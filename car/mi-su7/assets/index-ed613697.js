var aO=Object.defineProperty;var lO=(t,i,r)=>i in t?aO(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r;var B=(t,i,r)=>(lO(t,typeof i!="symbol"?i+"":i,r),r);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))o(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const d of y.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(p){if(p.ep)return;p.ep=!0;const y=r(p);fetch(p.href,y)}})();function cO(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ST={exports:{}},Wv={},MT={exports:{}},Un={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hm=Symbol.for("react.element"),uO=Symbol.for("react.portal"),hO=Symbol.for("react.fragment"),dO=Symbol.for("react.strict_mode"),fO=Symbol.for("react.profiler"),pO=Symbol.for("react.provider"),mO=Symbol.for("react.context"),gO=Symbol.for("react.forward_ref"),vO=Symbol.for("react.suspense"),yO=Symbol.for("react.memo"),_O=Symbol.for("react.lazy"),VS=Symbol.iterator;function xO(t){return t===null||typeof t!="object"?null:(t=VS&&t[VS]||t["@@iterator"],typeof t=="function"?t:null)}var ET={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},TT=Object.assign,CT={};function Jd(t,i,r){this.props=t,this.context=i,this.refs=CT,this.updater=r||ET}Jd.prototype.isReactComponent={};Jd.prototype.setState=function(t,i){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,i,"setState")};Jd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function PT(){}PT.prototype=Jd.prototype;function pb(t,i,r){this.props=t,this.context=i,this.refs=CT,this.updater=r||ET}var mb=pb.prototype=new PT;mb.constructor=pb;TT(mb,Jd.prototype);mb.isPureReactComponent=!0;var WS=Array.isArray,RT=Object.prototype.hasOwnProperty,gb={current:null},DT={key:!0,ref:!0,__self:!0,__source:!0};function IT(t,i,r){var o,p={},y=null,d=null;if(i!=null)for(o in i.ref!==void 0&&(d=i.ref),i.key!==void 0&&(y=""+i.key),i)RT.call(i,o)&&!DT.hasOwnProperty(o)&&(p[o]=i[o]);var E=arguments.length-2;if(E===1)p.children=r;else if(1<E){for(var L=Array(E),k=0;k<E;k++)L[k]=arguments[k+2];p.children=L}if(t&&t.defaultProps)for(o in E=t.defaultProps,E)p[o]===void 0&&(p[o]=E[o]);return{$$typeof:hm,type:t,key:y,ref:d,props:p,_owner:gb.current}}function bO(t,i){return{$$typeof:hm,type:t.type,key:i,ref:t.ref,props:t.props,_owner:t._owner}}function vb(t){return typeof t=="object"&&t!==null&&t.$$typeof===hm}function wO(t){var i={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return i[r]})}var jS=/\/+/g;function g_(t,i){return typeof t=="object"&&t!==null&&t.key!=null?wO(""+t.key):i.toString(36)}function Jg(t,i,r,o,p){var y=typeof t;(y==="undefined"||y==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(y){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case hm:case uO:d=!0}}if(d)return d=t,p=p(d),t=o===""?"."+g_(d,0):o,WS(p)?(r="",t!=null&&(r=t.replace(jS,"$&/")+"/"),Jg(p,i,r,"",function(k){return k})):p!=null&&(vb(p)&&(p=bO(p,r+(!p.key||d&&d.key===p.key?"":(""+p.key).replace(jS,"$&/")+"/")+t)),i.push(p)),1;if(d=0,o=o===""?".":o+":",WS(t))for(var E=0;E<t.length;E++){y=t[E];var L=o+g_(y,E);d+=Jg(y,i,r,L,p)}else if(L=xO(t),typeof L=="function")for(t=L.call(t),E=0;!(y=t.next()).done;)y=y.value,L=o+g_(y,E++),d+=Jg(y,i,r,L,p);else if(y==="object")throw i=String(t),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return d}function Ig(t,i,r){if(t==null)return t;var o=[],p=0;return Jg(t,o,"","",function(y){return i.call(r,y,p++)}),o}function AO(t){if(t._status===-1){var i=t._result;i=i(),i.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=i)}if(t._status===1)return t._result.default;throw t._result}var Ps={current:null},$g={transition:null},SO={ReactCurrentDispatcher:Ps,ReactCurrentBatchConfig:$g,ReactCurrentOwner:gb};Un.Children={map:Ig,forEach:function(t,i,r){Ig(t,function(){i.apply(this,arguments)},r)},count:function(t){var i=0;return Ig(t,function(){i++}),i},toArray:function(t){return Ig(t,function(i){return i})||[]},only:function(t){if(!vb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Un.Component=Jd;Un.Fragment=hO;Un.Profiler=fO;Un.PureComponent=pb;Un.StrictMode=dO;Un.Suspense=vO;Un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SO;Un.cloneElement=function(t,i,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var o=TT({},t.props),p=t.key,y=t.ref,d=t._owner;if(i!=null){if(i.ref!==void 0&&(y=i.ref,d=gb.current),i.key!==void 0&&(p=""+i.key),t.type&&t.type.defaultProps)var E=t.type.defaultProps;for(L in i)RT.call(i,L)&&!DT.hasOwnProperty(L)&&(o[L]=i[L]===void 0&&E!==void 0?E[L]:i[L])}var L=arguments.length-2;if(L===1)o.children=r;else if(1<L){E=Array(L);for(var k=0;k<L;k++)E[k]=arguments[k+2];o.children=E}return{$$typeof:hm,type:t.type,key:p,ref:y,props:o,_owner:d}};Un.createContext=function(t){return t={$$typeof:mO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:pO,_context:t},t.Consumer=t};Un.createElement=IT;Un.createFactory=function(t){var i=IT.bind(null,t);return i.type=t,i};Un.createRef=function(){return{current:null}};Un.forwardRef=function(t){return{$$typeof:gO,render:t}};Un.isValidElement=vb;Un.lazy=function(t){return{$$typeof:_O,_payload:{_status:-1,_result:t},_init:AO}};Un.memo=function(t,i){return{$$typeof:yO,type:t,compare:i===void 0?null:i}};Un.startTransition=function(t){var i=$g.transition;$g.transition={};try{t()}finally{$g.transition=i}};Un.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Un.useCallback=function(t,i){return Ps.current.useCallback(t,i)};Un.useContext=function(t){return Ps.current.useContext(t)};Un.useDebugValue=function(){};Un.useDeferredValue=function(t){return Ps.current.useDeferredValue(t)};Un.useEffect=function(t,i){return Ps.current.useEffect(t,i)};Un.useId=function(){return Ps.current.useId()};Un.useImperativeHandle=function(t,i,r){return Ps.current.useImperativeHandle(t,i,r)};Un.useInsertionEffect=function(t,i){return Ps.current.useInsertionEffect(t,i)};Un.useLayoutEffect=function(t,i){return Ps.current.useLayoutEffect(t,i)};Un.useMemo=function(t,i){return Ps.current.useMemo(t,i)};Un.useReducer=function(t,i,r){return Ps.current.useReducer(t,i,r)};Un.useRef=function(t){return Ps.current.useRef(t)};Un.useState=function(t){return Ps.current.useState(t)};Un.useSyncExternalStore=function(t,i,r){return Ps.current.useSyncExternalStore(t,i,r)};Un.useTransition=function(){return Ps.current.useTransition()};Un.version="18.2.0";MT.exports=Un;var pt=MT.exports;const yb=cO(pt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MO=pt,EO=Symbol.for("react.element"),TO=Symbol.for("react.fragment"),CO=Object.prototype.hasOwnProperty,PO=MO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RO={key:!0,ref:!0,__self:!0,__source:!0};function LT(t,i,r){var o,p={},y=null,d=null;r!==void 0&&(y=""+r),i.key!==void 0&&(y=""+i.key),i.ref!==void 0&&(d=i.ref);for(o in i)CO.call(i,o)&&!RO.hasOwnProperty(o)&&(p[o]=i[o]);if(t&&t.defaultProps)for(o in i=t.defaultProps,i)p[o]===void 0&&(p[o]=i[o]);return{$$typeof:EO,type:t,key:y,ref:d,props:p,_owner:PO.current}}Wv.Fragment=TO;Wv.jsx=LT;Wv.jsxs=LT;ST.exports=Wv;var Xe=ST.exports,sx={},OT={exports:{}},po={},FT={exports:{}},BT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function i(mt,tn){var yn=mt.length;mt.push(tn);e:for(;0<yn;){var fi=yn-1>>>1,wi=mt[fi];if(0<p(wi,tn))mt[fi]=tn,mt[yn]=wi,yn=fi;else break e}}function r(mt){return mt.length===0?null:mt[0]}function o(mt){if(mt.length===0)return null;var tn=mt[0],yn=mt.pop();if(yn!==tn){mt[0]=yn;e:for(var fi=0,wi=mt.length,Ds=wi>>>1;fi<Ds;){var es=2*(fi+1)-1,ba=mt[es],gs=es+1,vo=mt[gs];if(0>p(ba,yn))gs<wi&&0>p(vo,ba)?(mt[fi]=vo,mt[gs]=yn,fi=gs):(mt[fi]=ba,mt[es]=yn,fi=es);else if(gs<wi&&0>p(vo,yn))mt[fi]=vo,mt[gs]=yn,fi=gs;else break e}}return tn}function p(mt,tn){var yn=mt.sortIndex-tn.sortIndex;return yn!==0?yn:mt.id-tn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;t.unstable_now=function(){return y.now()}}else{var d=Date,E=d.now();t.unstable_now=function(){return d.now()-E}}var L=[],k=[],X=1,$=null,Z=3,ge=!1,be=!1,ye=!1,$e=typeof setTimeout=="function"?setTimeout:null,ce=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(mt){for(var tn=r(k);tn!==null;){if(tn.callback===null)o(k);else if(tn.startTime<=mt)o(k),tn.sortIndex=tn.expirationTime,i(L,tn);else break;tn=r(k)}}function re(mt){if(ye=!1,U(mt),!be)if(r(L)!==null)be=!0,gr(ve);else{var tn=r(k);tn!==null&&ms(re,tn.startTime-mt)}}function ve(mt,tn){be=!1,ye&&(ye=!1,ce(Ie),Ie=-1),ge=!0;var yn=Z;try{for(U(tn),$=r(L);$!==null&&(!($.expirationTime>tn)||mt&&!Sn());){var fi=$.callback;if(typeof fi=="function"){$.callback=null,Z=$.priorityLevel;var wi=fi($.expirationTime<=tn);tn=t.unstable_now(),typeof wi=="function"?$.callback=wi:$===r(L)&&o(L),U(tn)}else o(L);$=r(L)}if($!==null)var Ds=!0;else{var es=r(k);es!==null&&ms(re,es.startTime-tn),Ds=!1}return Ds}finally{$=null,Z=yn,ge=!1}}var Be=!1,Ge=null,Ie=-1,Ct=5,vt=-1;function Sn(){return!(t.unstable_now()-vt<Ct)}function Oi(){if(Ge!==null){var mt=t.unstable_now();vt=mt;var tn=!0;try{tn=Ge(!0,mt)}finally{tn?Fi():(Be=!1,Ge=null)}}else Be=!1}var Fi;if(typeof ie=="function")Fi=function(){ie(Oi)};else if(typeof MessageChannel<"u"){var $r=new MessageChannel,Ei=$r.port2;$r.port1.onmessage=Oi,Fi=function(){Ei.postMessage(null)}}else Fi=function(){$e(Oi,0)};function gr(mt){Ge=mt,Be||(Be=!0,Fi())}function ms(mt,tn){Ie=$e(function(){mt(t.unstable_now())},tn)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(mt){mt.callback=null},t.unstable_continueExecution=function(){be||ge||(be=!0,gr(ve))},t.unstable_forceFrameRate=function(mt){0>mt||125<mt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ct=0<mt?Math.floor(1e3/mt):5},t.unstable_getCurrentPriorityLevel=function(){return Z},t.unstable_getFirstCallbackNode=function(){return r(L)},t.unstable_next=function(mt){switch(Z){case 1:case 2:case 3:var tn=3;break;default:tn=Z}var yn=Z;Z=tn;try{return mt()}finally{Z=yn}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(mt,tn){switch(mt){case 1:case 2:case 3:case 4:case 5:break;default:mt=3}var yn=Z;Z=mt;try{return tn()}finally{Z=yn}},t.unstable_scheduleCallback=function(mt,tn,yn){var fi=t.unstable_now();switch(typeof yn=="object"&&yn!==null?(yn=yn.delay,yn=typeof yn=="number"&&0<yn?fi+yn:fi):yn=fi,mt){case 1:var wi=-1;break;case 2:wi=250;break;case 5:wi=1073741823;break;case 4:wi=1e4;break;default:wi=5e3}return wi=yn+wi,mt={id:X++,callback:tn,priorityLevel:mt,startTime:yn,expirationTime:wi,sortIndex:-1},yn>fi?(mt.sortIndex=yn,i(k,mt),r(L)===null&&mt===r(k)&&(ye?(ce(Ie),Ie=-1):ye=!0,ms(re,yn-fi))):(mt.sortIndex=wi,i(L,mt),be||ge||(be=!0,gr(ve))),mt},t.unstable_shouldYield=Sn,t.unstable_wrapCallback=function(mt){var tn=Z;return function(){var yn=Z;Z=tn;try{return mt.apply(this,arguments)}finally{Z=yn}}}})(BT);FT.exports=BT;var DO=FT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kT=pt,ho=DO;function ht(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)i+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var UT=new Set,Gp={};function vh(t,i){Wd(t,i),Wd(t+"Capture",i)}function Wd(t,i){for(Gp[t]=i,t=0;t<i.length;t++)UT.add(i[t])}var zl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ox=Object.prototype.hasOwnProperty,IO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XS={},YS={};function LO(t){return ox.call(YS,t)?!0:ox.call(XS,t)?!1:IO.test(t)?YS[t]=!0:(XS[t]=!0,!1)}function OO(t,i,r,o){if(r!==null&&r.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return o?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FO(t,i,r,o){if(i===null||typeof i>"u"||OO(t,i,r,o))return!0;if(o)return!1;if(r!==null)switch(r.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Rs(t,i,r,o,p,y,d){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=o,this.attributeNamespace=p,this.mustUseProperty=r,this.propertyName=t,this.type=i,this.sanitizeURL=y,this.removeEmptyString=d}var Jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jr[t]=new Rs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];Jr[i]=new Rs(i,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jr[t]=new Rs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jr[t]=new Rs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jr[t]=new Rs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jr[t]=new Rs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jr[t]=new Rs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jr[t]=new Rs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jr[t]=new Rs(t,5,!1,t.toLowerCase(),null,!1,!1)});var _b=/[\-:]([a-z])/g;function xb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(_b,xb);Jr[i]=new Rs(i,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(_b,xb);Jr[i]=new Rs(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(_b,xb);Jr[i]=new Rs(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jr[t]=new Rs(t,1,!1,t.toLowerCase(),null,!1,!1)});Jr.xlinkHref=new Rs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jr[t]=new Rs(t,1,!1,t.toLowerCase(),null,!0,!0)});function bb(t,i,r,o){var p=Jr.hasOwnProperty(i)?Jr[i]:null;(p!==null?p.type!==0:o||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(FO(i,r,p,o)&&(r=null),o||p===null?LO(i)&&(r===null?t.removeAttribute(i):t.setAttribute(i,""+r)):p.mustUseProperty?t[p.propertyName]=r===null?p.type===3?!1:"":r:(i=p.attributeName,o=p.attributeNamespace,r===null?t.removeAttribute(i):(p=p.type,r=p===3||p===4&&r===!0?"":""+r,o?t.setAttributeNS(o,i,r):t.setAttribute(i,r))))}var Wl=kT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lg=Symbol.for("react.element"),wd=Symbol.for("react.portal"),Ad=Symbol.for("react.fragment"),wb=Symbol.for("react.strict_mode"),ax=Symbol.for("react.profiler"),NT=Symbol.for("react.provider"),zT=Symbol.for("react.context"),Ab=Symbol.for("react.forward_ref"),lx=Symbol.for("react.suspense"),cx=Symbol.for("react.suspense_list"),Sb=Symbol.for("react.memo"),Ic=Symbol.for("react.lazy"),GT=Symbol.for("react.offscreen"),QS=Symbol.iterator;function dp(t){return t===null||typeof t!="object"?null:(t=QS&&t[QS]||t["@@iterator"],typeof t=="function"?t:null)}var Yi=Object.assign,v_;function Ap(t){if(v_===void 0)try{throw Error()}catch(r){var i=r.stack.trim().match(/\n( *(at )?)/);v_=i&&i[1]||""}return`
`+v_+t}var y_=!1;function __(t,i){if(!t||y_)return"";y_=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(k){var o=k}Reflect.construct(t,[],i)}else{try{i.call()}catch(k){o=k}t.call(i.prototype)}else{try{throw Error()}catch(k){o=k}t()}}catch(k){if(k&&o&&typeof k.stack=="string"){for(var p=k.stack.split(`
`),y=o.stack.split(`
`),d=p.length-1,E=y.length-1;1<=d&&0<=E&&p[d]!==y[E];)E--;for(;1<=d&&0<=E;d--,E--)if(p[d]!==y[E]){if(d!==1||E!==1)do if(d--,E--,0>E||p[d]!==y[E]){var L=`
`+p[d].replace(" at new "," at ");return t.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",t.displayName)),L}while(1<=d&&0<=E);break}}}finally{y_=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ap(t):""}function BO(t){switch(t.tag){case 5:return Ap(t.type);case 16:return Ap("Lazy");case 13:return Ap("Suspense");case 19:return Ap("SuspenseList");case 0:case 2:case 15:return t=__(t.type,!1),t;case 11:return t=__(t.type.render,!1),t;case 1:return t=__(t.type,!0),t;default:return""}}function ux(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ad:return"Fragment";case wd:return"Portal";case ax:return"Profiler";case wb:return"StrictMode";case lx:return"Suspense";case cx:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case zT:return(t.displayName||"Context")+".Consumer";case NT:return(t._context.displayName||"Context")+".Provider";case Ab:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sb:return i=t.displayName||null,i!==null?i:ux(t.type)||"Memo";case Ic:i=t._payload,t=t._init;try{return ux(t(i))}catch{}}return null}function kO(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ux(i);case 8:return i===wb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function HT(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function UO(t){var i=HT(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),o=""+t[i];if(!t.hasOwnProperty(i)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var p=r.get,y=r.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return p.call(this)},set:function(d){o=""+d,y.call(this,d)}}),Object.defineProperty(t,i,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function Og(t){t._valueTracker||(t._valueTracker=UO(t))}function VT(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var r=i.getValue(),o="";return t&&(o=HT(t)?t.checked?"true":"false":t.value),t=o,t!==r?(i.setValue(t),!0):!1}function fv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function hx(t,i){var r=i.checked;return Yi({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function KS(t,i){var r=i.defaultValue==null?"":i.defaultValue,o=i.checked!=null?i.checked:i.defaultChecked;r=Qc(i.value!=null?i.value:r),t._wrapperState={initialChecked:o,initialValue:r,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function WT(t,i){i=i.checked,i!=null&&bb(t,"checked",i,!1)}function dx(t,i){WT(t,i);var r=Qc(i.value),o=i.type;if(r!=null)o==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(o==="submit"||o==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?fx(t,i.type,r):i.hasOwnProperty("defaultValue")&&fx(t,i.type,Qc(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function qS(t,i,r){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var o=i.type;if(!(o!=="submit"&&o!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,r||i===t.value||(t.value=i),t.defaultValue=i}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function fx(t,i,r){(i!=="number"||fv(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Sp=Array.isArray;function Ud(t,i,r,o){if(t=t.options,i){i={};for(var p=0;p<r.length;p++)i["$"+r[p]]=!0;for(r=0;r<t.length;r++)p=i.hasOwnProperty("$"+t[r].value),t[r].selected!==p&&(t[r].selected=p),p&&o&&(t[r].defaultSelected=!0)}else{for(r=""+Qc(r),i=null,p=0;p<t.length;p++){if(t[p].value===r){t[p].selected=!0,o&&(t[p].defaultSelected=!0);return}i!==null||t[p].disabled||(i=t[p])}i!==null&&(i.selected=!0)}}function px(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(ht(91));return Yi({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ZS(t,i){var r=i.value;if(r==null){if(r=i.children,i=i.defaultValue,r!=null){if(i!=null)throw Error(ht(92));if(Sp(r)){if(1<r.length)throw Error(ht(93));r=r[0]}i=r}i==null&&(i=""),r=i}t._wrapperState={initialValue:Qc(r)}}function jT(t,i){var r=Qc(i.value),o=Qc(i.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),i.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),o!=null&&(t.defaultValue=""+o)}function JS(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function XT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mx(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?XT(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fg,YT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,r,o,p){MSApp.execUnsafeLocalFunction(function(){return t(i,r,o,p)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(Fg=Fg||document.createElement("div"),Fg.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Fg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function Hp(t,i){if(i){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=i;return}}t.textContent=i}var Cp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NO=["Webkit","ms","Moz","O"];Object.keys(Cp).forEach(function(t){NO.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),Cp[i]=Cp[t]})});function QT(t,i,r){return i==null||typeof i=="boolean"||i===""?"":r||typeof i!="number"||i===0||Cp.hasOwnProperty(t)&&Cp[t]?(""+i).trim():i+"px"}function KT(t,i){t=t.style;for(var r in i)if(i.hasOwnProperty(r)){var o=r.indexOf("--")===0,p=QT(r,i[r],o);r==="float"&&(r="cssFloat"),o?t.setProperty(r,p):t[r]=p}}var zO=Yi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gx(t,i){if(i){if(zO[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(ht(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(ht(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(ht(61))}if(i.style!=null&&typeof i.style!="object")throw Error(ht(62))}}function vx(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yx=null;function Mb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _x=null,Nd=null,zd=null;function $S(t){if(t=pm(t)){if(typeof _x!="function")throw Error(ht(280));var i=t.stateNode;i&&(i=Kv(i),_x(t.stateNode,t.type,i))}}function qT(t){Nd?zd?zd.push(t):zd=[t]:Nd=t}function ZT(){if(Nd){var t=Nd,i=zd;if(zd=Nd=null,$S(t),i)for(t=0;t<i.length;t++)$S(i[t])}}function JT(t,i){return t(i)}function $T(){}var x_=!1;function eC(t,i,r){if(x_)return t(i,r);x_=!0;try{return JT(t,i,r)}finally{x_=!1,(Nd!==null||zd!==null)&&($T(),ZT())}}function Vp(t,i){var r=t.stateNode;if(r===null)return null;var o=Kv(r);if(o===null)return null;r=o[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(t=t.type,o=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!o;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ht(231,i,typeof r));return r}var xx=!1;if(zl)try{var fp={};Object.defineProperty(fp,"passive",{get:function(){xx=!0}}),window.addEventListener("test",fp,fp),window.removeEventListener("test",fp,fp)}catch{xx=!1}function GO(t,i,r,o,p,y,d,E,L){var k=Array.prototype.slice.call(arguments,3);try{i.apply(r,k)}catch(X){this.onError(X)}}var Pp=!1,pv=null,mv=!1,bx=null,HO={onError:function(t){Pp=!0,pv=t}};function VO(t,i,r,o,p,y,d,E,L){Pp=!1,pv=null,GO.apply(HO,arguments)}function WO(t,i,r,o,p,y,d,E,L){if(VO.apply(this,arguments),Pp){if(Pp){var k=pv;Pp=!1,pv=null}else throw Error(ht(198));mv||(mv=!0,bx=k)}}function yh(t){var i=t,r=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,i.flags&4098&&(r=i.return),t=i.return;while(t)}return i.tag===3?r:null}function tC(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function eM(t){if(yh(t)!==t)throw Error(ht(188))}function jO(t){var i=t.alternate;if(!i){if(i=yh(t),i===null)throw Error(ht(188));return i!==t?null:t}for(var r=t,o=i;;){var p=r.return;if(p===null)break;var y=p.alternate;if(y===null){if(o=p.return,o!==null){r=o;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===r)return eM(p),t;if(y===o)return eM(p),i;y=y.sibling}throw Error(ht(188))}if(r.return!==o.return)r=p,o=y;else{for(var d=!1,E=p.child;E;){if(E===r){d=!0,r=p,o=y;break}if(E===o){d=!0,o=p,r=y;break}E=E.sibling}if(!d){for(E=y.child;E;){if(E===r){d=!0,r=y,o=p;break}if(E===o){d=!0,o=y,r=p;break}E=E.sibling}if(!d)throw Error(ht(189))}}if(r.alternate!==o)throw Error(ht(190))}if(r.tag!==3)throw Error(ht(188));return r.stateNode.current===r?t:i}function nC(t){return t=jO(t),t!==null?iC(t):null}function iC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=iC(t);if(i!==null)return i;t=t.sibling}return null}var rC=ho.unstable_scheduleCallback,tM=ho.unstable_cancelCallback,XO=ho.unstable_shouldYield,YO=ho.unstable_requestPaint,ar=ho.unstable_now,QO=ho.unstable_getCurrentPriorityLevel,Eb=ho.unstable_ImmediatePriority,sC=ho.unstable_UserBlockingPriority,gv=ho.unstable_NormalPriority,KO=ho.unstable_LowPriority,oC=ho.unstable_IdlePriority,jv=null,Za=null;function qO(t){if(Za&&typeof Za.onCommitFiberRoot=="function")try{Za.onCommitFiberRoot(jv,t,void 0,(t.current.flags&128)===128)}catch{}}var va=Math.clz32?Math.clz32:$O,ZO=Math.log,JO=Math.LN2;function $O(t){return t>>>=0,t===0?32:31-(ZO(t)/JO|0)|0}var Bg=64,kg=4194304;function Mp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function vv(t,i){var r=t.pendingLanes;if(r===0)return 0;var o=0,p=t.suspendedLanes,y=t.pingedLanes,d=r&268435455;if(d!==0){var E=d&~p;E!==0?o=Mp(E):(y&=d,y!==0&&(o=Mp(y)))}else d=r&~p,d!==0?o=Mp(d):y!==0&&(o=Mp(y));if(o===0)return 0;if(i!==0&&i!==o&&!(i&p)&&(p=o&-o,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if(o&4&&(o|=r&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=o;0<i;)r=31-va(i),p=1<<r,o|=t[r],i&=~p;return o}function eF(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tF(t,i){for(var r=t.suspendedLanes,o=t.pingedLanes,p=t.expirationTimes,y=t.pendingLanes;0<y;){var d=31-va(y),E=1<<d,L=p[d];L===-1?(!(E&r)||E&o)&&(p[d]=eF(E,i)):L<=i&&(t.expiredLanes|=E),y&=~E}}function wx(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function aC(){var t=Bg;return Bg<<=1,!(Bg&4194240)&&(Bg=64),t}function b_(t){for(var i=[],r=0;31>r;r++)i.push(t);return i}function dm(t,i,r){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-va(i),t[i]=r}function nF(t,i){var r=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var o=t.eventTimes;for(t=t.expirationTimes;0<r;){var p=31-va(r),y=1<<p;i[p]=0,o[p]=-1,t[p]=-1,r&=~y}}function Tb(t,i){var r=t.entangledLanes|=i;for(t=t.entanglements;r;){var o=31-va(r),p=1<<o;p&i|t[o]&i&&(t[o]|=i),r&=~p}}var di=0;function lC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var cC,Cb,uC,hC,dC,Ax=!1,Ug=[],Nc=null,zc=null,Gc=null,Wp=new Map,jp=new Map,Fc=[],iF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nM(t,i){switch(t){case"focusin":case"focusout":Nc=null;break;case"dragenter":case"dragleave":zc=null;break;case"mouseover":case"mouseout":Gc=null;break;case"pointerover":case"pointerout":Wp.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":jp.delete(i.pointerId)}}function pp(t,i,r,o,p,y){return t===null||t.nativeEvent!==y?(t={blockedOn:i,domEventName:r,eventSystemFlags:o,nativeEvent:y,targetContainers:[p]},i!==null&&(i=pm(i),i!==null&&Cb(i)),t):(t.eventSystemFlags|=o,i=t.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),t)}function rF(t,i,r,o,p){switch(i){case"focusin":return Nc=pp(Nc,t,i,r,o,p),!0;case"dragenter":return zc=pp(zc,t,i,r,o,p),!0;case"mouseover":return Gc=pp(Gc,t,i,r,o,p),!0;case"pointerover":var y=p.pointerId;return Wp.set(y,pp(Wp.get(y)||null,t,i,r,o,p)),!0;case"gotpointercapture":return y=p.pointerId,jp.set(y,pp(jp.get(y)||null,t,i,r,o,p)),!0}return!1}function fC(t){var i=sh(t.target);if(i!==null){var r=yh(i);if(r!==null){if(i=r.tag,i===13){if(i=tC(r),i!==null){t.blockedOn=i,dC(t.priority,function(){uC(r)});return}}else if(i===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ev(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var r=Sx(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var o=new r.constructor(r.type,r);yx=o,r.target.dispatchEvent(o),yx=null}else return i=pm(r),i!==null&&Cb(i),t.blockedOn=r,!1;i.shift()}return!0}function iM(t,i,r){ev(t)&&r.delete(i)}function sF(){Ax=!1,Nc!==null&&ev(Nc)&&(Nc=null),zc!==null&&ev(zc)&&(zc=null),Gc!==null&&ev(Gc)&&(Gc=null),Wp.forEach(iM),jp.forEach(iM)}function mp(t,i){t.blockedOn===i&&(t.blockedOn=null,Ax||(Ax=!0,ho.unstable_scheduleCallback(ho.unstable_NormalPriority,sF)))}function Xp(t){function i(p){return mp(p,t)}if(0<Ug.length){mp(Ug[0],t);for(var r=1;r<Ug.length;r++){var o=Ug[r];o.blockedOn===t&&(o.blockedOn=null)}}for(Nc!==null&&mp(Nc,t),zc!==null&&mp(zc,t),Gc!==null&&mp(Gc,t),Wp.forEach(i),jp.forEach(i),r=0;r<Fc.length;r++)o=Fc[r],o.blockedOn===t&&(o.blockedOn=null);for(;0<Fc.length&&(r=Fc[0],r.blockedOn===null);)fC(r),r.blockedOn===null&&Fc.shift()}var Gd=Wl.ReactCurrentBatchConfig,yv=!0;function oF(t,i,r,o){var p=di,y=Gd.transition;Gd.transition=null;try{di=1,Pb(t,i,r,o)}finally{di=p,Gd.transition=y}}function aF(t,i,r,o){var p=di,y=Gd.transition;Gd.transition=null;try{di=4,Pb(t,i,r,o)}finally{di=p,Gd.transition=y}}function Pb(t,i,r,o){if(yv){var p=Sx(t,i,r,o);if(p===null)D_(t,i,o,_v,r),nM(t,o);else if(rF(p,t,i,r,o))o.stopPropagation();else if(nM(t,o),i&4&&-1<iF.indexOf(t)){for(;p!==null;){var y=pm(p);if(y!==null&&cC(y),y=Sx(t,i,r,o),y===null&&D_(t,i,o,_v,r),y===p)break;p=y}p!==null&&o.stopPropagation()}else D_(t,i,o,null,r)}}var _v=null;function Sx(t,i,r,o){if(_v=null,t=Mb(o),t=sh(t),t!==null)if(i=yh(t),i===null)t=null;else if(r=i.tag,r===13){if(t=tC(i),t!==null)return t;t=null}else if(r===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return _v=t,null}function pC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QO()){case Eb:return 1;case sC:return 4;case gv:case KO:return 16;case oC:return 536870912;default:return 16}default:return 16}}var kc=null,Rb=null,tv=null;function mC(){if(tv)return tv;var t,i=Rb,r=i.length,o,p="value"in kc?kc.value:kc.textContent,y=p.length;for(t=0;t<r&&i[t]===p[t];t++);var d=r-t;for(o=1;o<=d&&i[r-o]===p[y-o];o++);return tv=p.slice(t,1<o?1-o:void 0)}function nv(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function Ng(){return!0}function rM(){return!1}function mo(t){function i(r,o,p,y,d){this._reactName=r,this._targetInst=p,this.type=o,this.nativeEvent=y,this.target=d,this.currentTarget=null;for(var E in t)t.hasOwnProperty(E)&&(r=t[E],this[E]=r?r(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ng:rM,this.isPropagationStopped=rM,this}return Yi(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ng)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ng)},persist:function(){},isPersistent:Ng}),i}var $d={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Db=mo($d),fm=Yi({},$d,{view:0,detail:0}),lF=mo(fm),w_,A_,gp,Xv=Yi({},fm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ib,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gp&&(gp&&t.type==="mousemove"?(w_=t.screenX-gp.screenX,A_=t.screenY-gp.screenY):A_=w_=0,gp=t),w_)},movementY:function(t){return"movementY"in t?t.movementY:A_}}),sM=mo(Xv),cF=Yi({},Xv,{dataTransfer:0}),uF=mo(cF),hF=Yi({},fm,{relatedTarget:0}),S_=mo(hF),dF=Yi({},$d,{animationName:0,elapsedTime:0,pseudoElement:0}),fF=mo(dF),pF=Yi({},$d,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mF=mo(pF),gF=Yi({},$d,{data:0}),oM=mo(gF),vF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_F={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xF(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=_F[t])?!!i[t]:!1}function Ib(){return xF}var bF=Yi({},fm,{key:function(t){if(t.key){var i=vF[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=nv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ib,charCode:function(t){return t.type==="keypress"?nv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wF=mo(bF),AF=Yi({},Xv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aM=mo(AF),SF=Yi({},fm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ib}),MF=mo(SF),EF=Yi({},$d,{propertyName:0,elapsedTime:0,pseudoElement:0}),TF=mo(EF),CF=Yi({},Xv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),PF=mo(CF),RF=[9,13,27,32],Lb=zl&&"CompositionEvent"in window,Rp=null;zl&&"documentMode"in document&&(Rp=document.documentMode);var DF=zl&&"TextEvent"in window&&!Rp,gC=zl&&(!Lb||Rp&&8<Rp&&11>=Rp),lM=String.fromCharCode(32),cM=!1;function vC(t,i){switch(t){case"keyup":return RF.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sd=!1;function IF(t,i){switch(t){case"compositionend":return yC(i);case"keypress":return i.which!==32?null:(cM=!0,lM);case"textInput":return t=i.data,t===lM&&cM?null:t;default:return null}}function LF(t,i){if(Sd)return t==="compositionend"||!Lb&&vC(t,i)?(t=mC(),tv=Rb=kc=null,Sd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return gC&&i.locale!=="ko"?null:i.data;default:return null}}var OF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uM(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!OF[t.type]:i==="textarea"}function _C(t,i,r,o){qT(o),i=xv(i,"onChange"),0<i.length&&(r=new Db("onChange","change",null,r,o),t.push({event:r,listeners:i}))}var Dp=null,Yp=null;function FF(t){RC(t,0)}function Yv(t){var i=Td(t);if(VT(i))return t}function BF(t,i){if(t==="change")return i}var xC=!1;if(zl){var M_;if(zl){var E_="oninput"in document;if(!E_){var hM=document.createElement("div");hM.setAttribute("oninput","return;"),E_=typeof hM.oninput=="function"}M_=E_}else M_=!1;xC=M_&&(!document.documentMode||9<document.documentMode)}function dM(){Dp&&(Dp.detachEvent("onpropertychange",bC),Yp=Dp=null)}function bC(t){if(t.propertyName==="value"&&Yv(Yp)){var i=[];_C(i,Yp,t,Mb(t)),eC(FF,i)}}function kF(t,i,r){t==="focusin"?(dM(),Dp=i,Yp=r,Dp.attachEvent("onpropertychange",bC)):t==="focusout"&&dM()}function UF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yv(Yp)}function NF(t,i){if(t==="click")return Yv(i)}function zF(t,i){if(t==="input"||t==="change")return Yv(i)}function GF(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var _a=typeof Object.is=="function"?Object.is:GF;function Qp(t,i){if(_a(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var r=Object.keys(t),o=Object.keys(i);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var p=r[o];if(!ox.call(i,p)||!_a(t[p],i[p]))return!1}return!0}function fM(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function pM(t,i){var r=fM(t);t=0;for(var o;r;){if(r.nodeType===3){if(o=t+r.textContent.length,t<=i&&o>=i)return{node:r,offset:i-t};t=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fM(r)}}function wC(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?wC(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function AC(){for(var t=window,i=fv();i instanceof t.HTMLIFrameElement;){try{var r=typeof i.contentWindow.location.href=="string"}catch{r=!1}if(r)t=i.contentWindow;else break;i=fv(t.document)}return i}function Ob(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function HF(t){var i=AC(),r=t.focusedElem,o=t.selectionRange;if(i!==r&&r&&r.ownerDocument&&wC(r.ownerDocument.documentElement,r)){if(o!==null&&Ob(r)){if(i=o.start,t=o.end,t===void 0&&(t=i),"selectionStart"in r)r.selectionStart=i,r.selectionEnd=Math.min(t,r.value.length);else if(t=(i=r.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var p=r.textContent.length,y=Math.min(o.start,p);o=o.end===void 0?y:Math.min(o.end,p),!t.extend&&y>o&&(p=o,o=y,y=p),p=pM(r,y);var d=pM(r,o);p&&d&&(t.rangeCount!==1||t.anchorNode!==p.node||t.anchorOffset!==p.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),t.removeAllRanges(),y>o?(t.addRange(i),t.extend(d.node,d.offset)):(i.setEnd(d.node,d.offset),t.addRange(i)))}}for(i=[],t=r;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<i.length;r++)t=i[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var VF=zl&&"documentMode"in document&&11>=document.documentMode,Md=null,Mx=null,Ip=null,Ex=!1;function mM(t,i,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ex||Md==null||Md!==fv(o)||(o=Md,"selectionStart"in o&&Ob(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ip&&Qp(Ip,o)||(Ip=o,o=xv(Mx,"onSelect"),0<o.length&&(i=new Db("onSelect","select",null,i,r),t.push({event:i,listeners:o}),i.target=Md)))}function zg(t,i){var r={};return r[t.toLowerCase()]=i.toLowerCase(),r["Webkit"+t]="webkit"+i,r["Moz"+t]="moz"+i,r}var Ed={animationend:zg("Animation","AnimationEnd"),animationiteration:zg("Animation","AnimationIteration"),animationstart:zg("Animation","AnimationStart"),transitionend:zg("Transition","TransitionEnd")},T_={},SC={};zl&&(SC=document.createElement("div").style,"AnimationEvent"in window||(delete Ed.animationend.animation,delete Ed.animationiteration.animation,delete Ed.animationstart.animation),"TransitionEvent"in window||delete Ed.transitionend.transition);function Qv(t){if(T_[t])return T_[t];if(!Ed[t])return t;var i=Ed[t],r;for(r in i)if(i.hasOwnProperty(r)&&r in SC)return T_[t]=i[r];return t}var MC=Qv("animationend"),EC=Qv("animationiteration"),TC=Qv("animationstart"),CC=Qv("transitionend"),PC=new Map,gM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $c(t,i){PC.set(t,i),vh(i,[t])}for(var C_=0;C_<gM.length;C_++){var P_=gM[C_],WF=P_.toLowerCase(),jF=P_[0].toUpperCase()+P_.slice(1);$c(WF,"on"+jF)}$c(MC,"onAnimationEnd");$c(EC,"onAnimationIteration");$c(TC,"onAnimationStart");$c("dblclick","onDoubleClick");$c("focusin","onFocus");$c("focusout","onBlur");$c(CC,"onTransitionEnd");Wd("onMouseEnter",["mouseout","mouseover"]);Wd("onMouseLeave",["mouseout","mouseover"]);Wd("onPointerEnter",["pointerout","pointerover"]);Wd("onPointerLeave",["pointerout","pointerover"]);vh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vh("onBeforeInput",["compositionend","keypress","textInput","paste"]);vh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ep="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ep));function vM(t,i,r){var o=t.type||"unknown-event";t.currentTarget=r,WO(o,i,void 0,t),t.currentTarget=null}function RC(t,i){i=(i&4)!==0;for(var r=0;r<t.length;r++){var o=t[r],p=o.event;o=o.listeners;e:{var y=void 0;if(i)for(var d=o.length-1;0<=d;d--){var E=o[d],L=E.instance,k=E.currentTarget;if(E=E.listener,L!==y&&p.isPropagationStopped())break e;vM(p,E,k),y=L}else for(d=0;d<o.length;d++){if(E=o[d],L=E.instance,k=E.currentTarget,E=E.listener,L!==y&&p.isPropagationStopped())break e;vM(p,E,k),y=L}}}if(mv)throw t=bx,mv=!1,bx=null,t}function Ii(t,i){var r=i[Dx];r===void 0&&(r=i[Dx]=new Set);var o=t+"__bubble";r.has(o)||(DC(i,t,2,!1),r.add(o))}function R_(t,i,r){var o=0;i&&(o|=4),DC(r,t,o,i)}var Gg="_reactListening"+Math.random().toString(36).slice(2);function Kp(t){if(!t[Gg]){t[Gg]=!0,UT.forEach(function(r){r!=="selectionchange"&&(XF.has(r)||R_(r,!1,t),R_(r,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Gg]||(i[Gg]=!0,R_("selectionchange",!1,i))}}function DC(t,i,r,o){switch(pC(i)){case 1:var p=oF;break;case 4:p=aF;break;default:p=Pb}r=p.bind(null,i,r,t),p=void 0,!xx||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),o?p!==void 0?t.addEventListener(i,r,{capture:!0,passive:p}):t.addEventListener(i,r,!0):p!==void 0?t.addEventListener(i,r,{passive:p}):t.addEventListener(i,r,!1)}function D_(t,i,r,o,p){var y=o;if(!(i&1)&&!(i&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var E=o.stateNode.containerInfo;if(E===p||E.nodeType===8&&E.parentNode===p)break;if(d===4)for(d=o.return;d!==null;){var L=d.tag;if((L===3||L===4)&&(L=d.stateNode.containerInfo,L===p||L.nodeType===8&&L.parentNode===p))return;d=d.return}for(;E!==null;){if(d=sh(E),d===null)return;if(L=d.tag,L===5||L===6){o=y=d;continue e}E=E.parentNode}}o=o.return}eC(function(){var k=y,X=Mb(r),$=[];e:{var Z=PC.get(t);if(Z!==void 0){var ge=Db,be=t;switch(t){case"keypress":if(nv(r)===0)break e;case"keydown":case"keyup":ge=wF;break;case"focusin":be="focus",ge=S_;break;case"focusout":be="blur",ge=S_;break;case"beforeblur":case"afterblur":ge=S_;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=sM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=uF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=MF;break;case MC:case EC:case TC:ge=fF;break;case CC:ge=TF;break;case"scroll":ge=lF;break;case"wheel":ge=PF;break;case"copy":case"cut":case"paste":ge=mF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=aM}var ye=(i&4)!==0,$e=!ye&&t==="scroll",ce=ye?Z!==null?Z+"Capture":null:Z;ye=[];for(var ie=k,U;ie!==null;){U=ie;var re=U.stateNode;if(U.tag===5&&re!==null&&(U=re,ce!==null&&(re=Vp(ie,ce),re!=null&&ye.push(qp(ie,re,U)))),$e)break;ie=ie.return}0<ye.length&&(Z=new ge(Z,be,null,r,X),$.push({event:Z,listeners:ye}))}}if(!(i&7)){e:{if(Z=t==="mouseover"||t==="pointerover",ge=t==="mouseout"||t==="pointerout",Z&&r!==yx&&(be=r.relatedTarget||r.fromElement)&&(sh(be)||be[Gl]))break e;if((ge||Z)&&(Z=X.window===X?X:(Z=X.ownerDocument)?Z.defaultView||Z.parentWindow:window,ge?(be=r.relatedTarget||r.toElement,ge=k,be=be?sh(be):null,be!==null&&($e=yh(be),be!==$e||be.tag!==5&&be.tag!==6)&&(be=null)):(ge=null,be=k),ge!==be)){if(ye=sM,re="onMouseLeave",ce="onMouseEnter",ie="mouse",(t==="pointerout"||t==="pointerover")&&(ye=aM,re="onPointerLeave",ce="onPointerEnter",ie="pointer"),$e=ge==null?Z:Td(ge),U=be==null?Z:Td(be),Z=new ye(re,ie+"leave",ge,r,X),Z.target=$e,Z.relatedTarget=U,re=null,sh(X)===k&&(ye=new ye(ce,ie+"enter",be,r,X),ye.target=U,ye.relatedTarget=$e,re=ye),$e=re,ge&&be)t:{for(ye=ge,ce=be,ie=0,U=ye;U;U=_d(U))ie++;for(U=0,re=ce;re;re=_d(re))U++;for(;0<ie-U;)ye=_d(ye),ie--;for(;0<U-ie;)ce=_d(ce),U--;for(;ie--;){if(ye===ce||ce!==null&&ye===ce.alternate)break t;ye=_d(ye),ce=_d(ce)}ye=null}else ye=null;ge!==null&&yM($,Z,ge,ye,!1),be!==null&&$e!==null&&yM($,$e,be,ye,!0)}}e:{if(Z=k?Td(k):window,ge=Z.nodeName&&Z.nodeName.toLowerCase(),ge==="select"||ge==="input"&&Z.type==="file")var ve=BF;else if(uM(Z))if(xC)ve=zF;else{ve=UF;var Be=kF}else(ge=Z.nodeName)&&ge.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(ve=NF);if(ve&&(ve=ve(t,k))){_C($,ve,r,X);break e}Be&&Be(t,Z,k),t==="focusout"&&(Be=Z._wrapperState)&&Be.controlled&&Z.type==="number"&&fx(Z,"number",Z.value)}switch(Be=k?Td(k):window,t){case"focusin":(uM(Be)||Be.contentEditable==="true")&&(Md=Be,Mx=k,Ip=null);break;case"focusout":Ip=Mx=Md=null;break;case"mousedown":Ex=!0;break;case"contextmenu":case"mouseup":case"dragend":Ex=!1,mM($,r,X);break;case"selectionchange":if(VF)break;case"keydown":case"keyup":mM($,r,X)}var Ge;if(Lb)e:{switch(t){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else Sd?vC(t,r)&&(Ie="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(Ie="onCompositionStart");Ie&&(gC&&r.locale!=="ko"&&(Sd||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&Sd&&(Ge=mC()):(kc=X,Rb="value"in kc?kc.value:kc.textContent,Sd=!0)),Be=xv(k,Ie),0<Be.length&&(Ie=new oM(Ie,t,null,r,X),$.push({event:Ie,listeners:Be}),Ge?Ie.data=Ge:(Ge=yC(r),Ge!==null&&(Ie.data=Ge)))),(Ge=DF?IF(t,r):LF(t,r))&&(k=xv(k,"onBeforeInput"),0<k.length&&(X=new oM("onBeforeInput","beforeinput",null,r,X),$.push({event:X,listeners:k}),X.data=Ge))}RC($,i)})}function qp(t,i,r){return{instance:t,listener:i,currentTarget:r}}function xv(t,i){for(var r=i+"Capture",o=[];t!==null;){var p=t,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=Vp(t,r),y!=null&&o.unshift(qp(t,y,p)),y=Vp(t,i),y!=null&&o.push(qp(t,y,p))),t=t.return}return o}function _d(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yM(t,i,r,o,p){for(var y=i._reactName,d=[];r!==null&&r!==o;){var E=r,L=E.alternate,k=E.stateNode;if(L!==null&&L===o)break;E.tag===5&&k!==null&&(E=k,p?(L=Vp(r,y),L!=null&&d.unshift(qp(r,L,E))):p||(L=Vp(r,y),L!=null&&d.push(qp(r,L,E)))),r=r.return}d.length!==0&&t.push({event:i,listeners:d})}var YF=/\r\n?/g,QF=/\u0000|\uFFFD/g;function _M(t){return(typeof t=="string"?t:""+t).replace(YF,`
`).replace(QF,"")}function Hg(t,i,r){if(i=_M(i),_M(t)!==i&&r)throw Error(ht(425))}function bv(){}var Tx=null,Cx=null;function Px(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Rx=typeof setTimeout=="function"?setTimeout:void 0,KF=typeof clearTimeout=="function"?clearTimeout:void 0,xM=typeof Promise=="function"?Promise:void 0,qF=typeof queueMicrotask=="function"?queueMicrotask:typeof xM<"u"?function(t){return xM.resolve(null).then(t).catch(ZF)}:Rx;function ZF(t){setTimeout(function(){throw t})}function I_(t,i){var r=i,o=0;do{var p=r.nextSibling;if(t.removeChild(r),p&&p.nodeType===8)if(r=p.data,r==="/$"){if(o===0){t.removeChild(p),Xp(i);return}o--}else r!=="$"&&r!=="$?"&&r!=="$!"||o++;r=p}while(r);Xp(i)}function Hc(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function bM(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(i===0)return t;i--}else r==="/$"&&i++}t=t.previousSibling}return null}var ef=Math.random().toString(36).slice(2),qa="__reactFiber$"+ef,Zp="__reactProps$"+ef,Gl="__reactContainer$"+ef,Dx="__reactEvents$"+ef,JF="__reactListeners$"+ef,$F="__reactHandles$"+ef;function sh(t){var i=t[qa];if(i)return i;for(var r=t.parentNode;r;){if(i=r[Gl]||r[qa]){if(r=i.alternate,i.child!==null||r!==null&&r.child!==null)for(t=bM(t);t!==null;){if(r=t[qa])return r;t=bM(t)}return i}t=r,r=t.parentNode}return null}function pm(t){return t=t[qa]||t[Gl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Td(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ht(33))}function Kv(t){return t[Zp]||null}var Ix=[],Cd=-1;function eu(t){return{current:t}}function Li(t){0>Cd||(t.current=Ix[Cd],Ix[Cd]=null,Cd--)}function Mi(t,i){Cd++,Ix[Cd]=t.current,t.current=i}var Kc={},ps=eu(Kc),Ns=eu(!1),dh=Kc;function jd(t,i){var r=t.type.contextTypes;if(!r)return Kc;var o=t.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===i)return o.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in r)p[y]=i[y];return o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=p),p}function zs(t){return t=t.childContextTypes,t!=null}function wv(){Li(Ns),Li(ps)}function wM(t,i,r){if(ps.current!==Kc)throw Error(ht(168));Mi(ps,i),Mi(Ns,r)}function IC(t,i,r){var o=t.stateNode;if(i=i.childContextTypes,typeof o.getChildContext!="function")return r;o=o.getChildContext();for(var p in o)if(!(p in i))throw Error(ht(108,kO(t)||"Unknown",p));return Yi({},r,o)}function Av(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Kc,dh=ps.current,Mi(ps,t),Mi(Ns,Ns.current),!0}function AM(t,i,r){var o=t.stateNode;if(!o)throw Error(ht(169));r?(t=IC(t,i,dh),o.__reactInternalMemoizedMergedChildContext=t,Li(Ns),Li(ps),Mi(ps,t)):Li(Ns),Mi(Ns,r)}var Rl=null,qv=!1,L_=!1;function LC(t){Rl===null?Rl=[t]:Rl.push(t)}function eB(t){qv=!0,LC(t)}function tu(){if(!L_&&Rl!==null){L_=!0;var t=0,i=di;try{var r=Rl;for(di=1;t<r.length;t++){var o=r[t];do o=o(!0);while(o!==null)}Rl=null,qv=!1}catch(p){throw Rl!==null&&(Rl=Rl.slice(t+1)),rC(Eb,tu),p}finally{di=i,L_=!1}}return null}var Pd=[],Rd=0,Sv=null,Mv=0,Bo=[],ko=0,fh=null,Dl=1,Il="";function eh(t,i){Pd[Rd++]=Mv,Pd[Rd++]=Sv,Sv=t,Mv=i}function OC(t,i,r){Bo[ko++]=Dl,Bo[ko++]=Il,Bo[ko++]=fh,fh=t;var o=Dl;t=Il;var p=32-va(o)-1;o&=~(1<<p),r+=1;var y=32-va(i)+p;if(30<y){var d=p-p%5;y=(o&(1<<d)-1).toString(32),o>>=d,p-=d,Dl=1<<32-va(i)+p|r<<p|o,Il=y+t}else Dl=1<<y|r<<p|o,Il=t}function Fb(t){t.return!==null&&(eh(t,1),OC(t,1,0))}function Bb(t){for(;t===Sv;)Sv=Pd[--Rd],Pd[Rd]=null,Mv=Pd[--Rd],Pd[Rd]=null;for(;t===fh;)fh=Bo[--ko],Bo[ko]=null,Il=Bo[--ko],Bo[ko]=null,Dl=Bo[--ko],Bo[ko]=null}var uo=null,co=null,Gi=!1,ma=null;function FC(t,i){var r=Uo(5,null,null,0);r.elementType="DELETED",r.stateNode=i,r.return=t,i=t.deletions,i===null?(t.deletions=[r],t.flags|=16):i.push(r)}function SM(t,i){switch(t.tag){case 5:var r=t.type;return i=i.nodeType!==1||r.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,uo=t,co=Hc(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,uo=t,co=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(r=fh!==null?{id:Dl,overflow:Il}:null,t.memoizedState={dehydrated:i,treeContext:r,retryLane:1073741824},r=Uo(18,null,null,0),r.stateNode=i,r.return=t,t.child=r,uo=t,co=null,!0):!1;default:return!1}}function Lx(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ox(t){if(Gi){var i=co;if(i){var r=i;if(!SM(t,i)){if(Lx(t))throw Error(ht(418));i=Hc(r.nextSibling);var o=uo;i&&SM(t,i)?FC(o,r):(t.flags=t.flags&-4097|2,Gi=!1,uo=t)}}else{if(Lx(t))throw Error(ht(418));t.flags=t.flags&-4097|2,Gi=!1,uo=t}}}function MM(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;uo=t}function Vg(t){if(t!==uo)return!1;if(!Gi)return MM(t),Gi=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!Px(t.type,t.memoizedProps)),i&&(i=co)){if(Lx(t))throw BC(),Error(ht(418));for(;i;)FC(t,i),i=Hc(i.nextSibling)}if(MM(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ht(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(i===0){co=Hc(t.nextSibling);break e}i--}else r!=="$"&&r!=="$!"&&r!=="$?"||i++}t=t.nextSibling}co=null}}else co=uo?Hc(t.stateNode.nextSibling):null;return!0}function BC(){for(var t=co;t;)t=Hc(t.nextSibling)}function Xd(){co=uo=null,Gi=!1}function kb(t){ma===null?ma=[t]:ma.push(t)}var tB=Wl.ReactCurrentBatchConfig;function da(t,i){if(t&&t.defaultProps){i=Yi({},i),t=t.defaultProps;for(var r in t)i[r]===void 0&&(i[r]=t[r]);return i}return i}var Ev=eu(null),Tv=null,Dd=null,Ub=null;function Nb(){Ub=Dd=Tv=null}function zb(t){var i=Ev.current;Li(Ev),t._currentValue=i}function Fx(t,i,r){for(;t!==null;){var o=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,o!==null&&(o.childLanes|=i)):o!==null&&(o.childLanes&i)!==i&&(o.childLanes|=i),t===r)break;t=t.return}}function Hd(t,i){Tv=t,Ub=Dd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&i&&(Us=!0),t.firstContext=null)}function zo(t){var i=t._currentValue;if(Ub!==t)if(t={context:t,memoizedValue:i,next:null},Dd===null){if(Tv===null)throw Error(ht(308));Dd=t,Tv.dependencies={lanes:0,firstContext:t}}else Dd=Dd.next=t;return i}var oh=null;function Gb(t){oh===null?oh=[t]:oh.push(t)}function kC(t,i,r,o){var p=i.interleaved;return p===null?(r.next=r,Gb(i)):(r.next=p.next,p.next=r),i.interleaved=r,Hl(t,o)}function Hl(t,i){t.lanes|=i;var r=t.alternate;for(r!==null&&(r.lanes|=i),r=t,t=t.return;t!==null;)t.childLanes|=i,r=t.alternate,r!==null&&(r.childLanes|=i),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Lc=!1;function Hb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UC(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ol(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Vc(t,i,r){var o=t.updateQueue;if(o===null)return null;if(o=o.shared,Qn&2){var p=o.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),o.pending=i,Hl(t,r)}return p=o.interleaved,p===null?(i.next=i,Gb(o)):(i.next=p.next,p.next=i),o.interleaved=i,Hl(t,r)}function iv(t,i,r){if(i=i.updateQueue,i!==null&&(i=i.shared,(r&4194240)!==0)){var o=i.lanes;o&=t.pendingLanes,r|=o,i.lanes=r,Tb(t,r)}}function EM(t,i){var r=t.updateQueue,o=t.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var p=null,y=null;if(r=r.firstBaseUpdate,r!==null){do{var d={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};y===null?p=y=d:y=y.next=d,r=r.next}while(r!==null);y===null?p=y=i:y=y.next=i}else p=y=i;r={baseState:o.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:o.shared,effects:o.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=i:t.next=i,r.lastBaseUpdate=i}function Cv(t,i,r,o){var p=t.updateQueue;Lc=!1;var y=p.firstBaseUpdate,d=p.lastBaseUpdate,E=p.shared.pending;if(E!==null){p.shared.pending=null;var L=E,k=L.next;L.next=null,d===null?y=k:d.next=k,d=L;var X=t.alternate;X!==null&&(X=X.updateQueue,E=X.lastBaseUpdate,E!==d&&(E===null?X.firstBaseUpdate=k:E.next=k,X.lastBaseUpdate=L))}if(y!==null){var $=p.baseState;d=0,X=k=L=null,E=y;do{var Z=E.lane,ge=E.eventTime;if((o&Z)===Z){X!==null&&(X=X.next={eventTime:ge,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var be=t,ye=E;switch(Z=i,ge=r,ye.tag){case 1:if(be=ye.payload,typeof be=="function"){$=be.call(ge,$,Z);break e}$=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=ye.payload,Z=typeof be=="function"?be.call(ge,$,Z):be,Z==null)break e;$=Yi({},$,Z);break e;case 2:Lc=!0}}E.callback!==null&&E.lane!==0&&(t.flags|=64,Z=p.effects,Z===null?p.effects=[E]:Z.push(E))}else ge={eventTime:ge,lane:Z,tag:E.tag,payload:E.payload,callback:E.callback,next:null},X===null?(k=X=ge,L=$):X=X.next=ge,d|=Z;if(E=E.next,E===null){if(E=p.shared.pending,E===null)break;Z=E,E=Z.next,Z.next=null,p.lastBaseUpdate=Z,p.shared.pending=null}}while(1);if(X===null&&(L=$),p.baseState=L,p.firstBaseUpdate=k,p.lastBaseUpdate=X,i=p.shared.interleaved,i!==null){p=i;do d|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);mh|=d,t.lanes=d,t.memoizedState=$}}function TM(t,i,r){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var o=t[i],p=o.callback;if(p!==null){if(o.callback=null,o=r,typeof p!="function")throw Error(ht(191,p));p.call(o)}}}var NC=new kT.Component().refs;function Bx(t,i,r,o){i=t.memoizedState,r=r(o,i),r=r==null?i:Yi({},i,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Zv={isMounted:function(t){return(t=t._reactInternals)?yh(t)===t:!1},enqueueSetState:function(t,i,r){t=t._reactInternals;var o=Cs(),p=jc(t),y=Ol(o,p);y.payload=i,r!=null&&(y.callback=r),i=Vc(t,y,p),i!==null&&(ya(i,t,p,o),iv(i,t,p))},enqueueReplaceState:function(t,i,r){t=t._reactInternals;var o=Cs(),p=jc(t),y=Ol(o,p);y.tag=1,y.payload=i,r!=null&&(y.callback=r),i=Vc(t,y,p),i!==null&&(ya(i,t,p,o),iv(i,t,p))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var r=Cs(),o=jc(t),p=Ol(r,o);p.tag=2,i!=null&&(p.callback=i),i=Vc(t,p,o),i!==null&&(ya(i,t,o,r),iv(i,t,o))}};function CM(t,i,r,o,p,y,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(o,y,d):i.prototype&&i.prototype.isPureReactComponent?!Qp(r,o)||!Qp(p,y):!0}function zC(t,i,r){var o=!1,p=Kc,y=i.contextType;return typeof y=="object"&&y!==null?y=zo(y):(p=zs(i)?dh:ps.current,o=i.contextTypes,y=(o=o!=null)?jd(t,p):Kc),i=new i(r,y),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Zv,t.stateNode=i,i._reactInternals=t,o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=p,t.__reactInternalMemoizedMaskedChildContext=y),i}function PM(t,i,r,o){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(r,o),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(r,o),i.state!==t&&Zv.enqueueReplaceState(i,i.state,null)}function kx(t,i,r,o){var p=t.stateNode;p.props=r,p.state=t.memoizedState,p.refs=NC,Hb(t);var y=i.contextType;typeof y=="object"&&y!==null?p.context=zo(y):(y=zs(i)?dh:ps.current,p.context=jd(t,y)),p.state=t.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(Bx(t,i,y,r),p.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Zv.enqueueReplaceState(p,p.state,null),Cv(t,r,p,o),p.state=t.memoizedState),typeof p.componentDidMount=="function"&&(t.flags|=4194308)}function vp(t,i,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ht(309));var o=r.stateNode}if(!o)throw Error(ht(147,t));var p=o,y=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(d){var E=p.refs;E===NC&&(E=p.refs={}),d===null?delete E[y]:E[y]=d},i._stringRef=y,i)}if(typeof t!="string")throw Error(ht(284));if(!r._owner)throw Error(ht(290,t))}return t}function Wg(t,i){throw t=Object.prototype.toString.call(i),Error(ht(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function RM(t){var i=t._init;return i(t._payload)}function GC(t){function i(ce,ie){if(t){var U=ce.deletions;U===null?(ce.deletions=[ie],ce.flags|=16):U.push(ie)}}function r(ce,ie){if(!t)return null;for(;ie!==null;)i(ce,ie),ie=ie.sibling;return null}function o(ce,ie){for(ce=new Map;ie!==null;)ie.key!==null?ce.set(ie.key,ie):ce.set(ie.index,ie),ie=ie.sibling;return ce}function p(ce,ie){return ce=Xc(ce,ie),ce.index=0,ce.sibling=null,ce}function y(ce,ie,U){return ce.index=U,t?(U=ce.alternate,U!==null?(U=U.index,U<ie?(ce.flags|=2,ie):U):(ce.flags|=2,ie)):(ce.flags|=1048576,ie)}function d(ce){return t&&ce.alternate===null&&(ce.flags|=2),ce}function E(ce,ie,U,re){return ie===null||ie.tag!==6?(ie=z_(U,ce.mode,re),ie.return=ce,ie):(ie=p(ie,U),ie.return=ce,ie)}function L(ce,ie,U,re){var ve=U.type;return ve===Ad?X(ce,ie,U.props.children,re,U.key):ie!==null&&(ie.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ic&&RM(ve)===ie.type)?(re=p(ie,U.props),re.ref=vp(ce,ie,U),re.return=ce,re):(re=cv(U.type,U.key,U.props,null,ce.mode,re),re.ref=vp(ce,ie,U),re.return=ce,re)}function k(ce,ie,U,re){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==U.containerInfo||ie.stateNode.implementation!==U.implementation?(ie=G_(U,ce.mode,re),ie.return=ce,ie):(ie=p(ie,U.children||[]),ie.return=ce,ie)}function X(ce,ie,U,re,ve){return ie===null||ie.tag!==7?(ie=uh(U,ce.mode,re,ve),ie.return=ce,ie):(ie=p(ie,U),ie.return=ce,ie)}function $(ce,ie,U){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=z_(""+ie,ce.mode,U),ie.return=ce,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case Lg:return U=cv(ie.type,ie.key,ie.props,null,ce.mode,U),U.ref=vp(ce,null,ie),U.return=ce,U;case wd:return ie=G_(ie,ce.mode,U),ie.return=ce,ie;case Ic:var re=ie._init;return $(ce,re(ie._payload),U)}if(Sp(ie)||dp(ie))return ie=uh(ie,ce.mode,U,null),ie.return=ce,ie;Wg(ce,ie)}return null}function Z(ce,ie,U,re){var ve=ie!==null?ie.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return ve!==null?null:E(ce,ie,""+U,re);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Lg:return U.key===ve?L(ce,ie,U,re):null;case wd:return U.key===ve?k(ce,ie,U,re):null;case Ic:return ve=U._init,Z(ce,ie,ve(U._payload),re)}if(Sp(U)||dp(U))return ve!==null?null:X(ce,ie,U,re,null);Wg(ce,U)}return null}function ge(ce,ie,U,re,ve){if(typeof re=="string"&&re!==""||typeof re=="number")return ce=ce.get(U)||null,E(ie,ce,""+re,ve);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Lg:return ce=ce.get(re.key===null?U:re.key)||null,L(ie,ce,re,ve);case wd:return ce=ce.get(re.key===null?U:re.key)||null,k(ie,ce,re,ve);case Ic:var Be=re._init;return ge(ce,ie,U,Be(re._payload),ve)}if(Sp(re)||dp(re))return ce=ce.get(U)||null,X(ie,ce,re,ve,null);Wg(ie,re)}return null}function be(ce,ie,U,re){for(var ve=null,Be=null,Ge=ie,Ie=ie=0,Ct=null;Ge!==null&&Ie<U.length;Ie++){Ge.index>Ie?(Ct=Ge,Ge=null):Ct=Ge.sibling;var vt=Z(ce,Ge,U[Ie],re);if(vt===null){Ge===null&&(Ge=Ct);break}t&&Ge&&vt.alternate===null&&i(ce,Ge),ie=y(vt,ie,Ie),Be===null?ve=vt:Be.sibling=vt,Be=vt,Ge=Ct}if(Ie===U.length)return r(ce,Ge),Gi&&eh(ce,Ie),ve;if(Ge===null){for(;Ie<U.length;Ie++)Ge=$(ce,U[Ie],re),Ge!==null&&(ie=y(Ge,ie,Ie),Be===null?ve=Ge:Be.sibling=Ge,Be=Ge);return Gi&&eh(ce,Ie),ve}for(Ge=o(ce,Ge);Ie<U.length;Ie++)Ct=ge(Ge,ce,Ie,U[Ie],re),Ct!==null&&(t&&Ct.alternate!==null&&Ge.delete(Ct.key===null?Ie:Ct.key),ie=y(Ct,ie,Ie),Be===null?ve=Ct:Be.sibling=Ct,Be=Ct);return t&&Ge.forEach(function(Sn){return i(ce,Sn)}),Gi&&eh(ce,Ie),ve}function ye(ce,ie,U,re){var ve=dp(U);if(typeof ve!="function")throw Error(ht(150));if(U=ve.call(U),U==null)throw Error(ht(151));for(var Be=ve=null,Ge=ie,Ie=ie=0,Ct=null,vt=U.next();Ge!==null&&!vt.done;Ie++,vt=U.next()){Ge.index>Ie?(Ct=Ge,Ge=null):Ct=Ge.sibling;var Sn=Z(ce,Ge,vt.value,re);if(Sn===null){Ge===null&&(Ge=Ct);break}t&&Ge&&Sn.alternate===null&&i(ce,Ge),ie=y(Sn,ie,Ie),Be===null?ve=Sn:Be.sibling=Sn,Be=Sn,Ge=Ct}if(vt.done)return r(ce,Ge),Gi&&eh(ce,Ie),ve;if(Ge===null){for(;!vt.done;Ie++,vt=U.next())vt=$(ce,vt.value,re),vt!==null&&(ie=y(vt,ie,Ie),Be===null?ve=vt:Be.sibling=vt,Be=vt);return Gi&&eh(ce,Ie),ve}for(Ge=o(ce,Ge);!vt.done;Ie++,vt=U.next())vt=ge(Ge,ce,Ie,vt.value,re),vt!==null&&(t&&vt.alternate!==null&&Ge.delete(vt.key===null?Ie:vt.key),ie=y(vt,ie,Ie),Be===null?ve=vt:Be.sibling=vt,Be=vt);return t&&Ge.forEach(function(Oi){return i(ce,Oi)}),Gi&&eh(ce,Ie),ve}function $e(ce,ie,U,re){if(typeof U=="object"&&U!==null&&U.type===Ad&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Lg:e:{for(var ve=U.key,Be=ie;Be!==null;){if(Be.key===ve){if(ve=U.type,ve===Ad){if(Be.tag===7){r(ce,Be.sibling),ie=p(Be,U.props.children),ie.return=ce,ce=ie;break e}}else if(Be.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ic&&RM(ve)===Be.type){r(ce,Be.sibling),ie=p(Be,U.props),ie.ref=vp(ce,Be,U),ie.return=ce,ce=ie;break e}r(ce,Be);break}else i(ce,Be);Be=Be.sibling}U.type===Ad?(ie=uh(U.props.children,ce.mode,re,U.key),ie.return=ce,ce=ie):(re=cv(U.type,U.key,U.props,null,ce.mode,re),re.ref=vp(ce,ie,U),re.return=ce,ce=re)}return d(ce);case wd:e:{for(Be=U.key;ie!==null;){if(ie.key===Be)if(ie.tag===4&&ie.stateNode.containerInfo===U.containerInfo&&ie.stateNode.implementation===U.implementation){r(ce,ie.sibling),ie=p(ie,U.children||[]),ie.return=ce,ce=ie;break e}else{r(ce,ie);break}else i(ce,ie);ie=ie.sibling}ie=G_(U,ce.mode,re),ie.return=ce,ce=ie}return d(ce);case Ic:return Be=U._init,$e(ce,ie,Be(U._payload),re)}if(Sp(U))return be(ce,ie,U,re);if(dp(U))return ye(ce,ie,U,re);Wg(ce,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,ie!==null&&ie.tag===6?(r(ce,ie.sibling),ie=p(ie,U),ie.return=ce,ce=ie):(r(ce,ie),ie=z_(U,ce.mode,re),ie.return=ce,ce=ie),d(ce)):r(ce,ie)}return $e}var Yd=GC(!0),HC=GC(!1),mm={},Ja=eu(mm),Jp=eu(mm),$p=eu(mm);function ah(t){if(t===mm)throw Error(ht(174));return t}function Vb(t,i){switch(Mi($p,i),Mi(Jp,t),Mi(Ja,mm),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:mx(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=mx(i,t)}Li(Ja),Mi(Ja,i)}function Qd(){Li(Ja),Li(Jp),Li($p)}function VC(t){ah($p.current);var i=ah(Ja.current),r=mx(i,t.type);i!==r&&(Mi(Jp,t),Mi(Ja,r))}function Wb(t){Jp.current===t&&(Li(Ja),Li(Jp))}var Wi=eu(0);function Pv(t){for(var i=t;i!==null;){if(i.tag===13){var r=i.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var O_=[];function jb(){for(var t=0;t<O_.length;t++)O_[t]._workInProgressVersionPrimary=null;O_.length=0}var rv=Wl.ReactCurrentDispatcher,F_=Wl.ReactCurrentBatchConfig,ph=0,Xi=null,Rr=null,kr=null,Rv=!1,Lp=!1,em=0,nB=0;function ls(){throw Error(ht(321))}function Xb(t,i){if(i===null)return!1;for(var r=0;r<i.length&&r<t.length;r++)if(!_a(t[r],i[r]))return!1;return!0}function Yb(t,i,r,o,p,y){if(ph=y,Xi=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,rv.current=t===null||t.memoizedState===null?oB:aB,t=r(o,p),Lp){y=0;do{if(Lp=!1,em=0,25<=y)throw Error(ht(301));y+=1,kr=Rr=null,i.updateQueue=null,rv.current=lB,t=r(o,p)}while(Lp)}if(rv.current=Dv,i=Rr!==null&&Rr.next!==null,ph=0,kr=Rr=Xi=null,Rv=!1,i)throw Error(ht(300));return t}function Qb(){var t=em!==0;return em=0,t}function Ka(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Xi.memoizedState=kr=t:kr=kr.next=t,kr}function Go(){if(Rr===null){var t=Xi.alternate;t=t!==null?t.memoizedState:null}else t=Rr.next;var i=kr===null?Xi.memoizedState:kr.next;if(i!==null)kr=i,Rr=t;else{if(t===null)throw Error(ht(310));Rr=t,t={memoizedState:Rr.memoizedState,baseState:Rr.baseState,baseQueue:Rr.baseQueue,queue:Rr.queue,next:null},kr===null?Xi.memoizedState=kr=t:kr=kr.next=t}return kr}function tm(t,i){return typeof i=="function"?i(t):i}function B_(t){var i=Go(),r=i.queue;if(r===null)throw Error(ht(311));r.lastRenderedReducer=t;var o=Rr,p=o.baseQueue,y=r.pending;if(y!==null){if(p!==null){var d=p.next;p.next=y.next,y.next=d}o.baseQueue=p=y,r.pending=null}if(p!==null){y=p.next,o=o.baseState;var E=d=null,L=null,k=y;do{var X=k.lane;if((ph&X)===X)L!==null&&(L=L.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),o=k.hasEagerState?k.eagerState:t(o,k.action);else{var $={lane:X,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};L===null?(E=L=$,d=o):L=L.next=$,Xi.lanes|=X,mh|=X}k=k.next}while(k!==null&&k!==y);L===null?d=o:L.next=E,_a(o,i.memoizedState)||(Us=!0),i.memoizedState=o,i.baseState=d,i.baseQueue=L,r.lastRenderedState=o}if(t=r.interleaved,t!==null){p=t;do y=p.lane,Xi.lanes|=y,mh|=y,p=p.next;while(p!==t)}else p===null&&(r.lanes=0);return[i.memoizedState,r.dispatch]}function k_(t){var i=Go(),r=i.queue;if(r===null)throw Error(ht(311));r.lastRenderedReducer=t;var o=r.dispatch,p=r.pending,y=i.memoizedState;if(p!==null){r.pending=null;var d=p=p.next;do y=t(y,d.action),d=d.next;while(d!==p);_a(y,i.memoizedState)||(Us=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),r.lastRenderedState=y}return[y,o]}function WC(){}function jC(t,i){var r=Xi,o=Go(),p=i(),y=!_a(o.memoizedState,p);if(y&&(o.memoizedState=p,Us=!0),o=o.queue,Kb(QC.bind(null,r,o,t),[t]),o.getSnapshot!==i||y||kr!==null&&kr.memoizedState.tag&1){if(r.flags|=2048,nm(9,YC.bind(null,r,o,p,i),void 0,null),Ur===null)throw Error(ht(349));ph&30||XC(r,i,p)}return p}function XC(t,i,r){t.flags|=16384,t={getSnapshot:i,value:r},i=Xi.updateQueue,i===null?(i={lastEffect:null,stores:null},Xi.updateQueue=i,i.stores=[t]):(r=i.stores,r===null?i.stores=[t]:r.push(t))}function YC(t,i,r,o){i.value=r,i.getSnapshot=o,KC(i)&&qC(t)}function QC(t,i,r){return r(function(){KC(i)&&qC(t)})}function KC(t){var i=t.getSnapshot;t=t.value;try{var r=i();return!_a(t,r)}catch{return!0}}function qC(t){var i=Hl(t,1);i!==null&&ya(i,t,1,-1)}function DM(t){var i=Ka();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tm,lastRenderedState:t},i.queue=t,t=t.dispatch=sB.bind(null,Xi,t),[i.memoizedState,t]}function nm(t,i,r,o){return t={tag:t,create:i,destroy:r,deps:o,next:null},i=Xi.updateQueue,i===null?(i={lastEffect:null,stores:null},Xi.updateQueue=i,i.lastEffect=t.next=t):(r=i.lastEffect,r===null?i.lastEffect=t.next=t:(o=r.next,r.next=t,t.next=o,i.lastEffect=t)),t}function ZC(){return Go().memoizedState}function sv(t,i,r,o){var p=Ka();Xi.flags|=t,p.memoizedState=nm(1|i,r,void 0,o===void 0?null:o)}function Jv(t,i,r,o){var p=Go();o=o===void 0?null:o;var y=void 0;if(Rr!==null){var d=Rr.memoizedState;if(y=d.destroy,o!==null&&Xb(o,d.deps)){p.memoizedState=nm(i,r,y,o);return}}Xi.flags|=t,p.memoizedState=nm(1|i,r,y,o)}function IM(t,i){return sv(8390656,8,t,i)}function Kb(t,i){return Jv(2048,8,t,i)}function JC(t,i){return Jv(4,2,t,i)}function $C(t,i){return Jv(4,4,t,i)}function eP(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function tP(t,i,r){return r=r!=null?r.concat([t]):null,Jv(4,4,eP.bind(null,i,t),r)}function qb(){}function nP(t,i){var r=Go();i=i===void 0?null:i;var o=r.memoizedState;return o!==null&&i!==null&&Xb(i,o[1])?o[0]:(r.memoizedState=[t,i],t)}function iP(t,i){var r=Go();i=i===void 0?null:i;var o=r.memoizedState;return o!==null&&i!==null&&Xb(i,o[1])?o[0]:(t=t(),r.memoizedState=[t,i],t)}function rP(t,i,r){return ph&21?(_a(r,i)||(r=aC(),Xi.lanes|=r,mh|=r,t.baseState=!0),i):(t.baseState&&(t.baseState=!1,Us=!0),t.memoizedState=r)}function iB(t,i){var r=di;di=r!==0&&4>r?r:4,t(!0);var o=F_.transition;F_.transition={};try{t(!1),i()}finally{di=r,F_.transition=o}}function sP(){return Go().memoizedState}function rB(t,i,r){var o=jc(t);if(r={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null},oP(t))aP(i,r);else if(r=kC(t,i,r,o),r!==null){var p=Cs();ya(r,t,o,p),lP(r,i,o)}}function sB(t,i,r){var o=jc(t),p={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null};if(oP(t))aP(i,p);else{var y=t.alternate;if(t.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var d=i.lastRenderedState,E=y(d,r);if(p.hasEagerState=!0,p.eagerState=E,_a(E,d)){var L=i.interleaved;L===null?(p.next=p,Gb(i)):(p.next=L.next,L.next=p),i.interleaved=p;return}}catch{}finally{}r=kC(t,i,p,o),r!==null&&(p=Cs(),ya(r,t,o,p),lP(r,i,o))}}function oP(t){var i=t.alternate;return t===Xi||i!==null&&i===Xi}function aP(t,i){Lp=Rv=!0;var r=t.pending;r===null?i.next=i:(i.next=r.next,r.next=i),t.pending=i}function lP(t,i,r){if(r&4194240){var o=i.lanes;o&=t.pendingLanes,r|=o,i.lanes=r,Tb(t,r)}}var Dv={readContext:zo,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useInsertionEffect:ls,useLayoutEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useMutableSource:ls,useSyncExternalStore:ls,useId:ls,unstable_isNewReconciler:!1},oB={readContext:zo,useCallback:function(t,i){return Ka().memoizedState=[t,i===void 0?null:i],t},useContext:zo,useEffect:IM,useImperativeHandle:function(t,i,r){return r=r!=null?r.concat([t]):null,sv(4194308,4,eP.bind(null,i,t),r)},useLayoutEffect:function(t,i){return sv(4194308,4,t,i)},useInsertionEffect:function(t,i){return sv(4,2,t,i)},useMemo:function(t,i){var r=Ka();return i=i===void 0?null:i,t=t(),r.memoizedState=[t,i],t},useReducer:function(t,i,r){var o=Ka();return i=r!==void 0?r(i):i,o.memoizedState=o.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},o.queue=t,t=t.dispatch=rB.bind(null,Xi,t),[o.memoizedState,t]},useRef:function(t){var i=Ka();return t={current:t},i.memoizedState=t},useState:DM,useDebugValue:qb,useDeferredValue:function(t){return Ka().memoizedState=t},useTransition:function(){var t=DM(!1),i=t[0];return t=iB.bind(null,t[1]),Ka().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,r){var o=Xi,p=Ka();if(Gi){if(r===void 0)throw Error(ht(407));r=r()}else{if(r=i(),Ur===null)throw Error(ht(349));ph&30||XC(o,i,r)}p.memoizedState=r;var y={value:r,getSnapshot:i};return p.queue=y,IM(QC.bind(null,o,y,t),[t]),o.flags|=2048,nm(9,YC.bind(null,o,y,r,i),void 0,null),r},useId:function(){var t=Ka(),i=Ur.identifierPrefix;if(Gi){var r=Il,o=Dl;r=(o&~(1<<32-va(o)-1)).toString(32)+r,i=":"+i+"R"+r,r=em++,0<r&&(i+="H"+r.toString(32)),i+=":"}else r=nB++,i=":"+i+"r"+r.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},aB={readContext:zo,useCallback:nP,useContext:zo,useEffect:Kb,useImperativeHandle:tP,useInsertionEffect:JC,useLayoutEffect:$C,useMemo:iP,useReducer:B_,useRef:ZC,useState:function(){return B_(tm)},useDebugValue:qb,useDeferredValue:function(t){var i=Go();return rP(i,Rr.memoizedState,t)},useTransition:function(){var t=B_(tm)[0],i=Go().memoizedState;return[t,i]},useMutableSource:WC,useSyncExternalStore:jC,useId:sP,unstable_isNewReconciler:!1},lB={readContext:zo,useCallback:nP,useContext:zo,useEffect:Kb,useImperativeHandle:tP,useInsertionEffect:JC,useLayoutEffect:$C,useMemo:iP,useReducer:k_,useRef:ZC,useState:function(){return k_(tm)},useDebugValue:qb,useDeferredValue:function(t){var i=Go();return Rr===null?i.memoizedState=t:rP(i,Rr.memoizedState,t)},useTransition:function(){var t=k_(tm)[0],i=Go().memoizedState;return[t,i]},useMutableSource:WC,useSyncExternalStore:jC,useId:sP,unstable_isNewReconciler:!1};function Kd(t,i){try{var r="",o=i;do r+=BO(o),o=o.return;while(o);var p=r}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:t,source:i,stack:p,digest:null}}function U_(t,i,r){return{value:t,source:null,stack:r??null,digest:i??null}}function Ux(t,i){try{console.error(i.value)}catch(r){setTimeout(function(){throw r})}}var cB=typeof WeakMap=="function"?WeakMap:Map;function cP(t,i,r){r=Ol(-1,r),r.tag=3,r.payload={element:null};var o=i.value;return r.callback=function(){Lv||(Lv=!0,Qx=o),Ux(t,i)},r}function uP(t,i,r){r=Ol(-1,r),r.tag=3;var o=t.type.getDerivedStateFromError;if(typeof o=="function"){var p=i.value;r.payload=function(){return o(p)},r.callback=function(){Ux(t,i)}}var y=t.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(r.callback=function(){Ux(t,i),typeof o!="function"&&(Wc===null?Wc=new Set([this]):Wc.add(this));var d=i.stack;this.componentDidCatch(i.value,{componentStack:d!==null?d:""})}),r}function LM(t,i,r){var o=t.pingCache;if(o===null){o=t.pingCache=new cB;var p=new Set;o.set(i,p)}else p=o.get(i),p===void 0&&(p=new Set,o.set(i,p));p.has(r)||(p.add(r),t=AB.bind(null,t,i,r),i.then(t,t))}function OM(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function FM(t,i,r,o,p){return t.mode&1?(t.flags|=65536,t.lanes=p,t):(t===i?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(i=Ol(-1,1),i.tag=2,Vc(r,i,1))),r.lanes|=1),t)}var uB=Wl.ReactCurrentOwner,Us=!1;function Ts(t,i,r,o){i.child=t===null?HC(i,null,r,o):Yd(i,t.child,r,o)}function BM(t,i,r,o,p){r=r.render;var y=i.ref;return Hd(i,p),o=Yb(t,i,r,o,y,p),r=Qb(),t!==null&&!Us?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~p,Vl(t,i,p)):(Gi&&r&&Fb(i),i.flags|=1,Ts(t,i,o,p),i.child)}function kM(t,i,r,o,p){if(t===null){var y=r.type;return typeof y=="function"&&!rw(y)&&y.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(i.tag=15,i.type=y,hP(t,i,y,o,p)):(t=cv(r.type,null,o,i,i.mode,p),t.ref=i.ref,t.return=i,i.child=t)}if(y=t.child,!(t.lanes&p)){var d=y.memoizedProps;if(r=r.compare,r=r!==null?r:Qp,r(d,o)&&t.ref===i.ref)return Vl(t,i,p)}return i.flags|=1,t=Xc(y,o),t.ref=i.ref,t.return=i,i.child=t}function hP(t,i,r,o,p){if(t!==null){var y=t.memoizedProps;if(Qp(y,o)&&t.ref===i.ref)if(Us=!1,i.pendingProps=o=y,(t.lanes&p)!==0)t.flags&131072&&(Us=!0);else return i.lanes=t.lanes,Vl(t,i,p)}return Nx(t,i,r,o,p)}function dP(t,i,r){var o=i.pendingProps,p=o.children,y=t!==null?t.memoizedState:null;if(o.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(Ld,ao),ao|=r;else{if(!(r&1073741824))return t=y!==null?y.baseLanes|r:r,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,Mi(Ld,ao),ao|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=y!==null?y.baseLanes:r,Mi(Ld,ao),ao|=o}else y!==null?(o=y.baseLanes|r,i.memoizedState=null):o=r,Mi(Ld,ao),ao|=o;return Ts(t,i,p,r),i.child}function fP(t,i){var r=i.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(i.flags|=512,i.flags|=2097152)}function Nx(t,i,r,o,p){var y=zs(r)?dh:ps.current;return y=jd(i,y),Hd(i,p),r=Yb(t,i,r,o,y,p),o=Qb(),t!==null&&!Us?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~p,Vl(t,i,p)):(Gi&&o&&Fb(i),i.flags|=1,Ts(t,i,r,p),i.child)}function UM(t,i,r,o,p){if(zs(r)){var y=!0;Av(i)}else y=!1;if(Hd(i,p),i.stateNode===null)ov(t,i),zC(i,r,o),kx(i,r,o,p),o=!0;else if(t===null){var d=i.stateNode,E=i.memoizedProps;d.props=E;var L=d.context,k=r.contextType;typeof k=="object"&&k!==null?k=zo(k):(k=zs(r)?dh:ps.current,k=jd(i,k));var X=r.getDerivedStateFromProps,$=typeof X=="function"||typeof d.getSnapshotBeforeUpdate=="function";$||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(E!==o||L!==k)&&PM(i,d,o,k),Lc=!1;var Z=i.memoizedState;d.state=Z,Cv(i,o,d,p),L=i.memoizedState,E!==o||Z!==L||Ns.current||Lc?(typeof X=="function"&&(Bx(i,r,X,o),L=i.memoizedState),(E=Lc||CM(i,r,E,o,Z,L,k))?($||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(i.flags|=4194308)):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=o,i.memoizedState=L),d.props=o,d.state=L,d.context=k,o=E):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),o=!1)}else{d=i.stateNode,UC(t,i),E=i.memoizedProps,k=i.type===i.elementType?E:da(i.type,E),d.props=k,$=i.pendingProps,Z=d.context,L=r.contextType,typeof L=="object"&&L!==null?L=zo(L):(L=zs(r)?dh:ps.current,L=jd(i,L));var ge=r.getDerivedStateFromProps;(X=typeof ge=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(E!==$||Z!==L)&&PM(i,d,o,L),Lc=!1,Z=i.memoizedState,d.state=Z,Cv(i,o,d,p);var be=i.memoizedState;E!==$||Z!==be||Ns.current||Lc?(typeof ge=="function"&&(Bx(i,r,ge,o),be=i.memoizedState),(k=Lc||CM(i,r,k,o,Z,be,L)||!1)?(X||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,be,L),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,be,L)),typeof d.componentDidUpdate=="function"&&(i.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof d.componentDidUpdate!="function"||E===t.memoizedProps&&Z===t.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&Z===t.memoizedState||(i.flags|=1024),i.memoizedProps=o,i.memoizedState=be),d.props=o,d.state=be,d.context=L,o=k):(typeof d.componentDidUpdate!="function"||E===t.memoizedProps&&Z===t.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&Z===t.memoizedState||(i.flags|=1024),o=!1)}return zx(t,i,r,o,y,p)}function zx(t,i,r,o,p,y){fP(t,i);var d=(i.flags&128)!==0;if(!o&&!d)return p&&AM(i,r,!1),Vl(t,i,y);o=i.stateNode,uB.current=i;var E=d&&typeof r.getDerivedStateFromError!="function"?null:o.render();return i.flags|=1,t!==null&&d?(i.child=Yd(i,t.child,null,y),i.child=Yd(i,null,E,y)):Ts(t,i,E,y),i.memoizedState=o.state,p&&AM(i,r,!0),i.child}function pP(t){var i=t.stateNode;i.pendingContext?wM(t,i.pendingContext,i.pendingContext!==i.context):i.context&&wM(t,i.context,!1),Vb(t,i.containerInfo)}function NM(t,i,r,o,p){return Xd(),kb(p),i.flags|=256,Ts(t,i,r,o),i.child}var Gx={dehydrated:null,treeContext:null,retryLane:0};function Hx(t){return{baseLanes:t,cachePool:null,transitions:null}}function mP(t,i,r){var o=i.pendingProps,p=Wi.current,y=!1,d=(i.flags&128)!==0,E;if((E=d)||(E=t!==null&&t.memoizedState===null?!1:(p&2)!==0),E?(y=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(p|=1),Mi(Wi,p&1),t===null)return Ox(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(i.mode&1?t.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(d=o.children,t=o.fallback,y?(o=i.mode,y=i.child,d={mode:"hidden",children:d},!(o&1)&&y!==null?(y.childLanes=0,y.pendingProps=d):y=t0(d,o,0,null),t=uh(t,o,r,null),y.return=i,t.return=i,y.sibling=t,i.child=y,i.child.memoizedState=Hx(r),i.memoizedState=Gx,t):Zb(i,d));if(p=t.memoizedState,p!==null&&(E=p.dehydrated,E!==null))return hB(t,i,d,o,E,p,r);if(y){y=o.fallback,d=i.mode,p=t.child,E=p.sibling;var L={mode:"hidden",children:o.children};return!(d&1)&&i.child!==p?(o=i.child,o.childLanes=0,o.pendingProps=L,i.deletions=null):(o=Xc(p,L),o.subtreeFlags=p.subtreeFlags&14680064),E!==null?y=Xc(E,y):(y=uh(y,d,r,null),y.flags|=2),y.return=i,o.return=i,o.sibling=y,i.child=o,o=y,y=i.child,d=t.child.memoizedState,d=d===null?Hx(r):{baseLanes:d.baseLanes|r,cachePool:null,transitions:d.transitions},y.memoizedState=d,y.childLanes=t.childLanes&~r,i.memoizedState=Gx,o}return y=t.child,t=y.sibling,o=Xc(y,{mode:"visible",children:o.children}),!(i.mode&1)&&(o.lanes=r),o.return=i,o.sibling=null,t!==null&&(r=i.deletions,r===null?(i.deletions=[t],i.flags|=16):r.push(t)),i.child=o,i.memoizedState=null,o}function Zb(t,i){return i=t0({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function jg(t,i,r,o){return o!==null&&kb(o),Yd(i,t.child,null,r),t=Zb(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function hB(t,i,r,o,p,y,d){if(r)return i.flags&256?(i.flags&=-257,o=U_(Error(ht(422))),jg(t,i,d,o)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(y=o.fallback,p=i.mode,o=t0({mode:"visible",children:o.children},p,0,null),y=uh(y,p,d,null),y.flags|=2,o.return=i,y.return=i,o.sibling=y,i.child=o,i.mode&1&&Yd(i,t.child,null,d),i.child.memoizedState=Hx(d),i.memoizedState=Gx,y);if(!(i.mode&1))return jg(t,i,d,null);if(p.data==="$!"){if(o=p.nextSibling&&p.nextSibling.dataset,o)var E=o.dgst;return o=E,y=Error(ht(419)),o=U_(y,o,void 0),jg(t,i,d,o)}if(E=(d&t.childLanes)!==0,Us||E){if(o=Ur,o!==null){switch(d&-d){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=p&(o.suspendedLanes|d)?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,Hl(t,p),ya(o,t,p,-1))}return iw(),o=U_(Error(ht(421))),jg(t,i,d,o)}return p.data==="$?"?(i.flags|=128,i.child=t.child,i=SB.bind(null,t),p._reactRetry=i,null):(t=y.treeContext,co=Hc(p.nextSibling),uo=i,Gi=!0,ma=null,t!==null&&(Bo[ko++]=Dl,Bo[ko++]=Il,Bo[ko++]=fh,Dl=t.id,Il=t.overflow,fh=i),i=Zb(i,o.children),i.flags|=4096,i)}function zM(t,i,r){t.lanes|=i;var o=t.alternate;o!==null&&(o.lanes|=i),Fx(t.return,i,r)}function N_(t,i,r,o,p){var y=t.memoizedState;y===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=o,y.tail=r,y.tailMode=p)}function gP(t,i,r){var o=i.pendingProps,p=o.revealOrder,y=o.tail;if(Ts(t,i,o.children,r),o=Wi.current,o&2)o=o&1|2,i.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zM(t,r,i);else if(t.tag===19)zM(t,r,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}o&=1}if(Mi(Wi,o),!(i.mode&1))i.memoizedState=null;else switch(p){case"forwards":for(r=i.child,p=null;r!==null;)t=r.alternate,t!==null&&Pv(t)===null&&(p=r),r=r.sibling;r=p,r===null?(p=i.child,i.child=null):(p=r.sibling,r.sibling=null),N_(i,!1,p,r,y);break;case"backwards":for(r=null,p=i.child,i.child=null;p!==null;){if(t=p.alternate,t!==null&&Pv(t)===null){i.child=p;break}t=p.sibling,p.sibling=r,r=p,p=t}N_(i,!0,r,null,y);break;case"together":N_(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ov(t,i){!(i.mode&1)&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function Vl(t,i,r){if(t!==null&&(i.dependencies=t.dependencies),mh|=i.lanes,!(r&i.childLanes))return null;if(t!==null&&i.child!==t.child)throw Error(ht(153));if(i.child!==null){for(t=i.child,r=Xc(t,t.pendingProps),i.child=r,r.return=i;t.sibling!==null;)t=t.sibling,r=r.sibling=Xc(t,t.pendingProps),r.return=i;r.sibling=null}return i.child}function dB(t,i,r){switch(i.tag){case 3:pP(i),Xd();break;case 5:VC(i);break;case 1:zs(i.type)&&Av(i);break;case 4:Vb(i,i.stateNode.containerInfo);break;case 10:var o=i.type._context,p=i.memoizedProps.value;Mi(Ev,o._currentValue),o._currentValue=p;break;case 13:if(o=i.memoizedState,o!==null)return o.dehydrated!==null?(Mi(Wi,Wi.current&1),i.flags|=128,null):r&i.child.childLanes?mP(t,i,r):(Mi(Wi,Wi.current&1),t=Vl(t,i,r),t!==null?t.sibling:null);Mi(Wi,Wi.current&1);break;case 19:if(o=(r&i.childLanes)!==0,t.flags&128){if(o)return gP(t,i,r);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Mi(Wi,Wi.current),o)break;return null;case 22:case 23:return i.lanes=0,dP(t,i,r)}return Vl(t,i,r)}var vP,Vx,yP,_P;vP=function(t,i){for(var r=i.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Vx=function(){};yP=function(t,i,r,o){var p=t.memoizedProps;if(p!==o){t=i.stateNode,ah(Ja.current);var y=null;switch(r){case"input":p=hx(t,p),o=hx(t,o),y=[];break;case"select":p=Yi({},p,{value:void 0}),o=Yi({},o,{value:void 0}),y=[];break;case"textarea":p=px(t,p),o=px(t,o),y=[];break;default:typeof p.onClick!="function"&&typeof o.onClick=="function"&&(t.onclick=bv)}gx(r,o);var d;r=null;for(k in p)if(!o.hasOwnProperty(k)&&p.hasOwnProperty(k)&&p[k]!=null)if(k==="style"){var E=p[k];for(d in E)E.hasOwnProperty(d)&&(r||(r={}),r[d]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(Gp.hasOwnProperty(k)?y||(y=[]):(y=y||[]).push(k,null));for(k in o){var L=o[k];if(E=p!=null?p[k]:void 0,o.hasOwnProperty(k)&&L!==E&&(L!=null||E!=null))if(k==="style")if(E){for(d in E)!E.hasOwnProperty(d)||L&&L.hasOwnProperty(d)||(r||(r={}),r[d]="");for(d in L)L.hasOwnProperty(d)&&E[d]!==L[d]&&(r||(r={}),r[d]=L[d])}else r||(y||(y=[]),y.push(k,r)),r=L;else k==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,E=E?E.__html:void 0,L!=null&&E!==L&&(y=y||[]).push(k,L)):k==="children"?typeof L!="string"&&typeof L!="number"||(y=y||[]).push(k,""+L):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(Gp.hasOwnProperty(k)?(L!=null&&k==="onScroll"&&Ii("scroll",t),y||E===L||(y=[])):(y=y||[]).push(k,L))}r&&(y=y||[]).push("style",r);var k=y;(i.updateQueue=k)&&(i.flags|=4)}};_P=function(t,i,r,o){r!==o&&(i.flags|=4)};function yp(t,i){if(!Gi)switch(t.tailMode){case"hidden":i=t.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:o.sibling=null}}function cs(t){var i=t.alternate!==null&&t.alternate.child===t.child,r=0,o=0;if(i)for(var p=t.child;p!==null;)r|=p.lanes|p.childLanes,o|=p.subtreeFlags&14680064,o|=p.flags&14680064,p.return=t,p=p.sibling;else for(p=t.child;p!==null;)r|=p.lanes|p.childLanes,o|=p.subtreeFlags,o|=p.flags,p.return=t,p=p.sibling;return t.subtreeFlags|=o,t.childLanes=r,i}function fB(t,i,r){var o=i.pendingProps;switch(Bb(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cs(i),null;case 1:return zs(i.type)&&wv(),cs(i),null;case 3:return o=i.stateNode,Qd(),Li(Ns),Li(ps),jb(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Vg(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,ma!==null&&(Zx(ma),ma=null))),Vx(t,i),cs(i),null;case 5:Wb(i);var p=ah($p.current);if(r=i.type,t!==null&&i.stateNode!=null)yP(t,i,r,o,p),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!o){if(i.stateNode===null)throw Error(ht(166));return cs(i),null}if(t=ah(Ja.current),Vg(i)){o=i.stateNode,r=i.type;var y=i.memoizedProps;switch(o[qa]=i,o[Zp]=y,t=(i.mode&1)!==0,r){case"dialog":Ii("cancel",o),Ii("close",o);break;case"iframe":case"object":case"embed":Ii("load",o);break;case"video":case"audio":for(p=0;p<Ep.length;p++)Ii(Ep[p],o);break;case"source":Ii("error",o);break;case"img":case"image":case"link":Ii("error",o),Ii("load",o);break;case"details":Ii("toggle",o);break;case"input":KS(o,y),Ii("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!y.multiple},Ii("invalid",o);break;case"textarea":ZS(o,y),Ii("invalid",o)}gx(r,y),p=null;for(var d in y)if(y.hasOwnProperty(d)){var E=y[d];d==="children"?typeof E=="string"?o.textContent!==E&&(y.suppressHydrationWarning!==!0&&Hg(o.textContent,E,t),p=["children",E]):typeof E=="number"&&o.textContent!==""+E&&(y.suppressHydrationWarning!==!0&&Hg(o.textContent,E,t),p=["children",""+E]):Gp.hasOwnProperty(d)&&E!=null&&d==="onScroll"&&Ii("scroll",o)}switch(r){case"input":Og(o),qS(o,y,!0);break;case"textarea":Og(o),JS(o);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(o.onclick=bv)}o=p,i.updateQueue=o,o!==null&&(i.flags|=4)}else{d=p.nodeType===9?p:p.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=XT(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof o.is=="string"?t=d.createElement(r,{is:o.is}):(t=d.createElement(r),r==="select"&&(d=t,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):t=d.createElementNS(t,r),t[qa]=i,t[Zp]=o,vP(t,i,!1,!1),i.stateNode=t;e:{switch(d=vx(r,o),r){case"dialog":Ii("cancel",t),Ii("close",t),p=o;break;case"iframe":case"object":case"embed":Ii("load",t),p=o;break;case"video":case"audio":for(p=0;p<Ep.length;p++)Ii(Ep[p],t);p=o;break;case"source":Ii("error",t),p=o;break;case"img":case"image":case"link":Ii("error",t),Ii("load",t),p=o;break;case"details":Ii("toggle",t),p=o;break;case"input":KS(t,o),p=hx(t,o),Ii("invalid",t);break;case"option":p=o;break;case"select":t._wrapperState={wasMultiple:!!o.multiple},p=Yi({},o,{value:void 0}),Ii("invalid",t);break;case"textarea":ZS(t,o),p=px(t,o),Ii("invalid",t);break;default:p=o}gx(r,p),E=p;for(y in E)if(E.hasOwnProperty(y)){var L=E[y];y==="style"?KT(t,L):y==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&YT(t,L)):y==="children"?typeof L=="string"?(r!=="textarea"||L!=="")&&Hp(t,L):typeof L=="number"&&Hp(t,""+L):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(Gp.hasOwnProperty(y)?L!=null&&y==="onScroll"&&Ii("scroll",t):L!=null&&bb(t,y,L,d))}switch(r){case"input":Og(t),qS(t,o,!1);break;case"textarea":Og(t),JS(t);break;case"option":o.value!=null&&t.setAttribute("value",""+Qc(o.value));break;case"select":t.multiple=!!o.multiple,y=o.value,y!=null?Ud(t,!!o.multiple,y,!1):o.defaultValue!=null&&Ud(t,!!o.multiple,o.defaultValue,!0);break;default:typeof p.onClick=="function"&&(t.onclick=bv)}switch(r){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return cs(i),null;case 6:if(t&&i.stateNode!=null)_P(t,i,t.memoizedProps,o);else{if(typeof o!="string"&&i.stateNode===null)throw Error(ht(166));if(r=ah($p.current),ah(Ja.current),Vg(i)){if(o=i.stateNode,r=i.memoizedProps,o[qa]=i,(y=o.nodeValue!==r)&&(t=uo,t!==null))switch(t.tag){case 3:Hg(o.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hg(o.nodeValue,r,(t.mode&1)!==0)}y&&(i.flags|=4)}else o=(r.nodeType===9?r:r.ownerDocument).createTextNode(o),o[qa]=i,i.stateNode=o}return cs(i),null;case 13:if(Li(Wi),o=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Gi&&co!==null&&i.mode&1&&!(i.flags&128))BC(),Xd(),i.flags|=98560,y=!1;else if(y=Vg(i),o!==null&&o.dehydrated!==null){if(t===null){if(!y)throw Error(ht(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(ht(317));y[qa]=i}else Xd(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;cs(i),y=!1}else ma!==null&&(Zx(ma),ma=null),y=!0;if(!y)return i.flags&65536?i:null}return i.flags&128?(i.lanes=r,i):(o=o!==null,o!==(t!==null&&t.memoizedState!==null)&&o&&(i.child.flags|=8192,i.mode&1&&(t===null||Wi.current&1?Dr===0&&(Dr=3):iw())),i.updateQueue!==null&&(i.flags|=4),cs(i),null);case 4:return Qd(),Vx(t,i),t===null&&Kp(i.stateNode.containerInfo),cs(i),null;case 10:return zb(i.type._context),cs(i),null;case 17:return zs(i.type)&&wv(),cs(i),null;case 19:if(Li(Wi),y=i.memoizedState,y===null)return cs(i),null;if(o=(i.flags&128)!==0,d=y.rendering,d===null)if(o)yp(y,!1);else{if(Dr!==0||t!==null&&t.flags&128)for(t=i.child;t!==null;){if(d=Pv(t),d!==null){for(i.flags|=128,yp(y,!1),o=d.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),i.subtreeFlags=0,o=r,r=i.child;r!==null;)y=r,t=o,y.flags&=14680066,d=y.alternate,d===null?(y.childLanes=0,y.lanes=t,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=d.childLanes,y.lanes=d.lanes,y.child=d.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=d.memoizedProps,y.memoizedState=d.memoizedState,y.updateQueue=d.updateQueue,y.type=d.type,t=d.dependencies,y.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Mi(Wi,Wi.current&1|2),i.child}t=t.sibling}y.tail!==null&&ar()>qd&&(i.flags|=128,o=!0,yp(y,!1),i.lanes=4194304)}else{if(!o)if(t=Pv(d),t!==null){if(i.flags|=128,o=!0,r=t.updateQueue,r!==null&&(i.updateQueue=r,i.flags|=4),yp(y,!0),y.tail===null&&y.tailMode==="hidden"&&!d.alternate&&!Gi)return cs(i),null}else 2*ar()-y.renderingStartTime>qd&&r!==1073741824&&(i.flags|=128,o=!0,yp(y,!1),i.lanes=4194304);y.isBackwards?(d.sibling=i.child,i.child=d):(r=y.last,r!==null?r.sibling=d:i.child=d,y.last=d)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=ar(),i.sibling=null,r=Wi.current,Mi(Wi,o?r&1|2:r&1),i):(cs(i),null);case 22:case 23:return nw(),o=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==o&&(i.flags|=8192),o&&i.mode&1?ao&1073741824&&(cs(i),i.subtreeFlags&6&&(i.flags|=8192)):cs(i),null;case 24:return null;case 25:return null}throw Error(ht(156,i.tag))}function pB(t,i){switch(Bb(i),i.tag){case 1:return zs(i.type)&&wv(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Qd(),Li(Ns),Li(ps),jb(),t=i.flags,t&65536&&!(t&128)?(i.flags=t&-65537|128,i):null;case 5:return Wb(i),null;case 13:if(Li(Wi),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(ht(340));Xd()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return Li(Wi),null;case 4:return Qd(),null;case 10:return zb(i.type._context),null;case 22:case 23:return nw(),null;case 24:return null;default:return null}}var Xg=!1,ds=!1,mB=typeof WeakSet=="function"?WeakSet:Set,jt=null;function Id(t,i){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(o){Ji(t,i,o)}else r.current=null}function Wx(t,i,r){try{r()}catch(o){Ji(t,i,o)}}var GM=!1;function gB(t,i){if(Tx=yv,t=AC(),Ob(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var p=o.anchorOffset,y=o.focusNode;o=o.focusOffset;try{r.nodeType,y.nodeType}catch{r=null;break e}var d=0,E=-1,L=-1,k=0,X=0,$=t,Z=null;t:for(;;){for(var ge;$!==r||p!==0&&$.nodeType!==3||(E=d+p),$!==y||o!==0&&$.nodeType!==3||(L=d+o),$.nodeType===3&&(d+=$.nodeValue.length),(ge=$.firstChild)!==null;)Z=$,$=ge;for(;;){if($===t)break t;if(Z===r&&++k===p&&(E=d),Z===y&&++X===o&&(L=d),(ge=$.nextSibling)!==null)break;$=Z,Z=$.parentNode}$=ge}r=E===-1||L===-1?null:{start:E,end:L}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cx={focusedElem:t,selectionRange:r},yv=!1,jt=i;jt!==null;)if(i=jt,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,jt=t;else for(;jt!==null;){i=jt;try{var be=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var ye=be.memoizedProps,$e=be.memoizedState,ce=i.stateNode,ie=ce.getSnapshotBeforeUpdate(i.elementType===i.type?ye:da(i.type,ye),$e);ce.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var U=i.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ht(163))}}catch(re){Ji(i,i.return,re)}if(t=i.sibling,t!==null){t.return=i.return,jt=t;break}jt=i.return}return be=GM,GM=!1,be}function Op(t,i,r){var o=i.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var p=o=o.next;do{if((p.tag&t)===t){var y=p.destroy;p.destroy=void 0,y!==void 0&&Wx(i,r,y)}p=p.next}while(p!==o)}}function $v(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var o=r.create;r.destroy=o()}r=r.next}while(r!==i)}}function jx(t){var i=t.ref;if(i!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof i=="function"?i(t):i.current=t}}function xP(t){var i=t.alternate;i!==null&&(t.alternate=null,xP(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[qa],delete i[Zp],delete i[Dx],delete i[JF],delete i[$F])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bP(t){return t.tag===5||t.tag===3||t.tag===4}function HM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xx(t,i,r){var o=t.tag;if(o===5||o===6)t=t.stateNode,i?r.nodeType===8?r.parentNode.insertBefore(t,i):r.insertBefore(t,i):(r.nodeType===8?(i=r.parentNode,i.insertBefore(t,r)):(i=r,i.appendChild(t)),r=r._reactRootContainer,r!=null||i.onclick!==null||(i.onclick=bv));else if(o!==4&&(t=t.child,t!==null))for(Xx(t,i,r),t=t.sibling;t!==null;)Xx(t,i,r),t=t.sibling}function Yx(t,i,r){var o=t.tag;if(o===5||o===6)t=t.stateNode,i?r.insertBefore(t,i):r.appendChild(t);else if(o!==4&&(t=t.child,t!==null))for(Yx(t,i,r),t=t.sibling;t!==null;)Yx(t,i,r),t=t.sibling}var Qr=null,pa=!1;function Pc(t,i,r){for(r=r.child;r!==null;)wP(t,i,r),r=r.sibling}function wP(t,i,r){if(Za&&typeof Za.onCommitFiberUnmount=="function")try{Za.onCommitFiberUnmount(jv,r)}catch{}switch(r.tag){case 5:ds||Id(r,i);case 6:var o=Qr,p=pa;Qr=null,Pc(t,i,r),Qr=o,pa=p,Qr!==null&&(pa?(t=Qr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Qr.removeChild(r.stateNode));break;case 18:Qr!==null&&(pa?(t=Qr,r=r.stateNode,t.nodeType===8?I_(t.parentNode,r):t.nodeType===1&&I_(t,r),Xp(t)):I_(Qr,r.stateNode));break;case 4:o=Qr,p=pa,Qr=r.stateNode.containerInfo,pa=!0,Pc(t,i,r),Qr=o,pa=p;break;case 0:case 11:case 14:case 15:if(!ds&&(o=r.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){p=o=o.next;do{var y=p,d=y.destroy;y=y.tag,d!==void 0&&(y&2||y&4)&&Wx(r,i,d),p=p.next}while(p!==o)}Pc(t,i,r);break;case 1:if(!ds&&(Id(r,i),o=r.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=r.memoizedProps,o.state=r.memoizedState,o.componentWillUnmount()}catch(E){Ji(r,i,E)}Pc(t,i,r);break;case 21:Pc(t,i,r);break;case 22:r.mode&1?(ds=(o=ds)||r.memoizedState!==null,Pc(t,i,r),ds=o):Pc(t,i,r);break;default:Pc(t,i,r)}}function VM(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new mB),i.forEach(function(o){var p=MB.bind(null,t,o);r.has(o)||(r.add(o),o.then(p,p))})}}function ha(t,i){var r=i.deletions;if(r!==null)for(var o=0;o<r.length;o++){var p=r[o];try{var y=t,d=i,E=d;e:for(;E!==null;){switch(E.tag){case 5:Qr=E.stateNode,pa=!1;break e;case 3:Qr=E.stateNode.containerInfo,pa=!0;break e;case 4:Qr=E.stateNode.containerInfo,pa=!0;break e}E=E.return}if(Qr===null)throw Error(ht(160));wP(y,d,p),Qr=null,pa=!1;var L=p.alternate;L!==null&&(L.return=null),p.return=null}catch(k){Ji(p,i,k)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)AP(i,t),i=i.sibling}function AP(t,i){var r=t.alternate,o=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ha(i,t),Qa(t),o&4){try{Op(3,t,t.return),$v(3,t)}catch(ye){Ji(t,t.return,ye)}try{Op(5,t,t.return)}catch(ye){Ji(t,t.return,ye)}}break;case 1:ha(i,t),Qa(t),o&512&&r!==null&&Id(r,r.return);break;case 5:if(ha(i,t),Qa(t),o&512&&r!==null&&Id(r,r.return),t.flags&32){var p=t.stateNode;try{Hp(p,"")}catch(ye){Ji(t,t.return,ye)}}if(o&4&&(p=t.stateNode,p!=null)){var y=t.memoizedProps,d=r!==null?r.memoizedProps:y,E=t.type,L=t.updateQueue;if(t.updateQueue=null,L!==null)try{E==="input"&&y.type==="radio"&&y.name!=null&&WT(p,y),vx(E,d);var k=vx(E,y);for(d=0;d<L.length;d+=2){var X=L[d],$=L[d+1];X==="style"?KT(p,$):X==="dangerouslySetInnerHTML"?YT(p,$):X==="children"?Hp(p,$):bb(p,X,$,k)}switch(E){case"input":dx(p,y);break;case"textarea":jT(p,y);break;case"select":var Z=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var ge=y.value;ge!=null?Ud(p,!!y.multiple,ge,!1):Z!==!!y.multiple&&(y.defaultValue!=null?Ud(p,!!y.multiple,y.defaultValue,!0):Ud(p,!!y.multiple,y.multiple?[]:"",!1))}p[Zp]=y}catch(ye){Ji(t,t.return,ye)}}break;case 6:if(ha(i,t),Qa(t),o&4){if(t.stateNode===null)throw Error(ht(162));p=t.stateNode,y=t.memoizedProps;try{p.nodeValue=y}catch(ye){Ji(t,t.return,ye)}}break;case 3:if(ha(i,t),Qa(t),o&4&&r!==null&&r.memoizedState.isDehydrated)try{Xp(i.containerInfo)}catch(ye){Ji(t,t.return,ye)}break;case 4:ha(i,t),Qa(t);break;case 13:ha(i,t),Qa(t),p=t.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(ew=ar())),o&4&&VM(t);break;case 22:if(X=r!==null&&r.memoizedState!==null,t.mode&1?(ds=(k=ds)||X,ha(i,t),ds=k):ha(i,t),Qa(t),o&8192){if(k=t.memoizedState!==null,(t.stateNode.isHidden=k)&&!X&&t.mode&1)for(jt=t,X=t.child;X!==null;){for($=jt=X;jt!==null;){switch(Z=jt,ge=Z.child,Z.tag){case 0:case 11:case 14:case 15:Op(4,Z,Z.return);break;case 1:Id(Z,Z.return);var be=Z.stateNode;if(typeof be.componentWillUnmount=="function"){o=Z,r=Z.return;try{i=o,be.props=i.memoizedProps,be.state=i.memoizedState,be.componentWillUnmount()}catch(ye){Ji(o,r,ye)}}break;case 5:Id(Z,Z.return);break;case 22:if(Z.memoizedState!==null){jM($);continue}}ge!==null?(ge.return=Z,jt=ge):jM($)}X=X.sibling}e:for(X=null,$=t;;){if($.tag===5){if(X===null){X=$;try{p=$.stateNode,k?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(E=$.stateNode,L=$.memoizedProps.style,d=L!=null&&L.hasOwnProperty("display")?L.display:null,E.style.display=QT("display",d))}catch(ye){Ji(t,t.return,ye)}}}else if($.tag===6){if(X===null)try{$.stateNode.nodeValue=k?"":$.memoizedProps}catch(ye){Ji(t,t.return,ye)}}else if(($.tag!==22&&$.tag!==23||$.memoizedState===null||$===t)&&$.child!==null){$.child.return=$,$=$.child;continue}if($===t)break e;for(;$.sibling===null;){if($.return===null||$.return===t)break e;X===$&&(X=null),$=$.return}X===$&&(X=null),$.sibling.return=$.return,$=$.sibling}}break;case 19:ha(i,t),Qa(t),o&4&&VM(t);break;case 21:break;default:ha(i,t),Qa(t)}}function Qa(t){var i=t.flags;if(i&2){try{e:{for(var r=t.return;r!==null;){if(bP(r)){var o=r;break e}r=r.return}throw Error(ht(160))}switch(o.tag){case 5:var p=o.stateNode;o.flags&32&&(Hp(p,""),o.flags&=-33);var y=HM(t);Yx(t,y,p);break;case 3:case 4:var d=o.stateNode.containerInfo,E=HM(t);Xx(t,E,d);break;default:throw Error(ht(161))}}catch(L){Ji(t,t.return,L)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function vB(t,i,r){jt=t,SP(t)}function SP(t,i,r){for(var o=(t.mode&1)!==0;jt!==null;){var p=jt,y=p.child;if(p.tag===22&&o){var d=p.memoizedState!==null||Xg;if(!d){var E=p.alternate,L=E!==null&&E.memoizedState!==null||ds;E=Xg;var k=ds;if(Xg=d,(ds=L)&&!k)for(jt=p;jt!==null;)d=jt,L=d.child,d.tag===22&&d.memoizedState!==null?XM(p):L!==null?(L.return=d,jt=L):XM(p);for(;y!==null;)jt=y,SP(y),y=y.sibling;jt=p,Xg=E,ds=k}WM(t)}else p.subtreeFlags&8772&&y!==null?(y.return=p,jt=y):WM(t)}}function WM(t){for(;jt!==null;){var i=jt;if(i.flags&8772){var r=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:ds||$v(5,i);break;case 1:var o=i.stateNode;if(i.flags&4&&!ds)if(r===null)o.componentDidMount();else{var p=i.elementType===i.type?r.memoizedProps:da(i.type,r.memoizedProps);o.componentDidUpdate(p,r.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&TM(i,y,o);break;case 3:var d=i.updateQueue;if(d!==null){if(r=null,i.child!==null)switch(i.child.tag){case 5:r=i.child.stateNode;break;case 1:r=i.child.stateNode}TM(i,d,r)}break;case 5:var E=i.stateNode;if(r===null&&i.flags&4){r=E;var L=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&r.focus();break;case"img":L.src&&(r.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var k=i.alternate;if(k!==null){var X=k.memoizedState;if(X!==null){var $=X.dehydrated;$!==null&&Xp($)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ht(163))}ds||i.flags&512&&jx(i)}catch(Z){Ji(i,i.return,Z)}}if(i===t){jt=null;break}if(r=i.sibling,r!==null){r.return=i.return,jt=r;break}jt=i.return}}function jM(t){for(;jt!==null;){var i=jt;if(i===t){jt=null;break}var r=i.sibling;if(r!==null){r.return=i.return,jt=r;break}jt=i.return}}function XM(t){for(;jt!==null;){var i=jt;try{switch(i.tag){case 0:case 11:case 15:var r=i.return;try{$v(4,i)}catch(L){Ji(i,r,L)}break;case 1:var o=i.stateNode;if(typeof o.componentDidMount=="function"){var p=i.return;try{o.componentDidMount()}catch(L){Ji(i,p,L)}}var y=i.return;try{jx(i)}catch(L){Ji(i,y,L)}break;case 5:var d=i.return;try{jx(i)}catch(L){Ji(i,d,L)}}}catch(L){Ji(i,i.return,L)}if(i===t){jt=null;break}var E=i.sibling;if(E!==null){E.return=i.return,jt=E;break}jt=i.return}}var yB=Math.ceil,Iv=Wl.ReactCurrentDispatcher,Jb=Wl.ReactCurrentOwner,No=Wl.ReactCurrentBatchConfig,Qn=0,Ur=null,mr=null,qr=0,ao=0,Ld=eu(0),Dr=0,im=null,mh=0,e0=0,$b=0,Fp=null,ks=null,ew=0,qd=1/0,Pl=null,Lv=!1,Qx=null,Wc=null,Yg=!1,Uc=null,Ov=0,Bp=0,Kx=null,av=-1,lv=0;function Cs(){return Qn&6?ar():av!==-1?av:av=ar()}function jc(t){return t.mode&1?Qn&2&&qr!==0?qr&-qr:tB.transition!==null?(lv===0&&(lv=aC()),lv):(t=di,t!==0||(t=window.event,t=t===void 0?16:pC(t.type)),t):1}function ya(t,i,r,o){if(50<Bp)throw Bp=0,Kx=null,Error(ht(185));dm(t,r,o),(!(Qn&2)||t!==Ur)&&(t===Ur&&(!(Qn&2)&&(e0|=r),Dr===4&&Bc(t,qr)),Gs(t,o),r===1&&Qn===0&&!(i.mode&1)&&(qd=ar()+500,qv&&tu()))}function Gs(t,i){var r=t.callbackNode;tF(t,i);var o=vv(t,t===Ur?qr:0);if(o===0)r!==null&&tM(r),t.callbackNode=null,t.callbackPriority=0;else if(i=o&-o,t.callbackPriority!==i){if(r!=null&&tM(r),i===1)t.tag===0?eB(YM.bind(null,t)):LC(YM.bind(null,t)),qF(function(){!(Qn&6)&&tu()}),r=null;else{switch(lC(o)){case 1:r=Eb;break;case 4:r=sC;break;case 16:r=gv;break;case 536870912:r=oC;break;default:r=gv}r=IP(r,MP.bind(null,t))}t.callbackPriority=i,t.callbackNode=r}}function MP(t,i){if(av=-1,lv=0,Qn&6)throw Error(ht(327));var r=t.callbackNode;if(Vd()&&t.callbackNode!==r)return null;var o=vv(t,t===Ur?qr:0);if(o===0)return null;if(o&30||o&t.expiredLanes||i)i=Fv(t,o);else{i=o;var p=Qn;Qn|=2;var y=TP();(Ur!==t||qr!==i)&&(Pl=null,qd=ar()+500,ch(t,i));do try{bB();break}catch(E){EP(t,E)}while(1);Nb(),Iv.current=y,Qn=p,mr!==null?i=0:(Ur=null,qr=0,i=Dr)}if(i!==0){if(i===2&&(p=wx(t),p!==0&&(o=p,i=qx(t,p))),i===1)throw r=im,ch(t,0),Bc(t,o),Gs(t,ar()),r;if(i===6)Bc(t,o);else{if(p=t.current.alternate,!(o&30)&&!_B(p)&&(i=Fv(t,o),i===2&&(y=wx(t),y!==0&&(o=y,i=qx(t,y))),i===1))throw r=im,ch(t,0),Bc(t,o),Gs(t,ar()),r;switch(t.finishedWork=p,t.finishedLanes=o,i){case 0:case 1:throw Error(ht(345));case 2:th(t,ks,Pl);break;case 3:if(Bc(t,o),(o&130023424)===o&&(i=ew+500-ar(),10<i)){if(vv(t,0)!==0)break;if(p=t.suspendedLanes,(p&o)!==o){Cs(),t.pingedLanes|=t.suspendedLanes&p;break}t.timeoutHandle=Rx(th.bind(null,t,ks,Pl),i);break}th(t,ks,Pl);break;case 4:if(Bc(t,o),(o&4194240)===o)break;for(i=t.eventTimes,p=-1;0<o;){var d=31-va(o);y=1<<d,d=i[d],d>p&&(p=d),o&=~y}if(o=p,o=ar()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*yB(o/1960))-o,10<o){t.timeoutHandle=Rx(th.bind(null,t,ks,Pl),o);break}th(t,ks,Pl);break;case 5:th(t,ks,Pl);break;default:throw Error(ht(329))}}}return Gs(t,ar()),t.callbackNode===r?MP.bind(null,t):null}function qx(t,i){var r=Fp;return t.current.memoizedState.isDehydrated&&(ch(t,i).flags|=256),t=Fv(t,i),t!==2&&(i=ks,ks=r,i!==null&&Zx(i)),t}function Zx(t){ks===null?ks=t:ks.push.apply(ks,t)}function _B(t){for(var i=t;;){if(i.flags&16384){var r=i.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var o=0;o<r.length;o++){var p=r[o],y=p.getSnapshot;p=p.value;try{if(!_a(y(),p))return!1}catch{return!1}}}if(r=i.child,i.subtreeFlags&16384&&r!==null)r.return=i,i=r;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Bc(t,i){for(i&=~$b,i&=~e0,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var r=31-va(i),o=1<<r;t[r]=-1,i&=~o}}function YM(t){if(Qn&6)throw Error(ht(327));Vd();var i=vv(t,0);if(!(i&1))return Gs(t,ar()),null;var r=Fv(t,i);if(t.tag!==0&&r===2){var o=wx(t);o!==0&&(i=o,r=qx(t,o))}if(r===1)throw r=im,ch(t,0),Bc(t,i),Gs(t,ar()),r;if(r===6)throw Error(ht(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,th(t,ks,Pl),Gs(t,ar()),null}function tw(t,i){var r=Qn;Qn|=1;try{return t(i)}finally{Qn=r,Qn===0&&(qd=ar()+500,qv&&tu())}}function gh(t){Uc!==null&&Uc.tag===0&&!(Qn&6)&&Vd();var i=Qn;Qn|=1;var r=No.transition,o=di;try{if(No.transition=null,di=1,t)return t()}finally{di=o,No.transition=r,Qn=i,!(Qn&6)&&tu()}}function nw(){ao=Ld.current,Li(Ld)}function ch(t,i){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,KF(r)),mr!==null)for(r=mr.return;r!==null;){var o=r;switch(Bb(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&wv();break;case 3:Qd(),Li(Ns),Li(ps),jb();break;case 5:Wb(o);break;case 4:Qd();break;case 13:Li(Wi);break;case 19:Li(Wi);break;case 10:zb(o.type._context);break;case 22:case 23:nw()}r=r.return}if(Ur=t,mr=t=Xc(t.current,null),qr=ao=i,Dr=0,im=null,$b=e0=mh=0,ks=Fp=null,oh!==null){for(i=0;i<oh.length;i++)if(r=oh[i],o=r.interleaved,o!==null){r.interleaved=null;var p=o.next,y=r.pending;if(y!==null){var d=y.next;y.next=p,o.next=d}r.pending=o}oh=null}return t}function EP(t,i){do{var r=mr;try{if(Nb(),rv.current=Dv,Rv){for(var o=Xi.memoizedState;o!==null;){var p=o.queue;p!==null&&(p.pending=null),o=o.next}Rv=!1}if(ph=0,kr=Rr=Xi=null,Lp=!1,em=0,Jb.current=null,r===null||r.return===null){Dr=1,im=i,mr=null;break}e:{var y=t,d=r.return,E=r,L=i;if(i=qr,E.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var k=L,X=E,$=X.tag;if(!(X.mode&1)&&($===0||$===11||$===15)){var Z=X.alternate;Z?(X.updateQueue=Z.updateQueue,X.memoizedState=Z.memoizedState,X.lanes=Z.lanes):(X.updateQueue=null,X.memoizedState=null)}var ge=OM(d);if(ge!==null){ge.flags&=-257,FM(ge,d,E,y,i),ge.mode&1&&LM(y,k,i),i=ge,L=k;var be=i.updateQueue;if(be===null){var ye=new Set;ye.add(L),i.updateQueue=ye}else be.add(L);break e}else{if(!(i&1)){LM(y,k,i),iw();break e}L=Error(ht(426))}}else if(Gi&&E.mode&1){var $e=OM(d);if($e!==null){!($e.flags&65536)&&($e.flags|=256),FM($e,d,E,y,i),kb(Kd(L,E));break e}}y=L=Kd(L,E),Dr!==4&&(Dr=2),Fp===null?Fp=[y]:Fp.push(y),y=d;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var ce=cP(y,L,i);EM(y,ce);break e;case 1:E=L;var ie=y.type,U=y.stateNode;if(!(y.flags&128)&&(typeof ie.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(Wc===null||!Wc.has(U)))){y.flags|=65536,i&=-i,y.lanes|=i;var re=uP(y,E,i);EM(y,re);break e}}y=y.return}while(y!==null)}PP(r)}catch(ve){i=ve,mr===r&&r!==null&&(mr=r=r.return);continue}break}while(1)}function TP(){var t=Iv.current;return Iv.current=Dv,t===null?Dv:t}function iw(){(Dr===0||Dr===3||Dr===2)&&(Dr=4),Ur===null||!(mh&268435455)&&!(e0&268435455)||Bc(Ur,qr)}function Fv(t,i){var r=Qn;Qn|=2;var o=TP();(Ur!==t||qr!==i)&&(Pl=null,ch(t,i));do try{xB();break}catch(p){EP(t,p)}while(1);if(Nb(),Qn=r,Iv.current=o,mr!==null)throw Error(ht(261));return Ur=null,qr=0,Dr}function xB(){for(;mr!==null;)CP(mr)}function bB(){for(;mr!==null&&!XO();)CP(mr)}function CP(t){var i=DP(t.alternate,t,ao);t.memoizedProps=t.pendingProps,i===null?PP(t):mr=i,Jb.current=null}function PP(t){var i=t;do{var r=i.alternate;if(t=i.return,i.flags&32768){if(r=pB(r,i),r!==null){r.flags&=32767,mr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Dr=6,mr=null;return}}else if(r=fB(r,i,ao),r!==null){mr=r;return}if(i=i.sibling,i!==null){mr=i;return}mr=i=t}while(i!==null);Dr===0&&(Dr=5)}function th(t,i,r){var o=di,p=No.transition;try{No.transition=null,di=1,wB(t,i,r,o)}finally{No.transition=p,di=o}return null}function wB(t,i,r,o){do Vd();while(Uc!==null);if(Qn&6)throw Error(ht(327));r=t.finishedWork;var p=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ht(177));t.callbackNode=null,t.callbackPriority=0;var y=r.lanes|r.childLanes;if(nF(t,y),t===Ur&&(mr=Ur=null,qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Yg||(Yg=!0,IP(gv,function(){return Vd(),null})),y=(r.flags&15990)!==0,r.subtreeFlags&15990||y){y=No.transition,No.transition=null;var d=di;di=1;var E=Qn;Qn|=4,Jb.current=null,gB(t,r),AP(r,t),HF(Cx),yv=!!Tx,Cx=Tx=null,t.current=r,vB(r),YO(),Qn=E,di=d,No.transition=y}else t.current=r;if(Yg&&(Yg=!1,Uc=t,Ov=p),y=t.pendingLanes,y===0&&(Wc=null),qO(r.stateNode),Gs(t,ar()),i!==null)for(o=t.onRecoverableError,r=0;r<i.length;r++)p=i[r],o(p.value,{componentStack:p.stack,digest:p.digest});if(Lv)throw Lv=!1,t=Qx,Qx=null,t;return Ov&1&&t.tag!==0&&Vd(),y=t.pendingLanes,y&1?t===Kx?Bp++:(Bp=0,Kx=t):Bp=0,tu(),null}function Vd(){if(Uc!==null){var t=lC(Ov),i=No.transition,r=di;try{if(No.transition=null,di=16>t?16:t,Uc===null)var o=!1;else{if(t=Uc,Uc=null,Ov=0,Qn&6)throw Error(ht(331));var p=Qn;for(Qn|=4,jt=t.current;jt!==null;){var y=jt,d=y.child;if(jt.flags&16){var E=y.deletions;if(E!==null){for(var L=0;L<E.length;L++){var k=E[L];for(jt=k;jt!==null;){var X=jt;switch(X.tag){case 0:case 11:case 15:Op(8,X,y)}var $=X.child;if($!==null)$.return=X,jt=$;else for(;jt!==null;){X=jt;var Z=X.sibling,ge=X.return;if(xP(X),X===k){jt=null;break}if(Z!==null){Z.return=ge,jt=Z;break}jt=ge}}}var be=y.alternate;if(be!==null){var ye=be.child;if(ye!==null){be.child=null;do{var $e=ye.sibling;ye.sibling=null,ye=$e}while(ye!==null)}}jt=y}}if(y.subtreeFlags&2064&&d!==null)d.return=y,jt=d;else e:for(;jt!==null;){if(y=jt,y.flags&2048)switch(y.tag){case 0:case 11:case 15:Op(9,y,y.return)}var ce=y.sibling;if(ce!==null){ce.return=y.return,jt=ce;break e}jt=y.return}}var ie=t.current;for(jt=ie;jt!==null;){d=jt;var U=d.child;if(d.subtreeFlags&2064&&U!==null)U.return=d,jt=U;else e:for(d=ie;jt!==null;){if(E=jt,E.flags&2048)try{switch(E.tag){case 0:case 11:case 15:$v(9,E)}}catch(ve){Ji(E,E.return,ve)}if(E===d){jt=null;break e}var re=E.sibling;if(re!==null){re.return=E.return,jt=re;break e}jt=E.return}}if(Qn=p,tu(),Za&&typeof Za.onPostCommitFiberRoot=="function")try{Za.onPostCommitFiberRoot(jv,t)}catch{}o=!0}return o}finally{di=r,No.transition=i}}return!1}function QM(t,i,r){i=Kd(r,i),i=cP(t,i,1),t=Vc(t,i,1),i=Cs(),t!==null&&(dm(t,1,i),Gs(t,i))}function Ji(t,i,r){if(t.tag===3)QM(t,t,r);else for(;i!==null;){if(i.tag===3){QM(i,t,r);break}else if(i.tag===1){var o=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Wc===null||!Wc.has(o))){t=Kd(r,t),t=uP(i,t,1),i=Vc(i,t,1),t=Cs(),i!==null&&(dm(i,1,t),Gs(i,t));break}}i=i.return}}function AB(t,i,r){var o=t.pingCache;o!==null&&o.delete(i),i=Cs(),t.pingedLanes|=t.suspendedLanes&r,Ur===t&&(qr&r)===r&&(Dr===4||Dr===3&&(qr&130023424)===qr&&500>ar()-ew?ch(t,0):$b|=r),Gs(t,i)}function RP(t,i){i===0&&(t.mode&1?(i=kg,kg<<=1,!(kg&130023424)&&(kg=4194304)):i=1);var r=Cs();t=Hl(t,i),t!==null&&(dm(t,i,r),Gs(t,r))}function SB(t){var i=t.memoizedState,r=0;i!==null&&(r=i.retryLane),RP(t,r)}function MB(t,i){var r=0;switch(t.tag){case 13:var o=t.stateNode,p=t.memoizedState;p!==null&&(r=p.retryLane);break;case 19:o=t.stateNode;break;default:throw Error(ht(314))}o!==null&&o.delete(i),RP(t,r)}var DP;DP=function(t,i,r){if(t!==null)if(t.memoizedProps!==i.pendingProps||Ns.current)Us=!0;else{if(!(t.lanes&r)&&!(i.flags&128))return Us=!1,dB(t,i,r);Us=!!(t.flags&131072)}else Us=!1,Gi&&i.flags&1048576&&OC(i,Mv,i.index);switch(i.lanes=0,i.tag){case 2:var o=i.type;ov(t,i),t=i.pendingProps;var p=jd(i,ps.current);Hd(i,r),p=Yb(null,i,o,t,p,r);var y=Qb();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,zs(o)?(y=!0,Av(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Hb(i),p.updater=Zv,i.stateNode=p,p._reactInternals=i,kx(i,o,t,r),i=zx(null,i,o,!0,y,r)):(i.tag=0,Gi&&y&&Fb(i),Ts(null,i,p,r),i=i.child),i;case 16:o=i.elementType;e:{switch(ov(t,i),t=i.pendingProps,p=o._init,o=p(o._payload),i.type=o,p=i.tag=TB(o),t=da(o,t),p){case 0:i=Nx(null,i,o,t,r);break e;case 1:i=UM(null,i,o,t,r);break e;case 11:i=BM(null,i,o,t,r);break e;case 14:i=kM(null,i,o,da(o.type,t),r);break e}throw Error(ht(306,o,""))}return i;case 0:return o=i.type,p=i.pendingProps,p=i.elementType===o?p:da(o,p),Nx(t,i,o,p,r);case 1:return o=i.type,p=i.pendingProps,p=i.elementType===o?p:da(o,p),UM(t,i,o,p,r);case 3:e:{if(pP(i),t===null)throw Error(ht(387));o=i.pendingProps,y=i.memoizedState,p=y.element,UC(t,i),Cv(i,o,null,r);var d=i.memoizedState;if(o=d.element,y.isDehydrated)if(y={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=Kd(Error(ht(423)),i),i=NM(t,i,o,r,p);break e}else if(o!==p){p=Kd(Error(ht(424)),i),i=NM(t,i,o,r,p);break e}else for(co=Hc(i.stateNode.containerInfo.firstChild),uo=i,Gi=!0,ma=null,r=HC(i,null,o,r),i.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xd(),o===p){i=Vl(t,i,r);break e}Ts(t,i,o,r)}i=i.child}return i;case 5:return VC(i),t===null&&Ox(i),o=i.type,p=i.pendingProps,y=t!==null?t.memoizedProps:null,d=p.children,Px(o,p)?d=null:y!==null&&Px(o,y)&&(i.flags|=32),fP(t,i),Ts(t,i,d,r),i.child;case 6:return t===null&&Ox(i),null;case 13:return mP(t,i,r);case 4:return Vb(i,i.stateNode.containerInfo),o=i.pendingProps,t===null?i.child=Yd(i,null,o,r):Ts(t,i,o,r),i.child;case 11:return o=i.type,p=i.pendingProps,p=i.elementType===o?p:da(o,p),BM(t,i,o,p,r);case 7:return Ts(t,i,i.pendingProps,r),i.child;case 8:return Ts(t,i,i.pendingProps.children,r),i.child;case 12:return Ts(t,i,i.pendingProps.children,r),i.child;case 10:e:{if(o=i.type._context,p=i.pendingProps,y=i.memoizedProps,d=p.value,Mi(Ev,o._currentValue),o._currentValue=d,y!==null)if(_a(y.value,d)){if(y.children===p.children&&!Ns.current){i=Vl(t,i,r);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var E=y.dependencies;if(E!==null){d=y.child;for(var L=E.firstContext;L!==null;){if(L.context===o){if(y.tag===1){L=Ol(-1,r&-r),L.tag=2;var k=y.updateQueue;if(k!==null){k=k.shared;var X=k.pending;X===null?L.next=L:(L.next=X.next,X.next=L),k.pending=L}}y.lanes|=r,L=y.alternate,L!==null&&(L.lanes|=r),Fx(y.return,r,i),E.lanes|=r;break}L=L.next}}else if(y.tag===10)d=y.type===i.type?null:y.child;else if(y.tag===18){if(d=y.return,d===null)throw Error(ht(341));d.lanes|=r,E=d.alternate,E!==null&&(E.lanes|=r),Fx(d,r,i),d=y.sibling}else d=y.child;if(d!==null)d.return=y;else for(d=y;d!==null;){if(d===i){d=null;break}if(y=d.sibling,y!==null){y.return=d.return,d=y;break}d=d.return}y=d}Ts(t,i,p.children,r),i=i.child}return i;case 9:return p=i.type,o=i.pendingProps.children,Hd(i,r),p=zo(p),o=o(p),i.flags|=1,Ts(t,i,o,r),i.child;case 14:return o=i.type,p=da(o,i.pendingProps),p=da(o.type,p),kM(t,i,o,p,r);case 15:return hP(t,i,i.type,i.pendingProps,r);case 17:return o=i.type,p=i.pendingProps,p=i.elementType===o?p:da(o,p),ov(t,i),i.tag=1,zs(o)?(t=!0,Av(i)):t=!1,Hd(i,r),zC(i,o,p),kx(i,o,p,r),zx(null,i,o,!0,t,r);case 19:return gP(t,i,r);case 22:return dP(t,i,r)}throw Error(ht(156,i.tag))};function IP(t,i){return rC(t,i)}function EB(t,i,r,o){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Uo(t,i,r,o){return new EB(t,i,r,o)}function rw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function TB(t){if(typeof t=="function")return rw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ab)return 11;if(t===Sb)return 14}return 2}function Xc(t,i){var r=t.alternate;return r===null?(r=Uo(t.tag,i,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=i,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,i=t.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function cv(t,i,r,o,p,y){var d=2;if(o=t,typeof t=="function")rw(t)&&(d=1);else if(typeof t=="string")d=5;else e:switch(t){case Ad:return uh(r.children,p,y,i);case wb:d=8,p|=8;break;case ax:return t=Uo(12,r,i,p|2),t.elementType=ax,t.lanes=y,t;case lx:return t=Uo(13,r,i,p),t.elementType=lx,t.lanes=y,t;case cx:return t=Uo(19,r,i,p),t.elementType=cx,t.lanes=y,t;case GT:return t0(r,p,y,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case NT:d=10;break e;case zT:d=9;break e;case Ab:d=11;break e;case Sb:d=14;break e;case Ic:d=16,o=null;break e}throw Error(ht(130,t==null?t:typeof t,""))}return i=Uo(d,r,i,p),i.elementType=t,i.type=o,i.lanes=y,i}function uh(t,i,r,o){return t=Uo(7,t,o,i),t.lanes=r,t}function t0(t,i,r,o){return t=Uo(22,t,o,i),t.elementType=GT,t.lanes=r,t.stateNode={isHidden:!1},t}function z_(t,i,r){return t=Uo(6,t,null,i),t.lanes=r,t}function G_(t,i,r){return i=Uo(4,t.children!==null?t.children:[],t.key,i),i.lanes=r,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function CB(t,i,r,o,p){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=b_(0),this.expirationTimes=b_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=b_(0),this.identifierPrefix=o,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function sw(t,i,r,o,p,y,d,E,L){return t=new CB(t,i,r,E,L),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Uo(3,null,null,i),t.current=y,y.stateNode=t,y.memoizedState={element:o,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hb(y),t}function PB(t,i,r){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wd,key:o==null?null:""+o,children:t,containerInfo:i,implementation:r}}function LP(t){if(!t)return Kc;t=t._reactInternals;e:{if(yh(t)!==t||t.tag!==1)throw Error(ht(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(zs(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(ht(171))}if(t.tag===1){var r=t.type;if(zs(r))return IC(t,r,i)}return i}function OP(t,i,r,o,p,y,d,E,L){return t=sw(r,o,!0,t,p,y,d,E,L),t.context=LP(null),r=t.current,o=Cs(),p=jc(r),y=Ol(o,p),y.callback=i??null,Vc(r,y,p),t.current.lanes=p,dm(t,p,o),Gs(t,o),t}function n0(t,i,r,o){var p=i.current,y=Cs(),d=jc(p);return r=LP(r),i.context===null?i.context=r:i.pendingContext=r,i=Ol(y,d),i.payload={element:t},o=o===void 0?null:o,o!==null&&(i.callback=o),t=Vc(p,i,d),t!==null&&(ya(t,p,d,y),iv(t,p,d)),d}function Bv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function KM(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<i?r:i}}function ow(t,i){KM(t,i),(t=t.alternate)&&KM(t,i)}function RB(){return null}var FP=typeof reportError=="function"?reportError:function(t){console.error(t)};function aw(t){this._internalRoot=t}i0.prototype.render=aw.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(ht(409));n0(t,i,null,null)};i0.prototype.unmount=aw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;gh(function(){n0(null,t,null,null)}),i[Gl]=null}};function i0(t){this._internalRoot=t}i0.prototype.unstable_scheduleHydration=function(t){if(t){var i=hC();t={blockedOn:null,target:t,priority:i};for(var r=0;r<Fc.length&&i!==0&&i<Fc[r].priority;r++);Fc.splice(r,0,t),r===0&&fC(t)}};function lw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function r0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qM(){}function DB(t,i,r,o,p){if(p){if(typeof o=="function"){var y=o;o=function(){var k=Bv(d);y.call(k)}}var d=OP(i,o,t,0,null,!1,!1,"",qM);return t._reactRootContainer=d,t[Gl]=d.current,Kp(t.nodeType===8?t.parentNode:t),gh(),d}for(;p=t.lastChild;)t.removeChild(p);if(typeof o=="function"){var E=o;o=function(){var k=Bv(L);E.call(k)}}var L=sw(t,0,!1,null,null,!1,!1,"",qM);return t._reactRootContainer=L,t[Gl]=L.current,Kp(t.nodeType===8?t.parentNode:t),gh(function(){n0(i,L,r,o)}),L}function s0(t,i,r,o,p){var y=r._reactRootContainer;if(y){var d=y;if(typeof p=="function"){var E=p;p=function(){var L=Bv(d);E.call(L)}}n0(i,d,t,p)}else d=DB(r,i,t,p,o);return Bv(d)}cC=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var r=Mp(i.pendingLanes);r!==0&&(Tb(i,r|1),Gs(i,ar()),!(Qn&6)&&(qd=ar()+500,tu()))}break;case 13:gh(function(){var o=Hl(t,1);if(o!==null){var p=Cs();ya(o,t,1,p)}}),ow(t,1)}};Cb=function(t){if(t.tag===13){var i=Hl(t,134217728);if(i!==null){var r=Cs();ya(i,t,134217728,r)}ow(t,134217728)}};uC=function(t){if(t.tag===13){var i=jc(t),r=Hl(t,i);if(r!==null){var o=Cs();ya(r,t,i,o)}ow(t,i)}};hC=function(){return di};dC=function(t,i){var r=di;try{return di=t,i()}finally{di=r}};_x=function(t,i,r){switch(i){case"input":if(dx(t,r),i=r.name,r.type==="radio"&&i!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<r.length;i++){var o=r[i];if(o!==t&&o.form===t.form){var p=Kv(o);if(!p)throw Error(ht(90));VT(o),dx(o,p)}}}break;case"textarea":jT(t,r);break;case"select":i=r.value,i!=null&&Ud(t,!!r.multiple,i,!1)}};JT=tw;$T=gh;var IB={usingClientEntryPoint:!1,Events:[pm,Td,Kv,qT,ZT,tw]},_p={findFiberByHostInstance:sh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LB={bundleType:_p.bundleType,version:_p.version,rendererPackageName:_p.rendererPackageName,rendererConfig:_p.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nC(t),t===null?null:t.stateNode},findFiberByHostInstance:_p.findFiberByHostInstance||RB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qg.isDisabled&&Qg.supportsFiber)try{jv=Qg.inject(LB),Za=Qg}catch{}}po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IB;po.createPortal=function(t,i){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lw(i))throw Error(ht(200));return PB(t,i,null,r)};po.createRoot=function(t,i){if(!lw(t))throw Error(ht(299));var r=!1,o="",p=FP;return i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(o=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=sw(t,1,!1,null,null,r,!1,o,p),t[Gl]=i.current,Kp(t.nodeType===8?t.parentNode:t),new aw(i)};po.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(ht(188)):(t=Object.keys(t).join(","),Error(ht(268,t)));return t=nC(i),t=t===null?null:t.stateNode,t};po.flushSync=function(t){return gh(t)};po.hydrate=function(t,i,r){if(!r0(i))throw Error(ht(200));return s0(null,t,i,!0,r)};po.hydrateRoot=function(t,i,r){if(!lw(t))throw Error(ht(405));var o=r!=null&&r.hydratedSources||null,p=!1,y="",d=FP;if(r!=null&&(r.unstable_strictMode===!0&&(p=!0),r.identifierPrefix!==void 0&&(y=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),i=OP(i,null,t,1,r??null,p,!1,y,d),t[Gl]=i.current,Kp(t),o)for(t=0;t<o.length;t++)r=o[t],p=r._getVersion,p=p(r._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[r,p]:i.mutableSourceEagerHydrationData.push(r,p);return new i0(i)};po.render=function(t,i,r){if(!r0(i))throw Error(ht(200));return s0(null,t,i,!1,r)};po.unmountComponentAtNode=function(t){if(!r0(t))throw Error(ht(40));return t._reactRootContainer?(gh(function(){s0(null,null,t,!1,function(){t._reactRootContainer=null,t[Gl]=null})}),!0):!1};po.unstable_batchedUpdates=tw;po.unstable_renderSubtreeIntoContainer=function(t,i,r,o){if(!r0(r))throw Error(ht(200));if(t==null||t._reactInternals===void 0)throw Error(ht(38));return s0(t,i,r,!1,o)};po.version="18.2.0-next-9e3b772b8-20220608";function BP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BP)}catch(t){console.error(t)}}BP(),OT.exports=po;var OB=OT.exports,ZM=OB;sx.createRoot=ZM.createRoot,sx.hydrateRoot=ZM.hydrateRoot;var FB={461:(t,i,r)=>{r.d(i,{Entity:()=>d});var o=r(930),p;(function(E){E[E.Destroyed=1]="Destroyed",E[E.OnLoadCalled=2]="OnLoadCalled",E[E.OnEnableCalled=4]="OnEnableCalled",E[E.StartCalled=8]="StartCalled",E[E.Deactivating=16]="Deactivating",E[E.IsStartCalled=32]="IsStartCalled"})(p||(p={}));let y=0;class d extends o.v{constructor(k){super();B(this,"uuid",""+y++);B(this,"name","");B(this,"_objFlags",0);this.name=k||this.name}__setFlag(k){this._objFlags|=k}__clearFlag(k){this._objFlags&=~k}__getFlag(k){return!!(this._objFlags&k)}get isValid(){return!(this._objFlags&p.Destroyed)}destroy(){return this.__getFlag(p.Destroyed)?!1:(this.destroyImmediate(),!0)}destroyImmediate(){this._onPreDestroy&&this._onPreDestroy(),this.__setFlag(p.Destroyed)}}B(d,"Flags",p)},930:(t,i,r)=>{r.d(i,{v:()=>o});class o{constructor(){B(this,"_events",{})}clear(){return this._events={},this}has(y){return!!this._events[y]}on(y,d,E,L=!1){let k=this._events[y];if(k==null&&(k=this._events[y]=[]),k.findIndex($=>$.callback===d&&(!E||$.target===E))>-1){console.warn(`event: ${y} duplicate registered`);return}return k.push({name:y,callback:d,target:E,once:L}),this}off(y,d,E){let L=this._events[y];if(L){let k=L.findIndex(X=>X.callback===d&&(!E||X.target===E));this._removeEvent(L,k,y)}return this}onof(y,d,E){return E._listeners===void 0&&(E._listeners=[]),E._listeners.push({name:y,callback:d}),this.on(y,d),this}offof(y){for(let d of y._listeners)this.off(d.name,d.callback);return this}_removeEvent(y,d,E){return d>-1&&(y.splice(d,1),y.length===0&&delete this._events[E]),this}targetOff(y){for(let d in this._events){let E=this._events[d];for(let L=E.length;L--;)E[L].target===y&&this._removeEvent(E,L,d)}}emit(y,...d){let E=this._events[y];if(E)for(let L=E.length;L--;){let k=E[L];k&&(k.once&&this._removeEvent(E,L,y),k.target?k.callback.apply(k.target,d):k.callback(...d))}return this}}},591:(t,i,r)=>{r.d(i,{w:()=>p});var o=r(461);class p extends o.Entity{constructor(){super(...arguments);B(this,"_enabled",!0);B(this,"node");B(this,"viewer");B(this,"isComponent",!0)}get enabled(){return this._enabled}set enabled(E){var L;this._enabled!==E&&(this._enabled=E,(L=this.viewer)==null||L.componentScheduler.enableComponent(this,E))}_onPreDestroy(){var E,L,k;this.unscheduleAll(),(E=this.viewer)==null||E.input.disconnect(this),(L=this.viewer)==null||L.removeComponent(this.node,this),this._enabled&&((k=this.viewer)==null||k.componentScheduler.enableComponent(this,!1)),this.onDestroy&&this.__getFlag(o.Entity.Flags.OnLoadCalled)&&this.onDestroy()}schedule(E,L,k=-1){var X;(X=this.viewer)==null||X.scheduler.schedule(this,E,L,k)}unshedule(E){var L;(L=this.viewer)==null||L.scheduler.unshedule(this,E)}unscheduleAll(){var E;(E=this.viewer)==null||E.scheduler.unscheduleAll(this)}on(E,L,k,X){var $;return super.on(E,L,k,X),($=this.viewer)==null||$.input.connect(this,E),this}}},41:(t,i,r)=>{r.d(i,{Cb:()=>o,HO:()=>p,jf:()=>y});function o(d={}){return function(E,L){E.hasOwnProperty("__properties")||(E.__properties=Object.assign({},E.__proto__.__properties)),E.__properties[L]=d}}function p(...d){return function(E){let L=E.prototype;L.__dependencies==null&&(L.__dependencies=[]),L.__dependencies.push(...d)}}function y(d="",E=0,L=!1){return function(k){let X=k.prototype;X.__display==null&&(X.__display={name:d||k.name||k.constructor.name,order:E,root:L})}}},25:(t,i,r)=>{r.d(i,{$TI:()=>o.$TI,$V:()=>o.$V,$Vf:()=>o.$Vf,$YQ:()=>o.$YQ,A5E:()=>o.A5E,AXT:()=>o.AXT,Aip:()=>o.Aip,B02:()=>o.B02,BFQ:()=>o.BFQ,BG$:()=>o.BG$,BKK:()=>o.BKK,BVF:()=>o.BVF,BVQ:()=>o.BVQ,BbS:()=>o.BbS,Bf4:()=>o.Bf4,BtG:()=>o.BtG,CJI:()=>o.CJI,CP7:()=>o.CP7,CaW:()=>o.CaW,CdI:()=>o.CdI,Cne:()=>o.Cne,CtA:()=>o.CtA,CtF:()=>o.CtF,D1R:()=>o.D1R,D9w:()=>o.D9w,DT1:()=>o.DT1,Djp:()=>o.Djp,DqL:()=>o.DqL,DvJ:()=>o.DvJ,E2K:()=>o.E2K,EB7:()=>o.EB7,EJi:()=>o.EJi,EoG:()=>o.EoG,F5T:()=>o.F5T,FDw:()=>o.FDw,FE5:()=>o.FE5,FIo:()=>o.FIo,FM8:()=>o.FM8,FT0:()=>o.FT0,FUD:()=>o.FUD,FvO:()=>o.FvO,GG6:()=>o.GG6,GQ:()=>o.GQ,GUF:()=>o.GUF,GVz:()=>o.GVz,GZb:()=>o.GZb,Gih:()=>o.Gih,Gql:()=>o.Gql,H$k:()=>o.H$k,HTd:()=>o.HTd,HW6:()=>o.HW6,HdW:()=>o.HdW,HgB:()=>o.HgB,HkE:()=>o.HkE,Hmr:()=>o.Hmr,Hw6:()=>o.Hw6,Hy8:()=>o.Hy8,Hyl:()=>o.Hyl,IEO:()=>o.IEO,IFH:()=>o.IFH,IKL:()=>o.IKL,ILR:()=>o.ILR,IOt:()=>o.IOt,Ilk:()=>o.Ilk,Ir4:()=>o.Ir4,JOQ:()=>o.JOQ,JQ4:()=>o.JQ4,JUT:()=>o.JUT,JWc:()=>o.JWc,KI_:()=>o.KI_,Kgo:()=>o.Kgo,KhW:()=>o.KhW,Kj0:()=>o.Kj0,Kz5:()=>o.Kz5,L5g:()=>o.L5g,L5s:()=>o.L5s,LBq:()=>o.LBq,LSk:()=>o.LSk,LY2:()=>o.LY2,L_r:()=>o.L_r,Lcc:()=>o.Lcc,LgZ:()=>o.LgZ,LsT:()=>o.LsT,Ltg:()=>o.Ltg,Lun:()=>o.Lun,M5h:()=>o.M5h,M6v:()=>o.M6v,MathUtils:()=>o.M8C,Mig:()=>o.Mig,MyG:()=>o.MyG,N$j:()=>o.N$j,N4l:()=>o.N4l,NDo:()=>o.NDo,NMF:()=>o.NMF,NYV:()=>o.NYV,Ns1:()=>o.Ns1,NwF:()=>o.NwF,Ny0:()=>o.Ny0,O7d:()=>o.O7d,OAl:()=>o.OAl,OM3:()=>o.OM3,OTo:()=>o.OTo,OdW:()=>o.OdW,OoA:()=>o.OoA,Ox3:()=>o.Ox3,PA7:()=>o.PA7,PMe:()=>o.PMe,Pa4:()=>o.Pa4,PeU:()=>o.PeU,Pnf:()=>o.Pnf,PpQ:()=>o.PpQ,QM0:()=>o.QM0,QRU:()=>o.QRU,QZ1:()=>o.QZ1,QmN:()=>o.QmN,Qpg:()=>o.Qpg,R2R:()=>o.R2R,REq:()=>o.REq,RNb:()=>o.RNb,ROQ:()=>o.ROQ,RSm:()=>o.RSm,Rki:()=>o.Rki,RlZ:()=>o.RlZ,RsA:()=>o.RsA,RvT:()=>o.RvT,S2y:()=>o.S2y,S3k:()=>o.S3k,S9g:()=>o.S9g,SJI:()=>o.SJI,SPe:()=>o.SPe,SUY:()=>o.SUY,Se2:()=>o.Se2,Sm8:()=>o.Sm8,So8:()=>o.So8,SvJ:()=>o.SvJ,Syv:()=>o.Syv,T95:()=>o.T95,TOt:()=>o.TOt,TUj:()=>o.TUj,TUv:()=>o.TUv,T_1:()=>o.T_1,T_J:()=>o.T_J,T__:()=>o.T__,T_f:()=>o.T_f,TlE:()=>o.TlE,Tme:()=>o.Tme,Tn7:()=>o.Tn7,TyD:()=>o.TyD,U7:()=>o.U7,USm:()=>o.USm,UY4:()=>o.UY4,UZH:()=>o.UZH,Uk6:()=>o.Uk6,UlW:()=>o.UlW,Uol:()=>o.Uol,V1s:()=>o.V1s,V4E:()=>o.V4E,VLJ:()=>o.VLJ,VYz:()=>o.VYz,Vdb:()=>o.Vdb,Vj0:()=>o.Vj0,Vkp:()=>o.Vkp,VzW:()=>o.VzW,W2J:()=>o.W2J,WMw:()=>o.WMw,WTc:()=>o.WTc,WXh:()=>o.WXh,Wbm:()=>o.Wbm,WdD:()=>o.WdD,Wid:()=>o.Wid,Wjw:()=>o.Wjw,Wl3:()=>o.Wl3,Wpd:()=>o.Wpd,Wqd:()=>o.Wqd,WwZ:()=>o.WwZ,Wzm:()=>o.Wzm,XZw:()=>o.XZw,Xaj:()=>o.Xaj,Xcj:()=>o.Xcj,XvJ:()=>o.XvJ,Y8D:()=>o.Y8D,YBo:()=>o.YBo,YGz:()=>o.YGz,YKA:()=>o.YKA,YLQ:()=>o.YLQ,YN5:()=>o.YN5,YT8:()=>o.YT8,Ywn:()=>o.Ywn,Z6B:()=>o.Z6B,ZAu:()=>o.ZAu,ZQ6:()=>o.ZQ6,ZRs:()=>o.ZRs,ZTh:()=>o.ZTh,ZZA:()=>o.ZZA,Z_g:()=>o.Z_g,Zp0:()=>o.Zp0,Zr5:()=>o.Zr5,ZzF:()=>o.ZzF,Zzh:()=>o.Zzh,_12:()=>o._12,_3:()=>o._3,_AM:()=>o._AM,_C8:()=>o._C8,_Li:()=>o._Li,_MY:()=>o._MY,_YM:()=>o._YM,_YX:()=>o._YX,_am:()=>o._am,_fP:()=>o._fP,_iA:()=>o._iA,_kC:()=>o._kC,_lf:()=>o._lf,_sL:()=>o._sL,a$l:()=>o.a$l,aCh:()=>o.aCh,aH4:()=>o.aH4,aLr:()=>o.aLr,aNw:()=>o.aNw,aVm:()=>o.aVm,ad5:()=>o.ad5,anP:()=>o.anP,aq0:()=>o.aq0,av9:()=>o.av9,b5g:()=>o.b5g,bGH:()=>o.bGH,b_z:()=>o.b_z,bdR:()=>o.bdR,blk:()=>o.blk,bnF:()=>o.bnF,brP:()=>o.brP,bsb:()=>o.bsb,c8b:()=>o.c8b,cBI:()=>o.cBI,cBK:()=>o.cBK,cJO:()=>o.cJO,cLu:()=>o.cLu,cPb:()=>o.cPb,cRx:()=>o.cRx,cU9:()=>o.cU9,ce8:()=>o.ce8,cek:()=>o.cek,cum:()=>o.cum,dSO:()=>o.dSO,dUE:()=>o.dUE,dYG:()=>o.dYG,dZ3:()=>o.dZ3,dd2:()=>o.dd2,dj0:()=>o.dj0,dpR:()=>o.dpR,dwk:()=>o.dwk,e62:()=>o.e62,eD:()=>o.eD,eMJ:()=>o.eMJ,eaV:()=>o.eaV,ehD:()=>o.ehD,ejS:()=>o.ejS,ekQ:()=>o.ekQ,epp:()=>o.epp,fHI:()=>o.fHI,fO1:()=>o.fO1,fQA:()=>o.fQA,fQK:()=>o.fQK,fSK:()=>o.fSK,fY$:()=>o.fY$,fto:()=>o.fto,g8_:()=>o.g8_,gH0:()=>o.gH0,gSk:()=>o.gSk,g_z:()=>o.g_z,ghN:()=>o.ghN,gi4:()=>o.gi4,gti:()=>o.gti,hEm:()=>o.hEm,hH6:()=>o.hH6,iAb:()=>o.iAb,iDF:()=>o.iDF,iKG:()=>o.iKG,iLg:()=>o.iLg,iMs:()=>o.iMs,iUV:()=>o.iUV,iWC:()=>o.iWC,iWj:()=>o.iWj,i_9:()=>o.i_9,iiP:()=>o.iiP,irR:()=>o.irR,j4z:()=>o.j4z,j87:()=>o.j87,jAl:()=>o.jAl,jFi:()=>o.jFi,jZA:()=>o.jZA,jfJ:()=>o.jfJ,jwo:()=>o.jwo,jyi:()=>o.jyi,jyz:()=>o.jyz,k0A:()=>o.k0A,k74:()=>o.k74,kB5:()=>o.kB5,kFz:()=>o.kFz,kaV:()=>o.kaV,knz:()=>o.knz,kqm:()=>o.kqm,ksN:()=>o.ksN,l0P:()=>o.l0P,l8J:()=>o.l8J,lCJ:()=>o.lCJ,lDi:()=>o.lDi,lGU:()=>o.lGU,lLk:()=>o.lLk,lRF:()=>o.lRF,lRj:()=>o.lRj,lb7:()=>o.lb7,lfu:()=>o.lfu,lk7:()=>o.lk7,m7l:()=>o.m7l,mSO:()=>o.mSO,mTL:()=>o.mTL,mXe:()=>o.mXe,m_w:()=>o.m_w,mzJ:()=>o.mzJ,nls:()=>o.nls,ntZ:()=>o.ntZ,ntt:()=>o.ntt,nvb:()=>o.nvb,o8S:()=>o.o8S,oAp:()=>o.oAp,oa8:()=>o.oa8,oqc:()=>o.oqc,p3g:()=>o.p3g,p7y:()=>o.p7y,pBf:()=>o.pBf,pIN:()=>o.pIN,pKu:()=>o.pKu,pQR:()=>o.pQR,ptH:()=>o.ptH,qhX:()=>o.qhX,qkB:()=>o.qkB,qlB:()=>o.qlB,qyh:()=>o.qyh,rAo:()=>o.rAo,rBU:()=>o.rBU,rDY:()=>o.rDY,rOj:()=>o.rOj,r_:()=>o.r_,rnI:()=>o.rnI,rpg:()=>o.rpg,s4_:()=>o.s4_,sYA:()=>o.sYA,tEQ:()=>o.tEQ,tGC:()=>o.tGC,tJx:()=>o.tJx,tUh:()=>o.tUh,tf:()=>o.tf,tm_:()=>o.tm_,trn:()=>o.trn,u37:()=>o.u37,u7G:()=>o.u7G,u9r:()=>o.u9r,uEv:()=>o.uEv,uL9:()=>o.uL9,uWy:()=>o.uWy,uXU:()=>o.uXU,ub3:()=>o.ub3,ujx:()=>o.ujx,v3W:()=>o.v3W,v9Y:()=>o.v9Y,vBJ:()=>o.vBJ,vCF:()=>o.vCF,vCx:()=>o.vCx,vZf:()=>o.vZf,vmT:()=>o.vmT,vpT:()=>o.vpT,vuL:()=>o.vuL,vxC:()=>o.vxC,w$m:()=>o.w$m,wJv:()=>o.wJv,wem:()=>o.wem,wk1:()=>o.wk1,woe:()=>o.woe,wuA:()=>o.wuA,x12:()=>o.x12,x5V:()=>o.x5V,xEZ:()=>o.xEZ,xG9:()=>o.xG9,xJs:()=>o.xJs,xWb:()=>o.xWb,xeV:()=>o.xeV,xfE:()=>o.xfE,xo$:()=>o.xo$,xoR:()=>o.xoR,xsS:()=>o.xsS,y$t:()=>o.y$t,y2t:()=>o.y2t,y8_:()=>o.y8_,yC1:()=>o.yC1,yGw:()=>o.yGw,ybr:()=>o.ybr,yj7:()=>o.yj7,ylh:()=>o.ylh,yo9:()=>o.yo9,yt0:()=>o.yt0,ywz:()=>o.ywz,yxD:()=>o.yxD,z$h:()=>o.z$h,z81:()=>o.z81,z8B:()=>o.z8B,zHn:()=>o.zHn,zbs:()=>o.zbs,zf8:()=>o.zf8});var o=r(477)},651:(t,i,r)=>{r.d(i,{J12:()=>ba,$c:()=>Ie,I_b:()=>es,oGK:()=>Ds,$p:()=>Ge,$q:()=>$r,$r:()=>Fi,L0d:()=>Ct,i5S:()=>vt,nXV:()=>Sn,bd1:()=>Oi,LY2:()=>d.LY2,iAO:()=>qi,bGH:()=>d.bGH,NDo:()=>d.NDo,gSk:()=>d.gSk,WMw:()=>d.WMw,OTo:()=>d.OTo,Se2:()=>d.Se2,cum:()=>d.cum,Mig:()=>d.Mig,i_9:()=>d.i_9,fwF:()=>xf,m7l:()=>d.m7l,vXP:()=>be,sYA:()=>d.sYA,Xcj:()=>d.Xcj,mzJ:()=>d.mzJ,ZZA:()=>d.ZZA,T__:()=>d.T__,HkE:()=>d.HkE,tGC:()=>d.tGC,gOo:()=>tn,f03:()=>vr,BbS:()=>d.BbS,kqm:()=>d.kqm,GPr:()=>ru,Hmr:()=>d.Hmr,SJI:()=>d.SJI,mTL:()=>d.mTL,y8_:()=>d.y8_,Xim:()=>$0,_Li:()=>d._Li,z81:()=>d.z81,_MY:()=>d._MY,NBQ:()=>Im,IIx:()=>Su,N$j:()=>d.N$j,_YM:()=>d._YM,TUj:()=>d.TUj,ZzF:()=>d.ZzF,GQ:()=>d.GQ,nvb:()=>d.nvb,DvJ:()=>d.DvJ,fQA:()=>d.fQA,ePP:()=>As,TlE:()=>d.TlE,u9r:()=>d.u9r,s4_:()=>d.s4_,T95:()=>d.T95,CtF:()=>d.CtF,V1s:()=>d.V1s,Rki:()=>d.Rki,ROQ:()=>d.ROQ,YN5:()=>d.YN5,BVQ:()=>d.BVQ,YT8:()=>d.YT8,YGz:()=>d.YGz,WXy:()=>Gh,trn:()=>d.trn,zf8:()=>d.zf8,uWy:()=>d.uWy,SUY:()=>d.SUY,Ilk:()=>d.Ilk,R2R:()=>d.R2R,epp:()=>d.epp,Wrv:()=>Nh,EKy:()=>pf,$S:()=>Uh,wA2:()=>mt.w,Z_g:()=>d.Z_g,EB7:()=>d.EB7,DqL:()=>d.DqL,_3:()=>d._3,b_z:()=>d.b_z,unp:()=>Ls,_am:()=>d._am,fY$:()=>d.fY$,vxC:()=>d.vxC,BtG:()=>d.BtG,cBK:()=>d.cBK,g8_:()=>d.g8_,AXT:()=>d.AXT,yj7:()=>d.yj7,dYG:()=>d.dYG,tm_:()=>d.tm_,S2y:()=>d.S2y,B02:()=>d.B02,PeU:()=>d.PeU,Hyl:()=>d.Hyl,Wqd:()=>d.Wqd,SVw:()=>ge,Xaj:()=>d.Xaj,dZ3:()=>d.dZ3,m_w:()=>d.m_w,fHI:()=>d.fHI,LBq:()=>d.LBq,JUT:()=>d.JUT,p3g:()=>d.p3g,IEO:()=>d.IEO,yxD:()=>d.yxD,A5E:()=>d.A5E,jfJ:()=>d.jfJ,T_J:()=>d.T_J,tEQ:()=>d.tEQ,qkB:()=>d.qkB,brP:()=>d.brP,$YQ:()=>d.$YQ,iRp:()=>wr,Ox3:()=>d.Ox3,cBI:()=>d.cBI,cU9:()=>d.cU9,ntt:()=>d.ntt,DT1:()=>d.DT1,Kgo:()=>d.Kgo,ehD:()=>d.ehD,fSK:()=>d.fSK,Vdb:()=>d.Vdb,l8J:()=>d.l8J,dj0:()=>d.dj0,QM0:()=>d.QM0,q7E:()=>hu,TOt:()=>d.TOt,Ny0:()=>d.Ny0,qAh:()=>_l,eD:()=>d.eD,jwo:()=>d.jwo,dSO:()=>d.dSO,Bf4:()=>d.Bf4,USm:()=>d.USm,pBf:()=>d.pBf,vpe:()=>ie.v,$Vf:()=>d.$Vf,O7d:()=>d.O7d,Aek:()=>he,hH6:()=>d.hH6,e62:()=>d.e62,a$l:()=>d.a$l,OM3:()=>d.OM3,VzW:()=>d.VzW,ybr:()=>d.ybr,yo9:()=>d.yo9,Wzm:()=>d.Wzm,zUS:()=>Zn,Wl3:()=>d.Wl3,iWj:()=>d.iWj,ylh:()=>d.ylh,v9Y:()=>d.v9Y,LSk:()=>d.LSk,uoT:()=>yu,w$m:()=>d.w$m,ksN:()=>d.ksN,j4z:()=>d.j4z,OAl:()=>d.OAl,VLJ:()=>d.VLJ,ZAu:()=>d.ZAu,k7s:()=>Vr,cLu:()=>d.cLu,vmT:()=>d.vmT,Qpg:()=>d.Qpg,So8:()=>d.So8,Wjw:()=>d.Wjw,cJO:()=>d.cJO,KCx:()=>hf,QRU:()=>d.QRU,S3k:()=>d.S3k,PpQ:()=>d.PpQ,ZRs:()=>d.ZRs,oqc:()=>d.oqc,lb7:()=>d.lb7,L5s:()=>d.L5s,$TI:()=>d.$TI,SPe:()=>d.SPe,aVm:()=>d.aVm,j87:()=>d.j87,RNb:()=>d.RNb,Kz5:()=>d.Kz5,vpT:()=>d.vpT,kB5:()=>d.kB5,_C8:()=>d._C8,Syv:()=>d.Syv,NMF:()=>d.NMF,pIN:()=>d.pIN,eMJ:()=>d.eMJ,ZtY:()=>le,x5V:()=>d.x5V,tUh:()=>d.tUh,z8B:()=>d.z8B,__J:()=>Sr,GZb:()=>d.GZb,p7y:()=>d.p7y,udN:()=>wc,S9g:()=>d.S9g,Zr5:()=>d.Zr5,vCF:()=>d.vCF,yt0:()=>d.yt0,uXU:()=>d.uXU,_kC:()=>d._kC,lk7:()=>d.lk7,DvN:()=>Q0,x12:()=>d.x12,Zzh:()=>d.Zzh,nls:()=>d.nls,g_z:()=>d.g_z,U7:()=>d.U7,FT0:()=>d.FT0,blk:()=>d.blk,ejS:()=>d.ejS,rnI:()=>d.rnI,wem:()=>d.wem,lfu:()=>d.lfu,FDw:()=>d.FDw,lRj:()=>d.lRj,D1R:()=>d.D1R,qyh:()=>d.qyh,GUF:()=>d.GUF,EoG:()=>d.EoG,aNw:()=>d.aNw,Zp0:()=>d.Zp0,lLk:()=>d.lLk,jAl:()=>d.jAl,uEv:()=>d.uEv,YKA:()=>d.YKA,cRx:()=>d.cRx,Y8D:()=>d.Y8D,RsA:()=>d.RsA,B51:()=>is,F5T:()=>d.F5T,u7G:()=>d.u7G,M8C:()=>d.MathUtils,Vkp:()=>d.Vkp,yGw:()=>d.yGw,Sm8:()=>d.Sm8,Kj0:()=>d.Kj0,vBJ:()=>d.vBJ,lRF:()=>d.lRF,Lun:()=>d.Lun,YBo:()=>d.YBo,kaV:()=>d.kaV,RSm:()=>d.RSm,xoR:()=>d.xoR,EJi:()=>d.EJi,Qme:()=>Fm,Wid:()=>d.Wid,jrH:()=>Hw,IKL:()=>d.IKL,r_:()=>d.r_,OPb:()=>yl,OoA:()=>d.OoA,qhX:()=>d.qhX,M5h:()=>d.M5h,Ns1:()=>d.Ns1,TyD:()=>d.TyD,vZf:()=>d.vZf,HTd:()=>d.HTd,aH4:()=>d.aH4,YLQ:()=>d.YLQ,BVF:()=>d.BVF,MyG:()=>d.MyG,jFi:()=>d.jFi,aCh:()=>d.aCh,uL9:()=>d.uL9,fwl:()=>Tu,IFH:()=>d.IFH,bdR:()=>d.bdR,M6v:()=>d.M6v,RvT:()=>d.RvT,dUE:()=>d.dUE,Tme:()=>d.Tme,Gql:()=>d.Gql,PA7:()=>d.PA7,REq:()=>d.REq,pQR:()=>d.pQR,ghN:()=>d.ghN,Hy8:()=>d.Hy8,Wpd:()=>d.Wpd,LgZ:()=>d.LgZ,iWC:()=>d.iWC,i5E:()=>ce,iKG:()=>d.iKG,_iA:()=>d._iA,ntZ:()=>d.ntZ,anP:()=>d.anP,y$t:()=>d.y$t,Ady:()=>j0,H8x:()=>$e,cPb:()=>d.cPb,JOQ:()=>d.JOQ,BKK:()=>d.BKK,_12:()=>d._12,tJx:()=>d.tJx,OdJ:()=>Ia,SyM:()=>Bh.S,cek:()=>d.cek,xG9:()=>d.xG9,woe:()=>d.woe,UY4:()=>d.UY4,aq0:()=>d.aq0,ujx:()=>d.ujx,Uol:()=>d.Uol,VYz:()=>d.VYz,XgS:()=>_c,iUV:()=>d.iUV,tf:()=>d.tf,ZQ6:()=>d.ZQ6,mXe:()=>d.mXe,_fP:()=>d._fP,iLg:()=>d.iLg,zbs:()=>d.zbs,ZTh:()=>d.ZTh,HdW:()=>d.HdW,UZH:()=>d.UZH,mSO:()=>d.mSO,wk1:()=>d.wk1,E2K:()=>d.E2K,FUD:()=>d.FUD,pKu:()=>d.pKu,GG6:()=>d.GG6,Gih:()=>d.Gih,iiP:()=>d.iiP,SvJ:()=>d.SvJ,ptH:()=>d.ptH,jZA:()=>d.jZA,y2t:()=>d.y2t,gi4:()=>d.gi4,Djp:()=>d.Djp,BG$:()=>d.BG$,NYV:()=>d.NYV,xJs:()=>d.xJs,bsb:()=>d.bsb,ekQ:()=>d.ekQ,CaW:()=>d.CaW,eaV:()=>d.eaV,BFQ:()=>d.BFQ,v3W:()=>d.v3W,ILR:()=>d.ILR,fto:()=>d.fto,l0P:()=>d.l0P,vCx:()=>d.vCx,_AM:()=>d._AM,wuA:()=>d.wuA,av9:()=>d.av9,CtA:()=>d.CtA,mIn:()=>Kh,FIo:()=>d.FIo,zHn:()=>d.zHn,iMs:()=>d.iMs,T_f:()=>d.T_f,hEm:()=>d.hEm,D9w:()=>d.D9w,CdI:()=>d.CdI,TIb:()=>La,rpg:()=>d.rpg,ce8:()=>d.ce8,rOj:()=>d.rOj,V4E:()=>d.V4E,o8S:()=>d.o8S,lGU:()=>d.lGU,vuL:()=>d.vuL,KI_:()=>d.KI_,xsS:()=>d.xsS,b26:()=>ve,WdD:()=>d.WdD,Vj0:()=>d.Vj0,jyz:()=>d.jyz,Tn7:()=>d.Tn7,bnF:()=>d.bnF,HW6:()=>d.HW6,oa8:()=>d.oa8,T_1:()=>d.T_1,iDF:()=>d.iDF,iAb:()=>d.iAb,OdW:()=>d.OdW,_YX:()=>d._YX,TUv:()=>d.TUv,Hw6:()=>d.Hw6,aLr:()=>d.aLr,Aip:()=>d.Aip,xo$:()=>d.xo$,$V:()=>d.$V,lDi:()=>d.lDi,gti:()=>d.gti,PMe:()=>d.PMe,FvO:()=>d.FvO,jyi:()=>d.jyi,xeV:()=>d.xeV,k74:()=>d.k74,RlZ:()=>d.RlZ,KhW:()=>d.KhW,HgB:()=>d.HgB,W2J:()=>d.W2J,JWc:()=>d.JWc,kP0:()=>u1,u37:()=>d.u37,Z6B:()=>d.Z6B,QZ1:()=>d.QZ1,Ir4:()=>d.Ir4,NwF:()=>d.NwF,Wbm:()=>d.Wbm,N4l:()=>d.N4l,QmN:()=>d.QmN,wes:()=>o,IOt:()=>d.IOt,L5g:()=>d.L5g,H$k:()=>d.H$k,xEZ:()=>d.xEZ,YQ_:()=>Oh,Yin:()=>wi,dpR:()=>d.dpR,Cne:()=>d.Cne,XvJ:()=>d.XvJ,XZw:()=>d.XZw,FE5:()=>d.FE5,Ys8:()=>ia,CJI:()=>d.CJI,z$h:()=>d.z$h,UlW:()=>d.UlW,WwZ:()=>d.WwZ,Lcc:()=>d.Lcc,WXh:()=>d.WXh,ub3:()=>d.ub3,xfE:()=>d.xfE,qlB:()=>d.qlB,lCJ:()=>d.lCJ,WTc:()=>d.WTc,rAo:()=>d.rAo,xWb:()=>d.xWb,gH0:()=>d.gH0,rBU:()=>d.rBU,rDY:()=>d.rDY,ywz:()=>d.ywz,wJv:()=>d.wJv,JQ4:()=>d.JQ4,k0A:()=>d.k0A,irR:()=>d.irR,LsT:()=>d.LsT,MiG:()=>ri,dwk:()=>d.dwk,FM8:()=>d.FM8,Pa4:()=>d.Pa4,Ltg:()=>d.Ltg,yC1:()=>d.yC1,fO1:()=>d.fO1,AEx:()=>zh,_9o:()=>Om,k5T:()=>vl,b5g:()=>d.b5g,Ywn:()=>d.Ywn,GVz:()=>d.GVz,oAp:()=>d.oAp,kFz:()=>d.kFz,dd2:()=>d.dd2,CP7:()=>d.CP7,fQK:()=>d.fQK,Uk6:()=>d.Uk6,_sL:()=>d._sL,Pnf:()=>d.Pnf,c8b:()=>d.c8b,_lf:()=>d._lf,ad5:()=>d.ad5,L_r:()=>d.L_r,eC3:()=>Ei,BRj:()=>gs,rif:()=>ms,HOT:()=>Yt.HO,jfB:()=>Yt.jf,bkz:()=>vo,lDs:()=>Xo,tQ:()=>Pt,Oe_:()=>wo,YRX:()=>y,S6$:()=>p,CbL:()=>Yt.Cb,knz:()=>d.knz,lKs:()=>q,GaT:()=>nl,OEW:()=>gr});var o={};r.r(o),r.d(o,{Easing:()=>_n.Easing,Group:()=>_n.Group,Interpolation:()=>_n.Interpolation,Sequence:()=>_n.Sequence,Tween:()=>_n.Tween,TweenChain:()=>_u.TweenChain,TweenManager:()=>Tm,VERSION:()=>_n.VERSION,__esModule:()=>_n.__esModule,add:()=>_n.add,getAll:()=>_n.getAll,nextId:()=>_n.nextId,now:()=>_n.now,remove:()=>_n.remove,removeAll:()=>_n.removeAll,update:()=>_n.update});var p={};r.r(p),r.d(p,{Box:()=>Nm,Capsule:()=>X0,Circle:()=>zm,Cone:()=>Gn,Cylinder:()=>eo,Dodecahedron:()=>ra,Edges:()=>wf,Extrude:()=>sa,Icosahedron:()=>uc,Lathe:()=>hc,Octahedron:()=>Gm,Plane:()=>Yh,Polyhedron:()=>Af,Ring:()=>Sf,Shape:()=>Os,Sphere:()=>Y0,Tetrahedron:()=>Ir,Torus:()=>Hm,TorusKnot:()=>to,Tube:()=>Qh,Wireframe:()=>Mf});var y={};r.r(y),r.d(y,{Alpha:()=>n1,BaseRenderer:()=>fy,Behaviour:()=>nd,Color:()=>i1,Controller:()=>cy,Emitter:()=>e1,Force:()=>dy,GPURenderer:()=>l1,Gravity:()=>r1,Particle:()=>Qm,Scale:()=>s1,System:()=>Km,copyProperties:()=>qw,ease:()=>Iu,setPrototypeByObj:()=>Of});var d=r(25);const E=`
uniform sampler2D   tCameraDepth;
uniform vec2        uCameraNearFar;

float getLinearEyeDepth(const in float fragCoordZ) {
    #if PERSPECTIVE_CAMERA == 1
        return -perspectiveDepthToViewZ(fragCoordZ, uCameraNearFar.x, uCameraNearFar.y );
    #else
        return -orthographicDepthToViewZ(fragCoordZ, uCameraNearFar.x, uCameraNearFar.y );
    #endif
}

float getLinear01Depth(const in float fragCoordZ) {
    #if PERSPECTIVE_CAMERA == 1
        float viewZ = perspectiveDepthToViewZ( fragCoordZ, uCameraNearFar.x, uCameraNearFar.y );
        return viewZToOrthographicDepth( viewZ, uCameraNearFar.x, uCameraNearFar.y );
    #else
        return fragCoordZ;
    #endif
}

float sampleDepth(const in vec2 screenPosition) {
    #if DEPTH_PACKING == 3201
        return unpackRGBAToDepth(texture2D(tCameraDepth, screenPosition));
    #else
        return texture2D(tCameraDepth, screenPosition).r;
    #endif
}

float sampleLinearEyeDepth(const in vec2 screenPosition) {
    return getLinearEyeDepth(sampleDepth(screenPosition));
}

float sampleLinear01Depth(const in vec2 screenPosition) {
    return getLinear01Depth(sampleDepth(screenPosition));
}
`,L=`
#include <common>

float remap(float origFrom, float origTo, float targetFrom, float targetTo, float value) {
    return mix(targetFrom, targetTo, (value - origFrom) / (origTo - origFrom));
}

float remap01(float origFrom, float origTo, float value) {
    return saturate((value - origFrom) / (origTo - origFrom));
}

float remap10(float origFrom, float origTo, float value) {
    return saturate((origFrom - value) / (origTo - origFrom));
}

bool isPower2(int x) {
    return (x & (x - 1)) == 0;
}

// Input [0, 1] and output [0, PI/2]
// 9 VALU
float fastACosPos(float inX) {
    float x = abs(inX);
    float res = (0.0468878 * x + -0.203471) * x + 1.570796; // p(x)
    res *= sqrt(1.0 - x);

    return res;
}

// Ref: https://seblagarde.wordpress.com/2014/12/01/inverse-trigonometric-functions-gpu-optimization-for-amd-gcn-architecture/
// Input [-1, 1] and output [0, PI]
// 12 VALU
float fastACos(float inX) {
    float res = fastACosPos(inX);

    return (inX >= 0.) ? res : PI - res; // Undo range reduction
}

// Same cost as Acos + 1 FR
// Same error
// input [-1, 1] and output [-PI/2, PI/2]
float fastASin(float x) {
    return PI_HALF - fastACos(x);
}

// max absolute error 1.3x10^-3
// Eberly's odd polynomial degree 5 - respect bounds
// 4 VGPR, 14 FR (10 FR, 1 QR), 2 scalar
// input [0, infinity] and output [0, PI/2]
float fastATanPos(float x) {
    float t0 = (x < 1.0) ? x : 1.0 / x;
    float t1 = t0 * t0;
    float poly = 0.0872929;
    poly = -0.301895 + poly * t1;
    poly = 1.0 + poly * t1;
    poly = poly * t0;
    return (x < 1.0) ? poly : PI_HALF - poly;
}

// 4 VGPR, 16 FR (12 FR, 1 QR), 2 scalar
// input [-infinity, infinity] and output [-PI/2, PI/2]
float fastATan(float x) {
    float t0 = fastATanPos(abs(x));
    return (x < 0.0) ? -t0 : t0;
}

float fastAtan2(float y, float x) {
    return fastATan(y / x) + float(y >= 0.0 ? PI : -PI) * step(0., x);
}

// smoothstep that assumes that 'x' lies within the [0, 1] interval.
float smoothstep01(float x) {
    return x * x * (3. - (2. * x));
}

float smootherstep01(float x) {
  return x * x * x * (x * (x * 6. - 15.) + 10.);
}

// ref https://www.gamedev.net/topic/678043-how-to-blend-world-space-normals/#entry5287707
// assume compositing in world space
// Note: Using vtxNormal = vec3(0, 0, 1) give the blendNormalRNM formulation.
// TODO: Untested
vec3 blendNormalWorldspaceRNM(vec3 n1, vec3 n2, vec3 vtxNormal) {
    // Build the shortest-arc quaternion
    vec4 q = vec4(cross(vtxNormal, n2), dot(vtxNormal, n2) + 1.0) / sqrt(2.0 * (dot(vtxNormal, n2) + 1.));

    // Rotate the normal
    return n1 * (q.w * q.w - dot(q.xyz, q.xyz)) + 2. * q.xyz * dot(q.xyz, n1) + 2. * q.w * cross(q.xyz, n1);
}

// ref http://blog.selfshadow.com/publications/blending-in-detail/
// ref https://gist.github.com/selfshadow/8048308
// Reoriented Normal Mapping
// Blending when n1 and n2 are already 'unpacked' and normalised
// assume compositing in tangent space
vec3 blendNormalRNM(vec3 n1, vec3 n2) {
    vec3 t = n1.xyz + vec3(0.0, 0.0, 1.0);
    vec3 u = n2.xyz * vec3(-1.0, -1.0, 1.0);
    vec3 r = (t / t.z) * dot(t, u) - u;
    return r;
}

// assume compositing in tangent space
vec3 blendNormal(vec3 n1, vec3 n2) {
    return normalize(vec3(n1.xy * n2.z + n2.xy * n1.z, n1.z * n2.z));
}

vec2 cartesianToPolar(float x, float y, float z) {
    vec2 polar;
    polar.x = atan(z, x); // phi
    polar.y = asin(y); // theta
    return polar;
}

vec3 polarToCartesian(float phi, float theta) {
    vec3 cartesian;
    cartesian.x = sin(theta) * cos(phi);
    cartesian.y = cos(theta);
    cartesian.z = sin(theta) * sin(phi);
    return cartesian;
}

vec2 dirToUv(vec3 dir) {
    return cartesianToPolar(dir.x, dir.y, dir.z) * vec2(RECIPROCAL_PI2, RECIPROCAL_PI) + 0.5;
}

vec3 uvToDir(vec2 uv) {
    return polarToCartesian((uv.x - 0.5) * PI2, uv.y * PI);
}
`,k=`
mat4 getInstanceMatrix(vec3 p, vec4 q, vec3 s) {
    mat4 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    float sx = s.x;
    float sy = s.y;
    float sz = s.z;
    m[0][0] = (1. - (yy + zz)) * sx;
    m[0][1] = (xy + wz) * sx;
    m[0][2] = (xz - wy) * sx;
    m[0][3] = 0.;
    m[1][0] = (xy - wz) * sy;
    m[1][1] = (1. - (xx + zz)) * sy;
    m[1][2] = (yz + wx) * sy;
    m[1][3] = 0.;
    m[2][0] = (xz + wy) * sz;
    m[2][1] = (yz - wx) * sz;
    m[2][2] = (1. - (xx + yy)) * sz;
    m[2][3] = 0.;
    m[3][0] = p.x;
    m[3][1] = p.y;
    m[3][2] = p.z;
    m[3][3] = 1.;
    return m;
}
mat3 getInstanceRotationMatrix(vec4 q) {
    mat3 m;
    float x = q.x;
    float y = q.y;
    float z = q.z;
    float w = q.w;
    float x2 = x + x;
    float y2 = y + y;
    float z2 = z + z;
    float xx = x * x2;
    float xy = x * y2;
    float xz = x * z2;
    float yy = y * y2;
    float yz = y * z2;
    float zz = z * z2;
    float wx = w * x2;
    float wy = w * y2;
    float wz = w * z2;
    m[0][0] = (1. - (yy + zz));
    m[0][1] = (xy + wz);
    m[0][2] = (xz - wy);
    m[1][0] = (xy - wz);
    m[1][1] = (1. - (xx + zz));
    m[1][2] = (yz + wx);
    m[2][0] = (xz + wy);
    m[2][1] = (yz - wx);
    m[2][2] = (1. - (xx + yy));
    return m;
}
`;d.WdD.xv_common=L,d.WdD.xv_matrix=k,d.WdD.xv_camera_depth=E;const{lerp:X,clamp01:$}=d.MathUtils;function Z(S,h,l,f,v){const x=(f-h)*.5,b=(v-l)*.5,P=S*S,I=S*P;return(2*l-2*f+x+b)*I+(-3*l+3*f-2*x-b)*P+x*S+l}class ge{constructor(h=0,l=0,f=0){B(this,"x");B(this,"y");B(this,"mode",0);this.set(h,l),this.mode=f}set(h,l){return this.x=h,this.y=l,this}lerp(h,l,f=this){return f.x=X(this.x,h.x,l),f.y=X(this.y,h.y,l),f}}class be{constructor(h="",l=[new ge(0,0),new ge(1,1)]){B(this,"name");B(this,"points");B(this,"isAnimationCurve",!0);B(this,"needsUpdate",!0);B(this,"_samples",100);B(this,"_interpolant",new d.lfu(new Float32Array(100),new Float32Array(100),1,new Float32Array(100)));this.name=h,this.points=l}_getInterpolant(h){return this._samples!==h&&(this._samples=h,this._interpolant=new d.lfu(new Float32Array(h),new Float32Array(h),1,new Float32Array(h))),this._interpolant}resample(h=100){const l=1/(h-1),f=this._getInterpolant(h),v=f.parameterPositions,x=f.sampleValues,b=new ge;for(let P=0;P<h;P++)this.getPoint(P*l,b),v[P]=b.x,x[P]=b.y}evaluate(h){return this.needsUpdate&&(this.needsUpdate=!1,this.resample()),this._interpolant.evaluate(h)[0]}getPoint(h,l){const f=this.points;if(h<=0)return l.set(h,f[0].y);if(h>=1)return l.set(h,f[f.length-1].y);const v=(f.length-1)*h,x=Math.floor(v),b=v-x,P=f[x===0?x:x-1],I=f[x],z=f[x>f.length-2?f.length-1:x+1],Q=f[x>f.length-3?f.length-1:x+2];return I.mode===1||P===I&&z.mode===1?I.lerp(z,b,l):l.set($(Z(b,P.x,I.x,z.x,Q.x)),$(Z(b,P.y,I.y,z.y,Q.y)))}}const{floor:ye}=Math,bl=class bl{static Noise(h,l,f){let v=bl._Fade,x=bl._Grad,b=bl._Lerp,P=bl._Permutation;if(l!==void 0&&f!==void 0){let I=ye(h),z=ye(l),Q=ye(f),H=I&255,ee=z&255,fe=Q&255;h-=I,l-=z,f-=Q;let Se=v(h),De=v(l),Re=v(f),Te=P[H]+ee,Oe=P[Te]+fe,Ae=P[Te+1]+fe,ke=P[H+1]+ee,lt=P[ke]+fe,wt=P[ke+1]+fe;return b(Re,b(De,b(Se,x(P[Oe],h,l,f),x(P[lt],h-1,l,f)),b(Se,x(P[Ae],h,l-1,f),x(P[wt],h-1,l-1,f))),b(De,b(Se,x(P[Oe+1],h,l,f-1),x(P[lt+1],h-1,l,f-1)),b(Se,x(P[Ae+1],h,l-1,f-1),x(P[wt+1],h-1,l-1,f-1))))}else if(l!==void 0){let I=ye(h),z=ye(l),Q=I&255,H=z&255;h-=I,l-=z;let ee=v(h),fe=v(l),Se=P[Q]+H&255,De=P[Q+1]+H&255;return b(fe,b(ee,x(P[Se],h,l),x(P[De],h-1,l)),b(ee,x(P[Se+1],h,l-1),x(P[De+1],h-1,l-1)))}else{let I=ye(h),z=I&255;h-=I;let Q=v(h);return b(Q,x(P[z],h),x(P[z+1],h-1))}}static Fbm(h,l,f,v){let x=0,b=.5,P=bl.Noise;if(f!==void 0&&v!==void 0)for(let I=0;I<h;I++)x+=b*P(l,f,v),l*=2,f*=2,v*=2,b*=.5;else if(f!==void 0)for(let I=0;I<h;I++)x+=b*P(l,f),l*=2,f*=2,b*=.5;else for(let I=0;I<h;I++)x+=b*P(l),l*=2,b*=.5;return x}static _Fade(h){return h*h*h*(h*(h*6-15)+10)}static _Lerp(h,l,f){return l+h*(f-l)}static _Grad(h,l,f,v){if(f!==void 0&&v!==void 0){let x=h&15,b=x<8?l:f,P=x<4?f:x==12||x==14?l:v;return(x&1?-b:b)+(x&2?-P:P)}else return f!==void 0?(h&1?-l:l)+(h&2?-f:f):h&1?-l:l}};B(bl,"_Permutation",[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180,151]);let $e=bl;Array.prototype.remove=function(S){let h=this.indexOf(S);h>-1&&this.splice(h,1)};var ce;(function(S){S[S.AUTO=0]="AUTO",S[S.LANDSCAPE=1]="LANDSCAPE",S[S.PORTRAIT=2]="PORTRAIT"})(ce||(ce={}));var ie=r(930);class U{constructor(h,l,f,v){B(this,"_target",null);B(this,"_callback",null);B(this,"_interval",0);B(this,"_repeat",0);B(this,"_elapsed",0);B(this,"_lastTime",0);B(this,"_repeatForever",!1);B(this,"_pause",!1);this._target=h,this._callback=l,this._interval=f,this._repeat=v,this._repeatForever=v===-1}get pause(){return this._pause}set pause(h){this._pause=h}get target(){return this._target}get callback(){return this._callback}get lived(){return this._repeat>0||this._repeatForever}update(h){this._pause||(this._repeat>0||this._repeatForever)&&(this._elapsed+=h,this._elapsed>=this._interval&&(this.trigger(this._elapsed-this._lastTime),this._elapsed-=this._interval,this._lastTime=this._elapsed,this._repeat--))}trigger(h){this._target&&this._callback&&this._callback.call(this._target,h,this._elapsed)}}class re{constructor(h,l){B(this,"_target");B(this,"_callers");this._target=h,this._callers=l}get target(){return this._target}get callers(){return this._callers}}class ve{constructor(){B(this,"_callers",{});B(this,"_callersArray",[])}pause(h){let l=this._callers[h.uuid];l&&l.forEach(f=>f.pause=!0)}resume(h){let l=this._callers[h.uuid];l&&l.forEach(f=>f.pause=!1)}schedule(h,l,f,v){let x=this._callers[h.uuid];x===void 0&&(x=this._callers[h.uuid]=[],this._callersArray.push(new re(h,x))),x.push(new U(h,l,f,v))}unshedule(h,l){let f=this._callers[h.uuid];if(f){let v=f.findIndex(x=>x.callback===l);v!==-1&&f.splice(v,1)}}unscheduleAll(h){delete this._callers[h.uuid];let l=this._callersArray.findIndex(f=>f.target===h);l!==-1&&this._callersArray.splice(l,1)}update(h){let l,f=this._callersArray;for(let v=f.length;v--;){l=f[v].callers;for(let x=l.length;x--;)l[x].lived?l[x].update(h):l.splice(x,1)}}}const{degToRad:Be}=d.MathUtils;function Ge(S,h,l=!1){for(let f in h){let v=h[f];if(v===void 0)continue;let x=f.split("-"),b=S,P=b;for(let I=0,z=x.length;I<z;I++){let Q=x[I];if(l||P.hasOwnProperty(Q)||P.constructor.prototype.hasOwnProperty(Q)){if(b=P[Q],I==z-1){let H=Object.getOwnPropertyDescriptor(P,Q);!H||H.writable||H.set?P[Q]=v:b&&b.copy&&b.copy(v)}P=b}}}return S}function Ie(...S){let h=new d.Ilk;return S.length===1?h.set(S[0]):S.length===3&&h.setRGB(S[0],S[1],S[2]),h}function Ct(S,h,l,f){let v=new d.Ilk().setHex((S<<16)+(h<<8)+l);return f!==void 0?new d.Ltg(v.r,v.g,v.b,f/255):v}function vt(S,h){return new d.FM8(S,h??S)}function Sn(S,h,l){return new d.Pa4(S,h??S,l??S)}function Oi(S,h,l,f){return new d.Ltg(S,h??S,l??S,f??S)}function Fi(S,h,l,f=!1){return f?new d.USm(Be(S),Be(h),Be(l)):new d.USm(S,h,l)}function $r(S,h,l,f){return new d._fP(S,h,l,f)}function Ei(S,h=new d.Ltg){return h.x=S.r,h.y=S.g,h.z=S.b,h}function gr(S,h=new d.Ilk){return h.r=S.x,h.g=S.y,h.b=S.z,h}function ms(S){return S!=null}var mt=r(591);class tn{constructor(h){B(this,"viewer");B(this,"name","");this.viewer=h}}class yn{constructor(h,l,f){B(this,"texture");B(this,"texCoords");B(this,"meshCoords");this.texture=h,this.texCoords=l,this.meshCoords=f}}const fi={x:.5,y:.5};class wi{constructor(h,l){B(this,"json");B(this,"texture");B(this,"_spriteFrames",{});B(this,"_animations",{});this.json=h,this.texture=l;let f=h.meta.size,v=h.meta.scale/Math.max(f.w,f.h),x=h.frames;for(let b in x){let{frame:P,sourceSize:I,spriteSourceSize:z,anchor:Q}=x[b],H=P.x/f.w,ee=P.y/f.h,fe=P.w/f.w,Se=P.h/f.h,De=I,Re=z,Te=Q||fi,Oe=v;this._spriteFrames[b]=new yn(l,new d.Ltg(H,1-(ee+Se),fe,Se),new d.Ltg(Re.x+.5*Re.w-De.w*Te.x,-(Re.y+.5*Re.h-De.h*Te.y),Re.w,Re.h).multiplyScalar(Oe))}for(let b in h.animations)this._animations[b]=h.animations[b].map(P=>this._spriteFrames[P])}getAnimation(h){return this._animations[h]}getSpriteFrame(h){return this._spriteFrames[h]}}function Ds(S){let h=S.split(".");return h.length>1?h.pop():""}function es(S){let h=S.lastIndexOf("/");return h!==-1?S.substring(0,h):""}function ba(S,h){let l=S.split("/").pop();return h?l.replace("."+h,""):l}function gs(S){let h="",l=null,f="";return typeof File<"u"&&S instanceof File?(h=S.name,f=Ds(h),l=S):typeof S=="object"?(h=S.mainFile.name,f=Ds(h),l=S):(h+=S,f=Ds(h)),{url:h,file:l,ext:f}}function vo(S,h){let l=[S];for(let f in h)h[f]!==void 0&&l.push(f+"="+h[f]);return l.join(",")}const Hs=["flipY","mapping","wrapS","wrapT","dataType","magFilter","minFilter","format","anisotropy","encoding","repeat"];function nl(S){let h={};for(let l of Hs)S[l]!==void 0&&(l==="dataType"?h.type=S[l]:h[l]=S[l]);return h}class vr extends tn{constructor(){super(...arguments);B(this,"extensions",["atlas"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b,texSettings:P}){(async()=>{try{let I=await this.viewer.loadAsset({url:l,selExt:"json"}),z=await this.viewer.loadAsset({url:`${es(l)}/${I.meta.image}`,onProgress:x});v(new wi(I,Object.assign(z,P)))}catch(I){b(I)}})()}}class ru extends tn{constructor(){super(...arguments);B(this,"extensions",["mp3","wav","ogg"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b}){new d.mTL(this.viewer.loadingManager).load(l,v,x,b,f)}}var G=r(477),Xl=function(S){return URL.createObjectURL(new Blob([S],{type:"text/javascript"}))};try{URL.revokeObjectURL(Xl(""))}catch{Xl=function(h){return"data:application/javascript;charset=UTF-8,"+encodeURI(h)}}var Qi=Uint8Array,lr=Uint16Array,zr=Uint32Array,Gr=new Qi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yl=new Qi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bh=new Qi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ql=function(S,h){for(var l=new lr(31),f=0;f<31;++f)l[f]=h+=1<<S[f-1];for(var v=new zr(l[30]),f=1;f<30;++f)for(var x=l[f];x<l[f+1];++x)v[x]=x-l[f]<<5|f;return[l,v]},su=Ql(Gr,2),ou=su[0],Kl=su[1];ou[28]=258,Kl[258]=28;for(var yo=Ql(Yl,0),_o=yo[0],Ho=new lr(32768),zn=0;zn<32768;++zn){var yr=(zn&43690)>>>1|(zn&21845)<<1;yr=(yr&52428)>>>2|(yr&13107)<<2,yr=(yr&61680)>>>4|(yr&3855)<<4,Ho[zn]=((yr&65280)>>>8|(yr&255)<<8)>>>1}for(var Vs=function(S,h,l){for(var f=S.length,v=0,x=new lr(h);v<f;++v)++x[S[v]-1];var b=new lr(h);for(v=0;v<h;++v)b[v]=b[v-1]+x[v-1]<<1;var P;if(l){P=new lr(1<<h);var I=15-h;for(v=0;v<f;++v)if(S[v])for(var z=v<<4|S[v],Q=h-S[v],H=b[S[v]-1]++<<Q,ee=H|(1<<Q)-1;H<=ee;++H)P[Ho[H]>>>I]=z}else for(P=new lr(f),v=0;v<f;++v)S[v]&&(P[v]=Ho[b[S[v]-1]++]>>>15-S[v]);return P},Bi=new Qi(288),zn=0;zn<144;++zn)Bi[zn]=8;for(var zn=144;zn<256;++zn)Bi[zn]=9;for(var zn=256;zn<280;++zn)Bi[zn]=7;for(var zn=280;zn<288;++zn)Bi[zn]=8;for(var wa=new Qi(32),zn=0;zn<32;++zn)wa[zn]=5;var Ti=Vs(Bi,9,1),ql=Vs(wa,5,1),au=function(S){for(var h=S[0],l=1;l<S.length;++l)S[l]>h&&(h=S[l]);return h},_r=function(S,h,l){var f=h/8|0;return(S[f]|S[f+1]<<8)>>(h&7)&l},lu=function(S,h){var l=h/8|0;return(S[l]|S[l+1]<<8|S[l+2]<<16)>>(h&7)},Ci=function(S){return(S/8|0)+(S&7&&1)},cu=function(S,h,l){(h==null||h<0)&&(h=0),(l==null||l>S.length)&&(l=S.length);var f=new(S instanceof lr?lr:S instanceof zr?zr:Qi)(l-h);return f.set(S.subarray(h,l)),f},nf=function(S,h,l){var f=S.length;if(!f||l&&!l.l&&f<5)return h||new Qi(0);var v=!h||l,x=!l||l.i;l||(l={}),h||(h=new Qi(f*3));var b=function(mi){var Va=h.length;if(mi>Va){var Wa=new Qi(Math.max(Va*2,mi));Wa.set(h),h=Wa}},P=l.f||0,I=l.p||0,z=l.b||0,Q=l.l,H=l.d,ee=l.m,fe=l.n,Se=f*8;do{if(!Q){l.f=P=_r(S,I,1);var De=_r(S,I+1,3);if(I+=3,De)if(De==1)Q=Ti,H=ql,ee=9,fe=5;else if(De==2){var Ae=_r(S,I,31)+257,ke=_r(S,I+10,15)+4,lt=Ae+_r(S,I+5,31)+1;I+=14;for(var wt=new Qi(lt),xt=new Qi(19),Ft=0;Ft<ke;++Ft)xt[bh[Ft]]=_r(S,I+Ft*3,7);I+=ke*3;for(var Rt=au(xt),on=(1<<Rt)-1,Nt=Vs(xt,Rt,1),Ft=0;Ft<lt;){var In=Nt[_r(S,I,on)];I+=In&15;var Re=In>>>4;if(Re<16)wt[Ft++]=Re;else{var Ai=0,$n=0;for(Re==16?($n=3+_r(S,I,3),I+=2,Ai=wt[Ft-1]):Re==17?($n=3+_r(S,I,7),I+=3):Re==18&&($n=11+_r(S,I,127),I+=7);$n--;)wt[Ft++]=Ai}}var Fn=wt.subarray(0,Ae),nr=wt.subarray(Ae);ee=au(Fn),fe=au(nr),Q=Vs(Fn,ee,1),H=Vs(nr,fe,1)}else throw"invalid block type";else{var Re=Ci(I)+4,Te=S[Re-4]|S[Re-3]<<8,Oe=Re+Te;if(Oe>f){if(x)throw"unexpected EOF";break}v&&b(z+Te),h.set(S.subarray(Re,Oe),z),l.b=z+=Te,l.p=I=Oe*8;continue}if(I>Se){if(x)throw"unexpected EOF";break}}v&&b(z+131072);for(var ui=(1<<ee)-1,Ui=(1<<fe)-1,Ri=I;;Ri=I){var Ai=Q[lu(S,I)&ui],ir=Ai>>>4;if(I+=Ai&15,I>Se){if(x)throw"unexpected EOF";break}if(!Ai)throw"invalid length/literal";if(ir<256)h[z++]=ir;else if(ir==256){Ri=I,Q=null;break}else{var Do=ir-254;if(ir>264){var Ft=ir-257,hr=Gr[Ft];Do=_r(S,I,(1<<hr)-1)+ou[Ft],I+=hr}var Ha=H[lu(S,I)&Ui],aa=Ha>>>4;if(!Ha)throw"invalid distance";I+=Ha&15;var nr=_o[aa];if(aa>3){var hr=Yl[aa];nr+=lu(S,I)&(1<<hr)-1,I+=hr}if(I>Se){if(x)throw"unexpected EOF";break}v&&b(z+131072);for(var id=z+Do;z<id;z+=4)h[z]=h[z-nr],h[z+1]=h[z+1-nr],h[z+2]=h[z+2-nr],h[z+3]=h[z+3-nr];z=id}}l.l=Q,l.p=Ri,l.b=z,Q&&(P=1,l.m=ee,l.d=H,l.n=fe)}while(!P);return z==h.length?h:cu(h,0,z)},xo=new Qi(0),rf=function(S){if((S[0]&15)!=8||S[0]>>>4>7||(S[0]<<8|S[1])%31)throw"invalid zlib data";if(S[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ts(S,h){return nf((rf(S),S.subarray(2,-4)),h)}var wh=typeof TextDecoder<"u"&&new TextDecoder,Ah=0;try{wh.decode(xo,{stream:!0}),Ah=1}catch{}class uu extends G.yxD{constructor(h){super(h),this.type=G.cLu}parse(h){const Rt=Math.pow(2.7182818,2.2);function on(j,te){let pe=0;for(let Ye=0;Ye<65536;++Ye)(Ye==0||j[Ye>>3]&1<<(Ye&7))&&(te[pe++]=Ye);const Ee=pe-1;for(;pe<65536;)te[pe++]=0;return Ee}function Nt(j){for(let te=0;te<16384;te++)j[te]={},j[te].len=0,j[te].lit=0,j[te].p=null}const In={l:0,c:0,lc:0};function Ai(j,te,pe,Ee,Ye){for(;pe<j;)te=te<<8|by(Ee,Ye),pe+=8;pe-=j,In.l=te>>pe&(1<<j)-1,In.c=te,In.lc=pe}const $n=new Array(59);function Fn(j){for(let pe=0;pe<=58;++pe)$n[pe]=0;for(let pe=0;pe<65537;++pe)$n[j[pe]]+=1;let te=0;for(let pe=58;pe>0;--pe){const Ee=te+$n[pe]>>1;$n[pe]=te,te=Ee}for(let pe=0;pe<65537;++pe){const Ee=j[pe];Ee>0&&(j[pe]=Ee|$n[Ee]++<<6)}}function nr(j,te,pe,Ee,Ye,ze){const st=te;let bt=0,St=0;for(;Ee<=Ye;Ee++){if(st.value-te.value>pe)return!1;Ai(6,bt,St,j,st);const ot=In.l;if(bt=In.c,St=In.lc,ze[Ee]=ot,ot==63){if(st.value-te.value>pe)throw new Error("Something wrong with hufUnpackEncTable");Ai(8,bt,St,j,st);let dt=In.l+6;if(bt=In.c,St=In.lc,Ee+dt>Ye+1)throw new Error("Something wrong with hufUnpackEncTable");for(;dt--;)ze[Ee++]=0;Ee--}else if(ot>=59){let dt=ot-59+2;if(Ee+dt>Ye+1)throw new Error("Something wrong with hufUnpackEncTable");for(;dt--;)ze[Ee++]=0;Ee--}}Fn(ze)}function ui(j){return j&63}function Ui(j){return j>>6}function Ri(j,te,pe,Ee){for(;te<=pe;te++){const Ye=Ui(j[te]),ze=ui(j[te]);if(Ye>>ze)throw new Error("Invalid table entry");if(ze>14){const st=Ee[Ye>>ze-14];if(st.len)throw new Error("Invalid table entry");if(st.lit++,st.p){const bt=st.p;st.p=new Array(st.lit);for(let St=0;St<st.lit-1;++St)st.p[St]=bt[St]}else st.p=new Array(1);st.p[st.lit-1]=te}else if(ze){let st=0;for(let bt=1<<14-ze;bt>0;bt--){const St=Ee[(Ye<<14-ze)+st];if(St.len||St.p)throw new Error("Invalid table entry");St.len=ze,St.lit=te,st++}}}return!0}const ir={c:0,lc:0};function Do(j,te,pe,Ee){j=j<<8|by(pe,Ee),te+=8,ir.c=j,ir.lc=te}const hr={c:0,lc:0};function Ha(j,te,pe,Ee,Ye,ze,st,bt,St){if(j==te){Ee<8&&(Do(pe,Ee,Ye,ze),pe=ir.c,Ee=ir.lc),Ee-=8;let ot=pe>>Ee;if(ot=new Uint8Array([ot])[0],bt.value+ot>St)return!1;const dt=st[bt.value-1];for(;ot-- >0;)st[bt.value++]=dt}else if(bt.value<St)st[bt.value++]=j;else return!1;hr.c=pe,hr.lc=Ee}function aa(j){return j&65535}function id(j){const te=aa(j);return te>32767?te-65536:te}const mi={a:0,b:0};function Va(j,te){const pe=id(j),Ye=id(te),ze=pe+(Ye&1)+(Ye>>1),st=ze,bt=ze-Ye;mi.a=st,mi.b=bt}function Wa(j,te){const pe=aa(j),Ee=aa(te),Ye=pe-(Ee>>1)&65535,ze=Ee+Ye-32768&65535;mi.a=ze,mi.b=Ye}function h1(j,te,pe,Ee,Ye,ze,st){const bt=st<16384,St=pe>Ye?Ye:pe;let ot=1,dt,Ht;for(;ot<=St;)ot<<=1;for(ot>>=1,dt=ot,ot>>=1;ot>=1;){Ht=0;const Xt=Ht+ze*(Ye-dt),un=ze*ot,Dn=ze*dt,Jt=Ee*ot,nn=Ee*dt;let On,Di,Ni,Xr;for(;Ht<=Xt;Ht+=Dn){let xi=Ht;const Nn=Ht+Ee*(pe-dt);for(;xi<=Nn;xi+=nn){const rr=xi+Jt,Bs=xi+un,dr=Bs+Jt;bt?(Va(j[xi+te],j[Bs+te]),On=mi.a,Ni=mi.b,Va(j[rr+te],j[dr+te]),Di=mi.a,Xr=mi.b,Va(On,Di),j[xi+te]=mi.a,j[rr+te]=mi.b,Va(Ni,Xr),j[Bs+te]=mi.a,j[dr+te]=mi.b):(Wa(j[xi+te],j[Bs+te]),On=mi.a,Ni=mi.b,Wa(j[rr+te],j[dr+te]),Di=mi.a,Xr=mi.b,Wa(On,Di),j[xi+te]=mi.a,j[rr+te]=mi.b,Wa(Ni,Xr),j[Bs+te]=mi.a,j[dr+te]=mi.b)}if(pe&ot){const rr=xi+un;bt?Va(j[xi+te],j[rr+te]):Wa(j[xi+te],j[rr+te]),On=mi.a,j[rr+te]=mi.b,j[xi+te]=On}}if(Ye&ot){let xi=Ht;const Nn=Ht+Ee*(pe-dt);for(;xi<=Nn;xi+=nn){const rr=xi+Jt;bt?Va(j[xi+te],j[rr+te]):Wa(j[xi+te],j[rr+te]),On=mi.a,j[rr+te]=mi.b,j[xi+te]=On}}dt=ot,ot>>=1}return Ht}function d1(j,te,pe,Ee,Ye,ze,st,bt,St){let ot=0,dt=0;const Ht=st,Xt=Math.trunc(Ee.value+(Ye+7)/8);for(;Ee.value<Xt;)for(Do(ot,dt,pe,Ee),ot=ir.c,dt=ir.lc;dt>=14;){const Dn=ot>>dt-14&16383,Jt=te[Dn];if(Jt.len)dt-=Jt.len,Ha(Jt.lit,ze,ot,dt,pe,Ee,bt,St,Ht),ot=hr.c,dt=hr.lc;else{if(!Jt.p)throw new Error("hufDecode issues");let nn;for(nn=0;nn<Jt.lit;nn++){const On=ui(j[Jt.p[nn]]);for(;dt<On&&Ee.value<Xt;)Do(ot,dt,pe,Ee),ot=ir.c,dt=ir.lc;if(dt>=On&&Ui(j[Jt.p[nn]])==(ot>>dt-On&(1<<On)-1)){dt-=On,Ha(Jt.p[nn],ze,ot,dt,pe,Ee,bt,St,Ht),ot=hr.c,dt=hr.lc;break}}if(nn==Jt.lit)throw new Error("hufDecode issues")}}const un=8-Ye&7;for(ot>>=un,dt-=un;dt>0;){const Dn=te[ot<<14-dt&16383];if(Dn.len)dt-=Dn.len,Ha(Dn.lit,ze,ot,dt,pe,Ee,bt,St,Ht),ot=hr.c,dt=hr.lc;else throw new Error("hufDecode issues")}return!0}function my(j,te,pe,Ee,Ye,ze){const st={value:0},bt=pe.value,St=Ss(te,pe),ot=Ss(te,pe);pe.value+=4;const dt=Ss(te,pe);if(pe.value+=4,St<0||St>=65537||ot<0||ot>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const Ht=new Array(65537),Xt=new Array(16384);Nt(Xt);const un=Ee-(pe.value-bt);if(nr(j,pe,un,St,ot,Ht),dt>8*(Ee-(pe.value-bt)))throw new Error("Something wrong with hufUncompress");Ri(Ht,St,ot,Xt),d1(Ht,Xt,j,pe,dt,ot,ze,Ye,st)}function f1(j,te,pe){for(let Ee=0;Ee<pe;++Ee)te[Ee]=j[te[Ee]]}function gy(j){for(let te=1;te<j.length;te++){const pe=j[te-1]+j[te]-128;j[te]=pe}}function vy(j,te){let pe=0,Ee=Math.floor((j.length+1)/2),Ye=0;const ze=j.length-1;for(;!(Ye>ze||(te[Ye++]=j[pe++],Ye>ze));)te[Ye++]=j[Ee++]}function yy(j){let te=j.byteLength;const pe=new Array;let Ee=0;const Ye=new DataView(j);for(;te>0;){const ze=Ye.getInt8(Ee++);if(ze<0){const st=-ze;te-=st+1;for(let bt=0;bt<st;bt++)pe.push(Ye.getUint8(Ee++))}else{const st=ze;te-=2;const bt=Ye.getUint8(Ee++);for(let St=0;St<st+1;St++)pe.push(bt)}}return pe}function p1(j,te,pe,Ee,Ye,ze){let st=new DataView(ze.buffer);const bt=pe[j.idx[0]].width,St=pe[j.idx[0]].height,ot=3,dt=Math.floor(bt/8),Ht=Math.ceil(bt/8),Xt=Math.ceil(St/8),un=bt-(Ht-1)*8,Dn=St-(Xt-1)*8,Jt={value:0},nn=new Array(ot),On=new Array(ot),Di=new Array(ot),Ni=new Array(ot),Xr=new Array(ot);for(let Nn=0;Nn<ot;++Nn)Xr[Nn]=te[j.idx[Nn]],nn[Nn]=Nn<1?0:nn[Nn-1]+Ht*Xt,On[Nn]=new Float32Array(64),Di[Nn]=new Uint16Array(64),Ni[Nn]=new Uint16Array(Ht*64);for(let Nn=0;Nn<Xt;++Nn){let rr=8;Nn==Xt-1&&(rr=Dn);let Bs=8;for(let ii=0;ii<Ht;++ii){ii==Ht-1&&(Bs=un);for(let gi=0;gi<ot;++gi)Di[gi].fill(0),Di[gi][0]=Ye[nn[gi]++],m1(Jt,Ee,Di[gi]),g1(Di[gi],On[gi]),v1(On[gi]);y1(On);for(let gi=0;gi<ot;++gi)_1(On[gi],Ni[gi],ii*64)}let dr=0;for(let ii=0;ii<ot;++ii){const gi=pe[j.idx[ii]].type;for(let la=8*Nn;la<8*Nn+rr;++la){dr=Xr[ii][la];for(let Fu=0;Fu<dt;++Fu){const ro=Fu*64+(la&7)*8;st.setUint16(dr+0*2*gi,Ni[ii][ro+0],!0),st.setUint16(dr+1*2*gi,Ni[ii][ro+1],!0),st.setUint16(dr+2*2*gi,Ni[ii][ro+2],!0),st.setUint16(dr+3*2*gi,Ni[ii][ro+3],!0),st.setUint16(dr+4*2*gi,Ni[ii][ro+4],!0),st.setUint16(dr+5*2*gi,Ni[ii][ro+5],!0),st.setUint16(dr+6*2*gi,Ni[ii][ro+6],!0),st.setUint16(dr+7*2*gi,Ni[ii][ro+7],!0),dr+=8*2*gi}}if(dt!=Ht)for(let la=8*Nn;la<8*Nn+rr;++la){const Fu=Xr[ii][la]+8*dt*2*gi,ro=dt*64+(la&7)*8;for(let Bu=0;Bu<Bs;++Bu)st.setUint16(Fu+Bu*2*gi,Ni[ii][ro+Bu],!0)}}}const xi=new Uint16Array(bt);st=new DataView(ze.buffer);for(let Nn=0;Nn<ot;++Nn){pe[j.idx[Nn]].decoded=!0;const rr=pe[j.idx[Nn]].type;if(pe[Nn].type==2)for(let Bs=0;Bs<St;++Bs){const dr=Xr[Nn][Bs];for(let ii=0;ii<bt;++ii)xi[ii]=st.getUint16(dr+ii*2*rr,!0);for(let ii=0;ii<bt;++ii)st.setFloat32(dr+ii*2*rr,Gt(xi[ii]),!0)}}}function m1(j,te,pe){let Ee,Ye=1;for(;Ye<64;)Ee=te[j.value],Ee==65280?Ye=64:Ee>>8==255?Ye+=Ee&255:(pe[Ye]=Ee,Ye++),j.value++}function g1(j,te){te[0]=Gt(j[0]),te[1]=Gt(j[1]),te[2]=Gt(j[5]),te[3]=Gt(j[6]),te[4]=Gt(j[14]),te[5]=Gt(j[15]),te[6]=Gt(j[27]),te[7]=Gt(j[28]),te[8]=Gt(j[2]),te[9]=Gt(j[4]),te[10]=Gt(j[7]),te[11]=Gt(j[13]),te[12]=Gt(j[16]),te[13]=Gt(j[26]),te[14]=Gt(j[29]),te[15]=Gt(j[42]),te[16]=Gt(j[3]),te[17]=Gt(j[8]),te[18]=Gt(j[12]),te[19]=Gt(j[17]),te[20]=Gt(j[25]),te[21]=Gt(j[30]),te[22]=Gt(j[41]),te[23]=Gt(j[43]),te[24]=Gt(j[9]),te[25]=Gt(j[11]),te[26]=Gt(j[18]),te[27]=Gt(j[24]),te[28]=Gt(j[31]),te[29]=Gt(j[40]),te[30]=Gt(j[44]),te[31]=Gt(j[53]),te[32]=Gt(j[10]),te[33]=Gt(j[19]),te[34]=Gt(j[23]),te[35]=Gt(j[32]),te[36]=Gt(j[39]),te[37]=Gt(j[45]),te[38]=Gt(j[52]),te[39]=Gt(j[54]),te[40]=Gt(j[20]),te[41]=Gt(j[22]),te[42]=Gt(j[33]),te[43]=Gt(j[38]),te[44]=Gt(j[46]),te[45]=Gt(j[51]),te[46]=Gt(j[55]),te[47]=Gt(j[60]),te[48]=Gt(j[21]),te[49]=Gt(j[34]),te[50]=Gt(j[37]),te[51]=Gt(j[47]),te[52]=Gt(j[50]),te[53]=Gt(j[56]),te[54]=Gt(j[59]),te[55]=Gt(j[61]),te[56]=Gt(j[35]),te[57]=Gt(j[36]),te[58]=Gt(j[48]),te[59]=Gt(j[49]),te[60]=Gt(j[57]),te[61]=Gt(j[58]),te[62]=Gt(j[62]),te[63]=Gt(j[63])}function v1(j){const te=.5*Math.cos(.7853975),pe=.5*Math.cos(3.14159/16),Ee=.5*Math.cos(3.14159/8),Ye=.5*Math.cos(3*3.14159/16),ze=.5*Math.cos(5*3.14159/16),st=.5*Math.cos(3*3.14159/8),bt=.5*Math.cos(7*3.14159/16),St=new Array(4),ot=new Array(4),dt=new Array(4),Ht=new Array(4);for(let Xt=0;Xt<8;++Xt){const un=Xt*8;St[0]=Ee*j[un+2],St[1]=st*j[un+2],St[2]=Ee*j[un+6],St[3]=st*j[un+6],ot[0]=pe*j[un+1]+Ye*j[un+3]+ze*j[un+5]+bt*j[un+7],ot[1]=Ye*j[un+1]-bt*j[un+3]-pe*j[un+5]-ze*j[un+7],ot[2]=ze*j[un+1]-pe*j[un+3]+bt*j[un+5]+Ye*j[un+7],ot[3]=bt*j[un+1]-ze*j[un+3]+Ye*j[un+5]-pe*j[un+7],dt[0]=te*(j[un+0]+j[un+4]),dt[3]=te*(j[un+0]-j[un+4]),dt[1]=St[0]+St[3],dt[2]=St[1]-St[2],Ht[0]=dt[0]+dt[1],Ht[1]=dt[3]+dt[2],Ht[2]=dt[3]-dt[2],Ht[3]=dt[0]-dt[1],j[un+0]=Ht[0]+ot[0],j[un+1]=Ht[1]+ot[1],j[un+2]=Ht[2]+ot[2],j[un+3]=Ht[3]+ot[3],j[un+4]=Ht[3]-ot[3],j[un+5]=Ht[2]-ot[2],j[un+6]=Ht[1]-ot[1],j[un+7]=Ht[0]-ot[0]}for(let Xt=0;Xt<8;++Xt)St[0]=Ee*j[16+Xt],St[1]=st*j[16+Xt],St[2]=Ee*j[48+Xt],St[3]=st*j[48+Xt],ot[0]=pe*j[8+Xt]+Ye*j[24+Xt]+ze*j[40+Xt]+bt*j[56+Xt],ot[1]=Ye*j[8+Xt]-bt*j[24+Xt]-pe*j[40+Xt]-ze*j[56+Xt],ot[2]=ze*j[8+Xt]-pe*j[24+Xt]+bt*j[40+Xt]+Ye*j[56+Xt],ot[3]=bt*j[8+Xt]-ze*j[24+Xt]+Ye*j[40+Xt]-pe*j[56+Xt],dt[0]=te*(j[Xt]+j[32+Xt]),dt[3]=te*(j[Xt]-j[32+Xt]),dt[1]=St[0]+St[3],dt[2]=St[1]-St[2],Ht[0]=dt[0]+dt[1],Ht[1]=dt[3]+dt[2],Ht[2]=dt[3]-dt[2],Ht[3]=dt[0]-dt[1],j[0+Xt]=Ht[0]+ot[0],j[8+Xt]=Ht[1]+ot[1],j[16+Xt]=Ht[2]+ot[2],j[24+Xt]=Ht[3]+ot[3],j[32+Xt]=Ht[3]-ot[3],j[40+Xt]=Ht[2]-ot[2],j[48+Xt]=Ht[1]-ot[1],j[56+Xt]=Ht[0]-ot[0]}function y1(j){for(let te=0;te<64;++te){const pe=j[0][te],Ee=j[1][te],Ye=j[2][te];j[0][te]=pe+1.5747*Ye,j[1][te]=pe-.1873*Ee-.4682*Ye,j[2][te]=pe+1.8556*Ee}}function _1(j,te,pe){for(let Ee=0;Ee<64;++Ee)te[pe+Ee]=G.A5E.toHalfFloat(x1(j[Ee]))}function x1(j){return j<=1?Math.sign(j)*Math.pow(Math.abs(j),2.2):Math.sign(j)*Math.pow(Rt,Math.abs(j)-1)}function _y(j){return new DataView(j.array.buffer,j.offset.value,j.size)}function b1(j){const te=j.viewer.buffer.slice(j.offset.value,j.offset.value+j.size),pe=new Uint8Array(yy(te)),Ee=new Uint8Array(pe.length);return gy(pe),vy(pe,Ee),new DataView(Ee.buffer)}function Jm(j){const te=j.array.slice(j.offset.value,j.offset.value+j.size),pe=ts(te),Ee=new Uint8Array(pe.length);return gy(pe),vy(pe,Ee),new DataView(Ee.buffer)}function w1(j){const te=j.viewer,pe={value:j.offset.value},Ee=new Uint16Array(j.width*j.scanlineBlockSize*(j.channels*j.type)),Ye=new Uint8Array(8192);let ze=0;const st=new Array(j.channels);for(let Dn=0;Dn<j.channels;Dn++)st[Dn]={},st[Dn].start=ze,st[Dn].end=st[Dn].start,st[Dn].nx=j.width,st[Dn].ny=j.lines,st[Dn].size=j.type,ze+=st[Dn].nx*st[Dn].ny*st[Dn].size;const bt=sd(te,pe),St=sd(te,pe);if(St>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(bt<=St)for(let Dn=0;Dn<St-bt+1;Dn++)Ye[Dn+bt]=Ou(te,pe);const ot=new Uint16Array(65536),dt=on(Ye,ot),Ht=Ss(te,pe);my(j.array,te,pe,Ht,Ee,ze);for(let Dn=0;Dn<j.channels;++Dn){const Jt=st[Dn];for(let nn=0;nn<st[Dn].size;++nn)h1(Ee,Jt.start+nn,Jt.nx,Jt.size,Jt.ny,Jt.nx*Jt.size,dt)}f1(ot,Ee,ze);let Xt=0;const un=new Uint8Array(Ee.buffer.byteLength);for(let Dn=0;Dn<j.lines;Dn++)for(let Jt=0;Jt<j.channels;Jt++){const nn=st[Jt],On=nn.nx*nn.size,Di=new Uint8Array(Ee.buffer,nn.end*2,On*2);un.set(Di,Xt),Xt+=On*2,nn.end+=On}return new DataView(un.buffer)}function A1(j){const te=j.array.slice(j.offset.value,j.offset.value+j.size),pe=ts(te),Ee=j.lines*j.channels*j.width,Ye=j.type==1?new Uint16Array(Ee):new Uint32Array(Ee);let ze=0,st=0;const bt=new Array(4);for(let St=0;St<j.lines;St++)for(let ot=0;ot<j.channels;ot++){let dt=0;switch(j.type){case 1:bt[0]=ze,bt[1]=bt[0]+j.width,ze=bt[1]+j.width;for(let Ht=0;Ht<j.width;++Ht){const Xt=pe[bt[0]++]<<8|pe[bt[1]++];dt+=Xt,Ye[st]=dt,st++}break;case 2:bt[0]=ze,bt[1]=bt[0]+j.width,bt[2]=bt[1]+j.width,ze=bt[2]+j.width;for(let Ht=0;Ht<j.width;++Ht){const Xt=pe[bt[0]++]<<24|pe[bt[1]++]<<16|pe[bt[2]++]<<8;dt+=Xt,Ye[st]=dt,st++}break}}return new DataView(Ye.buffer)}function xy(j){const te=j.viewer,pe={value:j.offset.value},Ee=new Uint8Array(j.width*j.lines*(j.channels*j.type*2)),Ye={version:io(te,pe),unknownUncompressedSize:io(te,pe),unknownCompressedSize:io(te,pe),acCompressedSize:io(te,pe),dcCompressedSize:io(te,pe),rleCompressedSize:io(te,pe),rleUncompressedSize:io(te,pe),rleRawSize:io(te,pe),totalAcUncompressedCount:io(te,pe),totalDcUncompressedCount:io(te,pe),acCompression:io(te,pe)};if(Ye.version<2)throw new Error("EXRLoader.parse: "+ja.compression+" version "+Ye.version+" is unsupported");const ze=new Array;let st=sd(te,pe)-2;for(;st>0;){const Jt=Ff(te.buffer,pe),nn=Ou(te,pe),On=nn>>2&3,Di=(nn>>4)-1,Ni=new Int8Array([Di])[0],Xr=Ou(te,pe);ze.push({name:Jt,index:Ni,type:Xr,compression:On}),st-=Jt.length+3}const bt=ja.channels,St=new Array(j.channels);for(let Jt=0;Jt<j.channels;++Jt){const nn=St[Jt]={},On=bt[Jt];nn.name=On.name,nn.compression=0,nn.decoded=!1,nn.type=On.pixelType,nn.pLinear=On.pLinear,nn.width=j.width,nn.height=j.lines}const ot={idx:new Array(3)};for(let Jt=0;Jt<j.channels;++Jt){const nn=St[Jt];for(let On=0;On<ze.length;++On){const Di=ze[On];nn.name==Di.name&&(nn.compression=Di.compression,Di.index>=0&&(ot.idx[Di.index]=Jt),nn.offset=Jt)}}let dt,Ht,Xt;if(Ye.acCompressedSize>0)switch(Ye.acCompression){case 0:dt=new Uint16Array(Ye.totalAcUncompressedCount),my(j.array,te,pe,Ye.acCompressedSize,dt,Ye.totalAcUncompressedCount);break;case 1:const Jt=j.array.slice(pe.value,pe.value+Ye.totalAcUncompressedCount),nn=ts(Jt);dt=new Uint16Array(nn.buffer),pe.value+=Ye.totalAcUncompressedCount;break}if(Ye.dcCompressedSize>0){const Jt={array:j.array,offset:pe,size:Ye.dcCompressedSize};Ht=new Uint16Array(Jm(Jt).buffer),pe.value+=Ye.dcCompressedSize}if(Ye.rleRawSize>0){const Jt=j.array.slice(pe.value,pe.value+Ye.rleCompressedSize),nn=ts(Jt);Xt=yy(nn.buffer),pe.value+=Ye.rleCompressedSize}let un=0;const Dn=new Array(St.length);for(let Jt=0;Jt<Dn.length;++Jt)Dn[Jt]=new Array;for(let Jt=0;Jt<j.lines;++Jt)for(let nn=0;nn<St.length;++nn)Dn[nn].push(un),un+=St[nn].width*j.type*2;p1(ot,Dn,St,dt,Ht,Ee);for(let Jt=0;Jt<St.length;++Jt){const nn=St[Jt];if(!nn.decoded)switch(nn.compression){case 2:let On=0,Di=0;for(let Ni=0;Ni<j.lines;++Ni){let Xr=Dn[Jt][On];for(let xi=0;xi<nn.width;++xi){for(let Nn=0;Nn<2*nn.type;++Nn)Ee[Xr++]=Xt[Di+Nn*nn.width*nn.height];Di++}On++}break;case 1:default:throw new Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(Ee.buffer)}function Ff(j,te){const pe=new Uint8Array(j);let Ee=0;for(;pe[te.value+Ee]!=0;)Ee+=1;const Ye=new TextDecoder().decode(pe.slice(te.value,te.value+Ee));return te.value=te.value+Ee+1,Ye}function S1(j,te,pe){const Ee=new TextDecoder().decode(new Uint8Array(j).slice(te.value,te.value+pe));return te.value=te.value+pe,Ee}function M1(j,te){const pe=rd(j,te),Ee=Ss(j,te);return[pe,Ee]}function E1(j,te){const pe=Ss(j,te),Ee=Ss(j,te);return[pe,Ee]}function rd(j,te){const pe=j.getInt32(te.value,!0);return te.value=te.value+4,pe}function Ss(j,te){const pe=j.getUint32(te.value,!0);return te.value=te.value+4,pe}function by(j,te){const pe=j[te.value];return te.value=te.value+1,pe}function Ou(j,te){const pe=j.getUint8(te.value);return te.value=te.value+1,pe}const io=function(j,te){let pe;return"getBigInt64"in DataView.prototype?pe=Number(j.getBigInt64(te.value,!0)):pe=j.getUint32(te.value+4,!0)+Number(j.getUint32(te.value,!0)<<32),te.value+=8,pe};function Wr(j,te){const pe=j.getFloat32(te.value,!0);return te.value+=4,pe}function T1(j,te){return G.A5E.toHalfFloat(Wr(j,te))}function Gt(j){const te=(j&31744)>>10,pe=j&1023;return(j>>15?-1:1)*(te?te===31?pe?NaN:1/0:Math.pow(2,te-15)*(1+pe/1024):6103515625e-14*(pe/1024))}function sd(j,te){const pe=j.getUint16(te.value,!0);return te.value+=2,pe}function C1(j,te){return Gt(sd(j,te))}function P1(j,te,pe,Ee){const Ye=pe.value,ze=[];for(;pe.value<Ye+Ee-1;){const st=Ff(te,pe),bt=rd(j,pe),St=Ou(j,pe);pe.value+=3;const ot=rd(j,pe),dt=rd(j,pe);ze.push({name:st,pixelType:bt,pLinear:St,xSampling:ot,ySampling:dt})}return pe.value+=1,ze}function R1(j,te){const pe=Wr(j,te),Ee=Wr(j,te),Ye=Wr(j,te),ze=Wr(j,te),st=Wr(j,te),bt=Wr(j,te),St=Wr(j,te),ot=Wr(j,te);return{redX:pe,redY:Ee,greenX:Ye,greenY:ze,blueX:st,blueY:bt,whiteX:St,whiteY:ot}}function D1(j,te){const pe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Ee=Ou(j,te);return pe[Ee]}function I1(j,te){const pe=Ss(j,te),Ee=Ss(j,te),Ye=Ss(j,te),ze=Ss(j,te);return{xMin:pe,yMin:Ee,xMax:Ye,yMax:ze}}function L1(j,te){const pe=["INCREASING_Y"],Ee=Ou(j,te);return pe[Ee]}function O1(j,te){const pe=Wr(j,te),Ee=Wr(j,te);return[pe,Ee]}function F1(j,te){const pe=Wr(j,te),Ee=Wr(j,te),Ye=Wr(j,te);return[pe,Ee,Ye]}function B1(j,te,pe,Ee,Ye){if(Ee==="string"||Ee==="stringvector"||Ee==="iccProfile")return S1(te,pe,Ye);if(Ee==="chlist")return P1(j,te,pe,Ye);if(Ee==="chromaticities")return R1(j,pe);if(Ee==="compression")return D1(j,pe);if(Ee==="box2i")return I1(j,pe);if(Ee==="lineOrder")return L1(j,pe);if(Ee==="float")return Wr(j,pe);if(Ee==="v2f")return O1(j,pe);if(Ee==="v3f")return F1(j,pe);if(Ee==="int")return rd(j,pe);if(Ee==="rational")return M1(j,pe);if(Ee==="timecode")return E1(j,pe);if(Ee==="preview")return pe.value+=Ye,"skipped";pe.value+=Ye}function k1(j,te,pe){const Ee={};if(j.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");Ee.version=j.getUint8(4);const Ye=j.getUint8(5);Ee.spec={singleTile:!!(Ye&2),longName:!!(Ye&4),deepFormat:!!(Ye&8),multiPart:!!(Ye&16)},pe.value=8;let ze=!0;for(;ze;){const st=Ff(te,pe);if(st==0)ze=!1;else{const bt=Ff(te,pe),St=Ss(j,pe),ot=B1(j,te,pe,bt,St);ot===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${bt}'.`):Ee[st]=ot}}if(Ye&-5)throw console.error("EXRHeader:",Ee),new Error("THREE.EXRLoader: provided file is currently unsupported.");return Ee}function U1(j,te,pe,Ee,Ye){const ze={size:0,viewer:te,array:pe,offset:Ee,width:j.dataWindow.xMax-j.dataWindow.xMin+1,height:j.dataWindow.yMax-j.dataWindow.yMin+1,channels:j.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:j.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(j.compression){case"NO_COMPRESSION":ze.lines=1,ze.uncompress=_y;break;case"RLE_COMPRESSION":ze.lines=1,ze.uncompress=b1;break;case"ZIPS_COMPRESSION":ze.lines=1,ze.uncompress=Jm;break;case"ZIP_COMPRESSION":ze.lines=16,ze.uncompress=Jm;break;case"PIZ_COMPRESSION":ze.lines=32,ze.uncompress=w1;break;case"PXR24_COMPRESSION":ze.lines=16,ze.uncompress=A1;break;case"DWAA_COMPRESSION":ze.lines=32,ze.uncompress=xy;break;case"DWAB_COMPRESSION":ze.lines=256,ze.uncompress=xy;break;default:throw new Error("EXRLoader.parse: "+j.compression+" is unsupported")}if(ze.scanlineBlockSize=ze.lines,ze.type==1)switch(Ye){case G.VzW:ze.getter=C1,ze.inputSize=2;break;case G.cLu:ze.getter=sd,ze.inputSize=2;break}else if(ze.type==2)switch(Ye){case G.VzW:ze.getter=Wr,ze.inputSize=4;break;case G.cLu:ze.getter=T1,ze.inputSize=4}else throw new Error("EXRLoader.parse: unsupported pixelType "+ze.type+" for "+j.compression+".");ze.blockCount=(j.dataWindow.yMax+1)/ze.scanlineBlockSize;for(let bt=0;bt<ze.blockCount;bt++)io(te,Ee);ze.outputChannels=ze.channels==3?4:ze.channels;const st=ze.width*ze.height*ze.outputChannels;switch(Ye){case G.VzW:ze.byteArray=new Float32Array(st),ze.channels<ze.outputChannels&&ze.byteArray.fill(1,0,st);break;case G.cLu:ze.byteArray=new Uint16Array(st),ze.channels<ze.outputChannels&&ze.byteArray.fill(15360,0,st);break;default:console.error("THREE.EXRLoader: unsupported type: ",Ye);break}return ze.bytesPerLine=ze.width*ze.inputSize*ze.channels,ze.outputChannels==4?(ze.format=G.wk1,ze.encoding=G.rnI):(ze.format=G.hEm,ze.encoding=G.rnI),ze}const En=new DataView(h),Et=new Uint8Array(h),jr={value:0},ja=k1(En,h,jr),Bn=U1(ja,En,Et,jr,this.type),$m={value:0},wy={R:0,G:1,B:2,A:3,Y:0};for(let j=0;j<Bn.height/Bn.scanlineBlockSize;j++){const te=Ss(En,jr);Bn.size=Ss(En,jr),Bn.lines=te+Bn.scanlineBlockSize>Bn.height?Bn.height-te:Bn.scanlineBlockSize;const Ee=Bn.size<Bn.lines*Bn.bytesPerLine?Bn.uncompress(Bn):_y(Bn);jr.value+=Bn.size;for(let Ye=0;Ye<Bn.scanlineBlockSize;Ye++){const ze=Ye+j*Bn.scanlineBlockSize;if(ze>=Bn.height)break;for(let st=0;st<Bn.channels;st++){const bt=wy[ja.channels[st].name];for(let St=0;St<Bn.width;St++){$m.value=(Ye*(Bn.channels*Bn.width)+st*Bn.width+St)*Bn.inputSize;const ot=(Bn.height-1-ze)*(Bn.width*Bn.outputChannels)+St*Bn.outputChannels+bt;Bn.byteArray[ot]=Bn.getter(Ee,$m)}}}}return{header:ja,width:Bn.width,height:Bn.height,data:Bn.byteArray,format:Bn.format,encoding:Bn.encoding,type:this.type}}setDataType(h){return this.type=h,this}load(h,l,f,v){function x(b,P){b.encoding=P.encoding,b.minFilter=G.wem,b.magFilter=G.wem,b.generateMipmaps=!1,b.flipY=!1,l&&l(b,P)}return super.load(h,x,f,v)}}class hu extends tn{constructor(){super(...arguments);B(this,"extensions",["exr"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b,texSettings:P}){new uu(this.viewer.loadingManager).load(l,I=>v(Object.assign(I,P)),x,b,f)}}function Ws(S,h,l){const f=l.length-S-1;if(h>=l[f])return f-1;if(h<=l[S])return S;let v=S,x=f,b=Math.floor((v+x)/2);for(;h<l[b]||h>=l[b+1];)h<l[b]?x=b:v=b,b=Math.floor((v+x)/2);return b}function js(S,h,l,f){const v=[],x=[],b=[];v[0]=1;for(let P=1;P<=l;++P){x[P]=h-f[S+1-P],b[P]=f[S+P]-h;let I=0;for(let z=0;z<P;++z){const Q=b[z+1],H=x[P-z],ee=v[z]/(Q+H);v[z]=I+Q*ee,I=H*ee}v[P]=I}return v}function Aa(S,h,l,f){const v=Ws(S,f,h),x=js(v,f,S,h),b=new G.Ltg(0,0,0,0);for(let P=0;P<=S;++P){const I=l[v-S+P],z=x[P],Q=I.w*z;b.x+=I.x*Q,b.y+=I.y*Q,b.z+=I.z*Q,b.w+=I.w*z}return b}function Sh(S,h,l,f,v){const x=[];for(let H=0;H<=l;++H)x[H]=0;const b=[];for(let H=0;H<=f;++H)b[H]=x.slice(0);const P=[];for(let H=0;H<=l;++H)P[H]=x.slice(0);P[0][0]=1;const I=x.slice(0),z=x.slice(0);for(let H=1;H<=l;++H){I[H]=h-v[S+1-H],z[H]=v[S+H]-h;let ee=0;for(let fe=0;fe<H;++fe){const Se=z[fe+1],De=I[H-fe];P[H][fe]=Se+De;const Re=P[fe][H-1]/P[H][fe];P[fe][H]=ee+Se*Re,ee=De*Re}P[H][H]=ee}for(let H=0;H<=l;++H)b[0][H]=P[H][l];for(let H=0;H<=l;++H){let ee=0,fe=1;const Se=[];for(let De=0;De<=l;++De)Se[De]=x.slice(0);Se[0][0]=1;for(let De=1;De<=f;++De){let Re=0;const Te=H-De,Oe=l-De;H>=De&&(Se[fe][0]=Se[ee][0]/P[Oe+1][Te],Re=Se[fe][0]*P[Te][Oe]);const Ae=Te>=-1?1:-Te,ke=H-1<=Oe?De-1:l-H;for(let wt=Ae;wt<=ke;++wt)Se[fe][wt]=(Se[ee][wt]-Se[ee][wt-1])/P[Oe+1][Te+wt],Re+=Se[fe][wt]*P[Te+wt][Oe];H<=Oe&&(Se[fe][De]=-Se[ee][De-1]/P[Oe+1][H],Re+=Se[fe][De]*P[H][Oe]),b[De][H]=Re;const lt=ee;ee=fe,fe=lt}}let Q=l;for(let H=1;H<=f;++H){for(let ee=0;ee<=l;++ee)b[H][ee]*=Q;Q*=l-H}return b}function Mh(S,h,l,f,v){const x=v<S?v:S,b=[],P=Ws(S,f,h),I=Sh(P,f,S,x,h),z=[];for(let Q=0;Q<l.length;++Q){const H=l[Q].clone(),ee=H.w;H.x*=ee,H.y*=ee,H.z*=ee,z[Q]=H}for(let Q=0;Q<=x;++Q){const H=z[P-S].clone().multiplyScalar(I[Q][0]);for(let ee=1;ee<=S;++ee)H.add(z[P-S+ee].clone().multiplyScalar(I[Q][ee]));b[Q]=H}for(let Q=x+1;Q<=v+1;++Q)b[Q]=new G.Ltg(0,0,0);return b}function Vo(S,h){let l=1;for(let v=2;v<=S;++v)l*=v;let f=1;for(let v=2;v<=h;++v)f*=v;for(let v=2;v<=S-h;++v)f*=v;return l/f}function Eh(S){const h=S.length,l=[],f=[];for(let x=0;x<h;++x){const b=S[x];l[x]=new G.Pa4(b.x,b.y,b.z),f[x]=b.w}const v=[];for(let x=0;x<h;++x){const b=l[x].clone();for(let P=1;P<=x;++P)b.sub(v[x-P].clone().multiplyScalar(Vo(x,P)*f[P]));v[x]=b.divideScalar(f[0])}return v}function Hr(S,h,l,f,v){const x=Mh(S,h,l,f,v);return Eh(x)}class Th extends G.Hyl{constructor(h,l,f,v,x){super(),this.degree=h,this.knots=l,this.controlPoints=[],this.startKnot=v||0,this.endKnot=x||this.knots.length-1;for(let b=0;b<f.length;++b){const P=f[b];this.controlPoints[b]=new G.Ltg(P.x,P.y,P.z,P.w)}}getPoint(h,l=new G.Pa4){const f=l,v=this.knots[this.startKnot]+h*(this.knots[this.endKnot]-this.knots[this.startKnot]),x=Aa(this.degree,this.knots,this.controlPoints,v);return x.w!==1&&x.divideScalar(x.w),f.set(x.x,x.y,x.z)}getTangent(h,l=new G.Pa4){const f=l,v=this.knots[0]+h*(this.knots[this.knots.length-1]-this.knots[0]),x=Hr(this.degree,this.knots,this.controlPoints,v,1);return f.copy(x[1]).normalize(),f}}let Pn,Kn,ki;class Ch extends G.aNw{constructor(h){super(h)}load(h,l,f,v,x){const b=this,P=b.path===""?G.Zp0.extractUrlBase(h):b.path,I=new G.hH6(this.manager);I.setPath(b.path),I.setResponseType("arraybuffer"),I.setRequestHeader(b.requestHeader),I.setWithCredentials(b.withCredentials),I.load(h,function(z){try{l(b.parse(z,P))}catch(Q){v?v(Q):console.error(Q),b.manager.itemError(h)}},f,v,x==null?void 0:x.mainFile)}parse(h,l){if(sl(h))Pn=new Zl().parse(h);else{const v=Wo(h);if(!du(v))throw new Error("THREE.FBXLoader: Unknown format.");if(Jl(v)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Jl(v));Pn=new Ih().parse(v)}const f=new G.dpR(this.manager).setPath(this.resourcePath||l).setCrossOrigin(this.crossOrigin);return new Ph(f,this.manager).parse(Pn)}}class Ph{constructor(h,l){this.textureLoader=h,this.manager=l}parse(){Kn=this.parseConnections();const h=this.parseImages(),l=this.parseTextures(h),f=this.parseMaterials(l),v=this.parseDeformers(),x=new Rh().parse(v);return this.parseScene(v,x,f),ki}parseConnections(){const h=new Map;return"Connections"in Pn&&Pn.Connections.connections.forEach(function(f){const v=f[0],x=f[1],b=f[2];h.has(v)||h.set(v,{parents:[],children:[]});const P={ID:x,relationship:b};h.get(v).parents.push(P),h.has(x)||h.set(x,{parents:[],children:[]});const I={ID:v,relationship:b};h.get(x).children.push(I)}),h}parseImages(){const h={},l={};if("Video"in Pn.Objects){const f=Pn.Objects.Video;for(const v in f){const x=f[v],b=parseInt(v);if(h[b]=x.RelativeFilename||x.Filename,"Content"in x){const P=x.Content instanceof ArrayBuffer&&x.Content.byteLength>0,I=typeof x.Content=="string"&&x.Content!=="";if(P||I){const z=this.parseImage(f[v]);l[x.RelativeFilename||x.Filename]=z}}}}for(const f in h){const v=h[f];l[v]!==void 0?h[f]=l[v]:h[f]=h[f].split("\\").pop()}return h}parseImage(h){const l=h.Content,f=h.RelativeFilename||h.Filename,v=f.slice(f.lastIndexOf(".")+1).toLowerCase();let x;switch(v){case"bmp":x="image/bmp";break;case"jpg":case"jpeg":x="image/jpeg";break;case"png":x="image/png";break;case"tif":x="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",f),x="image/tga";break;default:console.warn('FBXLoader: Image type "'+v+'" is not supported.');return}if(typeof l=="string")return"data:"+x+";base64,"+l;{const b=new Uint8Array(l);return window.URL.createObjectURL(new Blob([b],{type:x}))}}parseTextures(h){const l=new Map;if("Texture"in Pn.Objects){const f=Pn.Objects.Texture;for(const v in f){const x=this.parseTexture(f[v],h);l.set(parseInt(v),x)}}return l}parseTexture(h,l){const f=this.loadTexture(h,l);f.ID=h.id,f.name=h.attrName;const v=h.WrapModeU,x=h.WrapModeV,b=v!==void 0?v.value:0,P=x!==void 0?x.value:0;if(f.wrapS=b===0?G.rpg:G.uWy,f.wrapT=P===0?G.rpg:G.uWy,"Scaling"in h){const I=h.Scaling.value;f.repeat.x=I[0],f.repeat.y=I[1]}if("Translation"in h){const I=h.Translation.value;f.offset.x=I[0],f.offset.y=I[1]}return f}loadTexture(h,l){let f;const v=this.textureLoader.path,x=Kn.get(h.id).children;x!==void 0&&x.length>0&&l[x[0].ID]!==void 0&&(f=l[x[0].ID],(f.indexOf("blob:")===0||f.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let b;const P=h.FileName.slice(-3).toLowerCase();if(P==="tga"){const I=this.manager.getHandler(".tga");I===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",h.RelativeFilename),b=new G.xEZ):(I.setPath(this.textureLoader.path),b=I.load(f))}else P==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",h.RelativeFilename),b=new G.xEZ):b=this.textureLoader.load(f);return this.textureLoader.setPath(v),b}parseMaterials(h){const l=new Map;if("Material"in Pn.Objects){const f=Pn.Objects.Material;for(const v in f){const x=this.parseMaterial(f[v],h);x!==null&&l.set(parseInt(v),x)}}return l}parseMaterial(h,l){const f=h.id,v=h.attrName;let x=h.ShadingModel;if(typeof x=="object"&&(x=x.value),!Kn.has(f))return null;const b=this.parseParameters(h,l,f);let P;switch(x.toLowerCase()){case"phong":P=new G.xoR;break;case"lambert":P=new G.YBo;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',x),P=new G.xoR;break}return P.setValues(b),P.name=v,P}parseParameters(h,l,f){const v={};h.BumpFactor&&(v.bumpScale=h.BumpFactor.value),h.Diffuse?v.color=new G.Ilk().fromArray(h.Diffuse.value):h.DiffuseColor&&(h.DiffuseColor.type==="Color"||h.DiffuseColor.type==="ColorRGB")&&(v.color=new G.Ilk().fromArray(h.DiffuseColor.value)),h.DisplacementFactor&&(v.displacementScale=h.DisplacementFactor.value),h.Emissive?v.emissive=new G.Ilk().fromArray(h.Emissive.value):h.EmissiveColor&&(h.EmissiveColor.type==="Color"||h.EmissiveColor.type==="ColorRGB")&&(v.emissive=new G.Ilk().fromArray(h.EmissiveColor.value)),h.EmissiveFactor&&(v.emissiveIntensity=parseFloat(h.EmissiveFactor.value)),h.Opacity&&(v.opacity=parseFloat(h.Opacity.value)),v.opacity<1&&(v.transparent=!0),h.ReflectionFactor&&(v.reflectivity=h.ReflectionFactor.value),h.Shininess&&(v.shininess=h.Shininess.value),h.Specular?v.specular=new G.Ilk().fromArray(h.Specular.value):h.SpecularColor&&h.SpecularColor.type==="Color"&&(v.specular=new G.Ilk().fromArray(h.SpecularColor.value));const x=this;return Kn.get(f).children.forEach(function(b){const P=b.relationship;switch(P){case"Bump":v.bumpMap=x.getTexture(l,b.ID);break;case"Maya|TEX_ao_map":v.aoMap=x.getTexture(l,b.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":v.map=x.getTexture(l,b.ID),v.map!==void 0&&(v.map.encoding=G.knz);break;case"DisplacementColor":v.displacementMap=x.getTexture(l,b.ID);break;case"EmissiveColor":v.emissiveMap=x.getTexture(l,b.ID),v.emissiveMap!==void 0&&(v.emissiveMap.encoding=G.knz);break;case"NormalMap":case"Maya|TEX_normal_map":v.normalMap=x.getTexture(l,b.ID);break;case"ReflectionColor":v.envMap=x.getTexture(l,b.ID),v.envMap!==void 0&&(v.envMap.mapping=G.dSO,v.envMap.encoding=G.knz);break;case"SpecularColor":v.specularMap=x.getTexture(l,b.ID),v.specularMap!==void 0&&(v.specularMap.encoding=G.knz);break;case"TransparentColor":case"TransparencyFactor":v.alphaMap=x.getTexture(l,b.ID),v.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",P);break}}),v}getTexture(h,l){return"LayeredTexture"in Pn.Objects&&l in Pn.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),l=Kn.get(l).children[0].ID),h.get(l)}parseDeformers(){const h={},l={};if("Deformer"in Pn.Objects){const f=Pn.Objects.Deformer;for(const v in f){const x=f[v],b=Kn.get(parseInt(v));if(x.attrType==="Skin"){const P=this.parseSkeleton(b,f);P.ID=v,b.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),P.geometryID=b.parents[0].ID,h[v]=P}else if(x.attrType==="BlendShape"){const P={id:v};P.rawTargets=this.parseMorphTargets(b,f),P.id=v,b.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),l[v]=P}}}return{skeletons:h,morphTargets:l}}parseSkeleton(h,l){const f=[];return h.children.forEach(function(v){const x=l[v.ID];if(x.attrType!=="Cluster")return;const b={ID:v.ID,indices:[],weights:[],transformLink:new G.yGw().fromArray(x.TransformLink.a)};"Indexes"in x&&(b.indices=x.Indexes.a,b.weights=x.Weights.a),f.push(b)}),{rawBones:f,bones:[]}}parseMorphTargets(h,l){const f=[];for(let v=0;v<h.children.length;v++){const x=h.children[v],b=l[x.ID],P={name:b.attrName,initialWeight:b.DeformPercent,id:b.id,fullWeights:b.FullWeights.a};if(b.attrType!=="BlendShapeChannel")return;P.geoID=Kn.get(parseInt(x.ID)).children.filter(function(I){return I.relationship===void 0})[0].ID,f.push(P)}return f}parseScene(h,l,f){ki=new G.ZAu;const v=this.parseModels(h.skeletons,l,f),x=Pn.Objects.Model,b=this;v.forEach(function(I){const z=x[I.ID];b.setLookAtProperties(I,z),Kn.get(I.ID).parents.forEach(function(H){const ee=v.get(H.ID);ee!==void 0&&ee.add(I)}),I.parent===null&&ki.add(I)}),this.bindSkeleton(h.skeletons,l,v),this.createAmbientLight(),ki.traverse(function(I){if(I.userData.transformData){I.parent&&(I.userData.transformData.parentMatrix=I.parent.matrix,I.userData.transformData.parentMatrixWorld=I.parent.matrixWorld);const z=Sa(I.userData.transformData);I.applyMatrix4(z),I.updateWorldMatrix()}});const P=new Dh().parse();ki.children.length===1&&ki.children[0].isGroup&&(ki.children[0].animations=P,ki=ki.children[0]),ki.animations=P}parseModels(h,l,f){const v=new Map,x=Pn.Objects.Model;for(const b in x){const P=parseInt(b),I=x[b],z=Kn.get(P);let Q=this.buildSkeleton(z,h,P,I.attrName);if(!Q){switch(I.attrType){case"Camera":Q=this.createCamera(z);break;case"Light":Q=this.createLight(z);break;case"Mesh":Q=this.createMesh(z,l,f);break;case"NurbsCurve":Q=this.createCurve(z,l);break;case"LimbNode":case"Root":Q=new G.N$j;break;case"Null":default:Q=new G.ZAu;break}Q.name=I.attrName?G.iUV.sanitizeNodeName(I.attrName):"",Q.ID=P}this.getTransformData(Q,I),v.set(P,Q)}return v}buildSkeleton(h,l,f,v){let x=null;return h.parents.forEach(function(b){for(const P in l){const I=l[P];I.rawBones.forEach(function(z,Q){if(z.ID===b.ID){const H=x;x=new G.N$j,x.matrixWorld.copy(z.transformLink),x.name=v?G.iUV.sanitizeNodeName(v):"",x.ID=f,I.bones[Q]=x,H!==null&&x.add(H)}})}}),x}createCamera(h){let l,f;if(h.children.forEach(function(v){const x=Pn.Objects.NodeAttribute[v.ID];x!==void 0&&(f=x)}),f===void 0)l=new G.Tme;else{let v=0;f.CameraProjectionType!==void 0&&f.CameraProjectionType.value===1&&(v=1);let x=1;f.NearPlane!==void 0&&(x=f.NearPlane.value/1e3);let b=1e3;f.FarPlane!==void 0&&(b=f.FarPlane.value/1e3);let P=window.innerWidth,I=window.innerHeight;f.AspectWidth!==void 0&&f.AspectHeight!==void 0&&(P=f.AspectWidth.value,I=f.AspectHeight.value);const z=P/I;let Q=45;f.FieldOfView!==void 0&&(Q=f.FieldOfView.value);const H=f.FocalLength?f.FocalLength.value:null;switch(v){case 0:l=new G.cPb(Q,z,x,b),H!==null&&l.setFocalLength(H);break;case 1:l=new G.iKG(-P/2,P/2,I/2,-I/2,x,b);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+v+"."),l=new G.Tme;break}}return l}createLight(h){let l,f;if(h.children.forEach(function(v){const x=Pn.Objects.NodeAttribute[v.ID];x!==void 0&&(f=x)}),f===void 0)l=new G.Tme;else{let v;f.LightType===void 0?v=0:v=f.LightType.value;let x=16777215;f.Color!==void 0&&(x=new G.Ilk().fromArray(f.Color.value));let b=f.Intensity===void 0?1:f.Intensity.value/100;f.CastLightOnObject!==void 0&&f.CastLightOnObject.value===0&&(b=0);let P=0;f.FarAttenuationEnd!==void 0&&(f.EnableFarAttenuation!==void 0&&f.EnableFarAttenuation.value===0?P=0:P=f.FarAttenuationEnd.value);const I=1;switch(v){case 0:l=new G.cek(x,b,P,I);break;case 1:l=new G.Ox3(x,b);break;case 2:let z=Math.PI/3;f.InnerAngle!==void 0&&(z=G.M8C.degToRad(f.InnerAngle.value));let Q=0;f.OuterAngle!==void 0&&(Q=G.M8C.degToRad(f.OuterAngle.value),Q=Math.max(Q,1)),l=new G.PMe(x,b,P,z,Q,I);break;default:console.warn("THREE.FBXLoader: Unknown light type "+f.LightType.value+", defaulting to a PointLight."),l=new G.cek(x,b);break}f.CastShadows!==void 0&&f.CastShadows.value===1&&(l.castShadow=!0)}return l}createMesh(h,l,f){let v,x=null,b=null;const P=[];return h.children.forEach(function(I){l.has(I.ID)&&(x=l.get(I.ID)),f.has(I.ID)&&P.push(f.get(I.ID))}),P.length>1?b=P:P.length>0?b=P[0]:(b=new G.xoR({color:13421772}),P.push(b)),"color"in x.attributes&&P.forEach(function(I){I.vertexColors=!0}),x.FBX_Deformer?(v=new G.TUv(x,b),v.normalizeSkinWeights()):v=new G.Kj0(x,b),v}createCurve(h,l){const f=h.children.reduce(function(x,b){return l.has(b.ID)&&(x=l.get(b.ID)),x},null),v=new G.nls({color:3342591,linewidth:1});return new G.x12(f,v)}getTransformData(h,l){const f={};"InheritType"in l&&(f.inheritType=parseInt(l.InheritType.value)),"RotationOrder"in l?f.eulerOrder=ll(l.RotationOrder.value):f.eulerOrder="ZYX","Lcl_Translation"in l&&(f.translation=l.Lcl_Translation.value),"PreRotation"in l&&(f.preRotation=l.PreRotation.value),"Lcl_Rotation"in l&&(f.rotation=l.Lcl_Rotation.value),"PostRotation"in l&&(f.postRotation=l.PostRotation.value),"Lcl_Scaling"in l&&(f.scale=l.Lcl_Scaling.value),"ScalingOffset"in l&&(f.scalingOffset=l.ScalingOffset.value),"ScalingPivot"in l&&(f.scalingPivot=l.ScalingPivot.value),"RotationOffset"in l&&(f.rotationOffset=l.RotationOffset.value),"RotationPivot"in l&&(f.rotationPivot=l.RotationPivot.value),h.userData.transformData=f}setLookAtProperties(h,l){"LookAtProperty"in l&&Kn.get(h.ID).children.forEach(function(v){if(v.relationship==="LookAtProperty"){const x=Pn.Objects.Model[v.ID];if("Lcl_Translation"in x){const b=x.Lcl_Translation.value;h.target!==void 0?(h.target.position.fromArray(b),ki.add(h.target)):h.lookAt(new G.Pa4().fromArray(b))}}})}bindSkeleton(h,l,f){const v=this.parsePoseNodes();for(const x in h){const b=h[x];Kn.get(parseInt(b.ID)).parents.forEach(function(I){if(l.has(I.ID)){const z=I.ID;Kn.get(z).parents.forEach(function(H){f.has(H.ID)&&f.get(H.ID).bind(new G.OdW(b.bones),v[H.ID])})}})}}parsePoseNodes(){const h={};if("Pose"in Pn.Objects){const l=Pn.Objects.Pose;for(const f in l)if(l[f].attrType==="BindPose"&&l[f].NbPoseNodes>0){const v=l[f].PoseNode;Array.isArray(v)?v.forEach(function(x){h[x.Node]=new G.yGw().fromArray(x.Matrix.a)}):h[v.Node]=new G.yGw().fromArray(v.Matrix.a)}}return h}createAmbientLight(){if("GlobalSettings"in Pn&&"AmbientColor"in Pn.GlobalSettings){const h=Pn.GlobalSettings.AmbientColor.value,l=h[0],f=h[1],v=h[2];if(l!==0||f!==0||v!==0){const x=new G.Ilk(l,f,v);ki.add(new G.Mig(x,1))}}}}class Rh{constructor(){this.negativeMaterialIndices=!1}parse(h){const l=new Map;if("Geometry"in Pn.Objects){const f=Pn.Objects.Geometry;for(const v in f){const x=Kn.get(parseInt(v)),b=this.parseGeometry(x,f[v],h);l.set(parseInt(v),b)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),l}parseGeometry(h,l,f){switch(l.attrType){case"Mesh":return this.parseMeshGeometry(h,l,f);case"NurbsCurve":return this.parseNurbsGeometry(l)}}parseMeshGeometry(h,l,f){const v=f.skeletons,x=[],b=h.parents.map(function(H){return Pn.Objects.Model[H.ID]});if(b.length===0)return;const P=h.children.reduce(function(H,ee){return v[ee.ID]!==void 0&&(H=v[ee.ID]),H},null);h.children.forEach(function(H){f.morphTargets[H.ID]!==void 0&&x.push(f.morphTargets[H.ID])});const I=b[0],z={};"RotationOrder"in I&&(z.eulerOrder=ll(I.RotationOrder.value)),"InheritType"in I&&(z.inheritType=parseInt(I.InheritType.value)),"GeometricTranslation"in I&&(z.translation=I.GeometricTranslation.value),"GeometricRotation"in I&&(z.rotation=I.GeometricRotation.value),"GeometricScaling"in I&&(z.scale=I.GeometricScaling.value);const Q=Sa(z);return this.genGeometry(l,P,x,Q)}genGeometry(h,l,f,v){const x=new G.u9r;h.attrName&&(x.name=h.attrName);const b=this.parseGeoNode(h,l),P=this.genBuffers(b),I=new G.a$l(P.vertex,3);if(I.applyMatrix4(v),x.setAttribute("position",I),P.colors.length>0&&x.setAttribute("color",new G.a$l(P.colors,3)),l&&(x.setAttribute("skinIndex",new G.qlB(P.weightsIndices,4)),x.setAttribute("skinWeight",new G.a$l(P.vertexWeights,4)),x.FBX_Deformer=l),P.normal.length>0){const z=new G.Vkp().getNormalMatrix(v),Q=new G.a$l(P.normal,3);Q.applyNormalMatrix(z),x.setAttribute("normal",Q)}if(P.uvs.forEach(function(z,Q){let H="uv"+(Q+1).toString();Q===0&&(H="uv"),x.setAttribute(H,new G.a$l(P.uvs[Q],2))}),b.material&&b.material.mappingType!=="AllSame"){let z=P.materialIndex[0],Q=0;if(P.materialIndex.forEach(function(H,ee){H!==z&&(x.addGroup(Q,ee-Q,z),z=H,Q=ee)}),x.groups.length>0){const H=x.groups[x.groups.length-1],ee=H.start+H.count;ee!==P.materialIndex.length&&x.addGroup(ee,P.materialIndex.length-ee,z)}x.groups.length===0&&x.addGroup(0,P.materialIndex.length,P.materialIndex[0])}return this.addMorphTargets(x,h,f,v),x}parseGeoNode(h,l){const f={};if(f.vertexPositions=h.Vertices!==void 0?h.Vertices.a:[],f.vertexIndices=h.PolygonVertexIndex!==void 0?h.PolygonVertexIndex.a:[],h.LayerElementColor&&(f.color=this.parseVertexColors(h.LayerElementColor[0])),h.LayerElementMaterial&&(f.material=this.parseMaterialIndices(h.LayerElementMaterial[0])),h.LayerElementNormal&&(f.normal=this.parseNormals(h.LayerElementNormal[0])),h.LayerElementUV){f.uv=[];let v=0;for(;h.LayerElementUV[v];)h.LayerElementUV[v].UV&&f.uv.push(this.parseUVs(h.LayerElementUV[v])),v++}return f.weightTable={},l!==null&&(f.skeleton=l,l.rawBones.forEach(function(v,x){v.indices.forEach(function(b,P){f.weightTable[b]===void 0&&(f.weightTable[b]=[]),f.weightTable[b].push({id:x,weight:v.weights[P]})})})),f}genBuffers(h){const l={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let f=0,v=0,x=!1,b=[],P=[],I=[],z=[],Q=[],H=[];const ee=this;return h.vertexIndices.forEach(function(fe,Se){let De,Re=!1;fe<0&&(fe=fe^-1,Re=!0);let Te=[],Oe=[];if(b.push(fe*3,fe*3+1,fe*3+2),h.color){const Ae=ol(Se,f,fe,h.color);I.push(Ae[0],Ae[1],Ae[2])}if(h.skeleton){if(h.weightTable[fe]!==void 0&&h.weightTable[fe].forEach(function(Ae){Oe.push(Ae.weight),Te.push(Ae.id)}),Oe.length>4){x||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),x=!0);const Ae=[0,0,0,0],ke=[0,0,0,0];Oe.forEach(function(lt,wt){let xt=lt,Ft=Te[wt];ke.forEach(function(Rt,on,Nt){if(xt>Rt){Nt[on]=xt,xt=Rt;const In=Ae[on];Ae[on]=Ft,Ft=In}})}),Te=Ae,Oe=ke}for(;Oe.length<4;)Oe.push(0),Te.push(0);for(let Ae=0;Ae<4;++Ae)Q.push(Oe[Ae]),H.push(Te[Ae])}if(h.normal){const Ae=ol(Se,f,fe,h.normal);P.push(Ae[0],Ae[1],Ae[2])}h.material&&h.material.mappingType!=="AllSame"&&(De=ol(Se,f,fe,h.material)[0],De<0&&(ee.negativeMaterialIndices=!0,De=0)),h.uv&&h.uv.forEach(function(Ae,ke){const lt=ol(Se,f,fe,Ae);z[ke]===void 0&&(z[ke]=[]),z[ke].push(lt[0]),z[ke].push(lt[1])}),v++,Re&&(v>4&&console.warn("THREE.FBXLoader: Polygons with more than four sides are not supported. Make sure to triangulate the geometry during export."),ee.genFace(l,h,b,De,P,I,z,Q,H,v),f++,v=0,b=[],P=[],I=[],z=[],Q=[],H=[])}),l}genFace(h,l,f,v,x,b,P,I,z,Q){for(let H=2;H<Q;H++)h.vertex.push(l.vertexPositions[f[0]]),h.vertex.push(l.vertexPositions[f[1]]),h.vertex.push(l.vertexPositions[f[2]]),h.vertex.push(l.vertexPositions[f[(H-1)*3]]),h.vertex.push(l.vertexPositions[f[(H-1)*3+1]]),h.vertex.push(l.vertexPositions[f[(H-1)*3+2]]),h.vertex.push(l.vertexPositions[f[H*3]]),h.vertex.push(l.vertexPositions[f[H*3+1]]),h.vertex.push(l.vertexPositions[f[H*3+2]]),l.skeleton&&(h.vertexWeights.push(I[0]),h.vertexWeights.push(I[1]),h.vertexWeights.push(I[2]),h.vertexWeights.push(I[3]),h.vertexWeights.push(I[(H-1)*4]),h.vertexWeights.push(I[(H-1)*4+1]),h.vertexWeights.push(I[(H-1)*4+2]),h.vertexWeights.push(I[(H-1)*4+3]),h.vertexWeights.push(I[H*4]),h.vertexWeights.push(I[H*4+1]),h.vertexWeights.push(I[H*4+2]),h.vertexWeights.push(I[H*4+3]),h.weightsIndices.push(z[0]),h.weightsIndices.push(z[1]),h.weightsIndices.push(z[2]),h.weightsIndices.push(z[3]),h.weightsIndices.push(z[(H-1)*4]),h.weightsIndices.push(z[(H-1)*4+1]),h.weightsIndices.push(z[(H-1)*4+2]),h.weightsIndices.push(z[(H-1)*4+3]),h.weightsIndices.push(z[H*4]),h.weightsIndices.push(z[H*4+1]),h.weightsIndices.push(z[H*4+2]),h.weightsIndices.push(z[H*4+3])),l.color&&(h.colors.push(b[0]),h.colors.push(b[1]),h.colors.push(b[2]),h.colors.push(b[(H-1)*3]),h.colors.push(b[(H-1)*3+1]),h.colors.push(b[(H-1)*3+2]),h.colors.push(b[H*3]),h.colors.push(b[H*3+1]),h.colors.push(b[H*3+2])),l.material&&l.material.mappingType!=="AllSame"&&(h.materialIndex.push(v),h.materialIndex.push(v),h.materialIndex.push(v)),l.normal&&(h.normal.push(x[0]),h.normal.push(x[1]),h.normal.push(x[2]),h.normal.push(x[(H-1)*3]),h.normal.push(x[(H-1)*3+1]),h.normal.push(x[(H-1)*3+2]),h.normal.push(x[H*3]),h.normal.push(x[H*3+1]),h.normal.push(x[H*3+2])),l.uv&&l.uv.forEach(function(ee,fe){h.uvs[fe]===void 0&&(h.uvs[fe]=[]),h.uvs[fe].push(P[fe][0]),h.uvs[fe].push(P[fe][1]),h.uvs[fe].push(P[fe][(H-1)*2]),h.uvs[fe].push(P[fe][(H-1)*2+1]),h.uvs[fe].push(P[fe][H*2]),h.uvs[fe].push(P[fe][H*2+1])})}addMorphTargets(h,l,f,v){if(f.length===0)return;h.morphTargetsRelative=!0,h.morphAttributes.position=[];const x=this;f.forEach(function(b){b.rawTargets.forEach(function(P){const I=Pn.Objects.Geometry[P.geoID];I!==void 0&&x.genMorphGeometry(h,l,I,v,P.name)})})}genMorphGeometry(h,l,f,v,x){const b=l.PolygonVertexIndex!==void 0?l.PolygonVertexIndex.a:[],P=f.Vertices!==void 0?f.Vertices.a:[],I=f.Indexes!==void 0?f.Indexes.a:[],z=h.attributes.position.count*3,Q=new Float32Array(z);for(let Se=0;Se<I.length;Se++){const De=I[Se]*3;Q[De]=P[Se*3],Q[De+1]=P[Se*3+1],Q[De+2]=P[Se*3+2]}const H={vertexIndices:b,vertexPositions:Q},ee=this.genBuffers(H),fe=new G.a$l(ee.vertex,3);fe.name=x||f.attrName,fe.applyMatrix4(v),h.morphAttributes.position.push(fe)}parseNormals(h){const l=h.MappingInformationType,f=h.ReferenceInformationType,v=h.Normals.a;let x=[];return f==="IndexToDirect"&&("NormalIndex"in h?x=h.NormalIndex.a:"NormalsIndex"in h&&(x=h.NormalsIndex.a)),{dataSize:3,buffer:v,indices:x,mappingType:l,referenceType:f}}parseUVs(h){const l=h.MappingInformationType,f=h.ReferenceInformationType,v=h.UV.a;let x=[];return f==="IndexToDirect"&&(x=h.UVIndex.a),{dataSize:2,buffer:v,indices:x,mappingType:l,referenceType:f}}parseVertexColors(h){const l=h.MappingInformationType,f=h.ReferenceInformationType,v=h.Colors.a;let x=[];return f==="IndexToDirect"&&(x=h.ColorIndex.a),{dataSize:4,buffer:v,indices:x,mappingType:l,referenceType:f}}parseMaterialIndices(h){const l=h.MappingInformationType,f=h.ReferenceInformationType;if(l==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:f};const v=h.Materials.a,x=[];for(let b=0;b<v.length;++b)x.push(b);return{dataSize:1,buffer:v,indices:x,mappingType:l,referenceType:f}}parseNurbsGeometry(h){const l=parseInt(h.Order);if(isNaN(l))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",h.Order,h.id),new G.u9r;const f=l-1,v=h.KnotVector.a,x=[],b=h.Points.a;for(let H=0,ee=b.length;H<ee;H+=4)x.push(new G.Ltg().fromArray(b,H));let P,I;if(h.Form==="Closed")x.push(x[0]);else if(h.Form==="Periodic"){P=f,I=v.length-1-P;for(let H=0;H<f;++H)x.push(x[H])}const Q=new Th(f,v,x,P,I).getPoints(x.length*12);return new G.u9r().setFromPoints(Q)}}class Dh{parse(){const h=[],l=this.parseClips();if(l!==void 0)for(const f in l){const v=l[f],x=this.addClip(v);h.push(x)}return h}parseClips(){if(Pn.Objects.AnimationCurve===void 0)return;const h=this.parseAnimationCurveNodes();this.parseAnimationCurves(h);const l=this.parseAnimationLayers(h);return this.parseAnimStacks(l)}parseAnimationCurveNodes(){const h=Pn.Objects.AnimationCurveNode,l=new Map;for(const f in h){const v=h[f];if(v.attrName.match(/S|R|T|DeformPercent/)!==null){const x={id:v.id,attr:v.attrName,curves:{}};l.set(x.id,x)}}return l}parseAnimationCurves(h){const l=Pn.Objects.AnimationCurve;for(const f in l){const v={id:l[f].id,times:l[f].KeyTime.a.map($l),values:l[f].KeyValueFloat.a},x=Kn.get(v.id);if(x!==void 0){const b=x.parents[0].ID,P=x.parents[0].relationship;P.match(/X/)?h.get(b).curves.x=v:P.match(/Y/)?h.get(b).curves.y=v:P.match(/Z/)?h.get(b).curves.z=v:P.match(/d|DeformPercent/)&&h.has(b)&&(h.get(b).curves.morph=v)}}}parseAnimationLayers(h){const l=Pn.Objects.AnimationLayer,f=new Map;for(const v in l){const x=[],b=Kn.get(parseInt(v));b!==void 0&&(b.children.forEach(function(I,z){if(h.has(I.ID)){const Q=h.get(I.ID);if(Q.curves.x!==void 0||Q.curves.y!==void 0||Q.curves.z!==void 0){if(x[z]===void 0){const H=Kn.get(I.ID).parents.filter(function(ee){return ee.relationship!==void 0})[0].ID;if(H!==void 0){const ee=Pn.Objects.Model[H.toString()];if(ee===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",I);return}const fe={modelName:ee.attrName?G.iUV.sanitizeNodeName(ee.attrName):"",ID:ee.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ki.traverse(function(Se){Se.ID===ee.id&&(fe.transform=Se.matrix,Se.userData.transformData&&(fe.eulerOrder=Se.userData.transformData.eulerOrder))}),fe.transform||(fe.transform=new G.yGw),"PreRotation"in ee&&(fe.preRotation=ee.PreRotation.value),"PostRotation"in ee&&(fe.postRotation=ee.PostRotation.value),x[z]=fe}}x[z]&&(x[z][Q.attr]=Q)}else if(Q.curves.morph!==void 0){if(x[z]===void 0){const H=Kn.get(I.ID).parents.filter(function(Te){return Te.relationship!==void 0})[0].ID,ee=Kn.get(H).parents[0].ID,fe=Kn.get(ee).parents[0].ID,Se=Kn.get(fe).parents[0].ID,De=Pn.Objects.Model[Se],Re={modelName:De.attrName?G.iUV.sanitizeNodeName(De.attrName):"",morphName:Pn.Objects.Deformer[H].attrName};x[z]=Re}x[z][Q.attr]=Q}}}),f.set(parseInt(v),x))}return f}parseAnimStacks(h){const l=Pn.Objects.AnimationStack,f={};for(const v in l){const x=Kn.get(parseInt(v)).children;x.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const b=h.get(x[0].ID);f[v]={name:l[v].attrName,layer:b}}return f}addClip(h){let l=[];const f=this;return h.layer.forEach(function(v){l=l.concat(f.generateTracks(v))}),new G.m7l(h.name,-1,l)}generateTracks(h){const l=[];let f=new G.Pa4,v=new G._fP,x=new G.Pa4;if(h.transform&&h.transform.decompose(f,v,x),f=f.toArray(),v=new G.USm().setFromQuaternion(v,h.eulerOrder).toArray(),x=x.toArray(),h.T!==void 0&&Object.keys(h.T.curves).length>0){const b=this.generateVectorTrack(h.modelName,h.T.curves,f,"position");b!==void 0&&l.push(b)}if(h.R!==void 0&&Object.keys(h.R.curves).length>0){const b=this.generateRotationTrack(h.modelName,h.R.curves,v,h.preRotation,h.postRotation,h.eulerOrder);b!==void 0&&l.push(b)}if(h.S!==void 0&&Object.keys(h.S.curves).length>0){const b=this.generateVectorTrack(h.modelName,h.S.curves,x,"scale");b!==void 0&&l.push(b)}if(h.DeformPercent!==void 0){const b=this.generateMorphTrack(h);b!==void 0&&l.push(b)}return l}generateVectorTrack(h,l,f,v){const x=this.getTimesForAllAxes(l),b=this.getKeyframeTrackValues(x,l,f);return new G.yC1(h+"."+v,x,b)}generateRotationTrack(h,l,f,v,x,b){l.x!==void 0&&(this.interpolateRotations(l.x),l.x.values=l.x.values.map(G.M8C.degToRad)),l.y!==void 0&&(this.interpolateRotations(l.y),l.y.values=l.y.values.map(G.M8C.degToRad)),l.z!==void 0&&(this.interpolateRotations(l.z),l.z.values=l.z.values.map(G.M8C.degToRad));const P=this.getTimesForAllAxes(l),I=this.getKeyframeTrackValues(P,l,f);v!==void 0&&(v=v.map(G.M8C.degToRad),v.push(b),v=new G.USm().fromArray(v),v=new G._fP().setFromEuler(v)),x!==void 0&&(x=x.map(G.M8C.degToRad),x.push(b),x=new G.USm().fromArray(x),x=new G._fP().setFromEuler(x).invert());const z=new G._fP,Q=new G.USm,H=[];for(let ee=0;ee<I.length;ee+=3)Q.set(I[ee],I[ee+1],I[ee+2],b),z.setFromEuler(Q),v!==void 0&&z.premultiply(v),x!==void 0&&z.multiply(x),z.toArray(H,ee/3*4);return new G.iLg(h+".quaternion",P,H)}generateMorphTrack(h){const l=h.DeformPercent.curves.morph,f=l.values.map(function(x){return x/100}),v=ki.getObjectByName(h.modelName).morphTargetDictionary[h.morphName];return new G.dUE(h.modelName+".morphTargetInfluences["+v+"]",l.times,f)}getTimesForAllAxes(h){let l=[];if(h.x!==void 0&&(l=l.concat(h.x.times)),h.y!==void 0&&(l=l.concat(h.y.times)),h.z!==void 0&&(l=l.concat(h.z.times)),l=l.sort(function(f,v){return f-v}),l.length>1){let f=1,v=l[0];for(let x=1;x<l.length;x++){const b=l[x];b!==v&&(l[f]=b,v=b,f++)}l=l.slice(0,f)}return l}getKeyframeTrackValues(h,l,f){const v=f,x=[];let b=-1,P=-1,I=-1;return h.forEach(function(z){if(l.x&&(b=l.x.times.indexOf(z)),l.y&&(P=l.y.times.indexOf(z)),l.z&&(I=l.z.times.indexOf(z)),b!==-1){const Q=l.x.values[b];x.push(Q),v[0]=Q}else x.push(v[0]);if(P!==-1){const Q=l.y.values[P];x.push(Q),v[1]=Q}else x.push(v[1]);if(I!==-1){const Q=l.z.values[I];x.push(Q),v[2]=Q}else x.push(v[2])}),x}interpolateRotations(h){for(let l=1;l<h.values.length;l++){const f=h.values[l-1],v=h.values[l]-f,x=Math.abs(v);if(x>=180){const b=x/180,P=v/b;let I=f+P;const z=h.times[l-1],H=(h.times[l]-z)/b;let ee=z+H;const fe=[],Se=[];for(;ee<h.times[l];)fe.push(ee),ee+=H,Se.push(I),I+=P;h.times=jo(h.times,l,fe),h.values=jo(h.values,l,Se)}}}}class Ih{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(h){this.nodeStack.push(h),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(h,l){this.currentProp=h,this.currentPropName=l}parse(h){this.currentIndent=0,this.allNodes=new rl,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const l=this,f=h.split(/[\r\n]+/);return f.forEach(function(v,x){const b=v.match(/^[\s\t]*;/),P=v.match(/^[\s\t]*$/);if(b||P)return;const I=v.match("^\\t{"+l.currentIndent+"}(\\w+):(.*){",""),z=v.match("^\\t{"+l.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),Q=v.match("^\\t{"+(l.currentIndent-1)+"}}");I?l.parseNodeBegin(v,I):z?l.parseNodeProperty(v,z,f[++x]):Q?l.popStack():v.match(/^[^\s\t}]/)&&l.parseNodePropertyContinued(v)}),this.allNodes}parseNodeBegin(h,l){const f=l[1].trim().replace(/^"/,"").replace(/"$/,""),v=l[2].split(",").map(function(I){return I.trim().replace(/^"/,"").replace(/"$/,"")}),x={name:f},b=this.parseNodeAttr(v),P=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(f,x):f in P?(f==="PoseNode"?P.PoseNode.push(x):P[f].id!==void 0&&(P[f]={},P[f][P[f].id]=P[f]),b.id!==""&&(P[f][b.id]=x)):typeof b.id=="number"?(P[f]={},P[f][b.id]=x):f!=="Properties70"&&(f==="PoseNode"?P[f]=[x]:P[f]=x),typeof b.id=="number"&&(x.id=b.id),b.name!==""&&(x.attrName=b.name),b.type!==""&&(x.attrType=b.type),this.pushStack(x)}parseNodeAttr(h){let l=h[0];h[0]!==""&&(l=parseInt(h[0]),isNaN(l)&&(l=h[0]));let f="",v="";return h.length>1&&(f=h[1].replace(/^(\w+)::/,""),v=h[2]),{id:l,name:f,type:v}}parseNodeProperty(h,l,f){let v=l[1].replace(/^"/,"").replace(/"$/,"").trim(),x=l[2].replace(/^"/,"").replace(/"$/,"").trim();v==="Content"&&x===","&&(x=f.replace(/"/g,"").replace(/,$/,"").trim());const b=this.getCurrentNode();if(b.name==="Properties70"){this.parseNodeSpecialProperty(h,v,x);return}if(v==="C"){const I=x.split(",").slice(1),z=parseInt(I[0]),Q=parseInt(I[1]);let H=x.split(",").slice(3);H=H.map(function(ee){return ee.trim().replace(/^"/,"")}),v="connections",x=[z,Q],fu(x,H),b[v]===void 0&&(b[v]=[])}v==="Node"&&(b.id=x),v in b&&Array.isArray(b[v])?b[v].push(x):v!=="a"?b[v]=x:b.a=x,this.setCurrentProp(b,v),v==="a"&&x.slice(-1)!==","&&(b.a=cl(x))}parseNodePropertyContinued(h){const l=this.getCurrentNode();l.a+=h,h.slice(-1)!==","&&(l.a=cl(l.a))}parseNodeSpecialProperty(h,l,f){const v=f.split('",').map(function(Q){return Q.trim().replace(/^\"/,"").replace(/\s/,"_")}),x=v[0],b=v[1],P=v[2],I=v[3];let z=v[4];switch(b){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":z=parseFloat(z);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":z=cl(z);break}this.getPrevNode()[x]={type:b,type2:P,flag:I,value:z},this.setCurrentProp(this.getPrevNode(),x)}}class Zl{parse(h){const l=new il(h);l.skip(23);const f=l.getUint32();if(f<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+f);const v=new rl;for(;!this.endOfContent(l);){const x=this.parseNode(l,f);x!==null&&v.add(x.name,x)}return v}endOfContent(h){return h.size()%16===0?(h.getOffset()+160+16&-16)>=h.size():h.getOffset()+160+16>=h.size()}parseNode(h,l){const f={},v=l>=7500?h.getUint64():h.getUint32(),x=l>=7500?h.getUint64():h.getUint32();l>=7500?h.getUint64():h.getUint32();const b=h.getUint8(),P=h.getString(b);if(v===0)return null;const I=[];for(let ee=0;ee<x;ee++)I.push(this.parseProperty(h));const z=I.length>0?I[0]:"",Q=I.length>1?I[1]:"",H=I.length>2?I[2]:"";for(f.singleProperty=x===1&&h.getOffset()===v;v>h.getOffset();){const ee=this.parseNode(h,l);ee!==null&&this.parseSubNode(P,f,ee)}return f.propertyList=I,typeof z=="number"&&(f.id=z),Q!==""&&(f.attrName=Q),H!==""&&(f.attrType=H),P!==""&&(f.name=P),f}parseSubNode(h,l,f){if(f.singleProperty===!0){const v=f.propertyList[0];Array.isArray(v)?(l[f.name]=f,f.a=v):l[f.name]=v}else if(h==="Connections"&&f.name==="C"){const v=[];f.propertyList.forEach(function(x,b){b!==0&&v.push(x)}),l.connections===void 0&&(l.connections=[]),l.connections.push(v)}else if(f.name==="Properties70")Object.keys(f).forEach(function(x){l[x]=f[x]});else if(h==="Properties70"&&f.name==="P"){let v=f.propertyList[0],x=f.propertyList[1];const b=f.propertyList[2],P=f.propertyList[3];let I;v.indexOf("Lcl ")===0&&(v=v.replace("Lcl ","Lcl_")),x.indexOf("Lcl ")===0&&(x=x.replace("Lcl ","Lcl_")),x==="Color"||x==="ColorRGB"||x==="Vector"||x==="Vector3D"||x.indexOf("Lcl_")===0?I=[f.propertyList[4],f.propertyList[5],f.propertyList[6]]:I=f.propertyList[4],l[v]={type:x,type2:b,flag:P,value:I}}else l[f.name]===void 0?typeof f.id=="number"?(l[f.name]={},l[f.name][f.id]=f):l[f.name]=f:f.name==="PoseNode"?(Array.isArray(l[f.name])||(l[f.name]=[l[f.name]]),l[f.name].push(f)):l[f.name][f.id]===void 0&&(l[f.name][f.id]=f)}parseProperty(h){const l=h.getString(1);let f;switch(l){case"C":return h.getBoolean();case"D":return h.getFloat64();case"F":return h.getFloat32();case"I":return h.getInt32();case"L":return h.getInt64();case"R":return f=h.getUint32(),h.getArrayBuffer(f);case"S":return f=h.getUint32(),h.getString(f);case"Y":return h.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const v=h.getUint32(),x=h.getUint32(),b=h.getUint32();if(x===0)switch(l){case"b":case"c":return h.getBooleanArray(v);case"d":return h.getFloat64Array(v);case"f":return h.getFloat32Array(v);case"i":return h.getInt32Array(v);case"l":return h.getInt64Array(v)}const P=ts(new Uint8Array(h.getArrayBuffer(b))),I=new il(P.buffer);switch(l){case"b":case"c":return I.getBooleanArray(v);case"d":return I.getFloat64Array(v);case"f":return I.getFloat32Array(v);case"i":return I.getInt32Array(v);case"l":return I.getInt64Array(v)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+l)}}}class il{constructor(h,l){this.dv=new DataView(h),this.offset=0,this.littleEndian=l!==void 0?l:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(h){this.offset+=h}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(h){const l=[];for(let f=0;f<h;f++)l.push(this.getBoolean());return l}getUint8(){const h=this.dv.getUint8(this.offset);return this.offset+=1,h}getInt16(){const h=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,h}getInt32(){const h=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,h}getInt32Array(h){const l=[];for(let f=0;f<h;f++)l.push(this.getInt32());return l}getUint32(){const h=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,h}getInt64(){let h,l;return this.littleEndian?(h=this.getUint32(),l=this.getUint32()):(l=this.getUint32(),h=this.getUint32()),l&2147483648?(l=~l&4294967295,h=~h&4294967295,h===4294967295&&(l=l+1&4294967295),h=h+1&4294967295,-(l*4294967296+h)):l*4294967296+h}getInt64Array(h){const l=[];for(let f=0;f<h;f++)l.push(this.getInt64());return l}getUint64(){let h,l;return this.littleEndian?(h=this.getUint32(),l=this.getUint32()):(l=this.getUint32(),h=this.getUint32()),l*4294967296+h}getFloat32(){const h=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,h}getFloat32Array(h){const l=[];for(let f=0;f<h;f++)l.push(this.getFloat32());return l}getFloat64(){const h=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,h}getFloat64Array(h){const l=[];for(let f=0;f<h;f++)l.push(this.getFloat64());return l}getArrayBuffer(h){const l=this.dv.buffer.slice(this.offset,this.offset+h);return this.offset+=h,l}getString(h){const l=this.offset;let f=new Uint8Array(this.dv.buffer,l,h);this.skip(h);const v=f.indexOf(0);return v>=0&&(f=new Uint8Array(this.dv.buffer,l,v)),this._textDecoder.decode(f)}}class rl{add(h,l){this[h]=l}}function sl(S){const h="Kaydara FBX Binary  \0";return S.byteLength>=h.length&&h===Wo(S,0,h.length)}function du(S){const h=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let l=0;function f(v){const x=S[v-1];return S=S.slice(l+v),l++,x}for(let v=0;v<h.length;++v)if(f(1)===h[v])return!1;return!0}function Jl(S){const h=/FBXVersion: (\d+)/,l=S.match(h);if(l)return parseInt(l[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function $l(S){return S/46186158e3}const ec=[];function ol(S,h,l,f){let v;switch(f.mappingType){case"ByPolygonVertex":v=S;break;case"ByPolygon":v=h;break;case"ByVertice":v=l;break;case"AllSame":v=f.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+f.mappingType)}f.referenceType==="IndexToDirect"&&(v=f.indices[v]);const x=v*f.dataSize,b=x+f.dataSize;return Ma(ec,f.buffer,x,b)}const al=new G.USm,bo=new G.Pa4;function Sa(S){const h=new G.yGw,l=new G.yGw,f=new G.yGw,v=new G.yGw,x=new G.yGw,b=new G.yGw,P=new G.yGw,I=new G.yGw,z=new G.yGw,Q=new G.yGw,H=new G.yGw,ee=new G.yGw,fe=S.inheritType?S.inheritType:0;if(S.translation&&h.setPosition(bo.fromArray(S.translation)),S.preRotation){const on=S.preRotation.map(G.M8C.degToRad);on.push(S.eulerOrder||G.USm.DEFAULT_ORDER),l.makeRotationFromEuler(al.fromArray(on))}if(S.rotation){const on=S.rotation.map(G.M8C.degToRad);on.push(S.eulerOrder||G.USm.DEFAULT_ORDER),f.makeRotationFromEuler(al.fromArray(on))}if(S.postRotation){const on=S.postRotation.map(G.M8C.degToRad);on.push(S.eulerOrder||G.USm.DEFAULT_ORDER),v.makeRotationFromEuler(al.fromArray(on)),v.invert()}S.scale&&x.scale(bo.fromArray(S.scale)),S.scalingOffset&&P.setPosition(bo.fromArray(S.scalingOffset)),S.scalingPivot&&b.setPosition(bo.fromArray(S.scalingPivot)),S.rotationOffset&&I.setPosition(bo.fromArray(S.rotationOffset)),S.rotationPivot&&z.setPosition(bo.fromArray(S.rotationPivot)),S.parentMatrixWorld&&(H.copy(S.parentMatrix),Q.copy(S.parentMatrixWorld));const Se=l.clone().multiply(f).multiply(v),De=new G.yGw;De.extractRotation(Q);const Re=new G.yGw;Re.copyPosition(Q);const Te=Re.clone().invert().multiply(Q),Oe=De.clone().invert().multiply(Te),Ae=x,ke=new G.yGw;if(fe===0)ke.copy(De).multiply(Se).multiply(Oe).multiply(Ae);else if(fe===1)ke.copy(De).multiply(Oe).multiply(Se).multiply(Ae);else{const Nt=new G.yGw().scale(new G.Pa4().setFromMatrixScale(H)).clone().invert(),In=Oe.clone().multiply(Nt);ke.copy(De).multiply(Se).multiply(In).multiply(Ae)}const lt=z.clone().invert(),wt=b.clone().invert();let xt=h.clone().multiply(I).multiply(z).multiply(l).multiply(f).multiply(v).multiply(lt).multiply(P).multiply(b).multiply(x).multiply(wt);const Ft=new G.yGw().copyPosition(xt),Rt=Q.clone().multiply(Ft);return ee.copyPosition(Rt),xt=ee.clone().multiply(ke),xt.premultiply(Q.invert()),xt}function ll(S){S=S||0;const h=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return S===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),h[0]):h[S]}function cl(S){return S.split(",").map(function(l){return parseFloat(l)})}function Wo(S,h,l){return h===void 0&&(h=0),l===void 0&&(l=S.byteLength),new TextDecoder().decode(new Uint8Array(S,h,l))}function fu(S,h){for(let l=0,f=S.length,v=h.length;l<v;l++,f++)S[f]=h[l]}function Ma(S,h,l,f){for(let v=l,x=0;v<f;v++,x++)S[x]=h[v];return S}function jo(S,h,l){return S.slice(0,h).concat(l).concat(S.slice(h))}function wo(S,h,l){let f={};S.traverse(P=>{var I;if(P.visible&&P.isMesh&&P.geometry){if(l&&l(P))return;let z=P.geometry.uuid+((I=P.material)==null?void 0:I.name);f[z]==null&&(f[z]={geometry:P.geometry,material:P.material,group:[]}),f[z].group.push(P)}});let v=0,x=0,b=new d.ZAu;for(let P in f){let I=f[P],{geometry:z,material:Q,group:H}=I,ee=new d.SPe(z,Q,H.length);for(let fe=H.length;fe--;)H[fe].updateWorldMatrix(!0,!1),ee.setMatrixAt(fe,H[fe].matrixWorld);Ge(ee,h),b.add(ee),x++,v+=H.length}return console.log("makeInstanced","instance",x,"count",v),b}function Xo(){let S=new d.u9r;return S.setAttribute("position",new d.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),S.setAttribute("uv",new d.a$l([0,2,0,0,2,0],2)),S}const Ao=["alphaMap","aoMap","bumpMap","displacementMap","emissiveMap","envMap","lightMap","metalnessMap","normalMap","roughnessMap","specularMap"];function Pt(S,h={meshes:[],materials:{},textures:{}}){return S.traverse(l=>{if(l instanceof d.Kj0){const f=l.material;h.meshes.push(l),h.materials[f.name]=f;let v=null;for(let x of Ao)v=f[x],v&&(h.textures[v.uuid]=v)}}),h}const T=["top","bottom","left","right","near","far"];function q(S,h){const l=S.camera;for(let f=0;f<h.length&&f<6;f++)l[T[f]]=h[f];return h.length>6&&(S.bias=h[6]),h.length>8&&S.mapSize.set(h[7],h[8]),S}class he extends tn{constructor(){super(...arguments);B(this,"extensions",["fbx"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b}){const P=I=>{Object.assign(I.meshData,Pt(I)),v(I)};new Ch(this.viewer.loadingManager).load(l,P,x,b,f)}}const Ce=new WeakMap;class He extends G.aNw{constructor(h){super(h),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(h){return this.decoderPath=h,this}setDecoderConfig(h){return this.decoderConfig=h,this}setWorkerLimit(h){return this.workerLimit=h,this}load(h,l,f,v){const x=new G.hH6(this.manager);x.setPath(this.path),x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setWithCredentials(this.withCredentials),x.load(h,b=>{this.parse(b,l,v)},f,v)}parse(h,l,f){this.decodeDracoFile(h,l,null,null,G.KI_).catch(f)}decodeDracoFile(h,l,f,v,x=G.GUF){const b={attributeIDs:f||this.defaultAttributeIDs,attributeTypes:v||this.defaultAttributeTypes,useUniqueIDs:!!f,vertexColorSpace:x};return this.decodeGeometry(h,b).then(l)}decodeGeometry(h,l){const f=JSON.stringify(l);if(Ce.has(h)){const I=Ce.get(h);if(I.key===f)return I.promise;if(h.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let v;const x=this.workerNextTaskID++,b=h.byteLength,P=this._getWorker(x,b).then(I=>(v=I,new Promise((z,Q)=>{v._callbacks[x]={resolve:z,reject:Q},v.postMessage({type:"decode",id:x,taskConfig:l,buffer:h},[h])}))).then(I=>this._createGeometry(I.geometry));return P.catch(()=>!0).then(()=>{v&&x&&this._releaseTask(v,x)}),Ce.set(h,{key:f,promise:P}),P}_createGeometry(h){const l=new G.u9r;h.index&&l.setIndex(new G.TlE(h.index.array,1));for(let f=0;f<h.attributes.length;f++){const v=h.attributes[f],x=v.name,b=v.array,P=v.itemSize,I=new G.TlE(b,P);x==="color"&&this._assignVertexColorSpace(I,v.vertexColorSpace),l.setAttribute(x,I)}return l}_assignVertexColorSpace(h,l){if(l!==G.KI_)return;const f=new G.Ilk;for(let v=0,x=h.count;v<x;v++)f.fromBufferAttribute(h,v).convertSRGBToLinear(),h.setXYZ(v,f.r,f.g,f.b)}_loadLibrary(h,l){const f=new G.hH6(this.manager);return f.setPath(this.decoderPath),f.setResponseType(l),f.setWithCredentials(this.withCredentials),new Promise((v,x)=>{f.load(h,v,void 0,x)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const h=typeof WebAssembly!="object"||this.decoderConfig.type==="js",l=[];return h?l.push(this._loadLibrary("draco_decoder.js","text")):(l.push(this._loadLibrary("draco_wasm_wrapper.js","text")),l.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(l).then(f=>{const v=f[0];h||(this.decoderConfig.wasmBinary=f[1]);const x=Ze.toString(),b=["/* draco decoder */",v,"","/* worker */",x.substring(x.indexOf("{")+1,x.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([b]))}),this.decoderPending}_getWorker(h,l){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const v=new Worker(this.workerSourceURL);v._callbacks={},v._taskCosts={},v._taskLoad=0,v.postMessage({type:"init",decoderConfig:this.decoderConfig}),v.onmessage=function(x){const b=x.data;switch(b.type){case"decode":v._callbacks[b.id].resolve(b);break;case"error":v._callbacks[b.id].reject(b);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+b.type+'"')}},this.workerPool.push(v)}else this.workerPool.sort(function(v,x){return v._taskLoad>x._taskLoad?-1:1});const f=this.workerPool[this.workerPool.length-1];return f._taskCosts[h]=l,f._taskLoad+=l,f})}_releaseTask(h,l){h._taskLoad-=h._taskCosts[l],delete h._callbacks[l],delete h._taskCosts[l]}debug(){console.log("Task load: ",this.workerPool.map(h=>h._taskLoad))}dispose(){for(let h=0;h<this.workerPool.length;++h)this.workerPool[h].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Ze(){let S,h;onmessage=function(b){const P=b.data;switch(P.type){case"init":S=P.decoderConfig,h=new Promise(function(Q){S.onModuleLoaded=function(H){Q({draco:H})},DracoDecoderModule(S)});break;case"decode":const I=P.buffer,z=P.taskConfig;h.then(Q=>{const H=Q.draco,ee=new H.Decoder;try{const fe=l(H,ee,new Int8Array(I),z),Se=fe.attributes.map(De=>De.array.buffer);fe.index&&Se.push(fe.index.array.buffer),self.postMessage({type:"decode",id:P.id,geometry:fe},Se)}catch(fe){console.error(fe),self.postMessage({type:"error",id:P.id,error:fe.message})}finally{H.destroy(ee)}});break}};function l(b,P,I,z){const Q=z.attributeIDs,H=z.attributeTypes;let ee,fe;const Se=P.GetEncodedGeometryType(I);if(Se===b.TRIANGULAR_MESH)ee=new b.Mesh,fe=P.DecodeArrayToMesh(I,I.byteLength,ee);else if(Se===b.POINT_CLOUD)ee=new b.PointCloud,fe=P.DecodeArrayToPointCloud(I,I.byteLength,ee);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!fe.ok()||ee.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+fe.error_msg());const De={index:null,attributes:[]};for(const Re in Q){const Te=self[H[Re]];let Oe,Ae;if(z.useUniqueIDs)Ae=Q[Re],Oe=P.GetAttributeByUniqueId(ee,Ae);else{if(Ae=P.GetAttributeId(ee,b[Q[Re]]),Ae===-1)continue;Oe=P.GetAttribute(ee,Ae)}const ke=v(b,P,ee,Re,Te,Oe);Re==="color"&&(ke.vertexColorSpace=z.vertexColorSpace),De.attributes.push(ke)}return Se===b.TRIANGULAR_MESH&&(De.index=f(b,P,ee)),b.destroy(ee),De}function f(b,P,I){const Q=I.num_faces()*3,H=Q*4,ee=b._malloc(H);P.GetTrianglesUInt32Array(I,H,ee);const fe=new Uint32Array(b.HEAPF32.buffer,ee,Q).slice();return b._free(ee),{array:fe,itemSize:1}}function v(b,P,I,z,Q,H){const ee=H.num_components(),Se=I.num_points()*ee,De=Se*Q.BYTES_PER_ELEMENT,Re=x(b,Q),Te=b._malloc(De);P.GetAttributeDataArrayForAllPoints(I,H,Re,De,Te);const Oe=new Q(b.HEAPF32.buffer,Te,Se).slice();return b._free(Te),{name:z,array:Oe,itemSize:ee}}function x(b,P){switch(P){case Float32Array:return b.DT_FLOAT32;case Int8Array:return b.DT_INT8;case Int16Array:return b.DT_INT16;case Int32Array:return b.DT_INT32;case Uint8Array:return b.DT_UINT8;case Uint16Array:return b.DT_UINT16;case Uint32Array:return b.DT_UINT32}}}var at=r(980);function zt(S,h){if(h===G.WwZ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),S;if(h===G.z$h||h===G.UlW){let l=S.getIndex();if(l===null){const b=[],P=S.getAttribute("position");if(P!==void 0){for(let I=0;I<P.count;I++)b.push(I);S.setIndex(b),l=S.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),S}const f=l.count-2,v=[];if(h===G.z$h)for(let b=1;b<=f;b++)v.push(l.getX(0)),v.push(l.getX(b)),v.push(l.getX(b+1));else for(let b=0;b<f;b++)b%2===0?(v.push(l.getX(b)),v.push(l.getX(b+1)),v.push(l.getX(b+2))):(v.push(l.getX(b+2)),v.push(l.getX(b+1)),v.push(l.getX(b)));v.length/3!==f&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const x=S.clone();return x.setIndex(v),x.clearGroups(),x}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",h),S}class Cn extends G.aNw{constructor(h){super(h),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(l){return new _i(l)}),this.register(function(l){return new v0(l)}),this.register(function(l){return new Ea(l)}),this.register(function(l){return new pi(l)}),this.register(function(l){return new So(l)}),this.register(function(l){return new Ki(l)}),this.register(function(l){return new br(l)}),this.register(function(l){return new pu(l)}),this.register(function(l){return new xr(l)}),this.register(function(l){return new g0(l)}),this.register(function(l){return new Xs(l)}),this.register(function(l){return new oi(l)}),this.register(function(l){return new bm(l)}),this.register(function(l){return new wm(l)})}load(h,l,f,v,x){const b=this;let P;this.resourcePath!==""?P=this.resourcePath:this.path!==""?P=this.path:P=G.Zp0.extractUrlBase(h),this.manager.itemStart(h);const I=function(Q){v?v(Q):console.error(Q),b.manager.itemError(h),b.manager.itemEnd(h)},z=new G.hH6(this.manager);z.setPath(this.path),z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setWithCredentials(this.withCredentials),z.load(h,function(Q){try{b.parse(Q,P,function(H){l(H),b.manager.itemEnd(h)},I,x==null?void 0:x.additionalFiles)}catch(H){I(H)}},f,I,x==null?void 0:x.mainFile)}setDRACOLoader(h){return this.dracoLoader=h,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(h){return this.ktx2Loader=h,this}setMeshoptDecoder(h){return this.meshoptDecoder=h,this}register(h){return this.pluginCallbacks.indexOf(h)===-1&&this.pluginCallbacks.push(h),this}unregister(h){return this.pluginCallbacks.indexOf(h)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(h),1),this}parse(h,l,f,v,x){let b;const P={},I={},z=new TextDecoder;if(typeof h=="string")b=JSON.parse(h);else if(h instanceof ArrayBuffer)if(z.decode(new Uint8Array(h,0,4))===Yo){try{P[Ot.KHR_BINARY_GLTF]=new Ys(h)}catch(ee){v&&v(ee);return}b=JSON.parse(P[Ot.KHR_BINARY_GLTF].content)}else b=JSON.parse(z.decode(h));else b=h;if(b.asset===void 0||b.asset.version[0]<2){v&&v(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const Q=new T0(b,{path:l||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});Q.fileLoader.setRequestHeader(this.requestHeader);for(let H=0;H<this.pluginCallbacks.length;H++){const ee=this.pluginCallbacks[H](Q);I[ee.name]=ee,P[ee.name]=!0}if(b.extensionsUsed)for(let H=0;H<b.extensionsUsed.length;++H){const ee=b.extensionsUsed[H],fe=b.extensionsRequired||[];switch(ee){case Ot.KHR_MATERIALS_UNLIT:P[ee]=new yi;break;case Ot.KHR_DRACO_MESH_COMPRESSION:P[ee]=new nc(b,this.dracoLoader);break;case Ot.KHR_TEXTURE_TRANSFORM:P[ee]=new sf;break;case Ot.KHR_MESH_QUANTIZATION:P[ee]=new y0;break;default:fe.indexOf(ee)>=0&&I[ee]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ee+'".')}}b.additionalFiles=x,Q.setExtensions(P),Q.setPlugins(I),Q.parse(f,v)}parseAsync(h,l){const f=this;return new Promise(function(v,x){f.parse(h,l,v,x)})}}function qn(){let S={};return{get:function(h){return S[h]},add:function(h,l){S[h]=l},remove:function(h){delete S[h]},removeAll:function(){S={}}}}const Ot={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class oi{constructor(h){this.parser=h,this.name=Ot.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const h=this.parser,l=this.parser.json.nodes||[];for(let f=0,v=l.length;f<v;f++){const x=l[f];x.extensions&&x.extensions[this.name]&&x.extensions[this.name].light!==void 0&&h._addNodeRef(this.cache,x.extensions[this.name].light)}}_loadLight(h){const l=this.parser,f="light:"+h;let v=l.cache.get(f);if(v)return v;const x=l.json,I=((x.extensions&&x.extensions[this.name]||{}).lights||[])[h];let z;const Q=new G.Ilk(16777215);I.color!==void 0&&Q.fromArray(I.color);const H=I.range!==void 0?I.range:0;switch(I.type){case"directional":z=new G.Ox3(Q),z.target.position.set(0,0,-1),z.add(z.target);break;case"point":z=new G.cek(Q),z.distance=H;break;case"spot":z=new G.PMe(Q),z.distance=H,I.spot=I.spot||{},I.spot.innerConeAngle=I.spot.innerConeAngle!==void 0?I.spot.innerConeAngle:0,I.spot.outerConeAngle=I.spot.outerConeAngle!==void 0?I.spot.outerConeAngle:Math.PI/4,z.angle=I.spot.outerConeAngle,z.penumbra=1-I.spot.innerConeAngle/I.spot.outerConeAngle,z.target.position.set(0,0,-1),z.add(z.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+I.type)}return z.position.set(0,0,0),z.decay=2,Qo(z,I),I.intensity!==void 0&&(z.intensity=I.intensity),z.name=l.createUniqueName(I.name||"light_"+h),v=Promise.resolve(z),l.cache.add(f,v),v}getDependency(h,l){if(h==="light")return this._loadLight(l)}createNodeAttachment(h){const l=this,f=this.parser,x=f.json.nodes[h],P=(x.extensions&&x.extensions[this.name]||{}).light;return P===void 0?null:this._loadLight(P).then(function(I){return f._getNodeRef(l.cache,P,I)})}}class yi{constructor(){this.name=Ot.KHR_MATERIALS_UNLIT}getMaterialType(){return G.vBJ}extendParams(h,l,f){const v=[];h.color=new G.Ilk(1,1,1),h.opacity=1;const x=l.pbrMetallicRoughness;if(x){if(Array.isArray(x.baseColorFactor)){const b=x.baseColorFactor;h.color.fromArray(b),h.opacity=b[3]}x.baseColorTexture!==void 0&&v.push(f.assignTexture(h,"map",x.baseColorTexture,G.knz))}return Promise.all(v)}}class xr{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(h,l){const v=this.parser.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=v.extensions[this.name].emissiveStrength;return x!==void 0&&(l.emissiveIntensity=x),Promise.resolve()}}class _i{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_CLEARCOAT}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[],b=v.extensions[this.name];if(b.clearcoatFactor!==void 0&&(l.clearcoat=b.clearcoatFactor),b.clearcoatTexture!==void 0&&x.push(f.assignTexture(l,"clearcoatMap",b.clearcoatTexture)),b.clearcoatRoughnessFactor!==void 0&&(l.clearcoatRoughness=b.clearcoatRoughnessFactor),b.clearcoatRoughnessTexture!==void 0&&x.push(f.assignTexture(l,"clearcoatRoughnessMap",b.clearcoatRoughnessTexture)),b.clearcoatNormalTexture!==void 0&&(x.push(f.assignTexture(l,"clearcoatNormalMap",b.clearcoatNormalTexture)),b.clearcoatNormalTexture.scale!==void 0)){const P=b.clearcoatNormalTexture.scale;l.clearcoatNormalScale=new G.FM8(P,P)}return Promise.all(x)}}class Xs{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_IRIDESCENCE}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[],b=v.extensions[this.name];return b.iridescenceFactor!==void 0&&(l.iridescence=b.iridescenceFactor),b.iridescenceTexture!==void 0&&x.push(f.assignTexture(l,"iridescenceMap",b.iridescenceTexture)),b.iridescenceIor!==void 0&&(l.iridescenceIOR=b.iridescenceIor),l.iridescenceThicknessRange===void 0&&(l.iridescenceThicknessRange=[100,400]),b.iridescenceThicknessMinimum!==void 0&&(l.iridescenceThicknessRange[0]=b.iridescenceThicknessMinimum),b.iridescenceThicknessMaximum!==void 0&&(l.iridescenceThicknessRange[1]=b.iridescenceThicknessMaximum),b.iridescenceThicknessTexture!==void 0&&x.push(f.assignTexture(l,"iridescenceThicknessMap",b.iridescenceThicknessTexture)),Promise.all(x)}}class So{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_SHEEN}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[];l.sheenColor=new G.Ilk(0,0,0),l.sheenRoughness=0,l.sheen=1;const b=v.extensions[this.name];return b.sheenColorFactor!==void 0&&l.sheenColor.fromArray(b.sheenColorFactor),b.sheenRoughnessFactor!==void 0&&(l.sheenRoughness=b.sheenRoughnessFactor),b.sheenColorTexture!==void 0&&x.push(f.assignTexture(l,"sheenColorMap",b.sheenColorTexture,G.knz)),b.sheenRoughnessTexture!==void 0&&x.push(f.assignTexture(l,"sheenRoughnessMap",b.sheenRoughnessTexture)),Promise.all(x)}}class Ki{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_TRANSMISSION}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[],b=v.extensions[this.name];return b.transmissionFactor!==void 0&&(l.transmission=b.transmissionFactor),b.transmissionTexture!==void 0&&x.push(f.assignTexture(l,"transmissionMap",b.transmissionTexture)),Promise.all(x)}}class br{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_VOLUME}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[],b=v.extensions[this.name];l.thickness=b.thicknessFactor!==void 0?b.thicknessFactor:0,b.thicknessTexture!==void 0&&x.push(f.assignTexture(l,"thicknessMap",b.thicknessTexture)),l.attenuationDistance=b.attenuationDistance||1/0;const P=b.attenuationColor||[1,1,1];return l.attenuationColor=new G.Ilk(P[0],P[1],P[2]),Promise.all(x)}}class pu{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_IOR}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const v=this.parser.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=v.extensions[this.name];return l.ior=x.ior!==void 0?x.ior:1.5,Promise.resolve()}}class g0{constructor(h){this.parser=h,this.name=Ot.KHR_MATERIALS_SPECULAR}getMaterialType(h){const f=this.parser.json.materials[h];return!f.extensions||!f.extensions[this.name]?null:G.EJi}extendMaterialParams(h,l){const f=this.parser,v=f.json.materials[h];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();const x=[],b=v.extensions[this.name];l.specularIntensity=b.specularFactor!==void 0?b.specularFactor:1,b.specularTexture!==void 0&&x.push(f.assignTexture(l,"specularIntensityMap",b.specularTexture));const P=b.specularColorFactor||[1,1,1];return l.specularColor=new G.Ilk(P[0],P[1],P[2]),b.specularColorTexture!==void 0&&x.push(f.assignTexture(l,"specularColorMap",b.specularColorTexture,G.knz)),Promise.all(x)}}class v0{constructor(h){this.parser=h,this.name=Ot.KHR_TEXTURE_BASISU}loadTexture(h){const l=this.parser,f=l.json,v=f.textures[h];if(!v.extensions||!v.extensions[this.name])return null;const x=v.extensions[this.name],b=l.options.ktx2Loader;if(!b){if(f.extensionsRequired&&f.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return l.loadTextureImage(h,x.source,b)}}class Ea{constructor(h){this.parser=h,this.name=Ot.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(h){const l=this.name,f=this.parser,v=f.json,x=v.textures[h];if(!x.extensions||!x.extensions[l])return null;const b=x.extensions[l],P=v.images[b.source];let I=f.textureLoader;if(P.uri){const z=f.options.manager.getHandler(P.uri);z!==null&&(I=z)}return this.detectSupport().then(function(z){if(z)return f.loadTextureImage(h,b.source,I);if(v.extensionsRequired&&v.extensionsRequired.indexOf(l)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return f.loadTexture(h)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(h){const l=new Image;l.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",l.onload=l.onerror=function(){h(l.height===1)}})),this.isSupported}}class pi{constructor(h){this.parser=h,this.name=Ot.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(h){const l=this.name,f=this.parser,v=f.json,x=v.textures[h];if(!x.extensions||!x.extensions[l])return null;const b=x.extensions[l],P=v.images[b.source];let I=f.textureLoader;if(P.uri){const z=f.options.manager.getHandler(P.uri);z!==null&&(I=z)}return this.detectSupport().then(function(z){if(z)return f.loadTextureImage(h,b.source,I);if(v.extensionsRequired&&v.extensionsRequired.indexOf(l)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return f.loadTexture(h)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(h){const l=new Image;l.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",l.onload=l.onerror=function(){h(l.height===1)}})),this.isSupported}}class bm{constructor(h){this.name=Ot.EXT_MESHOPT_COMPRESSION,this.parser=h}loadBufferView(h){const l=this.parser.json,f=l.bufferViews[h];if(f.extensions&&f.extensions[this.name]){const v=f.extensions[this.name],x=this.parser.getDependency("buffer",v.buffer),b=this.parser.options.meshoptDecoder;if(!b||!b.supported){if(l.extensionsRequired&&l.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return x.then(function(P){const I=v.byteOffset||0,z=v.byteLength||0,Q=v.count,H=v.byteStride,ee=new Uint8Array(P,I,z);return b.decodeGltfBufferAsync?b.decodeGltfBufferAsync(Q,H,ee,v.mode,v.filter).then(function(fe){return fe.buffer}):b.ready.then(function(){const fe=new ArrayBuffer(Q*H);return b.decodeGltfBuffer(new Uint8Array(fe),Q,H,ee,v.mode,v.filter),fe})})}else return null}}class wm{constructor(h){this.name=Ot.EXT_MESH_GPU_INSTANCING,this.parser=h}createNodeMesh(h){const l=this.parser.json,f=l.nodes[h];if(!f.extensions||!f.extensions[this.name]||f.mesh===void 0)return null;const v=l.meshes[f.mesh];for(const z of v.primitives)if(z.mode!==Is.TRIANGLES&&z.mode!==Is.TRIANGLE_STRIP&&z.mode!==Is.TRIANGLE_FAN&&z.mode!==void 0)return null;const b=f.extensions[this.name].attributes,P=[],I={};for(const z in b)P.push(this.parser.getDependency("accessor",b[z]).then(Q=>(I[z]=Q,I[z])));return P.length<1?null:(P.push(this.parser.createNodeMesh(h)),Promise.all(P).then(z=>{const Q=z.pop(),H=Q.isGroup?Q.children:[Q],ee=z[0].count,fe=[];for(const Se of H){const De=new G.yGw,Re=new G.Pa4,Te=new G._fP,Oe=new G.Pa4(1,1,1),Ae=new G.SPe(Se.geometry,Se.material,ee);for(let ke=0;ke<ee;ke++)I.TRANSLATION&&Re.fromBufferAttribute(I.TRANSLATION,ke),I.ROTATION&&Te.fromBufferAttribute(I.ROTATION,ke),I.SCALE&&Oe.fromBufferAttribute(I.SCALE,ke),Ae.setMatrixAt(ke,De.compose(Re,Te,Oe));for(const ke in I)ke!=="TRANSLATION"&&ke!=="ROTATION"&&ke!=="SCALE"&&Se.geometry.setAttribute(ke,I[ke]);G.Tme.prototype.copy.call(Ae,Se),Ae.frustumCulled=!1,this.parser.assignFinalMaterial(Ae),fe.push(Ae)}return Q.isGroup?(Q.clear(),Q.add(...fe),Q):fe[0]}))}}const Yo="glTF",tc=12,Lh={JSON:1313821514,BIN:5130562,JSON_EX:1313821514+66,BIN_EX:5130562+66};class Ys{constructor(h){this.name=Ot.KHR_BINARY_GLTF,this.content=null,this.body=null;const l=new DataView(h,0,tc),f=new TextDecoder;if(this.header={magic:f.decode(new Uint8Array(h.slice(0,4))),version:l.getUint32(4,!0),length:l.getUint32(8,!0)},this.header.magic!==Yo)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const v=this.header.length-tc,x=new DataView(h,tc);let b=0;for(;b<v;){const P=x.getUint32(b,!0);b+=4;const I=x.getUint32(b,!0);if(b+=4,I===Lh.JSON||I===Lh.JSON_EX){const z=new Uint8Array(h,tc+b,P);this.content=f.decode(z)}else if(I===Lh.BIN||I===Lh.BIN_EX){const z=tc+b;this.body=h.slice(z,z+P)}b+=P}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class nc{constructor(h,l){if(!l)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ot.KHR_DRACO_MESH_COMPRESSION,this.json=h,this.dracoLoader=l,this.dracoLoader.preload()}decodePrimitive(h,l){const f=this.json,v=this.dracoLoader,x=h.extensions[this.name].bufferView,b=h.extensions[this.name].attributes,P={},I={},z={};for(const Q in b){const H=af[Q]||Q.toLowerCase();P[H]=b[Q]}for(const Q in h.attributes){const H=af[Q]||Q.toLowerCase();if(b[Q]!==void 0){const ee=f.accessors[h.attributes[Q]],fe=ic[ee.componentType];z[H]=fe.name,I[H]=ee.normalized===!0}}return l.getDependency("bufferView",x).then(function(Q){return new Promise(function(H){v.decodeDracoFile(Q,function(ee){for(const fe in ee.attributes){const Se=ee.attributes[fe],De=I[fe];De!==void 0&&(Se.normalized=De)}H(ee)},P,z)})})}}class sf{constructor(){this.name=Ot.KHR_TEXTURE_TRANSFORM}extendTexture(h,l){return l.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),l.offset===void 0&&l.rotation===void 0&&l.scale===void 0||(h=h.clone(),l.offset!==void 0&&h.offset.fromArray(l.offset),l.rotation!==void 0&&(h.rotation=l.rotation),l.scale!==void 0&&h.repeat.fromArray(l.scale),h.needsUpdate=!0),h}}class y0{constructor(){this.name=Ot.KHR_MESH_QUANTIZATION}}class mu extends G._C8{constructor(h,l,f,v){super(h,l,f,v)}copySampleValue_(h){const l=this.resultBuffer,f=this.sampleValues,v=this.valueSize,x=h*v*3+v;for(let b=0;b!==v;b++)l[b]=f[x+b];return l}interpolate_(h,l,f,v){const x=this.resultBuffer,b=this.sampleValues,P=this.valueSize,I=P*2,z=P*3,Q=v-l,H=(f-l)/Q,ee=H*H,fe=ee*H,Se=h*z,De=Se-z,Re=-2*fe+3*ee,Te=fe-ee,Oe=1-Re,Ae=Te-ee+H;for(let ke=0;ke!==P;ke++){const lt=b[De+ke+P],wt=b[De+ke+I]*Q,xt=b[Se+ke+P],Ft=b[Se+ke]*Q;x[ke]=Oe*lt+Ae*wt+Re*xt+Te*Ft}return x}}const _0=new G._fP;class x0 extends mu{interpolate_(h,l,f,v){const x=super.interpolate_(h,l,f,v);return _0.fromArray(x).normalize().toArray(x),x}}const Is={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ic={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Am={9728:G.TyD,9729:G.wem,9984:G.YLQ,9985:G.qyh,9986:G.aH4,9987:G.D1R},Sm={33071:G.uWy,33648:G.OoA,10497:G.rpg},of={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},af={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ta={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},b0={CUBICSPLINE:void 0,LINEAR:G.NMF,STEP:G.Syv},lf={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function w0(S){return S.DefaultMaterial===void 0&&(S.DefaultMaterial=new G.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:G.Wl3})),S.DefaultMaterial}function gu(S,h,l){for(const f in l.extensions)S[f]===void 0&&(h.userData.gltfExtensions=h.userData.gltfExtensions||{},h.userData.gltfExtensions[f]=l.extensions[f])}function Qo(S,h){h.extras!==void 0&&(typeof h.extras=="object"?Object.assign(S.userData,h.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+h.extras))}function vu(S,h,l){let f=!1,v=!1,x=!1;for(let z=0,Q=h.length;z<Q;z++){const H=h[z];if(H.POSITION!==void 0&&(f=!0),H.NORMAL!==void 0&&(v=!0),H.COLOR_0!==void 0&&(x=!0),f&&v&&x)break}if(!f&&!v&&!x)return Promise.resolve(S);const b=[],P=[],I=[];for(let z=0,Q=h.length;z<Q;z++){const H=h[z];if(f){const ee=H.POSITION!==void 0?l.getDependency("accessor",H.POSITION):S.attributes.position;b.push(ee)}if(v){const ee=H.NORMAL!==void 0?l.getDependency("accessor",H.NORMAL):S.attributes.normal;P.push(ee)}if(x){const ee=H.COLOR_0!==void 0?l.getDependency("accessor",H.COLOR_0):S.attributes.color;I.push(ee)}}return Promise.all([Promise.all(b),Promise.all(P),Promise.all(I)]).then(function(z){const Q=z[0],H=z[1],ee=z[2];return f&&(S.morphAttributes.position=Q),v&&(S.morphAttributes.normal=H),x&&(S.morphAttributes.color=ee),S.morphTargetsRelative=!0,S})}function A0(S,h){if(S.updateMorphTargets(),h.weights!==void 0)for(let l=0,f=h.weights.length;l<f;l++)S.morphTargetInfluences[l]=h.weights[l];if(h.extras&&Array.isArray(h.extras.targetNames)){const l=h.extras.targetNames;if(S.morphTargetInfluences.length===l.length){S.morphTargetDictionary={};for(let f=0,v=l.length;f<v;f++)S.morphTargetDictionary[l[f]]=f}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function S0(S){const h=S.extensions&&S.extensions[Ot.KHR_DRACO_MESH_COMPRESSION];let l;return h?l="draco:"+h.bufferView+":"+h.indices+":"+Mm(h.attributes):l=S.indices+":"+Mm(S.attributes)+":"+S.mode,l}function Mm(S){let h="";const l=Object.keys(S).sort();for(let f=0,v=l.length;f<v;f++)h+=l[f]+":"+S[l[f]]+";";return h}function cf(S){switch(S){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function M0(S){return S.search(/\.jpe?g($|\?)/i)>0||S.search(/^data\:image\/jpeg/)===0?"image/jpeg":S.search(/\.webp($|\?)/i)>0||S.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const E0=new G.yGw;class T0{constructor(h={},l={}){this.json=h,this.extensions={},this.plugins={},this.options=l,this.cache=new qn,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let f=!1,v=!1,x=-1;typeof navigator<"u"&&(f=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,v=navigator.userAgent.indexOf("Firefox")>-1,x=v?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||f||v&&x<98?this.textureLoader=new G.dpR(this.options.manager):this.textureLoader=new G.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new G.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(h){this.extensions=h}setPlugins(h){this.plugins=h}parse(h,l){const f=this,v=this.json,x=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(b){return b._markDefs&&b._markDefs()}),Promise.all(this._invokeAll(function(b){return b.beforeRoot&&b.beforeRoot()})).then(function(){return Promise.all([f.getDependencies("scene"),f.getDependencies("animation"),f.getDependencies("camera")])}).then(function(b){const P={scene:b[0][v.scene||0],scenes:b[0],animations:b[1],cameras:b[2],asset:v.asset,parser:f,userData:{}};gu(x,P,v),Qo(P,v),Promise.all(f._invokeAll(function(I){return I.afterRoot&&I.afterRoot(P)})).then(function(){h(P)})}).catch(l)}_markDefs(){const h=this.json.nodes||[],l=this.json.skins||[],f=this.json.meshes||[];for(let v=0,x=l.length;v<x;v++){const b=l[v].joints;for(let P=0,I=b.length;P<I;P++)h[b[P]].isBone=!0}for(let v=0,x=h.length;v<x;v++){const b=h[v];b.mesh!==void 0&&(this._addNodeRef(this.meshCache,b.mesh),b.skin!==void 0&&(f[b.mesh].isSkinnedMesh=!0)),b.camera!==void 0&&this._addNodeRef(this.cameraCache,b.camera)}}_addNodeRef(h,l){l!==void 0&&(h.refs[l]===void 0&&(h.refs[l]=h.uses[l]=0),h.refs[l]++)}_getNodeRef(h,l,f){if(h.refs[l]<=1)return f;const v=f.clone(),x=(b,P)=>{const I=this.associations.get(b);I!=null&&this.associations.set(P,I);for(const[z,Q]of b.children.entries())x(Q,P.children[z])};return x(f,v),v.name+="_instance_"+h.uses[l]++,v}_invokeOne(h){const l=Object.values(this.plugins);l.push(this);for(let f=0;f<l.length;f++){const v=h(l[f]);if(v)return v}return null}_invokeAll(h){const l=Object.values(this.plugins);l.unshift(this);const f=[];for(let v=0;v<l.length;v++){const x=h(l[v]);x&&f.push(x)}return f}getDependency(h,l){const f=h+":"+l;let v=this.cache.get(f);if(!v){switch(h){case"scene":v=this.loadScene(l);break;case"node":v=this._invokeOne(function(x){return x.loadNode&&x.loadNode(l)});break;case"mesh":v=this._invokeOne(function(x){return x.loadMesh&&x.loadMesh(l)});break;case"accessor":v=this.loadAccessor(l);break;case"bufferView":v=this._invokeOne(function(x){return x.loadBufferView&&x.loadBufferView(l)});break;case"buffer":v=this.loadBuffer(l);break;case"material":v=this._invokeOne(function(x){return x.loadMaterial&&x.loadMaterial(l)});break;case"texture":v=this._invokeOne(function(x){return x.loadTexture&&x.loadTexture(l)});break;case"skin":v=this.loadSkin(l);break;case"animation":v=this._invokeOne(function(x){return x.loadAnimation&&x.loadAnimation(l)});break;case"camera":v=this.loadCamera(l);break;default:if(v=this._invokeOne(function(x){return x!=this&&x.getDependency&&x.getDependency(h,l)}),!v)throw new Error("Unknown type: "+h);break}this.cache.add(f,v)}return v}getDependencies(h){let l=this.cache.get(h);if(!l){const f=this,v=this.json[h+(h==="mesh"?"es":"s")]||[];l=Promise.all(v.map(function(x,b){return f.getDependency(h,b)})),this.cache.add(h,l)}return l}loadBuffer(h){const l=this.json.buffers[h],f=this.fileLoader;if(l.type&&l.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+l.type+" buffer type is not supported.");if(l.uri===void 0&&h===0)return Promise.resolve(this.extensions[Ot.KHR_BINARY_GLTF].body);let v=this.json.additionalFiles,x=v?v.find(P=>P.name===l.uri):null;const b=this.options;return new Promise(function(P,I){f.load(G.Zp0.resolveURL(l.uri,b.path),P,void 0,function(){I(new Error('THREE.GLTFLoader: Failed to load buffer "'+l.uri+'".'))},x)})}loadBufferView(h){const l=this.json.bufferViews[h];return this.getDependency("buffer",l.buffer).then(function(f){const v=l.byteLength||0,x=l.byteOffset||0;return f.slice(x,x+v)})}loadAccessor(h){const l=this,f=this.json,v=this.json.accessors[h];if(v.bufferView===void 0&&v.sparse===void 0){const b=of[v.type],P=ic[v.componentType],I=v.normalized===!0,z=new P(v.count*b);return Promise.resolve(new G.TlE(z,b,I))}const x=[];return v.bufferView!==void 0?x.push(this.getDependency("bufferView",v.bufferView)):x.push(null),v.sparse!==void 0&&(x.push(this.getDependency("bufferView",v.sparse.indices.bufferView)),x.push(this.getDependency("bufferView",v.sparse.values.bufferView))),Promise.all(x).then(function(b){const P=b[0],I=of[v.type],z=ic[v.componentType],Q=z.BYTES_PER_ELEMENT,H=Q*I,ee=v.byteOffset||0,fe=v.bufferView!==void 0?f.bufferViews[v.bufferView].byteStride:void 0,Se=v.normalized===!0;let De,Re;if(fe&&fe!==H){const Te=Math.floor(ee/fe),Oe="InterleavedBuffer:"+v.bufferView+":"+v.componentType+":"+Te+":"+v.count;let Ae=l.cache.get(Oe);Ae||(De=new z(P,Te*fe,v.count*fe/Q),Ae=new G.vpT(De,fe/Q),l.cache.add(Oe,Ae)),Re=new G.kB5(Ae,I,ee%fe/Q,Se)}else P===null?De=new z(v.count*I):De=new z(P,ee,v.count*I),Re=new G.TlE(De,I,Se);if(v.sparse!==void 0){const Te=of.SCALAR,Oe=ic[v.sparse.indices.componentType],Ae=v.sparse.indices.byteOffset||0,ke=v.sparse.values.byteOffset||0,lt=new Oe(b[1],Ae,v.sparse.count*Te),wt=new z(b[2],ke,v.sparse.count*I);P!==null&&(Re=new G.TlE(Re.array.slice(),Re.itemSize,Re.normalized));for(let xt=0,Ft=lt.length;xt<Ft;xt++){const Rt=lt[xt];if(Re.setX(Rt,wt[xt*I]),I>=2&&Re.setY(Rt,wt[xt*I+1]),I>=3&&Re.setZ(Rt,wt[xt*I+2]),I>=4&&Re.setW(Rt,wt[xt*I+3]),I>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Re})}loadTexture(h){const l=this.json,f=this.options,x=l.textures[h].source,b=l.images[x];let P=this.textureLoader;if(b.uri){const I=f.manager.getHandler(b.uri);I!==null&&(P=I)}return this.loadTextureImage(h,x,P)}loadTextureImage(h,l,f){const v=this,x=this.json,b=x.textures[h],P=x.images[l],I=(P.uri||P.bufferView)+":"+b.sampler;if(this.textureCache[I])return this.textureCache[I];const z=this.loadImageSource(l,f).then(function(Q){Q.flipY=!1,Q.name=b.name||P.name||"";const ee=(x.samplers||{})[b.sampler]||{};return Q.magFilter=Am[ee.magFilter]||G.wem,Q.minFilter=Am[ee.minFilter]||G.D1R,Q.wrapS=Sm[ee.wrapS]||G.rpg,Q.wrapT=Sm[ee.wrapT]||G.rpg,v.associations.set(Q,{textures:h}),Q}).catch(function(){return null});return this.textureCache[I]=z,z}loadImageSource(h,l){const f=this,v=this.json,x=this.options;if(this.sourceCache[h]!==void 0)return this.sourceCache[h].then(H=>H.clone());const b=v.images[h],P=self.URL||self.webkitURL;let I=b.uri||"",z=!1;if(b.bufferView!==void 0)I=f.getDependency("bufferView",b.bufferView).then(function(H){z=!0;const ee=new Blob([H],{type:b.mimeType});return I=P.createObjectURL(ee),I});else{if(b.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+h+" is missing URI and bufferView");if(v.additionalFiles){let H=I.split("\\").pop().split("/").pop(),ee=v.additionalFiles.find(fe=>H===fe.name);ee&&(I=(0,at.hR)(ee))}}const Q=Promise.resolve(I).then(function(H){return new Promise(function(ee,fe){let Se=ee;l.isImageBitmapLoader===!0&&(Se=function(De){const Re=new G.xEZ(De);Re.needsUpdate=!0,ee(Re)}),l.load(G.Zp0.resolveURL(H,x.path),Se,void 0,fe)})}).then(function(H){return z===!0&&P.revokeObjectURL(I),H.userData.mimeType=b.mimeType||M0(b.uri),H}).catch(function(H){throw console.error("THREE.GLTFLoader: Couldn't load texture",I),H});return this.sourceCache[h]=Q,Q}assignTexture(h,l,f,v){const x=this;return this.getDependency("texture",f.index).then(function(b){if(!b)return null;if(f.texCoord!==void 0&&f.texCoord!=0&&!(l==="aoMap"&&f.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+f.texCoord+" for texture "+l+" not yet supported."),x.extensions[Ot.KHR_TEXTURE_TRANSFORM]){const P=f.extensions!==void 0?f.extensions[Ot.KHR_TEXTURE_TRANSFORM]:void 0;if(P){const I=x.associations.get(b);b=x.extensions[Ot.KHR_TEXTURE_TRANSFORM].extendTexture(b,P),x.associations.set(b,I)}}return v!==void 0&&(b.encoding=v),h[l]=b,b})}assignFinalMaterial(h){const l=h.geometry;let f=h.material;const v=l.attributes.tangent===void 0,x=l.attributes.color!==void 0,b=l.attributes.normal===void 0;if(h.isPoints){const P="PointsMaterial:"+f.uuid;let I=this.cache.get(P);I||(I=new G.UY4,G.F5T.prototype.copy.call(I,f),I.color.copy(f.color),I.map=f.map,I.sizeAttenuation=!1,this.cache.add(P,I)),f=I}else if(h.isLine){const P="LineBasicMaterial:"+f.uuid;let I=this.cache.get(P);I||(I=new G.nls,G.F5T.prototype.copy.call(I,f),I.color.copy(f.color),this.cache.add(P,I)),f=I}if(v||x||b){let P="ClonedMaterial:"+f.uuid+":";v&&(P+="derivative-tangents:"),x&&(P+="vertex-colors:"),b&&(P+="flat-shading:");let I=this.cache.get(P);I||(I=f.clone(),x&&(I.vertexColors=!0),b&&(I.flatShading=!0),v&&(I.normalScale&&(I.normalScale.y*=-1),I.clearcoatNormalScale&&(I.clearcoatNormalScale.y*=-1)),this.cache.add(P,I),this.associations.set(I,this.associations.get(f))),f=I}f.aoMap&&l.attributes.uv2===void 0&&l.attributes.uv!==void 0&&l.setAttribute("uv2",l.attributes.uv),h.material=f}getMaterialType(){return G.Wid}loadMaterial(h){const l=this,f=this.json,v=this.extensions,x=f.materials[h];let b;const P={},I=x.extensions||{},z=[];if(I[Ot.KHR_MATERIALS_UNLIT]){const H=v[Ot.KHR_MATERIALS_UNLIT];b=H.getMaterialType(),z.push(H.extendParams(P,x,l))}else{const H=x.pbrMetallicRoughness||{};if(P.color=new G.Ilk(1,1,1),P.opacity=1,Array.isArray(H.baseColorFactor)){const ee=H.baseColorFactor;P.color.fromArray(ee),P.opacity=ee[3]}H.baseColorTexture!==void 0&&z.push(l.assignTexture(P,"map",H.baseColorTexture,G.knz)),P.metalness=H.metallicFactor!==void 0?H.metallicFactor:1,P.roughness=H.roughnessFactor!==void 0?H.roughnessFactor:1,H.metallicRoughnessTexture!==void 0&&(z.push(l.assignTexture(P,"metalnessMap",H.metallicRoughnessTexture)),z.push(l.assignTexture(P,"roughnessMap",H.metallicRoughnessTexture))),b=this._invokeOne(function(ee){return ee.getMaterialType&&ee.getMaterialType(h)}),z.push(Promise.all(this._invokeAll(function(ee){return ee.extendMaterialParams&&ee.extendMaterialParams(h,P)})))}x.doubleSided===!0&&(P.side=G.ehD);const Q=x.alphaMode||lf.OPAQUE;if(Q===lf.BLEND?(P.transparent=!0,P.depthWrite=!1):(P.transparent=!1,Q===lf.MASK&&(P.alphaTest=x.alphaCutoff!==void 0?x.alphaCutoff:.5)),x.normalTexture!==void 0&&b!==G.vBJ&&(z.push(l.assignTexture(P,"normalMap",x.normalTexture)),P.normalScale=new G.FM8(1,1),x.normalTexture.scale!==void 0)){const H=x.normalTexture.scale;P.normalScale.set(H,H)}return x.occlusionTexture!==void 0&&b!==G.vBJ&&(z.push(l.assignTexture(P,"aoMap",x.occlusionTexture)),x.occlusionTexture.strength!==void 0&&(P.aoMapIntensity=x.occlusionTexture.strength)),x.emissiveFactor!==void 0&&b!==G.vBJ&&(P.emissive=new G.Ilk().fromArray(x.emissiveFactor)),x.emissiveTexture!==void 0&&b!==G.vBJ&&z.push(l.assignTexture(P,"emissiveMap",x.emissiveTexture,G.knz)),Promise.all(z).then(function(){const H=new b(P);return x.name&&(H.name=x.name),Qo(H,x),l.associations.set(H,{materials:h}),x.extensions&&gu(v,H,x),H})}createUniqueName(h){const l=G.iUV.sanitizeNodeName(h||"");let f=l;for(let v=1;this.nodeNamesUsed[f];++v)f=l+"_"+v;return this.nodeNamesUsed[f]=!0,f}loadGeometries(h){const l=this,f=this.extensions,v=this.primitiveCache;function x(P){return f[Ot.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(P,l).then(function(I){return Em(I,P,l)})}const b=[];for(let P=0,I=h.length;P<I;P++){const z=h[P],Q=S0(z),H=v[Q];if(H)b.push(H.promise);else{let ee;z.extensions&&z.extensions[Ot.KHR_DRACO_MESH_COMPRESSION]?ee=x(z):ee=Em(new G.u9r,z,l),v[Q]={primitive:z,promise:ee},b.push(ee)}}return Promise.all(b)}loadMesh(h){const l=this,f=this.json,v=this.extensions,x=f.meshes[h],b=x.primitives,P=[];for(let I=0,z=b.length;I<z;I++){const Q=b[I].material===void 0?w0(this.cache):this.getDependency("material",b[I].material);P.push(Q)}return P.push(l.loadGeometries(b)),Promise.all(P).then(function(I){const z=I.slice(0,I.length-1),Q=I[I.length-1],H=[];for(let fe=0,Se=Q.length;fe<Se;fe++){const De=Q[fe],Re=b[fe];let Te;const Oe=z[fe];if(Re.mode===Is.TRIANGLES||Re.mode===Is.TRIANGLE_STRIP||Re.mode===Is.TRIANGLE_FAN||Re.mode===void 0)Te=x.isSkinnedMesh===!0?new G.TUv(De,Oe):new G.Kj0(De,Oe),Te.isSkinnedMesh===!0&&Te.normalizeSkinWeights(),Re.mode===Is.TRIANGLE_STRIP?Te.geometry=zt(Te.geometry,G.UlW):Re.mode===Is.TRIANGLE_FAN&&(Te.geometry=zt(Te.geometry,G.z$h));else if(Re.mode===Is.LINES)Te=new G.ejS(De,Oe);else if(Re.mode===Is.LINE_STRIP)Te=new G.x12(De,Oe);else if(Re.mode===Is.LINE_LOOP)Te=new G.blk(De,Oe);else if(Re.mode===Is.POINTS)Te=new G.woe(De,Oe);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Re.mode);Object.keys(Te.geometry.morphAttributes).length>0&&A0(Te,x),Te.name=l.createUniqueName(x.name||"mesh_"+h),Qo(Te,x),Re.extensions&&gu(v,Te,Re),l.assignFinalMaterial(Te),H.push(Te)}for(let fe=0,Se=H.length;fe<Se;fe++)l.associations.set(H[fe],{meshes:h,primitives:fe});if(H.length===1)return H[0];const ee=new G.ZAu;l.associations.set(ee,{meshes:h});for(let fe=0,Se=H.length;fe<Se;fe++)ee.add(H[fe]);return ee})}loadCamera(h){let l;const f=this.json.cameras[h],v=f[f.type];if(!v){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return f.type==="perspective"?l=new G.cPb(G.M8C.radToDeg(v.yfov),v.aspectRatio||1,v.znear||1,v.zfar||2e6):f.type==="orthographic"&&(l=new G.iKG(-v.xmag,v.xmag,v.ymag,-v.ymag,v.znear,v.zfar)),f.name&&(l.name=this.createUniqueName(f.name)),Qo(l,f),Promise.resolve(l)}loadSkin(h){const l=this.json.skins[h],f=[];for(let v=0,x=l.joints.length;v<x;v++)f.push(this._loadNodeShallow(l.joints[v]));return l.inverseBindMatrices!==void 0?f.push(this.getDependency("accessor",l.inverseBindMatrices)):f.push(null),Promise.all(f).then(function(v){const x=v.pop(),b=v,P=[],I=[];for(let z=0,Q=b.length;z<Q;z++){const H=b[z];if(H){P.push(H);const ee=new G.yGw;x!==null&&ee.fromArray(x.array,z*16),I.push(ee)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',l.joints[z])}return new G.OdW(P,I)})}loadAnimation(h){const f=this.json.animations[h],v=[],x=[],b=[],P=[],I=[];for(let z=0,Q=f.channels.length;z<Q;z++){const H=f.channels[z],ee=f.samplers[H.sampler],fe=H.target,Se=fe.node,De=f.parameters!==void 0?f.parameters[ee.input]:ee.input,Re=f.parameters!==void 0?f.parameters[ee.output]:ee.output;v.push(this.getDependency("node",Se)),x.push(this.getDependency("accessor",De)),b.push(this.getDependency("accessor",Re)),P.push(ee),I.push(fe)}return Promise.all([Promise.all(v),Promise.all(x),Promise.all(b),Promise.all(P),Promise.all(I)]).then(function(z){const Q=z[0],H=z[1],ee=z[2],fe=z[3],Se=z[4],De=[];for(let Te=0,Oe=Q.length;Te<Oe;Te++){const Ae=Q[Te],ke=H[Te],lt=ee[Te],wt=fe[Te],xt=Se[Te];if(Ae===void 0)continue;Ae.updateMatrix();let Ft;switch(Ta[xt.path]){case Ta.weights:Ft=G.dUE;break;case Ta.rotation:Ft=G.iLg;break;case Ta.position:case Ta.scale:default:Ft=G.yC1;break}const Rt=Ae.name?Ae.name:Ae.uuid,on=wt.interpolation!==void 0?b0[wt.interpolation]:G.NMF,Nt=[];Ta[xt.path]===Ta.weights?Ae.traverse(function(Ai){Ai.morphTargetInfluences&&Nt.push(Ai.name?Ai.name:Ai.uuid)}):Nt.push(Rt);let In=lt.array;if(lt.normalized){const Ai=cf(In.constructor),$n=new Float32Array(In.length);for(let Fn=0,nr=In.length;Fn<nr;Fn++)$n[Fn]=In[Fn]*Ai;In=$n}for(let Ai=0,$n=Nt.length;Ai<$n;Ai++){const Fn=new Ft(Nt[Ai]+"."+Ta[xt.path],ke.array,In,on);wt.interpolation==="CUBICSPLINE"&&(Fn.createInterpolant=function(ui){const Ui=this instanceof G.iLg?x0:mu;return new Ui(this.times,this.values,this.getValueSize()/3,ui)},Fn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),De.push(Fn)}}const Re=f.name?f.name:"animation_"+h;return new G.m7l(Re,void 0,De)})}createNodeMesh(h){const l=this.json,f=this,v=l.nodes[h];return v.mesh===void 0?null:f.getDependency("mesh",v.mesh).then(function(x){const b=f._getNodeRef(f.meshCache,v.mesh,x);return v.weights!==void 0&&b.traverse(function(P){if(P.isMesh)for(let I=0,z=v.weights.length;I<z;I++)P.morphTargetInfluences[I]=v.weights[I]}),b})}loadNode(h){const l=this.json,f=this,v=l.nodes[h],x=f._loadNodeShallow(h),b=[],P=v.children||[];for(let z=0,Q=P.length;z<Q;z++)b.push(f.getDependency("node",P[z]));const I=v.skin===void 0?Promise.resolve(null):f.getDependency("skin",v.skin);return Promise.all([x,Promise.all(b),I]).then(function(z){const Q=z[0],H=z[1],ee=z[2];ee!==null&&Q.traverse(function(fe){fe.isSkinnedMesh&&fe.bind(ee,E0)});for(let fe=0,Se=H.length;fe<Se;fe++)Q.add(H[fe]);return Q})}_loadNodeShallow(h){const l=this.json,f=this.extensions,v=this;if(this.nodeCache[h]!==void 0)return this.nodeCache[h];const x=l.nodes[h],b=x.name?v.createUniqueName(x.name):"",P=[],I=v._invokeOne(function(z){return z.createNodeMesh&&z.createNodeMesh(h)});return I&&P.push(I),x.camera!==void 0&&P.push(v.getDependency("camera",x.camera).then(function(z){return v._getNodeRef(v.cameraCache,x.camera,z)})),v._invokeAll(function(z){return z.createNodeAttachment&&z.createNodeAttachment(h)}).forEach(function(z){P.push(z)}),this.nodeCache[h]=Promise.all(P).then(function(z){let Q;if(x.isBone===!0?Q=new G.N$j:z.length>1?Q=new G.ZAu:z.length===1?Q=z[0]:Q=new G.Tme,Q!==z[0])for(let H=0,ee=z.length;H<ee;H++)Q.add(z[H]);if(x.name&&(Q.userData.name=x.name,Q.name=b),Qo(Q,x),x.extensions&&gu(f,Q,x),x.matrix!==void 0){const H=new G.yGw;H.fromArray(x.matrix),Q.applyMatrix4(H)}else x.translation!==void 0&&Q.position.fromArray(x.translation),x.rotation!==void 0&&Q.quaternion.fromArray(x.rotation),x.scale!==void 0&&Q.scale.fromArray(x.scale);return v.associations.has(Q)||v.associations.set(Q,{}),v.associations.get(Q).nodes=h,Q}),this.nodeCache[h]}loadScene(h){const l=this.extensions,f=this.json.scenes[h],v=this,x=new G.ZAu;f.name&&(x.name=v.createUniqueName(f.name)),Qo(x,f),f.extensions&&gu(l,x,f);const b=f.nodes||[],P=[];for(let I=0,z=b.length;I<z;I++)P.push(v.getDependency("node",b[I]));return Promise.all(P).then(function(I){for(let Q=0,H=I.length;Q<H;Q++)x.add(I[Q]);const z=Q=>{const H=new Map;for(const[ee,fe]of v.associations)(ee instanceof G.F5T||ee instanceof G.xEZ)&&H.set(ee,fe);return Q.traverse(ee=>{const fe=v.associations.get(ee);fe!=null&&H.set(ee,fe)}),H};return v.associations=z(x),x})}}function C0(S,h,l){const f=h.attributes,v=new G.ZzF;if(f.POSITION!==void 0){const P=l.json.accessors[f.POSITION],I=P.min,z=P.max;if(I!==void 0&&z!==void 0){if(v.set(new G.Pa4(I[0],I[1],I[2]),new G.Pa4(z[0],z[1],z[2])),P.normalized){const Q=cf(ic[P.componentType]);v.min.multiplyScalar(Q),v.max.multiplyScalar(Q)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const x=h.targets;if(x!==void 0){const P=new G.Pa4,I=new G.Pa4;for(let z=0,Q=x.length;z<Q;z++){const H=x[z];if(H.POSITION!==void 0){const ee=l.json.accessors[H.POSITION],fe=ee.min,Se=ee.max;if(fe!==void 0&&Se!==void 0){if(I.setX(Math.max(Math.abs(fe[0]),Math.abs(Se[0]))),I.setY(Math.max(Math.abs(fe[1]),Math.abs(Se[1]))),I.setZ(Math.max(Math.abs(fe[2]),Math.abs(Se[2]))),ee.normalized){const De=cf(ic[ee.componentType]);I.multiplyScalar(De)}P.max(I)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}v.expandByVector(P)}S.boundingBox=v;const b=new G.aLr;v.getCenter(b.center),b.radius=v.min.distanceTo(v.max)/2,S.boundingSphere=b}function Em(S,h,l){const f=h.attributes,v=[];function x(b,P){return l.getDependency("accessor",b).then(function(I){S.setAttribute(P,I)})}for(const b in f){const P=af[b]||b.toLowerCase();P in S.attributes||v.push(x(f[b],P))}if(h.indices!==void 0&&!S.index){const b=l.getDependency("accessor",h.indices).then(function(P){S.setIndex(P)});v.push(b)}return Qo(S,h),C0(S,h,l),Promise.all(v).then(function(){return h.targets!==void 0?vu(S,h.targets,l):S})}var uf=function(){var S="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:P8Yqdbk;3sezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfgocl4cifcd4hxdndndndnaoc9WGgmTmbcbhPcehsawcjdfhzalhHinaraH9Rax6midnaraHaxfgl9RcK6mbczhoinawcj;cbfaogifgoc9WfhOdndndndndnaHaic9WfgAco4fRbbaAci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOalRblalRbbgAco4gCaCciSgCE86bbaocGfalclfaCfgORbbaAcl4ciGgCaCciSgCE86bbaocVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbaoc7faOaCfgORbbaAciGgAaAciSgAE86bbaoctfaOaAfgARbbalRbegOco4gCaCciSgCE86bbaoc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc93faAaCfgARbbaOciGgOaOciSgOE86bbaoc94faAaOfgARbbalRbdgOco4gCaCciSgCE86bbaoc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbaoc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbaoc97faAaCfgARbbaOciGgOaOciSgOE86bbaoc98faAaOfgORbbalRbiglco4gAaAciSgAE86bbaoc99faOaAfgORbbalcl4ciGgAaAciSgAE86bbaoc9:faOaAfgORbbalcd4ciGgAaAciSgAE86bbaocufaOaAfgoRbbalciGglalciSglE86bbaoalfhlxdkaOalRbwalRbbgAcl4gCaCcsSgCE86bbaocGfalcwfaCfgORbbaAcsGgAaAcsSgAE86bbaocVfaOaAfgORbbalRbegAcl4gCaCcsSgCE86bbaoc7faOaCfgORbbaAcsGgAaAcsSgAE86bbaoctfaOaAfgORbbalRbdgAcl4gCaCcsSgCE86bbaoc91faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc4faOaAfgORbbalRbigAcl4gCaCcsSgCE86bbaoc93faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc94faOaAfgORbbalRblgAcl4gCaCcsSgCE86bbaoc95faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc96faOaAfgORbbalRbvgAcl4gCaCcsSgCE86bbaoc97faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc98faOaAfgORbbalRbogAcl4gCaCcsSgCE86bbaoc99faOaCfgORbbaAcsGgAaAcsSgAE86bbaoc9:faOaAfgORbbalRbrglcl4gAaAcsSgAE86bbaocufaOaAfgoRbbalcsGglalcsSglE86bbaoalfhlxekaOal8Pbb83bbaOcwfalcwf8Pbb83bbalczfhlkdnaiam9pmbaiczfhoaral9RcL0mekkaiam6mialTmidnakTmbawaPfRbbhOcbhoazhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkkazcefhzaPcefgPad6hsalhHaPad9hmexvkkcbhlasceGmdxikalaxad2fhCdnakTmbcbhHcehsawcjdfhminaral9Rax6mialTmdalaxfhlawaHfRbbhOcbhoamhiinaiawcj;cbfaofRbbgAce4cbaAceG9R7aOfgO86bbaiadfhiaocefgoak9hmbkamcefhmaHcefgHad6hsaHad9hmbkaChlxikcbhocehsinaral9Rax6mdalTmealaxfhlaocefgoad6hsadao9hmbkaChlxdkcbhlasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqalmbkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;yzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2geTmbinababydbgdcwtcw91:Yadce91cjjj;8ifcjjj98G::NUdbabclfhbaecufgembkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaiczfhiaeczfheadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",h="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;t9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;h8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgohAaoclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;uzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhDcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgrc;Ve0mbavc;abfalarcl4cu7fcsGcitfgPydlhsaPydbhzdnarcsGgPak9pmbavaiarcu7fcsGcdtfydbaxaPEhraPThPdndnadcd9hmbabaDcetfgHaz87ebaHcdfas87ebaHclfar87ebxekabaDcdtfgHazBdbaHclfasBdbaHcwfarBdbkaxaPfhxavc;abfalcitfgHarBdbaHasBdlavaicdtfarBdbavc;abfalcefcsGglcitfgHazBdbaHarBdlaiaPfhialcefhlxdkdndnaPcsSmbamaPfaPc987fcefhmxekaocefhrao8SbbgPcFeGhHdndnaPcu9mmbarhoxekaocvfhoaHcFbGhHcrhPdninar8SbbgOcFbGaPtaHVhHaOcu9kmearcefhraPcrfgPc8J9hmbxdkkarcefhokaHce4cbaHceG9R7amfhmkdndnadcd9hmbabaDcetfgraz87ebarcdfas87ebarclfam87ebxekabaDcdtfgrazBdbarclfasBdbarcwfamBdbkavc;abfalcitfgramBdbarasBdlavaicdtfamBdbavc;abfalcefcsGglcitfgrazBdbaramBdlaicefhialcefhlxekdnarcpe0mbaxcefgOavaiaqarcsGfRbbgPcl49RcsGcdtfydbaPcz6gHEhravaiaP9RcsGcdtfydbaOaHfgsaPcsGgOEhPaOThOdndnadcd9hmbabaDcetfgzax87ebazcdfar87ebazclfaP87ebxekabaDcdtfgzaxBdbazclfarBdbazcwfaPBdbkavaicdtfaxBdbavc;abfalcitfgzarBdbazaxBdlavaicefgicsGcdtfarBdbavc;abfalcefcsGcitfgzaPBdbazarBdlavaiaHfcsGgicdtfaPBdbavc;abfalcdfcsGglcitfgraxBdbaraPBdlalcefhlaiaOfhiasaOfhxxekaxcbaoRbbgzEgAarc;:eSgrfhsazcsGhCazcl4hXdndnazcs0mbascefhOxekashOavaiaX9RcsGcdtfydbhskdndnaCmbaOcefhxxekaOhxavaiaz9RcsGcdtfydbhOkdndnarTmbaocefhrxekaocdfhrao8SbegHcFeGhPdnaHcu9kmbaocofhAaPcFbGhPcrhodninar8SbbgHcFbGaotaPVhPaHcu9kmearcefhraocrfgoc8J9hmbkaAhrxekarcefhrkaPce4cbaPceG9R7amfgmhAkdndnaXcsSmbarhPxekarcefhPar8SbbgocFeGhHdnaocu9kmbarcvfhsaHcFbGhHcrhodninaP8SbbgrcFbGaotaHVhHarcu9kmeaPcefhPaocrfgoc8J9hmbkashPxekaPcefhPkaHce4cbaHceG9R7amfgmhskdndnaCcsSmbaPhoxekaPcefhoaP8SbbgrcFeGhHdnarcu9kmbaPcvfhOaHcFbGhHcrhrdninao8SbbgPcFbGartaHVhHaPcu9kmeaocefhoarcrfgrc8J9hmbkaOhoxekaocefhokaHce4cbaHceG9R7amfgmhOkdndnadcd9hmbabaDcetfgraA87ebarcdfas87ebarclfaO87ebxekabaDcdtfgraABdbarclfasBdbarcwfaOBdbkavc;abfalcitfgrasBdbaraABdlavaicdtfaABdbavc;abfalcefcsGcitfgraOBdbarasBdlavaicefgicsGcdtfasBdbavc;abfalcdfcsGcitfgraABdbaraOBdlavaiazcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiaDcifgDae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:llevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaicd4cbaice4ceG9R7avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:EPliuo97eue978Jjjjjbca9Rhidndnadcl9hmbdnaec98GglTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaiaeciGgvcdtgdVcbczad9R;8kbaiabalcdtfglad;8qbbdnavTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkalaiad;8qbbskdnaec98GgxTmbcbhvabhdinadczfglalpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgvax6mbkkaxae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabaxcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbhdabheinaeaepbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbaeczfheadclfgdav6mbkkdnaval9pmbaialciGgdcdtgeVcbc;abae9R;8kbaiabavcdtfgvae;8qbbdnadTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiae;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb",l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),f=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var v=WebAssembly.validate(l)?h:S,x,b=WebAssembly.instantiate(P(v),{}).then(function(Te){x=Te.instance,x.exports.__wasm_call_ctors()});function P(Te){for(var Oe=new Uint8Array(Te.length),Ae=0;Ae<Te.length;++Ae){var ke=Te.charCodeAt(Ae);Oe[Ae]=ke>96?ke-97:ke>64?ke-39:ke+4}for(var lt=0,Ae=0;Ae<Te.length;++Ae)Oe[lt++]=Oe[Ae]<60?f[Oe[Ae]]:(Oe[Ae]-60)*64+Oe[++Ae];return Oe.buffer.slice(0,lt)}function I(Te,Oe,Ae,ke,lt,wt){var xt=x.exports.sbrk,Ft=Ae+3&-4,Rt=xt(Ft*ke),on=xt(lt.length),Nt=new Uint8Array(x.exports.memory.buffer);Nt.set(lt,on);var In=Te(Rt,Ae,ke,on,lt.length);if(In==0&&wt&&wt(Rt,Ft,ke),Oe.set(Nt.subarray(Rt,Rt+Ae*ke)),xt(Rt-xt(0)),In!=0)throw new Error("Malformed buffer data: "+In)}var z={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Q={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},H=[],ee=0;function fe(Te){var Oe={object:new Worker(Te),pending:0,requests:{}};return Oe.object.onmessage=function(Ae){var ke=Ae.data;Oe.pending-=ke.count,Oe.requests[ke.id][ke.action](ke.value),delete Oe.requests[ke.id]},Oe}function Se(Te){for(var Oe="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(P(v))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+I.toString()+Re.toString(),Ae=new Blob([Oe],{type:"text/javascript"}),ke=URL.createObjectURL(Ae),lt=0;lt<Te;++lt)H[lt]=fe(ke);URL.revokeObjectURL(ke)}function De(Te,Oe,Ae,ke,lt){for(var wt=H[0],xt=1;xt<H.length;++xt)H[xt].pending<wt.pending&&(wt=H[xt]);return new Promise(function(Ft,Rt){var on=new Uint8Array(Ae),Nt=ee++;wt.pending+=Te,wt.requests[Nt]={resolve:Ft,reject:Rt},wt.object.postMessage({id:Nt,count:Te,size:Oe,source:on,mode:ke,filter:lt},[on.buffer])})}function Re(Te){b.then(function(){var Oe=Te.data;try{var Ae=new Uint8Array(Oe.count*Oe.size);I(x.exports[Oe.mode],Ae,Oe.count,Oe.size,Oe.source,x.exports[Oe.filter]),self.postMessage({id:Oe.id,count:Oe.count,action:"resolve",value:Ae},[Ae.buffer])}catch(ke){self.postMessage({id:Oe.id,count:Oe.count,action:"reject",value:ke})}})}return{ready:b,supported:!0,useWorkers:function(Te){Se(Te)},decodeVertexBuffer:function(Te,Oe,Ae,ke,lt){I(x.exports.meshopt_decodeVertexBuffer,Te,Oe,Ae,ke,x.exports[z[lt]])},decodeIndexBuffer:function(Te,Oe,Ae,ke){I(x.exports.meshopt_decodeIndexBuffer,Te,Oe,Ae,ke)},decodeIndexSequence:function(Te,Oe,Ae,ke){I(x.exports.meshopt_decodeIndexSequence,Te,Oe,Ae,ke)},decodeGltfBuffer:function(Te,Oe,Ae,ke,lt,wt){I(x.exports[Q[lt]],Te,Oe,Ae,ke,x.exports[z[wt]])},decodeGltfBufferAsync:function(Te,Oe,Ae,ke,lt){return H.length>0?De(Te,Oe,Ae,Q[ke],z[lt]):b.then(function(){var wt=new Uint8Array(Te*Oe);return I(x.exports[Q[ke]],wt,Te,Oe,Ae,x.exports[z[lt]]),wt})}}}();class yu extends tn{constructor(){super(...arguments);B(this,"extensions",["gltf","glb"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b}){const P=Q=>{const H=Q.scene;Object.assign(H,{animations:Q.animations}),Object.assign(H.meshData,Pt(H)),v(H)};let I=new Cn(this.viewer.loadingManager),z=new He(this.viewer.loadingManager);z.setDecoderPath(this.viewer.dracoPath),I.setDRACOLoader(z),I.setMeshoptDecoder(uf),I.load(l,P,x,b,f)}}class Ko extends G.yxD{constructor(h){super(h),this.type=G.cLu}parse(h){const P=function(Ae,ke){switch(Ae){case 1:console.error("THREE.RGBELoader Read Error: "+(ke||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(ke||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(ke||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(ke||""))}return-1},H=`
`,ee=function(Ae,ke,lt){ke=ke||1024;let xt=Ae.pos,Ft=-1,Rt=0,on="",Nt=String.fromCharCode.apply(null,new Uint16Array(Ae.subarray(xt,xt+128)));for(;0>(Ft=Nt.indexOf(H))&&Rt<ke&&xt<Ae.byteLength;)on+=Nt,Rt+=Nt.length,xt+=128,Nt+=String.fromCharCode.apply(null,new Uint16Array(Ae.subarray(xt,xt+128)));return-1<Ft?(lt!==!1&&(Ae.pos+=Rt+Ft+1),on+Nt.slice(0,Ft)):!1},fe=function(Ae){const ke=/^#\?(\S+)/,lt=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,wt=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,xt=/^\s*FORMAT=(\S+)\s*$/,Ft=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Rt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let on,Nt;if(Ae.pos>=Ae.byteLength||!(on=ee(Ae)))return P(1,"no header found");if(!(Nt=on.match(ke)))return P(3,"bad initial token");for(Rt.valid|=1,Rt.programtype=Nt[1],Rt.string+=on+`
`;on=ee(Ae),on!==!1;){if(Rt.string+=on+`
`,on.charAt(0)==="#"){Rt.comments+=on+`
`;continue}if((Nt=on.match(lt))&&(Rt.gamma=parseFloat(Nt[1])),(Nt=on.match(wt))&&(Rt.exposure=parseFloat(Nt[1])),(Nt=on.match(xt))&&(Rt.valid|=2,Rt.format=Nt[1]),(Nt=on.match(Ft))&&(Rt.valid|=4,Rt.height=parseInt(Nt[1],10),Rt.width=parseInt(Nt[2],10)),Rt.valid&2&&Rt.valid&4)break}return Rt.valid&2?Rt.valid&4?Rt:P(3,"missing image size specifier"):P(3,"missing format specifier")},Se=function(Ae,ke,lt){const wt=ke;if(wt<8||wt>32767||Ae[0]!==2||Ae[1]!==2||Ae[2]&128)return new Uint8Array(Ae);if(wt!==(Ae[2]<<8|Ae[3]))return P(3,"wrong scanline width");const xt=new Uint8Array(4*ke*lt);if(!xt.length)return P(4,"unable to allocate buffer space");let Ft=0,Rt=0;const on=4*wt,Nt=new Uint8Array(4),In=new Uint8Array(on);let Ai=lt;for(;Ai>0&&Rt<Ae.byteLength;){if(Rt+4>Ae.byteLength)return P(1);if(Nt[0]=Ae[Rt++],Nt[1]=Ae[Rt++],Nt[2]=Ae[Rt++],Nt[3]=Ae[Rt++],Nt[0]!=2||Nt[1]!=2||(Nt[2]<<8|Nt[3])!=wt)return P(3,"bad rgbe scanline format");let $n=0,Fn;for(;$n<on&&Rt<Ae.byteLength;){Fn=Ae[Rt++];const ui=Fn>128;if(ui&&(Fn-=128),Fn===0||$n+Fn>on)return P(3,"bad scanline data");if(ui){const Ui=Ae[Rt++];for(let Ri=0;Ri<Fn;Ri++)In[$n++]=Ui}else In.set(Ae.subarray(Rt,Rt+Fn),$n),$n+=Fn,Rt+=Fn}const nr=wt;for(let ui=0;ui<nr;ui++){let Ui=0;xt[Ft]=In[ui+Ui],Ui+=wt,xt[Ft+1]=In[ui+Ui],Ui+=wt,xt[Ft+2]=In[ui+Ui],Ui+=wt,xt[Ft+3]=In[ui+Ui],Ft+=4}Ai--}return xt},De=function(Ae,ke,lt,wt){const xt=Ae[ke+3],Ft=Math.pow(2,xt-128)/255;lt[wt+0]=Ae[ke+0]*Ft,lt[wt+1]=Ae[ke+1]*Ft,lt[wt+2]=Ae[ke+2]*Ft,lt[wt+3]=1},Re=function(Ae,ke,lt,wt){const xt=Ae[ke+3],Ft=Math.pow(2,xt-128)/255;lt[wt+0]=G.A5E.toHalfFloat(Math.min(Ae[ke+0]*Ft,65504)),lt[wt+1]=G.A5E.toHalfFloat(Math.min(Ae[ke+1]*Ft,65504)),lt[wt+2]=G.A5E.toHalfFloat(Math.min(Ae[ke+2]*Ft,65504)),lt[wt+3]=G.A5E.toHalfFloat(1)},Te=new Uint8Array(h);Te.pos=0;const Oe=fe(Te);if(Oe!==-1){const Ae=Oe.width,ke=Oe.height,lt=Se(Te.subarray(Te.pos),Ae,ke);if(lt!==-1){let wt,xt,Ft;switch(this.type){case G.VzW:Ft=lt.length/4;const Rt=new Float32Array(Ft*4);for(let Nt=0;Nt<Ft;Nt++)De(lt,Nt*4,Rt,Nt*4);wt=Rt,xt=G.VzW;break;case G.cLu:Ft=lt.length/4;const on=new Uint16Array(Ft*4);for(let Nt=0;Nt<Ft;Nt++)Re(lt,Nt*4,on,Nt*4);wt=on,xt=G.cLu;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:Ae,height:ke,data:wt,header:Oe.string,gamma:Oe.gamma,exposure:Oe.exposure,type:xt}}}return null}setDataType(h){return this.type=h,this}load(h,l,f,v,x){function b(P,I){switch(P.type){case G.VzW:case G.cLu:P.encoding=G.rnI,P.minFilter=G.wem,P.magFilter=G.wem,P.generateMipmaps=!1,P.flipY=!0;break}l&&l(P,I)}return super.load(h,b,f,v,x)}}class Vr extends tn{constructor(){super(...arguments);B(this,"extensions",["hdr"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b,texSettings:P}){new Ko(this.viewer.loadingManager).load(l,I=>v(Object.assign(I,P)),x,b,f)}}class le extends tn{constructor(){super(...arguments);B(this,"extensions",["json"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b}){new d.hH6(this.viewer.loadingManager).load(l,P=>v(JSON.parse(P)),x,b,f)}}class Oh extends tn{constructor(){super(...arguments);B(this,"extensions",["png","jpg","webp","avif"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b,texSettings:P}){const I=this.viewer.renderer.outputEncoding;new d.dpR(this.viewer.loadingManager).load(l,z=>v(Object.assign(z,Object.assign({encoding:I},P))),x,b,f)}}class hf extends tn{constructor(){super(...arguments);B(this,"extensions",["img"])}load({url:l,file:f,onLoad:v,onProgress:x,onError:b}){this.viewer.renderer.outputEncoding,new d.S3k(this.viewer.loadingManager).load(l,v,x,b,f)}}var $i=r(461);class Fh{constructor(h){B(this,"_targets",[]);B(this,"_callback");this._callback=h}add(h){this._targets.push(h)}remove(h){let l=this._targets.indexOf(h);l!==-1&&this._targets.splice(l,1)}invoke(h){let l=this._callback;for(let f of this._targets)l(f,h)}}class ul extends Fh{invoke(h){if(this._targets.length>0){let l=this._callback;for(let f of this._targets)l(f,h);this._targets.length=0}}}const{Flags:Qs}=$i.Entity;class vs{constructor(){B(this,"startInvoker",new ul(h=>h.start()));B(this,"updateInvoker",new Fh((h,l)=>h.update(l)));B(this,"lastUpdateInvoker",new Fh((h,l)=>h.lastUpdate(l)))}start(){this.startInvoker.invoke(0)}update(h){this.updateInvoker.invoke(h)}lastUpdate(h){this.lastUpdateInvoker.invoke(h)}enableComponent(h,l){l?h.__getFlag(Qs.OnEnableCalled)===!1&&(h.__setFlag(Qs.OnEnableCalled),h.onEnable&&h.onEnable(),typeof h.start=="function"&&!h.__getFlag(Qs.IsStartCalled)&&(h.__setFlag(Qs.IsStartCalled),this.startInvoker.add(h)),typeof h.update=="function"&&this.updateInvoker.add(h),typeof h.lastUpdate=="function"&&this.lastUpdateInvoker.add(h)):h.__getFlag(Qs.OnEnableCalled)&&(h.__clearFlag(Qs.OnEnableCalled),h.onDisable&&h.onDisable(),typeof h.start=="function"&&!h.__getFlag(Qs.IsStartCalled)&&this.startInvoker.remove(h),typeof h.update=="function"&&this.updateInvoker.remove(h),typeof h.lastUpdate=="function"&&this.lastUpdateInvoker.remove(h))}}class ni extends $i.Entity{constructor(){super(...arguments);B(this,"_scheduler",new ve);B(this,"_componentScheduler",new vs)}get scheduler(){return this._scheduler}get componentScheduler(){return this._componentScheduler}update(l){this._scheduler.update(l),this._componentScheduler.start(),this._componentScheduler.update(l),this._componentScheduler.lastUpdate(l)}destroyNode(l){l.removeFromParent(),this.destroyComponents(l)}activeNode(l,f){l.visible=f,this.activeComponents(l)}destroyComponents(l){let f=this._getComponents(l);for(let v of f)v.destroy();l._components=[];for(let v of l.children)this.destroyComponents(v)}activeComponents(l){let f=l.visible;for(let v of this._getComponents(l))this._activeComponent(v,f);for(let v of l.children)this.activeComponents(v)}addComponent(l,f){let v=l instanceof mt.w?l.node:l,x=typeof f=="function",b=this._findComponent(v,x?f:f.constructor);if(b===void 0){b=x?new f:f,b.node=v,b.viewer=this;let P=b.__dependencies;if(P)for(let I of P)this.getComponent(v,I)==null&&this.addComponent(v,I);b.__getFlag($i.Entity.Flags.OnLoadCalled)===!1&&(b.__setFlag($i.Entity.Flags.OnLoadCalled),b.onInit&&b.onInit(),b.onLoad&&b.onLoad()),this._getComponents(v).push(b),this._activeComponent(b,b.enabled)}return b}removeComponent(l,f){let v=this._getComponents(l),x=v.indexOf(f);return x!=-1&&v.splice(x,1),this}getComponent(l,f){return this._findComponent(l,f)}getComponentsInChidren(l,f,v=[]){let x=this._getComponents(l);for(let b=x.length;b--;)x[b]instanceof f&&v.push(x[b]);for(let b of l.children)this.getComponentsInChidren(b,f,v);return v}_getComponents(l){let f=l._components;return f==null&&(f=l._components=[]),f}_findComponent(l,f){let v=this._getComponents(l);for(let x=v.length;x--;){let b=v[x];if(b instanceof f)return b}}_activeComponent(l,f){this._componentScheduler.enableComponent(l,f)}}var Mo;(function(S){S[S.NONE=1]="NONE",S[S.SELECTED=2]="SELECTED",S[S.IN=4]="IN"})(Mo||(Mo={}));class df{constructor(){B(this,"_raycaster",new d.iMs);B(this,"_connectors",[])}connect(h){let l=this._connectors.find(f=>f.target===h);l===void 0&&(l={target:h,state:Mo.NONE},this._connectors.push(l))}disconnect(h){let l=this._connectors.findIndex(f=>f.target===h);l!==-1&&this._connectors.splice(l,1)}pointerDown(h,l){if(this._connectors.length!==0){this._raycaster.setFromCamera(h,l);for(let f of this._connectors)if(f.target.has("click")||f.target.has("pointerdown")){let v=this._raycaster.intersectObject(f.target.node,!0);v.length&&(f.state|=Mo.SELECTED,f.target.emit("pointerdown",{intersects:v}))}}}pointerUp(h,l){if(this._connectors.length!==0){this._raycaster.setFromCamera(h,l);for(let f of this._connectors)if(f.target.has("click")||f.target.has("pointerup")){let v=this._raycaster.intersectObject(f.target.node,!0);v.length&&(f.state&Mo.SELECTED&&(f.state&=~Mo.SELECTED,f.target.emit("click",{intersects:v})),f.target.emit("pointerup",{intersects:v}))}}}pointerMove(h,l){if(this._connectors.length!==0){this._raycaster.setFromCamera(h,l);for(let f of this._connectors)if(f.target.has("pointerover")||f.target.has("pointerout")){let v=this._raycaster.intersectObject(f.target.node,!0);v.length?f.state&Mo.IN||(f.state|=Mo.IN,f.target.emit("pointerover",{intersects:v})):f.state&Mo.IN&&(f.state&=~Mo.IN,f.target.emit("pointerout",{intersects:v}))}}}}const Jn=class Jn{constructor(h){B(this,"viewer");B(this,"_listeners",[]);B(this,"_mouseWheel",0);B(this,"_touches",[]);B(this,"_touchCount",0);B(this,"_pointerButton",-1);B(this,"_pointerPosition",new d.FM8);B(this,"_pointer",new d.FM8);B(this,"_keys",{});B(this,"_pressability",new df);this.viewer=h}get pointerButton(){return this._pointerButton}get pointer(){return this._pointer}get pointerPosition(){return this._pointerPosition}get mouseWheel(){return this._mouseWheel}get touchCount(){return this._touchCount}get touches(){return this._touches}get keys(){return this._keys}addEventListeners(){const h=this.viewer.renderer.domElement;h.style.touchAction="none",this._addEventListener(h,"contextmenu",l=>l.preventDefault()),this._addEventListener(h,"pointerdown",l=>this._onPointerDown(l),{passive:!1}),this._addEventListener(h,"pointerup",l=>this._onPointerUp(l),{passive:!1}),this._addEventListener(h,"pointercancel",l=>this._onPointerUp(l),{passive:!1}),this._addEventListener(h,"pointerout",l=>this._onPointerUp(l),{passive:!1}),this._addEventListener(h,"pointermove",l=>this._onPointerMove(l),{passive:!0}),this._addEventListener(h,"wheel",l=>this._onMouseWheel(l),{passive:!1}),this._addEventListener(h,"touchstart",l=>this._onTouchStart(l),{passive:!0}),this._addEventListener(h,"touchend",l=>this._onTouchEnd(l),{passive:!0}),this._addEventListener(h,"touchmove",l=>this._onTouchMove(l),{passive:!0}),this._addEventListener(window,"keydown",l=>this._onKeyDown(l),{passive:!1}),this._addEventListener(window,"keypress",l=>this._onKeyPress(l),{passive:!1}),this._addEventListener(window,"keyup",l=>this._onKeyUp(l),{passive:!1})}connect(h,l){switch(l){case Jn.CLICK:case Jn.POINTER_DOWN:case Jn.POINTER_UP:case Jn.POINTER_OVER:case Jn.POINTER_OUT:this._pressability.connect(h);break}}disconnect(h){this._pressability.disconnect(h)}_addEventListener(h,l,f,v){h.addEventListener?h.addEventListener(l,f,v):h.on&&h.on(l,f,h),this._listeners.push({target:h,type:l,callback:f})}removeAllListeners(){for(let{target:h,type:l,callback:f}of this._listeners)h.removeEventListener?h.removeEventListener(l,f):h.off&&h.off(l,f,h);this._listeners=[]}_remapPointer(h){const l=this.viewer.width;return this.viewer.rootRotated?{button:h.button,buttons:h.buttons,clientX:h.clientY,clientY:l-h.clientX,offsetX:h.offsetY,offsetY:l-h.offsetX,pageX:h.pageY,pageY:l-h.pageX,screenX:h.screenY,screenY:l-h.screenX,movementX:h.movementY,movementY:h.movementX}:h}_remapTouch(h){const l=this.viewer.width;return this.viewer.rootRotated?{touches:Array.from(h.touches).map(f=>({identifier:f.identifier,clientX:f.clientY,clientY:l-f.clientX,pageX:f.pageY,pageY:l-f.pageX,screenX:f.screenY,screenY:l-f.screenX}))}:h}_computePointer(h){this._pointer.x=h.offsetX/this.viewer.width*2-1,this._pointer.y=1-h.offsetY/this.viewer.height*2,this._pointerPosition.set(h.offsetX,h.offsetY)}_onPointerDown(h){h.preventDefault(),h=this._remapPointer(h),this._pointerButton=h.button,this._computePointer(h),this._pressability.pointerDown(this._pointer,this.viewer.camera),this.viewer.emit(Jn.POINTER_DOWN,h)}_onPointerUp(h){h.preventDefault(),h=this._remapPointer(h),this._pointerButton=-1,this._computePointer(h),this._pressability.pointerUp(this._pointer,this.viewer.camera),this.viewer.emit(Jn.POINTER_UP,h)}_onPointerMove(h){h=this._remapPointer(h),this._computePointer(h),this._pressability.pointerMove(this._pointer,this.viewer.camera),this.viewer.emit(Jn.POINTER_MOVE,h)}_onMouseWheel(h){h.preventDefault(),this._mouseWheel=h.deltaY||h.wheelDelta,this.viewer.emit(Jn.MOUSE_WHEEL,h)}_onTouchStart(h){h=this._remapTouch(h),this.viewer.emit(Jn.TOUCH_START,h)}_onTouchEnd(h){h=this._remapTouch(h),this.viewer.emit(Jn.TOUCH_END,h)}_onTouchMove(h){h=this._remapTouch(h);let l=h.touches,f=this._touches;for(let v=l.length;v--;){f[v]==null&&(f[v]={id:-1,position:new d.FM8});const x=l[v];f[v].id=x.identifier,f[v].position.set(x.pageX,x.pageY)}this._touchCount=l.length,this.viewer.emit(Jn.TOUCH_MOVE,h)}_onKeyDown(h){this._keys[h.key]=!0,this.viewer.emit(Jn.KEYDOWN,h)}_onKeyPress(h){this._keys[h.key]=!0,this.viewer.emit(Jn.KEYPRESS,h)}_onKeyUp(h){this._keys[h.key]=!1,this.viewer.emit(Jn.KEYUP,h)}};B(Jn,"CLICK","click"),B(Jn,"MOUSE_WHEEL","mousewheel"),B(Jn,"TOUCH_START","touchstart"),B(Jn,"TOUCH_END","touchend"),B(Jn,"TOUCH_MOVE","touchmove"),B(Jn,"POINTER_DOWN","pointerdown"),B(Jn,"POINTER_UP","pointerup"),B(Jn,"POINTER_MOVE","pointermove"),B(Jn,"POINTER_OVER","pointerover"),B(Jn,"POINTER_OUT","pointerout"),B(Jn,"KEYDOWN","keydown"),B(Jn,"KEYPRESS","keypress"),B(Jn,"KEYUP","keyup"),B(Jn,"RESIZE","resize");let wr=Jn;var _n=r(622),_u=r(631);const{Tween:P0,getAll:R0,remove:D0,update:I0}=r(622),{TweenChain:L0}=r(631);class Tm{static Tween(h){return new P0(h)}static Timeline(h){return new L0(h)}static KillTweensOf(h){let l=R0();for(let f of l)f._object===h&&D0(f)}static TweenUpdate(h){I0(h)}}var Bh=r(992);class O0 extends Bh.S{update(h){Tm.TweenUpdate()}}const Cm=typeof window>"u";class F0{constructor(h){B(this,"userAgent");B(this,"isAndroidDevice");B(this,"iOSDevice");this.userAgent=h||(!Cm&&window.navigator?window.navigator.userAgent:""),this.isAndroidDevice=!/like android/i.test(this.userAgent)&&/android/i.test(this.userAgent),this.iOSDevice=this.match(1,/(iphone|ipod|ipad)/i).toLowerCase(),!Cm&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>2&&!window.MSStream&&(this.iOSDevice="ipad")}match(h,l){const f=this.userAgent.match(l);return f&&f.length>1&&f[h]||""}get isMobile(){return!this.isTablet&&(/[^-]mobi/i.test(this.userAgent)||this.iOSDevice==="iphone"||this.iOSDevice==="ipod"||this.isAndroidDevice||/nexus\s*[0-6]\s*/i.test(this.userAgent))}get isTablet(){return/tablet/i.test(this.userAgent)&&!/tablet pc/i.test(this.userAgent)||this.iOSDevice==="ipad"||this.isAndroidDevice&&!/[^-]mobi/i.test(this.userAgent)||!/nexus\s*[0-6]\s*/i.test(this.userAgent)&&/nexus\s*[0-9]+/i.test(this.userAgent)}get isDesktop(){return!this.isMobile&&!this.isTablet}get isMacOS(){return/macintosh/i.test(this.userAgent)&&{version:this.match(1,/mac os x (\d+(\.?_?\d+)+)/i).replace(/[_\s]/g,".").split(".").map(h=>h)[1]}}get isWindows(){return/windows /i.test(this.userAgent)&&{version:this.match(1,/Windows ((NT|XP)( \d\d?.\d)?)/i)}}get isiOS(){return!!this.iOSDevice&&{version:this.match(1,/os (\d+([_\s]\d+)*) like mac os x/i).replace(/[_\s]/g,".")||this.match(1,/version\/(\d+(\.\d+)?)/i)}}get isAndroid(){return this.isAndroidDevice&&{version:this.match(1,/android[ \/-](\d+(\.\d+)*)/i)}}get browser(){const h=this.match(1,/version\/(\d+(\.\d+)?)/i);return/opera/i.test(this.userAgent)?{name:"Opera",version:h||this.match(1,/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(this.userAgent)?{name:"Opera",version:this.match(1,/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||h}:/SamsungBrowser/i.test(this.userAgent)?{name:"Samsung Internet for Android",version:h||this.match(1,/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(this.userAgent)?{name:"Yandex Browser",version:h||this.match(1,/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(this.userAgent)?{name:"UC Browser",version:this.match(1,/(?:ucbrowser)[\s\/](\d+(\.\d+)?)/i)}:/msie|trident/i.test(this.userAgent)?{name:"Internet Explorer",version:this.match(1,/(?:msie |rv:)(\d+(\.\d+)?)/i)}:/(edge|edgios|edga|edg)/i.test(this.userAgent)?{name:"Microsoft Edge",version:this.match(2,/(edge|edgios|edga|edg)\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(this.userAgent)?{name:"Firefox",version:this.match(1,/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)}:/chromium/i.test(this.userAgent)?{name:"Chromium",version:this.match(1,/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||h}:/chrome|crios|crmo/i.test(this.userAgent)?{name:"Chrome",version:this.match(1,/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/safari|applewebkit/i.test(this.userAgent)?{name:"Safari",version:h}:{name:this.match(1,/^(.*)\/(.*) /),version:this.match(2,/^(.*)\/(.*) /)}}}const ys=new F0,kh=(navigator.userAgent||navigator.vendor).toLowerCase(),hl=typeof ys.browser=="boolean"?"":ys.browser.name,B0=document.createElement("audio");class qo{constructor(){B(this,"isMobile",ys.isMobile||ys.isTablet);B(this,"isDesktop",ys.isDesktop);B(this,"device",this.isMobile?"mobile":"desktop");B(this,"isAndroid",!!ys.isAndroid);B(this,"isIOS",!!ys.isiOS);B(this,"isMacOS",!!ys.isMacOS);B(this,"isWindows",typeof ys.isWindows=="boolean"?ys.isWindows:ys.isWindows.version!==null);B(this,"isLinux",kh.indexOf("linux")!=-1);B(this,"ua",kh);B(this,"isEdge",hl==="Microsoft Edge");B(this,"isIE",hl==="Internet Explorer");B(this,"isFirefox",hl==="Firefox");B(this,"isChrome",hl==="Chrome");B(this,"isOpera",hl==="Opera");B(this,"isSafari",hl==="Safari");B(this,"isSupportMSAA",!kh.match("version/15.4 "));B(this,"isSupportOgg",!!B0.canPlayType("audio/ogg"));B(this,"isRetina",window.devicePixelRatio&&window.devicePixelRatio>=1.5);B(this,"devicePixelRatio",window.devicePixelRatio||1);B(this,"cpuCoreCount",navigator.hardwareConcurrency||1);B(this,"baseUrl",document.location.origin);B(this,"isIFrame",window.self!==window.top)}}var Yt=r(41),Ca=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};const rc=`
varying vec2 vUv;

void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,ns=`
uniform sampler2D texFont;
varying vec2 vUv;

uniform vec4  diffuse;
uniform vec4  stroke;
uniform vec4  shadow;
uniform vec2  shadowOffset;
uniform float weight;

float median(in float r, in float g, in float b) {
    return max(min(r, g), min(max(r, g), b));
}

float signedDistance(in vec2 uv) {
    vec4 texel = texture2D(texFont, uv);
    return median(texel.r, texel.g, texel.b) - 0.5;
}

void main() {
    vec4 color = vec4(diffuse);
    float d = signedDistance(vUv) + weight;
    float w = fwidth(d);

    if (stroke.a > 0.0) {
        vec4 strokeColor = vec4(stroke.rgb, smoothstep(-w, w, d));
        color.a *= smoothstep(-w, w, d - stroke.a);
        color = mix(strokeColor, color, color.a);
    }
    else {
        color.a *= smoothstep(-w, w, d);
    }

    if (shadow.a > 0.0) {
        float dd = signedDistance(vUv + shadowOffset);
        vec4 shadowColor = vec4(shadow.rgb, smoothstep(-w - shadow.a, w + shadow.a, dd));
        color = mix(shadowColor, color, color.a);
    }

    gl_FragColor = color;
}
`;class is extends d.jyz{constructor(){super(...arguments);B(this,"vertexShader",rc);B(this,"fragmentShader",ns);B(this,"blending",d.bdR);B(this,"transparent",!0);B(this,"depthWrite",!1);B(this,"uniforms",{texFont:{value:null},diffuse:{value:Oi(1)},stroke:{value:Oi(0)},shadow:{value:Oi(0)},shadowOffset:{value:vt(-.001,.001)},weight:{value:.2}});B(this,"_strokeColor",Ie());B(this,"_shadowColor",Ie())}get color(){return this.uniforms.diffuse.value}set color(l){this.uniforms.diffuse.value=l}get weight(){return this.uniforms.weight.value}set weight(l){this.uniforms.weight.value=l}get strokeColor(){return gr(this.uniforms.stroke.value,this._strokeColor)}set strokeColor(l){Ei(l,this.uniforms.stroke.value)}get strokeWidth(){return this.uniforms.stroke.value.w}set strokeWidth(l){this.uniforms.stroke.value.w=l}get shadowBlur(){return this.uniforms.shadow.value.w}set shadowBlur(l){this.uniforms.shadow.value.w=l}get shadowColor(){return gr(this.uniforms.shadow.value,this._shadowColor)}set shadowColor(l){Ei(l,this.uniforms.shadow.value)}get shadowOffset(){return this.uniforms.shadowOffset.value}set shadowOffset(l){this.uniforms.shadowOffset.value=l}get texFont(){return this.uniforms.texFont.value}}Ca([(0,Yt.Cb)({type:"Color"})],is.prototype,"color",null),Ca([(0,Yt.Cb)({min:0,max:1,step:.01})],is.prototype,"weight",null),Ca([(0,Yt.Cb)({dir:"stroke"})],is.prototype,"strokeColor",null),Ca([(0,Yt.Cb)({min:0,max:1,step:.01,dir:"stroke"})],is.prototype,"strokeWidth",null),Ca([(0,Yt.Cb)({min:0,max:1,step:.01,dir:"shadow"})],is.prototype,"shadowBlur",null),Ca([(0,Yt.Cb)({dir:"shadow"})],is.prototype,"shadowColor",null),Ca([(0,Yt.Cb)({dir:"shadow"})],is.prototype,"shadowOffset",null),Ca([(0,Yt.Cb)()],is.prototype,"texFont",null);class Gw{constructor(h,l){B(this,"font");B(this,"texture");B(this,"material",null);this.font=h,this.texture=l,this.material=new is,this.material.uniforms.texFont.value=l}build(h,l){const f=this.font,v=f.common.scaleW,x=f.common.scaleH,b=h.glyphs.filter(H=>H.data.width*H.data.height>0),P=l.flipY!==!1,I=new Float32Array(b.length*8),z=new Float32Array(b.length*8),Q=new Uint16Array(b.length*6);for(let H=0,ee=0,fe=0,Se=0,De=0;De<b.length;De++,H+=4){const Re=b[De],Te=Re.data;let Oe=Re.position[0]+Te.xoffset,Ae=Re.position[1]+Te.yoffset,ke=Te.width,lt=Te.height;I[ee++]=Oe,I[ee++]=Ae,I[ee++]=Oe+ke,I[ee++]=Ae,I[ee++]=Oe+ke,I[ee++]=Ae+lt,I[ee++]=Oe,I[ee++]=Ae+lt;let wt=Te.x+Te.width,xt=Te.y+Te.height,Ft=Te.x/v,Rt=Te.y/x,on=wt/v,Nt=xt/x;P&&(Rt=1-Rt,Nt=1-Nt),z[fe++]=Ft,z[fe++]=Rt,z[fe++]=on,z[fe++]=Rt,z[fe++]=on,z[fe++]=Nt,z[fe++]=Ft,z[fe++]=Nt,Q[Se++]=H+0,Q[Se++]=H+1,Q[Se++]=H+2,Q[Se++]=H+0,Q[Se++]=H+2,Q[Se++]=H+3}return{position:I,uv:z,indice:Q}}}class k0 extends tn{constructor(){super(...arguments);B(this,"extensions",["fnt"])}load({url:l,onLoad:f,onProgress:v,onError:x,texSettings:b}){(async()=>{try{let P=await this.viewer.loadAsset({url:l,selExt:"json"}),I=await this.viewer.loadAsset({url:`${es(l)}/${P.pages[0]}`,onProgress:v});f(new Gw(P,Object.assign(I,b)))}catch(P){x(P)}})()}}class Pm{constructor(h,l=""){B(this,"excute");B(this,"name");this.excute=h,this.name=l}}class Rm extends ie.v{constructor(l,f,v){super();B(this,"onComplete");B(this,"onProgress");B(this,"onError");B(this,"_tasks",[]);B(this,"_taskIndex",0);B(this,"_percent",0);this.onComplete=l,this.onProgress=f,this.onError=v}get percent(){return this._percent}add(l){this._tasks.push(l)}update(){let l=this._tasks[this._taskIndex];if(l){try{l.excute()}catch(f){console.error(f),this.onError&&this.onError(l)}this._percent=++this._taskIndex/this._tasks.length,this.onProgress&&this.onProgress(l,this._taskIndex,this._tasks.length),this._taskIndex===this._tasks.length&&(this._percent=1,this.onComplete&&this.onComplete())}}}const ff=`
varying vec2      vUv;
uniform sampler2D tMain;
uniform float     uLod;

void main() {
    gl_FragColor = texture(tMain, vUv, uLod);
	#include <encodings_fragment>
}
`,Dm=`
varying vec2 vUv;
void main() {
	vUv = position.xy * 0.5 + 0.5;
	gl_Position = vec4(position.xy, 1.0, 1.0);
}
`;class U0{constructor(){B(this,"copyMaterial",new d.jyz({vertexShader:Dm,fragmentShader:ff,blending:d.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,uniforms:{tMain:{value:null},uLod:{value:0}}}));B(this,"fullscreenMesh",new d.Kj0(Xo(),this.copyMaterial));B(this,"fullscreenCamera",new d.iKG(-1,1,1,-1,0,1))}}const xu=new U0;function Im(S,h,l,f,v){xu.fullscreenMesh.material=l;const x=S.getRenderTarget();S.setRenderTarget(h,v,f),S.render(xu.fullscreenMesh,xu.fullscreenCamera),S.setRenderTarget(x)}function Uh(S,h){if(Array.isArray(h))for(let l of h)S.initTexture(l);else S.initTexture(h)}function Nh(S,h,l,f){xu.fullscreenMesh.material=f,S.compile(xu.fullscreenMesh,l,h)}function pf(S,h,l,f){S.compile(f,l,h)}let mf=new d.Pa4,Lm=new d.Pa4,N0=new d.FM8;function gf(S,h=[]){return typeof S=="function"?new S(...h):S}const Sc=class Sc extends ni{constructor({root:l,canvas:f=document.getElementById("canvas"),shadows:v=!1,depth:x=!1,outputEncoding:b=d.knz,toneMapping:P=d.EoG,toneMappingExposure:I=1,camera:z={fov:45,near:1,far:1e3,position:Sn(0,0,4)},autoStart:Q=!0,autoResize:H=!0,floatPacking:ee=!1,maxDPR:fe=1.5,orientation:Se=ce.AUTO,dracoPath:De,targetFrameRate:Re,loader:Te={},tasker:Oe={},...Ae}={}){super();B(this,"_width",0);B(this,"_height",0);B(this,"_running",!1);B(this,"_renderer");B(this,"_root");B(this,"_canvas");B(this,"_context");B(this,"_loadingManager");B(this,"_taskManager");B(this,"_scene");B(this,"_camera");B(this,"_viewport",{width:1,height:1,factor:1});B(this,"_input",new wr(this));B(this,"_caches",new Map);B(this,"_loaders",new Map);B(this,"_brower",new qo);B(this,"_autoResize",!0);B(this,"_floatPacking",!1);B(this,"_targetFrameRate",null);B(this,"_orientation",ce.AUTO);B(this,"_dracoPath","https://www.gstatic.com/draco/versioned/decoders/1.5.5/");B(this,"_RENDER_TARGET_FLOAT_TYPE",d.cLu);B(this,"_DATA_FLOAT_TYPE",d.VzW);B(this,"_rootRotated",!1);B(this,"_maxDPR",1.5);B(this,"_time",0);B(this,"_lastTime",0);let ke={alpha:!1,depth:!0,stencil:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},lt=this._getContext(f,Object.assign(ke,Ae));if(lt===null){console.error("Unsupport WebGL in current platform");return}this._root=l||f,this._canvas=f,this._context=lt,this._scene=new d.xsS,this._camera=Ge(new d.cPb(z.fov,z.aspect||f.width/f.height,z.near,z.far),z),this._renderer=new d.CP7({canvas:f,context:lt}),this._renderer.setPixelRatio(this.dpr),this._renderer.outputEncoding=b,this._renderer.toneMapping=P,this._renderer.toneMappingExposure=I,this._renderer.shadowMap.enabled=!!v,this._renderer.shadowMap.type=typeof v=="boolean"?d.ntZ:v,this._renderer.info.autoReset=!1,this._autoResize=H,this._orientation=Se,this._maxDPR=this._maxDPR,this._loadingManager=new d.lLk(Te.onLoad,Te.onProgress,Te.onError),this._taskManager=new Rm(Oe.onComplete,Oe.onProgress,Oe.onError),this._input.addEventListeners(),this._setColorSpace(),this._addDefaultPlugins(),this._addDefaultLoaders(),De&&(this._dracoPath=De),Re&&(this.targetFrameRate=Re),Q&&this.start(),this.printInfo()}get width(){return this._width}get height(){return this._height}get rootRotated(){return this._rootRotated}get orientation(){return this._orientation}get dracoPath(){return this._dracoPath}get targetFrameRate(){return this._targetFrameRate}set targetFrameRate(l){if(l<=0)throw Error("targetFrameRate must be greater than 0, or undefined.");this._targetFrameRate=l}get RENDER_TARGET_FLOAT_TYPE(){return this._RENDER_TARGET_FLOAT_TYPE}get DATA_FLOAT_TYPE(){return this._DATA_FLOAT_TYPE}get floatPacking(){return this._floatPacking}get canvas(){return this._canvas}get context(){return this._context}get brower(){return this._brower}get autoResize(){return this._autoResize}get environment(){return this._scene.userData.environment}get background(){return this._scene.userData.background}get input(){return this._input}get time(){return this._time}get renderer(){return this._renderer}get scene(){return this._scene}get camera(){return this._camera}get dpr(){return Math.min(this._maxDPR,window.devicePixelRatio)}get viewport(){return this._viewport}get size(){return this._renderer.getSize(N0)}get colorSpace(){return d.epp.enabled?d.epp.workingColorSpace:"srgb"}get dom(){return this._renderer.domElement}get loadingManager(){return this._loadingManager}printInfo(){const l=this._renderer.getContext();console.log(["Welcome to xviewer.js","Three Version: "+d.UZH,"WebGL Version: "+l.getParameter(l.VERSION),"ColorSpace: "+this.colorSpace].join(`
`))}_getContext(l,f){const v=this._brower;if(!((v.isChrome||v.isSafari||v.isEdge||v.isFirefox||v.isOpera)&&!v.isIE))return console.error("Unsupport platform"),null;if(!(l instanceof HTMLCanvasElement))return console.error("Canvas is null"),null;if(window.WebGL2RenderingContext)try{let b=l.getContext("webgl2",f);return this._RENDER_TARGET_FLOAT_TYPE=d.cLu,this._DATA_FLOAT_TYPE=d.VzW,b}catch(b){return console.error(b),null}else if(window.WebGLRenderingContext){let b=l.getContext("webgl",f)||l.getContext("webgl2",f)||l.getContext("experimental-webgl",f);return(b.getExtension("OES_texture_float")||b.getExtension("OES_texture_half_float"))&&b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(this._RENDER_TARGET_FLOAT_TYPE=this._brower.isIOS||b.getExtension("OES_texture_half_float")?d.cLu:d.VzW,this._DATA_FLOAT_TYPE=d.VzW,b):this._floatPacking?(this._RENDER_TARGET_FLOAT_TYPE=this._DATA_FLOAT_TYPE=d.ywz,b):(console.log("Unspport float type in current platform"),null)}return null}_setColorSpace(){d.epp.enabled=this.renderer.outputEncoding===d.knz}_addDefaultPlugins(){this.addPlugin(O0)}_addDefaultLoaders(){this.addLoader(vr),this.addLoader(ru),this.addLoader(hu),this.addLoader(he),this.addLoader(yu),this.addLoader(Vr),this.addLoader(le),this.addLoader(Oh),this.addLoader(k0),this.addLoader(hf)}_onPreDestroy(){this._caches.clear(),this._renderer.dispose(),this._input.removeAllListeners(),this.destroyComponents(this._scene),this.stop()}async load({url:l,settings:f,clear:v=!1,castShadow:x=!1,receiveShadow:b=!1,parent:P=this._scene,onProgress:I,...z}){const Q=await this.loadAsset({url:l,onProgress:I,...z});return(x||b)&&Q.meshData.meshes.forEach(H=>{H.castShadow=x,H.receiveShadow=b}),v&&P.clear(),this.addNode(Q,z),Q}loadAsset({url:l,selExt:f,onProgress:v,...x}){return new Promise((b,P)=>{const{url:I,file:z,ext:Q}=gs(l),H=nl(x),ee=vo(I,H);let fe=this._caches.get(ee);if(fe)b(fe);else{const Se=Re=>{this._caches.set(ee,Re),b(Re)};let De=f||Q;this._loaders.has(De)?this._loaders.get(De).load({url:I,file:z,texSettings:H,onProgress:v,onLoad:Se,onError:P}):P("missing loader for "+Q)}})}addLoader(l){let f=new l(this);for(let v of f.extensions)this._loaders.set(v,f);return this}async setEnvironment(l={}){let f=l.url??null;this._scene.userData.environment!==f&&(this._scene.userData.environment=f,this._scene.environment=f?await this.loadAsset(Object.assign({mapping:d.dSO},l)):null),l&&l.noBackground||this.setBackground(l)}async setBackground(l){let f=l.color||l.url||null;this._scene.userData.background!==f&&(this._scene.userData.background=f,this._scene.background=f?l.color||await this.loadAsset(Object.assign({mapping:d.dSO},l)):null)}portal(l){const f=this._scene,v=this._camera;this._scene=new d.xsS;const x=l();return this._scene=f,this._camera=v,x}addNode(l,{scale:f,position:v,rotation:x,debug:b,shadowArgs:P,makeDefault:I,args:z,parent:Q=this._scene,components:H=[],...ee}={}){let fe,Se=gf(l,z);if(Se.isObject3D){fe=Se,Q.add(Se);for(let De of H)this.addComponent(fe,De.ins),Ge(De.ins,De.props)}else if(Se.isComponent)fe=Se.node||new d.Tme,Q.add(fe),this.addComponent(fe,Se);else throw Error("unsuport object");return Ge(Se,ee,!0),Ge(fe,{scale:f,position:v,rotation:x}),Se.isCamera&&I&&(Se.manual=Se.aspect!==this.camera.aspect,this._camera=Se),P&&fe.isDirectionalLight&&q(fe.shadow,P),b&&(fe.userData.debug=b),Se}addTask(l,f){this._taskManager.add(new Pm(l,f))}addPlugin(l,{args:f,...v}={}){let x=gf(l,f);return this.addComponent(this._scene,x),Ge(x,v),x}getPlugin(l){return this.getComponent(this._scene,l)}requirePlugin(l){let f=this.getPlugin(l);return f===void 0&&(f=this.addPlugin(l)),f}component(l,{args:f,...v}={}){return{ins:gf(l,f),props:v}}resize(l=window.innerWidth,f=window.innerHeight){if(this._rootRotated=this._orientation===ce.LANDSCAPE?l<f:this._orientation===ce.PORTRAIT?l>f:!1,this._rootRotated){let v=l;l=f,f=v}if(this._width!==l||this._height!==f){this._width=l,this._height=f;let v=this._root;this._rootRotated?(v.style["-webkit-transform"]="rotate(90deg)",v.style.transform="rotate(90deg)",v.style["-webkit-transform-origin"]="0px 0px 0px",v.style.transformOrigin="0px 0px 0px",v.style.margin=`0 0 0 ${f}px`,v.style.width=`${l}px`,v.style.height=`${f}px`):(v.style["-webkit-transform"]="rotate(0deg)",v.style.transform="rotate(0deg)",v.style.margin="0px auto",v.style.width=`${l}px`,v.style.height=`${f}px`);let x=this._camera;if(x.isOrthographicCamera)this._viewport={width:l/x.zoom,height:f/x.zoom,factor:1};else if(x.isPerspectiveCamera){x.manual||(x.aspect=l/f,x.updateProjectionMatrix());let b=x.getWorldPosition(Lm).distanceTo(mf),P=2*Math.tan(d.MathUtils.degToRad(x.fov*.5))*b,I=P*l/f;this._viewport={width:I,height:P,factor:l/I}}this.resizeCallback(l,f),this.emit(wr.RESIZE,l,f)}}render(l){this._renderer.info.reset(),this.renderCallback(l)}resizeCallback(l,f){this._renderer.setSize(l,f)}renderCallback(l){this._renderer.render(this._scene,this._camera)}loop(l){this._autoResize&&this.resize(),l=Math.min(l,.067),this.update(l),this.emit(Sc.RENDER_BEFORE),this.render(l),this.emit(Sc.RENDER_AFTER)}_frame(l){if(this._time=l,this._taskManager.update(),ms(this._targetFrameRate)){const f=1/this._targetFrameRate,v=l-this._lastTime;v>=f&&(this.loop(v),this._lastTime=l-v%f)}else this.loop(l-this._lastTime),this._lastTime=l}start(){if(this._running==!1){this._running=!0;const l=f=>{this._running&&(this._frame(f*.001),requestAnimationFrame(l))};requestAnimationFrame(l)}return this}stop(){return this._running=!1,this._time=this._lastTime=0,this}compile(l){if(Array.isArray(l))if(l.every(f=>f.isMaterial))Nh(this._renderer,this._scene,this._camera,l);else throw Error("unsuport material");else typeof l=="object"?l.isMaterial?Nh(this._renderer,this._scene,this._camera,l):l.isObject3D?(l.meshData.materials&&Nh(this._renderer,this._scene,this._camera,Object.values(l.meshData.materials)),l.meshData.textures&&Uh(this._renderer,Object.values(l.meshData.textures)),l.meshData.meshes||pf(this._renderer,this._scene,this._camera,l)):l.isTexture&&Uh(this._renderer,l):pf(this._renderer,this._scene,this._camera,this._scene)}createRenderTarget(l,f,v=!1,x=!1,b=0,P=!1){return new d.dd2(l,f,{wrapS:d.uWy,wrapT:d.uWy,magFilter:v?d.TyD:d.wem,minFilter:v?d.TyD:P?d.FDw:d.wem,type:typeof x=="boolean"?x?this.DATA_FLOAT_TYPE:d.ywz:x,anisotropy:0,encoding:d.rnI,depthBuffer:!1,stencilBuffer:!1,samples:this._brower.isSupportMSAA?b:0,generateMipmaps:P})}createCubeRenderTarget(l,f=!1,v=!1,x=0,b=!1){return new d.oAp(l,{wrapS:d.uWy,wrapT:d.uWy,magFilter:f?d.TyD:d.wem,minFilter:f?d.TyD:b?d.FDw:d.wem,type:typeof v=="boolean"?v?this.DATA_FLOAT_TYPE:d.ywz:v,anisotropy:0,encoding:d.rnI,depthBuffer:!1,stencilBuffer:!1,samples:this._brower.isSupportMSAA?x:0,generateMipmaps:b})}createDataTexture(l,f,v,x=!1,b=!0){return new d.IEO(l,f,v,d.wk1,x?d.VzW:d.ywz,d.xfE,d.uWy,d.uWy,b?d.TyD:d.wem,b?d.TyD:d.wem,0)}};B(Sc,"RENDER_BEFORE","renderbefore"),B(Sc,"RENDER_AFTER","renderafter"),B(Sc,"ATTACH_HELPER","attachhelper");let zh=Sc;var vf;(function(S){S[S.Linear=0]="Linear",S[S.QuadraticIn=1]="QuadraticIn",S[S.QuadraticOut=2]="QuadraticOut",S[S.QuadraticInOut=3]="QuadraticInOut",S[S.CubicIn=4]="CubicIn",S[S.CubicOut=5]="CubicOut",S[S.CubicInOut=6]="CubicInOut",S[S.QuarticIn=7]="QuarticIn",S[S.QuarticOut=8]="QuarticOut",S[S.QuarticInOut=9]="QuarticInOut",S[S.QuinticIn=10]="QuinticIn",S[S.QuinticOut=11]="QuinticOut",S[S.QuinticInOut=12]="QuinticInOut",S[S.SinusoidalIn=13]="SinusoidalIn",S[S.SinusoidalOut=14]="SinusoidalOut",S[S.SinusoidalInOut=15]="SinusoidalInOut",S[S.ExponentialIn=16]="ExponentialIn",S[S.ExponentialOut=17]="ExponentialOut",S[S.ExponentialInOut=18]="ExponentialInOut",S[S.CircularIn=19]="CircularIn",S[S.CircularOut=20]="CircularOut",S[S.CircularInOut=21]="CircularInOut",S[S.ElasticIn=22]="ElasticIn",S[S.ElasticOut=23]="ElasticOut",S[S.ElasticInOut=24]="ElasticInOut",S[S.BackIn=25]="BackIn",S[S.BackOut=26]="BackOut",S[S.BackInOut=27]="BackInOut",S[S.BounceIn=28]="BounceIn",S[S.BounceOut=29]="BounceOut",S[S.BounceInOut=30]="BounceInOut"})(vf||(vf={}));const z0=[_n.Easing.Linear.None,_n.Easing.Quadratic.In,_n.Easing.Quadratic.Out,_n.Easing.Quadratic.InOut,_n.Easing.Cubic.In,_n.Easing.Cubic.Out,_n.Easing.Cubic.InOut,_n.Easing.Quintic.In,_n.Easing.Quadratic.Out,_n.Easing.Quadratic.InOut,_n.Easing.Quintic.In,_n.Easing.Quintic.Out,_n.Easing.Quintic.InOut,_n.Easing.Sinusoidal.In,_n.Easing.Sinusoidal.Out,_n.Easing.Sinusoidal.InOut,_n.Easing.Exponential.In,_n.Easing.Exponential.Out,_n.Easing.Exponential.InOut,_n.Easing.Circular.In,_n.Easing.Circular.Out,_n.Easing.Circular.InOut,_n.Easing.Elastic.In,_n.Easing.Elastic.Out,_n.Easing.Elastic.InOut,_n.Easing.Back.In,_n.Easing.Back.Out,_n.Easing.Back.InOut,_n.Easing.Bounce.In,_n.Easing.Bounce.Out,_n.Easing.Bounce.InOut];class it{constructor(){B(this,"style",vf.QuadraticInOut);B(this,"time",4)}}const{clamp:Ar,lerp:bu}=d.MathUtils;class Gh extends mt.w{constructor(){super(...arguments);B(this,"_vcam",null);B(this,"_vcamSolo",null);B(this,"_vcams",[]);B(this,"_lerpTime",0);B(this,"brainBlend",new it)}get vcam(){return this._vcam}get vcams(){return this._vcams}update(l){let f=this.getActiveCamera();if(f!=null){for(let v of this._vcams)v.enabled=v===f;if(this._lerpTime<this.brainBlend.time){this._lerpTime+=l;let v=Ar(this._lerpTime/this.brainBlend.time,0,1),x=z0[this.brainBlend.style];x&&(v=x(v)),this._lerpToMainCamera(f,v)}else this._lerpToMainCamera(f,1)}}activeCamera(l,f=4){this._vcamSolo!==l&&(this._vcamSolo=l,this._lerpTime=0,this.brainBlend.time=f)}addCamera(l){this._vcams.indexOf(l)===-1&&this._vcams.push(l)}removeCamera(l){let f=this._vcams.indexOf(l);f!==-1&&this._vcams.splice(f,1)}getActiveCamera(){return this._vcamSolo||this._vcams.filter(l=>l.enabled).sort((l,f)=>f.priority-l.priority)[0]}_lerpToMainCamera(l,f){let v=this.viewer.camera,x=l;v.position.lerp(x.finalPosition,f),v.quaternion.slerp(x.finalRotation,f),v.fov=bu(v.fov,x.fov,f),v.near=bu(v.near,x.near,f),v.far=bu(v.far,x.far,f),(v.fov!=x.fov||v.near!=x.near||v.far!=x.far)&&v.updateProjectionMatrix()}}class Om extends mt.w{constructor(){super(...arguments);B(this,"_finalPosition",new d.Pa4);B(this,"_finalRotation",new d._fP);B(this,"priority",10);B(this,"lookAt",null);B(this,"follow",null);B(this,"fov",45);B(this,"near",.1);B(this,"far",1e3);B(this,"correctPosition",new d.Pa4);B(this,"correctRotation",new d._fP);B(this,"lookaheadPosition",new d.Pa4);B(this,"trackedObjectOffset",new d.Pa4);B(this,"brain")}get finalPosition(){return this._finalPosition.copy(this.node.position).add(this.correctPosition)}get finalRotation(){return this._finalRotation.copy(this.node.quaternion).multiply(this.correctRotation)}onLoad(){this.node.isCamera=!0,this.brain=this.viewer.getComponent(this.viewer.camera,Gh),this.brain.addCamera(this)}onDestroy(){this.brain.removeCamera(this)}update(l){this.lookAt&&this.node.lookAt(this.lookAt.position)}}const{clamp:Eo,degToRad:wu,quarticDamp:Pa}=d.MathUtils,{abs:Ra,tan:G0}=Math;let Ks=new d.FM8,qs=new d.FM8,H0=new d.FM8,V0=new d.FM8,Hh=new d.FM8,To=new d.Pa4,ai=new d.Pa4,dl=new d.Pa4,Vh=new d.Pa4,Da=new d.Pa4,Au=new d._fP,rs=new d.$V;var ri;(function(S){S[S.FREE=0]="FREE",S[S.TRANSLATE=1]="TRANSLATE"})(ri||(ri={}));class Zn extends Om{constructor(){super(...arguments);B(this,"_button",-1);B(this,"_touchID",-1);B(this,"_distanceDelta",0);B(this,"_preLoc0",new d.FM8);B(this,"_preLoc1",new d.FM8);B(this,"_rotateDelta",new d.FM8);B(this,"_panDelta",new d.FM8);B(this,"mode",ri.FREE);B(this,"forbidX",!1);B(this,"forbidY",!1);B(this,"forbidZ",!1);B(this,"forbidPanX",!1);B(this,"forbidPanY",!1);B(this,"rotateSpeed",2);B(this,"rotateSmoothing",.5);B(this,"panSpeed",2);B(this,"panSmoothing",.5);B(this,"phiMin",.001);B(this,"phiMax",Math.PI-.001);B(this,"thetaMin",-1/0);B(this,"thetaMax",1/0);B(this,"distanceMin",.001);B(this,"distanceMax",1/0);B(this,"rotateTouchID",0)}onEnable(){this.viewer.on(wr.POINTER_DOWN,this._onPointerDown,this),this.viewer.on(wr.POINTER_UP,this._onPointerUp,this),this.viewer.on(wr.POINTER_MOVE,this._onPointerMove,this),this.viewer.on(wr.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.on(wr.TOUCH_START,this._onTouchStart,this),this.viewer.on(wr.TOUCH_MOVE,this._onTouchMove,this),this.reset()}onDisable(){this.viewer.off(wr.POINTER_DOWN,this._onPointerDown,this),this.viewer.off(wr.POINTER_UP,this._onPointerUp,this),this.viewer.off(wr.POINTER_MOVE,this._onPointerMove,this),this.viewer.off(wr.MOUSE_WHEEL,this._onMouseWheel,this),this.viewer.off(wr.TOUCH_START,this._onTouchStart,this),this.viewer.off(wr.TOUCH_MOVE,this._onTouchMove,this)}reset(){this._button=-1,this._touchID=-1,this._rotateDelta.set(0,0),this._panDelta.set(0,0),this._distanceDelta=0}_onPointerDown(l){this.viewer.brower.isMobile||(this._button=l.button,this._preLoc0.set(l.pageX,l.pageY))}_onPointerUp(l){this.viewer.brower.isMobile||(this._button=-1)}_onPointerMove(l){if(!this.viewer.brower.isMobile){switch(Ks.set(l.pageX,l.pageY),this._button){case 0:this._rotateDelta.add(this._calculateRotateDelta(Hh,this._preLoc0,Ks));break;case 1:this._panDelta.add(this._calculatePanDelta(Hh,this._preLoc0,Ks));break}this._preLoc0.copy(Ks)}}_onMouseWheel(l){if(this.lookAt){let f=To.copy(this.lookAt.position).add(this.trackedObjectOffset).distanceTo(this.node.position),v=f+this._distanceDelta;l.deltaY>0?v*=this._calculateDistanceScale(1/.85):l.deltaY<0&&(v*=this._calculateDistanceScale(.85)),this._distanceDelta=v-f}}_onTouchStart(l){if(!this.viewer.brower.isMobile)return;let f=l.touches,v=this.rotateTouchID;f.length>v+1?(this._preLoc0.set(f[v].pageX,f[v].pageY),this._preLoc1.set(f[v+1].pageX,f[v+1].pageY)):f.length>v&&(this._touchID=f[v].identifier,this._preLoc0.set(f[v].pageX,f[v].pageY))}_onTouchMove(l){if(!this.viewer.brower.isMobile)return;let f=l.touches,v=this.rotateTouchID;if(f.length>v+1){if(Ks.set(f[v].pageX,f[v].pageY),qs.set(f[v+1].pageX,f[v+1].pageY),this.lookAt){let x=To.copy(this.lookAt.position).add(this.trackedObjectOffset).distanceTo(this.node.position),b=(x+this._distanceDelta)*this._calculateDistanceScale(this._preLoc0.distanceTo(this._preLoc1)/Ks.distanceTo(qs));this._distanceDelta=b-x}this._panDelta.add(this._calculatePanDelta(Hh,V0.copy(this._preLoc0).add(this._preLoc1).multiplyScalar(.5),H0.copy(Ks).add(qs).multiplyScalar(.5))),this._preLoc0.copy(Ks),this._preLoc1.copy(qs)}else f.length>v&&this._touchID===f[v].identifier&&(Ks.set(f[v].pageX,f[v].pageY),this._rotateDelta.add(this._calculateRotateDelta(Hh,this._preLoc0,Ks)),this._preLoc0.copy(Ks))}_calculateDistanceScale(l){return this.forbidZ&&(l=1),l}_calculateRotateDelta(l,f,v){let x=this.viewer.renderer.domElement;return l.copy(v).sub(f).multiplyScalar(this.rotateSpeed*2*Math.PI/x.height),l.y=-l.y,this.forbidX&&(l.x=0),this.forbidY&&(l.y=0),l}_calculatePanDelta(l,f,v){let x=this.viewer.renderer.domElement;return l.copy(v).sub(f).multiplyScalar(this.panSpeed/x.height),this.forbidPanX&&(l.x=0),this.forbidPanY&&(l.y=0),l}update(l){if(this.lookAt){switch(To.copy(this.lookAt.position).add(this.trackedObjectOffset),this.mode){case ri.FREE:if(Ra(this._rotateDelta.x)+Ra(this._rotateDelta.y)+Ra(this._distanceDelta)>.001){Au.setFromUnitVectors(this.node.up,d.Tme.DEFAULT_UP),ai.copy(this.node.position).sub(To),ai.applyQuaternion(Au),rs.setFromVector3(ai);let f=Pa(1,0,this.rotateSmoothing,l);this._rotateDelta.x=rs.theta-Eo(rs.theta-this._rotateDelta.x,this.thetaMin,this.thetaMax),rs.theta=rs.theta-this._rotateDelta.x*(1-f),this._rotateDelta.y=Eo(rs.phi+this._rotateDelta.y,this.phiMin,this.phiMax)-rs.phi,rs.phi=Eo(rs.phi+this._rotateDelta.y*(1-f),.001,Math.PI-.001),this._distanceDelta=Eo(rs.radius+this._distanceDelta,this.distanceMin,this.distanceMax)-rs.radius,rs.radius=rs.radius+this._distanceDelta*(1-f),this._rotateDelta.multiplyScalar(f),this._distanceDelta*=f,ai.setFromSpherical(rs),ai.applyQuaternion(Au.invert()),this.node.position.copy(ai.add(To))}break;case ri.TRANSLATE:if(Ra(this._distanceDelta)>.001){ai.copy(this.node.position).sub(this.lookAt.position);let f=Pa(1,0,this.rotateSmoothing,l),v=ai.length();this._distanceDelta=Eo(v+this._distanceDelta,this.distanceMin,this.distanceMax)-v;let x=v+this._distanceDelta*(1-f);this._distanceDelta*=f;let b=ai.normalize().multiplyScalar(x).add(this.lookAt.position);dl.copy(b).sub(this.node.position),this.trackedObjectOffset.add(dl),this.node.position.copy(b),To.copy(this.lookAt.position).add(this.trackedObjectOffset)}break}switch(this.mode){case ri.FREE:case ri.TRANSLATE:{if(Ra(this._panDelta.x)+Ra(this._panDelta.y)>.001){ai.copy(this.node.position).sub(To),Vh.setFromMatrixColumn(this.node.matrix,0),Da.setFromMatrixColumn(this.node.matrix,1);let f=ai.length()*2*G0(wu(this.fov*.5)),v=Pa(1,0,this.panSmoothing,l),x=this.trackedObjectOffset;x.sub(Vh.multiplyScalar(this._panDelta.x*f*(1-v))),x.add(Da.multiplyScalar(this._panDelta.y*f*(1-v))),this._panDelta.multiplyScalar(v),To.copy(this.lookAt.position).add(x),this.node.position.copy(ai.add(To))}this.node.lookAt(To);break}}}}}class Ls extends d.jyz{constructor(l=new d.FM8){super({uniforms:{inputBuffer:new d.xWb(null),depthBuffer:new d.xWb(null),resolution:new d.xWb(new d.FM8),texelSize:new d.xWb(new d.FM8),halfTexelSize:new d.xWb(new d.FM8),kernel:new d.xWb(0),scale:new d.xWb(1),cameraNear:new d.xWb(0),cameraFar:new d.xWb(1),minDepthThreshold:new d.xWb(0),maxDepthThreshold:new d.xWb(1),depthScale:new d.xWb(0),depthToBlurRatioBias:new d.xWb(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <encodings_fragment>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:d.jFi,depthWrite:!1,depthTest:!1});B(this,"kernel");this.toneMapped=!1,this.setTexelSize(l.x,l.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(l,f){this.uniforms.texelSize.value.set(l,f),this.uniforms.halfTexelSize.value.set(l,f).multiplyScalar(.5)}setResolution(l){this.uniforms.resolution.value.copy(l)}}class Su{constructor({resolution:h,width:l=500,height:f=500,minDepthThreshold:v=0,maxDepthThreshold:x=1,depthScale:b=0,depthToBlurRatioBias:P=.25}){B(this,"renderTargetA");B(this,"renderTargetB");B(this,"convolutionMaterial");B(this,"scene");B(this,"camera");B(this,"screen");B(this,"renderToScreen",!1);this.renderTargetA=new d.dd2(h,h,{minFilter:d.wem,magFilter:d.wem,stencilBuffer:!1,depthBuffer:!1,type:d.cLu}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Ls,this.convolutionMaterial.setTexelSize(1/l,1/f),this.convolutionMaterial.setResolution(new d.FM8(l,f)),this.scene=new d.xsS,this.camera=new d.V1s,this.convolutionMaterial.uniforms.minDepthThreshold.value=v,this.convolutionMaterial.uniforms.maxDepthThreshold.value=x,this.convolutionMaterial.uniforms.depthScale.value=b,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=P,this.convolutionMaterial.defines.USE_DEPTH=b>0;const I=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),z=new Float32Array([0,0,2,0,0,2]),Q=new d.u9r;Q.setAttribute("position",new d.TlE(I,3)),Q.setAttribute("uv",new d.TlE(z,2)),this.screen=new d.Kj0(Q,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(h,l,f){const v=this.scene,x=this.camera,b=this.renderTargetA,P=this.renderTargetB;let I=this.convolutionMaterial,z=I.uniforms;z.depthBuffer.value=l.depthTexture;const Q=I.kernel;let H=l,ee,fe,Se;for(fe=0,Se=Q.length-1;fe<Se;++fe)ee=fe&1?P:b,z.kernel.value=Q[fe],z.inputBuffer.value=H.texture,h.setRenderTarget(ee),h.render(v,x),H=ee;z.kernel.value=Q[fe],z.inputBuffer.value=H.texture,h.setRenderTarget(this.renderToScreen?null:f),h.render(v,x)}}class Fm extends d.Wid{constructor(l={}){super(l);B(this,"_tDepth",{value:null});B(this,"_distortionMap",{value:null});B(this,"_tDiffuse",{value:null});B(this,"_tDiffuseBlur",{value:null});B(this,"_textureMatrix",{value:null});B(this,"_hasBlur",{value:!1});B(this,"_mirror",{value:0});B(this,"_mixBlur",{value:0});B(this,"_blurStrength",{value:.5});B(this,"_minDepthThreshold",{value:.9});B(this,"_maxDepthThreshold",{value:1});B(this,"_depthScale",{value:0});B(this,"_depthToBlurRatioBias",{value:.25});B(this,"_distortion",{value:1});B(this,"_mixContrast",{value:1});this.setValues(l)}onBeforeCompile(l){var f;(f=l.defines)!=null&&f.USE_UV||(l.defines.USE_UV=""),l.uniforms.hasBlur=this._hasBlur,l.uniforms.tDiffuse=this._tDiffuse,l.uniforms.tDepth=this._tDepth,l.uniforms.distortionMap=this._distortionMap,l.uniforms.tDiffuseBlur=this._tDiffuseBlur,l.uniforms.textureMatrix=this._textureMatrix,l.uniforms.mirror=this._mirror,l.uniforms.mixBlur=this._mixBlur,l.uniforms.mixStrength=this._blurStrength,l.uniforms.minDepthThreshold=this._minDepthThreshold,l.uniforms.maxDepthThreshold=this._maxDepthThreshold,l.uniforms.depthScale=this._depthScale,l.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,l.uniforms.distortion=this._distortion,l.uniforms.mixContrast=this._mixContrast,l.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${l.vertexShader}`,l.vertexShader=l.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),l.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
		uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${l.fragmentShader}`,l.fragmentShader=l.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(l){this._tDiffuse.value=l}get tDepth(){return this._tDepth.value}set tDepth(l){this._tDepth.value=l}get distortionMap(){return this._distortionMap.value}set distortionMap(l){this._distortionMap.value=l}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(l){this._tDiffuseBlur.value=l}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(l){this._textureMatrix.value=l}get hasBlur(){return this._hasBlur.value}set hasBlur(l){this._hasBlur.value=l}get mirror(){return this._mirror.value}set mirror(l){this._mirror.value=l}get mixBlur(){return this._mixBlur.value}set mixBlur(l){this._mixBlur.value=l}get mixStrength(){return this._blurStrength.value}set mixStrength(l){this._blurStrength.value=l}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(l){this._minDepthThreshold.value=l}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(l){this._maxDepthThreshold.value=l}get depthScale(){return this._depthScale.value}set depthScale(l){this._depthScale.value=l}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(l){this._depthToBlurRatioBias.value=l}get distortion(){return this._distortion.value}set distortion(l){this._distortion.value=l}get mixContrast(){return this._mixContrast.value}set mixContrast(l){this._mixContrast.value=l}}const fl=new d.Ltg,Zo=new d.Ltg,sc=new d.JOQ,_s=new d.Pa4,Zs=new d.Pa4,Js=new d.Pa4,pl=new d.yGw,xs=new d.Pa4,Jo=new d.Pa4,$o=new d.Pa4;class Ia extends mt.w{constructor({width:l=1,height:f=1,mixBlur:v=0,mixStrength:x=1,resolution:b=256,blur:P=[0,0],minDepthThreshold:I=.9,maxDepthThreshold:z=1,depthScale:Q=0,depthToBlurRatioBias:H=.25,mirror:ee=0,distortion:fe=1,mixContrast:Se=1,distortionMap:De=0,reflectorOffset:Re=0,color:Te=new d.Ilk(16777215),roughness:Oe=1,metalness:Ae=.8}){super();B(this,"_fbo1");B(this,"_fbo2");B(this,"_blurPass");B(this,"_hasBlur",!1);B(this,"_virtualCamera",new d.cPb);B(this,"_reflectorOffset",0);B(this,"_textureMatrix",new d.yGw);B(this,"_reflectorMaterial");const ke={minFilter:d.wem,magFilter:d.wem,type:d.cLu};this._fbo1=new d.dd2(b,b,ke),this._fbo1.depthBuffer=!0,this._fbo1.depthTexture=new d.$YQ(b,b),this._fbo1.depthTexture.format=d.qkB,this._fbo1.depthTexture.type=d.LsT,this._fbo2=new d.dd2(b,b,ke),this._blurPass=new Su({resolution:b,width:P[0],height:P[1],minDepthThreshold:I,maxDepthThreshold:z,depthScale:Q,depthToBlurRatioBias:H});let lt=this._hasBlur=P[0]+P[1]>0;this._reflectorOffset=Re,this._reflectorMaterial=Object.assign(new Fm,{color:Te,roughness:Oe,metalness:Ae,mirror:ee,mixBlur:v,textureMatrix:this._textureMatrix,tDiffuse:this._fbo1.texture,tDepth:this._fbo1.depthTexture,tDiffuseBlur:this._fbo2.texture,hasBlur:lt,mixStrength:x,minDepthThreshold:I,maxDepthThreshold:z,depthScale:Q,depthToBlurRatioBias:H,distortion:fe,distortionMap:De,mixContrast:Se,defines:{USE_BLUR:lt?"":void 0,USE_DEPTH:Q>0?"":void 0,USE_DISTORTION:De?"":void 0}},!0),this.node=new d.Kj0(new d._12(l,f),this._reflectorMaterial),this.node.rotation.set(-Math.PI/2,0,0)}onDestroy(){this._fbo1.dispose(),this._fbo2.dispose(),this._reflectorMaterial.dispose()}beforeRender(){const l=this.viewer.camera,f=this._virtualCamera,v=this._textureMatrix;if(_s.setFromMatrixPosition(this.node.matrixWorld),Zs.setFromMatrixPosition(l.matrixWorld),pl.extractRotation(this.node.matrixWorld),xs.set(0,0,1),xs.applyMatrix4(pl),_s.addScaledVector(xs,this._reflectorOffset),Js.subVectors(_s,Zs),Js.dot(xs)>0)return;Js.reflect(xs).negate(),Js.add(_s),pl.extractRotation(l.matrixWorld),$o.set(0,0,-1),$o.applyMatrix4(pl),$o.add(Zs),Jo.subVectors(_s,$o),Jo.reflect(xs).negate(),Jo.add(_s),f.position.copy(Js),f.up.set(0,1,0),f.up.applyMatrix4(pl),f.up.reflect(xs),f.lookAt(Jo),f.far=l.far,f.updateMatrixWorld(),f.projectionMatrix.copy(l.projectionMatrix),v.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),v.multiply(f.projectionMatrix),v.multiply(f.matrixWorldInverse),v.multiply(this.node.matrixWorld),sc.setFromNormalAndCoplanarPoint(xs,_s),sc.applyMatrix4(f.matrixWorldInverse),Zo.set(sc.normal.x,sc.normal.y,sc.normal.z,sc.constant);const x=f.projectionMatrix;fl.x=(Math.sign(Zo.x)+x.elements[8])/x.elements[0],fl.y=(Math.sign(Zo.y)+x.elements[9])/x.elements[5],fl.z=-1,fl.w=(1+x.elements[10])/x.elements[14],Zo.multiplyScalar(2/Zo.dot(fl)),x.elements[2]=Zo.x,x.elements[6]=Zo.y,x.elements[10]=Zo.z+1,x.elements[14]=Zo.w}update(l){this.node.visible=!1;const f=this.viewer.renderer,v=this.viewer.scene,x=f.xr.enabled,b=f.shadowMap.autoUpdate;this.beforeRender(),f.xr.enabled=!1,f.shadowMap.autoUpdate=!1,f.setRenderTarget(this._fbo1),f.state.buffers.depth.setMask(!0),f.autoClear||f.clear(),f.render(v,this._virtualCamera),this._hasBlur&&this._blurPass.render(f,this._fbo1,this._fbo2),f.xr.enabled=x,f.shadowMap.autoUpdate=b,this.node.visible=!0,f.setRenderTarget(null)}}class La extends mt.w{constructor(...[l,f,v]){super();B(this,"_fbo");B(this,"_scene");B(this,"_camera");this.onLoad=()=>{const{scene:x,camera:b,size:P}=this.viewer;this._fbo=new d.dd2(l||P.width,f||P.height,v),this._scene=x,this._camera=b}}get texture(){return this._fbo.texture}lastUpdate(l){const f=this.viewer.renderer;f.setRenderTarget(this._fbo),f.render(this._scene,this._camera),f.setRenderTarget(null)}}const bs=new G.iMs,cr=new G.Pa4,$s=new G.Pa4,li=new G._fP,Oa={X:new G.Pa4(1,0,0),Y:new G.Pa4(0,1,0),Z:new G.Pa4(0,0,1)},Mu={type:"change"},Bm={type:"mouseDown"},oc={type:"mouseUp",mode:null},Wh={type:"objectChange"};class ml extends G.Tme{constructor(h,l){super(),l===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),l=document),this.isTransformControls=!0,this.visible=!1,this.domElement=l,this.domElement.style.touchAction="none";const f=new W0;this._gizmo=f,this.add(f);const v=new km;this._plane=v,this.add(v);const x=this;function b(Oe,Ae){let ke=Ae;Object.defineProperty(x,Oe,{get:function(){return ke!==void 0?ke:Ae},set:function(lt){ke!==lt&&(ke=lt,v[Oe]=lt,f[Oe]=lt,x.dispatchEvent({type:Oe+"-changed",value:lt}),x.dispatchEvent(Mu))}}),x[Oe]=Ae,v[Oe]=Ae,f[Oe]=Ae}b("camera",h),b("object",void 0),b("enabled",!0),b("axis",null),b("mode","translate"),b("translationSnap",null),b("rotationSnap",null),b("scaleSnap",null),b("space","world"),b("size",1),b("dragging",!1),b("showX",!0),b("showY",!0),b("showZ",!0);const P=new G.Pa4,I=new G.Pa4,z=new G._fP,Q=new G._fP,H=new G.Pa4,ee=new G._fP,fe=new G.Pa4,Se=new G.Pa4,De=new G.Pa4,Re=0,Te=new G.Pa4;b("worldPosition",P),b("worldPositionStart",I),b("worldQuaternion",z),b("worldQuaternionStart",Q),b("cameraPosition",H),b("cameraQuaternion",ee),b("pointStart",fe),b("pointEnd",Se),b("rotationAxis",De),b("rotationAngle",Re),b("eye",Te),this._offset=new G.Pa4,this._startNorm=new G.Pa4,this._endNorm=new G.Pa4,this._cameraScale=new G.Pa4,this._parentPosition=new G.Pa4,this._parentQuaternion=new G._fP,this._parentQuaternionInv=new G._fP,this._parentScale=new G.Pa4,this._worldScaleStart=new G.Pa4,this._worldQuaternionInv=new G._fP,this._worldScale=new G.Pa4,this._positionStart=new G.Pa4,this._quaternionStart=new G._fP,this._scaleStart=new G.Pa4,this._getPointer=ea.bind(this),this._onPointerDown=jh.bind(this),this._onPointerHover=yf.bind(this),this._onPointerMove=Fa.bind(this),this._onPointerUp=_f.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(h){if(this.object===void 0||this.dragging===!0)return;bs.setFromCamera(h,this.camera);const l=ac(this._gizmo.picker[this.mode],bs);l?this.axis=l.object.name:this.axis=null}pointerDown(h){if(!(this.object===void 0||this.dragging===!0||h.button!==0)&&this.axis!==null){bs.setFromCamera(h,this.camera);const l=ac(this._plane,bs,!0);l&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(l.point).sub(this.worldPositionStart)),this.dragging=!0,Bm.mode=this.mode,this.dispatchEvent(Bm)}}pointerMove(h){const l=this.axis,f=this.mode,v=this.object;let x=this.space;if(f==="scale"?x="local":(l==="E"||l==="XYZE"||l==="XYZ")&&(x="world"),v===void 0||l===null||this.dragging===!1||h.button!==-1)return;bs.setFromCamera(h,this.camera);const b=ac(this._plane,bs,!0);if(b){if(this.pointEnd.copy(b.point).sub(this.worldPositionStart),f==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),x==="local"&&l!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),l.indexOf("X")===-1&&(this._offset.x=0),l.indexOf("Y")===-1&&(this._offset.y=0),l.indexOf("Z")===-1&&(this._offset.z=0),x==="local"&&l!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),v.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(x==="local"&&(v.position.applyQuaternion(li.copy(this._quaternionStart).invert()),l.search("X")!==-1&&(v.position.x=Math.round(v.position.x/this.translationSnap)*this.translationSnap),l.search("Y")!==-1&&(v.position.y=Math.round(v.position.y/this.translationSnap)*this.translationSnap),l.search("Z")!==-1&&(v.position.z=Math.round(v.position.z/this.translationSnap)*this.translationSnap),v.position.applyQuaternion(this._quaternionStart)),x==="world"&&(v.parent&&v.position.add(cr.setFromMatrixPosition(v.parent.matrixWorld)),l.search("X")!==-1&&(v.position.x=Math.round(v.position.x/this.translationSnap)*this.translationSnap),l.search("Y")!==-1&&(v.position.y=Math.round(v.position.y/this.translationSnap)*this.translationSnap),l.search("Z")!==-1&&(v.position.z=Math.round(v.position.z/this.translationSnap)*this.translationSnap),v.parent&&v.position.sub(cr.setFromMatrixPosition(v.parent.matrixWorld))));else if(f==="scale"){if(l.search("XYZ")!==-1){let P=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(P*=-1),$s.set(P,P,P)}else cr.copy(this.pointStart),$s.copy(this.pointEnd),cr.applyQuaternion(this._worldQuaternionInv),$s.applyQuaternion(this._worldQuaternionInv),$s.divide(cr),l.search("X")===-1&&($s.x=1),l.search("Y")===-1&&($s.y=1),l.search("Z")===-1&&($s.z=1);v.scale.copy(this._scaleStart).multiply($s),this.scaleSnap&&(l.search("X")!==-1&&(v.scale.x=Math.round(v.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),l.search("Y")!==-1&&(v.scale.y=Math.round(v.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),l.search("Z")!==-1&&(v.scale.z=Math.round(v.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(f==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const P=20/this.worldPosition.distanceTo(cr.setFromMatrixPosition(this.camera.matrixWorld));l==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):l==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(cr.copy(this.rotationAxis).cross(this.eye))*P):(l==="X"||l==="Y"||l==="Z")&&(this.rotationAxis.copy(Oa[l]),cr.copy(Oa[l]),x==="local"&&cr.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(cr.cross(this.eye).normalize())*P),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),x==="local"&&l!=="E"&&l!=="XYZE"?(v.quaternion.copy(this._quaternionStart),v.quaternion.multiply(li.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),v.quaternion.copy(li.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),v.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Mu),this.dispatchEvent(Wh)}}pointerUp(h){h.button===0&&(this.dragging&&this.axis!==null&&(oc.mode=this.mode,this.dispatchEvent(oc)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(h){h.geometry&&h.geometry.dispose(),h.material&&h.material.dispose()})}attach(h){return this.object=h,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Mu),this.dispatchEvent(Wh),this.pointStart.copy(this.pointEnd))}getRaycaster(){return bs}getMode(){return this.mode}setMode(h){this.mode=h}setTranslationSnap(h){this.translationSnap=h}setRotationSnap(h){this.rotationSnap=h}setScaleSnap(h){this.scaleSnap=h}setSize(h){this.size=h}setSpace(h){this.space=h}}function ea(S){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:S.button};{const h=this.domElement.getBoundingClientRect();return{x:(S.clientX-h.left)/h.width*2-1,y:-(S.clientY-h.top)/h.height*2+1,button:S.button}}}function yf(S){if(this.enabled)switch(S.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(S));break}}function jh(S){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(S.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(S)),this.pointerDown(this._getPointer(S)))}function Fa(S){this.enabled&&this.pointerMove(this._getPointer(S))}function _f(S){this.enabled&&(this.domElement.releasePointerCapture(S.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(S)))}function ac(S,h,l){const f=h.intersectObject(S,!0);for(let v=0;v<f.length;v++)if(f[v].object.visible||l)return f[v];return!1}const lc=new G.USm,jn=new G.Pa4(0,1,0),Mn=new G.Pa4(0,0,0),gl=new G.yGw,ss=new G._fP,Xh=new G._fP,Co=new G.Pa4,ta=new G.yGw,Ba=new G.Pa4(1,0,0),er=new G.Pa4(0,1,0),cc=new G.Pa4(0,0,1),Eu=new G.Pa4,na=new G.Pa4,ka=new G.Pa4;class W0 extends G.Tme{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const h=new G.vBJ({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),l=new G.nls({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),f=h.clone();f.opacity=.15;const v=l.clone();v.opacity=.5;const x=h.clone();x.color.setHex(16711680);const b=h.clone();b.color.setHex(65280);const P=h.clone();P.color.setHex(255);const I=h.clone();I.color.setHex(16711680),I.opacity=.5;const z=h.clone();z.color.setHex(65280),z.opacity=.5;const Q=h.clone();Q.color.setHex(255),Q.opacity=.5;const H=h.clone();H.opacity=.25;const ee=h.clone();ee.color.setHex(16776960),ee.opacity=.25,h.clone().color.setHex(16776960);const Se=h.clone();Se.color.setHex(7895160);const De=new G.fHI(0,.04,.1,12);De.translate(0,.05,0);const Re=new G.DvJ(.08,.08,.08);Re.translate(0,.04,0);const Te=new G.u9r;Te.setAttribute("position",new G.a$l([0,0,0,1,0,0],3));const Oe=new G.fHI(.0075,.0075,.5,3);Oe.translate(0,.25,0);function Ae(Fn,nr){const ui=new G.XvJ(Fn,.0075,3,64,nr*Math.PI*2);return ui.rotateY(Math.PI/2),ui.rotateX(Math.PI/2),ui}function ke(){const Fn=new G.u9r;return Fn.setAttribute("position",new G.a$l([0,0,0,1,1,1],3)),Fn}const lt={X:[[new G.Kj0(De,x),[.5,0,0],[0,0,-Math.PI/2]],[new G.Kj0(De,x),[-.5,0,0],[0,0,Math.PI/2]],[new G.Kj0(Oe,x),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new G.Kj0(De,b),[0,.5,0]],[new G.Kj0(De,b),[0,-.5,0],[Math.PI,0,0]],[new G.Kj0(Oe,b)]],Z:[[new G.Kj0(De,P),[0,0,.5],[Math.PI/2,0,0]],[new G.Kj0(De,P),[0,0,-.5],[-Math.PI/2,0,0]],[new G.Kj0(Oe,P),null,[Math.PI/2,0,0]]],XYZ:[[new G.Kj0(new G.pQR(.1,0),H.clone()),[0,0,0]]],XY:[[new G.Kj0(new G.DvJ(.15,.15,.01),Q.clone()),[.15,.15,0]]],YZ:[[new G.Kj0(new G.DvJ(.15,.15,.01),I.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new G.Kj0(new G.DvJ(.15,.15,.01),z.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},wt={X:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[.3,0,0],[0,0,-Math.PI/2]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,.3,0]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,-.3,0],[0,0,Math.PI]]],Z:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,0,.3],[Math.PI/2,0,0]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new G.Kj0(new G.pQR(.2,0),f)]],XY:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[.15,.15,0]]],YZ:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[.15,0,.15],[-Math.PI/2,0,0]]]},xt={START:[[new G.Kj0(new G.pQR(.01,2),v),null,null,null,"helper"]],END:[[new G.Kj0(new G.pQR(.01,2),v),null,null,null,"helper"]],DELTA:[[new G.x12(ke(),v),null,null,null,"helper"]],X:[[new G.x12(Te,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new G.x12(Te,v.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new G.x12(Te,v.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Ft={XYZE:[[new G.Kj0(Ae(.5,1),Se),null,[0,Math.PI/2,0]]],X:[[new G.Kj0(Ae(.5,.5),x)]],Y:[[new G.Kj0(Ae(.5,.5),b),null,[0,0,-Math.PI/2]]],Z:[[new G.Kj0(Ae(.5,.5),P),null,[0,Math.PI/2,0]]],E:[[new G.Kj0(Ae(.75,1),ee),null,[0,Math.PI/2,0]]]},Rt={AXIS:[[new G.x12(Te,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},on={XYZE:[[new G.Kj0(new G.xo$(.25,10,8),f)]],X:[[new G.Kj0(new G.XvJ(.5,.1,4,24),f),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new G.Kj0(new G.XvJ(.5,.1,4,24),f),[0,0,0],[Math.PI/2,0,0]]],Z:[[new G.Kj0(new G.XvJ(.5,.1,4,24),f),[0,0,0],[0,0,-Math.PI/2]]],E:[[new G.Kj0(new G.XvJ(.75,.1,2,24),f)]]},Nt={X:[[new G.Kj0(Re,x),[.5,0,0],[0,0,-Math.PI/2]],[new G.Kj0(Oe,x),[0,0,0],[0,0,-Math.PI/2]],[new G.Kj0(Re,x),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new G.Kj0(Re,b),[0,.5,0]],[new G.Kj0(Oe,b)],[new G.Kj0(Re,b),[0,-.5,0],[0,0,Math.PI]]],Z:[[new G.Kj0(Re,P),[0,0,.5],[Math.PI/2,0,0]],[new G.Kj0(Oe,P),[0,0,0],[Math.PI/2,0,0]],[new G.Kj0(Re,P),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new G.Kj0(new G.DvJ(.15,.15,.01),Q),[.15,.15,0]]],YZ:[[new G.Kj0(new G.DvJ(.15,.15,.01),I),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new G.Kj0(new G.DvJ(.15,.15,.01),z),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new G.Kj0(new G.DvJ(.1,.1,.1),H.clone())]]},In={X:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[.3,0,0],[0,0,-Math.PI/2]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,.3,0]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,-.3,0],[0,0,Math.PI]]],Z:[[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,0,.3],[Math.PI/2,0,0]],[new G.Kj0(new G.fHI(.2,0,.6,4),f),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[.15,.15,0]]],YZ:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new G.Kj0(new G.DvJ(.2,.2,.01),f),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new G.Kj0(new G.DvJ(.2,.2,.2),f),[0,0,0]]]},Ai={X:[[new G.x12(Te,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new G.x12(Te,v.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new G.x12(Te,v.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function $n(Fn){const nr=new G.Tme;for(const ui in Fn)for(let Ui=Fn[ui].length;Ui--;){const Ri=Fn[ui][Ui][0].clone(),ir=Fn[ui][Ui][1],Do=Fn[ui][Ui][2],hr=Fn[ui][Ui][3],Ha=Fn[ui][Ui][4];Ri.name=ui,Ri.tag=Ha,ir&&Ri.position.set(ir[0],ir[1],ir[2]),Do&&Ri.rotation.set(Do[0],Do[1],Do[2]),hr&&Ri.scale.set(hr[0],hr[1],hr[2]),Ri.updateMatrix();const aa=Ri.geometry.clone();aa.applyMatrix4(Ri.matrix),Ri.geometry=aa,Ri.renderOrder=1/0,Ri.position.set(0,0,0),Ri.rotation.set(0,0,0),Ri.scale.set(1,1,1),Ri.isGizmo=!0,nr.add(Ri)}return nr}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=$n(lt)),this.add(this.gizmo.rotate=$n(Ft)),this.add(this.gizmo.scale=$n(Nt)),this.add(this.picker.translate=$n(wt)),this.add(this.picker.rotate=$n(on)),this.add(this.picker.scale=$n(In)),this.add(this.helper.translate=$n(xt)),this.add(this.helper.rotate=$n(Rt)),this.add(this.helper.scale=$n(Ai)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(h){const f=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Xh;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let v=[];v=v.concat(this.picker[this.mode].children),v=v.concat(this.gizmo[this.mode].children),v=v.concat(this.helper[this.mode].children);for(let x=0;x<v.length;x++){const b=v[x];b.visible=!0,b.rotation.set(0,0,0),b.position.copy(this.worldPosition);let P;if(this.camera.isOrthographicCamera?P=(this.camera.top-this.camera.bottom)/this.camera.zoom:P=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),b.scale.set(1,1,1).multiplyScalar(P*this.size/4),b.tag==="helper"){b.visible=!1,b.name==="AXIS"?(b.visible=!!this.axis,this.axis==="X"&&(li.setFromEuler(lc.set(0,0,0)),b.quaternion.copy(f).multiply(li),Math.abs(jn.copy(Ba).applyQuaternion(f).dot(this.eye))>.9&&(b.visible=!1)),this.axis==="Y"&&(li.setFromEuler(lc.set(0,0,Math.PI/2)),b.quaternion.copy(f).multiply(li),Math.abs(jn.copy(er).applyQuaternion(f).dot(this.eye))>.9&&(b.visible=!1)),this.axis==="Z"&&(li.setFromEuler(lc.set(0,Math.PI/2,0)),b.quaternion.copy(f).multiply(li),Math.abs(jn.copy(cc).applyQuaternion(f).dot(this.eye))>.9&&(b.visible=!1)),this.axis==="XYZE"&&(li.setFromEuler(lc.set(0,Math.PI/2,0)),jn.copy(this.rotationAxis),b.quaternion.setFromRotationMatrix(gl.lookAt(Mn,jn,er)),b.quaternion.multiply(li),b.visible=this.dragging),this.axis==="E"&&(b.visible=!1)):b.name==="START"?(b.position.copy(this.worldPositionStart),b.visible=this.dragging):b.name==="END"?(b.position.copy(this.worldPosition),b.visible=this.dragging):b.name==="DELTA"?(b.position.copy(this.worldPositionStart),b.quaternion.copy(this.worldQuaternionStart),cr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),cr.applyQuaternion(this.worldQuaternionStart.clone().invert()),b.scale.copy(cr),b.visible=this.dragging):(b.quaternion.copy(f),this.dragging?b.position.copy(this.worldPositionStart):b.position.copy(this.worldPosition),this.axis&&(b.visible=this.axis.search(b.name)!==-1));continue}b.quaternion.copy(f),this.mode==="translate"||this.mode==="scale"?(b.name==="X"&&Math.abs(jn.copy(Ba).applyQuaternion(f).dot(this.eye))>.99&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1),b.name==="Y"&&Math.abs(jn.copy(er).applyQuaternion(f).dot(this.eye))>.99&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1),b.name==="Z"&&Math.abs(jn.copy(cc).applyQuaternion(f).dot(this.eye))>.99&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1),b.name==="XY"&&Math.abs(jn.copy(cc).applyQuaternion(f).dot(this.eye))<.2&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1),b.name==="YZ"&&Math.abs(jn.copy(Ba).applyQuaternion(f).dot(this.eye))<.2&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1),b.name==="XZ"&&Math.abs(jn.copy(er).applyQuaternion(f).dot(this.eye))<.2&&(b.scale.set(1e-10,1e-10,1e-10),b.visible=!1)):this.mode==="rotate"&&(ss.copy(f),jn.copy(this.eye).applyQuaternion(li.copy(f).invert()),b.name.search("E")!==-1&&b.quaternion.setFromRotationMatrix(gl.lookAt(this.eye,Mn,er)),b.name==="X"&&(li.setFromAxisAngle(Ba,Math.atan2(-jn.y,jn.z)),li.multiplyQuaternions(ss,li),b.quaternion.copy(li)),b.name==="Y"&&(li.setFromAxisAngle(er,Math.atan2(jn.x,jn.z)),li.multiplyQuaternions(ss,li),b.quaternion.copy(li)),b.name==="Z"&&(li.setFromAxisAngle(cc,Math.atan2(jn.y,jn.x)),li.multiplyQuaternions(ss,li),b.quaternion.copy(li))),b.visible=b.visible&&(b.name.indexOf("X")===-1||this.showX),b.visible=b.visible&&(b.name.indexOf("Y")===-1||this.showY),b.visible=b.visible&&(b.name.indexOf("Z")===-1||this.showZ),b.visible=b.visible&&(b.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),b.material._color=b.material._color||b.material.color.clone(),b.material._opacity=b.material._opacity||b.material.opacity,b.material.color.copy(b.material._color),b.material.opacity=b.material._opacity,this.enabled&&this.axis&&(b.name===this.axis||this.axis.split("").some(function(I){return b.name===I}))&&(b.material.color.setHex(16776960),b.material.opacity=1)}super.updateMatrixWorld(h)}}class km extends G.Kj0{constructor(){super(new G._12(1e5,1e5,2,2),new G.vBJ({visible:!1,wireframe:!0,side:G.ehD,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(h){let l=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(l="local"),Eu.copy(Ba).applyQuaternion(l==="local"?this.worldQuaternion:Xh),na.copy(er).applyQuaternion(l==="local"?this.worldQuaternion:Xh),ka.copy(cc).applyQuaternion(l==="local"?this.worldQuaternion:Xh),jn.copy(na),this.mode){case"translate":case"scale":switch(this.axis){case"X":jn.copy(this.eye).cross(Eu),Co.copy(Eu).cross(jn);break;case"Y":jn.copy(this.eye).cross(na),Co.copy(na).cross(jn);break;case"Z":jn.copy(this.eye).cross(ka),Co.copy(ka).cross(jn);break;case"XY":Co.copy(ka);break;case"YZ":Co.copy(Eu);break;case"XZ":jn.copy(ka),Co.copy(na);break;case"XYZ":case"E":Co.set(0,0,0);break}break;case"rotate":default:Co.set(0,0,0)}Co.length()===0?this.quaternion.copy(this.cameraQuaternion):(ta.lookAt(cr.set(0,0,0),Co,jn),this.quaternion.setFromRotationMatrix(ta)),super.updateMatrixWorld(h)}}class vl extends Bh.S{constructor(l){super();B(this,"name","VirtualCameraPlugin");B(this,"_brain",null);B(this,"_freelookCamera",null);this.onLoad=()=>{const f=this.viewer.camera;this._brain=this.viewer.addComponent(f,Gh),this._freelookCamera=this.viewer.addNode(Zn,Object.assign({fov:f.fov,near:f.near,far:f.far,lookAt:new d.Tme,position:Sn(0,0,4)},l))}}onEnable(){this._brain&&(this._brain.enabled=!0),this._freelookCamera&&(this._freelookCamera.enabled=!0)}onDisable(){this._brain&&(this._brain.enabled=!1),this._freelookCamera&&(this._freelookCamera.enabled=!1)}}var ws=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};class ia extends mt.w{constructor(){super(...arguments);B(this,"_vcamPlugin");B(this,"_transform")}get mode(){return this._transform.mode}set mode(l){this._transform.mode=l}get space(){return this._transform.space}set space(l){this._transform.setSpace(l)}get position(){return this.node.position}set position(l){this.node.position.copy(l)}get rotation(){return this.node.rotation}set rotation(l){this.node.rotation.copy(l)}get scale(){return this.node.scale}set scale(l){this.node.scale.copy(l)}onEnable(){this._transform&&this._transform.attach(this.node)}onDisable(){this._transform&&this._transform.detach()}start(){this._vcamPlugin=this.viewer.getPlugin(vl),this._transform=this.viewer.addNode(ml,{args:[this.viewer.camera,this.viewer.renderer.domElement]}),this._transform.attach(this.node),this._transform.addEventListener("dragging-changed",l=>{this._vcamPlugin&&(this._vcamPlugin.enabled=!l.value)}),this._transform.addEventListener("change",()=>{const l=this.__properties;switch(this._transform.mode){case"translate":l.position.$.updateDisplay();break;case"rotate":l.rotation.$.updateDisplay();break;case"scale":l.scale.$.updateDisplay();break}}),this.name=this.node.name||"Node"}}ws([(0,Yt.Cb)({value:{translate:"translate",rotate:"rotate",scale:"scale"}})],ia.prototype,"mode",null),ws([(0,Yt.Cb)({value:{local:"local",world:"world"}})],ia.prototype,"space",null),ws([(0,Yt.Cb)()],ia.prototype,"position",null),ws([(0,Yt.Cb)()],ia.prototype,"rotation",null),ws([(0,Yt.Cb)()],ia.prototype,"scale",null);class Tu extends mt.w{constructor(){super(...arguments);B(this,"_helper")}start(){let l=this.node;l.isDirectionalLight&&(this._helper=this.viewer.addNode(new d.cBI(l))),l.isPointLight&&(this._helper=this.viewer.addNode(new d.xG9(l))),l.isSpotLight&&(this._helper=this.viewer.addNode(new d.FvO(l))),l.isLight&&l.castShadow&&this.viewer.addNode(new d.Rki(l.shadow.camera))}update(l){this._helper&&this._helper.update()}}const wl=class wl extends mt.w{constructor(){super(...arguments);B(this,"_mixer");B(this,"_actions");B(this,"_action",null)}onLoad(){this._mixer=new d.Xcj(this.node),this._mixer.addEventListener(wl.FINISHED,l=>this.emit(wl.FINISHED,l)),this._mixer.addEventListener(wl.LOOP,l=>this.emit(wl.LOOP,l)),this._actions=this.node.animations.map(l=>this._mixer.clipAction(l))}update(l){this._mixer.update(l)}play(l,f={}){let v=l?this._actions.find(x=>x.getClip().name===l):this._actions[0];return v&&(f.clampWhenFinished!==void 0&&(v.clampWhenFinished=f.clampWhenFinished),f.zeroSlopeAtStart!==void 0&&(v.zeroSlopeAtStart=f.zeroSlopeAtStart),f.zeroSlopeAtEnd!==void 0&&(v.zeroSlopeAtEnd=f.zeroSlopeAtEnd),f.mode&&v.setLoop(f.mode,f.repetitions),f.duration&&v.setDuration(f.duration),this._action=v.play()),this}stop(){return this._action&&this._action.stop(),this}};B(wl,"FINISHED","finished"),B(wl,"LOOP","loop");let xf=wl;class j0 extends mt.w{constructor({iterations:l=10,ms:f=250,threshold:v=.75,step:x=.1,factor:b=.5,flipflops:P=1/0,bounds:I=fe=>fe>100?[60,100]:[40,60],onIncline:z,onDecline:Q,onChange:H,onFallback:ee}){super();B(this,"fps",0);B(this,"index",0);B(this,"factor",.5);B(this,"flipped",0);B(this,"refreshrate",0);B(this,"fallback",!1);B(this,"frames",[]);B(this,"averages",[]);B(this,"subscriptions",new Map);let fe=0;const Se=Math.pow(10,0);this.update=De=>{if(this.fallback)return;const{frames:Re,averages:Te}=this;if(Te.length<l){Re.push(performance.now());const Oe=Re[Re.length-1]-Re[0];if(Oe>=f){if(this.fps=Math.round(Re.length/Oe*1e3*Se)/Se,this.refreshrate=Math.max(this.refreshrate,this.fps),Te[this.index++%l]=this.fps,Te.length===l){const[Ae,ke]=I(this.refreshrate),lt=Te.filter(xt=>xt>=ke),wt=Te.filter(xt=>xt<Ae);lt.length>l*v&&(this.factor=Math.min(1,this.factor+x),this.flipped++,z&&z(this),this.subscriptions.forEach(xt=>xt.onIncline&&xt.onIncline(this))),wt.length>l*v&&(this.factor=Math.max(0,this.factor-x),this.flipped++,Q&&Q(this),this.subscriptions.forEach(xt=>xt.onDecline&&xt.onDecline(this))),fe!==this.factor&&(fe=this.factor,H&&H(this),this.subscriptions.forEach(xt=>xt.onChange&&xt.onChange(this))),this.flipped>P&&!this.fallback&&(this.fallback=!0,ee&&ee(this),this.subscriptions.forEach(xt=>xt.onFallback&&xt.onFallback(this))),this.averages=[]}this.frames=[]}}}}subscribe(l){this.subscriptions.set(Symbol(),l)}}function bf(S,h,l,f){return class extends d.jyz{constructor(b={}){const P=Object.entries(S);super({uniforms:P.reduce((I,[z,Q])=>{const H=d.rDY.clone({[z]:{value:Q}});return{...I,...H}},{}),vertexShader:h,fragmentShader:l});B(this,"key","");P.forEach(([I])=>Object.defineProperty(this,I,{get:()=>this.uniforms[I].value,set:z=>this.uniforms[I].value=z})),Object.assign(this,b),f&&f(this)}}}const Um=bf({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class Nm extends d.Kj0{constructor(...h){super(new d.DvJ(...h))}}class X0 extends d.Kj0{constructor(...h){super(new d.BVQ(...h))}}class zm extends d.Kj0{constructor(...h){super(new d.zf8(...h))}}class Gn extends d.Kj0{constructor(...h){super(new d.b_z(...h))}}class eo extends d.Kj0{constructor(...h){super(new d.fHI(...h))}}class ra extends d.Kj0{constructor(...h){super(new d.Kgo(...h))}}class wf extends d.Kj0{constructor(...h){super(new d.TOt(...h))}}class sa extends d.Kj0{constructor(...h){super(new d.O7d(...h))}}class uc extends d.Kj0{constructor(...h){super(new d.cJO(...h))}}class hc extends d.Kj0{constructor(...h){super(new d.p7y(...h))}}class Gm extends d.Kj0{constructor(...h){super(new d.pQR(...h))}}class Yh extends d.Kj0{constructor(...h){super(new d._12(...h))}}class Af extends d.Kj0{constructor(...h){super(new d.Uol(...h))}}class Sf extends d.Kj0{constructor(...h){super(new d.o8S(...h))}}class Os extends d.Kj0{constructor(...h){super(new d.oa8(...h))}}class Y0 extends d.Kj0{constructor(...h){super(new d.xo$(...h))}}class Ir extends d.Kj0{constructor(...h){super(new d.H$k(...h))}}class Hm extends d.Kj0{constructor(...h){super(new d.XvJ(...h))}}class to extends d.Kj0{constructor(...h){super(new d.FE5(...h))}}class Qh extends d.Kj0{constructor(...h){super(new d.WXh(...h))}}class Mf extends d.Kj0{constructor(...h){super(new d.Uk6(...h))}}function Ut(S){return S.isLight}function Lr(S){return!!S.geometry}const Ua=bf({color:new d.Ilk,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
     void main() {
       gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
       vUv = uv;
     }`,`varying vec2 vUv;
     uniform sampler2D map;
     uniform vec3 color;
     uniform float opacity;
     uniform float alphaTest;
     uniform float blend;
     void main() {
       vec4 sampledDiffuseColor = texture2D(map, vUv);
       gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
       #include <tonemapping_fragment>
       #include <encodings_fragment>
     }`);class qi extends mt.w{constructor({temporal:l,frames:f=40,limit:v=1/0,blend:x=20,scale:b=10,opacity:P=1,alphaTest:I=.75,color:z="black",colorBlend:Q=2,resolution:H=1024,toneMapped:ee=!0}={}){super();B(this,"lights");B(this,"temporal");B(this,"frames");B(this,"blend");B(this,"count");this.lights=[],this.temporal=!!l,this.frames=Math.max(2,f),this.blend=Math.max(2,f===1/0?x:f),this.count=0,this.onLoad=()=>{const{renderer:fe,scene:Se,camera:De}=this.viewer,Re=new ci(fe,Se,H),Te=new d.ZAu,Oe=this.viewer.addNode(new Yh,{parent:this.node,scale:Sn(b),rotation:Fi(-Math.PI/2,0,0),material:Ge(new Ua,{transparent:!0,depthWrite:!1,toneMapped:ee,color:Ie(z),blend:Q,map:Re.progressiveLightMap2.texture})});Re.configure(Te),Te.add(...this.lights);const Ae=(ke=1)=>{const lt=Oe.material;this.temporal?(lt.opacity=Math.min(P,lt.opacity+P/this.blend),lt.alphaTest=Math.min(I,lt.alphaTest+I/this.blend)):(lt.opacity=P,lt.alphaTest=I),Te.visible=!0,Re.prepare();for(let wt=0;wt<ke;wt++)this.lights.forEach(xt=>xt.update()),Re.update(De,this.blend);Te.visible=!1,Re.finish()};this.update=ke=>{(this.temporal||this.frames===1/0)&&this.count<this.frames&&this.count<v&&(Ae(),this.count++)}}}}class Kh extends d.Tme{constructor({castShadow:h=!0,bias:l=.001,mapSize:f=512,size:v=5,near:x=.5,far:b=500,frames:P=1,position:I=[0,0,0],radius:z=1,amount:Q=8,intensity:H=1,ambient:ee=.5}={}){super();for(let fe=0;fe<Q;fe++){let Se=new d.Ox3;Se.intensity=H,Se.castShadow=h,q(Se.shadow,[-v,v,v,-v,x,b,l,f,f]),this.add(Se)}this.update=()=>{let fe;for(let Se=0;Se<this.children.length;Se++)if(fe=this.children[Se],Math.random()>ee)fe.position.set(I[0]+d.MathUtils.randFloatSpread(z),I[1]+d.MathUtils.randFloatSpread(z),I[2]+d.MathUtils.randFloatSpread(z));else{let De=Math.acos(2*Math.random()-1)-Math.PI/2,Re=2*Math.PI*Math.random();fe.position.set(Math.cos(De)*Math.cos(Re)*length,Math.abs(Math.cos(De)*Math.sin(Re)*length),Math.sin(De)*length)}}}}class ci{constructor(h,l,f=1024){B(this,"renderer");B(this,"res");B(this,"scene");B(this,"object");B(this,"buffer1Active");B(this,"progressiveLightMap1");B(this,"progressiveLightMap2");B(this,"discardMat");B(this,"targetMat");B(this,"previousShadowMap");B(this,"averagingWindow");B(this,"clearColor");B(this,"clearAlpha");B(this,"lights");B(this,"meshes");this.renderer=h,this.res=f,this.scene=l,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new d.Ilk,this.clearAlpha=0;const v=/(Android|iPad|iPhone|iPod)/g.test(navigator.userAgent)?d.cLu:d.VzW;this.progressiveLightMap1=new d.dd2(this.res,this.res,{type:v}),this.progressiveLightMap2=new d.dd2(this.res,this.res,{type:v}),this.discardMat=new Um,this.targetMat=new d.YBo({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=x=>{x.vertexShader=`varying vec2 vUv;
`+x.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const b=x.fragmentShader.indexOf("void main() {");x.fragmentShader=`varying vec2 vUv;
`+x.fragmentShader.slice(0,b)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+x.fragmentShader.slice(b-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
          gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
        }`,x.uniforms.previousShadowMap=this.previousShadowMap,x.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(h=>{Lr(h)?this.meshes.push({object:h,material:h.material}):Ut(h)&&this.lights.push({object:h,intensity:h.intensity})})}prepare(){this.lights.forEach(h=>h.object.intensity=0),this.meshes.forEach(h=>h.object.material=this.discardMat)}finish(){this.lights.forEach(h=>h.object.intensity=h.intensity),this.meshes.forEach(h=>h.object.material=h.material)}configure(h){this.object=h}update(h,l=100){if(!this.object)return;this.averagingWindow.value=l,this.object.material=this.targetMat;const f=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,v=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,x=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(f),this.previousShadowMap.value=v.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,h),this.renderer.setRenderTarget(null),this.scene.background=x}}class Q0 extends d.Kj0{constructor({map:h,toneMapped:l=!1,color:f="white",form:v="rect",intensity:x=1,scale:b=Sn(1),target:P=Sn(),material:I}={}){super(),this.geometry=v==="circle"?new d.o8S(0,1,64):v==="ring"?new d.o8S(.5,1.64):v==="rect"?new d._12:v,this.material=I??new d.vBJ({toneMapped:l,map:h,side:d.ehD}),this.material.color.set(f).multiplyScalar(x),this.scale.copy(b),this.lookAt(P)}}var Po=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};let Vm=Sn(),Wm=Sn();class As extends mt.w{constructor(){super(...arguments);B(this,"enablePositionNoise",!0);B(this,"positionFrequency",.2);B(this,"positionAmplitude",.5);B(this,"positionScale",Sn(1));B(this,"positionFractalLevel",3);B(this,"enableRotationNoise",!0);B(this,"rotationFrequency",.2);B(this,"rotationAmplitude",10);B(this,"rotationScale",Sn(1,1,0));B(this,"rotationFractalLevel",3);B(this,"_initialPosition",Sn());B(this,"_initialRotation",Fi());B(this,"_time",[]);B(this,"_fbmNorm",1/.75)}rehash(){for(let l=0;l<6;l++)this._time[l]=d.MathUtils.randFloat(-1e4,0)}start(){this._initialPosition.copy(this.node.position),this._initialRotation.copy(this.node.rotation),this.rehash()}update(l){if(this.enablePositionNoise){for(let v=0;v<3;v++)this._time[v]+=this.positionFrequency*l;let f=Vm.set($e.Fbm(this.positionFractalLevel,this._time[0]),$e.Fbm(this.positionFractalLevel,this._time[1]),$e.Fbm(this.positionFractalLevel,this._time[2]));f=f.multiply(this.positionScale),f.multiplyScalar(this.positionAmplitude*this._fbmNorm),this.node.position.copy(this._initialPosition).add(f)}if(this.enableRotationNoise){for(let v=0;v<3;v++)this._time[v+3]+=this.rotationFrequency*l;let f=Vm.set($e.Fbm(this.rotationFractalLevel,this._time[3]),$e.Fbm(this.rotationFractalLevel,this._time[4]),$e.Fbm(this.rotationFractalLevel,this._time[5]));f=f.multiply(this.rotationScale),f.multiplyScalar(this.rotationAmplitude*this._fbmNorm),Wm.setFromEuler(this._initialRotation).add(f),this.node.rotation.setFromVector3(Wm)}}}Po([(0,Yt.Cb)({dir:"position"})],As.prototype,"enablePositionNoise",void 0),Po([(0,Yt.Cb)({dir:"position"})],As.prototype,"positionFrequency",void 0),Po([(0,Yt.Cb)({dir:"position"})],As.prototype,"positionAmplitude",void 0),Po([(0,Yt.Cb)({dir:"position"})],As.prototype,"positionScale",void 0),Po([(0,Yt.Cb)({dir:"position",min:0,max:8,step:1})],As.prototype,"positionFractalLevel",void 0),Po([(0,Yt.Cb)({dir:"rotation"})],As.prototype,"enableRotationNoise",void 0),Po([(0,Yt.Cb)({dir:"rotation"})],As.prototype,"rotationFrequency",void 0),Po([(0,Yt.Cb)({dir:"rotation"})],As.prototype,"rotationAmplitude",void 0),Po([(0,Yt.Cb)({dir:"rotation"})],As.prototype,"rotationScale",void 0),Po([(0,Yt.Cb)({dir:"rotation",min:0,max:8,step:1})],As.prototype,"rotationFractalLevel",void 0);const K0=/\n/,dc=`
`,q0=/\s/;function Qt(S,h){if(h=h||{},h.width===0&&h.mode!=="nowrap")return[];S=S||"";const l=typeof h.width=="number"?h.width:Number.MAX_VALUE,f=Math.max(0,h.start||0),v=typeof h.end=="number"?h.end:S.length,x=h.mode,b=h.letterSpacing||0,P=h.measure||fc;return x==="pre"?Fs(P,S,f,v,l,b):Tf(P,S,f,v,l,x,b)}function Z0(S,h,l,f){var v=S.indexOf(h,l);return v===-1||v>f?f:v}function Ef(S){return q0.test(S)}function Fs(S,h,l,f,v,x){for(var b=[],P=l,I=l;I<f&&I<h.length;I++){var z=h.charAt(I),Q=K0.test(z);if(Q||I===f-1){var H=Q?I:I+1,ee=S(h,P,H,v,x);b.push(ee),P=I+1}}return b}function Tf(S,h,l,f,v,x,b){var P=[],I=v;for(x==="nowrap"&&(I=Number.MAX_VALUE);l<f&&l<h.length;){for(var z=Z0(h,dc,l,f);l<z&&Ef(h.charAt(l));)l++;var Q=S(h,l,z,I,b),H=l+(Q.end-Q.start),ee=H+dc.length;if(H<z){for(;H>l&&!Ef(h.charAt(H));)H--;if(H===l)ee>l+dc.length&&ee--,H=ee;else for(ee=H;H>l&&Ef(h.charAt(H-dc.length));)H--}if(H>=l){var fe=S(h,l,H,I);P.push(fe)}l=ee}return P}function fc(S,h,l,f){var v=Math.min(f,l-h);return{start:h,end:h+v}}const os=["x","e","a","o","n","s","r","c","u","m","v","w","z"],pc=["m","w"],tr=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],Rn="	".charCodeAt(0),Cf=" ".charCodeAt(0),Ro=0,Cu=1,Pf=2;function Na(S,h,l){l=l||0;for(let f=l;f<S.length;f++)if(S[f].id===h)return f;return-1}function mc(S,h){if(!S.chars||S.chars.length===0)return null;let l=Na(S.chars,h);return l>=0?S.chars[l]:null}function Pu(S){for(let h=0;h<os.length;h++){let l=os[h].charCodeAt(0),f=Na(S.chars,l);if(f>=0)return S.chars[f].height}return 0}function Rf(S){for(let h=0;h<pc.length;h++){let l=pc[h].charCodeAt(0),f=Na(S.chars,l);if(f>=0)return S.chars[f]}return 0}function qh(S){for(let h=0;h<tr.length;h++){let l=tr[h].charCodeAt(0),f=Na(S.chars,l);if(f>=0)return S.chars[f].height}return 0}function Ru(S,h,l){if(!S.kernings||S.kernings.length===0)return 0;let f=S.kernings;for(let v=0;v<f.length;v++){let x=f[v];if(x.first===h&&x.second===l)return x.amount}return 0}function Zh(S){return S==="center"?Cu:S==="right"?Pf:Ro}class Jh{constructor(){B(this,"_width",0);B(this,"_height",0);B(this,"_descender",0);B(this,"_ascender",0);B(this,"_xHeight",0);B(this,"_baseline",0);B(this,"_capHeight",0);B(this,"_lineHeight",0);B(this,"_linesTotal",0);B(this,"_glyphs",[]);B(this,"_fallbackSpaceGlyph",null);B(this,"_fallbackTabGlyph",null);B(this,"_font",null)}get width(){return this._width}get height(){return this._height}get descender(){return this._descender}get ascender(){return this._ascender}get xHeight(){return this._xHeight}get baseline(){return this._baseline}get capHeight(){return this._capHeight}get lineHeight(){return this._lineHeight}get glyphs(){return this._glyphs}get linesTotal(){return this._linesTotal}update(h,l,f){f=Object.assign({tabSize:4,width:0,letterSpacing:0,mode:"nowrap",align:"left"},f),this._font=h;const v=this._computeMetrics.bind(this),x=Qt(l,{measure:v,...f}),b=f.width||0,P=this._glyphs,I=x.reduce((Ae,ke)=>Math.max(Ae,ke.width,b),0),z=f.lineHeight??h.common.lineHeight,Q=h.common.base,H=z-Q,ee=f.letterSpacing||0,fe=z*x.length-H,Se=Zh(f.align),De=f.anchor??[.5,.5];this._setupSpaceGlyphs(h,f),this._width=I,this._height=fe,this._descender=H,this._baseline=Q,this._xHeight=Pu(h),this._capHeight=qh(h),this._lineHeight=z,this._ascender=z-H-this._xHeight;const Re=[-I*De[0],2*z*De[1]-Q];let Te=0,Oe=0;Oe-=fe,P.length=0;for(let Ae=0;Ae<x.length;Ae++){const ke=x[Ae];let lt=ke.start,wt=ke.end,xt=ke.width,Ft;for(let Rt=lt;Rt<wt;Rt++){let on=l.charCodeAt(Rt),Nt=this._getGlyph(h,on);if(Nt){Ft&&(Te+=Ru(h,Ft.id,Nt.id));let In=Te;Se===Cu?In+=(I-xt)/2:Se===Pf&&(In+=I-xt),P.push({position:[In+Re[0],Oe+Re[1]],data:Nt,index:Rt,line:Ae}),Te+=Nt.xadvance+ee,Ft=Nt}}Oe+=z,Te=0}this._linesTotal=x.length}_setupSpaceGlyphs(h,l){if(!h.chars||h.chars.length===0)return;const f=Object.assign({},mc(h,Cf)||Rf(h)||h.chars[0]),v=l.tabSize*f.xadvance;this._fallbackSpaceGlyph=f,this._fallbackTabGlyph=Object.assign(f,{x:0,y:0,xadvance:v,id:Rn,xoffset:0,yoffset:0,width:0,height:0})}_getGlyph(h,l){let f=mc(h,l);return f||(l===Rn?this._fallbackTabGlyph:l===Cf?this._fallbackSpaceGlyph:null)}_computeMetrics(h,l,f,v,x=0){let b=this._font,P=0,I=0,z=0,Q;if(!b.chars||b.chars.length===0)return{start:l,end:l,width:0};f=Math.min(h.length,f);for(let H=l;H<f;H++){let ee=h.charCodeAt(H),fe=this._getGlyph(b,ee);if(fe){fe.xoffset;let Se=Q?Ru(b,Q.id,fe.id):0;P+=Se;let De=P+fe.xadvance+x,Re=P+fe.width;if(Re>=v||De>=v)break;P=De,I=Re,Q=fe}z++}return Q&&(I+=Q.xoffset),{start:l,end:l+z,width:I}}}const Du=2,Pi={min:[0,0],max:[0,0]};function ur(S){const h=S.length/Du;Pi.min[0]=S[0],Pi.min[1]=S[1],Pi.max[0]=S[0],Pi.max[1]=S[1];for(let l=0;l<h;l++){const f=S[l*Du+0],v=S[l*Du+1];Pi.min[0]=Math.min(f,Pi.min[0]),Pi.min[1]=Math.min(v,Pi.min[1]),Pi.max[0]=Math.max(f,Pi.max[0]),Pi.max[1]=Math.max(v,Pi.max[1])}}function J0(S,h){ur(S),h.min.set(Pi.min[0],Pi.min[1],0),h.max.set(Pi.max[0],Pi.max[1],0)}function $h(S,h){ur(S);const l=Pi.min[0],f=Pi.min[1],v=Pi.max[0],x=Pi.max[1],b=v-l,P=x-f,I=Math.sqrt(b*b+P*P);h.center.set(l+b/2,f+P/2,0),h.radius=I/2}class za extends d.u9r{constructor(){super(...arguments);B(this,"layout",new Jh)}update(l,f,v){this.layout.update(l.font,f,v);const{indice:x,position:b,uv:P}=l.build(this.layout,v);this.setIndex(new d.TlE(x,1)),this.setAttribute("position",new d.TlE(b,2)),this.setAttribute("uv",new d.TlE(P,2))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new d.aLr);const l=this.attributes.position.array,f=this.attributes.position.itemSize;if(!l||!f||l.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}$h(l,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new d.ZzF);const l=this.boundingBox,f=this.attributes.position.array,v=this.attributes.position.itemSize;if(!f||!v||f.length<2){l.makeEmpty();return}J0(f,l)}}var gc=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};class Sr extends mt.w{constructor({text:l="",font:f,material:v,...x}){super();B(this,"needsUpdate",!1);B(this,"_text","");B(this,"_font",null);B(this,"_setting",null);this.text=l,this.font=f,this.setting=x,this.node=new d.Kj0(new za,v||f.material),this.node.geometry.update(this.font,this.text,this.setting)}get text(){return this._text}set text(l){this._text!==l&&(this._text=l,this.needsUpdate=!0)}get font(){return this._font}set font(l){this._font!==l&&(this._font=l,this.needsUpdate=!0)}get setting(){return this._setting}set setting(l){JSON.stringify(this._setting)!==JSON.stringify(l)&&(this._setting=l,this.needsUpdate=!0)}get layout(){return this.node.geometry.layout}forceUpdate(){this.node.geometry.update(this.font,this.text,this.setting)}update(l){this.needsUpdate&&(this.needsUpdate=!1,this.forceUpdate())}}gc([(0,Yt.Cb)()],Sr.prototype,"text",null);class $0 extends mt.w{constructor(l){super();B(this,"_scene");B(this,"_label");B(this,"_camera");B(this,"_renderer");B(this,"_cacheURL",{});this.onLoad=()=>{this._scene=new d.xsS,this._label=this.viewer.addNode(new Sr(l),{parent:this._scene}),this._renderer=new d.CP7({alpha:!0}),this._renderer.setPixelRatio(this.viewer.dpr),this._renderer.outputEncoding=d.knz,this._camera=new d.iKG(-1,1,1,-1,-1,1)}}textURL({text:l,scale:f=1}){if(this._cacheURL[l])return this._cacheURL[l];this._label.text=l,this._label.forceUpdate(),this._label.node.scale.set(f,-f,f);const{width:v,height:x}=this._label.layout,b=v*f,P=x*f;return this._camera.left=-b/2,this._camera.right=b/2,this._camera.top=P/2,this._camera.bottom=-P/2,this._camera.updateProjectionMatrix(),this._renderer.setSize(b,P),this._renderer.render(this._scene,this._camera),this._cacheURL[l]=this._renderer.domElement.toDataURL()}}var vc=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};let yc=new d.ZzF,ey=new d.Pa4;class _c extends mt.w{constructor(){super(...arguments);B(this,"_boundingBox",new d.ZzF);B(this,"_probeBox",new d.ZzF);B(this,"_probeCenter",new d.Pa4);B(this,"_boxProjection",!0);B(this,"_needUpdate",!0);B(this,"_debug",!1)}onLoad(){this._boundingBox.setFromObject(this.node),this._probeBox.isEmpty()&&this._probeBox.copy(this._boundingBox);let l=this.viewer.renderer.globalUniforms;l.probePos=new d.Ltg(0,0,0,1),l.probeBoxMin=this._probeBox.min.clone(),l.probeBoxMax=this._probeBox.max.clone();for(let f of Object.values(this.node.meshData.materials))f.isMeshStandardMaterial&&(f.defines.USE_BOX_PROJECTION="")}update(l){if(this._needUpdate){this._needUpdate=!1,yc.copy(this._boundingBox),yc.translate(this.node.getWorldPosition(ey)),yc.union(this._probeBox);let f=this.viewer.renderer.globalUniforms;f.probePos.set(this._probeCenter.x,this._probeCenter.y,this._probeCenter.z,this._boxProjection?1:0),f.probeBoxMin.copy(yc.min),f.probeBoxMax.copy(yc.max)}}get debug(){return this._debug}set debug(l){this._debug=l,this.viewer.emit(zh.ATTACH_HELPER,this._probeBox,l)}get boxProjection(){return this._boxProjection}set boxProjection(l){this._boxProjection=l,this._needUpdate=!0}get probeCenter(){return this._probeCenter}set probeCenter(l){this._probeCenter=l,this._needUpdate=!0}get probeBoxMin(){return this._probeBox.min}set probeBoxMin(l){this._probeBox.min=l,this._needUpdate=!0}get probeBoxMax(){return this._probeBox.max}set probeBoxMax(l){this._probeBox.max=l,this._needUpdate=!0}}vc([(0,Yt.Cb)()],_c.prototype,"debug",null),vc([(0,Yt.Cb)()],_c.prototype,"boxProjection",null),vc([(0,Yt.Cb)({step:.01})],_c.prototype,"probeCenter",null),vc([(0,Yt.Cb)({step:.01})],_c.prototype,"probeBoxMin",null),vc([(0,Yt.Cb)({step:.01})],_c.prototype,"probeBoxMax",null);function no(S,h){let l=S*S,f=2*Math.PI*l,v=Math.pow(16,h)*1.386294361,x=f*(Math.pow(4,h)+f);return d.MathUtils.clamp01(v/x)}const ed=`
uniform samplerCube tLast;
uniform samplerCube tBlur;
uniform float	    uLod;
uniform float	    uWeight;
uniform float       uExposure;
uniform int         uFace;
varying vec2        vUv;

vec3 uvToXYZ(int face, vec2 uv) {
    if(face == 0)       return vec3(     1.f,   uv.y,    -uv.x);
    else if(face == 1)  return vec3(    -1.f,   uv.y,     uv.x);
    else if(face == 2)  return vec3(   +uv.x,   -1.f,    +uv.y);
    else if(face == 3)  return vec3(   +uv.x,    1.f,    -uv.y);
    else if(face == 4)  return vec3(   +uv.x,   uv.y,      1.f);
    else                return vec3(    -uv.x,  +uv.y,     -1.f);
}

vec3 uvToDir(vec2 uv) {
    vec3 dir = normalize(uvToXYZ(uFace, uv * 2. - 1.));
    dir.y = -dir.y;
    return dir;
}

void main() {
    vec3 dir = uvToDir(vUv);
	vec3 col0 = textureLod(tLast, dir, 0.).rgb;
	vec3 col1 = textureLod(tBlur, dir, uLod).rgb * uExposure;
    gl_FragColor = vec4(mix(col0, col1, uWeight), 1.);
}
`,Mr={vertexShader:Dm,blending:d.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1},Ga=7;class yl{constructor(h,l){B(this,"exposure",1);B(this,"blurIntensity",2);B(this,"_viewer");B(this,"_mipmapRenderTargets",[]);B(this,"_cubeRenderTarget");B(this,"_blurMaterial");B(this,"_blurIntensity",-1);B(this,"_blurTexture",{value:null});B(this,"_sigma",2);B(this,"_minLod",0);B(this,"_maxLod",Ga);this._viewer=h,this._cubeRenderTarget=l;const f=Math.min(256,l.width);for(let v=0;v<=Ga;v++)this._mipmapRenderTargets[v]=h.createCubeRenderTarget(f>>v,!1,d.cLu,0,!1);this._blurMaterial=new d.jyz({...Mr,fragmentShader:ed,uniforms:{tLast:{value:null},tBlur:{value:null},uWeight:{value:0},uLod:{value:0},uFace:{value:0},uExposure:{value:1}}})}get blurTexture(){return this._blurTexture}dispose(){for(let h=0;h<this._mipmapRenderTargets.length;h++)this._mipmapRenderTargets[h].dispose()}update(){const h=this._viewer.renderer;this._lodUpdate(this.blurIntensity);let l=this._maxLod;for(let f=0;f<6;f++)this._blur(h,this._mipmapRenderTargets[l],null,this._cubeRenderTarget.texture,1,l,f,0,f);for(;l-- >this._minLod;)for(let f=0;f<6;f++)this._blur(h,this._mipmapRenderTargets[l],this._mipmapRenderTargets[l+1].texture,this._cubeRenderTarget.texture,no(this._sigma,l),l,f,0,f);this._blurTexture.value=this._mipmapRenderTargets[l+1].texture}_lodUpdate(h){if(this._blurIntensity!==h){this._blurIntensity=h,this._sigma=d.MathUtils.lerp(1,40,this._blurIntensity/10);for(let l=0;l<=Ga;l++){let f=no(this._sigma,l);if(f<.002&&(this._minLod=l),f>=1){this._maxLod=l;break}}}}_blur(h,l,f,v,x,b,P,I,z){this._blurMaterial.uniforms.tLast.value=f,this._blurMaterial.uniforms.tBlur.value=v,this._blurMaterial.uniforms.uWeight.value=x,this._blurMaterial.uniforms.uLod.value=b,this._blurMaterial.uniforms.uFace.value=P,this._blurMaterial.uniforms.uExposure.value=this.exposure,Im(h,l,this._blurMaterial,I,z)}}var Df=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};class _l extends mt.w{constructor(l){super();B(this,"_scene");B(this,"_cubeRenderTarget");B(this,"_cubeCamera");B(this,"_mipBlurPass");B(this,"_cubeTexture",{value:null});this._scene=l.scene,this.onLoad=()=>{this._cubeRenderTarget=this.viewer.createCubeRenderTarget(l.resolution||256,!1,!1,0,!0),this._cubeTexture.value=this._cubeRenderTarget.texture,this._cubeCamera=new d._am(l.near||1,l.far||100,this._cubeRenderTarget),this._cubeCamera.layers.set(l.layer||0),this._mipBlurPass=new yl(this.viewer,this._cubeRenderTarget)}}get cubeTexture(){return this._cubeTexture}get blurTexture(){return this._mipBlurPass.blurTexture}get blurIntensity(){return this._mipBlurPass.blurIntensity}set blurIntensity(l){this._mipBlurPass.blurIntensity=l}get exposure(){return this._mipBlurPass.exposure}set exposure(l){this._mipBlurPass.exposure=l}onDestroy(){this._cubeRenderTarget.dispose(),this._mipBlurPass.dispose()}update(l){const f=this.viewer.renderer;this._cubeCamera.update(f,this._scene),this._mipBlurPass.update()}}Df([(0,Yt.Cb)({min:0,max:10,step:.01})],_l.prototype,"blurIntensity",null),Df([(0,Yt.Cb)({min:1,max:20,step:.01})],_l.prototype,"exposure",null);const xc={NORMAL:0,ADD:1,SUB:2,MUL:3};let If=0;class jm{constructor(h="",l="",f=xc.NORMAL,v=[],x={},b={}){B(this,"frag");B(this,"name");B(this,"blend");B(this,"keywords");B(this,"uniforms");B(this,"defines");B(this,"id",""+If++);this.frag=h,this.name=l,this.blend=f,this.keywords=v,this.uniforms=x,this.defines=b}compile(h,l){this.prepare&&this.prepare();let f={};for(let I in this.defines)f[I+this.id]=this.defines[I];this.defines=f;let v={};for(let I in this.uniforms)v[I+this.id]=this.uniforms[I];let x=this.frag,b=this.keywords.concat(["mainImage","mainUv"]);for(let I of b)x=x.replaceAll(I,I+this.id);let P=[/mainUv/.test(this.frag)?this._mainUv():"",/mainImage/.test(this.frag)?this._mainImage(h,l):"",this._blendLayer(h,l)].join(`
`);return{defines:f,uniforms:v,partChunk:x,mainChunk:P}}_mainUv(){return`mainUv${this.id}(uv);`}_mainImage(h,l){return`mainImage${this.id}(${h}, uv, ${l});`}_blendLayer(h,l){switch(this.blend){case xc.NORMAL:return`blendNormal(${h}, ${l});`;case xc.ADD:return`blendAdd(${h}, ${l});`;case xc.SUB:return`blendSub(${h}, ${l});`;case xc.MUL:return`blendMul(${h}, ${l});`;default:return`blendNormal(${h}, ${l});`}}}const ty=`
uniform vec3    uColor;
uniform float   uOpacity;

void mainImage(in vec4 inputColor, in vec2 uv, out vec4 outputColor) {
    outputColor = vec4(uColor, uOpacity);
}
`;class oa extends jm{constructor({color:h,mode:l}){super(ty,"LayerColor",l,["uColor","uOpacity"],{color:h})}}const bc=S=>`
uniform vec3 uOrigin;
uniform vec3 uColorA;
uniform vec3 uColorB;
uniform vec4 uDepthParams;

#define uOpacity    uDepthParams.x
#define uNear       uDepthParams.y
#define uFar        uDepthParams.z

void mainImage(in vec4 inputColor, in vec2 uv, out vec4 outputColor) {
    float fDist = ${S};
    float fDepth = (fDist - uNear) / (uFar - uNear);
    vec3  fDepthColor =  mix(uColorB, uColorA, 1.0 - clamp(fDepth, 0., 1.));
    outputColor = vec4(fDepthColor, uOpacity);
}
`,xl={VECTOR:0,WORLD:1,CAMERA:2};class td extends jm{constructor({blend:l,mapping:f,colorA:v,colorB:x,near:b,far:P}){super("","LayerDepth",l,["uOrigin","uColorA","uColorB","uDepthParams","uOpacity","uNear","uFar"],{colorA:v,colorB:x,near:b,far:P});B(this,"mapping",xl.VECTOR)}prepare(){this.frag=bc(this._depthDistance(this.mapping))}_depthDistance(l){switch(l){case xl.CAMERA:return"length(vWorldPosition - cameraPosition);";case xl.WORLD:return`length(vWorldPosition - uOrigin${this.id});`;case xl.VECTOR:return"length(vPosition);"}}}const Xm=`
varying vec2 vUv;
varying vec3 vPosition;
varying vec3 vWorldPosition;

void main() {
    vec4 worldPosition = modelViewMatrix * vec4(position, 1.0);
    gl_Position = projectionMatrix * worldPosition;
    vWorldPosition = worldPosition.xyz;
    vUv = uv;
}
`,ny=(S,h)=>`
varying vec2 vUv;
varying vec3 vPosition;
varying vec3 vWorldPosition;

void blendNormal(in vec4 inputColor, inout vec4 outputColor) {
    outputColor.rgb = inputColor.rgb * inputColor.a + outputColor.rgb * (1. - inputColor.a);
    outputColor.a   = inputColor.a + outputColor.a * (1. - inputColor.a);
}

void blendAdd(in vec4 inputColor, inout vec4 outputColor) {
    outputColor.rgb = inputColor.rgb * inputColor.a + outputColor.rgb;
    outputColor.a   = inputColor.a + outputColor.a;
}

void blendSub(in vec4 inputColor, inout vec4 outputColor) {
    outputColor.rgb = outputColor.rgb * (1. - inputColor.rgb);
    outputColor.a   = outputColor.a * (1. - inputColor.a);
}

void blendMul(in vec4 inputColor, inout vec4 outputColor) {
    outputColor.rgb = inputColor.rgb * outputColor.rgb;
    outputColor.a   = inputColor.a * outputColor.a;
}

${S}

void main() {
vec2 uv = vUv;
vec4 color0 = vec4(0.,0.,0.,0.);
vec4 color1 = vec4(0.,0.,0.,1.);
${h}
}
`;class wc extends d.jyz{constructor(l=[new oa({color:"#444",opacity:1}),new td({colorA:"blue",colorB:"black",opacity:.5}),new oa({color:"#444",opacity:1})]){super({vertexShader:Xm});B(this,"layers");this.layers=l}onBeforeCompile(l,f){let v={},x={},b=[],P=[],I="color0",z="color1",Q="";for(let H of this.layers){let ee=H.compile(I,z);Object.assign(v,ee.uniforms),Object.assign(x,ee.defines),b.push(ee.partChunk),P.push(ee.mainChunk),Q=I,I=z,z=Q}P.push(`gl_FragColor=${I};`),l.fragmentShader=ny(b.join(`
`),P.join(`
`)),console.log(l.fragmentShader)}}class Hw extends d.Wid{constructor({specularGlossMap:l,...f}={}){super(f);B(this,"envMapIntensity",.45);B(this,"specularGlossMap",null);this.specularGlossMap=l}onBeforeCompile(l,f){l.fragmentShader=l.fragmentShader.replace("#include <map_pars_fragment>",`
            uniform sampler2D specularGlossMap;
            #include <map_pars_fragment>
            `).replace("#include <lights_physical_fragment>",`
            #include <lights_physical_fragment>
            vec4 specGloss = texture2D(specularGlossMap, vUv);
            material.specularColor = specGloss.rgb;
            material.diffuseColor = diffuseColor.rgb * (1. - specGloss.rgb);
            material.roughness = specGloss.a;
        `),l.uniforms.specularGlossMap={value:this.specularGlossMap}}}const iy="SYSTEM_UPDATE",Vw="PARTICLE_CREATED",Ww="PARTICLE_UPDATE",jw="PARTICLE_DEAD",Xw="EMITTER_ADDED",Yw="EMITTER_REMOVED",ry="SYSTEM_UPDATE_AFTER",sy="EULER";function oy(S,h,l){S.sleep||(S.mass!==1&&S.acceleration.multiplyScalar(1/S.mass),S.velocity.add(S.acceleration.multiplyScalar(h)),S.position.add(S.velocity.multiplyScalar(h)),S.acceleration.set(0,0,0))}function Qw(S,h,l,f=sy){switch(f){case sy:oy(S,h);break;default:oy(S,h)}}function Kw(S,h,l){if(S===h)return l?S>>0:S;{let f=S+Math.random()*(h-S);return l?f>>0:f}}class Lf{constructor(h,l){B(this,"a");B(this,"b");B(this,"arr");Array.isArray(h)?this.arr=h:(this.a=h??0,this.b=l??this.a)}getValue(h=!1){return this.arr?this.arr[this.arr.length*Math.random()>>0]:Kw(this.a,this.b,h)}}class ay{constructor(h=1,l=0,f=1){B(this,"_countSpan",null);B(this,"_intervalSpan",null);B(this,"_elapse",0);B(this,"_inteval",0);B(this,"_lastTime",0);B(this,"_repeat",1);B(this,"_repeatCount",1);this._countSpan=Array.isArray(h)?new Lf(h[0],h[1]):new Lf(h),this._intervalSpan=Array.isArray(l)?new Lf(l[0],l[1]):new Lf(l),this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat=f}reset(){this._elapse=0,this._lastTime=0,this._inteval=this._intervalSpan.getValue(),this._repeatCount=this._repeat}getVaue(h){return(this._repeatCount>0||this._repeat<0)&&(this._elapse+=h,this._elapse-this._lastTime>=this._inteval)?(this._lastTime+=this._inteval,this._inteval=this._intervalSpan.getValue(),this._repeatCount--,this._countSpan.getValue(!0)):0}}const{PI:Ym}=Math,Iu={easeLinear:function(S){return S},easeInQuad:function(S){return Math.pow(S,2)},easeOutQuad:function(S){return-(Math.pow(S-1,2)-1)},easeInOutQuad:function(S){return(S/=.5)<1?.5*Math.pow(S,2):-.5*((S-=2)*S-2)},easeInCubic:function(S){return Math.pow(S,3)},easeOutCubic:function(S){return Math.pow(S-1,3)+1},easeInOutCubic:function(S){return(S/=.5)<1?.5*Math.pow(S,3):.5*(Math.pow(S-2,3)+2)},easeInQuart:function(S){return Math.pow(S,4)},easeOutQuart:function(S){return-(Math.pow(S-1,4)-1)},easeInOutQuart:function(S){return(S/=.5)<1?.5*Math.pow(S,4):-.5*((S-=2)*Math.pow(S,3)-2)},easeInSine:function(S){return-Math.cos(S*(Ym/2))+1},easeOutSine:function(S){return Math.sin(S*(Ym/2))},easeInOutSine:function(S){return-.5*(Math.cos(Ym*S)-1)},easeInExpo:function(S){return S===0?0:Math.pow(2,10*(S-1))},easeOutExpo:function(S){return S===1?1:-Math.pow(2,-10*S)+1},easeInOutExpo:function(S){return S===0?0:S===1?1:(S/=.5)<1?.5*Math.pow(2,10*(S-1)):.5*(-Math.pow(2,-10*--S)+2)},easeInCirc:function(S){return-(Math.sqrt(1-S*S)-1)},easeOutCirc:function(S){return Math.sqrt(1-Math.pow(S-1,2))},easeInOutCirc:function(S){return(S/=.5)<1?-.5*(Math.sqrt(1-S*S)-1):.5*(Math.sqrt(1-(S-=2)*S)+1)},easeInBack:function(S){var h=1.70158;return S*S*((h+1)*S-h)},easeOutBack:function(S){var h=1.70158;return(S=S-1)*S*((h+1)*S+h)+1},easeInOutBack:function(S){var h=1.70158;return(S/=.5)<1?.5*(S*S*(((h*=1.525)+1)*S-h)):.5*((S-=2)*S*(((h*=1.525)+1)*S+h)+2)}};function ly(S){return S.constructor.type==="Span"?S.getValue():S}function Of(S,h,l){for(var f in h)S.hasOwnProperty(f)&&(l?l.indexOf(f)<0&&(S[f]=ly(h[f])):S[f]=ly(h[f]));return S}function qw(S,h){for(let l in h)if(S.hasOwnProperty(l)){let f=S[l];f&&f.copy?f.copy(h[l]):S[l]=h[l]}return S}const{clamp:f2,clamp01:Zw}=d.MathUtils;class Qm{constructor(h){B(this,"index",0);B(this,"age",0);B(this,"life",1/0);B(this,"energy",1);B(this,"progress",0);B(this,"dead",!1);B(this,"sleep",!1);B(this,"delay",0);B(this,"acceleration",new d.Pa4);B(this,"scale",new d.Pa4(1,1,1));B(this,"position",new d.Pa4);B(this,"velocity",new d.Pa4);B(this,"rotation",new d.USm);B(this,"behaviours",[]);B(this,"parent",null);B(this,"color",new d.Ilk);B(this,"alpha",1);B(this,"mass",1);B(this,"easing",Iu.easeLinear);B(this,"transform",{});B(this,"rand",new d.Pa4);Of(this,h)}reset(){return this.age=0,this.life=1/0,this.energy=1,this.progress=0,this.dead=!1,this.sleep=!1,this.delay=0,this.acceleration.set(0,0,0),this.scale.set(1,1,1),this.position.set(0,0,0),this.velocity.set(0,0,0),this.rotation.set(0,0,0),this.parent=null,this.color.setRGB(1,1,1),this.alpha=1,this.mass=1,this.easing=Iu.easeLinear,this.rand.set(0,0,0),this.removeAllBehaviours(),this}destroy(){return this.dead=!0,this.parent=null,this}update(h){if(this.sleep||this.dead)return!1;if(this.delay>0)return this.delay-=h,!1;if(this.age+=h,this.age>this.life)if(this.energy>0)this.energy=0,this.progress=1;else return this.destroy(),!1;else this.progress=this.easing(Zw(this.age/this.life)),this.energy=1-this.progress;for(let l=this.behaviours.length;l--;)this.behaviours[l].applyBehaviour(this,h,this.progress);return!0}addBehaviour(...h){for(let l of h)this.behaviours.push(l),l.initialize(this)}removeBehaviour(h){let l=this.behaviours.indexOf(h);l>-1&&this.behaviours.splice(l,1)}removeAllBehaviours(){this.behaviours.length=0}}const Jw=new yn(null,new d.Ltg,new d.Ltg);class cy{constructor(h={}){B(this,"spriteFrame",Jw);B(this,"count",1);B(this,"interval",0);B(this,"repeat",1);B(this,"billboard",!0);B(this,"behaviours",[]);Of(this,h)}}const{clamp:$w}=d.MathUtils,uy={count:1};class e1 extends Qm{constructor(l){super();B(this,"rate",new ay(1,.1));B(this,"playing",!1);B(this,"particles",[]);B(this,"damping",.006);B(this,"controller",new cy);Of(this,l),this.initialize(this.controller)}initialize({count:l,interval:f,repeat:v,behaviours:x}){this.rate=new ay(l,f,v),this.behaviours=x}update(l){return this.sleep||this.dead?!1:(this.age+=l,this.age>this.life&&this.particles.length==0&&this.destroy(),this.playing&&this.generate(l),this.particles.length>0&&this.integrate(l),!0)}integrate(l){var x,b,P;1-this.damping;let f,v=$w(l*60,.5,1.5);for(let I=this.particles.length;I--;)f=this.particles[I],f.update(l)&&((x=this.parent)==null||x.emit(Ww,f),this.controller.onParticleUpdate&&this.controller.onParticleUpdate(f),Qw(f,v)),f.dead&&(this.particles.splice(I,1),(b=this.parent)==null||b.pool.expire(f),(P=this.parent)==null||P.emit(jw,f))}createParticle(l){var v;let f=this.parent.pool.get(Qm);f.reset(),f.addBehaviour(...this.behaviours),f.parent=this,f.index=this.particles.length,this.particles.push(f),(v=this.parent)==null||v.emit(Vw,f),this.controller.onParticleCreate&&this.controller.onParticleCreate(f,l)}generate(l){for(let f=uy.count=this.rate.getVaue(l);f--;)this.createParticle(uy)}emit(l){for(let f=l.count=Math.max(1,l.count);f--;)this.createParticle(l)}play(){this.playing=!0,this.rate.reset()}stop(){this.playing=!1}}class t1{constructor(){B(this,"list",[])}get(h){return this.list.length>0?this.list.pop():new h}expire(h){this.list.push(h)}}var hy=function(S,h,l,f){var v=arguments.length,x=v<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(S,h,l,f);else for(var P=S.length-1;P>=0;P--)(b=S[P])&&(x=(v<3?b(x):v>3?b(h,l,x):b(h,l))||x);return v>3&&x&&Object.defineProperty(h,l,x),x};class Km extends mt.w{constructor(){super(...arguments);B(this,"name","ParticleSystem-"+this.uuid);B(this,"playing",!1);B(this,"pool",new t1);B(this,"emitters",[]);B(this,"renderers",[])}addEmitter(l){return l.parent=this,this.emitters.push(l),this.emit(Xw,l),this}removeEmitter(l){return l.parent!==this?this:(l.parent=null,this.emitters.splice(this.emitters.indexOf(l),1),this.emit(Yw,l),this)}addRenderer(l){return this.renderers.push(l.init(this)),this}removeRenderer(l){return this.renderers.splice(this.renderers.indexOf(l.reset()),1),this}play(){for(let l=this.emitters.length;l--;)this.emitters[l].play();return this.playing=!0,this}stop(){return this.playing=!1,this}update(l){if(!this.playing)return;let f;for(let v=this.emitters.length;v--;)f=this.emitters[v],f.update(l),f.particles.length&&this.emit(iy,this);this.emit(ry,this)}getCount(){let l=0;for(let f=this.emitters.length;f--;)l+=this.emitters[f].particles.length;return l}onDestroy(){for(let l=this.emitters.length;l--;)this.emitters[l].destroy();for(let l=this.renderers.length;l--;)this.renderers[l].destroy();this.emitters.length=0,this.renderers.length=0}}hy([(0,Yt.Cb)()],Km.prototype,"play",null),hy([(0,Yt.Cb)()],Km.prototype,"stop",null);class nd{constructor(h=!0){B(this,"enabled");this.enabled=h}applyBehaviour(h,l,f){this.enabled&&this.mutate(h,l,f)}initialize(h){}mutate(h,l,f){}}class n1 extends nd{constructor(l=1,f,v=Iu.easeLinear,x){super(x);B(this,"alphaA");B(this,"alphaB");B(this,"easing");this.alphaA=l,this.alphaB=f,this.easing=v}initialize(l){l.transform.alphaA=this.alphaA,l.transform.alphaB=this.alphaB}mutate(l,f,v){l.alpha=l.transform.alphaB!==void 0?d.MathUtils.lerp(l.transform.alphaA,l.transform.alphaB,this.easing(v)):l.transform.alphaA}}class i1 extends nd{constructor(l=new d.Ilk,f,v=Iu.easeLinear,x){super(x);B(this,"colorA");B(this,"colorB");B(this,"easing");this.colorA=l,this.colorB=f,this.easing=v}initialize(l){var f;l.transform.colorA=this.colorA.clone(),l.transform.colorB=(f=this.colorB)==null?void 0:f.clone()}mutate(l,f,v){l.color.copy(l.transform.colorA),l.transform.colorB&&l.color.lerp(l.transform.colorB,this.easing(v))}}class dy extends nd{constructor(l=new d.Pa4,f){super(f);B(this,"force");this.force=l,this.force.multiplyScalar(100)}initialize(l){l.transform.force=this.force.clone()}mutate(l,f,v){l.acceleration.add(l.transform.force)}}class r1 extends dy{constructor(l=10,f){super(new d.Pa4(0,-l,0),f);B(this,"gravity");this.gravity=l}}class s1 extends nd{constructor(l=new d.Pa4,f,v=Iu.easeLinear,x){super(x);B(this,"scaleA");B(this,"scaleB");B(this,"easing");this.scaleA=l,this.scaleB=f,this.easing=v}initialize(l){var f;l.transform.scaleA=this.scaleA.clone(),l.transform.scaleB=(f=this.scaleB)==null?void 0:f.clone()}mutate(l,f,v){l.scale.copy(l.transform.scaleA),l.transform.scaleB&&l.scale.lerp(l.transform.scaleB,this.easing(v))}}class fy extends d.Kj0{constructor(){super(...arguments);B(this,"system")}init(l){return this.system=l,this.system.node.add(this),this.system.on(iy,this.onSystemUpdate,this),this.system.on(ry,this.onSystemUpdateAfter,this),this}reset(){return this.system&&(this.system.targetOff(this),this.system.node.remove(this),this.system=void 0),this}destroy(){}onSystemUpdate(l){}onSystemUpdateAfter(l){}}const o1=`
precision highp float;
attribute vec4 texCoords;
attribute vec4 meshCoords;
attribute vec3 spritePos;
attribute vec4 spriteQuat;
attribute vec4 spriteColor;
attribute vec2 decorators;

varying vec2 vUv;
varying vec4 vColor;

#include <xv_matrix>

mat2 makeRotateMatrix(in float rad) {
    float c = cos(rad);
    float s = sin(rad);
    return mat2(c,-s,s,c);
}

void main() {
    vColor = spriteColor;
    vUv = uv * texCoords.zw + texCoords.xy;
    vUv.y = 1. - vUv.y;

    mat4 instanceMatrix = getInstanceMatrix(spritePos, spriteQuat, vec3(1.));
    mat4 mvMatrix = modelViewMatrix * instanceMatrix;

    vec4 transformed = vec4(position,1.);
    transformed.xy = transformed.xy * meshCoords.zw + meshCoords.xy;

    vec4 mvPosition = mvMatrix * transformed;
    vec4 bbPosition = mvMatrix * vec4(0.,0.,0.,1.);
    vec2 scale = vec2(length(mvMatrix[0].xyz), length(mvMatrix[1].xyz));
    bbPosition.xy += makeRotateMatrix(spriteQuat.x) * transformed.xy * scale;
    mvPosition = mix(mvPosition, bbPosition, decorators.x);
    
    gl_Position = projectionMatrix * mvPosition;
}
`,a1=`
precision highp float;
uniform sampler2D map;
varying vec2 vUv;
varying vec4 vColor;

float luma(vec3 color) { return dot(color, vec3(0.299, 0.587, 0.114)); }

void main() {
    vec4 color = texture2D(map, vUv);
    float shape = color.r;

#ifdef USE_ALPHA_SDF
#ifdef IS_ADDITIVE_BLENDING
    float l = vColor.a * luma(vColor.rgb);
    shape = max(smoothstep(0.48, 0.52, shape), shape * l);
#else
    shape = smoothstep(0.48, 0.52, shape);
#endif
#endif

    float alpha = color.a * vColor.a;
    vec3 col = vColor.rgb * vColor.a * shape;
    gl_FragColor = vec4(col, alpha * shape);
}
`,py={blending:d.WMw,depthTest:!0,depthWrite:!1,transparent:!0,maxParticles:200},qm=new d._12;let Lu=new d._fP;class l1 extends fy{constructor(l=py){super();B(this,"stride",21);B(this,"buffer");B(this,"interleavedBuffer");B(this,"geometry",new d.L5s);B(this,"renderMode",0);const{blending:f,useAlphaSDF:v,depthTest:x,depthWrite:b,transparent:P,maxParticles:I,map:z,frustumCulled:Q,...H}={...py,...l},ee=new d.jyz({uniforms:{map:{value:z}},defines:{USE_ALPHA_SDF:!!v,IS_ADDITIVE_BLENDING:f===d.WMw},vertexShader:o1,fragmentShader:a1,blending:f,depthTest:x,depthWrite:b,transparent:P});let fe=new Float32Array(I*this.stride),Se=new d.$TI(fe,this.stride),De=new d.L5s;De.index=qm.index,De.attributes.position=qm.attributes.position,De.attributes.uv=qm.attributes.uv,De.setAttribute("texCoords",new d.kB5(Se,4,0,!1)),De.setAttribute("meshCoords",new d.kB5(Se,4,4,!1)),De.setAttribute("spritePos",new d.kB5(Se,3,8,!1)),De.setAttribute("decorators",new d.kB5(Se,2,11,!1)),De.setAttribute("spriteQuat",new d.kB5(Se,4,13,!1)),De.setAttribute("spriteColor",new d.kB5(Se,4,17,!1)),this.buffer=fe,this.interleavedBuffer=Se,this.interleavedBuffer.setUsage(d.dj0),this.geometry=De,this.material=ee,this.frustumCulled=Q??!1,Ge(this,H)}onSystemUpdateAfter(l){let f=0,v=l.emitters;for(let x=v.length;x--;){let b=v[x].particles;for(let P=b.length;P--;)this.commitInstanceBuffer(b[P],f++*this.stride)}this.interleavedBuffer.needsUpdate=!0,this.geometry.instanceCount=f,this.visible=f>0}commitInstanceBuffer(l,f=0){let{position:v,rotation:x,scale:b,color:P}=l,{billboard:I,spriteFrame:z}=l.parent.controller,{texCoords:Q,meshCoords:H}=z;I?Lu.x=x.x:Lu.setFromEuler(x);let ee=this.buffer;ee[f++]=Q.x,ee[f++]=Q.y,ee[f++]=Q.z,ee[f++]=Q.w,ee[f++]=H.x*b.x,ee[f++]=H.y*b.y,ee[f++]=H.z*b.x,ee[f++]=H.w*b.y,ee[f++]=v.x,ee[f++]=v.y,ee[f++]=v.z,ee[f++]=I?1:0,ee[f++]=0,ee[f++]=Lu.x,ee[f++]=Lu.y,ee[f++]=Lu.z,ee[f++]=Lu.w,ee[f++]=P.r,ee[f++]=P.g,ee[f++]=P.b,ee[f++]=l.alpha}}function Zm(S){return S>1e3?Math.floor(S*.001)+"k":S>1e6?Math.floor(S*1e-6)+"m":S}var Ac=function(S,h,l){var f=1/0,v=0,x=Math.round,b=x(window.devicePixelRatio||1),P=80*b,I=48*b,z=3*b,Q=2*b,H=3*b,ee=15*b,fe=74*b,Se=30*b,De=document.createElement("canvas");De.width=P,De.height=I,De.style.cssText="width:80px;height:48px";var Re=De.getContext("2d");return Re.font="bold "+9*b+"px Helvetica,Arial,sans-serif",Re.textBaseline="top",Re.fillStyle=l,Re.fillRect(0,0,P,I),Re.fillStyle=h,Re.fillText(S,z,Q),Re.fillRect(H,ee,fe,Se),Re.fillStyle=l,Re.globalAlpha=.9,Re.fillRect(H,ee,fe,Se),{dom:De,update:function(Te,Oe){f=Math.min(f,Te),v=Math.max(v,Te),Re.fillStyle=l,Re.globalAlpha=1,Re.fillRect(0,0,P,ee),Re.fillStyle=h,Re.fillText(Zm(x(Te))+" "+S+" ("+Zm(x(f))+"-"+Zm(x(v))+")",z,Q),Re.drawImage(De,H+b,ee,fe-b,Se,H,ee,fe-b,Se),Re.fillRect(H+fe-b,ee,b,Se),Re.fillStyle=l,Re.globalAlpha=.9,Re.fillRect(H+fe-b,ee,b,x((1-Te/Oe)*Se))}}},c1=function(){var S=0,h=document.createElement("div");h.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",h.addEventListener("click",function(Q){Q.preventDefault(),f(++S%h.children.length)},!1);function l(Q){return h.appendChild(Q.dom),Q}function f(Q){for(var H=0;H<h.children.length;H++)h.children[H].style.display=H===Q?"block":"none";S=Q}var v=(performance||Date).now(),x=v,b=0,P=l(new Ac("FPS","#0ff","#002")),I=l(new Ac("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var z=l(new Ac("MB","#f08","#201"));return f(0),{REVISION:16,dom:h,addPanel:l,showPanel:f,begin:function(){v=(performance||Date).now()},end:function(){b++;var Q=(performance||Date).now();if(I.update(Q-v,200),Q>=x+1e3&&(P.update(b*1e3/(Q-x),100),x=Q,b=0,z)){var H=performance.memory;z.update(H.usedJSHeapSize/1048576,H.jsHeapSizeLimit/1048576)}return Q},update:function(){v=this.end()},domElement:h,setMode:f}};class u1 extends Bh.S{constructor(){super(...arguments);B(this,"_stats",new c1);B(this,"_dcPanel",new Ac("DC","#ff8","#221"));B(this,"_triPanel",new Ac("TRI","#ff8","#221"));B(this,"_texPanel",new Ac("TEX","#ff8","#221"));B(this,"_prgPanel",new Ac("PRG","#ff8","#221"))}onLoad(){this._stats.addPanel(this._dcPanel),this._stats.addPanel(this._texPanel),this._stats.addPanel(this._triPanel),this._stats.addPanel(this._prgPanel),this._stats.showPanel(0),document.body.appendChild(this._stats.dom)}update(l){let f=this.viewer.renderer.info;this._dcPanel.update(f.render.calls,300),this._triPanel.update(f.render.triangles,5e5),this._texPanel.update(f.memory.textures,200),this._prgPanel.update(f.programs.length,50),this._stats.update()}}},992:(t,i,r)=>{r.d(i,{S:()=>p});var o=r(591);class p extends o.w{constructor(){super(...arguments);B(this,"isPlugin",!0)}}},477:(t,i,r)=>{r.d(i,{LY2:()=>su,bGH:()=>vt,NDo:()=>zr,gSk:()=>br,WMw:()=>Be,OTo:()=>Eh,Se2:()=>vo,cum:()=>Qo,Mig:()=>fS,i_9:()=>WI,m7l:()=>lp,sYA:()=>DI,Xcj:()=>cL,mzJ:()=>oL,ZZA:()=>TI,T__:()=>DA,HkE:()=>iA,tGC:()=>DL,BbS:()=>MS,kqm:()=>qI,Hmr:()=>s_,SJI:()=>YI,mTL:()=>HI,y8_:()=>IL,_Li:()=>ce,z81:()=>bm,_MY:()=>Z,N$j:()=>Dy,_YM:()=>Hu,TUj:()=>vL,ZzF:()=>_s,GQ:()=>PL,nvb:()=>UL,DvJ:()=>za,fQA:()=>CL,TlE:()=>ci,u9r:()=>Rn,s4_:()=>vS,T95:()=>wh,CtF:()=>Ec,V1s:()=>ed,Rki:()=>TL,ROQ:()=>ZD,YN5:()=>NL,BVQ:()=>Wf,YT8:()=>IA,YGz:()=>Ql,trn:()=>zL,zf8:()=>jf,uWy:()=>Bi,SUY:()=>wS,Ilk:()=>Ut,R2R:()=>Jy,epp:()=>ai,Z_g:()=>qD,EB7:()=>Fy,DqL:()=>II,_3:()=>GL,b_z:()=>Xf,_am:()=>Df,fY$:()=>yo,vxC:()=>_o,BtG:()=>_l,cBK:()=>LI,g8_:()=>yr,AXT:()=>zy,yj7:()=>OA,dYG:()=>nS,tm_:()=>k,S2y:()=>X,B02:()=>$,PeU:()=>L,Hyl:()=>ca,Wqd:()=>BA,Xaj:()=>Ct,dZ3:()=>ou,m_w:()=>HL,fHI:()=>Uu,LBq:()=>gL,JUT:()=>fl,p3g:()=>Su,IEO:()=>dd,yxD:()=>OI,A5E:()=>kL,jfJ:()=>Is,T_J:()=>Am,tEQ:()=>sS,qkB:()=>Kn,brP:()=>ki,$YQ:()=>rA,Ox3:()=>dS,cBI:()=>EL,cU9:()=>iS,ntt:()=>sf,DT1:()=>VL,Kgo:()=>Yf,ehD:()=>ie,fSK:()=>fi,Vdb:()=>Ds,l8J:()=>T0,dj0:()=>A0,QM0:()=>cf,TOt:()=>kA,Ny0:()=>pg,eD:()=>vr,jwo:()=>Ta,dSO:()=>Ho,Bf4:()=>zn,USm:()=>na,pBf:()=>Ko,$Vf:()=>WL,O7d:()=>Zf,hH6:()=>Ml,e62:()=>q0,a$l:()=>Qt,OM3:()=>Z0,VzW:()=>js,ybr:()=>ig,yo9:()=>ng,Wzm:()=>KD,Wl3:()=>$e,iWj:()=>td,ylh:()=>fL,v9Y:()=>Em,LSk:()=>uf,w$m:()=>G,ksN:()=>ru,j4z:()=>gu,OAl:()=>lf,VLJ:()=>SL,ZAu:()=>ad,cLu:()=>Aa,vmT:()=>oS,Qpg:()=>AL,So8:()=>VI,Wjw:()=>jL,cJO:()=>Jf,QRU:()=>GI,S3k:()=>cp,PpQ:()=>Vh,ZRs:()=>x0,oqc:()=>ic,lb7:()=>fd,L5s:()=>gS,$TI:()=>dL,SPe:()=>bA,aVm:()=>Wm,j87:()=>K0,RNb:()=>Q0,Kz5:()=>hu,vpT:()=>rg,kB5:()=>ku,_C8:()=>sp,Syv:()=>oi,NMF:()=>yi,pIN:()=>xr,eMJ:()=>Sm,x5V:()=>mu,tUh:()=>ua,z8B:()=>dA,GZb:()=>XL,p7y:()=>pd,S9g:()=>ka,Zr5:()=>Hs,vCF:()=>nl,yt0:()=>b0,uXU:()=>af,_kC:()=>Tc,lk7:()=>Ag,x12:()=>Mc,Zzh:()=>yL,nls:()=>Es,g_z:()=>gg,U7:()=>FA,FT0:()=>eS,blk:()=>TA,ejS:()=>Xa,rnI:()=>Ea,wem:()=>Ci,lfu:()=>Zy,FDw:()=>rf,lRj:()=>nf,D1R:()=>xo,qyh:()=>cu,GUF:()=>nc,EoG:()=>Yl,aNw:()=>so,Zp0:()=>r_,lLk:()=>$y,jAl:()=>Cn,uEv:()=>Ot,YKA:()=>qn,cRx:()=>Pn,Y8D:()=>Th,RsA:()=>d,F5T:()=>Ir,u7G:()=>Sg,M8C:()=>z0,Vkp:()=>Ar,yGw:()=>Mn,Sm8:()=>$r,Kj0:()=>ur,vBJ:()=>Ua,lRF:()=>My,Lun:()=>Ey,YBo:()=>JA,kaV:()=>$A,RSm:()=>ZA,xoR:()=>KA,EJi:()=>QA,Wid:()=>Yy,IKL:()=>qA,r_:()=>Fi,OoA:()=>wa,qhX:()=>lr,M5h:()=>Ie,Ns1:()=>Qi,TyD:()=>Ti,vZf:()=>lu,HTd:()=>au,aH4:()=>_r,YLQ:()=>ql,BVF:()=>gs,MyG:()=>of,jFi:()=>re,aCh:()=>Lh,uL9:()=>Gr,IFH:()=>Ki,bdR:()=>ve,M6v:()=>Xl,RvT:()=>w0,dUE:()=>op,Tme:()=>Gn,Gql:()=>NI,PA7:()=>tc,REq:()=>YL,pQR:()=>gd,ghN:()=>gr,Hy8:()=>wi,Wpd:()=>es,LgZ:()=>yn,iWC:()=>mt,iKG:()=>Ee,_iA:()=>ge,ntZ:()=>be,anP:()=>un,y$t:()=>Vf,cPb:()=>Mr,JOQ:()=>oa,BKK:()=>QL,_12:()=>wc,tJx:()=>RL,cek:()=>hS,xG9:()=>bL,woe:()=>PA,UY4:()=>Ly,aq0:()=>ML,ujx:()=>KL,Uol:()=>Al,VYz:()=>KI,iUV:()=>Xn,tf:()=>TS,ZQ6:()=>Gy,mXe:()=>Hy,_fP:()=>Vr,iLg:()=>yd,zbs:()=>rS,ZTh:()=>at,HdW:()=>He,UZH:()=>y,mSO:()=>wm,wk1:()=>Hr,E2K:()=>Ih,FUD:()=>T,pKu:()=>Xo,GG6:()=>Ao,Gih:()=>Pt,iiP:()=>q,SvJ:()=>he,ptH:()=>Sa,jZA:()=>ll,y2t:()=>cl,gi4:()=>Wo,Djp:()=>fu,BG$:()=>Ma,NYV:()=>jo,xJs:()=>wo,bsb:()=>Ce,ekQ:()=>bo,CaW:()=>ec,eaV:()=>$l,BFQ:()=>il,v3W:()=>rl,ILR:()=>sl,fto:()=>ol,l0P:()=>al,vCx:()=>Jl,_AM:()=>du,wuA:()=>Zl,av9:()=>Rh,CtA:()=>Dh,FIo:()=>YA,zHn:()=>jn,iMs:()=>pL,T_f:()=>pS,hEm:()=>Ch,D9w:()=>Ph,CdI:()=>bh,rpg:()=>Vs,ce8:()=>_0,rOj:()=>Oi,V4E:()=>qL,o8S:()=>$f,lGU:()=>zt,vuL:()=>Ze,KI_:()=>Ys,xsS:()=>oA,WdD:()=>En,Vj0:()=>jr,jyz:()=>no,Tn7:()=>XA,bnF:()=>Nu,HW6:()=>ZL,oa8:()=>ep,T_1:()=>LL,iDF:()=>Ya,iAb:()=>Ah,OdW:()=>cg,_YX:()=>xL,TUv:()=>vA,Hw6:()=>Da,aLr:()=>ml,Aip:()=>JL,xo$:()=>vd,$V:()=>mL,lDi:()=>mS,gti:()=>Vy,PMe:()=>cS,FvO:()=>_L,jyi:()=>uA,xeV:()=>Py,k74:()=>tn,RlZ:()=>ba,KhW:()=>ms,HgB:()=>E0,W2J:()=>vu,JWc:()=>Mm,u37:()=>jI,Z6B:()=>C0,QZ1:()=>S0,Ir4:()=>M0,NwF:()=>Vu,Wbm:()=>Sn,N4l:()=>Ge,QmN:()=>E,IOt:()=>Yo,L5g:()=>$L,H$k:()=>tp,xEZ:()=>ri,dpR:()=>FI,Cne:()=>eO,XvJ:()=>np,XZw:()=>tO,FE5:()=>ip,CJI:()=>Os,z$h:()=>v0,UlW:()=>g0,WwZ:()=>pu,Lcc:()=>nO,WXh:()=>rp,ub3:()=>U,xfE:()=>Kl,qlB:()=>As,lCJ:()=>dc,WTc:()=>Po,rAo:()=>Vm,xWb:()=>l_,gH0:()=>hL,rBU:()=>Et,rDY:()=>yc,ywz:()=>ts,wJv:()=>Vo,JQ4:()=>Ws,k0A:()=>Sh,irR:()=>Mh,LsT:()=>uu,dwk:()=>ye,FM8:()=>it,Pa4:()=>le,Ltg:()=>Zn,yC1:()=>ap,fO1:()=>QD,b5g:()=>sA,Ywn:()=>Zo,GVz:()=>Fm,oAp:()=>xc,kFz:()=>sc,dd2:()=>Ls,CP7:()=>Cy,fQK:()=>nA,Uk6:()=>WA,_sL:()=>So,Pnf:()=>_i,c8b:()=>Ei,_lf:()=>Xs,ad5:()=>y0,L_r:()=>yu,knz:()=>pi});var o={};r.r(o),r.d(o,{ArcCurve:()=>DA,CatmullRomCurve3:()=>IA,CubicBezierCurve:()=>zy,CubicBezierCurve3:()=>OA,EllipseCurve:()=>pg,LineCurve:()=>gg,LineCurve3:()=>FA,QuadraticBezierCurve:()=>Gy,QuadraticBezierCurve3:()=>Hy,SplineCurve:()=>Vy});var p={};r.r(p),r.d(p,{BoxGeometry:()=>za,CapsuleGeometry:()=>Wf,CircleGeometry:()=>jf,ConeGeometry:()=>Xf,CylinderGeometry:()=>Uu,DodecahedronGeometry:()=>Yf,EdgesGeometry:()=>kA,ExtrudeGeometry:()=>Zf,IcosahedronGeometry:()=>Jf,LatheGeometry:()=>pd,OctahedronGeometry:()=>gd,PlaneGeometry:()=>wc,PolyhedronGeometry:()=>Al,RingGeometry:()=>$f,ShapeGeometry:()=>ep,SphereGeometry:()=>vd,TetrahedronGeometry:()=>tp,TorusGeometry:()=>np,TorusKnotGeometry:()=>ip,TubeGeometry:()=>rp,WireframeGeometry:()=>WA});const y="150",d={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},E={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},L=0,k=1,X=2,$=3,Z=0,ge=1,be=2,ye=3,$e=0,ce=1,ie=2,U=2,re=0,ve=1,Be=2,Ge=3,Ie=4,Ct=5,vt=100,Sn=101,Oi=102,Fi=103,$r=104,Ei=200,gr=201,ms=202,mt=203,tn=204,yn=205,fi=206,wi=207,Ds=208,es=209,ba=210,gs=0,vo=1,Hs=2,nl=3,vr=4,ru=5,G=6,Xl=7,Qi=0,lr=1,zr=2,Gr=0,Yl=1,bh=2,Ql=3,su=4,ou=5,Kl=300,yo=301,_o=302,Ho=303,zn=304,yr=306,Vs=1e3,Bi=1001,wa=1002,Ti=1003,ql=1004,au=1004,_r=1005,lu=1005,Ci=1006,cu=1007,nf=1007,xo=1008,rf=1008,ts=1009,wh=1010,Ah=1011,uu=1012,hu=1013,Ws=1014,js=1015,Aa=1016,Sh=1017,Mh=1018,Vo=1020,Eh=1021,Hr=1023,Th=1024,Pn=1025,Kn=1026,ki=1027,Ch=1028,Ph=1029,Rh=1030,Dh=1031,Ih=1033,Zl=33776,il=33777,rl=33778,sl=33779,du=35840,Jl=35841,$l=35842,ec=35843,ol=36196,al=37492,bo=37496,Sa=37808,ll=37809,cl=37810,Wo=37811,fu=37812,Ma=37813,jo=37814,wo=37815,Xo=37816,Ao=37817,Pt=37818,T=37819,q=37820,he=37821,Ce=36492,He=36283,Ze=36284,at=36285,zt=36286,Cn=2200,qn=2201,Ot=2202,oi=2300,yi=2301,xr=2302,_i=2400,Xs=2401,So=2402,Ki=2500,br=2501,pu=0,g0=1,v0=2,Ea=3e3,pi=3001,bm=3200,wm=3201,Yo=0,tc=1,Lh="",Ys="srgb",nc="srgb-linear",sf="display-p3",y0=0,mu=7680,_0=7681,x0=7682,Is=7683,ic=34055,Am=34056,Sm=5386,of=512,af=513,Ta=514,b0=515,lf=516,w0=517,gu=518,Qo=519,vu=35044,A0=35048,S0=35040,Mm=35045,cf=35049,M0=35041,E0=35046,T0=35050,C0=35042,Em="100",uf="300 es",yu=1035;class Ko{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[e]===void 0&&(s[e]=[]),s[e].indexOf(n)===-1&&s[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const s=this._listeners;return s[e]!==void 0&&s[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const a=this._listeners[e];if(a!==void 0){const c=a.indexOf(n);c!==-1&&a.splice(c,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const s=this._listeners[e.type];if(s!==void 0){e.target=this;const a=s.slice(0);for(let c=0,m=a.length;c<m;c++)a[c].call(this,e);e.target=null}}}class Vr{constructor(e=0,n=0,s=0,a=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=s,this._w=a}static slerpFlat(e,n,s,a,c,m,g){let _=s[a+0],w=s[a+1],A=s[a+2],C=s[a+3];const M=c[m+0],R=c[m+1],F=c[m+2],D=c[m+3];if(g===0){e[n+0]=_,e[n+1]=w,e[n+2]=A,e[n+3]=C;return}if(g===1){e[n+0]=M,e[n+1]=R,e[n+2]=F,e[n+3]=D;return}if(C!==D||_!==M||w!==R||A!==F){let O=1-g;const W=_*M+w*R+A*F+C*D,K=W>=0?1:-1,V=1-W*W;if(V>Number.EPSILON){const se=Math.sqrt(V),ue=Math.atan2(se,W*K);O=Math.sin(O*ue)/se,g=Math.sin(g*ue)/se}const Y=g*K;if(_=_*O+M*Y,w=w*O+R*Y,A=A*O+F*Y,C=C*O+D*Y,O===1-g){const se=1/Math.sqrt(_*_+w*w+A*A+C*C);_*=se,w*=se,A*=se,C*=se}}e[n]=_,e[n+1]=w,e[n+2]=A,e[n+3]=C}static multiplyQuaternionsFlat(e,n,s,a,c,m){const g=s[a],_=s[a+1],w=s[a+2],A=s[a+3],C=c[m],M=c[m+1],R=c[m+2],F=c[m+3];return e[n]=g*F+A*C+_*R-w*M,e[n+1]=_*F+A*M+w*C-g*R,e[n+2]=w*F+A*R+g*M-_*C,e[n+3]=A*F-g*C-_*M-w*R,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,s,a){return this._x=e,this._y=n,this._z=s,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const s=e._x,a=e._y,c=e._z,m=e._order,g=Math.cos,_=Math.sin,w=g(s/2),A=g(a/2),C=g(c/2),M=_(s/2),R=_(a/2),F=_(c/2);switch(m){case"XYZ":this._x=M*A*C+w*R*F,this._y=w*R*C-M*A*F,this._z=w*A*F+M*R*C,this._w=w*A*C-M*R*F;break;case"YXZ":this._x=M*A*C+w*R*F,this._y=w*R*C-M*A*F,this._z=w*A*F-M*R*C,this._w=w*A*C+M*R*F;break;case"ZXY":this._x=M*A*C-w*R*F,this._y=w*R*C+M*A*F,this._z=w*A*F+M*R*C,this._w=w*A*C-M*R*F;break;case"ZYX":this._x=M*A*C-w*R*F,this._y=w*R*C+M*A*F,this._z=w*A*F-M*R*C,this._w=w*A*C+M*R*F;break;case"YZX":this._x=M*A*C+w*R*F,this._y=w*R*C+M*A*F,this._z=w*A*F-M*R*C,this._w=w*A*C-M*R*F;break;case"XZY":this._x=M*A*C-w*R*F,this._y=w*R*C-M*A*F,this._z=w*A*F+M*R*C,this._w=w*A*C+M*R*F;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+m)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const s=n/2,a=Math.sin(s);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,s=n[0],a=n[4],c=n[8],m=n[1],g=n[5],_=n[9],w=n[2],A=n[6],C=n[10],M=s+g+C;if(M>0){const R=.5/Math.sqrt(M+1);this._w=.25/R,this._x=(A-_)*R,this._y=(c-w)*R,this._z=(m-a)*R}else if(s>g&&s>C){const R=2*Math.sqrt(1+s-g-C);this._w=(A-_)/R,this._x=.25*R,this._y=(a+m)/R,this._z=(c+w)/R}else if(g>C){const R=2*Math.sqrt(1+g-s-C);this._w=(c-w)/R,this._x=(a+m)/R,this._y=.25*R,this._z=(_+A)/R}else{const R=2*Math.sqrt(1+C-s-g);this._w=(m-a)/R,this._x=(c+w)/R,this._y=(_+A)/R,this._z=.25*R}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let s=e.dot(n)+1;return s<Number.EPSILON?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ni(this.dot(e),-1,1)))}rotateTowards(e,n){const s=this.angleTo(e);if(s===0)return this;const a=Math.min(1,n/s);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const s=e._x,a=e._y,c=e._z,m=e._w,g=n._x,_=n._y,w=n._z,A=n._w;return this._x=s*A+m*g+a*w-c*_,this._y=a*A+m*_+c*g-s*w,this._z=c*A+m*w+s*_-a*g,this._w=m*A-s*g-a*_-c*w,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const s=this._x,a=this._y,c=this._z,m=this._w;let g=m*e._w+s*e._x+a*e._y+c*e._z;if(g<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,g=-g):this.copy(e),g>=1)return this._w=m,this._x=s,this._y=a,this._z=c,this;const _=1-g*g;if(_<=Number.EPSILON){const R=1-n;return this._w=R*m+n*this._w,this._x=R*s+n*this._x,this._y=R*a+n*this._y,this._z=R*c+n*this._z,this.normalize(),this._onChangeCallback(),this}const w=Math.sqrt(_),A=Math.atan2(w,g),C=Math.sin((1-n)*A)/w,M=Math.sin(n*A)/w;return this._w=m*C+this._w*M,this._x=s*C+this._x*M,this._y=a*C+this._y*M,this._z=c*C+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,n,s){return this.copy(e).slerp(n,s)}random(){const e=Math.random(),n=Math.sqrt(1-e),s=Math.sqrt(e),a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();return this.set(n*Math.cos(a),s*Math.sin(c),s*Math.cos(c),n*Math.sin(a))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}const Cr=class Cr{constructor(e=0,n=0,s=0){Cr.prototype.isVector3=!0,this.x=e,this.y=n,this.z=s}set(e,n,s){return s===void 0&&(s=this.z),this.x=e,this.y=n,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(hf.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(hf.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,s=this.y,a=this.z,c=e.elements;return this.x=c[0]*n+c[3]*s+c[6]*a,this.y=c[1]*n+c[4]*s+c[7]*a,this.z=c[2]*n+c[5]*s+c[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,s=this.y,a=this.z,c=e.elements,m=1/(c[3]*n+c[7]*s+c[11]*a+c[15]);return this.x=(c[0]*n+c[4]*s+c[8]*a+c[12])*m,this.y=(c[1]*n+c[5]*s+c[9]*a+c[13])*m,this.z=(c[2]*n+c[6]*s+c[10]*a+c[14])*m,this}applyQuaternion(e){const n=this.x,s=this.y,a=this.z,c=e.x,m=e.y,g=e.z,_=e.w,w=_*n+m*a-g*s,A=_*s+g*n-c*a,C=_*a+c*s-m*n,M=-c*n-m*s-g*a;return this.x=w*_+M*-c+A*-g-C*-m,this.y=A*_+M*-m+C*-c-w*-g,this.z=C*_+M*-g+w*-m-A*-c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,s=this.y,a=this.z,c=e.elements;return this.x=c[0]*n+c[4]*s+c[8]*a,this.y=c[1]*n+c[5]*s+c[9]*a,this.z=c[2]*n+c[6]*s+c[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(n,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this.z=e.z+(n.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const s=e.x,a=e.y,c=e.z,m=n.x,g=n.y,_=n.z;return this.x=a*_-c*g,this.y=c*m-s*_,this.z=s*g-a*m,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const s=e.dot(this)/n;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return Oh.copy(this).projectOnVector(e),this.sub(Oh)}reflect(e){return this.sub(Oh.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const s=this.dot(e)/n;return Math.acos(ni(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,s=this.y-e.y,a=this.z-e.z;return n*n+s*s+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,s){const a=Math.sin(n)*e;return this.x=a*Math.sin(s),this.y=Math.cos(n)*e,this.z=a*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,s){return this.x=e*Math.sin(n),this.y=s,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=s,this.z=a,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,s=Math.sqrt(1-e**2);return this.x=s*Math.cos(n),this.y=s*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};B(Cr,"UNIT_X",Object.freeze(new Cr(1,0,0))),B(Cr,"UNIT_Y",Object.freeze(new Cr(0,1,0))),B(Cr,"UNIT_Z",Object.freeze(new Cr(0,0,1))),B(Cr,"RIGHT",Object.freeze(new Cr(1,0,0))),B(Cr,"UP",Object.freeze(new Cr(0,1,0))),B(Cr,"ZERO",Object.freeze(new Cr(0,0,0))),B(Cr,"ONE",Object.freeze(new Cr(1,1,1))),B(Cr,"NEG_ONE",Object.freeze(new Cr(-1,-1,-1)));let le=Cr;const Oh=new le,hf=new Vr,$i=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Fh=1234567;const ul=Math.PI/180,Qs=180/Math.PI;function vs(){const u=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return($i[u&255]+$i[u>>8&255]+$i[u>>16&255]+$i[u>>24&255]+"-"+$i[e&255]+$i[e>>8&255]+"-"+$i[e>>16&15|64]+$i[e>>24&255]+"-"+$i[n&63|128]+$i[n>>8&255]+"-"+$i[n>>16&255]+$i[n>>24&255]+$i[s&255]+$i[s>>8&255]+$i[s>>16&255]+$i[s>>24&255]).toLowerCase()}function ni(u,e,n){return Math.max(e,Math.min(n,u))}function Mo(u){return ni(u,0,1)}function df(u,e){return(u%e+e)%e}function wr(u,e,n,s,a){return s+(u-e)*(a-s)/(n-e)}function _n(u,e,n){return u!==e?(n-u)/(e-u):0}function _u(u,e,n){return(1-n)*u+n*e}function P0(u,e,n,s){return _u(u,e,1-Math.exp(-n*s))}function R0(u,e=1){return e-Math.abs(df(u,e*2)-e)}function D0(u,e,n){return u<=e?0:u>=n?1:(u=(u-e)/(n-e),u*u*(3-2*u))}function I0(u,e,n){return u<=e?0:u>=n?1:(u=(u-e)/(n-e),u*u*u*(u*(u*6-15)+10))}function L0(u,e){return u+Math.random()*(e-u+1)>>0}function Tm(u,e){return u+Math.random()*(e-u)}function Bh(u){return u*(.5-Math.random())}function O0(u){u!==void 0&&(Fh=u);let e=Fh+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Cm(u){return u*ul}function F0(u){return u*Qs}function ys(u){return(u&u-1)===0&&u!==0}function kh(u){return Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function hl(u){return Math.pow(2,Math.floor(Math.log(u)/Math.LN2))}function B0(u,e,n,s,a){const c=Math.cos,m=Math.sin,g=c(n/2),_=m(n/2),w=c((e+s)/2),A=m((e+s)/2),C=c((e-s)/2),M=m((e-s)/2),R=c((s-e)/2),F=m((s-e)/2);switch(a){case"XYX":u.set(g*A,_*C,_*M,g*w);break;case"YZY":u.set(_*M,g*A,_*C,g*w);break;case"ZXZ":u.set(_*C,_*M,g*A,g*w);break;case"XZX":u.set(g*A,_*F,_*R,g*w);break;case"YXY":u.set(_*R,g*A,_*F,g*w);break;case"ZYZ":u.set(_*F,_*R,g*A,g*w);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}function qo(u,e){switch(e.constructor){case Float32Array:return u;case Uint16Array:return u/65535;case Uint8Array:return u/255;case Int16Array:return Math.max(u/32767,-1);case Int8Array:return Math.max(u/127,-1);default:throw new Error("Invalid component type.")}}function Yt(u,e){switch(e.constructor){case Float32Array:return u;case Uint16Array:return Math.round(u*65535);case Uint8Array:return Math.round(u*255);case Int16Array:return Math.round(u*32767);case Int8Array:return Math.round(u*127);default:throw new Error("Invalid component type.")}}const{min:Ca,max:rc,abs:ns}=Math,is=1e-6,k0=Math.log(.01);function Pm(u,e,n,s){let a=-k0/n;return u+(e-u)*(1-exp(-a*s))}function Rm(u,e,n,s){let a=1-Ca(s,n)/n,c=a*a;return u+(e-u)*(1-c*c)}function ff(u,e,n,s,a,c){u._velocity===void 0&&(u._velocity=0),s=rc(1e-4,s);let m=2/s,g=m*c,_=1/(1+g+.48*g*g+.235*g*g*g),w=e-n,A=n,C=a*s;w=ni(w,-C,C),n=e-w;let M=(u._velocity+m*w)*c;u._velocity=(u._velocity-m*M)*_;let R=n+(w+M)*_;return A-e>0==R>A&&(R=A,u._velocity=(R-A)/c),R}function Dm(u,e,n,s,a=u){return a.copy(u).slerp(e,Pm(0,1,n,s))}function U0(u,e,n,s,a=u){return a.copy(u).slerp(e,Rm(0,1,n,s))}function xu(u,e,n,s,a=u){return a.copy(u).slerp(e,ff(a,0,1,n,1/0,s))}function Im(u,e,n,s,a=u){return a.copy(u).lerp(e,ff(a,0,1,n,1/0,s))}let Uh=new le;function Nh(u,e,n,s,a=u){if(s<=0)return a.copy(e);let c=Uh.copy(e).sub(u);return c.lengthSq()<is?a.copy(e):a.copy(u).add(c.multiplyScalar(ni(n*s,0,1)))}function pf(u,e,n,s,a=u){let c=Uh.copy(e).sub(u),m=c.length(),g=s*n;if(m>g)if(g>0){let _=c.multiplyScalar(1/m);return a.copy(u).add(_)}else return a.copy(u);return a.copy(e)}function mf(u,e,n=is){return ns(u.x-e.x)<=n*rc(1,ns(u.x),ns(e.x))&&ns(u.y-e.y)<=n*rc(1,ns(u.y),ns(e.y))&&ns(u.z-e.z)<=n*rc(1,ns(u.z),ns(e.z))&&ns(u.w-e.w)<=n*rc(1,ns(u.w),ns(e.w))}function Lm(u,e){let n=u.x*e.x+u.y*e.y+u.z*e.z+u.w*e.w;return acos(2*n*n-1)}function N0(u,e,n,s){return s<=0||mf(u,e)?e:u.slerp(e,ni(s*n,0,1))}function gf(u,e,n,s,a=u){if(s<=0||mf(u,e))return a.copy(e);let c=ni(s*n,0,1),m=rc(Lm(u,e),is);return a.copy(u).slerp(e,ni(c/m,0,1))}function zh(u,e,n,s){if(s<=0)return e;let a=e-u;return ns(a)<is?e:u+a*ni(s*n,0,1)}function vf(u,e,n,s){let a=e-u;if(ns(a)<is)return e;let c=s*n;return u+ni(a,-c,c)}const z0={DEG2RAD:ul,RAD2DEG:Qs,generateUUID:vs,clamp:ni,clamp01:Mo,euclideanModulo:df,mapLinear:wr,inverseLerp:_n,lerp:_u,damp:P0,pingpong:R0,smoothstep:D0,smootherstep:I0,randInt:L0,randFloat:Tm,randFloatSpread:Bh,seededRandom:O0,degToRad:Cm,radToDeg:F0,isPowerOfTwo:ys,ceilPowerOfTwo:kh,floorPowerOfTwo:hl,setQuaternionFromProperEuler:B0,normalize:Yt,denormalize:qo,exponentialDamp:Pm,quarticDamp:Rm,smoothDamp:ff,Quat_Equals:mf,Quat_AngularDistance:Lm,Quat_exponentialDamp:Dm,Quat_quarticDamp:U0,Quat_smoothDamp:xu,Vec3_smoothDamp:Im,VInterpTo:Nh,VInterpConstantTo:pf,QInterpTo:N0,QInterpConstantTo:gf,FInterpTo:zh,FInterpConstantTo:vf};class it{constructor(e=0,n=0){it.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,s=this.y,a=e.elements;return this.x=a[0]*n+a[3]*s+a[6],this.y=a[1]*n+a[4]*s+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(n,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,s=this.y-e.y;return n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const s=Math.cos(n),a=Math.sin(n),c=this.x-e.x,m=this.y-e.y;return this.x=c*s-m*a+e.x,this.y=c*a+m*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ar{constructor(){Ar.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,n,s,a,c,m,g,_,w){const A=this.elements;return A[0]=e,A[1]=a,A[2]=g,A[3]=n,A[4]=c,A[5]=_,A[6]=s,A[7]=m,A[8]=w,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,s=e.elements;return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],this}extractBasis(e,n,s){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const s=e.elements,a=n.elements,c=this.elements,m=s[0],g=s[3],_=s[6],w=s[1],A=s[4],C=s[7],M=s[2],R=s[5],F=s[8],D=a[0],O=a[3],W=a[6],K=a[1],V=a[4],Y=a[7],se=a[2],ue=a[5],me=a[8];return c[0]=m*D+g*K+_*se,c[3]=m*O+g*V+_*ue,c[6]=m*W+g*Y+_*me,c[1]=w*D+A*K+C*se,c[4]=w*O+A*V+C*ue,c[7]=w*W+A*Y+C*me,c[2]=M*D+R*K+F*se,c[5]=M*O+R*V+F*ue,c[8]=M*W+R*Y+F*me,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],s=e[1],a=e[2],c=e[3],m=e[4],g=e[5],_=e[6],w=e[7],A=e[8];return n*m*A-n*g*w-s*c*A+s*g*_+a*c*w-a*m*_}invert(){const e=this.elements,n=e[0],s=e[1],a=e[2],c=e[3],m=e[4],g=e[5],_=e[6],w=e[7],A=e[8],C=A*m-g*w,M=g*_-A*c,R=w*c-m*_,F=n*C+s*M+a*R;if(F===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/F;return e[0]=C*D,e[1]=(a*w-A*s)*D,e[2]=(g*s-a*m)*D,e[3]=M*D,e[4]=(A*n-a*_)*D,e[5]=(a*c-g*n)*D,e[6]=R*D,e[7]=(s*_-w*n)*D,e[8]=(m*n-s*c)*D,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,s,a,c,m,g){const _=Math.cos(c),w=Math.sin(c);return this.set(s*_,s*w,-s*(_*m+w*g)+m+e,-a*w,a*_,-a*(-w*m+_*g)+g+n,0,0,1),this}scale(e,n){return this.premultiply(bu.makeScale(e,n)),this}rotate(e){return this.premultiply(bu.makeRotation(-e)),this}translate(e,n){return this.premultiply(bu.makeTranslation(e,n)),this}makeTranslation(e,n){return this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,-s,0,s,n,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,0,s,0,1,0,-s,0,n,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,s=e.elements;for(let a=0;a<9;a++)if(n[a]!==s[a])return!1;return!0}fromArray(e,n=0){for(let s=0;s<9;s++)this.elements[s]=e[s+n];return this}toArray(e=[],n=0){const s=this.elements;return e[n]=s[0],e[n+1]=s[1],e[n+2]=s[2],e[n+3]=s[3],e[n+4]=s[4],e[n+5]=s[5],e[n+6]=s[6],e[n+7]=s[7],e[n+8]=s[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const bu=new Ar;function Gh(u){for(let e=u.length-1;e>=0;--e)if(u[e]>=65535)return!0;return!1}const Om={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Eo(u,e){return new Om[u](e)}function wu(u){return document.createElementNS("http://www.w3.org/1999/xhtml",u)}function Pa(u){return u<.04045?u*.0773993808:Math.pow(u*.9478672986+.0521327014,2.4)}function Ra(u){return u<.0031308?u*12.92:1.055*Math.pow(u,.41666)-.055}const G0=new Ar().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Ks=new Ar().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),qs=new le;function H0(u){return u.convertSRGBToLinear(),qs.set(u.r,u.g,u.b).applyMatrix3(Ks),u.setRGB(qs.x,qs.y,qs.z)}function V0(u){return qs.set(u.r,u.g,u.b).applyMatrix3(G0),u.setRGB(qs.x,qs.y,qs.z).convertLinearToSRGB()}const Hh={[nc]:u=>u,[Ys]:u=>u.convertSRGBToLinear(),[sf]:H0},To={[nc]:u=>u,[Ys]:u=>u.convertLinearToSRGB(),[sf]:V0},ai={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(u){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!u},get workingColorSpace(){return nc},set workingColorSpace(u){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(u,e,n){if(this.enabled===!1||e===n||!e||!n)return u;const s=Hh[e],a=To[n];if(s===void 0||a===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return a(s(u))},fromWorkingColorSpace:function(u,e){return this.convert(u,this.workingColorSpace,e)},toWorkingColorSpace:function(u,e){return this.convert(u,e,this.workingColorSpace)}};let dl;class Vh{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{dl===void 0&&(dl=wu("canvas")),dl.width=e.width,dl.height=e.height;const s=dl.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=dl}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=wu("canvas");n.width=e.width,n.height=e.height;const s=n.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const a=s.getImageData(0,0,e.width,e.height),c=a.data;for(let m=0;m<c.length;m++)c[m]=Pa(c[m]/255)*255;return s.putImageData(a,0,0),n}else if(e.data){const n=e.data.slice(0);for(let s=0;s<n.length;s++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[s]=Math.floor(Pa(n[s]/255)*255):n[s]=Pa(n[s]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Da{constructor(e=null){this.isSource=!0,this.uuid=vs(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const s={uuid:this.uuid,url:""},a=this.data;if(a!==null){let c;if(Array.isArray(a)){c=[];for(let m=0,g=a.length;m<g;m++)a[m].isDataTexture?c.push(Au(a[m].image)):c.push(Au(a[m]))}else c=Au(a);s.url=c}return n||(e.images[this.uuid]=s),s}}function Au(u){return typeof HTMLImageElement<"u"&&u instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&u instanceof ImageBitmap?Vh.getDataURL(u):u.data?{data:Array.from(u.data),width:u.width,height:u.height,type:u.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rs=0;class ri extends Ko{constructor(e=ri.DEFAULT_IMAGE,n=ri.DEFAULT_MAPPING,s=Bi,a=Bi,c=Ci,m=xo,g=Hr,_=ts,w=ri.DEFAULT_ANISOTROPY,A=Ea){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rs++}),this.uuid=vs(),this.name="",this.source=new Da(e),this.mipmaps=[],this.mapping=n,this.wrapS=s,this.wrapT=a,this.magFilter=c,this.minFilter=m,this.anisotropy=w,this.format=g,this.internalFormat=null,this.type=_,this.offset=new it(0,0),this.repeat=new it(1,1),this.center=new it(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ar,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=A,this.userData={},this.version=0,this.onUpdate=null,this.fbo=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const s={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),n||(e.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Kl)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Vs:e.x=e.x-Math.floor(e.x);break;case Bi:e.x=e.x<0?0:1;break;case wa:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Vs:e.y=e.y-Math.floor(e.y);break;case Bi:e.y=e.y<0?0:1;break;case wa:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}ri.DEFAULT_IMAGE=null,ri.DEFAULT_MAPPING=Kl,ri.DEFAULT_ANISOTROPY=1;class Zn{constructor(e=0,n=0,s=0,a=1){Zn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=s,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,s,a){return this.x=e,this.y=n,this.z=s,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,s=this.y,a=this.z,c=this.w,m=e.elements;return this.x=m[0]*n+m[4]*s+m[8]*a+m[12]*c,this.y=m[1]*n+m[5]*s+m[9]*a+m[13]*c,this.z=m[2]*n+m[6]*s+m[10]*a+m[14]*c,this.w=m[3]*n+m[7]*s+m[11]*a+m[15]*c,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,s,a,c;const _=e.elements,w=_[0],A=_[4],C=_[8],M=_[1],R=_[5],F=_[9],D=_[2],O=_[6],W=_[10];if(Math.abs(A-M)<.01&&Math.abs(C-D)<.01&&Math.abs(F-O)<.01){if(Math.abs(A+M)<.1&&Math.abs(C+D)<.1&&Math.abs(F+O)<.1&&Math.abs(w+R+W-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const V=(w+1)/2,Y=(R+1)/2,se=(W+1)/2,ue=(A+M)/4,me=(C+D)/4,J=(F+O)/4;return V>Y&&V>se?V<.01?(s=0,a=.707106781,c=.707106781):(s=Math.sqrt(V),a=ue/s,c=me/s):Y>se?Y<.01?(s=.707106781,a=0,c=.707106781):(a=Math.sqrt(Y),s=ue/a,c=J/a):se<.01?(s=.707106781,a=.707106781,c=0):(c=Math.sqrt(se),s=me/c,a=J/c),this.set(s,a,c,n),this}let K=Math.sqrt((O-F)*(O-F)+(C-D)*(C-D)+(M-A)*(M-A));return Math.abs(K)<.001&&(K=1),this.x=(O-F)/K,this.y=(C-D)/K,this.z=(M-A)/K,this.w=Math.acos((w+R+W-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(e,Math.min(n,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this.z=e.z+(n.z-e.z)*s,this.w=e.w+(n.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ls extends Ko{constructor(e=1,n=1,s={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Zn(0,0,e,n),this.scissorTest=!1,this.viewport=new Zn(0,0,e,n);const a={width:e,height:n,depth:1};this.texture=new ri(a,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=s.generateMipmaps!==void 0?s.generateMipmaps:!1,this.texture.internalFormat=s.internalFormat!==void 0?s.internalFormat:null,this.texture.minFilter=s.minFilter!==void 0?s.minFilter:Ci,this.depthBuffer=s.depthBuffer!==void 0?s.depthBuffer:!0,this.stencilBuffer=s.stencilBuffer!==void 0?s.stencilBuffer:!1,this.depthTexture=s.depthTexture!==void 0?s.depthTexture:null,this.samples=s.samples!==void 0?s.samples:0}setSize(e,n,s=1){(this.width!==e||this.height!==n||this.depth!==s)&&(this.width=e,this.height=n,this.depth=s,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=s,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Da(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Su extends ri{constructor(e=null,n=1,s=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:s,depth:a},this.magFilter=Ti,this.minFilter=Ti,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Fm extends Ls{constructor(e=1,n=1,s=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=s,this.texture=new Su(null,e,n,s),this.texture.isRenderTargetTexture=!0}}class fl extends ri{constructor(e=null,n=1,s=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:s,depth:a},this.magFilter=Ti,this.minFilter=Ti,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Zo extends Ls{constructor(e=1,n=1,s=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=s,this.texture=new fl(null,e,n,s),this.texture.isRenderTargetTexture=!0}}class sc extends Ls{constructor(e=1,n=1,s=1,a={}){super(e,n,a),this.isWebGLMultipleRenderTargets=!0;const c=this.texture;this.texture=[];for(let m=0;m<s;m++)this.texture[m]=c.clone(),this.texture[m].isRenderTargetTexture=!0}setSize(e,n,s=1){if(this.width!==e||this.height!==n||this.depth!==s){this.width=e,this.height=n,this.depth=s;for(let a=0,c=this.texture.length;a<c;a++)this.texture[a].image.width=e,this.texture[a].image.height=n,this.texture[a].image.depth=s;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,s=e.texture.length;n<s;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class _s{constructor(e=new le(1/0,1/0,1/0),n=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){let n=1/0,s=1/0,a=1/0,c=-1/0,m=-1/0,g=-1/0;for(let _=0,w=e.length;_<w;_+=3){const A=e[_],C=e[_+1],M=e[_+2];A<n&&(n=A),C<s&&(s=C),M<a&&(a=M),A>c&&(c=A),C>m&&(m=C),M>g&&(g=M)}return this.min.set(n,s,a),this.max.set(c,m,g),this}setFromBufferAttribute(e){let n=1/0,s=1/0,a=1/0,c=-1/0,m=-1/0,g=-1/0;for(let _=0,w=e.count;_<w;_++){const A=e.getX(_),C=e.getY(_),M=e.getZ(_);A<n&&(n=A),C<s&&(s=C),M<a&&(a=M),A>c&&(c=A),C>m&&(m=C),M>g&&(g=M)}return this.min.set(n,s,a),this.max.set(c,m,g),this}setFromPoints(e){this.makeEmpty();for(let n=0,s=e.length;n<s;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const s=Js.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const s=e.geometry;if(s!==void 0)if(n&&s.attributes!=null&&s.attributes.position!==void 0){const c=s.attributes.position;for(let m=0,g=c.count;m<g;m++)Js.fromBufferAttribute(c,m).applyMatrix4(e.matrixWorld),this.expandByPoint(Js)}else s.boundingBox===null&&s.computeBoundingBox(),pl.copy(s.boundingBox),pl.applyMatrix4(e.matrixWorld),this.union(pl);const a=e.children;for(let c=0,m=a.length;c<m;c++)this.expandByObject(a[c],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Js),Js.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,s;return e.normal.x>0?(n=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),n<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(cr),$s.subVectors(this.max,cr),xs.subVectors(e.a,cr),Jo.subVectors(e.b,cr),$o.subVectors(e.c,cr),Ia.subVectors(Jo,xs),La.subVectors($o,Jo),bs.subVectors(xs,$o);let n=[0,-Ia.z,Ia.y,0,-La.z,La.y,0,-bs.z,bs.y,Ia.z,0,-Ia.x,La.z,0,-La.x,bs.z,0,-bs.x,-Ia.y,Ia.x,0,-La.y,La.x,0,-bs.y,bs.x,0];return!Mu(n,xs,Jo,$o,$s)||(n=[1,0,0,0,1,0,0,0,1],!Mu(n,xs,Jo,$o,$s))?!1:(li.crossVectors(Ia,La),n=[li.x,li.y,li.z],Mu(n,xs,Jo,$o,$s))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Js).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Js).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Zs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Zs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Zs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Zs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Zs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Zs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Zs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Zs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Zs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Zs=[new le,new le,new le,new le,new le,new le,new le,new le],Js=new le,pl=new _s,xs=new le,Jo=new le,$o=new le,Ia=new le,La=new le,bs=new le,cr=new le,$s=new le,li=new le,Oa=new le;function Mu(u,e,n,s,a){for(let c=0,m=u.length-3;c<=m;c+=3){Oa.fromArray(u,c);const g=a.x*Math.abs(Oa.x)+a.y*Math.abs(Oa.y)+a.z*Math.abs(Oa.z),_=e.dot(Oa),w=n.dot(Oa),A=s.dot(Oa);if(Math.max(-Math.max(_,w,A),Math.min(_,w,A))>g)return!1}return!0}const Bm=new _s,oc=new le,Wh=new le;class ml{constructor(e=new le,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const s=this.center;n!==void 0?s.copy(n):Bm.setFromPoints(e).getCenter(s);let a=0;for(let c=0,m=e.length;c<m;c++)a=Math.max(a,s.distanceToSquared(e[c]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const s=this.center.distanceToSquared(e);return n.copy(e),s>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;oc.subVectors(e,this.center);const n=oc.lengthSq();if(n>this.radius*this.radius){const s=Math.sqrt(n),a=(s-this.radius)*.5;this.center.addScaledVector(oc,a/s),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Wh.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(oc.copy(e.center).add(Wh)),this.expandByPoint(oc.copy(e.center).sub(Wh))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ea=new le,yf=new le,jh=new le,Fa=new le,_f=new le,ac=new le,lc=new le;class jn{constructor(e=new le,n=new le(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ea)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const s=n.dot(this.direction);return s<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=ea.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(ea.copy(this.origin).addScaledVector(this.direction,n),ea.distanceToSquared(e))}distanceSqToSegment(e,n,s,a){yf.copy(e).add(n).multiplyScalar(.5),jh.copy(n).sub(e).normalize(),Fa.copy(this.origin).sub(yf);const c=e.distanceTo(n)*.5,m=-this.direction.dot(jh),g=Fa.dot(this.direction),_=-Fa.dot(jh),w=Fa.lengthSq(),A=Math.abs(1-m*m);let C,M,R,F;if(A>0)if(C=m*_-g,M=m*g-_,F=c*A,C>=0)if(M>=-F)if(M<=F){const D=1/A;C*=D,M*=D,R=C*(C+m*M+2*g)+M*(m*C+M+2*_)+w}else M=c,C=Math.max(0,-(m*M+g)),R=-C*C+M*(M+2*_)+w;else M=-c,C=Math.max(0,-(m*M+g)),R=-C*C+M*(M+2*_)+w;else M<=-F?(C=Math.max(0,-(-m*c+g)),M=C>0?-c:Math.min(Math.max(-c,-_),c),R=-C*C+M*(M+2*_)+w):M<=F?(C=0,M=Math.min(Math.max(-c,-_),c),R=M*(M+2*_)+w):(C=Math.max(0,-(m*c+g)),M=C>0?c:Math.min(Math.max(-c,-_),c),R=-C*C+M*(M+2*_)+w);else M=m>0?-c:c,C=Math.max(0,-(m*M+g)),R=-C*C+M*(M+2*_)+w;return s&&s.copy(this.origin).addScaledVector(this.direction,C),a&&a.copy(yf).addScaledVector(jh,M),R}intersectSphere(e,n){ea.subVectors(e.center,this.origin);const s=ea.dot(this.direction),a=ea.dot(ea)-s*s,c=e.radius*e.radius;if(a>c)return null;const m=Math.sqrt(c-a),g=s-m,_=s+m;return _<0?null:g<0?this.at(_,n):this.at(g,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/n;return s>=0?s:null}intersectPlane(e,n){const s=this.distanceToPlane(e);return s===null?null:this.at(s,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let s,a,c,m,g,_;const w=1/this.direction.x,A=1/this.direction.y,C=1/this.direction.z,M=this.origin;return w>=0?(s=(e.min.x-M.x)*w,a=(e.max.x-M.x)*w):(s=(e.max.x-M.x)*w,a=(e.min.x-M.x)*w),A>=0?(c=(e.min.y-M.y)*A,m=(e.max.y-M.y)*A):(c=(e.max.y-M.y)*A,m=(e.min.y-M.y)*A),s>m||c>a||((c>s||isNaN(s))&&(s=c),(m<a||isNaN(a))&&(a=m),C>=0?(g=(e.min.z-M.z)*C,_=(e.max.z-M.z)*C):(g=(e.max.z-M.z)*C,_=(e.min.z-M.z)*C),s>_||g>a)||((g>s||s!==s)&&(s=g),(_<a||a!==a)&&(a=_),a<0)?null:this.at(s>=0?s:a,n)}intersectsBox(e){return this.intersectBox(e,ea)!==null}intersectTriangle(e,n,s,a,c){_f.subVectors(n,e),ac.subVectors(s,e),lc.crossVectors(_f,ac);let m=this.direction.dot(lc),g;if(m>0){if(a)return null;g=1}else if(m<0)g=-1,m=-m;else return null;Fa.subVectors(this.origin,e);const _=g*this.direction.dot(ac.crossVectors(Fa,ac));if(_<0)return null;const w=g*this.direction.dot(_f.cross(Fa));if(w<0||_+w>m)return null;const A=-g*Fa.dot(lc);return A<0?null:this.at(A/m,c)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Mn{constructor(){Mn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,s,a,c,m,g,_,w,A,C,M,R,F,D,O){const W=this.elements;return W[0]=e,W[4]=n,W[8]=s,W[12]=a,W[1]=c,W[5]=m,W[9]=g,W[13]=_,W[2]=w,W[6]=A,W[10]=C,W[14]=M,W[3]=R,W[7]=F,W[11]=D,W[15]=O,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Mn().fromArray(this.elements)}copy(e){const n=this.elements,s=e.elements;return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],this}copyPosition(e){const n=this.elements,s=e.elements;return n[12]=s[12],n[13]=s[13],n[14]=s[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,s){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,n,s){return this.set(e.x,n.x,s.x,0,e.y,n.y,s.y,0,e.z,n.z,s.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,s=e.elements,a=1/gl.setFromMatrixColumn(e,0).length(),c=1/gl.setFromMatrixColumn(e,1).length(),m=1/gl.setFromMatrixColumn(e,2).length();return n[0]=s[0]*a,n[1]=s[1]*a,n[2]=s[2]*a,n[3]=0,n[4]=s[4]*c,n[5]=s[5]*c,n[6]=s[6]*c,n[7]=0,n[8]=s[8]*m,n[9]=s[9]*m,n[10]=s[10]*m,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,s=e.x,a=e.y,c=e.z,m=Math.cos(s),g=Math.sin(s),_=Math.cos(a),w=Math.sin(a),A=Math.cos(c),C=Math.sin(c);if(e.order==="XYZ"){const M=m*A,R=m*C,F=g*A,D=g*C;n[0]=_*A,n[4]=-_*C,n[8]=w,n[1]=R+F*w,n[5]=M-D*w,n[9]=-g*_,n[2]=D-M*w,n[6]=F+R*w,n[10]=m*_}else if(e.order==="YXZ"){const M=_*A,R=_*C,F=w*A,D=w*C;n[0]=M+D*g,n[4]=F*g-R,n[8]=m*w,n[1]=m*C,n[5]=m*A,n[9]=-g,n[2]=R*g-F,n[6]=D+M*g,n[10]=m*_}else if(e.order==="ZXY"){const M=_*A,R=_*C,F=w*A,D=w*C;n[0]=M-D*g,n[4]=-m*C,n[8]=F+R*g,n[1]=R+F*g,n[5]=m*A,n[9]=D-M*g,n[2]=-m*w,n[6]=g,n[10]=m*_}else if(e.order==="ZYX"){const M=m*A,R=m*C,F=g*A,D=g*C;n[0]=_*A,n[4]=F*w-R,n[8]=M*w+D,n[1]=_*C,n[5]=D*w+M,n[9]=R*w-F,n[2]=-w,n[6]=g*_,n[10]=m*_}else if(e.order==="YZX"){const M=m*_,R=m*w,F=g*_,D=g*w;n[0]=_*A,n[4]=D-M*C,n[8]=F*C+R,n[1]=C,n[5]=m*A,n[9]=-g*A,n[2]=-w*A,n[6]=R*C+F,n[10]=M-D*C}else if(e.order==="XZY"){const M=m*_,R=m*w,F=g*_,D=g*w;n[0]=_*A,n[4]=-C,n[8]=w*A,n[1]=M*C+D,n[5]=m*A,n[9]=R*C-F,n[2]=F*C-R,n[6]=g*A,n[10]=D*C+M}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Xh,e,Co)}lookAt(e,n,s){const a=this.elements;return er.subVectors(e,n),er.lengthSq()===0&&(er.z=1),er.normalize(),ta.crossVectors(s,er),ta.lengthSq()===0&&(Math.abs(s.z)===1?er.x+=1e-4:er.z+=1e-4,er.normalize(),ta.crossVectors(s,er)),ta.normalize(),Ba.crossVectors(er,ta),a[0]=ta.x,a[4]=Ba.x,a[8]=er.x,a[1]=ta.y,a[5]=Ba.y,a[9]=er.y,a[2]=ta.z,a[6]=Ba.z,a[10]=er.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const s=e.elements,a=n.elements,c=this.elements,m=s[0],g=s[4],_=s[8],w=s[12],A=s[1],C=s[5],M=s[9],R=s[13],F=s[2],D=s[6],O=s[10],W=s[14],K=s[3],V=s[7],Y=s[11],se=s[15],ue=a[0],me=a[4],J=a[8],ae=a[12],xe=a[1],We=a[5],Je=a[9],Le=a[13],Me=a[2],Ke=a[6],rt=a[10],yt=a[14],et=a[3],_t=a[7],ut=a[11],$t=a[15];return c[0]=m*ue+g*xe+_*Me+w*et,c[4]=m*me+g*We+_*Ke+w*_t,c[8]=m*J+g*Je+_*rt+w*ut,c[12]=m*ae+g*Le+_*yt+w*$t,c[1]=A*ue+C*xe+M*Me+R*et,c[5]=A*me+C*We+M*Ke+R*_t,c[9]=A*J+C*Je+M*rt+R*ut,c[13]=A*ae+C*Le+M*yt+R*$t,c[2]=F*ue+D*xe+O*Me+W*et,c[6]=F*me+D*We+O*Ke+W*_t,c[10]=F*J+D*Je+O*rt+W*ut,c[14]=F*ae+D*Le+O*yt+W*$t,c[3]=K*ue+V*xe+Y*Me+se*et,c[7]=K*me+V*We+Y*Ke+se*_t,c[11]=K*J+V*Je+Y*rt+se*ut,c[15]=K*ae+V*Le+Y*yt+se*$t,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],s=e[4],a=e[8],c=e[12],m=e[1],g=e[5],_=e[9],w=e[13],A=e[2],C=e[6],M=e[10],R=e[14],F=e[3],D=e[7],O=e[11],W=e[15];return F*(+c*_*C-a*w*C-c*g*M+s*w*M+a*g*R-s*_*R)+D*(+n*_*R-n*w*M+c*m*M-a*m*R+a*w*A-c*_*A)+O*(+n*w*C-n*g*R-c*m*C+s*m*R+c*g*A-s*w*A)+W*(-a*g*A-n*_*C+n*g*M+a*m*C-s*m*M+s*_*A)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,s){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=n,a[14]=s),this}invert(){const e=this.elements,n=e[0],s=e[1],a=e[2],c=e[3],m=e[4],g=e[5],_=e[6],w=e[7],A=e[8],C=e[9],M=e[10],R=e[11],F=e[12],D=e[13],O=e[14],W=e[15],K=C*O*w-D*M*w+D*_*R-g*O*R-C*_*W+g*M*W,V=F*M*w-A*O*w-F*_*R+m*O*R+A*_*W-m*M*W,Y=A*D*w-F*C*w+F*g*R-m*D*R-A*g*W+m*C*W,se=F*C*_-A*D*_-F*g*M+m*D*M+A*g*O-m*C*O,ue=n*K+s*V+a*Y+c*se;if(ue===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const me=1/ue;return e[0]=K*me,e[1]=(D*M*c-C*O*c-D*a*R+s*O*R+C*a*W-s*M*W)*me,e[2]=(g*O*c-D*_*c+D*a*w-s*O*w-g*a*W+s*_*W)*me,e[3]=(C*_*c-g*M*c-C*a*w+s*M*w+g*a*R-s*_*R)*me,e[4]=V*me,e[5]=(A*O*c-F*M*c+F*a*R-n*O*R-A*a*W+n*M*W)*me,e[6]=(F*_*c-m*O*c-F*a*w+n*O*w+m*a*W-n*_*W)*me,e[7]=(m*M*c-A*_*c+A*a*w-n*M*w-m*a*R+n*_*R)*me,e[8]=Y*me,e[9]=(F*C*c-A*D*c-F*s*R+n*D*R+A*s*W-n*C*W)*me,e[10]=(m*D*c-F*g*c+F*s*w-n*D*w-m*s*W+n*g*W)*me,e[11]=(A*g*c-m*C*c-A*s*w+n*C*w+m*s*R-n*g*R)*me,e[12]=se*me,e[13]=(A*D*a-F*C*a+F*s*M-n*D*M-A*s*O+n*C*O)*me,e[14]=(F*g*a-m*D*a-F*s*_+n*D*_+m*s*O-n*g*O)*me,e[15]=(m*C*a-A*g*a+A*s*_-n*C*_-m*s*M+n*g*M)*me,this}scale(e){const n=this.elements,s=e.x,a=e.y,c=e.z;return n[0]*=s,n[4]*=a,n[8]*=c,n[1]*=s,n[5]*=a,n[9]*=c,n[2]*=s,n[6]*=a,n[10]*=c,n[3]*=s,n[7]*=a,n[11]*=c,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],s=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,s,a))}makeTranslation(e,n,s){return this.set(1,0,0,e,0,1,0,n,0,0,1,s,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,n,-s,0,0,s,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,0,s,0,0,1,0,0,-s,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,-s,0,0,s,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const s=Math.cos(n),a=Math.sin(n),c=1-s,m=e.x,g=e.y,_=e.z,w=c*m,A=c*g;return this.set(w*m+s,w*g-a*_,w*_+a*g,0,w*g+a*_,A*g+s,A*_-a*m,0,w*_-a*g,A*_+a*m,c*_*_+s,0,0,0,0,1),this}makeScale(e,n,s){return this.set(e,0,0,0,0,n,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,n,s,a,c,m){return this.set(1,s,c,0,e,1,m,0,n,a,1,0,0,0,0,1),this}compose(e,n,s){const a=this.elements,c=n._x,m=n._y,g=n._z,_=n._w,w=c+c,A=m+m,C=g+g,M=c*w,R=c*A,F=c*C,D=m*A,O=m*C,W=g*C,K=_*w,V=_*A,Y=_*C,se=s.x,ue=s.y,me=s.z;return a[0]=(1-(D+W))*se,a[1]=(R+Y)*se,a[2]=(F-V)*se,a[3]=0,a[4]=(R-Y)*ue,a[5]=(1-(M+W))*ue,a[6]=(O+K)*ue,a[7]=0,a[8]=(F+V)*me,a[9]=(O-K)*me,a[10]=(1-(M+D))*me,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,n,s){const a=this.elements;let c=gl.set(a[0],a[1],a[2]).length();const m=gl.set(a[4],a[5],a[6]).length(),g=gl.set(a[8],a[9],a[10]).length();this.determinant()<0&&(c=-c),e.x=a[12],e.y=a[13],e.z=a[14],ss.copy(this);const w=1/c,A=1/m,C=1/g;return ss.elements[0]*=w,ss.elements[1]*=w,ss.elements[2]*=w,ss.elements[4]*=A,ss.elements[5]*=A,ss.elements[6]*=A,ss.elements[8]*=C,ss.elements[9]*=C,ss.elements[10]*=C,n.setFromRotationMatrix(ss),s.x=c,s.y=m,s.z=g,this}makePerspective(e,n,s,a,c,m){const g=this.elements,_=2*c/(n-e),w=2*c/(s-a),A=(n+e)/(n-e),C=(s+a)/(s-a),M=-(m+c)/(m-c),R=-2*m*c/(m-c);return g[0]=_,g[4]=0,g[8]=A,g[12]=0,g[1]=0,g[5]=w,g[9]=C,g[13]=0,g[2]=0,g[6]=0,g[10]=M,g[14]=R,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this}makeOrthographic(e,n,s,a,c,m){const g=this.elements,_=1/(n-e),w=1/(s-a),A=1/(m-c),C=(n+e)*_,M=(s+a)*w,R=(m+c)*A;return g[0]=2*_,g[4]=0,g[8]=0,g[12]=-C,g[1]=0,g[5]=2*w,g[9]=0,g[13]=-M,g[2]=0,g[6]=0,g[10]=-2*A,g[14]=-R,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this}equals(e){const n=this.elements,s=e.elements;for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}fromArray(e,n=0){for(let s=0;s<16;s++)this.elements[s]=e[s+n];return this}toArray(e=[],n=0){const s=this.elements;return e[n]=s[0],e[n+1]=s[1],e[n+2]=s[2],e[n+3]=s[3],e[n+4]=s[4],e[n+5]=s[5],e[n+6]=s[6],e[n+7]=s[7],e[n+8]=s[8],e[n+9]=s[9],e[n+10]=s[10],e[n+11]=s[11],e[n+12]=s[12],e[n+13]=s[13],e[n+14]=s[14],e[n+15]=s[15],e}}const gl=new le,ss=new Mn,Xh=new le(0,0,0),Co=new le(1,1,1),ta=new le,Ba=new le,er=new le,cc=new Mn,Eu=new Vr;class na{constructor(e=0,n=0,s=0,a=na.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=s,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,s,a=this._order){return this._x=e,this._y=n,this._z=s,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,s=!0){const a=e.elements,c=a[0],m=a[4],g=a[8],_=a[1],w=a[5],A=a[9],C=a[2],M=a[6],R=a[10];switch(n){case"XYZ":this._y=Math.asin(ni(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(-A,R),this._z=Math.atan2(-m,c)):(this._x=Math.atan2(M,w),this._z=0);break;case"YXZ":this._x=Math.asin(-ni(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(g,R),this._z=Math.atan2(_,w)):(this._y=Math.atan2(-C,c),this._z=0);break;case"ZXY":this._x=Math.asin(ni(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-C,R),this._z=Math.atan2(-m,w)):(this._y=0,this._z=Math.atan2(_,c));break;case"ZYX":this._y=Math.asin(-ni(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(M,R),this._z=Math.atan2(_,c)):(this._x=0,this._z=Math.atan2(-m,w));break;case"YZX":this._z=Math.asin(ni(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-A,w),this._y=Math.atan2(-C,c)):(this._x=0,this._y=Math.atan2(g,R));break;case"XZY":this._z=Math.asin(-ni(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(M,w),this._y=Math.atan2(g,c)):(this._x=Math.atan2(-A,R),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,s===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,s){return cc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(cc,n,s)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Eu.setFromEuler(this),this.setFromQuaternion(Eu,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}na.DEFAULT_ORDER="XYZ";class ka{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let W0=0;const km=new le,vl=new Vr,ws=new Mn,ia=new le,Tu=new le,xf=new le,j0=new Vr,bf=new le(1,0,0),Um=new le(0,1,0),Nm=new le(0,0,1),X0={type:"added"},zm={type:"removed"};class Gn extends Ko{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:W0++}),this.uuid=vs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gn.DEFAULT_UP.clone();const e=new le,n=new na,s=new Vr,a=new le(1,1,1);function c(){s.setFromEuler(n,!1)}function m(){n.setFromQuaternion(s,void 0,!1)}n._onChange(c),s._onChange(m),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Mn},normalMatrix:{value:new Ar}}),this.matrix=new Mn,this.matrixWorld=new Mn,this.matrixAutoUpdate=Gn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ka,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={},this.meshData={},this.localUniforms={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return vl.setFromAxisAngle(e,n),this.quaternion.multiply(vl),this}rotateOnWorldAxis(e,n){return vl.setFromAxisAngle(e,n),this.quaternion.premultiply(vl),this}rotateX(e){return this.rotateOnAxis(bf,e)}rotateY(e){return this.rotateOnAxis(Um,e)}rotateZ(e){return this.rotateOnAxis(Nm,e)}translateOnAxis(e,n){return km.copy(e).applyQuaternion(this.quaternion),this.position.add(km.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(bf,e)}translateY(e){return this.translateOnAxis(Um,e)}translateZ(e){return this.translateOnAxis(Nm,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ws.copy(this.matrixWorld).invert())}lookAt(e,n,s){e.isVector3?ia.copy(e):ia.set(e,n,s);const a=this.parent;this.updateWorldMatrix(!0,!1),Tu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ws.lookAt(Tu,ia,this.up):ws.lookAt(ia,Tu,this.up),this.quaternion.setFromRotationMatrix(ws),a&&(ws.extractRotation(a.matrixWorld),vl.setFromRotationMatrix(ws),this.quaternion.premultiply(vl.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(X0)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}addObject(e){return this.add(e),e}remove(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(zm)),this}removeObject(e){return this.remove(e),e}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(zm)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),ws.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ws.multiply(e.parent.matrixWorld)),e.applyMatrix4(ws),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let s=0,a=this.children.length;s<a;s++){const m=this.children[s].getObjectByProperty(e,n);if(m!==void 0)return m}}getObjectsByProperty(e,n){let s=[];this[e]===n&&s.push(this);for(let a=0,c=this.children.length;a<c;a++){const m=this.children[a].getObjectsByProperty(e,n);m.length>0&&(s=s.concat(m))}return s}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tu,e,xf),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tu,j0,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let s=0,a=n.length;s<a;s++)n[s].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let s=0,a=n.length;s<a;s++)n[s].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let s=0,a=n.length;s<a;s++){const c=n[s];(c.matrixWorldAutoUpdate===!0||e===!0)&&c.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const s=this.parent;if(e===!0&&s!==null&&s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const a=this.children;for(let c=0,m=a.length;c<m;c++){const g=a[c];g.matrixWorldAutoUpdate===!0&&g.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",s={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON()));function c(g,_){return g[_.uuid]===void 0&&(g[_.uuid]=_.toJSON(e)),_.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(e.geometries,this.geometry);const g=this.geometry.parameters;if(g!==void 0&&g.shapes!==void 0){const _=g.shapes;if(Array.isArray(_))for(let w=0,A=_.length;w<A;w++){const C=_[w];c(e.shapes,C)}else c(e.shapes,_)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const g=[];for(let _=0,w=this.material.length;_<w;_++)g.push(c(e.materials,this.material[_]));a.material=g}else a.material=c(e.materials,this.material);if(this.children.length>0){a.children=[];for(let g=0;g<this.children.length;g++)a.children.push(this.children[g].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let g=0;g<this.animations.length;g++){const _=this.animations[g];a.animations.push(c(e.animations,_))}}if(n){const g=m(e.geometries),_=m(e.materials),w=m(e.textures),A=m(e.images),C=m(e.shapes),M=m(e.skeletons),R=m(e.animations),F=m(e.nodes);g.length>0&&(s.geometries=g),_.length>0&&(s.materials=_),w.length>0&&(s.textures=w),A.length>0&&(s.images=A),C.length>0&&(s.shapes=C),M.length>0&&(s.skeletons=M),R.length>0&&(s.animations=R),F.length>0&&(s.nodes=F)}return s.object=a,s;function m(g){const _=[];for(const w in g){const A=g[w];delete A.metadata,_.push(A)}return _}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let s=0;s<e.children.length;s++){const a=e.children[s];this.add(a.clone())}return this}}Gn.DEFAULT_UP=new le(0,1,0),Gn.DEFAULT_MATRIX_AUTO_UPDATE=!0,Gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const eo=new le,ra=new le,wf=new le,sa=new le,uc=new le,hc=new le,Gm=new le,Yh=new le,Af=new le,Sf=new le;class Os{constructor(e=new le,n=new le,s=new le){this.a=e,this.b=n,this.c=s}static getNormal(e,n,s,a){a.subVectors(s,n),eo.subVectors(e,n),a.cross(eo);const c=a.lengthSq();return c>0?a.multiplyScalar(1/Math.sqrt(c)):a.set(0,0,0)}static getBarycoord(e,n,s,a,c){eo.subVectors(a,n),ra.subVectors(s,n),wf.subVectors(e,n);const m=eo.dot(eo),g=eo.dot(ra),_=eo.dot(wf),w=ra.dot(ra),A=ra.dot(wf),C=m*w-g*g;if(C===0)return c.set(-2,-1,-1);const M=1/C,R=(w*_-g*A)*M,F=(m*A-g*_)*M;return c.set(1-R-F,F,R)}static containsPoint(e,n,s,a){return this.getBarycoord(e,n,s,a,sa),sa.x>=0&&sa.y>=0&&sa.x+sa.y<=1}static getUV(e,n,s,a,c,m,g,_){return this.getBarycoord(e,n,s,a,sa),_.set(0,0),_.addScaledVector(c,sa.x),_.addScaledVector(m,sa.y),_.addScaledVector(g,sa.z),_}static isFrontFacing(e,n,s,a){return eo.subVectors(s,n),ra.subVectors(e,n),eo.cross(ra).dot(a)<0}set(e,n,s){return this.a.copy(e),this.b.copy(n),this.c.copy(s),this}setFromPointsAndIndices(e,n,s,a){return this.a.copy(e[n]),this.b.copy(e[s]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,n,s,a){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return eo.subVectors(this.c,this.b),ra.subVectors(this.a,this.b),eo.cross(ra).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Os.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Os.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,s,a,c){return Os.getUV(e,this.a,this.b,this.c,n,s,a,c)}containsPoint(e){return Os.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Os.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const s=this.a,a=this.b,c=this.c;let m,g;uc.subVectors(a,s),hc.subVectors(c,s),Yh.subVectors(e,s);const _=uc.dot(Yh),w=hc.dot(Yh);if(_<=0&&w<=0)return n.copy(s);Af.subVectors(e,a);const A=uc.dot(Af),C=hc.dot(Af);if(A>=0&&C<=A)return n.copy(a);const M=_*C-A*w;if(M<=0&&_>=0&&A<=0)return m=_/(_-A),n.copy(s).addScaledVector(uc,m);Sf.subVectors(e,c);const R=uc.dot(Sf),F=hc.dot(Sf);if(F>=0&&R<=F)return n.copy(c);const D=R*w-_*F;if(D<=0&&w>=0&&F<=0)return g=w/(w-F),n.copy(s).addScaledVector(hc,g);const O=A*F-R*C;if(O<=0&&C-A>=0&&R-F>=0)return Gm.subVectors(c,a),g=(C-A)/(C-A+(R-F)),n.copy(a).addScaledVector(Gm,g);const W=1/(O+D+M);return m=D*W,g=M*W,n.copy(s).addScaledVector(uc,m).addScaledVector(hc,g)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Y0=0;class Ir extends Ko{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Y0++}),this.uuid=vs(),this.name="",this.type="Material",this.blending=ve,this.side=$e,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=tn,this.blendDst=yn,this.blendEquation=vt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=nl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Qo,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mu,this.stencilZFail=mu,this.stencilZPass=mu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const s=e[n];if(s===void 0){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}const a=this[n];if(a===void 0){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}a&&a.isColor?a.set(s):a&&a.isVector3&&s&&s.isVector3?a.copy(s):this[n]=s}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==ve&&(s.blending=this.blending),this.side!==$e&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(s.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(s.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=this.flatShading),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function a(c){const m=[];for(const g in c){const _=c[g];delete _.metadata,m.push(_)}return m}if(n){const c=a(e.textures),m=a(e.images);c.length>0&&(s.textures=c),m.length>0&&(s.images=m)}return s}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let s=null;if(n!==null){const a=n.length;s=new Array(a);for(let c=0;c!==a;++c)s[c]=n[c].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const Hm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},to={h:0,s:0,l:0},Qh={h:0,s:0,l:0};function Mf(u,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?u+(e-u)*6*n:n<1/2?e:n<2/3?u+(e-u)*6*(2/3-n):u}class Ut{constructor(e,n,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&s===void 0?this.set(e):this.setRGB(e,n,s)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ys){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ai.toWorkingColorSpace(this,n),this}setRGB(e,n,s,a=ai.workingColorSpace){return this.r=e,this.g=n,this.b=s,ai.toWorkingColorSpace(this,a),this}setHSL(e,n,s,a=ai.workingColorSpace){if(e=df(e,1),n=ni(n,0,1),s=ni(s,0,1),n===0)this.r=this.g=this.b=s;else{const c=s<=.5?s*(1+n):s+n-s*n,m=2*s-c;this.r=Mf(m,c,e+1/3),this.g=Mf(m,c,e),this.b=Mf(m,c,e-1/3)}return ai.toWorkingColorSpace(this,a),this}setStyle(e,n=Ys){function s(c){c!==void 0&&parseFloat(c)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(e)){let c;const m=a[1],g=a[2];switch(m){case"rgb":case"rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,ai.toWorkingColorSpace(this,n),s(c[4]),this;if(c=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,ai.toWorkingColorSpace(this,n),s(c[4]),this;break;case"hsl":case"hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g)){const _=parseFloat(c[1])/360,w=parseFloat(c[2])/100,A=parseFloat(c[3])/100;return s(c[4]),this.setHSL(_,w,A,n)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(e)){const c=a[1],m=c.length;if(m===3)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,ai.toWorkingColorSpace(this,n),this;if(m===6)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,ai.toWorkingColorSpace(this,n),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Ys){const s=Hm[e.toLowerCase()];return s!==void 0?this.setHex(s,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pa(e.r),this.g=Pa(e.g),this.b=Pa(e.b),this}copyLinearToSRGB(e){return this.r=Ra(e.r),this.g=Ra(e.g),this.b=Ra(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ys){return ai.fromWorkingColorSpace(Lr.copy(this),e),ni(Lr.r*255,0,255)<<16^ni(Lr.g*255,0,255)<<8^ni(Lr.b*255,0,255)<<0}getHexString(e=Ys){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=ai.workingColorSpace){ai.fromWorkingColorSpace(Lr.copy(this),n);const s=Lr.r,a=Lr.g,c=Lr.b,m=Math.max(s,a,c),g=Math.min(s,a,c);let _,w;const A=(g+m)/2;if(g===m)_=0,w=0;else{const C=m-g;switch(w=A<=.5?C/(m+g):C/(2-m-g),m){case s:_=(a-c)/C+(a<c?6:0);break;case a:_=(c-s)/C+2;break;case c:_=(s-a)/C+4;break}_/=6}return e.h=_,e.s=w,e.l=A,e}getRGB(e,n=ai.workingColorSpace){return ai.fromWorkingColorSpace(Lr.copy(this),n),e.r=Lr.r,e.g=Lr.g,e.b=Lr.b,e}getStyle(e=Ys){ai.fromWorkingColorSpace(Lr.copy(this),e);const n=Lr.r,s=Lr.g,a=Lr.b;return e!==Ys?`color(${e} ${n.toFixed(3)} ${s.toFixed(3)} ${a.toFixed(3)})`:`rgb(${n*255|0},${s*255|0},${a*255|0})`}offsetHSL(e,n,s){return this.getHSL(to),to.h+=e,to.s+=n,to.l+=s,this.setHSL(to.h,to.s,to.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,s){return this.r=e.r+(n.r-e.r)*s,this.g=e.g+(n.g-e.g)*s,this.b=e.b+(n.b-e.b)*s,this}lerpHSL(e,n){this.getHSL(to),e.getHSL(Qh);const s=_u(to.h,Qh.h,n),a=_u(to.s,Qh.s,n),c=_u(to.l,Qh.l,n);return this.setHSL(s,a,c),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Lr=new Ut;Ut.NAMES=Hm;class Ua extends Ir{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const qi=new le,Kh=new it;class ci{constructor(e,n,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=s,this.usage=vu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,s){e*=this.itemSize,s*=n.itemSize;for(let a=0,c=this.itemSize;a<c;a++)this.array[e+a]=n.array[s+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,s=this.count;n<s;n++)Kh.fromBufferAttribute(this,n),Kh.applyMatrix3(e),this.setXY(n,Kh.x,Kh.y);else if(this.itemSize===3)for(let n=0,s=this.count;n<s;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix3(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let n=0,s=this.count;n<s;n++)qi.fromBufferAttribute(this,n),qi.applyMatrix4(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let n=0,s=this.count;n<s;n++)qi.fromBufferAttribute(this,n),qi.applyNormalMatrix(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let n=0,s=this.count;n<s;n++)qi.fromBufferAttribute(this,n),qi.transformDirection(e),this.setXYZ(n,qi.x,qi.y,qi.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=qo(n,this.array)),n}setX(e,n){return this.normalized&&(n=Yt(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=qo(n,this.array)),n}setY(e,n){return this.normalized&&(n=Yt(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=qo(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Yt(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=qo(n,this.array)),n}setW(e,n){return this.normalized&&(n=Yt(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,s){return e*=this.itemSize,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array)),this.array[e+0]=n,this.array[e+1]=s,this}setXYZ(e,n,s,a){return e*=this.itemSize,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array),a=Yt(a,this.array)),this.array[e+0]=n,this.array[e+1]=s,this.array[e+2]=a,this}setXYZW(e,n,s,a,c){return e*=this.itemSize,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array),a=Yt(a,this.array),c=Yt(c,this.array)),this.array[e+0]=n,this.array[e+1]=s,this.array[e+2]=a,this.array[e+3]=c,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==vu&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Q0 extends ci{constructor(e,n,s){super(new Int8Array(e),n,s)}}class Po extends ci{constructor(e,n,s){super(new Uint8Array(e),n,s)}}class Vm extends ci{constructor(e,n,s){super(new Uint8ClampedArray(e),n,s)}}class Wm extends ci{constructor(e,n,s){super(new Int16Array(e),n,s)}}class As extends ci{constructor(e,n,s){super(new Uint16Array(e),n,s)}}class K0 extends ci{constructor(e,n,s){super(new Int32Array(e),n,s)}}class dc extends ci{constructor(e,n,s){super(new Uint32Array(e),n,s)}}class q0 extends ci{constructor(e,n,s){super(new Uint16Array(e),n,s),this.isFloat16BufferAttribute=!0}}class Qt extends ci{constructor(e,n,s){super(new Float32Array(e),n,s)}}class Z0 extends ci{constructor(e,n,s){super(new Float64Array(e),n,s)}}let Ef=0;const Fs=new Mn,Tf=new Gn,fc=new le,os=new _s,pc=new _s,tr=new le;class Rn extends Ko{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ef++}),this.uuid=vs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Gh(e)?dc:As)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,s=0){this.groups.push({start:e,count:n,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const c=new Ar().getNormalMatrix(e);s.applyNormalMatrix(c),s.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fs.makeRotationFromQuaternion(e),this.applyMatrix4(Fs),this}rotateX(e){return Fs.makeRotationX(e),this.applyMatrix4(Fs),this}rotateY(e){return Fs.makeRotationY(e),this.applyMatrix4(Fs),this}rotateZ(e){return Fs.makeRotationZ(e),this.applyMatrix4(Fs),this}translate(e,n,s){return Fs.makeTranslation(e,n,s),this.applyMatrix4(Fs),this}scale(e,n,s){return Fs.makeScale(e,n,s),this.applyMatrix4(Fs),this}lookAt(e){return Tf.lookAt(e),Tf.updateMatrix(),this.applyMatrix4(Tf.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fc).negate(),this.translate(fc.x,fc.y,fc.z),this}setFromPoints(e){const n=[];for(let s=0,a=e.length;s<a;s++){const c=e[s];n.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new Qt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _s);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const c=n[s];os.setFromBufferAttribute(c),this.morphTargetsRelative?(tr.addVectors(this.boundingBox.min,os.min),this.boundingBox.expandByPoint(tr),tr.addVectors(this.boundingBox.max,os.max),this.boundingBox.expandByPoint(tr)):(this.boundingBox.expandByPoint(os.min),this.boundingBox.expandByPoint(os.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ml);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new le,1/0);return}if(e){const s=this.boundingSphere.center;if(os.setFromBufferAttribute(e),n)for(let c=0,m=n.length;c<m;c++){const g=n[c];pc.setFromBufferAttribute(g),this.morphTargetsRelative?(tr.addVectors(os.min,pc.min),os.expandByPoint(tr),tr.addVectors(os.max,pc.max),os.expandByPoint(tr)):(os.expandByPoint(pc.min),os.expandByPoint(pc.max))}os.getCenter(s);let a=0;for(let c=0,m=e.count;c<m;c++)tr.fromBufferAttribute(e,c),a=Math.max(a,s.distanceToSquared(tr));if(n)for(let c=0,m=n.length;c<m;c++){const g=n[c],_=this.morphTargetsRelative;for(let w=0,A=g.count;w<A;w++)tr.fromBufferAttribute(g,w),_&&(fc.fromBufferAttribute(e,w),tr.add(fc)),a=Math.max(a,s.distanceToSquared(tr))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=e.array,a=n.position.array,c=n.normal.array,m=n.uv.array,g=a.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ci(new Float32Array(4*g),4));const _=this.getAttribute("tangent").array,w=[],A=[];for(let xe=0;xe<g;xe++)w[xe]=new le,A[xe]=new le;const C=new le,M=new le,R=new le,F=new it,D=new it,O=new it,W=new le,K=new le;function V(xe,We,Je){C.fromArray(a,xe*3),M.fromArray(a,We*3),R.fromArray(a,Je*3),F.fromArray(m,xe*2),D.fromArray(m,We*2),O.fromArray(m,Je*2),M.sub(C),R.sub(C),D.sub(F),O.sub(F);const Le=1/(D.x*O.y-O.x*D.y);isFinite(Le)&&(W.copy(M).multiplyScalar(O.y).addScaledVector(R,-D.y).multiplyScalar(Le),K.copy(R).multiplyScalar(D.x).addScaledVector(M,-O.x).multiplyScalar(Le),w[xe].add(W),w[We].add(W),w[Je].add(W),A[xe].add(K),A[We].add(K),A[Je].add(K))}let Y=this.groups;Y.length===0&&(Y=[{start:0,count:s.length}]);for(let xe=0,We=Y.length;xe<We;++xe){const Je=Y[xe],Le=Je.start,Me=Je.count;for(let Ke=Le,rt=Le+Me;Ke<rt;Ke+=3)V(s[Ke+0],s[Ke+1],s[Ke+2])}const se=new le,ue=new le,me=new le,J=new le;function ae(xe){me.fromArray(c,xe*3),J.copy(me);const We=w[xe];se.copy(We),se.sub(me.multiplyScalar(me.dot(We))).normalize(),ue.crossVectors(J,We);const Le=ue.dot(A[xe])<0?-1:1;_[xe*4]=se.x,_[xe*4+1]=se.y,_[xe*4+2]=se.z,_[xe*4+3]=Le}for(let xe=0,We=Y.length;xe<We;++xe){const Je=Y[xe],Le=Je.start,Me=Je.count;for(let Ke=Le,rt=Le+Me;Ke<rt;Ke+=3)ae(s[Ke+0]),ae(s[Ke+1]),ae(s[Ke+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new ci(new Float32Array(n.count*3),3),this.setAttribute("normal",s);else for(let M=0,R=s.count;M<R;M++)s.setXYZ(M,0,0,0);const a=new le,c=new le,m=new le,g=new le,_=new le,w=new le,A=new le,C=new le;if(e)for(let M=0,R=e.count;M<R;M+=3){const F=e.getX(M+0),D=e.getX(M+1),O=e.getX(M+2);a.fromBufferAttribute(n,F),c.fromBufferAttribute(n,D),m.fromBufferAttribute(n,O),A.subVectors(m,c),C.subVectors(a,c),A.cross(C),g.fromBufferAttribute(s,F),_.fromBufferAttribute(s,D),w.fromBufferAttribute(s,O),g.add(A),_.add(A),w.add(A),s.setXYZ(F,g.x,g.y,g.z),s.setXYZ(D,_.x,_.y,_.z),s.setXYZ(O,w.x,w.y,w.z)}else for(let M=0,R=n.count;M<R;M+=3)a.fromBufferAttribute(n,M+0),c.fromBufferAttribute(n,M+1),m.fromBufferAttribute(n,M+2),A.subVectors(m,c),C.subVectors(a,c),A.cross(C),s.setXYZ(M+0,A.x,A.y,A.z),s.setXYZ(M+1,A.x,A.y,A.z),s.setXYZ(M+2,A.x,A.y,A.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,s=e.count;n<s;n++)tr.fromBufferAttribute(e,n),tr.normalize(),e.setXYZ(n,tr.x,tr.y,tr.z)}toNonIndexed(){function e(g,_){const w=g.array,A=g.itemSize,C=g.normalized,M=new w.constructor(_.length*A);let R=0,F=0;for(let D=0,O=_.length;D<O;D++){g.isInterleavedBufferAttribute?R=_[D]*g.data.stride+g.offset:R=_[D]*A;for(let W=0;W<A;W++)M[F++]=w[R++]}return new ci(M,A,C)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Rn,s=this.index.array,a=this.attributes;for(const g in a){const _=a[g],w=e(_,s);n.setAttribute(g,w)}const c=this.morphAttributes;for(const g in c){const _=[],w=c[g];for(let A=0,C=w.length;A<C;A++){const M=w[A],R=e(M,s);_.push(R)}n.morphAttributes[g]=_}n.morphTargetsRelative=this.morphTargetsRelative;const m=this.groups;for(let g=0,_=m.length;g<_;g++){const w=m[g];n.addGroup(w.start,w.count,w.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const _=this.parameters;for(const w in _)_[w]!==void 0&&(e[w]=_[w]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const s=this.attributes;for(const _ in s){const w=s[_];e.data.attributes[_]=w.toJSON(e.data)}const a={};let c=!1;for(const _ in this.morphAttributes){const w=this.morphAttributes[_],A=[];for(let C=0,M=w.length;C<M;C++){const R=w[C];A.push(R.toJSON(e.data))}A.length>0&&(a[_]=A,c=!0)}c&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const m=this.groups;m.length>0&&(e.data.groups=JSON.parse(JSON.stringify(m)));const g=this.boundingSphere;return g!==null&&(e.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const s=e.index;s!==null&&this.setIndex(s.clone(n));const a=e.attributes;for(const w in a){const A=a[w];this.setAttribute(w,A.clone(n))}const c=e.morphAttributes;for(const w in c){const A=[],C=c[w];for(let M=0,R=C.length;M<R;M++)A.push(C[M].clone(n));this.morphAttributes[w]=A}this.morphTargetsRelative=e.morphTargetsRelative;const m=e.groups;for(let w=0,A=m.length;w<A;w++){const C=m[w];this.addGroup(C.start,C.count,C.materialIndex)}const g=e.boundingBox;g!==null&&(this.boundingBox=g.clone());const _=e.boundingSphere;return _!==null&&(this.boundingSphere=_.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Cf=new Mn,Ro=new jn,Cu=new ml,Pf=new le,Na=new le,mc=new le,Pu=new le,Rf=new le,qh=new le,Ru=new it,Zh=new it,Jh=new it,Du=new le,Pi=new le;class ur extends Gn{constructor(e=new Rn,n=new Ua){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,s=Object.keys(n);if(s.length>0){const a=n[s[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,m=a.length;c<m;c++){const g=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[g]=c}}}}getVertexPosition(e,n){const s=this.geometry,a=s.attributes.position,c=s.morphAttributes.position,m=s.morphTargetsRelative;n.fromBufferAttribute(a,e);const g=this.morphTargetInfluences;if(c&&g){qh.set(0,0,0);for(let _=0,w=c.length;_<w;_++){const A=g[_],C=c[_];A!==0&&(Rf.fromBufferAttribute(C,e),m?qh.addScaledVector(Rf,A):qh.addScaledVector(Rf.sub(n),A))}n.add(qh)}return this.isSkinnedMesh&&this.boneTransform(e,n),n}raycast(e,n){const s=this.geometry,a=this.material,c=this.matrixWorld;if(a===void 0||(s.boundingSphere===null&&s.computeBoundingSphere(),Cu.copy(s.boundingSphere),Cu.applyMatrix4(c),Ro.copy(e.ray).recast(e.near),Cu.containsPoint(Ro.origin)===!1&&(Ro.intersectSphere(Cu,Pf)===null||Ro.origin.distanceToSquared(Pf)>(e.far-e.near)**2))||(Cf.copy(c).invert(),Ro.copy(e.ray).applyMatrix4(Cf),s.boundingBox!==null&&Ro.intersectsBox(s.boundingBox)===!1))return;let m;const g=s.index,_=s.attributes.position,w=s.attributes.uv,A=s.attributes.uv2,C=s.groups,M=s.drawRange;if(g!==null)if(Array.isArray(a))for(let R=0,F=C.length;R<F;R++){const D=C[R],O=a[D.materialIndex],W=Math.max(D.start,M.start),K=Math.min(g.count,Math.min(D.start+D.count,M.start+M.count));for(let V=W,Y=K;V<Y;V+=3){const se=g.getX(V),ue=g.getX(V+1),me=g.getX(V+2);m=$h(this,O,e,Ro,w,A,se,ue,me),m&&(m.faceIndex=Math.floor(V/3),m.face.materialIndex=D.materialIndex,n.push(m))}}else{const R=Math.max(0,M.start),F=Math.min(g.count,M.start+M.count);for(let D=R,O=F;D<O;D+=3){const W=g.getX(D),K=g.getX(D+1),V=g.getX(D+2);m=$h(this,a,e,Ro,w,A,W,K,V),m&&(m.faceIndex=Math.floor(D/3),n.push(m))}}else if(_!==void 0)if(Array.isArray(a))for(let R=0,F=C.length;R<F;R++){const D=C[R],O=a[D.materialIndex],W=Math.max(D.start,M.start),K=Math.min(_.count,Math.min(D.start+D.count,M.start+M.count));for(let V=W,Y=K;V<Y;V+=3){const se=V,ue=V+1,me=V+2;m=$h(this,O,e,Ro,w,A,se,ue,me),m&&(m.faceIndex=Math.floor(V/3),m.face.materialIndex=D.materialIndex,n.push(m))}}else{const R=Math.max(0,M.start),F=Math.min(_.count,M.start+M.count);for(let D=R,O=F;D<O;D+=3){const W=D,K=D+1,V=D+2;m=$h(this,a,e,Ro,w,A,W,K,V),m&&(m.faceIndex=Math.floor(D/3),n.push(m))}}}}function J0(u,e,n,s,a,c,m,g){let _;if(e.side===ce?_=s.intersectTriangle(m,c,a,!0,g):_=s.intersectTriangle(a,c,m,e.side===$e,g),_===null)return null;Pi.copy(g),Pi.applyMatrix4(u.matrixWorld);const w=n.ray.origin.distanceTo(Pi);return w<n.near||w>n.far?null:{distance:w,point:Pi.clone(),object:u}}function $h(u,e,n,s,a,c,m,g,_){u.getVertexPosition(m,Na),u.getVertexPosition(g,mc),u.getVertexPosition(_,Pu);const w=J0(u,e,n,s,Na,mc,Pu,Du);if(w){a&&(Ru.fromBufferAttribute(a,m),Zh.fromBufferAttribute(a,g),Jh.fromBufferAttribute(a,_),w.uv=Os.getUV(Du,Na,mc,Pu,Ru,Zh,Jh,new it)),c&&(Ru.fromBufferAttribute(c,m),Zh.fromBufferAttribute(c,g),Jh.fromBufferAttribute(c,_),w.uv2=Os.getUV(Du,Na,mc,Pu,Ru,Zh,Jh,new it));const A={a:m,b:g,c:_,normal:new le,materialIndex:0};Os.getNormal(Na,mc,Pu,A.normal),w.face=A}return w}class za extends Rn{constructor(e=1,n=1,s=1,a=1,c=1,m=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:s,widthSegments:a,heightSegments:c,depthSegments:m};const g=this;a=Math.floor(a),c=Math.floor(c),m=Math.floor(m);const _=[],w=[],A=[],C=[];let M=0,R=0;F("z","y","x",-1,-1,s,n,e,m,c,0),F("z","y","x",1,-1,s,n,-e,m,c,1),F("x","z","y",1,1,e,s,n,a,m,2),F("x","z","y",1,-1,e,s,-n,a,m,3),F("x","y","z",1,-1,e,n,s,a,c,4),F("x","y","z",-1,-1,e,n,-s,a,c,5),this.setIndex(_),this.setAttribute("position",new Qt(w,3)),this.setAttribute("normal",new Qt(A,3)),this.setAttribute("uv",new Qt(C,2));function F(D,O,W,K,V,Y,se,ue,me,J,ae){const xe=Y/me,We=se/J,Je=Y/2,Le=se/2,Me=ue/2,Ke=me+1,rt=J+1;let yt=0,et=0;const _t=new le;for(let ut=0;ut<rt;ut++){const $t=ut*We-Le;for(let Fe=0;Fe<Ke;Fe++){const ft=Fe*xe-Je;_t[D]=ft*K,_t[O]=$t*V,_t[W]=Me,w.push(_t.x,_t.y,_t.z),_t[D]=0,_t[O]=0,_t[W]=ue>0?1:-1,A.push(_t.x,_t.y,_t.z),C.push(Fe/me),C.push(1-ut/J),yt+=1}}for(let ut=0;ut<J;ut++)for(let $t=0;$t<me;$t++){const Fe=M+$t+Ke*ut,ft=M+$t+Ke*(ut+1),Dt=M+($t+1)+Ke*(ut+1),_e=M+($t+1)+Ke*ut;_.push(Fe,ft,_e),_.push(ft,Dt,_e),et+=6}g.addGroup(R,et,ae),R+=et,M+=yt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new za(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function gc(u){const e={};for(const n in u){e[n]={};for(const s in u[n]){const a=u[n][s];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?e[n][s]=a.clone():Array.isArray(a)?e[n][s]=a.slice():e[n][s]=a}}return e}function Sr(u){const e={};for(let n=0;n<u.length;n++){const s=gc(u[n]);for(const a in s)e[a]=s[a]}return e}function $0(u){const e=[];for(let n=0;n<u.length;n++)e.push(u[n].clone());return e}function vc(u){return u.getRenderTarget()===null&&u.outputEncoding===pi?Ys:nc}const yc={clone:gc,merge:Sr},ey=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,_c=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class no extends Ir{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ey,this.fragmentShader=_c,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=gc(e.uniforms),this.uniformsGroups=$0(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const a in this.uniforms){const m=this.uniforms[a].value;m&&m.isTexture?n.uniforms[a]={type:"t",value:m.toJSON(e).uuid}:m&&m.isColor?n.uniforms[a]={type:"c",value:m.getHex()}:m&&m.isVector2?n.uniforms[a]={type:"v2",value:m.toArray()}:m&&m.isVector3?n.uniforms[a]={type:"v3",value:m.toArray()}:m&&m.isVector4?n.uniforms[a]={type:"v4",value:m.toArray()}:m&&m.isMatrix3?n.uniforms[a]={type:"m3",value:m.toArray()}:m&&m.isMatrix4?n.uniforms[a]={type:"m4",value:m.toArray()}:n.uniforms[a]={value:m}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;const s={};for(const a in this.extensions)this.extensions[a]===!0&&(s[a]=!0);return Object.keys(s).length>0&&(n.extensions=s),n}}class ed extends Gn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Mn,this.projectionMatrix=new Mn,this.projectionMatrixInverse=new Mn}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Mr extends ed{constructor(e=50,n=1,s=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=a,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Qs*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ul*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Qs*2*Math.atan(Math.tan(ul*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,s,a,c,m){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=s,this.view.offsetY=a,this.view.width=c,this.view.height=m,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(ul*.5*this.fov)/this.zoom,s=2*n,a=this.aspect*s,c=-.5*a;const m=this.view;if(this.view!==null&&this.view.enabled){const _=m.fullWidth,w=m.fullHeight;c+=m.offsetX*a/_,n-=m.offsetY*s/w,a*=m.width/_,s*=m.height/w}const g=this.filmOffset;g!==0&&(c+=e*g/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+a,n,n-s,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Ga=-90,yl=1;class Df extends Gn{constructor(e,n,s){super(),this.type="CubeCamera",this.renderTarget=s;const a=new Mr(Ga,yl,e,n);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(1,0,0),this.add(a);const c=new Mr(Ga,yl,e,n);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(-1,0,0),this.add(c);const m=new Mr(Ga,yl,e,n);m.layers=this.layers,m.up.set(0,0,-1),m.lookAt(0,1,0),this.add(m);const g=new Mr(Ga,yl,e,n);g.layers=this.layers,g.up.set(0,0,1),g.lookAt(0,-1,0),this.add(g);const _=new Mr(Ga,yl,e,n);_.layers=this.layers,_.up.set(0,1,0),_.lookAt(0,0,1),this.add(_);const w=new Mr(Ga,yl,e,n);w.layers=this.layers,w.up.set(0,1,0),w.lookAt(0,0,-1),this.add(w)}update(e,n){this.parent===null&&this.updateMatrixWorld();const s=this.renderTarget,[a,c,m,g,_,w]=this.children,A=e.getRenderTarget(),C=e.toneMapping,M=e.xr.enabled;e.toneMapping=Gr,e.xr.enabled=!1;const R=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0),e.render(n,a),e.setRenderTarget(s,1),e.render(n,c),e.setRenderTarget(s,2),e.render(n,m),e.setRenderTarget(s,3),e.render(n,g),e.setRenderTarget(s,4),e.render(n,_),s.texture.generateMipmaps=R,e.setRenderTarget(s,5),e.render(n,w),e.setRenderTarget(A),e.toneMapping=C,e.xr.enabled=M,s.texture.needsPMREMUpdate=!0}}class _l extends ri{constructor(e,n,s,a,c,m,g,_,w,A){e=e!==void 0?e:[],n=n!==void 0?n:yo,super(e,n,s,a,c,m,g,_,w,A),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class xc extends Ls{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const s={width:e,height:e,depth:1},a=[s,s,s,s,s,s];this.texture=new _l(a,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Ci}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new za(5,5,5),c=new no({name:"CubemapFromEquirect",uniforms:gc(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:ce,blending:re});c.uniforms.tEquirect.value=n;const m=new ur(a,c),g=n.minFilter;return n.minFilter===xo&&(n.minFilter=Ci),new Df(1,10,this).update(e,m),n.minFilter=g,m.geometry.dispose(),m.material.dispose(),this}clear(e,n,s,a){const c=e.getRenderTarget();for(let m=0;m<6;m++)e.setRenderTarget(this,m),e.clear(n,s,a);e.setRenderTarget(c)}}const If=new le,jm=new le,ty=new Ar;class oa{constructor(e=new le(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,s,a){return this.normal.set(e,n,s),this.constant=a,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,s){const a=If.subVectors(s,n).cross(jm.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const s=e.delta(If),a=this.normal.dot(s);if(a===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const c=-(e.start.dot(this.normal)+this.constant)/a;return c<0||c>1?null:n.copy(e.start).addScaledVector(s,c)}intersectsLine(e){const n=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return n<0&&s>0||s<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const s=n||ty.getNormalMatrix(e),a=this.coplanarPoint(If).applyMatrix4(e),c=this.normal.applyMatrix3(s).normalize();return this.constant=-a.dot(c),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const bc=new ml,xl=new le;class td{constructor(e=new oa,n=new oa,s=new oa,a=new oa,c=new oa,m=new oa){this.planes=[e,n,s,a,c,m]}set(e,n,s,a,c,m){const g=this.planes;return g[0].copy(e),g[1].copy(n),g[2].copy(s),g[3].copy(a),g[4].copy(c),g[5].copy(m),this}copy(e){const n=this.planes;for(let s=0;s<6;s++)n[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e){const n=this.planes,s=e.elements,a=s[0],c=s[1],m=s[2],g=s[3],_=s[4],w=s[5],A=s[6],C=s[7],M=s[8],R=s[9],F=s[10],D=s[11],O=s[12],W=s[13],K=s[14],V=s[15];return n[0].setComponents(g-a,C-_,D-M,V-O).normalize(),n[1].setComponents(g+a,C+_,D+M,V+O).normalize(),n[2].setComponents(g+c,C+w,D+R,V+W).normalize(),n[3].setComponents(g-c,C-w,D-R,V-W).normalize(),n[4].setComponents(g-m,C-A,D-F,V-K).normalize(),n[5].setComponents(g+m,C+A,D+F,V+K).normalize(),this}intersectsObject(e){const n=e.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),bc.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(bc)}intersectsSprite(e){return bc.center.set(0,0,0),bc.radius=.7071067811865476,bc.applyMatrix4(e.matrixWorld),this.intersectsSphere(bc)}intersectsSphere(e){const n=this.planes,s=e.center,a=-e.radius;for(let c=0;c<6;c++)if(n[c].distanceToPoint(s)<a)return!1;return!0}intersectsBox(e){const n=this.planes;for(let s=0;s<6;s++){const a=n[s];if(xl.x=a.normal.x>0?e.max.x:e.min.x,xl.y=a.normal.y>0?e.max.y:e.min.y,xl.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(xl)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let s=0;s<6;s++)if(n[s].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Xm(){let u=null,e=!1,n=null,s=null;function a(c,m){n(c,m),s=u.requestAnimationFrame(a)}return{start:function(){e!==!0&&n!==null&&(s=u.requestAnimationFrame(a),e=!0)},stop:function(){u.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(c){n=c},setContext:function(c){u=c}}}function ny(u,e){const n=e.isWebGL2,s=new WeakMap;function a(w,A){const C=w.array,M=w.usage,R=u.createBuffer();u.bindBuffer(A,R),u.bufferData(A,C,M),w.onUploadCallback();let F;if(C instanceof Float32Array)F=u.FLOAT;else if(C instanceof Uint16Array)if(w.isFloat16BufferAttribute)if(n)F=u.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else F=u.UNSIGNED_SHORT;else if(C instanceof Int16Array)F=u.SHORT;else if(C instanceof Uint32Array)F=u.UNSIGNED_INT;else if(C instanceof Int32Array)F=u.INT;else if(C instanceof Int8Array)F=u.BYTE;else if(C instanceof Uint8Array)F=u.UNSIGNED_BYTE;else if(C instanceof Uint8ClampedArray)F=u.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+C);return{buffer:R,type:F,bytesPerElement:C.BYTES_PER_ELEMENT,version:w.version}}function c(w,A,C){const M=A.array,R=A.updateRange;u.bindBuffer(C,w),R.count===-1?u.bufferSubData(C,0,M):(n?u.bufferSubData(C,R.offset*M.BYTES_PER_ELEMENT,M,R.offset,R.count):u.bufferSubData(C,R.offset*M.BYTES_PER_ELEMENT,M.subarray(R.offset,R.offset+R.count)),R.count=-1),A.onUploadCallback()}function m(w){return w.isInterleavedBufferAttribute&&(w=w.data),s.get(w)}function g(w){w.isInterleavedBufferAttribute&&(w=w.data);const A=s.get(w);A&&(u.deleteBuffer(A.buffer),s.delete(w))}function _(w,A){if(w.isGLBufferAttribute){const M=s.get(w);(!M||M.version<w.version)&&s.set(w,{buffer:w.buffer,type:w.type,bytesPerElement:w.elementSize,version:w.version});return}w.isInterleavedBufferAttribute&&(w=w.data);const C=s.get(w);C===void 0?s.set(w,a(w,A)):C.version<w.version&&(c(C.buffer,w,A),C.version=w.version)}return{get:m,remove:g,update:_}}class wc extends Rn{constructor(e=1,n=1,s=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:s,heightSegments:a};const c=e/2,m=n/2,g=Math.floor(s),_=Math.floor(a),w=g+1,A=_+1,C=e/g,M=n/_,R=[],F=[],D=[],O=[];for(let W=0;W<A;W++){const K=W*M-m;for(let V=0;V<w;V++){const Y=V*C-c;F.push(Y,-K,0),D.push(0,0,1),O.push(V/g),O.push(1-W/_)}}for(let W=0;W<_;W++)for(let K=0;K<g;K++){const V=K+w*W,Y=K+w*(W+1),se=K+1+w*(W+1),ue=K+1+w*W;R.push(V,Y,ue),R.push(Y,se,ue)}this.setIndex(R),this.setAttribute("position",new Qt(F,3)),this.setAttribute("normal",new Qt(D,3)),this.setAttribute("uv",new Qt(O,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wc(e.width,e.height,e.widthSegments,e.heightSegments)}}const En={alphamap_fragment:`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`,alphamap_pars_fragment:`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,alphatest_fragment:`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`,alphatest_pars_fragment:`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`,aomap_fragment:`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`,aomap_pars_fragment:`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`,begin_vertex:`
vec3 transformed = vec3( position );
`,beginnormal_vertex:`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`,bsdfs:`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );

    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disneys reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

#ifdef USE_IRIDESCENCE

	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {

		float alpha = pow2( roughness ); // UE4's roughness

		vec3 halfDir = normalize( lightDir + viewDir );

		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );

		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

		return F * ( V * D );

	}

#endif

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`,iridescence_fragment:`

#ifdef USE_IRIDESCENCE

	// XYZ to linear-sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	// Assume air interface for top
	// Note: We don't handle the case fresnel0 == 1
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float IorToFresnel0( float transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));

	}

	// Fresnel equations for dielectric/dielectric interfaces.
	// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	// Evaluation XYZ sensitivity curves in Fourier space
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;

		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;

	}

	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			 return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;

		// Phase shift
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

#endif

`,bumpmap_pars_fragment:`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm; // normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,clipping_planes_fragment:`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`,clipping_planes_pars_fragment:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`,clipping_planes_pars_vertex:`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`,clipping_planes_vertex:`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`,color_fragment:`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`,color_pars_fragment:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`,color_pars_vertex:`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`,color_vertex:`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`,common:`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

float luminance( const in vec3 rgb ) {

	// assumes rgb is in linear color space with sRGB primaries and D65 white point

	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );

	return dot( weights, rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}

// Mipped Bicubic Texture Filtering by N8
// https://www.shadertoy.com/view/Dl2SDW

float w0( float a ) {

	return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );

}

float w1( float a ) {

	return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );

}

float w2( float a ){

    return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );

}

float w3( float a ) {

	return ( 1.0 / 6.0 ) * ( a * a * a );

}

// g0 and g1 are the two amplitude functions
float g0( float a ) {

	return w0( a ) + w1( a );

}

float g1( float a ) {

	return w2( a ) + w3( a );

}

// h0 and h1 are the two offset functions
float h0( float a ) {

	return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );

}

float h1( float a ) {

    return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );

}

vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {

	uv = uv * texelSize.zw + 0.5;

	vec2 iuv = floor( uv );
    vec2 fuv = fract( uv );

    float g0x = g0( fuv.x );
    float g1x = g1( fuv.x );
    float h0x = h0( fuv.x );
    float h1x = h1( fuv.x );
    float h0y = h0( fuv.y );
    float h1y = h1( fuv.y );

    vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
    vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
    vec2 lodFudge = pow( 1.95, lod ) / fullSize;
#if __VERSION__ > 130
	return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
		   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
#else
	return texture2D(tex, uv); //TODO: remove
#endif
}

vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {

#if __VERSION__ > 130
	vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
	vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
	vec2 fLodSizeInv = 1.0 / fLodSize;
	vec2 cLodSizeInv = 1.0 / cLodSize;
	vec2 fullSize = vec2( textureSize( sampler, 0 ) );
	vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
	vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
	return mix( fSample, cSample, fract( lod ) );
#else
	return texture2D(sampler, uv); //TODO: remove
#endif

}
`,cube_uv_reflection_fragment:`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		uv.x += filterInt * 3.0 * cubeUV_minTileSize;

		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );

		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;

		#ifdef texture2DGradEXT

			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering

		#else

			return texture2D( envMap, uv ).rgb;

		#endif

	}

	// These defines must match with PMREMGenerator

	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= cubeUV_r1 ) {

			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;

		} else if ( roughness >= cubeUV_r4 ) {

			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;

		} else if ( roughness >= cubeUV_r5 ) {

			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;

		} else if ( roughness >= cubeUV_r6 ) {

			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`,defaultnormal_vertex:`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`,displacementmap_pars_vertex:`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`,displacementmap_vertex:`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`,emissivemap_fragment:`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`,emissivemap_pars_fragment:`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`,encodings_fragment:`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`,encodings_pars_fragment:`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`,envmap_fragment:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,envmap_common_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`,envmap_pars_fragment:`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`,envmap_pars_vertex:`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`,envmap_physical_pars_fragment:`
#if defined( USE_ENVMAP )

#if defined( USE_BOX_PROJECTION )

	uniform vec4 probePos;
	uniform vec3 probeBoxMin;
	uniform vec3 probeBoxMax;

	vec3 boxProjection(vec3 nrdir, vec3 worldPos, vec3 probePos, vec3 boxMin, vec3 boxMax) {

		vec3 tbot = boxMin - worldPos;
		vec3 ttop = boxMax - worldPos;
		vec3 tmax = mix(tbot, ttop, step(vec3(0), nrdir));
		tmax /= nrdir;
		float t = min(min(tmax.x, tmax.y), tmax.z);
		return worldPos + nrdir * t - probePos;
	
	}

#endif

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec = reflect( - viewDir, normal );

			// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

		#if defined( USE_BOX_PROJECTION )
			if (probePos.w > 0.001) {
				reflectVec = boxProjection(reflectVec, vWorldPosition, probePos.xyz, probeBoxMin.xyz, probeBoxMax.xyz);
			}
		#endif

			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`,envmap_vertex:`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`,fog_vertex:`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`,fog_pars_vertex:`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`,fog_fragment:`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`,fog_pars_fragment:`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`,gradientmap_pars_fragment:`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );

	#endif

}
`,lightmap_fragment:`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`,lightmap_pars_fragment:`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`,lights_lambert_fragment:`
LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;
`,lights_lambert_pars_fragment:`
varying vec3 vViewPosition;

struct LambertMaterial {

	vec3 diffuseColor;
	float specularStrength;

};

void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
`,lights_pars_begin:`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( LEGACY_LIGHTS )

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#else

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`,lights_toon_fragment:`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`,lights_toon_pars_fragment:`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
`,lights_phong_fragment:`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment:`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,lights_physical_fragment:`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	material.ior = ior;

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_IRIDESCENCE

	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;

	#ifdef USE_IRIDESCENCEMAP

		material.iridescence *= texture2D( iridescenceMap, vUv ).r;

	#endif

	#ifdef USE_IRIDESCENCE_THICKNESSMAP

		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;

	#else

		material.iridescenceThickness = iridescenceThicknessMaximum;

	#endif

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`,lights_physical_pars_fragment:`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

	#ifdef IOR
		float ior;
	#endif

	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Agera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	#ifdef USE_IRIDESCENCE

		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );

	#else

		vec3 Fr = specularColor;

	#endif

	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	#ifdef USE_IRIDESCENCE

		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );

	#else

		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );

	#endif

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	#ifdef USE_IRIDESCENCE

		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );

	#else

		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	#endif

	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`,lights_fragment_begin:`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

#ifdef USE_IRIDESCENCE

	float dotNVi = saturate( dot( normal, geometry.viewDir ) );

	if ( material.iridescenceThickness == 0.0 ) {

		material.iridescence = 0.0;

	} else {

		material.iridescence = saturate( material.iridescence );

	}

	if ( material.iridescence > 0.0 ) {

		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );

		// Iridescence F0 approximation
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );

	}

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;

	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif

		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif

		#undef SPOT_LIGHT_MAP_INDEX

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_fragment_maps:`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`,lights_fragment_end:`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`,logdepthbuf_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`,logdepthbuf_pars_fragment:`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_pars_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`,logdepthbuf_vertex:`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`,map_fragment:`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`,map_pars_fragment:`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`,map_particle_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`,map_particle_pars_fragment:`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,metalnessmap_fragment:`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`,metalnessmap_pars_fragment:`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`,morphcolor_vertex:`
#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	vColor *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		#if defined( USE_COLOR_ALPHA )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];

		#elif defined( USE_COLOR )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];

		#endif

	}

#endif
`,morphnormal_vertex:`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`,morphtarget_pars_vertex:`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;

		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {

			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;

			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`,morphtarget_vertex:`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`,normal_fragment_begin:`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`,normal_fragment_maps:`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`,normal_pars_fragment:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_pars_vertex:`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_vertex:`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`,normalmap_pars_fragment:`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`,clearcoat_normal_fragment_begin:`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`,clearcoat_normal_fragment_maps:`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`,clearcoat_pars_fragment:`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`,iridescence_pars_fragment:`

#ifdef USE_IRIDESCENCEMAP

	uniform sampler2D iridescenceMap;

#endif

#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform sampler2D iridescenceThicknessMap;

#endif
`,output_fragment:`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`,packing:`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}

float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,premultiplied_alpha_fragment:`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`,project_vertex:`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment:`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`,dithering_pars_fragment:`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift according to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`,roughnessmap_fragment:`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`,roughnessmap_pars_fragment:`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`,shadowmap_pars_fragment:`
#if NUM_SPOT_LIGHT_COORDS > 0

	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#if NUM_SPOT_LIGHT_MAPS > 0

	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`,shadowmap_pars_vertex:`

#if NUM_SPOT_LIGHT_COORDS > 0

	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`,shadowmap_vertex:`

#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )

	// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;

#endif

#if defined( USE_SHADOWMAP )

	#if NUM_DIR_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif

// spot lights can be evaluated without active shadow mapping (when SpotLight.map is used)

#if NUM_SPOT_LIGHT_COORDS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {

		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

#endif


`,shadowmask_pars_fragment:`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`,skinbase_vertex:`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`,skinning_pars_vertex:`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;

	mat4 getBoneMatrix( const in float i ) {

		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );

		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );

		y = dy * ( y + 0.5 );

		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

		mat4 bone = mat4( v1, v2, v3, v4 );

		return bone;

	}

#endif
`,skinning_vertex:`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`,skinnormal_vertex:`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`,specularmap_fragment:`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`,specularmap_pars_fragment:`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`,tonemapping_fragment:`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`,tonemapping_pars_fragment:`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );
}

vec3 CustomToneMapping( vec3 color ) { return color; }
`,transmission_fragment:`
#ifdef USE_TRANSMISSION

	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		material.transmission *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		material.thickness *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );

	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );

#endif
`,transmission_pars_fragment:`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( isinf( attenuationDistance ) ) {

			// Attenuation distance is +, i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`,uv_pars_fragment:`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`,uv_pars_vertex:`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`,uv_vertex:`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`,uv2_pars_fragment:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`,uv2_pars_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`,uv2_vertex:`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`,worldpos_vertex:`
#if defined( USE_BOX_PROJECTION ) || defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`,background_vert:`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,background_frag:`
uniform sampler2D t2D;
uniform float backgroundIntensity;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,backgroundCube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,backgroundCube_frag:`

#ifdef ENVMAP_TYPE_CUBE

	uniform samplerCube envMap;

#elif defined( ENVMAP_TYPE_CUBE_UV )

	uniform sampler2D envMap;

#endif

uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 dir = vWorldDirection;

	#ifdef ENVMAP_TYPE_CUBE

		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * dir.x, dir.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 texColor = textureCubeUV( envMap, dir, backgroundBlurriness );

	#else

		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,cube_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,cube_frag:`
uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;

varying vec3 vWorldDirection;

void main() {

	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );

	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,depth_vert:`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,depth_frag:`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`,distanceRGBA_vert:`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,distanceRGBA_frag:`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`,equirect_vert:`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,equirect_frag:`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`,linedashed_vert:`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,linedashed_frag:`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,meshbasic_vert:`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,meshbasic_frag:`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshlambert_vert:`
#define LAMBERT

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshlambert_frag:`
#define LAMBERT

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshmatcap_vert:`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,meshmatcap_frag:`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshnormal_vert:`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,meshnormal_frag:`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`,meshphong_vert:`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshphong_frag:`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,meshphysical_vert:`
#define STANDARD

varying vec3 vViewPosition;

#if defined(USE_TRANSMISSION) || defined(USE_BOX_PROJECTION)

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#if defined(USE_TRANSMISSION) || defined(USE_BOX_PROJECTION)

	vWorldPosition = worldPosition.xyz;

#endif
}
`,meshphysical_frag:`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#if defined(USE_TRANSMISSION) || defined(USE_BOX_PROJECTION)

varying vec3 vWorldPosition;

#endif

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

#if defined(DEBUG_OCCLUSION) && defined(USE_AOMAP)
	gl_FragColor.rgb = vec3(ambientOcclusion);
#endif

#if defined(DEBUG_NORMAL)
	gl_FragColor.rgb = geometry.normal * 0.5 + 0.5;
#endif

#if defined(DEBUG_ROUGHNESS)
	gl_FragColor.rgb = vec3(material.roughness);
#endif

#if defined(DEBUG_METALNESS)
	gl_FragColor.rgb = vec3(metalnessFactor);
#endif

}
`,meshtoon_vert:`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,meshtoon_frag:`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,points_vert:`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,points_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,shadow_vert:`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,shadow_frag:`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	#include <logdepthbuf_fragment>

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`,sprite_vert:`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,sprite_frag:`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`},Et={common:{diffuse:{value:new Ut(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ar},uv2Transform:{value:new Ar},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new it(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ar}},sprite:{diffuse:{value:new Ut(16777215)},opacity:{value:1},center:{value:new it(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ar}}},jr={basic:{uniforms:Sr([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.fog]),vertexShader:En.meshbasic_vert,fragmentShader:En.meshbasic_frag},lambert:{uniforms:Sr([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new Ut(0)}}]),vertexShader:En.meshlambert_vert,fragmentShader:En.meshlambert_frag},phong:{uniforms:Sr([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:En.meshphong_vert,fragmentShader:En.meshphong_frag},standard:{uniforms:Sr([Et.common,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.roughnessmap,Et.metalnessmap,Et.fog,Et.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:En.meshphysical_vert,fragmentShader:En.meshphysical_frag},toon:{uniforms:Sr([Et.common,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.gradientmap,Et.fog,Et.lights,{emissive:{value:new Ut(0)}}]),vertexShader:En.meshtoon_vert,fragmentShader:En.meshtoon_frag},matcap:{uniforms:Sr([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,{matcap:{value:null}}]),vertexShader:En.meshmatcap_vert,fragmentShader:En.meshmatcap_frag},points:{uniforms:Sr([Et.points,Et.fog]),vertexShader:En.points_vert,fragmentShader:En.points_frag},dashed:{uniforms:Sr([Et.common,Et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:En.linedashed_vert,fragmentShader:En.linedashed_frag},depth:{uniforms:Sr([Et.common,Et.displacementmap]),vertexShader:En.depth_vert,fragmentShader:En.depth_frag},normal:{uniforms:Sr([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,{opacity:{value:1}}]),vertexShader:En.meshnormal_vert,fragmentShader:En.meshnormal_frag},sprite:{uniforms:Sr([Et.sprite,Et.fog]),vertexShader:En.sprite_vert,fragmentShader:En.sprite_frag},background:{uniforms:{uvTransform:{value:new Ar},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:En.background_vert,fragmentShader:En.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:En.backgroundCube_vert,fragmentShader:En.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:En.cube_vert,fragmentShader:En.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:En.equirect_vert,fragmentShader:En.equirect_frag},distanceRGBA:{uniforms:Sr([Et.common,Et.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:En.distanceRGBA_vert,fragmentShader:En.distanceRGBA_frag},shadow:{uniforms:Sr([Et.lights,Et.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:En.shadow_vert,fragmentShader:En.shadow_frag}};jr.physical={uniforms:Sr([jr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new it(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ut(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new it},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ut(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ut(1,1,1)},specularColorMap:{value:null}}]),vertexShader:En.meshphysical_vert,fragmentShader:En.meshphysical_frag};const ja={r:0,b:0,g:0};function Bn(u,e,n,s,a,c,m){const g=new Ut(0);let _=c===!0?0:1,w,A,C=null,M=0,R=null;function F(O,W){let K=!1,V=W.isScene===!0?W.background:null;V&&V.isTexture&&(V=(W.backgroundBlurriness>0?n:e).get(V));const Y=u.xr,se=Y.getSession&&Y.getSession();se&&se.environmentBlendMode==="additive"&&(V=null),V===null?D(g,_):V&&V.isColor&&(D(V,1),K=!0),(u.autoClear||K)&&u.clear(u.autoClearColor,u.autoClearDepth,u.autoClearStencil),V&&(V.isCubeTexture||V.mapping===yr)?(A===void 0&&(A=new ur(new za(1,1,1),new no({name:"BackgroundCubeMaterial",uniforms:gc(jr.backgroundCube.uniforms),vertexShader:jr.backgroundCube.vertexShader,fragmentShader:jr.backgroundCube.fragmentShader,side:ce,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(ue,me,J){this.matrixWorld.copyPosition(J.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(A)),A.material.uniforms.envMap.value=V,A.material.uniforms.flipEnvMap.value=V.isCubeTexture&&V.isRenderTargetTexture===!1?-1:1,A.material.uniforms.backgroundBlurriness.value=W.backgroundBlurriness,A.material.uniforms.backgroundIntensity.value=W.backgroundIntensity,A.material.toneMapped=V.encoding!==pi,(C!==V||M!==V.version||R!==u.toneMapping)&&(A.material.needsUpdate=!0,C=V,M=V.version,R=u.toneMapping),A.layers.enableAll(),O.unshift(A,A.geometry,A.material,0,0,null)):V&&V.isTexture&&(w===void 0&&(w=new ur(new wc(2,2),new no({name:"BackgroundMaterial",uniforms:gc(jr.background.uniforms),vertexShader:jr.background.vertexShader,fragmentShader:jr.background.fragmentShader,side:$e,depthTest:!1,depthWrite:!1,fog:!1})),w.geometry.deleteAttribute("normal"),Object.defineProperty(w.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(w)),w.material.uniforms.t2D.value=V,w.material.uniforms.backgroundIntensity.value=W.backgroundIntensity,w.material.toneMapped=V.encoding!==pi,V.matrixAutoUpdate===!0&&V.updateMatrix(),w.material.uniforms.uvTransform.value.copy(V.matrix),(C!==V||M!==V.version||R!==u.toneMapping)&&(w.material.needsUpdate=!0,C=V,M=V.version,R=u.toneMapping),w.layers.enableAll(),O.unshift(w,w.geometry,w.material,0,0,null))}function D(O,W){O.getRGB(ja,vc(u)),s.buffers.color.setClear(ja.r,ja.g,ja.b,W,m)}return{getClearColor:function(){return g},setClearColor:function(O,W=1){g.set(O),_=W,D(g,_)},getClearAlpha:function(){return _},setClearAlpha:function(O){_=O,D(g,_)},render:F}}function $m(u,e,n,s){const a=u.getParameter(u.MAX_VERTEX_ATTRIBS),c=s.isWebGL2?null:e.get("OES_vertex_array_object"),m=s.isWebGL2||c!==null,g={},_=O(null);let w=_,A=!1;function C(Me,Ke,rt,yt,et){let _t=!1;if(m){const ut=D(yt,rt,Ke);w!==ut&&(w=ut,R(w.object)),_t=W(Me,yt,rt,et),_t&&K(Me,yt,rt,et)}else{const ut=Ke.wireframe===!0;(w.geometry!==yt.id||w.program!==rt.id||w.wireframe!==ut)&&(w.geometry=yt.id,w.program=rt.id,w.wireframe=ut,_t=!0)}et!==null&&n.update(et,u.ELEMENT_ARRAY_BUFFER),(_t||A)&&(A=!1,J(Me,Ke,rt,yt),et!==null&&u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n.get(et).buffer))}function M(){return s.isWebGL2?u.createVertexArray():c.createVertexArrayOES()}function R(Me){return s.isWebGL2?u.bindVertexArray(Me):c.bindVertexArrayOES(Me)}function F(Me){return s.isWebGL2?u.deleteVertexArray(Me):c.deleteVertexArrayOES(Me)}function D(Me,Ke,rt){const yt=rt.wireframe===!0;let et=g[Me.id];et===void 0&&(et={},g[Me.id]=et);let _t=et[Ke.id];_t===void 0&&(_t={},et[Ke.id]=_t);let ut=_t[yt];return ut===void 0&&(ut=O(M()),_t[yt]=ut),ut}function O(Me){const Ke=[],rt=[],yt=[];for(let et=0;et<a;et++)Ke[et]=0,rt[et]=0,yt[et]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ke,enabledAttributes:rt,attributeDivisors:yt,object:Me,attributes:{},index:null}}function W(Me,Ke,rt,yt){const et=w.attributes,_t=Ke.attributes;let ut=0;const $t=rt.getAttributes();for(const Fe in $t)if($t[Fe].location>=0){const Dt=et[Fe];let _e=_t[Fe];if(_e===void 0&&(Fe==="instanceMatrix"&&Me.instanceMatrix&&(_e=Me.instanceMatrix),Fe==="instanceColor"&&Me.instanceColor&&(_e=Me.instanceColor)),Dt===void 0||Dt.attribute!==_e||_e&&Dt.data!==_e.data)return!0;ut++}return w.attributesNum!==ut||w.index!==yt}function K(Me,Ke,rt,yt){const et={},_t=Ke.attributes;let ut=0;const $t=rt.getAttributes();for(const Fe in $t)if($t[Fe].location>=0){let Dt=_t[Fe];Dt===void 0&&(Fe==="instanceMatrix"&&Me.instanceMatrix&&(Dt=Me.instanceMatrix),Fe==="instanceColor"&&Me.instanceColor&&(Dt=Me.instanceColor));const _e={};_e.attribute=Dt,Dt&&Dt.data&&(_e.data=Dt.data),et[Fe]=_e,ut++}w.attributes=et,w.attributesNum=ut,w.index=yt}function V(){const Me=w.newAttributes;for(let Ke=0,rt=Me.length;Ke<rt;Ke++)Me[Ke]=0}function Y(Me){se(Me,0)}function se(Me,Ke){const rt=w.newAttributes,yt=w.enabledAttributes,et=w.attributeDivisors;rt[Me]=1,yt[Me]===0&&(u.enableVertexAttribArray(Me),yt[Me]=1),et[Me]!==Ke&&((s.isWebGL2?u:e.get("ANGLE_instanced_arrays"))[s.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Me,Ke),et[Me]=Ke)}function ue(){const Me=w.newAttributes,Ke=w.enabledAttributes;for(let rt=0,yt=Ke.length;rt<yt;rt++)Ke[rt]!==Me[rt]&&(u.disableVertexAttribArray(rt),Ke[rt]=0)}function me(Me,Ke,rt,yt,et,_t){s.isWebGL2===!0&&(rt===u.INT||rt===u.UNSIGNED_INT)?u.vertexAttribIPointer(Me,Ke,rt,et,_t):u.vertexAttribPointer(Me,Ke,rt,yt,et,_t)}function J(Me,Ke,rt,yt){if(s.isWebGL2===!1&&(Me.isInstancedMesh||yt.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;V();const et=yt.attributes,_t=rt.getAttributes(),ut=Ke.defaultAttributeValues;for(const $t in _t){const Fe=_t[$t];if(Fe.location>=0){let ft=et[$t];if(ft===void 0&&($t==="instanceMatrix"&&Me.instanceMatrix&&(ft=Me.instanceMatrix),$t==="instanceColor"&&Me.instanceColor&&(ft=Me.instanceColor)),ft!==void 0){const Dt=ft.normalized,_e=ft.itemSize,qt=n.get(ft);if(qt===void 0)continue;const Bt=qt.buffer,Kt=qt.type,en=qt.bytesPerElement;if(ft.isInterleavedBufferAttribute){const sn=ft.data,xn=sn.stride,tt=ft.offset;if(sn.isInstancedInterleavedBuffer){for(let ct=0;ct<Fe.locationSize;ct++)se(Fe.location+ct,sn.meshPerAttribute);Me.isInstancedMesh!==!0&&yt._maxInstanceCount===void 0&&(yt._maxInstanceCount=sn.meshPerAttribute*sn.count)}else for(let ct=0;ct<Fe.locationSize;ct++)Y(Fe.location+ct);u.bindBuffer(u.ARRAY_BUFFER,Bt);for(let ct=0;ct<Fe.locationSize;ct++)me(Fe.location+ct,_e/Fe.locationSize,Kt,Dt,xn*en,(tt+_e/Fe.locationSize*ct)*en)}else{if(ft.isInstancedBufferAttribute){for(let sn=0;sn<Fe.locationSize;sn++)se(Fe.location+sn,ft.meshPerAttribute);Me.isInstancedMesh!==!0&&yt._maxInstanceCount===void 0&&(yt._maxInstanceCount=ft.meshPerAttribute*ft.count)}else for(let sn=0;sn<Fe.locationSize;sn++)Y(Fe.location+sn);u.bindBuffer(u.ARRAY_BUFFER,Bt);for(let sn=0;sn<Fe.locationSize;sn++)me(Fe.location+sn,_e/Fe.locationSize,Kt,Dt,_e*en,_e/Fe.locationSize*sn*en)}}else if(ut!==void 0){const Dt=ut[$t];if(Dt!==void 0)switch(Dt.length){case 2:u.vertexAttrib2fv(Fe.location,Dt);break;case 3:u.vertexAttrib3fv(Fe.location,Dt);break;case 4:u.vertexAttrib4fv(Fe.location,Dt);break;default:u.vertexAttrib1fv(Fe.location,Dt)}}}}ue()}function ae(){Je();for(const Me in g){const Ke=g[Me];for(const rt in Ke){const yt=Ke[rt];for(const et in yt)F(yt[et].object),delete yt[et];delete Ke[rt]}delete g[Me]}}function xe(Me){if(g[Me.id]===void 0)return;const Ke=g[Me.id];for(const rt in Ke){const yt=Ke[rt];for(const et in yt)F(yt[et].object),delete yt[et];delete Ke[rt]}delete g[Me.id]}function We(Me){for(const Ke in g){const rt=g[Ke];if(rt[Me.id]===void 0)continue;const yt=rt[Me.id];for(const et in yt)F(yt[et].object),delete yt[et];delete rt[Me.id]}}function Je(){Le(),A=!0,w!==_&&(w=_,R(w.object))}function Le(){_.geometry=null,_.program=null,_.wireframe=!1}return{setup:C,reset:Je,resetDefaultState:Le,dispose:ae,releaseStatesOfGeometry:xe,releaseStatesOfProgram:We,initAttributes:V,enableAttribute:Y,disableUnusedAttributes:ue}}function wy(u,e,n,s){const a=s.isWebGL2;let c;function m(w){c=w}function g(w,A){u.drawArrays(c,w,A),n.update(A,c,1)}function _(w,A,C){if(C===0)return;let M,R;if(a)M=u,R="drawArraysInstanced";else if(M=e.get("ANGLE_instanced_arrays"),R="drawArraysInstancedANGLE",M===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[R](c,w,A,C),n.update(A,c,C)}this.setMode=m,this.render=g,this.renderInstances=_}function j(u,e,n){let s;function a(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const me=e.get("EXT_texture_filter_anisotropic");s=u.getParameter(me.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function c(me){if(me==="highp"){if(u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.HIGH_FLOAT).precision>0&&u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT).precision>0)return"highp";me="mediump"}return me==="mediump"&&u.getShaderPrecisionFormat(u.VERTEX_SHADER,u.MEDIUM_FLOAT).precision>0&&u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const m=typeof WebGL2RenderingContext<"u"&&u instanceof WebGL2RenderingContext;let g=n.precision!==void 0?n.precision:"highp";const _=c(g);_!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",_,"instead."),g=_);const w=m||e.has("WEBGL_draw_buffers"),A=n.logarithmicDepthBuffer===!0,C=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS),M=u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=u.getParameter(u.MAX_TEXTURE_SIZE),F=u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE),D=u.getParameter(u.MAX_VERTEX_ATTRIBS),O=u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS),W=u.getParameter(u.MAX_VARYING_VECTORS),K=u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS),V=M>0,Y=m||e.has("OES_texture_float"),se=V&&Y,ue=m?u.getParameter(u.MAX_SAMPLES):0;return{isWebGL2:m,drawBuffers:w,getMaxAnisotropy:a,getMaxPrecision:c,precision:g,logarithmicDepthBuffer:A,maxTextures:C,maxVertexTextures:M,maxTextureSize:R,maxCubemapSize:F,maxAttributes:D,maxVertexUniforms:O,maxVaryings:W,maxFragmentUniforms:K,vertexTextures:V,floatFragmentTextures:Y,floatVertexTextures:se,maxSamples:ue}}function te(u){const e=this;let n=null,s=0,a=!1,c=!1;const m=new oa,g=new Ar,_={value:null,needsUpdate:!1};this.uniform=_,this.numPlanes=0,this.numIntersection=0,this.init=function(C,M){const R=C.length!==0||M||s!==0||a;return a=M,s=C.length,R},this.beginShadows=function(){c=!0,A(null)},this.endShadows=function(){c=!1},this.setGlobalState=function(C,M){n=A(C,M,0)},this.setState=function(C,M,R){const F=C.clippingPlanes,D=C.clipIntersection,O=C.clipShadows,W=u.get(C);if(!a||F===null||F.length===0||c&&!O)c?A(null):w();else{const K=c?0:s,V=K*4;let Y=W.clippingState||null;_.value=Y,Y=A(F,M,V,R);for(let se=0;se!==V;++se)Y[se]=n[se];W.clippingState=Y,this.numIntersection=D?this.numPlanes:0,this.numPlanes+=K}};function w(){_.value!==n&&(_.value=n,_.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}function A(C,M,R,F){const D=C!==null?C.length:0;let O=null;if(D!==0){if(O=_.value,F!==!0||O===null){const W=R+D*4,K=M.matrixWorldInverse;g.getNormalMatrix(K),(O===null||O.length<W)&&(O=new Float32Array(W));for(let V=0,Y=R;V!==D;++V,Y+=4)m.copy(C[V]).applyMatrix4(K,g),m.normal.toArray(O,Y),O[Y+3]=m.constant}_.value=O,_.needsUpdate=!0}return e.numPlanes=D,e.numIntersection=0,O}}function pe(u){let e=new WeakMap;function n(m,g){return g===Ho?m.mapping=yo:g===zn&&(m.mapping=_o),m}function s(m){if(m&&m.isTexture&&m.isRenderTargetTexture===!1){const g=m.mapping;if(g===Ho||g===zn)if(e.has(m)){const _=e.get(m).texture;return n(_,m.mapping)}else{const _=m.image;if(_&&_.height>0){const w=new xc(_.height/2);return w.fromEquirectangularTexture(u,m),e.set(m,w),m.addEventListener("dispose",a),n(w.texture,m.mapping)}else return null}}return m}function a(m){const g=m.target;g.removeEventListener("dispose",a);const _=e.get(g);_!==void 0&&(e.delete(g),_.dispose())}function c(){e=new WeakMap}return{get:s,dispose:c}}class Ee extends ed{constructor(e=-1,n=1,s=1,a=-1,c=.1,m=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=s,this.bottom=a,this.near=c,this.far=m,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,s,a,c,m){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=s,this.view.offsetY=a,this.view.width=c,this.view.height=m,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let c=s-e,m=s+e,g=a+n,_=a-n;if(this.view!==null&&this.view.enabled){const w=(this.right-this.left)/this.view.fullWidth/this.zoom,A=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=w*this.view.offsetX,m=c+w*this.view.width,g-=A*this.view.offsetY,_=g-A*this.view.height}this.projectionMatrix.makeOrthographic(c,m,g,_,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Ye=4,ze=[.125,.215,.35,.446,.526,.582],st=20,bt=new Ee,St=new Ut;let ot=null;const dt=(1+Math.sqrt(5))/2,Ht=1/dt,Xt=[new le(1,1,1),new le(-1,1,1),new le(1,1,-1),new le(-1,1,-1),new le(0,dt,Ht),new le(0,dt,-Ht),new le(Ht,0,dt),new le(-Ht,0,dt),new le(dt,Ht,0),new le(-dt,Ht,0)];class un{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,s=.1,a=100){ot=this._renderer.getRenderTarget(),this._setSize(256);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,s,a,c),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Ni(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Di(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ot),e.scissorTest=!1,nn(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===yo||e.mapping===_o?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ot=this._renderer.getRenderTarget();const s=n||this._allocateTargets();return this._textureToCubeUV(e,s),this._applyPMREM(s),this._cleanup(s),s}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,s={magFilter:Ci,minFilter:Ci,generateMipmaps:!1,type:Aa,format:Hr,encoding:Ea,depthBuffer:!1},a=Jt(e,n,s);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Jt(e,n,s);const{_lodMax:c}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Dn(c)),this._blurMaterial=On(c,e,n)}return a}_compileMaterial(e){const n=new ur(this._lodPlanes[0],e);this._renderer.compile(n,bt)}_sceneToCubeUV(e,n,s,a){const g=new Mr(90,1,n,s),_=[1,-1,1,1,1,1],w=[1,1,1,-1,-1,-1],A=this._renderer,C=A.autoClear,M=A.toneMapping;A.getClearColor(St),A.toneMapping=Gr,A.autoClear=!1;const R=new Ua({name:"PMREM.Background",side:ce,depthWrite:!1,depthTest:!1}),F=new ur(new za,R);let D=!1;const O=e.background;O?O.isColor&&(R.color.copy(O),e.background=null,D=!0):(R.color.copy(St),D=!0);for(let W=0;W<6;W++){const K=W%3;K===0?(g.up.set(0,_[W],0),g.lookAt(w[W],0,0)):K===1?(g.up.set(0,0,_[W]),g.lookAt(0,w[W],0)):(g.up.set(0,_[W],0),g.lookAt(0,0,w[W]));const V=this._cubeSize;nn(a,K*V,W>2?V:0,V,V),A.setRenderTarget(a),D&&A.render(F,g),A.render(e,g)}F.geometry.dispose(),F.material.dispose(),A.toneMapping=M,A.autoClear=C,e.background=O}_textureToCubeUV(e,n){const s=this._renderer,a=e.mapping===yo||e.mapping===_o;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=Ni()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Di());const c=a?this._cubemapMaterial:this._equirectMaterial,m=new ur(this._lodPlanes[0],c),g=c.uniforms;g.envMap.value=e;const _=this._cubeSize;nn(n,0,0,3*_,2*_),s.setRenderTarget(n),s.render(m,bt)}_applyPMREM(e){const n=this._renderer,s=n.autoClear;n.autoClear=!1;for(let a=1;a<this._lodPlanes.length;a++){const c=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),m=Xt[(a-1)%Xt.length];this._blur(e,a-1,a,c,m)}n.autoClear=s}_blur(e,n,s,a,c){const m=this._pingPongRenderTarget;this._halfBlur(e,m,n,s,a,"latitudinal",c),this._halfBlur(m,e,s,s,a,"longitudinal",c)}_halfBlur(e,n,s,a,c,m,g){const _=this._renderer,w=this._blurMaterial;m!=="latitudinal"&&m!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const A=3,C=new ur(this._lodPlanes[a],w),M=w.uniforms,R=this._sizeLods[s]-1,F=isFinite(c)?Math.PI/(2*R):2*Math.PI/(2*st-1),D=c/F,O=isFinite(c)?1+Math.floor(A*D):st;O>st&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${O} samples when the maximum is set to ${st}`);const W=[];let K=0;for(let me=0;me<st;++me){const J=me/D,ae=Math.exp(-J*J/2);W.push(ae),me===0?K+=ae:me<O&&(K+=2*ae)}for(let me=0;me<W.length;me++)W[me]=W[me]/K;M.envMap.value=e.texture,M.samples.value=O,M.weights.value=W,M.latitudinal.value=m==="latitudinal",g&&(M.poleAxis.value=g);const{_lodMax:V}=this;M.dTheta.value=F,M.mipInt.value=V-s;const Y=this._sizeLods[a],se=3*Y*(a>V-Ye?a-V+Ye:0),ue=4*(this._cubeSize-Y);nn(n,se,ue,3*Y,2*Y),_.setRenderTarget(n),_.render(C,bt)}}function Dn(u){const e=[],n=[],s=[];let a=u;const c=u-Ye+1+ze.length;for(let m=0;m<c;m++){const g=Math.pow(2,a);n.push(g);let _=1/g;m>u-Ye?_=ze[m-u+Ye-1]:m===0&&(_=0),s.push(_);const w=1/(g-2),A=-w,C=1+w,M=[A,A,C,A,C,C,A,A,C,C,A,C],R=6,F=6,D=3,O=2,W=1,K=new Float32Array(D*F*R),V=new Float32Array(O*F*R),Y=new Float32Array(W*F*R);for(let ue=0;ue<R;ue++){const me=ue%3*2/3-1,J=ue>2?0:-1,ae=[me,J,0,me+2/3,J,0,me+2/3,J+1,0,me,J,0,me+2/3,J+1,0,me,J+1,0];K.set(ae,D*F*ue),V.set(M,O*F*ue);const xe=[ue,ue,ue,ue,ue,ue];Y.set(xe,W*F*ue)}const se=new Rn;se.setAttribute("position",new ci(K,D)),se.setAttribute("uv",new ci(V,O)),se.setAttribute("faceIndex",new ci(Y,W)),e.push(se),a>Ye&&a--}return{lodPlanes:e,sizeLods:n,sigmas:s}}function Jt(u,e,n){const s=new Ls(u,e,n);return s.texture.mapping=yr,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function nn(u,e,n,s,a){u.viewport.set(e,n,s,a),u.scissor.set(e,n,s,a)}function On(u,e,n){const s=new Float32Array(st),a=new le(0,1,0);return new no({name:"SphericalGaussianBlur",defines:{n:st,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${u}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:Xr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:re,depthTest:!1,depthWrite:!1})}function Di(){return new no({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Xr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:re,depthTest:!1,depthWrite:!1})}function Ni(){return new no({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Xr(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:re,depthTest:!1,depthWrite:!1})}function Xr(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function xi(u){let e=new WeakMap,n=null;function s(g){if(g&&g.isTexture){const _=g.mapping,w=_===Ho||_===zn,A=_===yo||_===_o;if(w||A)if(g.isRenderTargetTexture&&g.needsPMREMUpdate===!0){g.needsPMREMUpdate=!1;let C=e.get(g);return n===null&&(n=new un(u)),C=w?n.fromEquirectangular(g,C):n.fromCubemap(g,C),e.set(g,C),C.texture}else{if(e.has(g))return e.get(g).texture;{const C=g.image;if(w&&C&&C.height>0||A&&C&&a(C)){n===null&&(n=new un(u));const M=w?n.fromEquirectangular(g):n.fromCubemap(g);return e.set(g,M),g.addEventListener("dispose",c),M.texture}else return null}}}return g}function a(g){let _=0;const w=6;for(let A=0;A<w;A++)g[A]!==void 0&&_++;return _===w}function c(g){const _=g.target;_.removeEventListener("dispose",c);const w=e.get(_);w!==void 0&&(e.delete(_),w.dispose())}function m(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:s,dispose:m}}function Nn(u){const e={};function n(s){if(e[s]!==void 0)return e[s];let a;switch(s){case"WEBGL_depth_texture":a=u.getExtension("WEBGL_depth_texture")||u.getExtension("MOZ_WEBGL_depth_texture")||u.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=u.getExtension("WEBGL_compressed_texture_s3tc")||u.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||u.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=u.getExtension("WEBGL_compressed_texture_pvrtc")||u.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=u.getExtension(s)}return e[s]=a,a}return{has:function(s){return n(s)!==null},init:function(s){s.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(s){const a=n(s);return a===null&&console.warn("THREE.WebGLRenderer: "+s+" extension not supported."),a}}}function rr(u,e,n,s){const a={},c=new WeakMap;function m(C){const M=C.target;M.index!==null&&e.remove(M.index);for(const F in M.attributes)e.remove(M.attributes[F]);M.removeEventListener("dispose",m),delete a[M.id];const R=c.get(M);R&&(e.remove(R),c.delete(M)),s.releaseStatesOfGeometry(M),M.isInstancedBufferGeometry===!0&&delete M._maxInstanceCount,n.memory.geometries--}function g(C,M){return a[M.id]===!0||(M.addEventListener("dispose",m),a[M.id]=!0,n.memory.geometries++),M}function _(C){const M=C.attributes;for(const F in M)e.update(M[F],u.ARRAY_BUFFER);const R=C.morphAttributes;for(const F in R){const D=R[F];for(let O=0,W=D.length;O<W;O++)e.update(D[O],u.ARRAY_BUFFER)}}function w(C){const M=[],R=C.index,F=C.attributes.position;let D=0;if(R!==null){const K=R.array;D=R.version;for(let V=0,Y=K.length;V<Y;V+=3){const se=K[V+0],ue=K[V+1],me=K[V+2];M.push(se,ue,ue,me,me,se)}}else{const K=F.array;D=F.version;for(let V=0,Y=K.length/3-1;V<Y;V+=3){const se=V+0,ue=V+1,me=V+2;M.push(se,ue,ue,me,me,se)}}const O=new(Gh(M)?dc:As)(M,1);O.version=D;const W=c.get(C);W&&e.remove(W),c.set(C,O)}function A(C){const M=c.get(C);if(M){const R=C.index;R!==null&&M.version<R.version&&w(C)}else w(C);return c.get(C)}return{get:g,update:_,getWireframeAttribute:A}}function Bs(u,e,n,s){const a=s.isWebGL2;let c;function m(M){c=M}let g,_;function w(M){g=M.type,_=M.bytesPerElement}function A(M,R){u.drawElements(c,R,g,M*_),n.update(R,c,1)}function C(M,R,F){if(F===0)return;let D,O;if(a)D=u,O="drawElementsInstanced";else if(D=e.get("ANGLE_instanced_arrays"),O="drawElementsInstancedANGLE",D===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}D[O](c,R,g,M*_,F),n.update(R,c,F)}this.setMode=m,this.setIndex=w,this.render=A,this.renderInstances=C}function dr(u){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function s(c,m,g){switch(n.calls++,m){case u.TRIANGLES:n.triangles+=g*(c/3);break;case u.LINES:n.lines+=g*(c/2);break;case u.LINE_STRIP:n.lines+=g*(c-1);break;case u.LINE_LOOP:n.lines+=g*c;break;case u.POINTS:n.points+=g*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",m);break}}function a(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:a,update:s}}function ii(u,e){return u[0]-e[0]}function gi(u,e){return Math.abs(e[1])-Math.abs(u[1])}function la(u,e,n){const s={},a=new Float32Array(8),c=new WeakMap,m=new Zn,g=[];for(let w=0;w<8;w++)g[w]=[w,0];function _(w,A,C){const M=w.morphTargetInfluences;if(e.isWebGL2===!0){const F=A.morphAttributes.position||A.morphAttributes.normal||A.morphAttributes.color,D=F!==void 0?F.length:0;let O=c.get(A);if(O===void 0||O.count!==D){let Ke=function(){Le.dispose(),c.delete(A),A.removeEventListener("dispose",Ke)};var R=Ke;O!==void 0&&O.texture.dispose();const V=A.morphAttributes.position!==void 0,Y=A.morphAttributes.normal!==void 0,se=A.morphAttributes.color!==void 0,ue=A.morphAttributes.position||[],me=A.morphAttributes.normal||[],J=A.morphAttributes.color||[];let ae=0;V===!0&&(ae=1),Y===!0&&(ae=2),se===!0&&(ae=3);let xe=A.attributes.position.count*ae,We=1;xe>e.maxTextureSize&&(We=Math.ceil(xe/e.maxTextureSize),xe=e.maxTextureSize);const Je=new Float32Array(xe*We*4*D),Le=new Su(Je,xe,We,D);Le.type=js,Le.needsUpdate=!0;const Me=ae*4;for(let rt=0;rt<D;rt++){const yt=ue[rt],et=me[rt],_t=J[rt],ut=xe*We*4*rt;for(let $t=0;$t<yt.count;$t++){const Fe=$t*Me;V===!0&&(m.fromBufferAttribute(yt,$t),Je[ut+Fe+0]=m.x,Je[ut+Fe+1]=m.y,Je[ut+Fe+2]=m.z,Je[ut+Fe+3]=0),Y===!0&&(m.fromBufferAttribute(et,$t),Je[ut+Fe+4]=m.x,Je[ut+Fe+5]=m.y,Je[ut+Fe+6]=m.z,Je[ut+Fe+7]=0),se===!0&&(m.fromBufferAttribute(_t,$t),Je[ut+Fe+8]=m.x,Je[ut+Fe+9]=m.y,Je[ut+Fe+10]=m.z,Je[ut+Fe+11]=_t.itemSize===4?m.w:1)}}O={count:D,texture:Le,size:new it(xe,We)},c.set(A,O),A.addEventListener("dispose",Ke)}let W=0;for(let V=0;V<M.length;V++)W+=M[V];const K=A.morphTargetsRelative?1:1-W;C.getUniforms().setValue(u,"morphTargetBaseInfluence",K),C.getUniforms().setValue(u,"morphTargetInfluences",M),C.getUniforms().setValue(u,"morphTargetsTexture",O.texture,n),C.getUniforms().setValue(u,"morphTargetsTextureSize",O.size)}else{const F=M===void 0?0:M.length;let D=s[A.id];if(D===void 0||D.length!==F){D=[];for(let Y=0;Y<F;Y++)D[Y]=[Y,0];s[A.id]=D}for(let Y=0;Y<F;Y++){const se=D[Y];se[0]=Y,se[1]=M[Y]}D.sort(gi);for(let Y=0;Y<8;Y++)Y<F&&D[Y][1]?(g[Y][0]=D[Y][0],g[Y][1]=D[Y][1]):(g[Y][0]=Number.MAX_SAFE_INTEGER,g[Y][1]=0);g.sort(ii);const O=A.morphAttributes.position,W=A.morphAttributes.normal;let K=0;for(let Y=0;Y<8;Y++){const se=g[Y],ue=se[0],me=se[1];ue!==Number.MAX_SAFE_INTEGER&&me?(O&&A.getAttribute("morphTarget"+Y)!==O[ue]&&A.setAttribute("morphTarget"+Y,O[ue]),W&&A.getAttribute("morphNormal"+Y)!==W[ue]&&A.setAttribute("morphNormal"+Y,W[ue]),a[Y]=me,K+=me):(O&&A.hasAttribute("morphTarget"+Y)===!0&&A.deleteAttribute("morphTarget"+Y),W&&A.hasAttribute("morphNormal"+Y)===!0&&A.deleteAttribute("morphNormal"+Y),a[Y]=0)}const V=A.morphTargetsRelative?1:1-K;C.getUniforms().setValue(u,"morphTargetBaseInfluence",V),C.getUniforms().setValue(u,"morphTargetInfluences",a)}}return{update:_}}function Fu(u,e,n,s){let a=new WeakMap;function c(_){const w=s.render.frame,A=_.geometry,C=e.get(_,A);return a.get(C)!==w&&(e.update(C),a.set(C,w)),_.isInstancedMesh&&(_.hasEventListener("dispose",g)===!1&&_.addEventListener("dispose",g),n.update(_.instanceMatrix,u.ARRAY_BUFFER),_.instanceColor!==null&&n.update(_.instanceColor,u.ARRAY_BUFFER)),C}function m(){a=new WeakMap}function g(_){const w=_.target;w.removeEventListener("dispose",g),n.remove(w.instanceMatrix),w.instanceColor!==null&&n.remove(w.instanceColor)}return{update:c,dispose:m}}const ro=new ri,Bu=new Su,N1=new fl,z1=new _l,G1=[],H1=[],V1=new Float32Array(16),W1=new Float32Array(9),j1=new Float32Array(4);function od(u,e,n){const s=u[0];if(s<=0||s>0)return u;const a=e*n;let c=G1[a];if(c===void 0&&(c=new Float32Array(a),G1[a]=c),e!==0){s.toArray(c,0);for(let m=1,g=0;m!==e;++m)g+=n,u[m].toArray(c,g)}return c}function Er(u,e){if(u.length!==e.length)return!1;for(let n=0,s=u.length;n<s;n++)if(u[n]!==e[n])return!1;return!0}function Tr(u,e){for(let n=0,s=e.length;n<s;n++)u[n]=e[n]}function eg(u,e){let n=H1[e];n===void 0&&(n=new Int32Array(e),H1[e]=n);for(let s=0;s!==e;++s)n[s]=u.allocateTextureUnit();return n}function p2(u,e){const n=this.cache;n[0]!==e&&(u.uniform1f(this.addr,e),n[0]=e)}function m2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(u.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Er(n,e))return;u.uniform2fv(this.addr,e),Tr(n,e)}}function g2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(u.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(u.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Er(n,e))return;u.uniform3fv(this.addr,e),Tr(n,e)}}function v2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(u.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Er(n,e))return;u.uniform4fv(this.addr,e),Tr(n,e)}}function y2(u,e){const n=this.cache,s=e.elements;if(s===void 0){if(Er(n,e))return;u.uniformMatrix2fv(this.addr,!1,e),Tr(n,e)}else{if(Er(n,s))return;j1.set(s),u.uniformMatrix2fv(this.addr,!1,j1),Tr(n,s)}}function _2(u,e){const n=this.cache,s=e.elements;if(s===void 0){if(Er(n,e))return;u.uniformMatrix3fv(this.addr,!1,e),Tr(n,e)}else{if(Er(n,s))return;W1.set(s),u.uniformMatrix3fv(this.addr,!1,W1),Tr(n,s)}}function x2(u,e){const n=this.cache,s=e.elements;if(s===void 0){if(Er(n,e))return;u.uniformMatrix4fv(this.addr,!1,e),Tr(n,e)}else{if(Er(n,s))return;V1.set(s),u.uniformMatrix4fv(this.addr,!1,V1),Tr(n,s)}}function b2(u,e){const n=this.cache;n[0]!==e&&(u.uniform1i(this.addr,e),n[0]=e)}function w2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(u.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Er(n,e))return;u.uniform2iv(this.addr,e),Tr(n,e)}}function A2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(u.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Er(n,e))return;u.uniform3iv(this.addr,e),Tr(n,e)}}function S2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(u.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Er(n,e))return;u.uniform4iv(this.addr,e),Tr(n,e)}}function M2(u,e){const n=this.cache;n[0]!==e&&(u.uniform1ui(this.addr,e),n[0]=e)}function E2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(u.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Er(n,e))return;u.uniform2uiv(this.addr,e),Tr(n,e)}}function T2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(u.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Er(n,e))return;u.uniform3uiv(this.addr,e),Tr(n,e)}}function C2(u,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(u.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Er(n,e))return;u.uniform4uiv(this.addr,e),Tr(n,e)}}function P2(u,e,n){const s=this.cache,a=n.allocateTextureUnit();s[0]!==a&&(u.uniform1i(this.addr,a),s[0]=a),n.setTexture2D(e||ro,a)}function R2(u,e,n){const s=this.cache,a=n.allocateTextureUnit();s[0]!==a&&(u.uniform1i(this.addr,a),s[0]=a),n.setTexture3D(e||N1,a)}function D2(u,e,n){const s=this.cache,a=n.allocateTextureUnit();s[0]!==a&&(u.uniform1i(this.addr,a),s[0]=a),n.setTextureCube(e||z1,a)}function I2(u,e,n){const s=this.cache,a=n.allocateTextureUnit();s[0]!==a&&(u.uniform1i(this.addr,a),s[0]=a),n.setTexture2DArray(e||Bu,a)}function L2(u){switch(u){case 5126:return p2;case 35664:return m2;case 35665:return g2;case 35666:return v2;case 35674:return y2;case 35675:return _2;case 35676:return x2;case 5124:case 35670:return b2;case 35667:case 35671:return w2;case 35668:case 35672:return A2;case 35669:case 35673:return S2;case 5125:return M2;case 36294:return E2;case 36295:return T2;case 36296:return C2;case 35678:case 36198:case 36298:case 36306:case 35682:return P2;case 35679:case 36299:case 36307:return R2;case 35680:case 36300:case 36308:case 36293:return D2;case 36289:case 36303:case 36311:case 36292:return I2}}function O2(u,e){u.uniform1fv(this.addr,e)}function F2(u,e){const n=od(e,this.size,2);u.uniform2fv(this.addr,n)}function B2(u,e){const n=od(e,this.size,3);u.uniform3fv(this.addr,n)}function k2(u,e){const n=od(e,this.size,4);u.uniform4fv(this.addr,n)}function U2(u,e){const n=od(e,this.size,4);u.uniformMatrix2fv(this.addr,!1,n)}function N2(u,e){const n=od(e,this.size,9);u.uniformMatrix3fv(this.addr,!1,n)}function z2(u,e){const n=od(e,this.size,16);u.uniformMatrix4fv(this.addr,!1,n)}function G2(u,e){u.uniform1iv(this.addr,e)}function H2(u,e){u.uniform2iv(this.addr,e)}function V2(u,e){u.uniform3iv(this.addr,e)}function W2(u,e){u.uniform4iv(this.addr,e)}function j2(u,e){u.uniform1uiv(this.addr,e)}function X2(u,e){u.uniform2uiv(this.addr,e)}function Y2(u,e){u.uniform3uiv(this.addr,e)}function Q2(u,e){u.uniform4uiv(this.addr,e)}function K2(u,e,n){const s=this.cache,a=e.length,c=eg(n,a);Er(s,c)||(u.uniform1iv(this.addr,c),Tr(s,c));for(let m=0;m!==a;++m)n.setTexture2D(e[m]||ro,c[m])}function q2(u,e,n){const s=this.cache,a=e.length,c=eg(n,a);Er(s,c)||(u.uniform1iv(this.addr,c),Tr(s,c));for(let m=0;m!==a;++m)n.setTexture3D(e[m]||N1,c[m])}function Z2(u,e,n){const s=this.cache,a=e.length,c=eg(n,a);Er(s,c)||(u.uniform1iv(this.addr,c),Tr(s,c));for(let m=0;m!==a;++m)n.setTextureCube(e[m]||z1,c[m])}function J2(u,e,n){const s=this.cache,a=e.length,c=eg(n,a);Er(s,c)||(u.uniform1iv(this.addr,c),Tr(s,c));for(let m=0;m!==a;++m)n.setTexture2DArray(e[m]||Bu,c[m])}function $2(u){switch(u){case 5126:return O2;case 35664:return F2;case 35665:return B2;case 35666:return k2;case 35674:return U2;case 35675:return N2;case 35676:return z2;case 5124:case 35670:return G2;case 35667:case 35671:return H2;case 35668:case 35672:return V2;case 35669:case 35673:return W2;case 5125:return j2;case 36294:return X2;case 36295:return Y2;case 36296:return Q2;case 35678:case 36198:case 36298:case 36306:case 35682:return K2;case 35679:case 36299:case 36307:return q2;case 35680:case 36300:case 36308:case 36293:return Z2;case 36289:case 36303:case 36311:case 36292:return J2}}class eD{constructor(e,n,s){this.id=e,this.addr=s,this.cache=[],this.setValue=L2(n.type)}}class tD{constructor(e,n,s){this.id=e,this.addr=s,this.cache=[],this.size=n.size,this.setValue=$2(n.type)}}class nD{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,s){const a=this.seq;for(let c=0,m=a.length;c!==m;++c){const g=a[c];g.setValue(e,n[g.id],s)}}}const Ay=/(\w+)(\])?(\[|\.)?/g;function X1(u,e){u.seq.push(e),u.map[e.id]=e}function iD(u,e,n){const s=u.name,a=s.length;for(Ay.lastIndex=0;;){const c=Ay.exec(s),m=Ay.lastIndex;let g=c[1];const _=c[2]==="]",w=c[3];if(_&&(g=g|0),w===void 0||w==="["&&m+2===a){X1(n,w===void 0?new eD(g,u,e):new tD(g,u,e));break}else{let C=n.map[g];C===void 0&&(C=new nD(g),X1(n,C)),n=C}}}class tg{constructor(e,n){this.seq=[],this.map={};const s=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let a=0;a<s;++a){const c=e.getActiveUniform(n,a),m=e.getUniformLocation(n,c.name);iD(c,m,this)}}setValue(e,n,s,a){const c=this.map[n];c!==void 0&&c.setValue(e,s,a)}setOptional(e,n,s){const a=n[s];a!==void 0&&this.setValue(e,s,a)}static upload(e,n,s,a){for(let c=0,m=n.length;c!==m;++c){const g=n[c],_=s[g.id];_.needsUpdate!==!1&&g.setValue(e,_.value,a)}}static seqWithValue(e,n){const s=[];for(let a=0,c=e.length;a!==c;++a){const m=e[a];m.id in n&&s.push(m)}return s}}function Y1(u,e,n){const s=u.createShader(e);return u.shaderSource(s,n),u.compileShader(s),s}let rD=0;function sD(u,e){const n=u.split(`
`),s=[],a=Math.max(e-6,0),c=Math.min(e+6,n.length);for(let m=a;m<c;m++){const g=m+1;s.push(`${g===e?">":" "} ${g}: ${n[m]}`)}return s.join(`
`)}function oD(u){switch(u){case Ea:return["Linear","( value )"];case pi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",u),["Linear","( value )"]}}function Q1(u,e,n){const s=u.getShaderParameter(e,u.COMPILE_STATUS),a=u.getShaderInfoLog(e).trim();if(s&&a==="")return"";const c=/ERROR: 0:(\d+)/.exec(a);if(c){const m=parseInt(c[1]);return n.toUpperCase()+`

`+a+`

`+sD(u.getShaderSource(e),m)}else return a}function aD(u,e){const n=oD(e);return"vec4 "+u+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function lD(u,e){let n;switch(e){case Yl:n="Linear";break;case bh:n="Reinhard";break;case Ql:n="OptimizedCineon";break;case su:n="ACESFilmic";break;case ou:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+u+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function cD(u){return[u.extensionDerivatives||u.envMapCubeUVHeight||u.bumpMap||u.tangentSpaceNormalMap||u.clearcoatNormalMap||u.flatShading||u.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(u.extensionFragDepth||u.logarithmicDepthBuffer)&&u.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",u.extensionDrawBuffers&&u.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(u.extensionShaderTextureLOD||u.envMap||u.transmission)&&u.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Bf).join(`
`)}function uD(u){const e=[];for(const n in u){const s=u[n];s!==!1&&e.push("#define "+n+" "+s)}return e.join(`
`)}function hD(u,e){const n={},s=u.getProgramParameter(e,u.ACTIVE_ATTRIBUTES);for(let a=0;a<s;a++){const c=u.getActiveAttrib(e,a),m=c.name;let g=1;c.type===u.FLOAT_MAT2&&(g=2),c.type===u.FLOAT_MAT3&&(g=3),c.type===u.FLOAT_MAT4&&(g=4),n[m]={type:c.type,location:u.getAttribLocation(e,m),locationSize:g}}return n}function Bf(u){return u!==""}function K1(u,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return u.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function q1(u,e){return u.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const dD=/^[ \t]*#include +<([\w\d./]+)>/gm;function Sy(u){return u.replace(dD,fD)}function fD(u,e){const n=En[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return Sy(n)}const pD=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Z1(u){return u.replace(pD,mD)}function mD(u,e,n,s){let a="";for(let c=parseInt(e);c<parseInt(n);c++)a+=s.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return a}function J1(u){let e="precision "+u.precision+` float;
precision `+u.precision+" int;";return u.precision==="highp"?e+=`
#define HIGH_PRECISION`:u.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:u.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function gD(u){let e="SHADOWMAP_TYPE_BASIC";return u.shadowMapType===ge?e="SHADOWMAP_TYPE_PCF":u.shadowMapType===be?e="SHADOWMAP_TYPE_PCF_SOFT":u.shadowMapType===ye&&(e="SHADOWMAP_TYPE_VSM"),e}function vD(u){let e="ENVMAP_TYPE_CUBE";if(u.envMap)switch(u.envMapMode){case yo:case _o:e="ENVMAP_TYPE_CUBE";break;case yr:e="ENVMAP_TYPE_CUBE_UV";break}return e}function yD(u){let e="ENVMAP_MODE_REFLECTION";if(u.envMap)switch(u.envMapMode){case _o:e="ENVMAP_MODE_REFRACTION";break}return e}function _D(u){let e="ENVMAP_BLENDING_NONE";if(u.envMap)switch(u.combine){case Qi:e="ENVMAP_BLENDING_MULTIPLY";break;case lr:e="ENVMAP_BLENDING_MIX";break;case zr:e="ENVMAP_BLENDING_ADD";break}return e}function xD(u){const e=u.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,s=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:s,maxMip:n}}function bD(u,e,n,s){const a=u.getContext(),c=n.defines;let m=n.vertexShader,g=n.fragmentShader;const _=gD(n),w=vD(n),A=yD(n),C=_D(n),M=xD(n),R=n.isWebGL2?"":cD(n),F=uD(c),D=a.createProgram();let O,W,K=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(O=[F].filter(Bf).join(`
`),O.length>0&&(O+=`
`),W=[R,F].filter(Bf).join(`
`),W.length>0&&(W+=`
`)):(O=[J1(n),"#define SHADER_NAME "+n.shaderName,F,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+A:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Bf).join(`
`),W=[R,J1(n),"#define SHADER_NAME "+n.shaderName,F,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+w:"",n.envMap?"#define "+A:"",n.envMap?"#define "+C:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Gr?"#define TONE_MAPPING":"",n.toneMapping!==Gr?En.tonemapping_pars_fragment:"",n.toneMapping!==Gr?lD("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",En.encodings_pars_fragment,aD("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Bf).join(`
`)),m=Sy(m),m=K1(m,n),m=q1(m,n),g=Sy(g),g=K1(g,n),g=q1(g,n),m=Z1(m),g=Z1(g),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(K=`#version 300 es
`,O=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+O,W=["#define varying in",n.glslVersion===uf?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===uf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+W);const V=K+O+m,Y=K+W+g,se=Y1(a,a.VERTEX_SHADER,V),ue=Y1(a,a.FRAGMENT_SHADER,Y);if(a.attachShader(D,se),a.attachShader(D,ue),n.index0AttributeName!==void 0?a.bindAttribLocation(D,0,n.index0AttributeName):n.morphTargets===!0&&a.bindAttribLocation(D,0,"position"),a.linkProgram(D),u.debug.checkShaderErrors){const ae=a.getProgramInfoLog(D).trim(),xe=a.getShaderInfoLog(se).trim(),We=a.getShaderInfoLog(ue).trim();let Je=!0,Le=!0;if(a.getProgramParameter(D,a.LINK_STATUS)===!1){Je=!1;const Me=Q1(a,se,"vertex"),Ke=Q1(a,ue,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(D,a.VALIDATE_STATUS)+`

Program Info Log: `+ae+`
`+Me+`
`+Ke)}else ae!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ae):(xe===""||We==="")&&(Le=!1);Le&&(this.diagnostics={runnable:Je,programLog:ae,vertexShader:{log:xe,prefix:O},fragmentShader:{log:We,prefix:W}})}a.deleteShader(se),a.deleteShader(ue);let me;this.getUniforms=function(){return me===void 0&&(me=new tg(a,D)),me};let J;return this.getAttributes=function(){return J===void 0&&(J=hD(a,D)),J},this.destroy=function(){s.releaseStatesOfProgram(this),a.deleteProgram(D),this.program=void 0},this.name=n.shaderName,this.id=rD++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=se,this.fragmentShader=ue,this}let wD=0;class AD{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,s=e.fragmentShader,a=this._getShaderStage(n),c=this._getShaderStage(s),m=this._getShaderCacheForMaterial(e);return m.has(a)===!1&&(m.add(a),a.usedTimes++),m.has(c)===!1&&(m.add(c),c.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const s of n)s.usedTimes--,s.usedTimes===0&&this.shaderCache.delete(s.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let s=n.get(e);return s===void 0&&(s=new Set,n.set(e,s)),s}_getShaderStage(e){const n=this.shaderCache;let s=n.get(e);return s===void 0&&(s=new SD(e),n.set(e,s)),s}}class SD{constructor(e){this.id=wD++,this.code=e,this.usedTimes=0}}function MD(u,e,n,s,a,c,m){const g=new ka,_=new AD,w=[],A=a.isWebGL2,C=a.logarithmicDepthBuffer,M=a.vertexTextures;let R=a.precision;const F={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function D(J,ae,xe,We,Je){const Le=We.fog,Me=Je.geometry,Ke=J.isMeshStandardMaterial?We.environment:null,rt=(J.isMeshStandardMaterial?n:e).get(J.envMap||Ke),yt=rt&&rt.mapping===yr?rt.image.height:null,et=F[J.type];J.precision!==null&&(R=a.getMaxPrecision(J.precision),R!==J.precision&&console.warn("THREE.WebGLProgram.getParameters:",J.precision,"not supported, using",R,"instead."));const _t=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,ut=_t!==void 0?_t.length:0;let $t=0;Me.morphAttributes.position!==void 0&&($t=1),Me.morphAttributes.normal!==void 0&&($t=2),Me.morphAttributes.color!==void 0&&($t=3);let Fe,ft,Dt,_e;if(et){const xn=jr[et];Fe=xn.vertexShader,ft=xn.fragmentShader}else Fe=J.vertexShader,ft=J.fragmentShader,_.update(J),Dt=_.getVertexShaderID(J),_e=_.getFragmentShaderID(J);const qt=u.getRenderTarget(),Bt=J.alphaTest>0,Kt=J.clearcoat>0,en=J.iridescence>0;return{isWebGL2:A,shaderID:et,shaderName:J.type,vertexShader:Fe,fragmentShader:ft,defines:J.defines,customVertexShaderID:Dt,customFragmentShaderID:_e,isRawShaderMaterial:J.isRawShaderMaterial===!0,glslVersion:J.glslVersion,precision:R,instancing:Je.isInstancedMesh===!0,instancingColor:Je.isInstancedMesh===!0&&Je.instanceColor!==null,supportsVertexTextures:M,outputEncoding:qt===null?u.outputEncoding:qt.isXRRenderTarget===!0?qt.texture.encoding:Ea,map:!!J.map,matcap:!!J.matcap,envMap:!!rt,envMapMode:rt&&rt.mapping,envMapCubeUVHeight:yt,lightMap:!!J.lightMap,aoMap:!!J.aoMap,emissiveMap:!!J.emissiveMap,bumpMap:!!J.bumpMap,normalMap:!!J.normalMap,objectSpaceNormalMap:J.normalMapType===tc,tangentSpaceNormalMap:J.normalMapType===Yo,decodeVideoTexture:!!J.map&&J.map.isVideoTexture===!0&&J.map.encoding===pi,clearcoat:Kt,clearcoatMap:Kt&&!!J.clearcoatMap,clearcoatRoughnessMap:Kt&&!!J.clearcoatRoughnessMap,clearcoatNormalMap:Kt&&!!J.clearcoatNormalMap,iridescence:en,iridescenceMap:en&&!!J.iridescenceMap,iridescenceThicknessMap:en&&!!J.iridescenceThicknessMap,displacementMap:!!J.displacementMap,roughnessMap:!!J.roughnessMap,metalnessMap:!!J.metalnessMap,specularMap:!!J.specularMap,specularIntensityMap:!!J.specularIntensityMap,specularColorMap:!!J.specularColorMap,opaque:J.transparent===!1&&J.blending===ve,alphaMap:!!J.alphaMap,alphaTest:Bt,gradientMap:!!J.gradientMap,sheen:J.sheen>0,sheenColorMap:!!J.sheenColorMap,sheenRoughnessMap:!!J.sheenRoughnessMap,transmission:J.transmission>0,transmissionMap:!!J.transmissionMap,thicknessMap:!!J.thicknessMap,combine:J.combine,vertexTangents:!!J.normalMap&&!!Me.attributes.tangent,vertexColors:J.vertexColors,vertexAlphas:J.vertexColors===!0&&!!Me.attributes.color&&Me.attributes.color.itemSize===4,vertexUvs:!!J.map||!!J.bumpMap||!!J.normalMap||!!J.specularMap||!!J.alphaMap||!!J.emissiveMap||!!J.roughnessMap||!!J.metalnessMap||!!J.clearcoatMap||!!J.clearcoatRoughnessMap||!!J.clearcoatNormalMap||!!J.iridescenceMap||!!J.iridescenceThicknessMap||!!J.displacementMap||!!J.transmissionMap||!!J.thicknessMap||!!J.specularIntensityMap||!!J.specularColorMap||!!J.sheenColorMap||!!J.sheenRoughnessMap,uvsVertexOnly:!(J.map||J.bumpMap||J.normalMap||J.specularMap||J.alphaMap||J.emissiveMap||J.roughnessMap||J.metalnessMap||J.clearcoatNormalMap||J.iridescenceMap||J.iridescenceThicknessMap||J.transmission>0||J.transmissionMap||J.thicknessMap||J.specularIntensityMap||J.specularColorMap||J.sheen>0||J.sheenColorMap||J.sheenRoughnessMap)&&!!J.displacementMap,fog:!!Le,useFog:J.fog===!0,fogExp2:Le&&Le.isFogExp2,flatShading:!!J.flatShading,sizeAttenuation:J.sizeAttenuation,logarithmicDepthBuffer:C,skinning:Je.isSkinnedMesh===!0,morphTargets:Me.morphAttributes.position!==void 0,morphNormals:Me.morphAttributes.normal!==void 0,morphColors:Me.morphAttributes.color!==void 0,morphTargetsCount:ut,morphTextureStride:$t,numDirLights:ae.directional.length,numPointLights:ae.point.length,numSpotLights:ae.spot.length,numSpotLightMaps:ae.spotLightMap.length,numRectAreaLights:ae.rectArea.length,numHemiLights:ae.hemi.length,numDirLightShadows:ae.directionalShadowMap.length,numPointLightShadows:ae.pointShadowMap.length,numSpotLightShadows:ae.spotShadowMap.length,numSpotLightShadowsWithMaps:ae.numSpotLightShadowsWithMaps,numClippingPlanes:m.numPlanes,numClipIntersection:m.numIntersection,dithering:J.dithering,shadowMapEnabled:u.shadowMap.enabled&&xe.length>0,shadowMapType:u.shadowMap.type,toneMapping:J.toneMapped?u.toneMapping:Gr,useLegacyLights:u.useLegacyLights,premultipliedAlpha:J.premultipliedAlpha,doubleSided:J.side===ie,flipSided:J.side===ce,useDepthPacking:!!J.depthPacking,depthPacking:J.depthPacking||0,index0AttributeName:J.index0AttributeName,extensionDerivatives:J.extensions&&J.extensions.derivatives,extensionFragDepth:J.extensions&&J.extensions.fragDepth,extensionDrawBuffers:J.extensions&&J.extensions.drawBuffers,extensionShaderTextureLOD:J.extensions&&J.extensions.shaderTextureLOD,rendererExtensionFragDepth:A||s.has("EXT_frag_depth"),rendererExtensionDrawBuffers:A||s.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:A||s.has("EXT_shader_texture_lod"),customProgramCacheKey:J.customProgramCacheKey()}}function O(J){const ae=[];if(J.shaderID?ae.push(J.shaderID):(ae.push(J.customVertexShaderID),ae.push(J.customFragmentShaderID)),J.defines!==void 0)for(const xe in J.defines)ae.push(xe),ae.push(J.defines[xe]);return J.isRawShaderMaterial===!1&&(W(ae,J),K(ae,J),ae.push(u.outputEncoding)),ae.push(J.customProgramCacheKey),ae.join()}function W(J,ae){J.push(ae.precision),J.push(ae.outputEncoding),J.push(ae.envMapMode),J.push(ae.envMapCubeUVHeight),J.push(ae.combine),J.push(ae.vertexUvs),J.push(ae.fogExp2),J.push(ae.sizeAttenuation),J.push(ae.morphTargetsCount),J.push(ae.morphAttributeCount),J.push(ae.numDirLights),J.push(ae.numPointLights),J.push(ae.numSpotLights),J.push(ae.numSpotLightMaps),J.push(ae.numHemiLights),J.push(ae.numRectAreaLights),J.push(ae.numDirLightShadows),J.push(ae.numPointLightShadows),J.push(ae.numSpotLightShadows),J.push(ae.numSpotLightShadowsWithMaps),J.push(ae.shadowMapType),J.push(ae.toneMapping),J.push(ae.numClippingPlanes),J.push(ae.numClipIntersection),J.push(ae.depthPacking)}function K(J,ae){g.disableAll(),ae.isWebGL2&&g.enable(0),ae.supportsVertexTextures&&g.enable(1),ae.instancing&&g.enable(2),ae.instancingColor&&g.enable(3),ae.map&&g.enable(4),ae.matcap&&g.enable(5),ae.envMap&&g.enable(6),ae.lightMap&&g.enable(7),ae.aoMap&&g.enable(8),ae.emissiveMap&&g.enable(9),ae.bumpMap&&g.enable(10),ae.normalMap&&g.enable(11),ae.objectSpaceNormalMap&&g.enable(12),ae.tangentSpaceNormalMap&&g.enable(13),ae.clearcoat&&g.enable(14),ae.clearcoatMap&&g.enable(15),ae.clearcoatRoughnessMap&&g.enable(16),ae.clearcoatNormalMap&&g.enable(17),ae.iridescence&&g.enable(18),ae.iridescenceMap&&g.enable(19),ae.iridescenceThicknessMap&&g.enable(20),ae.displacementMap&&g.enable(21),ae.specularMap&&g.enable(22),ae.roughnessMap&&g.enable(23),ae.metalnessMap&&g.enable(24),ae.gradientMap&&g.enable(25),ae.alphaMap&&g.enable(26),ae.alphaTest&&g.enable(27),ae.vertexColors&&g.enable(28),ae.vertexAlphas&&g.enable(29),ae.vertexUvs&&g.enable(30),ae.vertexTangents&&g.enable(31),ae.uvsVertexOnly&&g.enable(32),J.push(g.mask),g.disableAll(),ae.fog&&g.enable(0),ae.useFog&&g.enable(1),ae.flatShading&&g.enable(2),ae.logarithmicDepthBuffer&&g.enable(3),ae.skinning&&g.enable(4),ae.morphTargets&&g.enable(5),ae.morphNormals&&g.enable(6),ae.morphColors&&g.enable(7),ae.premultipliedAlpha&&g.enable(8),ae.shadowMapEnabled&&g.enable(9),ae.useLegacyLights&&g.enable(10),ae.doubleSided&&g.enable(11),ae.flipSided&&g.enable(12),ae.useDepthPacking&&g.enable(13),ae.dithering&&g.enable(14),ae.specularIntensityMap&&g.enable(15),ae.specularColorMap&&g.enable(16),ae.transmission&&g.enable(17),ae.transmissionMap&&g.enable(18),ae.thicknessMap&&g.enable(19),ae.sheen&&g.enable(20),ae.sheenColorMap&&g.enable(21),ae.sheenRoughnessMap&&g.enable(22),ae.decodeVideoTexture&&g.enable(23),ae.opaque&&g.enable(24),J.push(g.mask)}function V(J){const ae=F[J.type];let xe;if(ae){const We=jr[ae];xe=yc.clone(We.uniforms)}else xe=J.uniforms;return xe}function Y(J,ae){let xe;for(let We=0,Je=w.length;We<Je;We++){const Le=w[We];if(Le.cacheKey===ae){xe=Le,++xe.usedTimes;break}}return xe===void 0&&(xe=new bD(u,ae,J,c),w.push(xe)),xe}function se(J){if(--J.usedTimes===0){const ae=w.indexOf(J);w[ae]=w[w.length-1],w.pop(),J.destroy()}}function ue(J){_.remove(J)}function me(){_.dispose()}return{getParameters:D,getProgramCacheKey:O,getUniforms:V,acquireProgram:Y,releaseProgram:se,releaseShaderCache:ue,programs:w,dispose:me}}function ED(){let u=new WeakMap;function e(c){let m=u.get(c);return m===void 0&&(m={},u.set(c,m)),m}function n(c){u.delete(c)}function s(c,m,g){u.get(c)[m]=g}function a(){u=new WeakMap}return{get:e,remove:n,update:s,dispose:a}}function TD(u,e){return u.groupOrder!==e.groupOrder?u.groupOrder-e.groupOrder:u.renderOrder!==e.renderOrder?u.renderOrder-e.renderOrder:u.material.id!==e.material.id?u.material.id-e.material.id:u.z!==e.z?u.z-e.z:u.id-e.id}function $1(u,e){return u.groupOrder!==e.groupOrder?u.groupOrder-e.groupOrder:u.renderOrder!==e.renderOrder?u.renderOrder-e.renderOrder:u.z!==e.z?e.z-u.z:u.id-e.id}function eA(){const u=[];let e=0;const n=[],s=[],a=[];function c(){e=0,n.length=0,s.length=0,a.length=0}function m(C,M,R,F,D,O){let W=u[e];return W===void 0?(W={id:C.id,object:C,geometry:M,material:R,groupOrder:F,renderOrder:C.renderOrder,z:D,group:O},u[e]=W):(W.id=C.id,W.object=C,W.geometry=M,W.material=R,W.groupOrder=F,W.renderOrder=C.renderOrder,W.z=D,W.group=O),e++,W}function g(C,M,R,F,D,O){const W=m(C,M,R,F,D,O);R.transmission>0?s.push(W):R.transparent===!0?a.push(W):n.push(W)}function _(C,M,R,F,D,O){const W=m(C,M,R,F,D,O);R.transmission>0?s.unshift(W):R.transparent===!0?a.unshift(W):n.unshift(W)}function w(C,M){n.length>1&&n.sort(C||TD),s.length>1&&s.sort(M||$1),a.length>1&&a.sort(M||$1)}function A(){for(let C=e,M=u.length;C<M;C++){const R=u[C];if(R.id===null)break;R.id=null,R.object=null,R.geometry=null,R.material=null,R.group=null}}return{opaque:n,transmissive:s,transparent:a,init:c,push:g,unshift:_,finish:A,sort:w}}function CD(){let u=new WeakMap;function e(s,a){const c=u.get(s);let m;return c===void 0?(m=new eA,u.set(s,[m])):a>=c.length?(m=new eA,c.push(m)):m=c[a],m}function n(){u=new WeakMap}return{get:e,dispose:n}}function PD(){const u={};return{get:function(e){if(u[e.id]!==void 0)return u[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new le,color:new Ut};break;case"SpotLight":n={position:new le,direction:new le,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new le,color:new Ut,distance:0,decay:0};break;case"HemisphereLight":n={direction:new le,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":n={color:new Ut,position:new le,halfWidth:new le,halfHeight:new le};break}return u[e.id]=n,n}}}function RD(){const u={};return{get:function(e){if(u[e.id]!==void 0)return u[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new it,shadowCameraNear:1,shadowCameraFar:1e3};break}return u[e.id]=n,n}}}let DD=0;function ID(u,e){return(e.castShadow?2:0)-(u.castShadow?2:0)+(e.map?1:0)-(u.map?1:0)}function LD(u,e){const n=new PD,s=RD(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let A=0;A<9;A++)a.probe.push(new le);const c=new le,m=new Mn,g=new Mn;function _(A,C){let M=0,R=0,F=0;for(let We=0;We<9;We++)a.probe[We].set(0,0,0);let D=0,O=0,W=0,K=0,V=0,Y=0,se=0,ue=0,me=0,J=0;A.sort(ID);const ae=C===!0?Math.PI:1;for(let We=0,Je=A.length;We<Je;We++){const Le=A[We],Me=Le.color,Ke=Le.intensity,rt=Le.distance,yt=Le.shadow&&Le.shadow.map?Le.shadow.map.texture:null;if(Le.isAmbientLight)M+=Me.r*Ke*ae,R+=Me.g*Ke*ae,F+=Me.b*Ke*ae;else if(Le.isLightProbe)for(let et=0;et<9;et++)a.probe[et].addScaledVector(Le.sh.coefficients[et],Ke);else if(Le.isDirectionalLight){const et=n.get(Le);if(et.color.copy(Le.color).multiplyScalar(Le.intensity*ae),Le.castShadow){const _t=Le.shadow,ut=s.get(Le);ut.shadowBias=_t.bias,ut.shadowNormalBias=_t.normalBias,ut.shadowRadius=_t.radius,ut.shadowMapSize=_t.mapSize,a.directionalShadow[D]=ut,a.directionalShadowMap[D]=yt,a.directionalShadowMatrix[D]=Le.shadow.matrix,Y++}a.directional[D]=et,D++}else if(Le.isSpotLight){const et=n.get(Le);et.position.setFromMatrixPosition(Le.matrixWorld),et.color.copy(Me).multiplyScalar(Ke*ae),et.distance=rt,et.coneCos=Math.cos(Le.angle),et.penumbraCos=Math.cos(Le.angle*(1-Le.penumbra)),et.decay=Le.decay,a.spot[W]=et;const _t=Le.shadow;if(Le.map&&(a.spotLightMap[me]=Le.map,me++,_t.updateMatrices(Le),Le.castShadow&&J++),a.spotLightMatrix[W]=_t.matrix,Le.castShadow){const ut=s.get(Le);ut.shadowBias=_t.bias,ut.shadowNormalBias=_t.normalBias,ut.shadowRadius=_t.radius,ut.shadowMapSize=_t.mapSize,a.spotShadow[W]=ut,a.spotShadowMap[W]=yt,ue++}W++}else if(Le.isRectAreaLight){const et=n.get(Le);et.color.copy(Me).multiplyScalar(Ke),et.halfWidth.set(Le.width*.5,0,0),et.halfHeight.set(0,Le.height*.5,0),a.rectArea[K]=et,K++}else if(Le.isPointLight){const et=n.get(Le);if(et.color.copy(Le.color).multiplyScalar(Le.intensity*ae),et.distance=Le.distance,et.decay=Le.decay,Le.castShadow){const _t=Le.shadow,ut=s.get(Le);ut.shadowBias=_t.bias,ut.shadowNormalBias=_t.normalBias,ut.shadowRadius=_t.radius,ut.shadowMapSize=_t.mapSize,ut.shadowCameraNear=_t.camera.near,ut.shadowCameraFar=_t.camera.far,a.pointShadow[O]=ut,a.pointShadowMap[O]=yt,a.pointShadowMatrix[O]=Le.shadow.matrix,se++}a.point[O]=et,O++}else if(Le.isHemisphereLight){const et=n.get(Le);et.skyColor.copy(Le.color).multiplyScalar(Ke*ae),et.groundColor.copy(Le.groundColor).multiplyScalar(Ke*ae),a.hemi[V]=et,V++}}K>0&&(e.isWebGL2||u.has("OES_texture_float_linear")===!0?(a.rectAreaLTC1=Et.LTC_FLOAT_1,a.rectAreaLTC2=Et.LTC_FLOAT_2):u.has("OES_texture_half_float_linear")===!0?(a.rectAreaLTC1=Et.LTC_HALF_1,a.rectAreaLTC2=Et.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=M,a.ambient[1]=R,a.ambient[2]=F;const xe=a.hash;(xe.directionalLength!==D||xe.pointLength!==O||xe.spotLength!==W||xe.rectAreaLength!==K||xe.hemiLength!==V||xe.numDirectionalShadows!==Y||xe.numPointShadows!==se||xe.numSpotShadows!==ue||xe.numSpotMaps!==me)&&(a.directional.length=D,a.spot.length=W,a.rectArea.length=K,a.point.length=O,a.hemi.length=V,a.directionalShadow.length=Y,a.directionalShadowMap.length=Y,a.pointShadow.length=se,a.pointShadowMap.length=se,a.spotShadow.length=ue,a.spotShadowMap.length=ue,a.directionalShadowMatrix.length=Y,a.pointShadowMatrix.length=se,a.spotLightMatrix.length=ue+me-J,a.spotLightMap.length=me,a.numSpotLightShadowsWithMaps=J,xe.directionalLength=D,xe.pointLength=O,xe.spotLength=W,xe.rectAreaLength=K,xe.hemiLength=V,xe.numDirectionalShadows=Y,xe.numPointShadows=se,xe.numSpotShadows=ue,xe.numSpotMaps=me,a.version=DD++)}function w(A,C){let M=0,R=0,F=0,D=0,O=0;const W=C.matrixWorldInverse;for(let K=0,V=A.length;K<V;K++){const Y=A[K];if(Y.isDirectionalLight){const se=a.directional[M];se.direction.setFromMatrixPosition(Y.matrixWorld),c.setFromMatrixPosition(Y.target.matrixWorld),se.direction.sub(c),se.direction.transformDirection(W),M++}else if(Y.isSpotLight){const se=a.spot[F];se.position.setFromMatrixPosition(Y.matrixWorld),se.position.applyMatrix4(W),se.direction.setFromMatrixPosition(Y.matrixWorld),c.setFromMatrixPosition(Y.target.matrixWorld),se.direction.sub(c),se.direction.transformDirection(W),F++}else if(Y.isRectAreaLight){const se=a.rectArea[D];se.position.setFromMatrixPosition(Y.matrixWorld),se.position.applyMatrix4(W),g.identity(),m.copy(Y.matrixWorld),m.premultiply(W),g.extractRotation(m),se.halfWidth.set(Y.width*.5,0,0),se.halfHeight.set(0,Y.height*.5,0),se.halfWidth.applyMatrix4(g),se.halfHeight.applyMatrix4(g),D++}else if(Y.isPointLight){const se=a.point[R];se.position.setFromMatrixPosition(Y.matrixWorld),se.position.applyMatrix4(W),R++}else if(Y.isHemisphereLight){const se=a.hemi[O];se.direction.setFromMatrixPosition(Y.matrixWorld),se.direction.transformDirection(W),O++}}}return{setup:_,setupView:w,state:a}}function tA(u,e){const n=new LD(u,e),s=[],a=[];function c(){s.length=0,a.length=0}function m(C){s.push(C)}function g(C){a.push(C)}function _(C){n.setup(s,C)}function w(C){n.setupView(s,C)}return{init:c,state:{lightsArray:s,shadowsArray:a,lights:n},setupLights:_,setupLightsView:w,pushLight:m,pushShadow:g}}function OD(u,e){let n=new WeakMap;function s(c,m=0){const g=n.get(c);let _;return g===void 0?(_=new tA(u,e),n.set(c,[_])):m>=g.length?(_=new tA(u,e),g.push(_)):_=g[m],_}function a(){n=new WeakMap}return{get:s,dispose:a}}class My extends Ir{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=bm,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Ey extends Ir{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new le,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const FD=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,BD=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function kD(u,e,n){let s=new td;const a=new it,c=new it,m=new Zn,g=new My({depthPacking:wm}),_=new Ey,w={},A=n.maxTextureSize,C={[$e]:ce,[ce]:$e,[ie]:ie},M=new no({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new it},radius:{value:4}},vertexShader:FD,fragmentShader:BD}),R=M.clone();R.defines.HORIZONTAL_PASS=1;const F=new Rn;F.setAttribute("position",new ci(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const D=new ur(F,M),O=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ge,this.render=function(Y,se,ue){if(O.enabled===!1||O.autoUpdate===!1&&O.needsUpdate===!1||Y.length===0)return;const me=u.getRenderTarget(),J=u.getActiveCubeFace(),ae=u.getActiveMipmapLevel(),xe=u.state;xe.setBlending(re),xe.buffers.color.setClear(1,1,1,1),xe.buffers.depth.setTest(!0),xe.setScissorTest(!1);for(let We=0,Je=Y.length;We<Je;We++){const Le=Y[We],Me=Le.shadow;if(Me===void 0){console.warn("THREE.WebGLShadowMap:",Le,"has no shadow.");continue}if(Me.autoUpdate===!1&&Me.needsUpdate===!1)continue;a.copy(Me.mapSize);const Ke=Me.getFrameExtents();if(a.multiply(Ke),c.copy(Me.mapSize),(a.x>A||a.y>A)&&(a.x>A&&(c.x=Math.floor(A/Ke.x),a.x=c.x*Ke.x,Me.mapSize.x=c.x),a.y>A&&(c.y=Math.floor(A/Ke.y),a.y=c.y*Ke.y,Me.mapSize.y=c.y)),Me.map===null){const yt=this.type!==ye?{minFilter:Ti,magFilter:Ti}:{};Me.map=new Ls(a.x,a.y,yt),Me.map.texture.name=Le.name+".shadowMap",Me.camera.updateProjectionMatrix()}u.setRenderTarget(Me.map),u.clear();const rt=Me.getViewportCount();for(let yt=0;yt<rt;yt++){const et=Me.getViewport(yt);m.set(c.x*et.x,c.y*et.y,c.x*et.z,c.y*et.w),xe.viewport(m),Me.updateMatrices(Le,yt),s=Me.getFrustum(),V(se,ue,Me.camera,Le,this.type)}Me.isPointLightShadow!==!0&&this.type===ye&&W(Me,ue),Me.needsUpdate=!1}O.needsUpdate=!1,u.setRenderTarget(me,J,ae)};function W(Y,se){const ue=e.update(D);M.defines.VSM_SAMPLES!==Y.blurSamples&&(M.defines.VSM_SAMPLES=Y.blurSamples,R.defines.VSM_SAMPLES=Y.blurSamples,M.needsUpdate=!0,R.needsUpdate=!0),Y.mapPass===null&&(Y.mapPass=new Ls(a.x,a.y)),M.uniforms.shadow_pass.value=Y.map.texture,M.uniforms.resolution.value=Y.mapSize,M.uniforms.radius.value=Y.radius,u.setRenderTarget(Y.mapPass),u.clear(),u.renderBufferDirect(se,null,ue,M,D,null),R.uniforms.shadow_pass.value=Y.mapPass.texture,R.uniforms.resolution.value=Y.mapSize,R.uniforms.radius.value=Y.radius,u.setRenderTarget(Y.map),u.clear(),u.renderBufferDirect(se,null,ue,R,D,null)}function K(Y,se,ue,me,J,ae){let xe=null;const We=ue.isPointLight===!0?Y.customDistanceMaterial:Y.customDepthMaterial;if(We!==void 0)xe=We;else if(xe=ue.isPointLight===!0?_:g,u.localClippingEnabled&&se.clipShadows===!0&&Array.isArray(se.clippingPlanes)&&se.clippingPlanes.length!==0||se.displacementMap&&se.displacementScale!==0||se.alphaMap&&se.alphaTest>0||se.map&&se.alphaTest>0){const Je=xe.uuid,Le=se.uuid;let Me=w[Je];Me===void 0&&(Me={},w[Je]=Me);let Ke=Me[Le];Ke===void 0&&(Ke=xe.clone(),Me[Le]=Ke),xe=Ke}return xe.visible=se.visible,xe.wireframe=se.wireframe,ae===ye?xe.side=se.shadowSide!==null?se.shadowSide:se.side:xe.side=se.shadowSide!==null?se.shadowSide:C[se.side],xe.alphaMap=se.alphaMap,xe.alphaTest=se.alphaTest,xe.map=se.map,xe.clipShadows=se.clipShadows,xe.clippingPlanes=se.clippingPlanes,xe.clipIntersection=se.clipIntersection,xe.displacementMap=se.displacementMap,xe.displacementScale=se.displacementScale,xe.displacementBias=se.displacementBias,xe.wireframeLinewidth=se.wireframeLinewidth,xe.linewidth=se.linewidth,ue.isPointLight===!0&&xe.isMeshDistanceMaterial===!0&&(xe.referencePosition.setFromMatrixPosition(ue.matrixWorld),xe.nearDistance=me,xe.farDistance=J),xe}function V(Y,se,ue,me,J){if(Y.visible===!1)return;if(Y.layers.test(se.layers)&&(Y.isMesh||Y.isLine||Y.isPoints)&&(Y.castShadow||Y.receiveShadow&&J===ye)&&(!Y.frustumCulled||s.intersectsObject(Y))){Y.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,Y.matrixWorld);const We=e.update(Y),Je=Y.material;if(Array.isArray(Je)){const Le=We.groups;for(let Me=0,Ke=Le.length;Me<Ke;Me++){const rt=Le[Me],yt=Je[rt.materialIndex];if(yt&&yt.visible){const et=K(Y,yt,me,ue.near,ue.far,J);u.renderBufferDirect(ue,null,We,et,Y,rt)}}}else if(Je.visible){const Le=K(Y,Je,me,ue.near,ue.far,J);u.renderBufferDirect(ue,null,We,Le,Y,null)}}const xe=Y.children;for(let We=0,Je=xe.length;We<Je;We++)V(xe[We],se,ue,me,J)}}function UD(u,e,n){const s=n.isWebGL2;function a(){let we=!1;const qe=new Zn;let gt=null;const Wt=new Zn(0,0,0,0);return{setMask:function(ln){gt!==ln&&!we&&(u.colorMask(ln,ln,ln,ln),gt=ln)},setLocked:function(ln){we=ln},setClear:function(ln,si,Fr,as,Ku){Ku===!0&&(ln*=as,si*=as,Fr*=as),qe.set(ln,si,Fr,as),Wt.equals(qe)===!1&&(u.clearColor(ln,si,Fr,as),Wt.copy(qe))},reset:function(){we=!1,gt=null,Wt.set(-1,0,0,0)}}}function c(){let we=!1,qe=null,gt=null,Wt=null;return{setTest:function(ln){ln?Bt(u.DEPTH_TEST):Kt(u.DEPTH_TEST)},setMask:function(ln){qe!==ln&&!we&&(u.depthMask(ln),qe=ln)},setFunc:function(ln){if(gt!==ln){switch(ln){case gs:u.depthFunc(u.NEVER);break;case vo:u.depthFunc(u.ALWAYS);break;case Hs:u.depthFunc(u.LESS);break;case nl:u.depthFunc(u.LEQUAL);break;case vr:u.depthFunc(u.EQUAL);break;case ru:u.depthFunc(u.GEQUAL);break;case G:u.depthFunc(u.GREATER);break;case Xl:u.depthFunc(u.NOTEQUAL);break;default:u.depthFunc(u.LEQUAL)}gt=ln}},setLocked:function(ln){we=ln},setClear:function(ln){Wt!==ln&&(u.clearDepth(ln),Wt=ln)},reset:function(){we=!1,qe=null,gt=null,Wt=null}}}function m(){let we=!1,qe=null,gt=null,Wt=null,ln=null,si=null,Fr=null,as=null,Ku=null;return{setTest:function(zi){we||(zi?Bt(u.STENCIL_TEST):Kt(u.STENCIL_TEST))},setMask:function(zi){qe!==zi&&!we&&(u.stencilMask(zi),qe=zi)},setFunc:function(zi,Tl,Lo){(gt!==zi||Wt!==Tl||ln!==Lo)&&(u.stencilFunc(zi,Tl,Lo),gt=zi,Wt=Tl,ln=Lo)},setOp:function(zi,Tl,Lo){(si!==zi||Fr!==Tl||as!==Lo)&&(u.stencilOp(zi,Tl,Lo),si=zi,Fr=Tl,as=Lo)},setLocked:function(zi){we=zi},setClear:function(zi){Ku!==zi&&(u.clearStencil(zi),Ku=zi)},reset:function(){we=!1,qe=null,gt=null,Wt=null,ln=null,si=null,Fr=null,as=null,Ku=null}}}const g=new a,_=new c,w=new m,A=new WeakMap,C=new WeakMap;let M={},R={},F=new WeakMap,D=[],O=null,W=!1,K=null,V=null,Y=null,se=null,ue=null,me=null,J=null,ae=!1,xe=null,We=null,Je=null,Le=null,Me=null;const Ke=u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let rt=!1,yt=0;const et=u.getParameter(u.VERSION);et.indexOf("WebGL")!==-1?(yt=parseFloat(/^WebGL (\d)/.exec(et)[1]),rt=yt>=1):et.indexOf("OpenGL ES")!==-1&&(yt=parseFloat(/^OpenGL ES (\d)/.exec(et)[1]),rt=yt>=2);let _t=null,ut={};const $t=u.getParameter(u.SCISSOR_BOX),Fe=u.getParameter(u.VIEWPORT),ft=new Zn().fromArray($t),Dt=new Zn().fromArray(Fe);function _e(we,qe,gt){const Wt=new Uint8Array(4),ln=u.createTexture();u.bindTexture(we,ln),u.texParameteri(we,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(we,u.TEXTURE_MAG_FILTER,u.NEAREST);for(let si=0;si<gt;si++)u.texImage2D(qe+si,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,Wt);return ln}const qt={};qt[u.TEXTURE_2D]=_e(u.TEXTURE_2D,u.TEXTURE_2D,1),qt[u.TEXTURE_CUBE_MAP]=_e(u.TEXTURE_CUBE_MAP,u.TEXTURE_CUBE_MAP_POSITIVE_X,6),g.setClear(0,0,0,1),_.setClear(1),w.setClear(0),Bt(u.DEPTH_TEST),_.setFunc(nl),It(!1),bn(k),Bt(u.CULL_FACE),Tt(re);function Bt(we){M[we]!==!0&&(u.enable(we),M[we]=!0)}function Kt(we){M[we]!==!1&&(u.disable(we),M[we]=!1)}function en(we,qe){return R[we]!==qe?(u.bindFramebuffer(we,qe),R[we]=qe,s&&(we===u.DRAW_FRAMEBUFFER&&(R[u.FRAMEBUFFER]=qe),we===u.FRAMEBUFFER&&(R[u.DRAW_FRAMEBUFFER]=qe)),!0):!1}function sn(we,qe){let gt=D,Wt=!1;if(we)if(gt=F.get(qe),gt===void 0&&(gt=[],F.set(qe,gt)),we.isWebGLMultipleRenderTargets){const ln=we.texture;if(gt.length!==ln.length||gt[0]!==u.COLOR_ATTACHMENT0){for(let si=0,Fr=ln.length;si<Fr;si++)gt[si]=u.COLOR_ATTACHMENT0+si;gt.length=ln.length,Wt=!0}}else gt[0]!==u.COLOR_ATTACHMENT0&&(gt[0]=u.COLOR_ATTACHMENT0,Wt=!0);else gt[0]!==u.BACK&&(gt[0]=u.BACK,Wt=!0);Wt&&(n.isWebGL2?u.drawBuffers(gt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(gt))}function xn(we){return O!==we?(u.useProgram(we),O=we,!0):!1}const tt={[vt]:u.FUNC_ADD,[Sn]:u.FUNC_SUBTRACT,[Oi]:u.FUNC_REVERSE_SUBTRACT};if(s)tt[Fi]=u.MIN,tt[$r]=u.MAX;else{const we=e.get("EXT_blend_minmax");we!==null&&(tt[Fi]=we.MIN_EXT,tt[$r]=we.MAX_EXT)}const ct={[Ei]:u.ZERO,[gr]:u.ONE,[ms]:u.SRC_COLOR,[tn]:u.SRC_ALPHA,[ba]:u.SRC_ALPHA_SATURATE,[Ds]:u.DST_COLOR,[fi]:u.DST_ALPHA,[mt]:u.ONE_MINUS_SRC_COLOR,[yn]:u.ONE_MINUS_SRC_ALPHA,[es]:u.ONE_MINUS_DST_COLOR,[wi]:u.ONE_MINUS_DST_ALPHA};function Tt(we,qe,gt,Wt,ln,si,Fr,as){if(we===re){W===!0&&(Kt(u.BLEND),W=!1);return}if(W===!1&&(Bt(u.BLEND),W=!0),we!==Ct){if(we!==K||as!==ae){if((V!==vt||ue!==vt)&&(u.blendEquation(u.FUNC_ADD),V=vt,ue=vt),as)switch(we){case ve:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Be:u.blendFunc(u.ONE,u.ONE);break;case Ge:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Ie:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}else switch(we){case ve:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Be:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case Ge:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Ie:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}Y=null,se=null,me=null,J=null,K=we,ae=as}return}ln=ln||qe,si=si||gt,Fr=Fr||Wt,(qe!==V||ln!==ue)&&(u.blendEquationSeparate(tt[qe],tt[ln]),V=qe,ue=ln),(gt!==Y||Wt!==se||si!==me||Fr!==J)&&(u.blendFuncSeparate(ct[gt],ct[Wt],ct[si],ct[Fr]),Y=gt,se=Wt,me=si,J=Fr),K=we,ae=!1}function an(we,qe){we.side===ie?Kt(u.CULL_FACE):Bt(u.CULL_FACE);let gt=we.side===ce;qe&&(gt=!gt),It(gt),we.blending===ve&&we.transparent===!1?Tt(re):Tt(we.blending,we.blendEquation,we.blendSrc,we.blendDst,we.blendEquationAlpha,we.blendSrcAlpha,we.blendDstAlpha,we.premultipliedAlpha),_.setFunc(we.depthFunc),_.setTest(we.depthTest),_.setMask(we.depthWrite),g.setMask(we.colorWrite);const Wt=we.stencilWrite;w.setTest(Wt),Wt&&(w.setMask(we.stencilWriteMask),w.setFunc(we.stencilFunc,we.stencilRef,we.stencilFuncMask),w.setOp(we.stencilFail,we.stencilZFail,we.stencilZPass)),wn(we.polygonOffset,we.polygonOffsetFactor,we.polygonOffsetUnits),we.alphaToCoverage===!0?Bt(u.SAMPLE_ALPHA_TO_COVERAGE):Kt(u.SAMPLE_ALPHA_TO_COVERAGE)}function It(we){xe!==we&&(we?u.frontFace(u.CW):u.frontFace(u.CCW),xe=we)}function bn(we){we!==L?(Bt(u.CULL_FACE),we!==We&&(we===k?u.cullFace(u.BACK):we===X?u.cullFace(u.FRONT):u.cullFace(u.FRONT_AND_BACK))):Kt(u.CULL_FACE),We=we}function hn(we){we!==Je&&(rt&&u.lineWidth(we),Je=we)}function wn(we,qe,gt){we?(Bt(u.POLYGON_OFFSET_FILL),(Le!==qe||Me!==gt)&&(u.polygonOffset(qe,gt),Le=qe,Me=gt)):Kt(u.POLYGON_OFFSET_FILL)}function Si(we){we?Bt(u.SCISSOR_TEST):Kt(u.SCISSOR_TEST)}function hi(we){we===void 0&&(we=u.TEXTURE0+Ke-1),_t!==we&&(u.activeTexture(we),_t=we)}function de(we,qe,gt){gt===void 0&&(_t===null?gt=u.TEXTURE0+Ke-1:gt=_t);let Wt=ut[gt];Wt===void 0&&(Wt={type:void 0,texture:void 0},ut[gt]=Wt),(Wt.type!==we||Wt.texture!==qe)&&(_t!==gt&&(u.activeTexture(gt),_t=gt),u.bindTexture(we,qe||qt[we]),Wt.type=we,Wt.texture=qe)}function ne(){const we=ut[_t];we!==void 0&&we.type!==void 0&&(u.bindTexture(we.type,null),we.type=void 0,we.texture=void 0)}function je(){try{u.compressedTexImage2D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function At(){try{u.compressedTexImage3D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Mt(){try{u.texSubImage2D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function kt(){try{u.texSubImage3D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function cn(){try{u.compressedTexSubImage2D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Vt(){try{u.compressedTexSubImage3D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function nt(){try{u.texStorage2D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function pn(){try{u.texStorage3D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function rn(){try{u.texImage2D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function An(){try{u.texImage3D.apply(u,arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function gn(we){ft.equals(we)===!1&&(u.scissor(we.x,we.y,we.z,we.w),ft.copy(we))}function dn(we){Dt.equals(we)===!1&&(u.viewport(we.x,we.y,we.z,we.w),Dt.copy(we))}function ei(we,qe){let gt=C.get(qe);gt===void 0&&(gt=new WeakMap,C.set(qe,gt));let Wt=gt.get(we);Wt===void 0&&(Wt=u.getUniformBlockIndex(qe,we.name),gt.set(we,Wt))}function Vi(we,qe){const Wt=C.get(qe).get(we);A.get(qe)!==Wt&&(u.uniformBlockBinding(qe,Wt,we.__bindingPointIndex),A.set(qe,Wt))}function Or(){u.disable(u.BLEND),u.disable(u.CULL_FACE),u.disable(u.DEPTH_TEST),u.disable(u.POLYGON_OFFSET_FILL),u.disable(u.SCISSOR_TEST),u.disable(u.STENCIL_TEST),u.disable(u.SAMPLE_ALPHA_TO_COVERAGE),u.blendEquation(u.FUNC_ADD),u.blendFunc(u.ONE,u.ZERO),u.blendFuncSeparate(u.ONE,u.ZERO,u.ONE,u.ZERO),u.colorMask(!0,!0,!0,!0),u.clearColor(0,0,0,0),u.depthMask(!0),u.depthFunc(u.LESS),u.clearDepth(1),u.stencilMask(4294967295),u.stencilFunc(u.ALWAYS,0,4294967295),u.stencilOp(u.KEEP,u.KEEP,u.KEEP),u.clearStencil(0),u.cullFace(u.BACK),u.frontFace(u.CCW),u.polygonOffset(0,0),u.activeTexture(u.TEXTURE0),u.bindFramebuffer(u.FRAMEBUFFER,null),s===!0&&(u.bindFramebuffer(u.DRAW_FRAMEBUFFER,null),u.bindFramebuffer(u.READ_FRAMEBUFFER,null)),u.useProgram(null),u.lineWidth(1),u.scissor(0,0,u.canvas.width,u.canvas.height),u.viewport(0,0,u.canvas.width,u.canvas.height),M={},_t=null,ut={},R={},F=new WeakMap,D=[],O=null,W=!1,K=null,V=null,Y=null,se=null,ue=null,me=null,J=null,ae=!1,xe=null,We=null,Je=null,Le=null,Me=null,ft.set(0,0,u.canvas.width,u.canvas.height),Dt.set(0,0,u.canvas.width,u.canvas.height),g.reset(),_.reset(),w.reset()}return{buffers:{color:g,depth:_,stencil:w},enable:Bt,disable:Kt,bindFramebuffer:en,drawBuffers:sn,useProgram:xn,setBlending:Tt,setMaterial:an,setFlipSided:It,setCullFace:bn,setLineWidth:hn,setPolygonOffset:wn,setScissorTest:Si,activeTexture:hi,bindTexture:de,unbindTexture:ne,compressedTexImage2D:je,compressedTexImage3D:At,texImage2D:rn,texImage3D:An,updateUBOMapping:ei,uniformBlockBinding:Vi,texStorage2D:nt,texStorage3D:pn,texSubImage2D:Mt,texSubImage3D:kt,compressedTexSubImage2D:cn,compressedTexSubImage3D:Vt,scissor:gn,viewport:dn,reset:Or}}function ND(u,e,n,s,a,c,m){const g=a.isWebGL2,_=a.maxTextures,w=a.maxCubemapSize,A=a.maxTextureSize,C=a.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,R=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),F=new WeakMap;let D;const O=new WeakMap;let W=!1;try{W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function K(de,ne){return W?new OffscreenCanvas(de,ne):wu("canvas")}function V(de,ne,je,At){let Mt=1;if((de.width>At||de.height>At)&&(Mt=At/Math.max(de.width,de.height)),Mt<1||ne===!0)if(typeof HTMLImageElement<"u"&&de instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&de instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&de instanceof ImageBitmap){const kt=ne?hl:Math.floor,cn=kt(Mt*de.width),Vt=kt(Mt*de.height);D===void 0&&(D=K(cn,Vt));const nt=je?K(cn,Vt):D;return nt.width=cn,nt.height=Vt,nt.getContext("2d").drawImage(de,0,0,cn,Vt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+de.width+"x"+de.height+") to ("+cn+"x"+Vt+")."),nt}else return"data"in de&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+de.width+"x"+de.height+")."),de;return de}function Y(de){return ys(de.width)&&ys(de.height)}function se(de){return g?!1:de.wrapS!==Bi||de.wrapT!==Bi||de.minFilter!==Ti&&de.minFilter!==Ci}function ue(de,ne){return de.generateMipmaps&&ne&&de.minFilter!==Ti&&de.minFilter!==Ci}function me(de){u.generateMipmap(de)}function J(de,ne,je,At,Mt=!1){if(g===!1)return ne;if(de!==null){if(u[de]!==void 0)return u[de];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+de+"'")}let kt=ne;return ne===u.RED&&(je===u.FLOAT&&(kt=u.R32F),je===u.HALF_FLOAT&&(kt=u.R16F),je===u.UNSIGNED_BYTE&&(kt=u.R8)),ne===u.RG&&(je===u.FLOAT&&(kt=u.RG32F),je===u.HALF_FLOAT&&(kt=u.RG16F),je===u.UNSIGNED_BYTE&&(kt=u.RG8)),ne===u.RGBA&&(je===u.FLOAT&&(kt=u.RGBA32F),je===u.HALF_FLOAT&&(kt=u.RGBA16F),je===u.UNSIGNED_BYTE&&(kt=At===pi&&Mt===!1?u.SRGB8_ALPHA8:u.RGBA8),je===u.UNSIGNED_SHORT_4_4_4_4&&(kt=u.RGBA4),je===u.UNSIGNED_SHORT_5_5_5_1&&(kt=u.RGB5_A1)),(kt===u.R16F||kt===u.R32F||kt===u.RG16F||kt===u.RG32F||kt===u.RGBA16F||kt===u.RGBA32F)&&e.get("EXT_color_buffer_float"),kt}function ae(de,ne,je){return ue(de,je)===!0||de.isFramebufferTexture&&de.minFilter!==Ti&&de.minFilter!==Ci?Math.log2(Math.max(ne.width,ne.height))+1:de.mipmaps!==void 0&&de.mipmaps.length>0?de.mipmaps.length:de.isCompressedTexture&&Array.isArray(de.image)?ne.mipmaps.length:1}function xe(de){return de===Ti||de===ql||de===_r?u.NEAREST:u.LINEAR}function We(de){const ne=de.target;ne.removeEventListener("dispose",We),Le(ne),ne.isVideoTexture&&F.delete(ne)}function Je(de){const ne=de.target;ne.removeEventListener("dispose",Je),Ke(ne)}function Le(de){const ne=s.get(de);if(ne.__webglInit===void 0)return;const je=de.source,At=O.get(je);if(At){const Mt=At[ne.__cacheKey];Mt.usedTimes--,Mt.usedTimes===0&&Me(de),Object.keys(At).length===0&&O.delete(je)}s.remove(de)}function Me(de){const ne=s.get(de);u.deleteTexture(ne.__webglTexture);const je=de.source,At=O.get(je);delete At[ne.__cacheKey],m.memory.textures--}function Ke(de){const ne=de.texture,je=s.get(de),At=s.get(ne);if(At.__webglTexture!==void 0&&(u.deleteTexture(At.__webglTexture),m.memory.textures--),de.depthTexture&&de.depthTexture.dispose(),de.isWebGLCubeRenderTarget)for(let Mt=0;Mt<6;Mt++)u.deleteFramebuffer(je.__webglFramebuffer[Mt]),je.__webglDepthbuffer&&u.deleteRenderbuffer(je.__webglDepthbuffer[Mt]);else{if(u.deleteFramebuffer(je.__webglFramebuffer),je.__webglDepthbuffer&&u.deleteRenderbuffer(je.__webglDepthbuffer),je.__webglMultisampledFramebuffer&&u.deleteFramebuffer(je.__webglMultisampledFramebuffer),je.__webglColorRenderbuffer)for(let Mt=0;Mt<je.__webglColorRenderbuffer.length;Mt++)je.__webglColorRenderbuffer[Mt]&&u.deleteRenderbuffer(je.__webglColorRenderbuffer[Mt]);je.__webglDepthRenderbuffer&&u.deleteRenderbuffer(je.__webglDepthRenderbuffer)}if(de.isWebGLMultipleRenderTargets)for(let Mt=0,kt=ne.length;Mt<kt;Mt++){const cn=s.get(ne[Mt]);cn.__webglTexture&&(u.deleteTexture(cn.__webglTexture),m.memory.textures--),s.remove(ne[Mt])}s.remove(ne),s.remove(de)}let rt=0;function yt(){rt=0}function et(){const de=rt;return de>=_&&console.warn("THREE.WebGLTextures: Trying to use "+de+" texture units while this GPU supports only "+_),rt+=1,de}function _t(de){const ne=[];return ne.push(de.wrapS),ne.push(de.wrapT),ne.push(de.wrapR||0),ne.push(de.magFilter),ne.push(de.minFilter),ne.push(de.anisotropy),ne.push(de.internalFormat),ne.push(de.format),ne.push(de.type),ne.push(de.generateMipmaps),ne.push(de.premultiplyAlpha),ne.push(de.flipY),ne.push(de.unpackAlignment),ne.push(de.encoding),ne.join()}function ut(de,ne){const je=s.get(de);if(de.isVideoTexture&&Si(de),de.isRenderTargetTexture===!1&&de.version>0&&je.__version!==de.version){const At=de.image;if(At===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(At.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Kt(je,de,ne);return}}n.bindTexture(u.TEXTURE_2D,je.__webglTexture,u.TEXTURE0+ne)}function $t(de,ne){const je=s.get(de);if(de.version>0&&je.__version!==de.version){Kt(je,de,ne);return}n.bindTexture(u.TEXTURE_2D_ARRAY,je.__webglTexture,u.TEXTURE0+ne)}function Fe(de,ne){const je=s.get(de);if(de.version>0&&je.__version!==de.version){Kt(je,de,ne);return}n.bindTexture(u.TEXTURE_3D,je.__webglTexture,u.TEXTURE0+ne)}function ft(de,ne){const je=s.get(de);if(de.version>0&&je.__version!==de.version){en(je,de,ne);return}n.bindTexture(u.TEXTURE_CUBE_MAP,je.__webglTexture,u.TEXTURE0+ne)}const Dt={[Vs]:u.REPEAT,[Bi]:u.CLAMP_TO_EDGE,[wa]:u.MIRRORED_REPEAT},_e={[Ti]:u.NEAREST,[ql]:u.NEAREST_MIPMAP_NEAREST,[_r]:u.NEAREST_MIPMAP_LINEAR,[Ci]:u.LINEAR,[cu]:u.LINEAR_MIPMAP_NEAREST,[xo]:u.LINEAR_MIPMAP_LINEAR};function qt(de,ne,je){if(je?(u.texParameteri(de,u.TEXTURE_WRAP_S,Dt[ne.wrapS]),u.texParameteri(de,u.TEXTURE_WRAP_T,Dt[ne.wrapT]),(de===u.TEXTURE_3D||de===u.TEXTURE_2D_ARRAY)&&u.texParameteri(de,u.TEXTURE_WRAP_R,Dt[ne.wrapR]),u.texParameteri(de,u.TEXTURE_MAG_FILTER,_e[ne.magFilter]),u.texParameteri(de,u.TEXTURE_MIN_FILTER,_e[ne.minFilter])):(u.texParameteri(de,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(de,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),(de===u.TEXTURE_3D||de===u.TEXTURE_2D_ARRAY)&&u.texParameteri(de,u.TEXTURE_WRAP_R,u.CLAMP_TO_EDGE),(ne.wrapS!==Bi||ne.wrapT!==Bi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),u.texParameteri(de,u.TEXTURE_MAG_FILTER,xe(ne.magFilter)),u.texParameteri(de,u.TEXTURE_MIN_FILTER,xe(ne.minFilter)),ne.minFilter!==Ti&&ne.minFilter!==Ci&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const At=e.get("EXT_texture_filter_anisotropic");if(ne.magFilter===Ti||ne.minFilter!==_r&&ne.minFilter!==xo||ne.type===js&&e.has("OES_texture_float_linear")===!1||g===!1&&ne.type===Aa&&e.has("OES_texture_half_float_linear")===!1)return;(ne.anisotropy>1||s.get(ne).__currentAnisotropy)&&(u.texParameterf(de,At.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ne.anisotropy,a.getMaxAnisotropy())),s.get(ne).__currentAnisotropy=ne.anisotropy)}}function Bt(de,ne){let je=!1;de.__webglInit===void 0&&(de.__webglInit=!0,ne.addEventListener("dispose",We));const At=ne.source;let Mt=O.get(At);Mt===void 0&&(Mt={},O.set(At,Mt));const kt=_t(ne);if(kt!==de.__cacheKey){Mt[kt]===void 0&&(Mt[kt]={texture:u.createTexture(),usedTimes:0},m.memory.textures++,je=!0),Mt[kt].usedTimes++;const cn=Mt[de.__cacheKey];cn!==void 0&&(Mt[de.__cacheKey].usedTimes--,cn.usedTimes===0&&Me(ne)),de.__cacheKey=kt,de.__webglTexture=Mt[kt].texture}return je}function Kt(de,ne,je){let At=u.TEXTURE_2D;(ne.isDataArrayTexture||ne.isCompressedArrayTexture)&&(At=u.TEXTURE_2D_ARRAY),ne.isData3DTexture&&(At=u.TEXTURE_3D);const Mt=Bt(de,ne),kt=ne.source;n.bindTexture(At,de.__webglTexture,u.TEXTURE0+je);const cn=s.get(kt);if(kt.version!==cn.__version||Mt===!0){n.activeTexture(u.TEXTURE0+je),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,ne.flipY),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),u.pixelStorei(u.UNPACK_ALIGNMENT,ne.unpackAlignment),u.pixelStorei(u.UNPACK_COLORSPACE_CONVERSION_WEBGL,u.NONE);const Vt=se(ne)&&Y(ne.image)===!1;let nt=V(ne.image,Vt,!1,A);nt=hi(ne,nt);const pn=Y(nt)||g,rn=c.convert(ne.format,ne.encoding);let An=c.convert(ne.type),gn=J(ne.internalFormat,rn,An,ne.encoding,ne.isVideoTexture);qt(At,ne,pn);let dn;const ei=ne.mipmaps,Vi=g&&ne.isVideoTexture!==!0,Or=cn.__version===void 0||Mt===!0,we=ae(ne,nt,pn);if(ne.isDepthTexture)gn=u.DEPTH_COMPONENT,g?ne.type===js?gn=u.DEPTH_COMPONENT32F:ne.type===Ws?gn=u.DEPTH_COMPONENT24:ne.type===Vo?gn=u.DEPTH24_STENCIL8:gn=u.DEPTH_COMPONENT16:ne.type===js&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ne.format===Kn&&gn===u.DEPTH_COMPONENT&&ne.type!==uu&&ne.type!==Ws&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ne.type=Ws,An=c.convert(ne.type)),ne.format===ki&&gn===u.DEPTH_COMPONENT&&(gn=u.DEPTH_STENCIL,ne.type!==Vo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ne.type=Vo,An=c.convert(ne.type))),Or&&(Vi?n.texStorage2D(u.TEXTURE_2D,1,gn,nt.width,nt.height):n.texImage2D(u.TEXTURE_2D,0,gn,nt.width,nt.height,0,rn,An,null));else if(ne.isDataTexture)if(ei.length>0&&pn){Vi&&Or&&n.texStorage2D(u.TEXTURE_2D,we,gn,ei[0].width,ei[0].height);for(let qe=0,gt=ei.length;qe<gt;qe++)dn=ei[qe],Vi?n.texSubImage2D(u.TEXTURE_2D,qe,0,0,dn.width,dn.height,rn,An,dn.data):n.texImage2D(u.TEXTURE_2D,qe,gn,dn.width,dn.height,0,rn,An,dn.data);ne.generateMipmaps=!1}else Vi?(Or&&n.texStorage2D(u.TEXTURE_2D,we,gn,nt.width,nt.height),n.texSubImage2D(u.TEXTURE_2D,0,0,0,nt.width,nt.height,rn,An,nt.data)):n.texImage2D(u.TEXTURE_2D,0,gn,nt.width,nt.height,0,rn,An,nt.data);else if(ne.isCompressedTexture)if(ne.isCompressedArrayTexture){Vi&&Or&&n.texStorage3D(u.TEXTURE_2D_ARRAY,we,gn,ei[0].width,ei[0].height,nt.depth);for(let qe=0,gt=ei.length;qe<gt;qe++)dn=ei[qe],ne.format!==Hr?rn!==null?Vi?n.compressedTexSubImage3D(u.TEXTURE_2D_ARRAY,qe,0,0,0,dn.width,dn.height,nt.depth,rn,dn.data,0,0):n.compressedTexImage3D(u.TEXTURE_2D_ARRAY,qe,gn,dn.width,dn.height,nt.depth,0,dn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Vi?n.texSubImage3D(u.TEXTURE_2D_ARRAY,qe,0,0,0,dn.width,dn.height,nt.depth,rn,An,dn.data):n.texImage3D(u.TEXTURE_2D_ARRAY,qe,gn,dn.width,dn.height,nt.depth,0,rn,An,dn.data)}else{Vi&&Or&&n.texStorage2D(u.TEXTURE_2D,we,gn,ei[0].width,ei[0].height);for(let qe=0,gt=ei.length;qe<gt;qe++)dn=ei[qe],ne.format!==Hr?rn!==null?Vi?n.compressedTexSubImage2D(u.TEXTURE_2D,qe,0,0,dn.width,dn.height,rn,dn.data):n.compressedTexImage2D(u.TEXTURE_2D,qe,gn,dn.width,dn.height,0,dn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Vi?n.texSubImage2D(u.TEXTURE_2D,qe,0,0,dn.width,dn.height,rn,An,dn.data):n.texImage2D(u.TEXTURE_2D,qe,gn,dn.width,dn.height,0,rn,An,dn.data)}else if(ne.isDataArrayTexture)Vi?(Or&&n.texStorage3D(u.TEXTURE_2D_ARRAY,we,gn,nt.width,nt.height,nt.depth),n.texSubImage3D(u.TEXTURE_2D_ARRAY,0,0,0,0,nt.width,nt.height,nt.depth,rn,An,nt.data)):n.texImage3D(u.TEXTURE_2D_ARRAY,0,gn,nt.width,nt.height,nt.depth,0,rn,An,nt.data);else if(ne.isData3DTexture)Vi?(Or&&n.texStorage3D(u.TEXTURE_3D,we,gn,nt.width,nt.height,nt.depth),n.texSubImage3D(u.TEXTURE_3D,0,0,0,0,nt.width,nt.height,nt.depth,rn,An,nt.data)):n.texImage3D(u.TEXTURE_3D,0,gn,nt.width,nt.height,nt.depth,0,rn,An,nt.data);else if(ne.isFramebufferTexture){if(Or)if(Vi)n.texStorage2D(u.TEXTURE_2D,we,gn,nt.width,nt.height);else{let qe=nt.width,gt=nt.height;for(let Wt=0;Wt<we;Wt++)n.texImage2D(u.TEXTURE_2D,Wt,gn,qe,gt,0,rn,An,null),qe>>=1,gt>>=1}}else if(ei.length>0&&pn){Vi&&Or&&n.texStorage2D(u.TEXTURE_2D,we,gn,ei[0].width,ei[0].height);for(let qe=0,gt=ei.length;qe<gt;qe++)dn=ei[qe],Vi?n.texSubImage2D(u.TEXTURE_2D,qe,0,0,rn,An,dn):n.texImage2D(u.TEXTURE_2D,qe,gn,rn,An,dn);ne.generateMipmaps=!1}else Vi?(Or&&n.texStorage2D(u.TEXTURE_2D,we,gn,nt.width,nt.height),n.texSubImage2D(u.TEXTURE_2D,0,0,0,rn,An,nt)):n.texImage2D(u.TEXTURE_2D,0,gn,rn,An,nt);ue(ne,pn)&&me(At),cn.__version=kt.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function en(de,ne,je){if(ne.image.length!==6)return;const At=Bt(de,ne),Mt=ne.source;n.bindTexture(u.TEXTURE_CUBE_MAP,de.__webglTexture,u.TEXTURE0+je);const kt=s.get(Mt);if(Mt.version!==kt.__version||At===!0){n.activeTexture(u.TEXTURE0+je),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,ne.flipY),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),u.pixelStorei(u.UNPACK_ALIGNMENT,ne.unpackAlignment),u.pixelStorei(u.UNPACK_COLORSPACE_CONVERSION_WEBGL,u.NONE);const cn=ne.isCompressedTexture||ne.image[0].isCompressedTexture,Vt=ne.image[0]&&ne.image[0].isDataTexture,nt=[];for(let qe=0;qe<6;qe++)!cn&&!Vt?nt[qe]=V(ne.image[qe],!1,!0,w):nt[qe]=Vt?ne.image[qe].image:ne.image[qe],nt[qe]=hi(ne,nt[qe]);const pn=nt[0],rn=Y(pn)||g,An=c.convert(ne.format,ne.encoding),gn=c.convert(ne.type),dn=J(ne.internalFormat,An,gn,ne.encoding),ei=g&&ne.isVideoTexture!==!0,Vi=kt.__version===void 0||At===!0;let Or=ae(ne,pn,rn);qt(u.TEXTURE_CUBE_MAP,ne,rn);let we;if(cn){ei&&Vi&&n.texStorage2D(u.TEXTURE_CUBE_MAP,Or,dn,pn.width,pn.height);for(let qe=0;qe<6;qe++){we=nt[qe].mipmaps;for(let gt=0;gt<we.length;gt++){const Wt=we[gt];ne.format!==Hr?An!==null?ei?n.compressedTexSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt,0,0,Wt.width,Wt.height,An,Wt.data):n.compressedTexImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt,dn,Wt.width,Wt.height,0,Wt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ei?n.texSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt,0,0,Wt.width,Wt.height,An,gn,Wt.data):n.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt,dn,Wt.width,Wt.height,0,An,gn,Wt.data)}}}else{we=ne.mipmaps,ei&&Vi&&(we.length>0&&Or++,n.texStorage2D(u.TEXTURE_CUBE_MAP,Or,dn,nt[0].width,nt[0].height));for(let qe=0;qe<6;qe++)if(Vt){ei?n.texSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,0,0,nt[qe].width,nt[qe].height,An,gn,nt[qe].data):n.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,dn,nt[qe].width,nt[qe].height,0,An,gn,nt[qe].data);for(let gt=0;gt<we.length;gt++){const ln=we[gt].image[qe].image;ei?n.texSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt+1,0,0,ln.width,ln.height,An,gn,ln.data):n.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt+1,dn,ln.width,ln.height,0,An,gn,ln.data)}}else{ei?n.texSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,0,0,An,gn,nt[qe]):n.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,dn,An,gn,nt[qe]);for(let gt=0;gt<we.length;gt++){const Wt=we[gt];ei?n.texSubImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt+1,0,0,An,gn,Wt.image[qe]):n.texImage2D(u.TEXTURE_CUBE_MAP_POSITIVE_X+qe,gt+1,dn,An,gn,Wt.image[qe])}}}ue(ne,rn)&&me(u.TEXTURE_CUBE_MAP),kt.__version=Mt.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function sn(de,ne,je,At,Mt){const kt=c.convert(je.format,je.encoding),cn=c.convert(je.type),Vt=J(je.internalFormat,kt,cn,je.encoding);s.get(ne).__hasExternalTextures||(Mt===u.TEXTURE_3D||Mt===u.TEXTURE_2D_ARRAY?n.texImage3D(Mt,0,Vt,ne.width,ne.height,ne.depth,0,kt,cn,null):n.texImage2D(Mt,0,Vt,ne.width,ne.height,0,kt,cn,null)),n.bindFramebuffer(u.FRAMEBUFFER,de),wn(ne)?M.framebufferTexture2DMultisampleEXT(u.FRAMEBUFFER,At,Mt,s.get(je).__webglTexture,0,hn(ne)):(Mt===u.TEXTURE_2D||Mt>=u.TEXTURE_CUBE_MAP_POSITIVE_X&&Mt<=u.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&u.framebufferTexture2D(u.FRAMEBUFFER,At,Mt,s.get(je).__webglTexture,0),n.bindFramebuffer(u.FRAMEBUFFER,null)}function xn(de,ne,je){if(u.bindRenderbuffer(u.RENDERBUFFER,de),ne.depthBuffer&&!ne.stencilBuffer){let At=u.DEPTH_COMPONENT16;if(je||wn(ne)){const Mt=ne.depthTexture;Mt&&Mt.isDepthTexture&&(Mt.type===js?At=u.DEPTH_COMPONENT32F:Mt.type===Ws&&(At=u.DEPTH_COMPONENT24));const kt=hn(ne);wn(ne)?M.renderbufferStorageMultisampleEXT(u.RENDERBUFFER,kt,At,ne.width,ne.height):u.renderbufferStorageMultisample(u.RENDERBUFFER,kt,At,ne.width,ne.height)}else u.renderbufferStorage(u.RENDERBUFFER,At,ne.width,ne.height);u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,de)}else if(ne.depthBuffer&&ne.stencilBuffer){const At=hn(ne);je&&wn(ne)===!1?u.renderbufferStorageMultisample(u.RENDERBUFFER,At,u.DEPTH24_STENCIL8,ne.width,ne.height):wn(ne)?M.renderbufferStorageMultisampleEXT(u.RENDERBUFFER,At,u.DEPTH24_STENCIL8,ne.width,ne.height):u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,ne.width,ne.height),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,de)}else{const At=ne.isWebGLMultipleRenderTargets===!0?ne.texture:[ne.texture];for(let Mt=0;Mt<At.length;Mt++){const kt=At[Mt],cn=c.convert(kt.format,kt.encoding),Vt=c.convert(kt.type),nt=J(kt.internalFormat,cn,Vt,kt.encoding),pn=hn(ne);je&&wn(ne)===!1?u.renderbufferStorageMultisample(u.RENDERBUFFER,pn,nt,ne.width,ne.height):wn(ne)?M.renderbufferStorageMultisampleEXT(u.RENDERBUFFER,pn,nt,ne.width,ne.height):u.renderbufferStorage(u.RENDERBUFFER,nt,ne.width,ne.height)}}u.bindRenderbuffer(u.RENDERBUFFER,null)}function tt(de,ne){if(ne&&ne.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(u.FRAMEBUFFER,de),!(ne.depthTexture&&ne.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!s.get(ne.depthTexture).__webglTexture||ne.depthTexture.image.width!==ne.width||ne.depthTexture.image.height!==ne.height)&&(ne.depthTexture.image.width=ne.width,ne.depthTexture.image.height=ne.height,ne.depthTexture.needsUpdate=!0),ut(ne.depthTexture,0);const At=s.get(ne.depthTexture).__webglTexture,Mt=hn(ne);if(ne.depthTexture.format===Kn)wn(ne)?M.framebufferTexture2DMultisampleEXT(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.TEXTURE_2D,At,0,Mt):u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.TEXTURE_2D,At,0);else if(ne.depthTexture.format===ki)wn(ne)?M.framebufferTexture2DMultisampleEXT(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.TEXTURE_2D,At,0,Mt):u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.TEXTURE_2D,At,0);else throw new Error("Unknown depthTexture format")}function ct(de){const ne=s.get(de),je=de.isWebGLCubeRenderTarget===!0;if(de.depthTexture&&!ne.__autoAllocateDepthBuffer){if(je)throw new Error("target.depthTexture not supported in Cube render targets");tt(ne.__webglFramebuffer,de)}else if(je){ne.__webglDepthbuffer=[];for(let At=0;At<6;At++)n.bindFramebuffer(u.FRAMEBUFFER,ne.__webglFramebuffer[At]),ne.__webglDepthbuffer[At]=u.createRenderbuffer(),xn(ne.__webglDepthbuffer[At],de,!1)}else n.bindFramebuffer(u.FRAMEBUFFER,ne.__webglFramebuffer),ne.__webglDepthbuffer=u.createRenderbuffer(),xn(ne.__webglDepthbuffer,de,!1);n.bindFramebuffer(u.FRAMEBUFFER,null)}function Tt(de,ne,je){const At=s.get(de);ne!==void 0&&sn(At.__webglFramebuffer,de,de.texture,u.COLOR_ATTACHMENT0,u.TEXTURE_2D),je!==void 0&&ct(de)}function an(de){const ne=de.texture,je=s.get(de),At=s.get(ne);de.addEventListener("dispose",Je),de.isWebGLMultipleRenderTargets!==!0&&(At.__webglTexture===void 0&&(At.__webglTexture=u.createTexture()),At.__version=ne.version,m.memory.textures++);const Mt=de.isWebGLCubeRenderTarget===!0,kt=de.isWebGLMultipleRenderTargets===!0,cn=Y(de)||g;if(Mt){je.__webglFramebuffer=[];for(let Vt=0;Vt<6;Vt++)je.__webglFramebuffer[Vt]=u.createFramebuffer()}else{if(je.__webglFramebuffer=u.createFramebuffer(),kt)if(a.drawBuffers){const Vt=de.texture;for(let nt=0,pn=Vt.length;nt<pn;nt++){const rn=s.get(Vt[nt]);rn.__webglTexture===void 0&&(rn.__webglTexture=u.createTexture(),m.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(g&&de.samples>0&&wn(de)===!1){const Vt=kt?ne:[ne];je.__webglMultisampledFramebuffer=u.createFramebuffer(),je.__webglColorRenderbuffer=[],n.bindFramebuffer(u.FRAMEBUFFER,je.__webglMultisampledFramebuffer);for(let nt=0;nt<Vt.length;nt++){const pn=Vt[nt];je.__webglColorRenderbuffer[nt]=u.createRenderbuffer(),u.bindRenderbuffer(u.RENDERBUFFER,je.__webglColorRenderbuffer[nt]);const rn=c.convert(pn.format,pn.encoding),An=c.convert(pn.type),gn=J(pn.internalFormat,rn,An,pn.encoding,de.isXRRenderTarget===!0),dn=hn(de);u.renderbufferStorageMultisample(u.RENDERBUFFER,dn,gn,de.width,de.height),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0+nt,u.RENDERBUFFER,je.__webglColorRenderbuffer[nt])}u.bindRenderbuffer(u.RENDERBUFFER,null),de.depthBuffer&&(je.__webglDepthRenderbuffer=u.createRenderbuffer(),xn(je.__webglDepthRenderbuffer,de,!0)),n.bindFramebuffer(u.FRAMEBUFFER,null)}}if(Mt){n.bindTexture(u.TEXTURE_CUBE_MAP,At.__webglTexture),qt(u.TEXTURE_CUBE_MAP,ne,cn);for(let Vt=0;Vt<6;Vt++)sn(je.__webglFramebuffer[Vt],de,ne,u.COLOR_ATTACHMENT0,u.TEXTURE_CUBE_MAP_POSITIVE_X+Vt);ue(ne,cn)&&me(u.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(kt){const Vt=de.texture;for(let nt=0,pn=Vt.length;nt<pn;nt++){const rn=Vt[nt],An=s.get(rn);n.bindTexture(u.TEXTURE_2D,An.__webglTexture),qt(u.TEXTURE_2D,rn,cn),sn(je.__webglFramebuffer,de,rn,u.COLOR_ATTACHMENT0+nt,u.TEXTURE_2D),ue(rn,cn)&&me(u.TEXTURE_2D)}n.unbindTexture()}else{let Vt=u.TEXTURE_2D;(de.isWebGL3DRenderTarget||de.isWebGLArrayRenderTarget)&&(g?Vt=de.isWebGL3DRenderTarget?u.TEXTURE_3D:u.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Vt,At.__webglTexture),qt(Vt,ne,cn),sn(je.__webglFramebuffer,de,ne,u.COLOR_ATTACHMENT0,Vt),ue(ne,cn)&&me(Vt),n.unbindTexture()}de.depthBuffer&&ct(de)}function It(de){const ne=Y(de)||g,je=de.isWebGLMultipleRenderTargets===!0?de.texture:[de.texture];for(let At=0,Mt=je.length;At<Mt;At++){const kt=je[At];if(ue(kt,ne)){const cn=de.isWebGLCubeRenderTarget?u.TEXTURE_CUBE_MAP:u.TEXTURE_2D,Vt=s.get(kt).__webglTexture;n.bindTexture(cn,Vt),me(cn),n.unbindTexture()}}}function bn(de){if(g&&de.samples>0&&wn(de)===!1){const ne=de.isWebGLMultipleRenderTargets?de.texture:[de.texture],je=de.width,At=de.height;let Mt=u.COLOR_BUFFER_BIT;const kt=[],cn=de.stencilBuffer?u.DEPTH_STENCIL_ATTACHMENT:u.DEPTH_ATTACHMENT,Vt=s.get(de),nt=de.isWebGLMultipleRenderTargets===!0;if(nt)for(let pn=0;pn<ne.length;pn++)n.bindFramebuffer(u.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0+pn,u.RENDERBUFFER,null),n.bindFramebuffer(u.FRAMEBUFFER,Vt.__webglFramebuffer),u.framebufferTexture2D(u.DRAW_FRAMEBUFFER,u.COLOR_ATTACHMENT0+pn,u.TEXTURE_2D,null,0);n.bindFramebuffer(u.READ_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),n.bindFramebuffer(u.DRAW_FRAMEBUFFER,Vt.__webglFramebuffer);for(let pn=0;pn<ne.length;pn++){kt.push(u.COLOR_ATTACHMENT0+pn),de.depthBuffer&&kt.push(cn);const rn=Vt.__ignoreDepthValues!==void 0?Vt.__ignoreDepthValues:!1;if(rn===!1&&(de.depthBuffer&&(Mt|=u.DEPTH_BUFFER_BIT),de.stencilBuffer&&(Mt|=u.STENCIL_BUFFER_BIT)),nt&&u.framebufferRenderbuffer(u.READ_FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.RENDERBUFFER,Vt.__webglColorRenderbuffer[pn]),rn===!0&&(u.invalidateFramebuffer(u.READ_FRAMEBUFFER,[cn]),u.invalidateFramebuffer(u.DRAW_FRAMEBUFFER,[cn])),nt){const An=s.get(ne[pn]).__webglTexture;u.framebufferTexture2D(u.DRAW_FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,An,0)}u.blitFramebuffer(0,0,je,At,0,0,je,At,Mt,u.NEAREST),R&&u.invalidateFramebuffer(u.READ_FRAMEBUFFER,kt)}if(n.bindFramebuffer(u.READ_FRAMEBUFFER,null),n.bindFramebuffer(u.DRAW_FRAMEBUFFER,null),nt)for(let pn=0;pn<ne.length;pn++){n.bindFramebuffer(u.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0+pn,u.RENDERBUFFER,Vt.__webglColorRenderbuffer[pn]);const rn=s.get(ne[pn]).__webglTexture;n.bindFramebuffer(u.FRAMEBUFFER,Vt.__webglFramebuffer),u.framebufferTexture2D(u.DRAW_FRAMEBUFFER,u.COLOR_ATTACHMENT0+pn,u.TEXTURE_2D,rn,0)}n.bindFramebuffer(u.DRAW_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer)}}function hn(de){return Math.min(C,de.samples)}function wn(de){const ne=s.get(de);return g&&de.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ne.__useRenderToTexture!==!1}function Si(de){const ne=m.render.frame;F.get(de)!==ne&&(F.set(de,ne),de.update())}function hi(de,ne){const je=de.encoding,At=de.format,Mt=de.type;return de.isCompressedTexture===!0||de.isVideoTexture===!0||de.format===yu||je!==Ea&&(je===pi?g===!1?e.has("EXT_sRGB")===!0&&At===Hr?(de.format=yu,de.minFilter=Ci,de.generateMipmaps=!1):ne=Vh.sRGBToLinear(ne):(At!==Hr||Mt!==ts)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",je)),ne}this.allocateTextureUnit=et,this.resetTextureUnits=yt,this.setTexture2D=ut,this.setTexture2DArray=$t,this.setTexture3D=Fe,this.setTextureCube=ft,this.rebindTextures=Tt,this.setupRenderTarget=an,this.updateRenderTargetMipmap=It,this.updateMultisampleRenderTarget=bn,this.setupDepthRenderbuffer=ct,this.setupFrameBufferTexture=sn,this.useMultisampledRTT=wn}function nA(u,e,n){const s=n.isWebGL2;function a(c,m=null){let g;if(c===ts)return u.UNSIGNED_BYTE;if(c===Sh)return u.UNSIGNED_SHORT_4_4_4_4;if(c===Mh)return u.UNSIGNED_SHORT_5_5_5_1;if(c===wh)return u.BYTE;if(c===Ah)return u.SHORT;if(c===uu)return u.UNSIGNED_SHORT;if(c===hu)return u.INT;if(c===Ws)return u.UNSIGNED_INT;if(c===js)return u.FLOAT;if(c===Aa)return s?u.HALF_FLOAT:(g=e.get("OES_texture_half_float"),g!==null?g.HALF_FLOAT_OES:null);if(c===Eh)return u.ALPHA;if(c===Hr)return u.RGBA;if(c===Th)return u.LUMINANCE;if(c===Pn)return u.LUMINANCE_ALPHA;if(c===Kn)return u.DEPTH_COMPONENT;if(c===ki)return u.DEPTH_STENCIL;if(c===yu)return g=e.get("EXT_sRGB"),g!==null?g.SRGB_ALPHA_EXT:null;if(c===Ch)return u.RED;if(c===Ph)return u.RED_INTEGER;if(c===Rh)return u.RG;if(c===Dh)return u.RG_INTEGER;if(c===Ih)return u.RGBA_INTEGER;if(c===Zl||c===il||c===rl||c===sl)if(m===pi)if(g=e.get("WEBGL_compressed_texture_s3tc_srgb"),g!==null){if(c===Zl)return g.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(c===il)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(c===rl)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(c===sl)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(g=e.get("WEBGL_compressed_texture_s3tc"),g!==null){if(c===Zl)return g.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===il)return g.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===rl)return g.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===sl)return g.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(c===du||c===Jl||c===$l||c===ec)if(g=e.get("WEBGL_compressed_texture_pvrtc"),g!==null){if(c===du)return g.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===Jl)return g.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===$l)return g.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===ec)return g.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(c===ol)return g=e.get("WEBGL_compressed_texture_etc1"),g!==null?g.COMPRESSED_RGB_ETC1_WEBGL:null;if(c===al||c===bo)if(g=e.get("WEBGL_compressed_texture_etc"),g!==null){if(c===al)return m===pi?g.COMPRESSED_SRGB8_ETC2:g.COMPRESSED_RGB8_ETC2;if(c===bo)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:g.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(c===Sa||c===ll||c===cl||c===Wo||c===fu||c===Ma||c===jo||c===wo||c===Xo||c===Ao||c===Pt||c===T||c===q||c===he)if(g=e.get("WEBGL_compressed_texture_astc"),g!==null){if(c===Sa)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:g.COMPRESSED_RGBA_ASTC_4x4_KHR;if(c===ll)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:g.COMPRESSED_RGBA_ASTC_5x4_KHR;if(c===cl)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:g.COMPRESSED_RGBA_ASTC_5x5_KHR;if(c===Wo)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:g.COMPRESSED_RGBA_ASTC_6x5_KHR;if(c===fu)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:g.COMPRESSED_RGBA_ASTC_6x6_KHR;if(c===Ma)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:g.COMPRESSED_RGBA_ASTC_8x5_KHR;if(c===jo)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:g.COMPRESSED_RGBA_ASTC_8x6_KHR;if(c===wo)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:g.COMPRESSED_RGBA_ASTC_8x8_KHR;if(c===Xo)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:g.COMPRESSED_RGBA_ASTC_10x5_KHR;if(c===Ao)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:g.COMPRESSED_RGBA_ASTC_10x6_KHR;if(c===Pt)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:g.COMPRESSED_RGBA_ASTC_10x8_KHR;if(c===T)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:g.COMPRESSED_RGBA_ASTC_10x10_KHR;if(c===q)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:g.COMPRESSED_RGBA_ASTC_12x10_KHR;if(c===he)return m===pi?g.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:g.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(c===Ce)if(g=e.get("EXT_texture_compression_bptc"),g!==null){if(c===Ce)return m===pi?g.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:g.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(c===He||c===Ze||c===at||c===zt)if(g=e.get("EXT_texture_compression_rgtc"),g!==null){if(c===Ce)return g.COMPRESSED_RED_RGTC1_EXT;if(c===Ze)return g.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(c===at)return g.COMPRESSED_RED_GREEN_RGTC2_EXT;if(c===zt)return g.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return c===Vo?s?u.UNSIGNED_INT_24_8:(g=e.get("WEBGL_depth_texture"),g!==null?g.UNSIGNED_INT_24_8_WEBGL:null):u[c]!==void 0?u[c]:null}return{convert:a}}class iA extends Mr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ad extends Gn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const zD={type:"move"};class Ty{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ad,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ad,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ad,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const s of e.hand.values())this._getHandJoint(n,s)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,s){let a=null,c=null,m=null;const g=this._targetRay,_=this._grip,w=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(w&&e.hand){m=!0;for(const D of e.hand.values()){const O=n.getJointPose(D,s),W=this._getHandJoint(w,D);O!==null&&(W.matrix.fromArray(O.transform.matrix),W.matrix.decompose(W.position,W.rotation,W.scale),W.jointRadius=O.radius),W.visible=O!==null}const A=w.joints["index-finger-tip"],C=w.joints["thumb-tip"],M=A.position.distanceTo(C.position),R=.02,F=.005;w.inputState.pinching&&M>R+F?(w.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!w.inputState.pinching&&M<=R-F&&(w.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else _!==null&&e.gripSpace&&(c=n.getPose(e.gripSpace,s),c!==null&&(_.matrix.fromArray(c.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),c.linearVelocity?(_.hasLinearVelocity=!0,_.linearVelocity.copy(c.linearVelocity)):_.hasLinearVelocity=!1,c.angularVelocity?(_.hasAngularVelocity=!0,_.angularVelocity.copy(c.angularVelocity)):_.hasAngularVelocity=!1));g!==null&&(a=n.getPose(e.targetRaySpace,s),a===null&&c!==null&&(a=c),a!==null&&(g.matrix.fromArray(a.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),a.linearVelocity?(g.hasLinearVelocity=!0,g.linearVelocity.copy(a.linearVelocity)):g.hasLinearVelocity=!1,a.angularVelocity?(g.hasAngularVelocity=!0,g.angularVelocity.copy(a.angularVelocity)):g.hasAngularVelocity=!1,this.dispatchEvent(zD)))}return g!==null&&(g.visible=a!==null),_!==null&&(_.visible=c!==null),w!==null&&(w.visible=m!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const s=new ad;s.matrixAutoUpdate=!1,s.visible=!1,e.joints[n.jointName]=s,e.add(s)}return e.joints[n.jointName]}}class rA extends ri{constructor(e,n,s,a,c,m,g,_,w,A){if(A=A!==void 0?A:Kn,A!==Kn&&A!==ki)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");s===void 0&&A===Kn&&(s=Ws),s===void 0&&A===ki&&(s=Vo),super(null,a,c,m,g,_,A,s,w),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=g!==void 0?g:Ti,this.minFilter=_!==void 0?_:Ti,this.flipY=!1,this.generateMipmaps=!1}}class GD extends Ko{constructor(e,n){super();const s=this;let a=null,c=1,m=null,g="local-floor",_=1,w=null,A=null,C=null,M=null,R=null,F=null;const D=n.getContextAttributes();let O=null,W=null;const K=[],V=[],Y=new Set,se=new Map,ue=new Mr;ue.layers.enable(1),ue.viewport=new Zn;const me=new Mr;me.layers.enable(2),me.viewport=new Zn;const J=[ue,me],ae=new iA;ae.layers.enable(1),ae.layers.enable(2);let xe=null,We=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Fe){let ft=K[Fe];return ft===void 0&&(ft=new Ty,K[Fe]=ft),ft.getTargetRaySpace()},this.getControllerGrip=function(Fe){let ft=K[Fe];return ft===void 0&&(ft=new Ty,K[Fe]=ft),ft.getGripSpace()},this.getHand=function(Fe){let ft=K[Fe];return ft===void 0&&(ft=new Ty,K[Fe]=ft),ft.getHandSpace()};function Je(Fe){const ft=V.indexOf(Fe.inputSource);if(ft===-1)return;const Dt=K[ft];Dt!==void 0&&Dt.dispatchEvent({type:Fe.type,data:Fe.inputSource})}function Le(){a.removeEventListener("select",Je),a.removeEventListener("selectstart",Je),a.removeEventListener("selectend",Je),a.removeEventListener("squeeze",Je),a.removeEventListener("squeezestart",Je),a.removeEventListener("squeezeend",Je),a.removeEventListener("end",Le),a.removeEventListener("inputsourceschange",Me);for(let Fe=0;Fe<K.length;Fe++){const ft=V[Fe];ft!==null&&(V[Fe]=null,K[Fe].disconnect(ft))}xe=null,We=null,e.setRenderTarget(O),R=null,M=null,C=null,a=null,W=null,$t.stop(),s.isPresenting=!1,s.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Fe){c=Fe,s.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Fe){g=Fe,s.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return w||m},this.setReferenceSpace=function(Fe){w=Fe},this.getBaseLayer=function(){return M!==null?M:R},this.getBinding=function(){return C},this.getFrame=function(){return F},this.getSession=function(){return a},this.setSession=async function(Fe){if(a=Fe,a!==null){if(O=e.getRenderTarget(),a.addEventListener("select",Je),a.addEventListener("selectstart",Je),a.addEventListener("selectend",Je),a.addEventListener("squeeze",Je),a.addEventListener("squeezestart",Je),a.addEventListener("squeezeend",Je),a.addEventListener("end",Le),a.addEventListener("inputsourceschange",Me),D.xrCompatible!==!0&&await n.makeXRCompatible(),a.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ft={antialias:a.renderState.layers===void 0?D.antialias:!0,alpha:D.alpha,depth:D.depth,stencil:D.stencil,framebufferScaleFactor:c};R=new XRWebGLLayer(a,n,ft),a.updateRenderState({baseLayer:R}),W=new Ls(R.framebufferWidth,R.framebufferHeight,{format:Hr,type:ts,encoding:e.outputEncoding,stencilBuffer:D.stencil})}else{let ft=null,Dt=null,_e=null;D.depth&&(_e=D.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,ft=D.stencil?ki:Kn,Dt=D.stencil?Vo:Ws);const qt={colorFormat:n.RGBA8,depthFormat:_e,scaleFactor:c};C=new XRWebGLBinding(a,n),M=C.createProjectionLayer(qt),a.updateRenderState({layers:[M]}),W=new Ls(M.textureWidth,M.textureHeight,{format:Hr,type:ts,depthTexture:new rA(M.textureWidth,M.textureHeight,Dt,void 0,void 0,void 0,void 0,void 0,void 0,ft),stencilBuffer:D.stencil,encoding:e.outputEncoding,samples:D.antialias?4:0});const Bt=e.properties.get(W);Bt.__ignoreDepthValues=M.ignoreDepthValues}W.isXRRenderTarget=!0,this.setFoveation(_),w=null,m=await a.requestReferenceSpace(g),$t.setContext(a),$t.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}};function Me(Fe){for(let ft=0;ft<Fe.removed.length;ft++){const Dt=Fe.removed[ft],_e=V.indexOf(Dt);_e>=0&&(V[_e]=null,K[_e].disconnect(Dt))}for(let ft=0;ft<Fe.added.length;ft++){const Dt=Fe.added[ft];let _e=V.indexOf(Dt);if(_e===-1){for(let Bt=0;Bt<K.length;Bt++)if(Bt>=V.length){V.push(Dt),_e=Bt;break}else if(V[Bt]===null){V[Bt]=Dt,_e=Bt;break}if(_e===-1)break}const qt=K[_e];qt&&qt.connect(Dt)}}const Ke=new le,rt=new le;function yt(Fe,ft,Dt){Ke.setFromMatrixPosition(ft.matrixWorld),rt.setFromMatrixPosition(Dt.matrixWorld);const _e=Ke.distanceTo(rt),qt=ft.projectionMatrix.elements,Bt=Dt.projectionMatrix.elements,Kt=qt[14]/(qt[10]-1),en=qt[14]/(qt[10]+1),sn=(qt[9]+1)/qt[5],xn=(qt[9]-1)/qt[5],tt=(qt[8]-1)/qt[0],ct=(Bt[8]+1)/Bt[0],Tt=Kt*tt,an=Kt*ct,It=_e/(-tt+ct),bn=It*-tt;ft.matrixWorld.decompose(Fe.position,Fe.quaternion,Fe.scale),Fe.translateX(bn),Fe.translateZ(It),Fe.matrixWorld.compose(Fe.position,Fe.quaternion,Fe.scale),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert();const hn=Kt+It,wn=en+It,Si=Tt-bn,hi=an+(_e-bn),de=sn*en/wn*hn,ne=xn*en/wn*hn;Fe.projectionMatrix.makePerspective(Si,hi,de,ne,hn,wn)}function et(Fe,ft){ft===null?Fe.matrixWorld.copy(Fe.matrix):Fe.matrixWorld.multiplyMatrices(ft.matrixWorld,Fe.matrix),Fe.matrixWorldInverse.copy(Fe.matrixWorld).invert()}this.updateCamera=function(Fe){if(a===null)return;ae.near=me.near=ue.near=Fe.near,ae.far=me.far=ue.far=Fe.far,(xe!==ae.near||We!==ae.far)&&(a.updateRenderState({depthNear:ae.near,depthFar:ae.far}),xe=ae.near,We=ae.far);const ft=Fe.parent,Dt=ae.cameras;et(ae,ft);for(let qt=0;qt<Dt.length;qt++)et(Dt[qt],ft);ae.matrixWorld.decompose(ae.position,ae.quaternion,ae.scale),Fe.matrix.copy(ae.matrix),Fe.matrix.decompose(Fe.position,Fe.quaternion,Fe.scale);const _e=Fe.children;for(let qt=0,Bt=_e.length;qt<Bt;qt++)_e[qt].updateMatrixWorld(!0);Dt.length===2?yt(ae,ue,me):ae.projectionMatrix.copy(ue.projectionMatrix)},this.getCamera=function(){return ae},this.getFoveation=function(){if(!(M===null&&R===null))return _},this.setFoveation=function(Fe){_=Fe,M!==null&&(M.fixedFoveation=Fe),R!==null&&R.fixedFoveation!==void 0&&(R.fixedFoveation=Fe)},this.getPlanes=function(){return Y};let _t=null;function ut(Fe,ft){if(A=ft.getViewerPose(w||m),F=ft,A!==null){const Dt=A.views;R!==null&&(e.setRenderTargetFramebuffer(W,R.framebuffer),e.setRenderTarget(W));let _e=!1;Dt.length!==ae.cameras.length&&(ae.cameras.length=0,_e=!0);for(let qt=0;qt<Dt.length;qt++){const Bt=Dt[qt];let Kt=null;if(R!==null)Kt=R.getViewport(Bt);else{const sn=C.getViewSubImage(M,Bt);Kt=sn.viewport,qt===0&&(e.setRenderTargetTextures(W,sn.colorTexture,M.ignoreDepthValues?void 0:sn.depthStencilTexture),e.setRenderTarget(W))}let en=J[qt];en===void 0&&(en=new Mr,en.layers.enable(qt),en.viewport=new Zn,J[qt]=en),en.matrix.fromArray(Bt.transform.matrix),en.projectionMatrix.fromArray(Bt.projectionMatrix),en.viewport.set(Kt.x,Kt.y,Kt.width,Kt.height),qt===0&&ae.matrix.copy(en.matrix),_e===!0&&ae.cameras.push(en)}}for(let Dt=0;Dt<K.length;Dt++){const _e=V[Dt],qt=K[Dt];_e!==null&&qt!==void 0&&qt.update(_e,ft,w||m)}if(_t&&_t(Fe,ft),ft.detectedPlanes){s.dispatchEvent({type:"planesdetected",data:ft.detectedPlanes});let Dt=null;for(const _e of Y)ft.detectedPlanes.has(_e)||(Dt===null&&(Dt=[]),Dt.push(_e));if(Dt!==null)for(const _e of Dt)Y.delete(_e),se.delete(_e),s.dispatchEvent({type:"planeremoved",data:_e});for(const _e of ft.detectedPlanes)if(!Y.has(_e))Y.add(_e),se.set(_e,ft.lastChangedTime),s.dispatchEvent({type:"planeadded",data:_e});else{const qt=se.get(_e);_e.lastChangedTime>qt&&(se.set(_e,_e.lastChangedTime),s.dispatchEvent({type:"planechanged",data:_e}))}}F=null}const $t=new Xm;$t.setAnimationLoop(ut),this.setAnimationLoop=function(Fe){_t=Fe},this.dispose=function(){}}}function HD(u,e){function n(D,O){O.color.getRGB(D.fogColor.value,vc(u)),O.isFog?(D.fogNear.value=O.near,D.fogFar.value=O.far):O.isFogExp2&&(D.fogDensity.value=O.density)}function s(D,O,W,K,V){O.isMeshBasicMaterial||O.isMeshLambertMaterial?a(D,O):O.isMeshToonMaterial?(a(D,O),A(D,O)):O.isMeshPhongMaterial?(a(D,O),w(D,O)):O.isMeshStandardMaterial?(a(D,O),C(D,O),O.isMeshPhysicalMaterial&&M(D,O,V)):O.isMeshMatcapMaterial?(a(D,O),R(D,O)):O.isMeshDepthMaterial?a(D,O):O.isMeshDistanceMaterial?(a(D,O),F(D,O)):O.isMeshNormalMaterial?a(D,O):O.isLineBasicMaterial?(c(D,O),O.isLineDashedMaterial&&m(D,O)):O.isPointsMaterial?g(D,O,W,K):O.isSpriteMaterial?_(D,O):O.isShadowMaterial?(D.color.value.copy(O.color),D.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}function a(D,O){D.opacity.value=O.opacity,O.color&&D.diffuse.value.copy(O.color),O.emissive&&D.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(D.map.value=O.map),O.alphaMap&&(D.alphaMap.value=O.alphaMap),O.bumpMap&&(D.bumpMap.value=O.bumpMap,D.bumpScale.value=O.bumpScale,O.side===ce&&(D.bumpScale.value*=-1)),O.displacementMap&&(D.displacementMap.value=O.displacementMap,D.displacementScale.value=O.displacementScale,D.displacementBias.value=O.displacementBias),O.emissiveMap&&(D.emissiveMap.value=O.emissiveMap),O.normalMap&&(D.normalMap.value=O.normalMap,D.normalScale.value.copy(O.normalScale),O.side===ce&&D.normalScale.value.negate()),O.specularMap&&(D.specularMap.value=O.specularMap),O.alphaTest>0&&(D.alphaTest.value=O.alphaTest);const W=e.get(O).envMap;if(W&&(D.envMap.value=W,D.flipEnvMap.value=W.isCubeTexture&&W.isRenderTargetTexture===!1?-1:1,D.reflectivity.value=O.reflectivity,D.ior.value=O.ior,D.refractionRatio.value=O.refractionRatio),O.lightMap){D.lightMap.value=O.lightMap;const Y=u.useLegacyLights===!0?Math.PI:1;D.lightMapIntensity.value=O.lightMapIntensity*Y}O.aoMap&&(D.aoMap.value=O.aoMap,D.aoMapIntensity.value=O.aoMapIntensity);let K;O.map?K=O.map:O.specularMap?K=O.specularMap:O.displacementMap?K=O.displacementMap:O.normalMap?K=O.normalMap:O.bumpMap?K=O.bumpMap:O.roughnessMap?K=O.roughnessMap:O.metalnessMap?K=O.metalnessMap:O.alphaMap?K=O.alphaMap:O.emissiveMap?K=O.emissiveMap:O.clearcoatMap?K=O.clearcoatMap:O.clearcoatNormalMap?K=O.clearcoatNormalMap:O.clearcoatRoughnessMap?K=O.clearcoatRoughnessMap:O.iridescenceMap?K=O.iridescenceMap:O.iridescenceThicknessMap?K=O.iridescenceThicknessMap:O.specularIntensityMap?K=O.specularIntensityMap:O.specularColorMap?K=O.specularColorMap:O.transmissionMap?K=O.transmissionMap:O.thicknessMap?K=O.thicknessMap:O.sheenColorMap?K=O.sheenColorMap:O.sheenRoughnessMap&&(K=O.sheenRoughnessMap),K!==void 0&&(K.isWebGLRenderTarget&&(K=K.texture),K.matrixAutoUpdate===!0&&K.updateMatrix(),D.uvTransform.value.copy(K.matrix));let V;O.aoMap?V=O.aoMap:O.lightMap&&(V=O.lightMap),V!==void 0&&(V.isWebGLRenderTarget&&(V=V.texture),V.matrixAutoUpdate===!0&&V.updateMatrix(),D.uv2Transform.value.copy(V.matrix))}function c(D,O){D.diffuse.value.copy(O.color),D.opacity.value=O.opacity}function m(D,O){D.dashSize.value=O.dashSize,D.totalSize.value=O.dashSize+O.gapSize,D.scale.value=O.scale}function g(D,O,W,K){D.diffuse.value.copy(O.color),D.opacity.value=O.opacity,D.size.value=O.size*W,D.scale.value=K*.5,O.map&&(D.map.value=O.map),O.alphaMap&&(D.alphaMap.value=O.alphaMap),O.alphaTest>0&&(D.alphaTest.value=O.alphaTest);let V;O.map?V=O.map:O.alphaMap&&(V=O.alphaMap),V!==void 0&&(V.matrixAutoUpdate===!0&&V.updateMatrix(),D.uvTransform.value.copy(V.matrix))}function _(D,O){D.diffuse.value.copy(O.color),D.opacity.value=O.opacity,D.rotation.value=O.rotation,O.map&&(D.map.value=O.map),O.alphaMap&&(D.alphaMap.value=O.alphaMap),O.alphaTest>0&&(D.alphaTest.value=O.alphaTest);let W;O.map?W=O.map:O.alphaMap&&(W=O.alphaMap),W!==void 0&&(W.matrixAutoUpdate===!0&&W.updateMatrix(),D.uvTransform.value.copy(W.matrix))}function w(D,O){D.specular.value.copy(O.specular),D.shininess.value=Math.max(O.shininess,1e-4)}function A(D,O){O.gradientMap&&(D.gradientMap.value=O.gradientMap)}function C(D,O){D.roughness.value=O.roughness,D.metalness.value=O.metalness,O.roughnessMap&&(D.roughnessMap.value=O.roughnessMap),O.metalnessMap&&(D.metalnessMap.value=O.metalnessMap),e.get(O).envMap&&(D.envMapIntensity.value=O.envMapIntensity)}function M(D,O,W){D.ior.value=O.ior,O.sheen>0&&(D.sheenColor.value.copy(O.sheenColor).multiplyScalar(O.sheen),D.sheenRoughness.value=O.sheenRoughness,O.sheenColorMap&&(D.sheenColorMap.value=O.sheenColorMap),O.sheenRoughnessMap&&(D.sheenRoughnessMap.value=O.sheenRoughnessMap)),O.clearcoat>0&&(D.clearcoat.value=O.clearcoat,D.clearcoatRoughness.value=O.clearcoatRoughness,O.clearcoatMap&&(D.clearcoatMap.value=O.clearcoatMap),O.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap),O.clearcoatNormalMap&&(D.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),D.clearcoatNormalMap.value=O.clearcoatNormalMap,O.side===ce&&D.clearcoatNormalScale.value.negate())),O.iridescence>0&&(D.iridescence.value=O.iridescence,D.iridescenceIOR.value=O.iridescenceIOR,D.iridescenceThicknessMinimum.value=O.iridescenceThicknessRange[0],D.iridescenceThicknessMaximum.value=O.iridescenceThicknessRange[1],O.iridescenceMap&&(D.iridescenceMap.value=O.iridescenceMap),O.iridescenceThicknessMap&&(D.iridescenceThicknessMap.value=O.iridescenceThicknessMap)),O.transmission>0&&(D.transmission.value=O.transmission,D.transmissionSamplerMap.value=W.texture,D.transmissionSamplerSize.value.set(W.width,W.height),O.transmissionMap&&(D.transmissionMap.value=O.transmissionMap),D.thickness.value=O.thickness,O.thicknessMap&&(D.thicknessMap.value=O.thicknessMap),D.attenuationDistance.value=O.attenuationDistance,D.attenuationColor.value.copy(O.attenuationColor)),D.specularIntensity.value=O.specularIntensity,D.specularColor.value.copy(O.specularColor),O.specularIntensityMap&&(D.specularIntensityMap.value=O.specularIntensityMap),O.specularColorMap&&(D.specularColorMap.value=O.specularColorMap)}function R(D,O){O.matcap&&(D.matcap.value=O.matcap)}function F(D,O){D.referencePosition.value.copy(O.referencePosition),D.nearDistance.value=O.nearDistance,D.farDistance.value=O.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function VD(u,e,n,s){let a={},c={},m=[];const g=n.isWebGL2?u.getParameter(u.MAX_UNIFORM_BUFFER_BINDINGS):0;function _(K,V){const Y=V.program;s.uniformBlockBinding(K,Y)}function w(K,V){let Y=a[K.id];Y===void 0&&(F(K),Y=A(K),a[K.id]=Y,K.addEventListener("dispose",O));const se=V.program;s.updateUBOMapping(K,se);const ue=e.render.frame;c[K.id]!==ue&&(M(K),c[K.id]=ue)}function A(K){const V=C();K.__bindingPointIndex=V;const Y=u.createBuffer(),se=K.__size,ue=K.usage;return u.bindBuffer(u.UNIFORM_BUFFER,Y),u.bufferData(u.UNIFORM_BUFFER,se,ue),u.bindBuffer(u.UNIFORM_BUFFER,null),u.bindBufferBase(u.UNIFORM_BUFFER,V,Y),Y}function C(){for(let K=0;K<g;K++)if(m.indexOf(K)===-1)return m.push(K),K;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function M(K){const V=a[K.id],Y=K.uniforms,se=K.__cache;u.bindBuffer(u.UNIFORM_BUFFER,V);for(let ue=0,me=Y.length;ue<me;ue++){const J=Y[ue];if(R(J,ue,se)===!0){const ae=J.__offset,xe=Array.isArray(J.value)?J.value:[J.value];let We=0;for(let Je=0;Je<xe.length;Je++){const Le=xe[Je],Me=D(Le);typeof Le=="number"?(J.__data[0]=Le,u.bufferSubData(u.UNIFORM_BUFFER,ae+We,J.__data)):Le.isMatrix3?(J.__data[0]=Le.elements[0],J.__data[1]=Le.elements[1],J.__data[2]=Le.elements[2],J.__data[3]=Le.elements[0],J.__data[4]=Le.elements[3],J.__data[5]=Le.elements[4],J.__data[6]=Le.elements[5],J.__data[7]=Le.elements[0],J.__data[8]=Le.elements[6],J.__data[9]=Le.elements[7],J.__data[10]=Le.elements[8],J.__data[11]=Le.elements[0]):(Le.toArray(J.__data,We),We+=Me.storage/Float32Array.BYTES_PER_ELEMENT)}u.bufferSubData(u.UNIFORM_BUFFER,ae,J.__data)}}u.bindBuffer(u.UNIFORM_BUFFER,null)}function R(K,V,Y){const se=K.value;if(Y[V]===void 0){if(typeof se=="number")Y[V]=se;else{const ue=Array.isArray(se)?se:[se],me=[];for(let J=0;J<ue.length;J++)me.push(ue[J].clone());Y[V]=me}return!0}else if(typeof se=="number"){if(Y[V]!==se)return Y[V]=se,!0}else{const ue=Array.isArray(Y[V])?Y[V]:[Y[V]],me=Array.isArray(se)?se:[se];for(let J=0;J<ue.length;J++){const ae=ue[J];if(ae.equals(me[J])===!1)return ae.copy(me[J]),!0}}return!1}function F(K){const V=K.uniforms;let Y=0;const se=16;let ue=0;for(let me=0,J=V.length;me<J;me++){const ae=V[me],xe={boundary:0,storage:0},We=Array.isArray(ae.value)?ae.value:[ae.value];for(let Je=0,Le=We.length;Je<Le;Je++){const Me=We[Je],Ke=D(Me);xe.boundary+=Ke.boundary,xe.storage+=Ke.storage}if(ae.__data=new Float32Array(xe.storage/Float32Array.BYTES_PER_ELEMENT),ae.__offset=Y,me>0){ue=Y%se;const Je=se-ue;ue!==0&&Je-xe.boundary<0&&(Y+=se-ue,ae.__offset=Y)}Y+=xe.storage}return ue=Y%se,ue>0&&(Y+=se-ue),K.__size=Y,K.__cache={},this}function D(K){const V={boundary:0,storage:0};return typeof K=="number"?(V.boundary=4,V.storage=4):K.isVector2?(V.boundary=8,V.storage=8):K.isVector3||K.isColor?(V.boundary=16,V.storage=12):K.isVector4?(V.boundary=16,V.storage=16):K.isMatrix3?(V.boundary=48,V.storage=48):K.isMatrix4?(V.boundary=64,V.storage=64):K.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",K),V}function O(K){const V=K.target;V.removeEventListener("dispose",O);const Y=m.indexOf(V.__bindingPointIndex);m.splice(Y,1),u.deleteBuffer(a[V.id]),delete a[V.id],delete c[V.id]}function W(){for(const K in a)u.deleteBuffer(a[K]);m=[],a={},c={}}return{bind:_,update:w,dispose:W}}function WD(){const u=wu("canvas");return u.style.display="block",u}function Cy(u={}){this.isWebGLRenderer=!0;const e=u.canvas!==void 0?u.canvas:WD(),n=u.context!==void 0?u.context:null,s=u.depth!==void 0?u.depth:!0,a=u.stencil!==void 0?u.stencil:!0,c=u.antialias!==void 0?u.antialias:!1,m=u.premultipliedAlpha!==void 0?u.premultipliedAlpha:!0,g=u.preserveDrawingBuffer!==void 0?u.preserveDrawingBuffer:!1,_=u.powerPreference!==void 0?u.powerPreference:"default",w=u.failIfMajorPerformanceCaveat!==void 0?u.failIfMajorPerformanceCaveat:!1;let A;n!==null?A=n.getContextAttributes().alpha:A=u.alpha!==void 0?u.alpha:!1;let C=null,M=null;const R=[],F=[];this.globalUniforms={},this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ea,this.useLegacyLights=!0,this.toneMapping=Gr,this.toneMappingExposure=1;const D=this;let O=!1,W=0,K=0,V=null,Y=-1,se=null;const ue=new Zn,me=new Zn;let J=null,ae=e.width,xe=e.height,We=1,Je=null,Le=null;const Me=new Zn(0,0,ae,xe),Ke=new Zn(0,0,ae,xe);let rt=!1;const yt=new td;let et=!1,_t=!1,ut=null;const $t=new Mn,Fe=new le,ft={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Dt(){return V===null?We:1}let _e=n;function qt(oe,Pe){for(let Ve=0;Ve<oe.length;Ve++){const Ue=oe[Ve],Qe=e.getContext(Ue,Pe);if(Qe!==null)return Qe}return null}try{const oe={alpha:!0,depth:s,stencil:a,antialias:c,premultipliedAlpha:m,preserveDrawingBuffer:g,powerPreference:_,failIfMajorPerformanceCaveat:w};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${y}`),e.addEventListener("webglcontextlost",An,!1),e.addEventListener("webglcontextrestored",gn,!1),e.addEventListener("webglcontextcreationerror",dn,!1),_e===null){const Pe=["webgl2","webgl","experimental-webgl"];if(D.isWebGL1Renderer===!0&&Pe.shift(),_e=qt(Pe,oe),_e===null)throw qt(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}_e.getShaderPrecisionFormat===void 0&&(_e.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(oe){throw console.error("THREE.WebGLRenderer: "+oe.message),oe}let Bt,Kt,en,sn,xn,tt,ct,Tt,an,It,bn,hn,wn,Si,hi,de,ne,je,At,Mt,kt,cn,Vt,nt;function pn(){Bt=new Nn(_e),Kt=new j(_e,Bt,u),Bt.init(Kt),cn=new nA(_e,Bt,Kt),en=new UD(_e,Bt,Kt),sn=new dr(_e),xn=new ED,tt=new ND(_e,Bt,en,xn,Kt,cn,sn),ct=new pe(D),Tt=new xi(D),an=new ny(_e,Kt),Vt=new $m(_e,Bt,an,Kt),It=new rr(_e,an,sn,Vt),bn=new Fu(_e,It,an,sn),At=new la(_e,Kt,tt),de=new te(xn),hn=new MD(D,ct,Tt,Bt,Kt,Vt,de),wn=new HD(D,xn),Si=new CD,hi=new OD(Bt,Kt),je=new Bn(D,ct,Tt,en,bn,A,m),ne=new kD(D,bn,Kt),nt=new VD(_e,sn,Kt,en),Mt=new wy(_e,Bt,sn,Kt),kt=new Bs(_e,Bt,sn,Kt),sn.programs=hn.programs,D.capabilities=Kt,D.extensions=Bt,D.properties=xn,D.renderLists=Si,D.shadowMap=ne,D.state=en,D.info=sn}pn();const rn=new GD(D,_e);this.xr=rn,this.getContext=function(){return _e},this.getContextAttributes=function(){return _e.getContextAttributes()},this.forceContextLoss=function(){const oe=Bt.get("WEBGL_lose_context");oe&&oe.loseContext()},this.forceContextRestore=function(){const oe=Bt.get("WEBGL_lose_context");oe&&oe.restoreContext()},this.getPixelRatio=function(){return We},this.setPixelRatio=function(oe){oe!==void 0&&(We=oe,this.setSize(ae,xe,!1))},this.getSize=function(oe){return oe.set(ae,xe)},this.setSize=function(oe,Pe,Ve=!0){if(rn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ae=oe,xe=Pe,e.width=Math.floor(oe*We),e.height=Math.floor(Pe*We),Ve===!0&&(e.style.width=oe+"px",e.style.height=Pe+"px"),this.setViewport(0,0,oe,Pe)},this.getDrawingBufferSize=function(oe){return oe.set(ae*We,xe*We).floor()},this.setDrawingBufferSize=function(oe,Pe,Ve){ae=oe,xe=Pe,We=Ve,e.width=Math.floor(oe*Ve),e.height=Math.floor(Pe*Ve),this.setViewport(0,0,oe,Pe)},this.getCurrentViewport=function(oe){return oe.copy(ue)},this.getViewport=function(oe){return oe.copy(Me)},this.setViewport=function(oe,Pe,Ve,Ue){oe.isVector4?Me.set(oe.x,oe.y,oe.z,oe.w):Me.set(oe,Pe,Ve,Ue),en.viewport(ue.copy(Me).multiplyScalar(We).floor())},this.getScissor=function(oe){return oe.copy(Ke)},this.setScissor=function(oe,Pe,Ve,Ue){oe.isVector4?Ke.set(oe.x,oe.y,oe.z,oe.w):Ke.set(oe,Pe,Ve,Ue),en.scissor(me.copy(Ke).multiplyScalar(We).floor())},this.getScissorTest=function(){return rt},this.setScissorTest=function(oe){en.setScissorTest(rt=oe)},this.setOpaqueSort=function(oe){Je=oe},this.setTransparentSort=function(oe){Le=oe},this.getClearColor=function(oe){return oe.copy(je.getClearColor())},this.setClearColor=function(){je.setClearColor.apply(je,arguments)},this.getClearAlpha=function(){return je.getClearAlpha()},this.setClearAlpha=function(){je.setClearAlpha.apply(je,arguments)},this.clear=function(oe=!0,Pe=!0,Ve=!0){let Ue=0;oe&&(Ue|=_e.COLOR_BUFFER_BIT),Pe&&(Ue|=_e.DEPTH_BUFFER_BIT),Ve&&(Ue|=_e.STENCIL_BUFFER_BIT),_e.clear(Ue)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",An,!1),e.removeEventListener("webglcontextrestored",gn,!1),e.removeEventListener("webglcontextcreationerror",dn,!1),Si.dispose(),hi.dispose(),xn.dispose(),ct.dispose(),Tt.dispose(),bn.dispose(),Vt.dispose(),nt.dispose(),hn.dispose(),rn.dispose(),rn.removeEventListener("sessionstart",Wt),rn.removeEventListener("sessionend",ln),ut&&(ut.dispose(),ut=null),si.stop()};function An(oe){oe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function gn(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1;const oe=sn.autoReset,Pe=ne.enabled,Ve=ne.autoUpdate,Ue=ne.needsUpdate,Qe=ne.type;pn(),sn.autoReset=oe,ne.enabled=Pe,ne.autoUpdate=Ve,ne.needsUpdate=Ue,ne.type=Qe}function dn(oe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",oe.statusMessage)}function ei(oe){const Pe=oe.target;Pe.removeEventListener("dispose",ei),Vi(Pe)}function Vi(oe){Or(oe),xn.remove(oe)}function Or(oe){const Pe=xn.get(oe).programs;Pe!==void 0&&(Pe.forEach(function(Ve){hn.releaseProgram(Ve)}),oe.isShaderMaterial&&hn.releaseShaderCache(oe))}this.renderBufferDirect=function(oe,Pe,Ve,Ue,Qe,fn){Pe===null&&(Pe=ft);const vn=Qe.isMesh&&Qe.matrixWorld.determinant()<0,Ln=iO(oe,Pe,Ve,Ue,Qe);en.setMaterial(Ue,vn);let kn=Ve.index,ti=1;Ue.wireframe===!0&&(kn=It.getWireframeAttribute(Ve),ti=2);const Hn=Ve.drawRange,Vn=Ve.attributes.position;let fr=Hn.start*ti,oo=(Hn.start+Hn.count)*ti;fn!==null&&(fr=Math.max(fr,fn.start*ti),oo=Math.min(oo,(fn.start+fn.count)*ti)),kn!==null?(fr=Math.max(fr,0),oo=Math.min(oo,kn.count)):Vn!=null&&(fr=Math.max(fr,0),oo=Math.min(oo,Vn.count));const Cl=oo-fr;if(Cl<0||Cl===1/0)return;Vt.setup(Qe,Ue,Ln,Ve,kn);let qu,pr=Mt;if(kn!==null&&(qu=an.get(kn),pr=kt,pr.setIndex(qu)),Qe.isMesh)Ue.wireframe===!0?(en.setLineWidth(Ue.wireframeLinewidth*Dt()),pr.setMode(_e.LINES)):pr.setMode(_e.TRIANGLES);else if(Qe.isLine){let Wn=Ue.linewidth;Wn===void 0&&(Wn=1),en.setLineWidth(Wn*Dt()),Qe.isLineSegments?pr.setMode(_e.LINES):Qe.isLineLoop?pr.setMode(_e.LINE_LOOP):pr.setMode(_e.LINE_STRIP)}else Qe.isPoints?pr.setMode(_e.POINTS):Qe.isSprite&&pr.setMode(_e.TRIANGLES);if(Qe.isInstancedMesh)pr.renderInstances(fr,Cl,Qe.count);else if(Ve.isInstancedBufferGeometry){const Wn=Ve._maxInstanceCount!==void 0?Ve._maxInstanceCount:1/0,d_=Math.min(Ve.instanceCount,Wn);pr.renderInstances(fr,Cl,d_)}else pr.render(fr,Cl)};function we(oe,Pe,Ve){oe.transparent===!0&&oe.side===ie&&oe.forceSinglePass===!1?(oe.side=ce,oe.needsUpdate=!0,Lo(oe,Pe,Ve),oe.side=$e,oe.needsUpdate=!0,Lo(oe,Pe,Ve),oe.side=ie):Lo(oe,Pe,Ve)}this.compile=function(oe,Pe,Ve=null){Ve===null&&(Ve=oe),M=hi.get(Ve),M.init(),F.push(M),Ve.traverseVisible(function(Qe){Qe.isLight&&Qe.layers.test(Pe.layers)&&(M.pushLight(Qe),Qe.castShadow&&M.pushShadow(Qe))}),oe!==Ve&&oe.traverseVisible(function(Qe){Qe.isLight&&Qe.layers.test(Pe.layers)&&(M.pushLight(Qe),Qe.castShadow&&M.pushShadow(Qe))}),M.setupLights(D._useLegacyLights);const Ue=new Set;return oe.traverse(function(Qe){const fn=Qe.material;if(fn)if(Array.isArray(fn))for(let vn=0;vn<fn.length;vn++){const Ln=fn[vn];we(Ln,Ve,Qe),Ue.add(Ln)}else we(fn,Ve,Qe),Ue.add(fn)}),F.pop(),M=null,Ue};let qe=null;function gt(oe){qe&&qe(oe)}function Wt(){si.stop()}function ln(){si.start()}const si=new Xm;si.setAnimationLoop(gt),typeof self<"u"&&si.setContext(self),this.setAnimationLoop=function(oe){qe=oe,rn.setAnimationLoop(oe),oe===null?si.stop():si.start()},rn.addEventListener("sessionstart",Wt),rn.addEventListener("sessionend",ln),this.render=function(oe,Pe){if(Pe!==void 0&&Pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(O===!0)return;oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),rn.enabled===!0&&rn.isPresenting===!0&&(rn.cameraAutoUpdate===!0&&rn.updateCamera(Pe),Pe=rn.getCamera()),oe.isScene===!0&&oe.onBeforeRender(D,oe,Pe,V),M=hi.get(oe,F.length),M.init(),F.push(M),$t.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),yt.setFromProjectionMatrix($t),_t=this.localClippingEnabled,et=de.init(this.clippingPlanes,_t),C=Si.get(oe,R.length),C.init(),R.push(C),Fr(oe,Pe,0,D.sortObjects),C.finish(),D.sortObjects===!0&&C.sort(Je,Le),et===!0&&de.beginShadows();const Ve=M.state.shadowsArray;if(ne.render(Ve,oe,Pe),et===!0&&de.endShadows(),this.info.autoReset===!0&&this.info.reset(),je.render(C,oe),M.setupLights(D.useLegacyLights),Pe.isArrayCamera){const Ue=Pe.cameras;for(let Qe=0,fn=Ue.length;Qe<fn;Qe++){const vn=Ue[Qe];as(C,oe,vn,vn.viewport)}}else as(C,oe,Pe);V!==null&&(tt.updateMultisampleRenderTarget(V),tt.updateRenderTargetMipmap(V)),oe.isScene===!0&&oe.onAfterRender(D,oe,Pe),Vt.resetDefaultState(),Y=-1,se=null,F.pop(),F.length>0?M=F[F.length-1]:M=null,R.pop(),R.length>0?C=R[R.length-1]:C=null};function Fr(oe,Pe,Ve,Ue){if(oe.visible===!1)return;if(oe.layers.test(Pe.layers)){if(oe.isGroup)Ve=oe.renderOrder;else if(oe.isLOD)oe.autoUpdate===!0&&oe.update(Pe);else if(oe.isLight)M.pushLight(oe),oe.castShadow&&M.pushShadow(oe);else if(oe.isSprite){if(!oe.frustumCulled||yt.intersectsSprite(oe)){Ue&&Fe.setFromMatrixPosition(oe.matrixWorld).applyMatrix4($t);const vn=bn.update(oe),Ln=oe.material;Ln.visible&&C.push(oe,vn,Ln,Ve,Fe.z,null)}}else if((oe.isMesh||oe.isLine||oe.isPoints)&&(oe.isSkinnedMesh&&oe.skeleton.frame!==sn.render.frame&&(oe.skeleton.update(),oe.skeleton.frame=sn.render.frame),!oe.frustumCulled||yt.intersectsObject(oe))){Ue&&Fe.setFromMatrixPosition(oe.matrixWorld).applyMatrix4($t);const vn=bn.update(oe),Ln=oe.material;if(Array.isArray(Ln)){const kn=vn.groups;for(let ti=0,Hn=kn.length;ti<Hn;ti++){const Vn=kn[ti],fr=Ln[Vn.materialIndex];fr&&fr.visible&&C.push(oe,vn,fr,Ve,Fe.z,Vn)}}else Ln.visible&&C.push(oe,vn,Ln,Ve,Fe.z,null)}}const fn=oe.children;for(let vn=0,Ln=fn.length;vn<Ln;vn++)Fr(fn[vn],Pe,Ve,Ue)}function as(oe,Pe,Ve,Ue){const Qe=oe.opaque,fn=oe.transmissive,vn=oe.transparent;M.setupLightsView(Ve),et===!0&&de.setGlobalState(D.clippingPlanes,Ve),fn.length>0&&Ku(Qe,Pe,Ve),Ue&&en.viewport(ue.copy(Ue)),Qe.length>0&&zi(Qe,Pe,Ve),fn.length>0&&zi(fn,Pe,Ve),vn.length>0&&zi(vn,Pe,Ve),en.buffers.depth.setTest(!0),en.buffers.depth.setMask(!0),en.buffers.color.setMask(!0),en.setPolygonOffset(!1)}function Ku(oe,Pe,Ve){const Ue=Kt.isWebGL2;ut===null&&(ut=new Ls(1024,1024,{generateMipmaps:!0,type:Bt.has("EXT_color_buffer_half_float")?Aa:ts,minFilter:xo,samples:Ue&&c===!0?4:0}));const Qe=D.getRenderTarget();D.setRenderTarget(ut),D.clear();const fn=D.toneMapping;D.toneMapping=Gr,zi(oe,Pe,Ve),D.toneMapping=fn,tt.updateMultisampleRenderTarget(ut),tt.updateRenderTargetMipmap(ut),D.setRenderTarget(Qe)}function zi(oe,Pe,Ve){const Ue=Pe.isScene===!0?Pe.overrideMaterial:null;for(let Qe=0,fn=oe.length;Qe<fn;Qe++){const vn=oe[Qe],Ln=vn.object,kn=vn.geometry,ti=Ue===null?vn.material:Ue,Hn=vn.group;Ln.layers.test(Ve.layers)&&Tl(Ln,Pe,Ve,kn,ti,Hn)}}function Tl(oe,Pe,Ve,Ue,Qe,fn){oe.onBeforeRender(D,Pe,Ve,Ue,Qe,fn),oe.modelViewMatrix.multiplyMatrices(Ve.matrixWorldInverse,oe.matrixWorld),oe.normalMatrix.getNormalMatrix(oe.modelViewMatrix),Qe.onBeforeRender(D,Pe,Ve,Ue,oe,fn),Qe.transparent===!0&&Qe.side===ie&&Qe.forceSinglePass===!1?(Qe.side=ce,Qe.needsUpdate=!0,D.renderBufferDirect(Ve,Pe,Ue,Qe,oe,fn),Qe.side=$e,Qe.needsUpdate=!0,D.renderBufferDirect(Ve,Pe,Ue,Qe,oe,fn),Qe.side=ie):D.renderBufferDirect(Ve,Pe,Ue,Qe,oe,fn),oe.onAfterRender(D,Pe,Ve,Ue,Qe,fn)}function Lo(oe,Pe,Ve){Pe.isScene!==!0&&(Pe=ft);const Ue=xn.get(oe),Qe=M.state.lights,fn=M.state.shadowsArray,vn=Qe.state.version,Ln=hn.getParameters(oe,Qe.state,fn,Pe,Ve),kn=hn.getProgramCacheKey(Ln);let ti=Ue.programs;Ue.environment=oe.isMeshStandardMaterial?Pe.environment:null,Ue.fog=Pe.fog,Ue.envMap=(oe.isMeshStandardMaterial?Tt:ct).get(oe.envMap||Ue.environment),ti===void 0&&(oe.addEventListener("dispose",ei),ti=new Map,Ue.programs=ti);let Hn=ti.get(kn);if(Hn!==void 0){if(Ue.currentProgram===Hn&&Ue.lightsStateVersion===vn)return US(oe,Ln),Hn}else Ln.uniforms=hn.getUniforms(oe),oe.onBuild(Ve,Ln,D),oe.onBeforeCompile(Ln,D),Hn=hn.acquireProgram(Ln,kn),ti.set(kn,Hn),Ue.uniforms=Ln.uniforms;const Vn=Ue.uniforms;(!oe.isShaderMaterial&&!oe.isRawShaderMaterial||oe.clipping===!0)&&(Vn.clippingPlanes=de.uniform),US(oe,Ln),Ue.needsLights=sO(oe),Ue.lightsStateVersion=vn,Ue.needsLights&&(Vn.ambientLightColor.value=Qe.state.ambient,Vn.lightProbe.value=Qe.state.probe,Vn.directionalLights.value=Qe.state.directional,Vn.directionalLightShadows.value=Qe.state.directionalShadow,Vn.spotLights.value=Qe.state.spot,Vn.spotLightShadows.value=Qe.state.spotShadow,Vn.rectAreaLights.value=Qe.state.rectArea,Vn.ltc_1.value=Qe.state.rectAreaLTC1,Vn.ltc_2.value=Qe.state.rectAreaLTC2,Vn.pointLights.value=Qe.state.point,Vn.pointLightShadows.value=Qe.state.pointShadow,Vn.hemisphereLights.value=Qe.state.hemi,Vn.directionalShadowMap.value=Qe.state.directionalShadowMap,Vn.directionalShadowMatrix.value=Qe.state.directionalShadowMatrix,Vn.spotShadowMap.value=Qe.state.spotShadowMap,Vn.spotLightMatrix.value=Qe.state.spotLightMatrix,Vn.spotLightMap.value=Qe.state.spotLightMap,Vn.pointShadowMap.value=Qe.state.pointShadowMap,Vn.pointShadowMatrix.value=Qe.state.pointShadowMatrix);const fr=Hn.getUniforms(),oo=tg.seqWithValue(fr.seq,Vn);return Ue.currentProgram=Hn,Ue.uniformsList=oo,Hn}function US(oe,Pe){const Ve=xn.get(oe);Ve.outputEncoding=Pe.outputEncoding,Ve.instancing=Pe.instancing,Ve.skinning=Pe.skinning,Ve.morphTargets=Pe.morphTargets,Ve.morphNormals=Pe.morphNormals,Ve.morphColors=Pe.morphColors,Ve.morphTargetsCount=Pe.morphTargetsCount,Ve.numClippingPlanes=Pe.numClippingPlanes,Ve.numIntersection=Pe.numClipIntersection,Ve.vertexAlphas=Pe.vertexAlphas,Ve.vertexTangents=Pe.vertexTangents,Ve.toneMapping=Pe.toneMapping}function iO(oe,Pe,Ve,Ue,Qe){Pe.isScene!==!0&&(Pe=ft),tt.resetTextureUnits();const fn=Pe.fog,vn=Ue.isMeshStandardMaterial?Pe.environment:null,Ln=V===null?D.outputEncoding:V.isXRRenderTarget===!0?V.texture.encoding:Ea,kn=(Ue.isMeshStandardMaterial?Tt:ct).get(Ue.envMap||vn),ti=Ue.vertexColors===!0&&!!Ve.attributes.color&&Ve.attributes.color.itemSize===4,Hn=!!Ue.normalMap&&!!Ve.attributes.tangent,Vn=!!Ve.morphAttributes.position,fr=!!Ve.morphAttributes.normal,oo=!!Ve.morphAttributes.color,Cl=Ue.toneMapped?D.toneMapping:Gr,qu=Ve.morphAttributes.position||Ve.morphAttributes.normal||Ve.morphAttributes.color,pr=qu!==void 0?qu.length:0,Wn=xn.get(Ue),d_=M.state.lights;if(et===!0&&(_t===!0||oe!==se)){const Pr=oe===se&&Ue.id===Y;de.setState(Ue,oe,Pr)}let Br=!1;Ue.version===Wn.__version?(Wn.needsLights&&Wn.lightsStateVersion!==d_.state.version||Wn.outputEncoding!==Ln||Qe.isInstancedMesh&&Wn.instancing===!1||!Qe.isInstancedMesh&&Wn.instancing===!0||Qe.isSkinnedMesh&&Wn.skinning===!1||!Qe.isSkinnedMesh&&Wn.skinning===!0||Wn.envMap!==kn||Ue.fog===!0&&Wn.fog!==fn||Wn.numClippingPlanes!==void 0&&(Wn.numClippingPlanes!==de.numPlanes||Wn.numIntersection!==de.numIntersection)||Wn.vertexAlphas!==ti||Wn.vertexTangents!==Hn||Wn.morphTargets!==Vn||Wn.morphNormals!==fr||Wn.morphColors!==oo||Wn.toneMapping!==Cl||Kt.isWebGL2===!0&&Wn.morphTargetsCount!==pr)&&(Br=!0):(Br=!0,Wn.__version=Ue.version);let Zu=Wn.currentProgram;Br===!0&&(Zu=Lo(Ue,Pe,Qe));let NS=!1,hp=!1,f_=!1;const Yr=Zu.getUniforms(),Ju=Wn.uniforms;if(en.useProgram(Zu.program)&&(NS=!0,hp=!0,f_=!0),Ue.id!==Y&&(Y=Ue.id,hp=!0),NS||se!==oe){if(Yr.setValue(_e,"projectionMatrix",oe.projectionMatrix),Kt.logarithmicDepthBuffer&&Yr.setValue(_e,"logDepthBufFC",2/(Math.log(oe.far+1)/Math.LN2)),se!==oe&&(se=oe,hp=!0,f_=!0),Ue.isShaderMaterial||Ue.isMeshPhongMaterial||Ue.isMeshToonMaterial||Ue.isMeshStandardMaterial||Ue.envMap){const Pr=Yr.map.cameraPosition;Pr!==void 0&&Pr.setValue(_e,Fe.setFromMatrixPosition(oe.matrixWorld))}(Ue.isMeshPhongMaterial||Ue.isMeshToonMaterial||Ue.isMeshLambertMaterial||Ue.isMeshBasicMaterial||Ue.isMeshStandardMaterial||Ue.isShaderMaterial)&&Yr.setValue(_e,"isOrthographic",oe.isOrthographicCamera===!0),(Ue.isMeshPhongMaterial||Ue.isMeshToonMaterial||Ue.isMeshLambertMaterial||Ue.isMeshBasicMaterial||Ue.isMeshStandardMaterial||Ue.isShaderMaterial||Ue.isShadowMaterial||Qe.isSkinnedMesh)&&Yr.setValue(_e,"viewMatrix",oe.matrixWorldInverse)}if(Qe.isSkinnedMesh){Yr.setOptional(_e,Qe,"bindMatrix"),Yr.setOptional(_e,Qe,"bindMatrixInverse");const Pr=Qe.skeleton;Pr&&(Kt.floatVertexTextures?(Pr.boneTexture===null&&Pr.computeBoneTexture(),Yr.setValue(_e,"boneTexture",Pr.boneTexture,tt),Yr.setValue(_e,"boneTextureSize",Pr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const p_=Ve.morphAttributes;(p_.position!==void 0||p_.normal!==void 0||p_.color!==void 0&&Kt.isWebGL2===!0)&&At.update(Qe,Ve,Zu),(hp||Wn.receiveShadow!==Qe.receiveShadow)&&(Wn.receiveShadow=Qe.receiveShadow,Yr.setValue(_e,"receiveShadow",Qe.receiveShadow)),Ue.isMeshGouraudMaterial&&Ue.envMap!==null&&(Ju.envMap.value=kn,Ju.flipEnvMap.value=kn.isCubeTexture&&kn.isRenderTargetTexture===!1?-1:1),hp&&(Yr.setValue(_e,"toneMappingExposure",D.toneMappingExposure),Wn.needsLights&&rO(Ju,f_),fn&&Ue.fog===!0&&wn.refreshFogUniforms(Ju,fn),wn.refreshMaterialUniforms(Ju,Ue,We,xe,ut),tg.upload(_e,Wn.uniformsList,Ju,tt)),Ue.isShaderMaterial&&Ue.uniformsNeedUpdate===!0&&(tg.upload(_e,Wn.uniformsList,Ju,tt),Ue.uniformsNeedUpdate=!1),Ue.isSpriteMaterial&&Yr.setValue(_e,"center",Qe.center),Yr.setValue(_e,"modelViewMatrix",Qe.modelViewMatrix),Yr.setValue(_e,"normalMatrix",Qe.normalMatrix),Yr.setValue(_e,"modelMatrix",Qe.matrixWorld);const zS=D.globalUniforms;for(let Pr in zS)Yr.setValue(_e,Pr,zS[Pr],tt);const GS=Qe.localUniforms;for(let Pr in GS)Yr.setValue(_e,Pr,GS[Pr],tt);if(Ue.isShaderMaterial||Ue.isRawShaderMaterial){const Pr=Ue.uniformsGroups;for(let m_=0,oO=Pr.length;m_<oO;m_++)if(Kt.isWebGL2){const HS=Pr[m_];nt.update(HS,Zu),nt.bind(HS,Zu)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Zu}function rO(oe,Pe){oe.ambientLightColor.needsUpdate=Pe,oe.lightProbe.needsUpdate=Pe,oe.directionalLights.needsUpdate=Pe,oe.directionalLightShadows.needsUpdate=Pe,oe.pointLights.needsUpdate=Pe,oe.pointLightShadows.needsUpdate=Pe,oe.spotLights.needsUpdate=Pe,oe.spotLightShadows.needsUpdate=Pe,oe.rectAreaLights.needsUpdate=Pe,oe.hemisphereLights.needsUpdate=Pe}function sO(oe){return oe.isMeshLambertMaterial||oe.isMeshToonMaterial||oe.isMeshPhongMaterial||oe.isMeshStandardMaterial||oe.isShadowMaterial||oe.isShaderMaterial&&oe.lights===!0}this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return V},this.setRenderTargetTextures=function(oe,Pe,Ve){xn.get(oe.texture).__webglTexture=Pe,xn.get(oe.depthTexture).__webglTexture=Ve;const Ue=xn.get(oe);Ue.__hasExternalTextures=!0,Ue.__hasExternalTextures&&(Ue.__autoAllocateDepthBuffer=Ve===void 0,Ue.__autoAllocateDepthBuffer||Bt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ue.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(oe,Pe){const Ve=xn.get(oe);Ve.__webglFramebuffer=Pe,Ve.__useDefaultFramebuffer=Pe===void 0},this.setRenderTarget=function(oe,Pe=0,Ve=0){V=oe,W=Pe,K=Ve;let Ue=!0,Qe=null,fn=!1,vn=!1;if(oe){const kn=xn.get(oe);kn.__useDefaultFramebuffer!==void 0?(en.bindFramebuffer(_e.FRAMEBUFFER,null),Ue=!1):kn.__webglFramebuffer===void 0?tt.setupRenderTarget(oe):kn.__hasExternalTextures&&tt.rebindTextures(oe,xn.get(oe.texture).__webglTexture,xn.get(oe.depthTexture).__webglTexture);const ti=oe.texture;(ti.isData3DTexture||ti.isDataArrayTexture||ti.isCompressedArrayTexture)&&(vn=!0);const Hn=xn.get(oe).__webglFramebuffer;oe.isWebGLCubeRenderTarget?(Qe=Hn[Pe],fn=!0):Kt.isWebGL2&&oe.samples>0&&tt.useMultisampledRTT(oe)===!1?Qe=xn.get(oe).__webglMultisampledFramebuffer:Qe=Hn,ue.copy(oe.viewport),me.copy(oe.scissor),J=oe.scissorTest}else ue.copy(Me).multiplyScalar(We).floor(),me.copy(Ke).multiplyScalar(We).floor(),J=rt;if(en.bindFramebuffer(_e.FRAMEBUFFER,Qe)&&Kt.drawBuffers&&Ue&&en.drawBuffers(oe,Qe),en.viewport(ue),en.scissor(me),en.setScissorTest(J),fn){const kn=xn.get(oe.texture);_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,kn.__webglTexture,Ve)}else if(vn){const kn=xn.get(oe.texture),ti=Pe||0;_e.framebufferTextureLayer(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,kn.__webglTexture,Ve||0,ti)}Y=-1},this.readRenderTargetPixels=function(oe,Pe,Ve,Ue,Qe,fn,vn){if(!(oe&&oe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ln=xn.get(oe).__webglFramebuffer;if(oe.isWebGLCubeRenderTarget&&vn!==void 0&&(Ln=Ln[vn]),Ln){en.bindFramebuffer(_e.FRAMEBUFFER,Ln);try{const kn=oe.texture,ti=kn.format,Hn=kn.type;if(ti!==Hr&&cn.convert(ti)!==_e.getParameter(_e.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Vn=Hn===Aa&&(Bt.has("EXT_color_buffer_half_float")||Kt.isWebGL2&&Bt.has("EXT_color_buffer_float"));if(Hn!==ts&&cn.convert(Hn)!==_e.getParameter(_e.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Hn===js&&(Kt.isWebGL2||Bt.has("OES_texture_float")||Bt.has("WEBGL_color_buffer_float")))&&!Vn){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Pe>=0&&Pe<=oe.width-Ue&&Ve>=0&&Ve<=oe.height-Qe&&_e.readPixels(Pe,Ve,Ue,Qe,cn.convert(ti),cn.convert(Hn),fn)}finally{const kn=V!==null?xn.get(V).__webglFramebuffer:null;en.bindFramebuffer(_e.FRAMEBUFFER,kn)}}},this.copyFramebufferToTexture=function(oe,Pe,Ve=0,Ue=-1){const Qe=Math.pow(2,-Ve),fn=Math.floor(Pe.image.width*Qe),vn=Math.floor(Pe.image.height*Qe);Ue>-1?(tt.setTextureCube(Pe,0),_e.copyTexSubImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Ve,0,0,oe.x,oe.y,fn,vn),Ve===0&&Ue>=5&&Pe.generateMipmaps&&_e.generateMipmap(_e.TEXTURE_CUBE_MAP)):(tt.setTexture2D(Pe,0),_e.copyTexSubImage2D(_e.TEXTURE_2D,Ve,0,0,oe.x,oe.y,fn,vn),Ve===0&&Pe.generateMipmaps&&_e.generateMipmap(_e.TEXTURE_2D)),en.unbindTexture()},this.copyTextureToTexture=function(oe,Pe,Ve,Ue=0){const Qe=Pe.image.width,fn=Pe.image.height,vn=cn.convert(Ve.format),Ln=cn.convert(Ve.type);tt.setTexture2D(Ve,0),_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,Ve.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ve.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,Ve.unpackAlignment),Pe.isDataTexture?_e.texSubImage2D(_e.TEXTURE_2D,Ue,oe.x,oe.y,Qe,fn,vn,Ln,Pe.image.data):Pe.isCompressedTexture?_e.compressedTexSubImage2D(_e.TEXTURE_2D,Ue,oe.x,oe.y,Pe.mipmaps[0].width,Pe.mipmaps[0].height,vn,Pe.mipmaps[0].data):_e.texSubImage2D(_e.TEXTURE_2D,Ue,oe.x,oe.y,vn,Ln,Pe.image),Ue===0&&Ve.generateMipmaps&&_e.generateMipmap(_e.TEXTURE_2D),en.unbindTexture()},this.copyTextureToTexture3D=function(oe,Pe,Ve,Ue,Qe=0){if(D.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const fn=oe.max.x-oe.min.x+1,vn=oe.max.y-oe.min.y+1,Ln=oe.max.z-oe.min.z+1,kn=cn.convert(Ue.format),ti=cn.convert(Ue.type);let Hn;if(Ue.isData3DTexture)tt.setTexture3D(Ue,0),Hn=_e.TEXTURE_3D;else if(Ue.isDataArrayTexture)tt.setTexture2DArray(Ue,0),Hn=_e.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}_e.pixelStorei(_e.UNPACK_FLIP_Y_WEBGL,Ue.flipY),_e.pixelStorei(_e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ue.premultiplyAlpha),_e.pixelStorei(_e.UNPACK_ALIGNMENT,Ue.unpackAlignment);const Vn=_e.getParameter(_e.UNPACK_ROW_LENGTH),fr=_e.getParameter(_e.UNPACK_IMAGE_HEIGHT),oo=_e.getParameter(_e.UNPACK_SKIP_PIXELS),Cl=_e.getParameter(_e.UNPACK_SKIP_ROWS),qu=_e.getParameter(_e.UNPACK_SKIP_IMAGES),pr=Ve.isCompressedTexture?Ve.mipmaps[0]:Ve.image;_e.pixelStorei(_e.UNPACK_ROW_LENGTH,pr.width),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,pr.height),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,oe.min.x),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,oe.min.y),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,oe.min.z),Ve.isDataTexture||Ve.isData3DTexture?_e.texSubImage3D(Hn,Qe,Pe.x,Pe.y,Pe.z,fn,vn,Ln,kn,ti,pr.data):Ve.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),_e.compressedTexSubImage3D(Hn,Qe,Pe.x,Pe.y,Pe.z,fn,vn,Ln,kn,pr.data)):_e.texSubImage3D(Hn,Qe,Pe.x,Pe.y,Pe.z,fn,vn,Ln,kn,ti,pr),_e.pixelStorei(_e.UNPACK_ROW_LENGTH,Vn),_e.pixelStorei(_e.UNPACK_IMAGE_HEIGHT,fr),_e.pixelStorei(_e.UNPACK_SKIP_PIXELS,oo),_e.pixelStorei(_e.UNPACK_SKIP_ROWS,Cl),_e.pixelStorei(_e.UNPACK_SKIP_IMAGES,qu),Qe===0&&Ue.generateMipmaps&&_e.generateMipmap(Hn),en.unbindTexture()},this.initTexture=function(oe){oe.isCubeTexture?tt.setTextureCube(oe,0):oe.isData3DTexture?tt.setTexture3D(oe,0):oe.isDataArrayTexture||oe.isCompressedArrayTexture?tt.setTexture2DArray(oe,0):tt.setTexture2D(oe,0),en.unbindTexture()},this.resetState=function(){W=0,K=0,V=null,en.reset(),Vt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Cy.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(u){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!u}}});class sA extends Cy{}sA.prototype.isWebGL1Renderer=!0;class ng{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ut(e),this.density=n}clone(){return new ng(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class ig{constructor(e,n=1,s=1e3){this.isFog=!0,this.name="",this.color=new Ut(e),this.near=n,this.far=s}clone(){return new ig(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class oA extends Gn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class rg{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=vu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=vs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,s){e*=this.stride,s*=n.stride;for(let a=0,c=this.stride;a<c;a++)this.array[e+a]=n.array[s+a];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),s=new this.constructor(n,this.stride);return s.setUsage(this.usage),s}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=vs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ms=new le;class ku{constructor(e,n,s,a=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=s,this.normalized=a}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,s=this.data.count;n<s;n++)Ms.fromBufferAttribute(this,n),Ms.applyMatrix4(e),this.setXYZ(n,Ms.x,Ms.y,Ms.z);return this}applyNormalMatrix(e){for(let n=0,s=this.count;n<s;n++)Ms.fromBufferAttribute(this,n),Ms.applyNormalMatrix(e),this.setXYZ(n,Ms.x,Ms.y,Ms.z);return this}transformDirection(e){for(let n=0,s=this.count;n<s;n++)Ms.fromBufferAttribute(this,n),Ms.transformDirection(e),this.setXYZ(n,Ms.x,Ms.y,Ms.z);return this}setX(e,n){return this.normalized&&(n=Yt(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Yt(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Yt(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Yt(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=qo(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=qo(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=qo(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=qo(n,this.array)),n}setXY(e,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=s,this}setXYZ(e,n,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array),a=Yt(a,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=s,this.data.array[e+2]=a,this}setXYZW(e,n,s,a,c){return e=e*this.data.stride+this.offset,this.normalized&&(n=Yt(n,this.array),s=Yt(s,this.array),a=Yt(a,this.array),c=Yt(c,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=s,this.data.array[e+2]=a,this.data.array[e+3]=c,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let s=0;s<this.count;s++){const a=s*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)n.push(this.data.array[a+c])}return new ci(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ku(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let s=0;s<this.count;s++){const a=s*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)n.push(this.data.array[a+c])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Py extends Ir{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ld;const kf=new le,cd=new le,ud=new le,hd=new it,Uf=new it,aA=new Mn,sg=new le,Nf=new le,og=new le,lA=new it,Ry=new it,cA=new it;class uA extends Gn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",ld===void 0){ld=new Rn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),s=new rg(n,5);ld.setIndex([0,1,2,0,2,3]),ld.setAttribute("position",new ku(s,3,0,!1)),ld.setAttribute("uv",new ku(s,2,3,!1))}this.geometry=ld,this.material=e!==void 0?e:new Py,this.center=new it(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),cd.setFromMatrixScale(this.matrixWorld),aA.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ud.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&cd.multiplyScalar(-ud.z);const s=this.material.rotation;let a,c;s!==0&&(c=Math.cos(s),a=Math.sin(s));const m=this.center;ag(sg.set(-.5,-.5,0),ud,m,cd,a,c),ag(Nf.set(.5,-.5,0),ud,m,cd,a,c),ag(og.set(.5,.5,0),ud,m,cd,a,c),lA.set(0,0),Ry.set(1,0),cA.set(1,1);let g=e.ray.intersectTriangle(sg,Nf,og,!1,kf);if(g===null&&(ag(Nf.set(-.5,.5,0),ud,m,cd,a,c),Ry.set(0,1),g=e.ray.intersectTriangle(sg,og,Nf,!1,kf),g===null))return;const _=e.ray.origin.distanceTo(kf);_<e.near||_>e.far||n.push({distance:_,point:kf.clone(),uv:Os.getUV(kf,sg,Nf,og,lA,Ry,cA,new it),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function ag(u,e,n,s,a,c){hd.subVectors(u,n).addScalar(.5).multiply(s),a!==void 0?(Uf.x=c*hd.x-a*hd.y,Uf.y=a*hd.x+c*hd.y):Uf.copy(hd),u.copy(e),u.x+=Uf.x,u.y+=Uf.y,u.applyMatrix4(aA)}const lg=new le,hA=new le;class dA extends Gn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let s=0,a=n.length;s<a;s++){const c=n[s];this.addLevel(c.object.clone(),c.distance,c.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,s=0){n=Math.abs(n);const a=this.levels;let c;for(c=0;c<a.length&&!(n<a[c].distance);c++);return a.splice(c,0,{distance:n,hysteresis:s,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let s,a;for(s=1,a=n.length;s<a;s++){let c=n[s].distance;if(n[s].object.visible&&(c-=c*n[s].hysteresis),e<c)break}return n[s-1].object}return null}raycast(e,n){if(this.levels.length>0){lg.setFromMatrixPosition(this.matrixWorld);const a=e.ray.origin.distanceTo(lg);this.getObjectForDistance(a).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){lg.setFromMatrixPosition(e.matrixWorld),hA.setFromMatrixPosition(this.matrixWorld);const s=lg.distanceTo(hA)/e.zoom;n[0].object.visible=!0;let a,c;for(a=1,c=n.length;a<c;a++){let m=n[a].distance;if(n[a].object.visible&&(m-=m*n[a].hysteresis),s>=m)n[a-1].object.visible=!1,n[a].object.visible=!0;else break}for(this._currentLevel=a-1;a<c;a++)n[a].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const s=this.levels;for(let a=0,c=s.length;a<c;a++){const m=s[a];n.object.levels.push({object:m.object.uuid,distance:m.distance,hysteresis:m.hysteresis})}return n}}const fA=new le,pA=new Zn,mA=new Zn,jD=new le,gA=new Mn;class vA extends ur{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Mn,this.bindMatrixInverse=new Mn}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Zn,n=this.geometry.attributes.skinWeight;for(let s=0,a=n.count;s<a;s++){e.fromBufferAttribute(n,s);const c=1/e.manhattanLength();c!==1/0?e.multiplyScalar(c):e.set(1,0,0,0),n.setXYZW(s,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,n){const s=this.skeleton,a=this.geometry;pA.fromBufferAttribute(a.attributes.skinIndex,e),mA.fromBufferAttribute(a.attributes.skinWeight,e),fA.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let c=0;c<4;c++){const m=mA.getComponent(c);if(m!==0){const g=pA.getComponent(c);gA.multiplyMatrices(s.bones[g].matrixWorld,s.boneInverses[g]),n.addScaledVector(jD.copy(fA).applyMatrix4(gA),m)}}return n.applyMatrix4(this.bindMatrixInverse)}}class Dy extends Gn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class dd extends ri{constructor(e=null,n=1,s=1,a,c,m,g,_,w=Ti,A=Ti,C,M){super(null,m,g,_,w,A,a,c,C,M),this.isDataTexture=!0,this.image={data:e,width:n,height:s},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const yA=new Mn,XD=new Mn;class cg{constructor(e=[],n=[]){this.uuid=vs(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let s=0,a=this.bones.length;s<a;s++)this.boneInverses.push(new Mn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const s=new Mn;this.bones[e]&&s.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(s)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const s=this.bones[e];s&&s.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const s=this.bones[e];s&&(s.parent&&s.parent.isBone?(s.matrix.copy(s.parent.matrixWorld).invert(),s.matrix.multiply(s.matrixWorld)):s.matrix.copy(s.matrixWorld),s.matrix.decompose(s.position,s.quaternion,s.scale))}}update(){const e=this.bones,n=this.boneInverses,s=this.boneMatrices,a=this.boneTexture;for(let c=0,m=e.length;c<m;c++){const g=e[c]?e[c].matrixWorld:XD;yA.multiplyMatrices(g,n[c]),yA.toArray(s,c*16)}a!==null&&(a.needsUpdate=!0)}clone(){return new cg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=kh(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const s=new dd(n,e,e,Hr,js);return s.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=s,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,s=this.bones.length;n<s;n++){const a=this.bones[n];if(a.name===e)return a}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let s=0,a=e.bones.length;s<a;s++){const c=e.bones[s];let m=n[c];m===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",c),m=new Dy),this.bones.push(m),this.boneInverses.push(new Mn().fromArray(e.boneInverses[s]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,s=this.boneInverses;for(let a=0,c=n.length;a<c;a++){const m=n[a];e.bones.push(m.uuid);const g=s[a];e.boneInverses.push(g.toArray())}return e}}class fd extends ci{constructor(e,n,s,a=1){super(e,n,s),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _A=new Mn,xA=new Mn,ug=[],YD=new Mn,zf=new ur;class bA extends ur{constructor(e,n,s){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new fd(new Float32Array(s*16),16),this.instanceColor=null,this.count=s,this.frustumCulled=!1;for(let a=0;a<s;a++)this.setMatrixAt(a,YD)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const s=this.matrixWorld,a=this.count;if(zf.geometry=this.geometry,zf.material=this.material,zf.material!==void 0)for(let c=0;c<a;c++){this.getMatrixAt(c,_A),xA.multiplyMatrices(s,_A),zf.matrixWorld=xA,zf.raycast(e,ug);for(let m=0,g=ug.length;m<g;m++){const _=ug[m];_.instanceId=c,_.object=this,n.push(_)}ug.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new fd(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Es extends Ir{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ut(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const wA=new le,AA=new le,SA=new Mn,Iy=new jn,hg=new ml;class Mc extends Gn{constructor(e=new Rn,n=new Es){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,s=[0];for(let a=1,c=n.count;a<c;a++)wA.fromBufferAttribute(n,a-1),AA.fromBufferAttribute(n,a),s[a]=s[a-1],s[a]+=wA.distanceTo(AA);e.setAttribute("lineDistance",new Qt(s,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const s=this.geometry,a=this.matrixWorld,c=e.params.Line.threshold,m=s.drawRange;if(s.boundingSphere===null&&s.computeBoundingSphere(),hg.copy(s.boundingSphere),hg.applyMatrix4(a),hg.radius+=c,e.ray.intersectsSphere(hg)===!1)return;SA.copy(a).invert(),Iy.copy(e.ray).applyMatrix4(SA);const g=c/((this.scale.x+this.scale.y+this.scale.z)/3),_=g*g,w=new le,A=new le,C=new le,M=new le,R=this.isLineSegments?2:1,F=s.index,O=s.attributes.position;if(F!==null){const W=Math.max(0,m.start),K=Math.min(F.count,m.start+m.count);for(let V=W,Y=K-1;V<Y;V+=R){const se=F.getX(V),ue=F.getX(V+1);if(w.fromBufferAttribute(O,se),A.fromBufferAttribute(O,ue),Iy.distanceSqToSegment(w,A,M,C)>_)continue;M.applyMatrix4(this.matrixWorld);const J=e.ray.origin.distanceTo(M);J<e.near||J>e.far||n.push({distance:J,point:C.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}else{const W=Math.max(0,m.start),K=Math.min(O.count,m.start+m.count);for(let V=W,Y=K-1;V<Y;V+=R){if(w.fromBufferAttribute(O,V),A.fromBufferAttribute(O,V+1),Iy.distanceSqToSegment(w,A,M,C)>_)continue;M.applyMatrix4(this.matrixWorld);const ue=e.ray.origin.distanceTo(M);ue<e.near||ue>e.far||n.push({distance:ue,point:C.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,s=Object.keys(n);if(s.length>0){const a=n[s[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,m=a.length;c<m;c++){const g=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[g]=c}}}}}const MA=new le,EA=new le;class Xa extends Mc{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,s=[];for(let a=0,c=n.count;a<c;a+=2)MA.fromBufferAttribute(n,a),EA.fromBufferAttribute(n,a+1),s[a]=a===0?0:s[a-1],s[a+1]=s[a]+MA.distanceTo(EA);e.setAttribute("lineDistance",new Qt(s,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class TA extends Mc{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class Ly extends Ir{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const CA=new Mn,Oy=new jn,dg=new ml,fg=new le;class PA extends Gn{constructor(e=new Rn,n=new Ly){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const s=this.geometry,a=this.matrixWorld,c=e.params.Points.threshold,m=s.drawRange;if(s.boundingSphere===null&&s.computeBoundingSphere(),dg.copy(s.boundingSphere),dg.applyMatrix4(a),dg.radius+=c,e.ray.intersectsSphere(dg)===!1)return;CA.copy(a).invert(),Oy.copy(e.ray).applyMatrix4(CA);const g=c/((this.scale.x+this.scale.y+this.scale.z)/3),_=g*g,w=s.index,C=s.attributes.position;if(w!==null){const M=Math.max(0,m.start),R=Math.min(w.count,m.start+m.count);for(let F=M,D=R;F<D;F++){const O=w.getX(F);fg.fromBufferAttribute(C,O),RA(fg,O,_,a,e,n,this)}}else{const M=Math.max(0,m.start),R=Math.min(C.count,m.start+m.count);for(let F=M,D=R;F<D;F++)fg.fromBufferAttribute(C,F),RA(fg,F,_,a,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,s=Object.keys(n);if(s.length>0){const a=n[s[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,m=a.length;c<m;c++){const g=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[g]=c}}}}}function RA(u,e,n,s,a,c,m){const g=Oy.distanceSqToPoint(u);if(g<n){const _=new le;Oy.closestPointToPoint(u,_),_.applyMatrix4(s);const w=a.ray.origin.distanceTo(_);if(w<a.near||w>a.far)return;c.push({distance:w,distanceToRay:Math.sqrt(g),point:_,index:e,face:null,object:m})}}class QD extends ri{constructor(e,n,s,a,c,m,g,_,w){super(e,n,s,a,c,m,g,_,w),this.isVideoTexture=!0,this.minFilter=m!==void 0?m:Ci,this.magFilter=c!==void 0?c:Ci,this.generateMipmaps=!1;const A=this;function C(){A.needsUpdate=!0,e.requestVideoFrameCallback(C)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(C)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class KD extends ri{constructor(e,n,s){super({width:e,height:n}),this.isFramebufferTexture=!0,this.format=s,this.magFilter=Ti,this.minFilter=Ti,this.generateMipmaps=!1,this.needsUpdate=!0}}class Fy extends ri{constructor(e,n,s,a,c,m,g,_,w,A,C,M){super(null,m,g,_,w,A,a,c,C,M),this.isCompressedTexture=!0,this.image={width:n,height:s},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qD extends Fy{constructor(e,n,s,a,c,m){super(e,n,s,c,m),this.isCompressedArrayTexture=!0,this.image.depth=a,this.wrapR=Bi}}class ZD extends ri{constructor(e,n,s,a,c,m,g,_,w){super(e,n,s,a,c,m,g,_,w),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ca{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const s=this.getUtoTmapping(e);return this.getPoint(s,n)}getPoints(e=5){const n=[];for(let s=0;s<=e;s++)n.push(this.getPoint(s/e));return n}getSpacedPoints(e=5){const n=[];for(let s=0;s<=e;s++)n.push(this.getPointAt(s/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let s,a=this.getPoint(0),c=0;n.push(0);for(let m=1;m<=e;m++)s=this.getPoint(m/e),c+=s.distanceTo(a),n.push(c),a=s;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const s=this.getLengths();let a=0;const c=s.length;let m;n?m=n:m=e*s[c-1];let g=0,_=c-1,w;for(;g<=_;)if(a=Math.floor(g+(_-g)/2),w=s[a]-m,w<0)g=a+1;else if(w>0)_=a-1;else{_=a;break}if(a=_,s[a]===m)return a/(c-1);const A=s[a],M=s[a+1]-A,R=(m-A)/M;return(a+R)/(c-1)}getTangent(e,n){let a=e-1e-4,c=e+1e-4;a<0&&(a=0),c>1&&(c=1);const m=this.getPoint(a),g=this.getPoint(c),_=n||(m.isVector2?new it:new le);return _.copy(g).sub(m).normalize(),_}getTangentAt(e,n){const s=this.getUtoTmapping(e);return this.getTangent(s,n)}computeFrenetFrames(e,n){const s=new le,a=[],c=[],m=[],g=new le,_=new Mn;for(let R=0;R<=e;R++){const F=R/e;a[R]=this.getTangentAt(F,new le)}c[0]=new le,m[0]=new le;let w=Number.MAX_VALUE;const A=Math.abs(a[0].x),C=Math.abs(a[0].y),M=Math.abs(a[0].z);A<=w&&(w=A,s.set(1,0,0)),C<=w&&(w=C,s.set(0,1,0)),M<=w&&s.set(0,0,1),g.crossVectors(a[0],s).normalize(),c[0].crossVectors(a[0],g),m[0].crossVectors(a[0],c[0]);for(let R=1;R<=e;R++){if(c[R]=c[R-1].clone(),m[R]=m[R-1].clone(),g.crossVectors(a[R-1],a[R]),g.length()>Number.EPSILON){g.normalize();const F=Math.acos(ni(a[R-1].dot(a[R]),-1,1));c[R].applyMatrix4(_.makeRotationAxis(g,F))}m[R].crossVectors(a[R],c[R])}if(n===!0){let R=Math.acos(ni(c[0].dot(c[e]),-1,1));R/=e,a[0].dot(g.crossVectors(c[0],c[e]))>0&&(R=-R);for(let F=1;F<=e;F++)c[F].applyMatrix4(_.makeRotationAxis(a[F],R*F)),m[F].crossVectors(a[F],c[F])}return{tangents:a,normals:c,binormals:m}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class pg extends ca{constructor(e=0,n=0,s=1,a=1,c=0,m=Math.PI*2,g=!1,_=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=s,this.yRadius=a,this.aStartAngle=c,this.aEndAngle=m,this.aClockwise=g,this.aRotation=_}getPoint(e,n){const s=n||new it,a=Math.PI*2;let c=this.aEndAngle-this.aStartAngle;const m=Math.abs(c)<Number.EPSILON;for(;c<0;)c+=a;for(;c>a;)c-=a;c<Number.EPSILON&&(m?c=0:c=a),this.aClockwise===!0&&!m&&(c===a?c=-a:c=c-a);const g=this.aStartAngle+e*c;let _=this.aX+this.xRadius*Math.cos(g),w=this.aY+this.yRadius*Math.sin(g);if(this.aRotation!==0){const A=Math.cos(this.aRotation),C=Math.sin(this.aRotation),M=_-this.aX,R=w-this.aY;_=M*A-R*C+this.aX,w=M*C+R*A+this.aY}return s.set(_,w)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class DA extends pg{constructor(e,n,s,a,c,m){super(e,n,s,s,a,c,m),this.isArcCurve=!0,this.type="ArcCurve"}}function By(){let u=0,e=0,n=0,s=0;function a(c,m,g,_){u=c,e=g,n=-3*c+3*m-2*g-_,s=2*c-2*m+g+_}return{initCatmullRom:function(c,m,g,_,w){a(m,g,w*(g-c),w*(_-m))},initNonuniformCatmullRom:function(c,m,g,_,w,A,C){let M=(m-c)/w-(g-c)/(w+A)+(g-m)/A,R=(g-m)/A-(_-m)/(A+C)+(_-g)/C;M*=A,R*=A,a(m,g,M,R)},calc:function(c){const m=c*c,g=m*c;return u+e*c+n*m+s*g}}}const mg=new le,ky=new By,Uy=new By,Ny=new By;class IA extends ca{constructor(e=[],n=!1,s="centripetal",a=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=s,this.tension=a}getPoint(e,n=new le){const s=n,a=this.points,c=a.length,m=(c-(this.closed?0:1))*e;let g=Math.floor(m),_=m-g;this.closed?g+=g>0?0:(Math.floor(Math.abs(g)/c)+1)*c:_===0&&g===c-1&&(g=c-2,_=1);let w,A;this.closed||g>0?w=a[(g-1)%c]:(mg.subVectors(a[0],a[1]).add(a[0]),w=mg);const C=a[g%c],M=a[(g+1)%c];if(this.closed||g+2<c?A=a[(g+2)%c]:(mg.subVectors(a[c-1],a[c-2]).add(a[c-1]),A=mg),this.curveType==="centripetal"||this.curveType==="chordal"){const R=this.curveType==="chordal"?.5:.25;let F=Math.pow(w.distanceToSquared(C),R),D=Math.pow(C.distanceToSquared(M),R),O=Math.pow(M.distanceToSquared(A),R);D<1e-4&&(D=1),F<1e-4&&(F=D),O<1e-4&&(O=D),ky.initNonuniformCatmullRom(w.x,C.x,M.x,A.x,F,D,O),Uy.initNonuniformCatmullRom(w.y,C.y,M.y,A.y,F,D,O),Ny.initNonuniformCatmullRom(w.z,C.z,M.z,A.z,F,D,O)}else this.curveType==="catmullrom"&&(ky.initCatmullRom(w.x,C.x,M.x,A.x,this.tension),Uy.initCatmullRom(w.y,C.y,M.y,A.y,this.tension),Ny.initCatmullRom(w.z,C.z,M.z,A.z,this.tension));return s.set(ky.calc(_),Uy.calc(_),Ny.calc(_)),s}copy(e){super.copy(e),this.points=[];for(let n=0,s=e.points.length;n<s;n++){const a=e.points[n];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,s=this.points.length;n<s;n++){const a=this.points[n];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,s=e.points.length;n<s;n++){const a=e.points[n];this.points.push(new le().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function LA(u,e,n,s,a){const c=(s-e)*.5,m=(a-n)*.5,g=u*u,_=u*g;return(2*n-2*s+c+m)*_+(-3*n+3*s-2*c-m)*g+c*u+n}function JD(u,e){const n=1-u;return n*n*e}function $D(u,e){return 2*(1-u)*u*e}function eI(u,e){return u*u*e}function Gf(u,e,n,s){return JD(u,e)+$D(u,n)+eI(u,s)}function tI(u,e){const n=1-u;return n*n*n*e}function nI(u,e){const n=1-u;return 3*n*n*u*e}function iI(u,e){return 3*(1-u)*u*u*e}function rI(u,e){return u*u*u*e}function Hf(u,e,n,s,a){return tI(u,e)+nI(u,n)+iI(u,s)+rI(u,a)}class zy extends ca{constructor(e=new it,n=new it,s=new it,a=new it){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=s,this.v3=a}getPoint(e,n=new it){const s=n,a=this.v0,c=this.v1,m=this.v2,g=this.v3;return s.set(Hf(e,a.x,c.x,m.x,g.x),Hf(e,a.y,c.y,m.y,g.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class OA extends ca{constructor(e=new le,n=new le,s=new le,a=new le){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=s,this.v3=a}getPoint(e,n=new le){const s=n,a=this.v0,c=this.v1,m=this.v2,g=this.v3;return s.set(Hf(e,a.x,c.x,m.x,g.x),Hf(e,a.y,c.y,m.y,g.y),Hf(e,a.z,c.z,m.z,g.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class gg extends ca{constructor(e=new it,n=new it){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new it){const s=n;return e===1?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new it){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class FA extends ca{constructor(e=new le,n=new le){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new le){const s=n;return e===1?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(e).add(this.v1)),s}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new le){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gy extends ca{constructor(e=new it,n=new it,s=new it){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=s}getPoint(e,n=new it){const s=n,a=this.v0,c=this.v1,m=this.v2;return s.set(Gf(e,a.x,c.x,m.x),Gf(e,a.y,c.y,m.y)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hy extends ca{constructor(e=new le,n=new le,s=new le){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=s}getPoint(e,n=new le){const s=n,a=this.v0,c=this.v1,m=this.v2;return s.set(Gf(e,a.x,c.x,m.x),Gf(e,a.y,c.y,m.y),Gf(e,a.z,c.z,m.z)),s}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vy extends ca{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new it){const s=n,a=this.points,c=(a.length-1)*e,m=Math.floor(c),g=c-m,_=a[m===0?m:m-1],w=a[m],A=a[m>a.length-2?a.length-1:m+1],C=a[m>a.length-3?a.length-1:m+2];return s.set(LA(g,_.x,w.x,A.x,C.x),LA(g,_.y,w.y,A.y,C.y)),s}copy(e){super.copy(e),this.points=[];for(let n=0,s=e.points.length;n<s;n++){const a=e.points[n];this.points.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,s=this.points.length;n<s;n++){const a=this.points[n];e.points.push(a.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,s=e.points.length;n<s;n++){const a=e.points[n];this.points.push(new it().fromArray(a))}return this}}class BA extends ca{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new gg(n,e))}getPoint(e,n){const s=e*this.getLength(),a=this.getCurveLengths();let c=0;for(;c<a.length;){if(a[c]>=s){const m=a[c]-s,g=this.curves[c],_=g.getLength(),w=_===0?0:1-m/_;return g.getPointAt(w,n)}c++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let s=0,a=this.curves.length;s<a;s++)n+=this.curves[s].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let s=0;s<=e;s++)n.push(this.getPoint(s/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let s;for(let a=0,c=this.curves;a<c.length;a++){const m=c[a],g=m.isEllipseCurve?e*2:m.isLineCurve||m.isLineCurve3?1:m.isSplineCurve?e*m.points.length:e,_=m.getPoints(g);for(let w=0;w<_.length;w++){const A=_[w];s&&s.equals(A)||(n.push(A),s=A)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,s=e.curves.length;n<s;n++){const a=e.curves[n];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,s=this.curves.length;n<s;n++){const a=this.curves[n];e.curves.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,s=e.curves.length;n<s;n++){const a=e.curves[n];this.curves.push(new o[a.type]().fromJSON(a))}return this}}class Vf extends BA{constructor(e){super(),this.type="Path",this.currentPoint=new it,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,s=e.length;n<s;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const s=new gg(this.currentPoint.clone(),new it(e,n));return this.curves.push(s),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,s,a){const c=new Gy(this.currentPoint.clone(),new it(e,n),new it(s,a));return this.curves.push(c),this.currentPoint.set(s,a),this}bezierCurveTo(e,n,s,a,c,m){const g=new zy(this.currentPoint.clone(),new it(e,n),new it(s,a),new it(c,m));return this.curves.push(g),this.currentPoint.set(c,m),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),s=new Vy(n);return this.curves.push(s),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,s,a,c,m){const g=this.currentPoint.x,_=this.currentPoint.y;return this.absarc(e+g,n+_,s,a,c,m),this}absarc(e,n,s,a,c,m){return this.absellipse(e,n,s,s,a,c,m),this}ellipse(e,n,s,a,c,m,g,_){const w=this.currentPoint.x,A=this.currentPoint.y;return this.absellipse(e+w,n+A,s,a,c,m,g,_),this}absellipse(e,n,s,a,c,m,g,_){const w=new pg(e,n,s,a,c,m,g,_);if(this.curves.length>0){const C=w.getPoint(0);C.equals(this.currentPoint)||this.lineTo(C.x,C.y)}this.curves.push(w);const A=w.getPoint(1);return this.currentPoint.copy(A),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class pd extends Rn{constructor(e=[new it(0,-.5),new it(.5,0),new it(0,.5)],n=12,s=0,a=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:s,phiLength:a},n=Math.floor(n),a=ni(a,0,Math.PI*2);const c=[],m=[],g=[],_=[],w=[],A=1/n,C=new le,M=new it,R=new le,F=new le,D=new le;let O=0,W=0;for(let K=0;K<=e.length-1;K++)switch(K){case 0:O=e[K+1].x-e[K].x,W=e[K+1].y-e[K].y,R.x=W*1,R.y=-O,R.z=W*0,D.copy(R),R.normalize(),_.push(R.x,R.y,R.z);break;case e.length-1:_.push(D.x,D.y,D.z);break;default:O=e[K+1].x-e[K].x,W=e[K+1].y-e[K].y,R.x=W*1,R.y=-O,R.z=W*0,F.copy(R),R.x+=D.x,R.y+=D.y,R.z+=D.z,R.normalize(),_.push(R.x,R.y,R.z),D.copy(F)}for(let K=0;K<=n;K++){const V=s+K*A*a,Y=Math.sin(V),se=Math.cos(V);for(let ue=0;ue<=e.length-1;ue++){C.x=e[ue].x*Y,C.y=e[ue].y,C.z=e[ue].x*se,m.push(C.x,C.y,C.z),M.x=K/n,M.y=ue/(e.length-1),g.push(M.x,M.y);const me=_[3*ue+0]*Y,J=_[3*ue+1],ae=_[3*ue+0]*se;w.push(me,J,ae)}}for(let K=0;K<n;K++)for(let V=0;V<e.length-1;V++){const Y=V+K*e.length,se=Y,ue=Y+e.length,me=Y+e.length+1,J=Y+1;c.push(se,ue,J),c.push(me,J,ue)}this.setIndex(c),this.setAttribute("position",new Qt(m,3)),this.setAttribute("uv",new Qt(g,2)),this.setAttribute("normal",new Qt(w,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pd(e.points,e.segments,e.phiStart,e.phiLength)}}class Wf extends pd{constructor(e=1,n=1,s=4,a=8){const c=new Vf;c.absarc(0,-n/2,e,Math.PI*1.5,0),c.absarc(0,n/2,e,0,Math.PI*.5),super(c.getPoints(s),a),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:s,radialSegments:a}}static fromJSON(e){return new Wf(e.radius,e.length,e.capSegments,e.radialSegments)}}class jf extends Rn{constructor(e=1,n=32,s=0,a=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:s,thetaLength:a},n=Math.max(3,n);const c=[],m=[],g=[],_=[],w=new le,A=new it;m.push(0,0,0),g.push(0,0,1),_.push(.5,.5);for(let C=0,M=3;C<=n;C++,M+=3){const R=s+C/n*a;w.x=e*Math.cos(R),w.y=e*Math.sin(R),m.push(w.x,w.y,w.z),g.push(0,0,1),A.x=(m[M]/e+1)/2,A.y=(m[M+1]/e+1)/2,_.push(A.x,A.y)}for(let C=1;C<=n;C++)c.push(C,C+1,0);this.setIndex(c),this.setAttribute("position",new Qt(m,3)),this.setAttribute("normal",new Qt(g,3)),this.setAttribute("uv",new Qt(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jf(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Uu extends Rn{constructor(e=1,n=1,s=1,a=32,c=1,m=!1,g=0,_=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:s,radialSegments:a,heightSegments:c,openEnded:m,thetaStart:g,thetaLength:_};const w=this;a=Math.floor(a),c=Math.floor(c);const A=[],C=[],M=[],R=[];let F=0;const D=[],O=s/2;let W=0;K(),m===!1&&(e>0&&V(!0),n>0&&V(!1)),this.setIndex(A),this.setAttribute("position",new Qt(C,3)),this.setAttribute("normal",new Qt(M,3)),this.setAttribute("uv",new Qt(R,2));function K(){const Y=new le,se=new le;let ue=0;const me=(n-e)/s;for(let J=0;J<=c;J++){const ae=[],xe=J/c,We=xe*(n-e)+e;for(let Je=0;Je<=a;Je++){const Le=Je/a,Me=Le*_+g,Ke=Math.sin(Me),rt=Math.cos(Me);se.x=We*Ke,se.y=-xe*s+O,se.z=We*rt,C.push(se.x,se.y,se.z),Y.set(Ke,me,rt).normalize(),M.push(Y.x,Y.y,Y.z),R.push(Le,1-xe),ae.push(F++)}D.push(ae)}for(let J=0;J<a;J++)for(let ae=0;ae<c;ae++){const xe=D[ae][J],We=D[ae+1][J],Je=D[ae+1][J+1],Le=D[ae][J+1];A.push(xe,We,Le),A.push(We,Je,Le),ue+=6}w.addGroup(W,ue,0),W+=ue}function V(Y){const se=F,ue=new it,me=new le;let J=0;const ae=Y===!0?e:n,xe=Y===!0?1:-1;for(let Je=1;Je<=a;Je++)C.push(0,O*xe,0),M.push(0,xe,0),R.push(.5,.5),F++;const We=F;for(let Je=0;Je<=a;Je++){const Me=Je/a*_+g,Ke=Math.cos(Me),rt=Math.sin(Me);me.x=ae*rt,me.y=O*xe,me.z=ae*Ke,C.push(me.x,me.y,me.z),M.push(0,xe,0),ue.x=Ke*.5+.5,ue.y=rt*.5*xe+.5,R.push(ue.x,ue.y),F++}for(let Je=0;Je<a;Je++){const Le=se+Je,Me=We+Je;Y===!0?A.push(Me,Me+1,Le):A.push(Me+1,Me,Le),J+=3}w.addGroup(W,J,Y===!0?1:2),W+=J}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uu(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Xf extends Uu{constructor(e=1,n=1,s=32,a=1,c=!1,m=0,g=Math.PI*2){super(0,e,n,s,a,c,m,g),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:s,heightSegments:a,openEnded:c,thetaStart:m,thetaLength:g}}static fromJSON(e){return new Xf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Al extends Rn{constructor(e=[],n=[],s=1,a=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:s,detail:a};const c=[],m=[];g(a),w(s),A(),this.setAttribute("position",new Qt(c,3)),this.setAttribute("normal",new Qt(c.slice(),3)),this.setAttribute("uv",new Qt(m,2)),a===0?this.computeVertexNormals():this.normalizeNormals();function g(K){const V=new le,Y=new le,se=new le;for(let ue=0;ue<n.length;ue+=3)R(n[ue+0],V),R(n[ue+1],Y),R(n[ue+2],se),_(V,Y,se,K)}function _(K,V,Y,se){const ue=se+1,me=[];for(let J=0;J<=ue;J++){me[J]=[];const ae=K.clone().lerp(Y,J/ue),xe=V.clone().lerp(Y,J/ue),We=ue-J;for(let Je=0;Je<=We;Je++)Je===0&&J===ue?me[J][Je]=ae:me[J][Je]=ae.clone().lerp(xe,Je/We)}for(let J=0;J<ue;J++)for(let ae=0;ae<2*(ue-J)-1;ae++){const xe=Math.floor(ae/2);ae%2===0?(M(me[J][xe+1]),M(me[J+1][xe]),M(me[J][xe])):(M(me[J][xe+1]),M(me[J+1][xe+1]),M(me[J+1][xe]))}}function w(K){const V=new le;for(let Y=0;Y<c.length;Y+=3)V.x=c[Y+0],V.y=c[Y+1],V.z=c[Y+2],V.normalize().multiplyScalar(K),c[Y+0]=V.x,c[Y+1]=V.y,c[Y+2]=V.z}function A(){const K=new le;for(let V=0;V<c.length;V+=3){K.x=c[V+0],K.y=c[V+1],K.z=c[V+2];const Y=O(K)/2/Math.PI+.5,se=W(K)/Math.PI+.5;m.push(Y,1-se)}F(),C()}function C(){for(let K=0;K<m.length;K+=6){const V=m[K+0],Y=m[K+2],se=m[K+4],ue=Math.max(V,Y,se),me=Math.min(V,Y,se);ue>.9&&me<.1&&(V<.2&&(m[K+0]+=1),Y<.2&&(m[K+2]+=1),se<.2&&(m[K+4]+=1))}}function M(K){c.push(K.x,K.y,K.z)}function R(K,V){const Y=K*3;V.x=e[Y+0],V.y=e[Y+1],V.z=e[Y+2]}function F(){const K=new le,V=new le,Y=new le,se=new le,ue=new it,me=new it,J=new it;for(let ae=0,xe=0;ae<c.length;ae+=9,xe+=6){K.set(c[ae+0],c[ae+1],c[ae+2]),V.set(c[ae+3],c[ae+4],c[ae+5]),Y.set(c[ae+6],c[ae+7],c[ae+8]),ue.set(m[xe+0],m[xe+1]),me.set(m[xe+2],m[xe+3]),J.set(m[xe+4],m[xe+5]),se.copy(K).add(V).add(Y).divideScalar(3);const We=O(se);D(ue,xe+0,K,We),D(me,xe+2,V,We),D(J,xe+4,Y,We)}}function D(K,V,Y,se){se<0&&K.x===1&&(m[V]=K.x-1),Y.x===0&&Y.z===0&&(m[V]=se/2/Math.PI+.5)}function O(K){return Math.atan2(K.z,-K.x)}function W(K){return Math.atan2(-K.y,Math.sqrt(K.x*K.x+K.z*K.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Al(e.vertices,e.indices,e.radius,e.details)}}class Yf extends Al{constructor(e=1,n=0){const s=(1+Math.sqrt(5))/2,a=1/s,c=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-s,0,-a,s,0,a,-s,0,a,s,-a,-s,0,-a,s,0,a,-s,0,a,s,0,-s,0,-a,s,0,-a,-s,0,a,s,0,a],m=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(c,m,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Yf(e.radius,e.detail)}}const vg=new le,yg=new le,Wy=new le,_g=new Os;class kA extends Rn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const a=Math.pow(10,4),c=Math.cos(ul*n),m=e.getIndex(),g=e.getAttribute("position"),_=m?m.count:g.count,w=[0,0,0],A=["a","b","c"],C=new Array(3),M={},R=[];for(let F=0;F<_;F+=3){m?(w[0]=m.getX(F),w[1]=m.getX(F+1),w[2]=m.getX(F+2)):(w[0]=F,w[1]=F+1,w[2]=F+2);const{a:D,b:O,c:W}=_g;if(D.fromBufferAttribute(g,w[0]),O.fromBufferAttribute(g,w[1]),W.fromBufferAttribute(g,w[2]),_g.getNormal(Wy),C[0]=`${Math.round(D.x*a)},${Math.round(D.y*a)},${Math.round(D.z*a)}`,C[1]=`${Math.round(O.x*a)},${Math.round(O.y*a)},${Math.round(O.z*a)}`,C[2]=`${Math.round(W.x*a)},${Math.round(W.y*a)},${Math.round(W.z*a)}`,!(C[0]===C[1]||C[1]===C[2]||C[2]===C[0]))for(let K=0;K<3;K++){const V=(K+1)%3,Y=C[K],se=C[V],ue=_g[A[K]],me=_g[A[V]],J=`${Y}_${se}`,ae=`${se}_${Y}`;ae in M&&M[ae]?(Wy.dot(M[ae].normal)<=c&&(R.push(ue.x,ue.y,ue.z),R.push(me.x,me.y,me.z)),M[ae]=null):J in M||(M[J]={index0:w[K],index1:w[V],normal:Wy.clone()})}}for(const F in M)if(M[F]){const{index0:D,index1:O}=M[F];vg.fromBufferAttribute(g,D),yg.fromBufferAttribute(g,O),R.push(vg.x,vg.y,vg.z),R.push(yg.x,yg.y,yg.z)}this.setAttribute("position",new Qt(R,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Nu extends Vf{constructor(e){super(e),this.uuid=vs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let s=0,a=this.holes.length;s<a;s++)n[s]=this.holes[s].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,s=e.holes.length;n<s;n++){const a=e.holes[n];this.holes.push(a.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,s=this.holes.length;n<s;n++){const a=this.holes[n];e.holes.push(a.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,s=e.holes.length;n<s;n++){const a=e.holes[n];this.holes.push(new Vf().fromJSON(a))}return this}}const sI={triangulate:function(u,e,n=2){const s=e&&e.length,a=s?e[0]*n:u.length;let c=UA(u,0,a,n,!0);const m=[];if(!c||c.next===c.prev)return m;let g,_,w,A,C,M,R;if(s&&(c=uI(u,e,c,n)),u.length>80*n){g=w=u[0],_=A=u[1];for(let F=n;F<a;F+=n)C=u[F],M=u[F+1],C<g&&(g=C),M<_&&(_=M),C>w&&(w=C),M>A&&(A=M);R=Math.max(w-g,A-_),R=R!==0?32767/R:0}return Qf(c,m,n,g,_,R,0),m}};function UA(u,e,n,s,a){let c,m;if(a===bI(u,e,n,s)>0)for(c=e;c<n;c+=s)m=GA(c,u[c],u[c+1],m);else for(c=n-s;c>=e;c-=s)m=GA(c,u[c],u[c+1],m);return m&&xg(m,m.next)&&(qf(m),m=m.next),m}function zu(u,e){if(!u)return u;e||(e=u);let n=u,s;do if(s=!1,!n.steiner&&(xg(n,n.next)||Hi(n.prev,n,n.next)===0)){if(qf(n),n=e=n.prev,n===n.next)break;s=!0}else n=n.next;while(s||n!==e);return e}function Qf(u,e,n,s,a,c,m){if(!u)return;!m&&c&&mI(u,s,a,c);let g=u,_,w;for(;u.prev!==u.next;){if(_=u.prev,w=u.next,c?aI(u,s,a,c):oI(u)){e.push(_.i/n|0),e.push(u.i/n|0),e.push(w.i/n|0),qf(u),u=w.next,g=w.next;continue}if(u=w,u===g){m?m===1?(u=lI(zu(u),e,n),Qf(u,e,n,s,a,c,2)):m===2&&cI(u,e,n,s,a,c):Qf(zu(u),e,n,s,a,c,1);break}}}function oI(u){const e=u.prev,n=u,s=u.next;if(Hi(e,n,s)>=0)return!1;const a=e.x,c=n.x,m=s.x,g=e.y,_=n.y,w=s.y,A=a<c?a<m?a:m:c<m?c:m,C=g<_?g<w?g:w:_<w?_:w,M=a>c?a>m?a:m:c>m?c:m,R=g>_?g>w?g:w:_>w?_:w;let F=s.next;for(;F!==e;){if(F.x>=A&&F.x<=M&&F.y>=C&&F.y<=R&&md(a,g,c,_,m,w,F.x,F.y)&&Hi(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function aI(u,e,n,s){const a=u.prev,c=u,m=u.next;if(Hi(a,c,m)>=0)return!1;const g=a.x,_=c.x,w=m.x,A=a.y,C=c.y,M=m.y,R=g<_?g<w?g:w:_<w?_:w,F=A<C?A<M?A:M:C<M?C:M,D=g>_?g>w?g:w:_>w?_:w,O=A>C?A>M?A:M:C>M?C:M,W=jy(R,F,e,n,s),K=jy(D,O,e,n,s);let V=u.prevZ,Y=u.nextZ;for(;V&&V.z>=W&&Y&&Y.z<=K;){if(V.x>=R&&V.x<=D&&V.y>=F&&V.y<=O&&V!==a&&V!==m&&md(g,A,_,C,w,M,V.x,V.y)&&Hi(V.prev,V,V.next)>=0||(V=V.prevZ,Y.x>=R&&Y.x<=D&&Y.y>=F&&Y.y<=O&&Y!==a&&Y!==m&&md(g,A,_,C,w,M,Y.x,Y.y)&&Hi(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;V&&V.z>=W;){if(V.x>=R&&V.x<=D&&V.y>=F&&V.y<=O&&V!==a&&V!==m&&md(g,A,_,C,w,M,V.x,V.y)&&Hi(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;Y&&Y.z<=K;){if(Y.x>=R&&Y.x<=D&&Y.y>=F&&Y.y<=O&&Y!==a&&Y!==m&&md(g,A,_,C,w,M,Y.x,Y.y)&&Hi(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function lI(u,e,n){let s=u;do{const a=s.prev,c=s.next.next;!xg(a,c)&&NA(a,s,s.next,c)&&Kf(a,c)&&Kf(c,a)&&(e.push(a.i/n|0),e.push(s.i/n|0),e.push(c.i/n|0),qf(s),qf(s.next),s=u=c),s=s.next}while(s!==u);return zu(s)}function cI(u,e,n,s,a,c){let m=u;do{let g=m.next.next;for(;g!==m.prev;){if(m.i!==g.i&&yI(m,g)){let _=zA(m,g);m=zu(m,m.next),_=zu(_,_.next),Qf(m,e,n,s,a,c,0),Qf(_,e,n,s,a,c,0);return}g=g.next}m=m.next}while(m!==u)}function uI(u,e,n,s){const a=[];let c,m,g,_,w;for(c=0,m=e.length;c<m;c++)g=e[c]*s,_=c<m-1?e[c+1]*s:u.length,w=UA(u,g,_,s,!1),w===w.next&&(w.steiner=!0),a.push(vI(w));for(a.sort(hI),c=0;c<a.length;c++)n=dI(a[c],n);return n}function hI(u,e){return u.x-e.x}function dI(u,e){const n=fI(u,e);if(!n)return e;const s=zA(n,u);return zu(s,s.next),zu(n,n.next)}function fI(u,e){let n=e,s=-1/0,a;const c=u.x,m=u.y;do{if(m<=n.y&&m>=n.next.y&&n.next.y!==n.y){const M=n.x+(m-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(M<=c&&M>s&&(s=M,a=n.x<n.next.x?n:n.next,M===c))return a}n=n.next}while(n!==e);if(!a)return null;const g=a,_=a.x,w=a.y;let A=1/0,C;n=a;do c>=n.x&&n.x>=_&&c!==n.x&&md(m<w?c:s,m,_,w,m<w?s:c,m,n.x,n.y)&&(C=Math.abs(m-n.y)/(c-n.x),Kf(n,u)&&(C<A||C===A&&(n.x>a.x||n.x===a.x&&pI(a,n)))&&(a=n,A=C)),n=n.next;while(n!==g);return a}function pI(u,e){return Hi(u.prev,u,e.prev)<0&&Hi(e.next,u,u.next)<0}function mI(u,e,n,s){let a=u;do a.z===0&&(a.z=jy(a.x,a.y,e,n,s)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==u);a.prevZ.nextZ=null,a.prevZ=null,gI(a)}function gI(u){let e,n,s,a,c,m,g,_,w=1;do{for(n=u,u=null,c=null,m=0;n;){for(m++,s=n,g=0,e=0;e<w&&(g++,s=s.nextZ,!!s);e++);for(_=w;g>0||_>0&&s;)g!==0&&(_===0||!s||n.z<=s.z)?(a=n,n=n.nextZ,g--):(a=s,s=s.nextZ,_--),c?c.nextZ=a:u=a,a.prevZ=c,c=a;n=s}c.nextZ=null,w*=2}while(m>1);return u}function jy(u,e,n,s,a){return u=(u-n)*a|0,e=(e-s)*a|0,u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,u=(u|u<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,u|e<<1}function vI(u){let e=u,n=u;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==u);return n}function md(u,e,n,s,a,c,m,g){return(a-m)*(e-g)>=(u-m)*(c-g)&&(u-m)*(s-g)>=(n-m)*(e-g)&&(n-m)*(c-g)>=(a-m)*(s-g)}function yI(u,e){return u.next.i!==e.i&&u.prev.i!==e.i&&!_I(u,e)&&(Kf(u,e)&&Kf(e,u)&&xI(u,e)&&(Hi(u.prev,u,e.prev)||Hi(u,e.prev,e))||xg(u,e)&&Hi(u.prev,u,u.next)>0&&Hi(e.prev,e,e.next)>0)}function Hi(u,e,n){return(e.y-u.y)*(n.x-e.x)-(e.x-u.x)*(n.y-e.y)}function xg(u,e){return u.x===e.x&&u.y===e.y}function NA(u,e,n,s){const a=wg(Hi(u,e,n)),c=wg(Hi(u,e,s)),m=wg(Hi(n,s,u)),g=wg(Hi(n,s,e));return!!(a!==c&&m!==g||a===0&&bg(u,n,e)||c===0&&bg(u,s,e)||m===0&&bg(n,u,s)||g===0&&bg(n,e,s))}function bg(u,e,n){return e.x<=Math.max(u.x,n.x)&&e.x>=Math.min(u.x,n.x)&&e.y<=Math.max(u.y,n.y)&&e.y>=Math.min(u.y,n.y)}function wg(u){return u>0?1:u<0?-1:0}function _I(u,e){let n=u;do{if(n.i!==u.i&&n.next.i!==u.i&&n.i!==e.i&&n.next.i!==e.i&&NA(n,n.next,u,e))return!0;n=n.next}while(n!==u);return!1}function Kf(u,e){return Hi(u.prev,u,u.next)<0?Hi(u,e,u.next)>=0&&Hi(u,u.prev,e)>=0:Hi(u,e,u.prev)<0||Hi(u,u.next,e)<0}function xI(u,e){let n=u,s=!1;const a=(u.x+e.x)/2,c=(u.y+e.y)/2;do n.y>c!=n.next.y>c&&n.next.y!==n.y&&a<(n.next.x-n.x)*(c-n.y)/(n.next.y-n.y)+n.x&&(s=!s),n=n.next;while(n!==u);return s}function zA(u,e){const n=new Xy(u.i,u.x,u.y),s=new Xy(e.i,e.x,e.y),a=u.next,c=e.prev;return u.next=e,e.prev=u,n.next=a,a.prev=n,s.next=n,n.prev=s,c.next=s,s.prev=c,s}function GA(u,e,n,s){const a=new Xy(u,e,n);return s?(a.next=s.next,a.prev=s,s.next.prev=a,s.next=a):(a.prev=a,a.next=a),a}function qf(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Xy(u,e,n){this.i=u,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bI(u,e,n,s){let a=0;for(let c=e,m=n-s;c<n;c+=s)a+=(u[m]-u[c])*(u[c+1]+u[m+1]),m=c;return a}class Ya{static area(e){const n=e.length;let s=0;for(let a=n-1,c=0;c<n;a=c++)s+=e[a].x*e[c].y-e[c].x*e[a].y;return s*.5}static isClockWise(e){return Ya.area(e)<0}static triangulateShape(e,n){const s=[],a=[],c=[];HA(e),VA(s,e);let m=e.length;n.forEach(HA);for(let _=0;_<n.length;_++)a.push(m),m+=n[_].length,VA(s,n[_]);const g=sI.triangulate(s,a);for(let _=0;_<g.length;_+=3)c.push(g.slice(_,_+3));return c}}function HA(u){const e=u.length;e>2&&u[e-1].equals(u[0])&&u.pop()}function VA(u,e){for(let n=0;n<e.length;n++)u.push(e[n].x),u.push(e[n].y)}class Zf extends Rn{constructor(e=new Nu([new it(.5,.5),new it(-.5,.5),new it(-.5,-.5),new it(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const s=this,a=[],c=[];for(let g=0,_=e.length;g<_;g++){const w=e[g];m(w)}this.setAttribute("position",new Qt(a,3)),this.setAttribute("uv",new Qt(c,2)),this.computeVertexNormals();function m(g){const _=[],w=n.curveSegments!==void 0?n.curveSegments:12,A=n.steps!==void 0?n.steps:1,C=n.depth!==void 0?n.depth:1;let M=n.bevelEnabled!==void 0?n.bevelEnabled:!0,R=n.bevelThickness!==void 0?n.bevelThickness:.2,F=n.bevelSize!==void 0?n.bevelSize:R-.1,D=n.bevelOffset!==void 0?n.bevelOffset:0,O=n.bevelSegments!==void 0?n.bevelSegments:3;const W=n.extrudePath,K=n.UVGenerator!==void 0?n.UVGenerator:wI;let V,Y=!1,se,ue,me,J;W&&(V=W.getSpacedPoints(A),Y=!0,M=!1,se=W.computeFrenetFrames(A,!1),ue=new le,me=new le,J=new le),M||(O=0,R=0,F=0,D=0);const ae=g.extractPoints(w);let xe=ae.shape;const We=ae.holes;if(!Ya.isClockWise(xe)){xe=xe.reverse();for(let tt=0,ct=We.length;tt<ct;tt++){const Tt=We[tt];Ya.isClockWise(Tt)&&(We[tt]=Tt.reverse())}}const Le=Ya.triangulateShape(xe,We),Me=xe;for(let tt=0,ct=We.length;tt<ct;tt++){const Tt=We[tt];xe=xe.concat(Tt)}function Ke(tt,ct,Tt){return ct||console.error("THREE.ExtrudeGeometry: vec does not exist"),tt.clone().addScaledVector(ct,Tt)}const rt=xe.length,yt=Le.length;function et(tt,ct,Tt){let an,It,bn;const hn=tt.x-ct.x,wn=tt.y-ct.y,Si=Tt.x-tt.x,hi=Tt.y-tt.y,de=hn*hn+wn*wn,ne=hn*hi-wn*Si;if(Math.abs(ne)>Number.EPSILON){const je=Math.sqrt(de),At=Math.sqrt(Si*Si+hi*hi),Mt=ct.x-wn/je,kt=ct.y+hn/je,cn=Tt.x-hi/At,Vt=Tt.y+Si/At,nt=((cn-Mt)*hi-(Vt-kt)*Si)/(hn*hi-wn*Si);an=Mt+hn*nt-tt.x,It=kt+wn*nt-tt.y;const pn=an*an+It*It;if(pn<=2)return new it(an,It);bn=Math.sqrt(pn/2)}else{let je=!1;hn>Number.EPSILON?Si>Number.EPSILON&&(je=!0):hn<-Number.EPSILON?Si<-Number.EPSILON&&(je=!0):Math.sign(wn)===Math.sign(hi)&&(je=!0),je?(an=-wn,It=hn,bn=Math.sqrt(de)):(an=hn,It=wn,bn=Math.sqrt(de/2))}return new it(an/bn,It/bn)}const _t=[];for(let tt=0,ct=Me.length,Tt=ct-1,an=tt+1;tt<ct;tt++,Tt++,an++)Tt===ct&&(Tt=0),an===ct&&(an=0),_t[tt]=et(Me[tt],Me[Tt],Me[an]);const ut=[];let $t,Fe=_t.concat();for(let tt=0,ct=We.length;tt<ct;tt++){const Tt=We[tt];$t=[];for(let an=0,It=Tt.length,bn=It-1,hn=an+1;an<It;an++,bn++,hn++)bn===It&&(bn=0),hn===It&&(hn=0),$t[an]=et(Tt[an],Tt[bn],Tt[hn]);ut.push($t),Fe=Fe.concat($t)}for(let tt=0;tt<O;tt++){const ct=tt/O,Tt=R*Math.cos(ct*Math.PI/2),an=F*Math.sin(ct*Math.PI/2)+D;for(let It=0,bn=Me.length;It<bn;It++){const hn=Ke(Me[It],_t[It],an);Bt(hn.x,hn.y,-Tt)}for(let It=0,bn=We.length;It<bn;It++){const hn=We[It];$t=ut[It];for(let wn=0,Si=hn.length;wn<Si;wn++){const hi=Ke(hn[wn],$t[wn],an);Bt(hi.x,hi.y,-Tt)}}}const ft=F+D;for(let tt=0;tt<rt;tt++){const ct=M?Ke(xe[tt],Fe[tt],ft):xe[tt];Y?(me.copy(se.normals[0]).multiplyScalar(ct.x),ue.copy(se.binormals[0]).multiplyScalar(ct.y),J.copy(V[0]).add(me).add(ue),Bt(J.x,J.y,J.z)):Bt(ct.x,ct.y,0)}for(let tt=1;tt<=A;tt++)for(let ct=0;ct<rt;ct++){const Tt=M?Ke(xe[ct],Fe[ct],ft):xe[ct];Y?(me.copy(se.normals[tt]).multiplyScalar(Tt.x),ue.copy(se.binormals[tt]).multiplyScalar(Tt.y),J.copy(V[tt]).add(me).add(ue),Bt(J.x,J.y,J.z)):Bt(Tt.x,Tt.y,C/A*tt)}for(let tt=O-1;tt>=0;tt--){const ct=tt/O,Tt=R*Math.cos(ct*Math.PI/2),an=F*Math.sin(ct*Math.PI/2)+D;for(let It=0,bn=Me.length;It<bn;It++){const hn=Ke(Me[It],_t[It],an);Bt(hn.x,hn.y,C+Tt)}for(let It=0,bn=We.length;It<bn;It++){const hn=We[It];$t=ut[It];for(let wn=0,Si=hn.length;wn<Si;wn++){const hi=Ke(hn[wn],$t[wn],an);Y?Bt(hi.x,hi.y+V[A-1].y,V[A-1].x+Tt):Bt(hi.x,hi.y,C+Tt)}}}Dt(),_e();function Dt(){const tt=a.length/3;if(M){let ct=0,Tt=rt*ct;for(let an=0;an<yt;an++){const It=Le[an];Kt(It[2]+Tt,It[1]+Tt,It[0]+Tt)}ct=A+O*2,Tt=rt*ct;for(let an=0;an<yt;an++){const It=Le[an];Kt(It[0]+Tt,It[1]+Tt,It[2]+Tt)}}else{for(let ct=0;ct<yt;ct++){const Tt=Le[ct];Kt(Tt[2],Tt[1],Tt[0])}for(let ct=0;ct<yt;ct++){const Tt=Le[ct];Kt(Tt[0]+rt*A,Tt[1]+rt*A,Tt[2]+rt*A)}}s.addGroup(tt,a.length/3-tt,0)}function _e(){const tt=a.length/3;let ct=0;qt(Me,ct),ct+=Me.length;for(let Tt=0,an=We.length;Tt<an;Tt++){const It=We[Tt];qt(It,ct),ct+=It.length}s.addGroup(tt,a.length/3-tt,1)}function qt(tt,ct){let Tt=tt.length;for(;--Tt>=0;){const an=Tt;let It=Tt-1;It<0&&(It=tt.length-1);for(let bn=0,hn=A+O*2;bn<hn;bn++){const wn=rt*bn,Si=rt*(bn+1),hi=ct+an+wn,de=ct+It+wn,ne=ct+It+Si,je=ct+an+Si;en(hi,de,ne,je)}}}function Bt(tt,ct,Tt){_.push(tt),_.push(ct),_.push(Tt)}function Kt(tt,ct,Tt){sn(tt),sn(ct),sn(Tt);const an=a.length/3,It=K.generateTopUV(s,a,an-3,an-2,an-1);xn(It[0]),xn(It[1]),xn(It[2])}function en(tt,ct,Tt,an){sn(tt),sn(ct),sn(an),sn(ct),sn(Tt),sn(an);const It=a.length/3,bn=K.generateSideWallUV(s,a,It-6,It-3,It-2,It-1);xn(bn[0]),xn(bn[1]),xn(bn[3]),xn(bn[1]),xn(bn[2]),xn(bn[3])}function sn(tt){a.push(_[tt*3+0]),a.push(_[tt*3+1]),a.push(_[tt*3+2])}function xn(tt){c.push(tt.x),c.push(tt.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,s=this.parameters.options;return AI(n,s,e)}static fromJSON(e,n){const s=[];for(let c=0,m=e.shapes.length;c<m;c++){const g=n[e.shapes[c]];s.push(g)}const a=e.options.extrudePath;return a!==void 0&&(e.options.extrudePath=new o[a.type]().fromJSON(a)),new Zf(s,e.options)}}const wI={generateTopUV:function(u,e,n,s,a){const c=e[n*3],m=e[n*3+1],g=e[s*3],_=e[s*3+1],w=e[a*3],A=e[a*3+1];return[new it(c,m),new it(g,_),new it(w,A)]},generateSideWallUV:function(u,e,n,s,a,c){const m=e[n*3],g=e[n*3+1],_=e[n*3+2],w=e[s*3],A=e[s*3+1],C=e[s*3+2],M=e[a*3],R=e[a*3+1],F=e[a*3+2],D=e[c*3],O=e[c*3+1],W=e[c*3+2];return Math.abs(g-A)<Math.abs(m-w)?[new it(m,1-_),new it(w,1-C),new it(M,1-F),new it(D,1-W)]:[new it(g,1-_),new it(A,1-C),new it(R,1-F),new it(O,1-W)]}};function AI(u,e,n){if(n.shapes=[],Array.isArray(u))for(let s=0,a=u.length;s<a;s++){const c=u[s];n.shapes.push(c.uuid)}else n.shapes.push(u.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class Jf extends Al{constructor(e=1,n=0){const s=(1+Math.sqrt(5))/2,a=[-1,s,0,1,s,0,-1,-s,0,1,-s,0,0,-1,s,0,1,s,0,-1,-s,0,1,-s,s,0,-1,s,0,1,-s,0,-1,-s,0,1],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(a,c,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Jf(e.radius,e.detail)}}class gd extends Al{constructor(e=1,n=0){const s=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],a=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(s,a,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new gd(e.radius,e.detail)}}class $f extends Rn{constructor(e=.5,n=1,s=32,a=1,c=0,m=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:s,phiSegments:a,thetaStart:c,thetaLength:m},s=Math.max(3,s),a=Math.max(1,a);const g=[],_=[],w=[],A=[];let C=e;const M=(n-e)/a,R=new le,F=new it;for(let D=0;D<=a;D++){for(let O=0;O<=s;O++){const W=c+O/s*m;R.x=C*Math.cos(W),R.y=C*Math.sin(W),_.push(R.x,R.y,R.z),w.push(0,0,1),F.x=(R.x/n+1)/2,F.y=(R.y/n+1)/2,A.push(F.x,F.y)}C+=M}for(let D=0;D<a;D++){const O=D*(s+1);for(let W=0;W<s;W++){const K=W+O,V=K,Y=K+s+1,se=K+s+2,ue=K+1;g.push(V,Y,ue),g.push(Y,se,ue)}}this.setIndex(g),this.setAttribute("position",new Qt(_,3)),this.setAttribute("normal",new Qt(w,3)),this.setAttribute("uv",new Qt(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $f(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ep extends Rn{constructor(e=new Nu([new it(0,.5),new it(-.5,-.5),new it(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const s=[],a=[],c=[],m=[];let g=0,_=0;if(Array.isArray(e)===!1)w(e);else for(let A=0;A<e.length;A++)w(e[A]),this.addGroup(g,_,A),g+=_,_=0;this.setIndex(s),this.setAttribute("position",new Qt(a,3)),this.setAttribute("normal",new Qt(c,3)),this.setAttribute("uv",new Qt(m,2));function w(A){const C=a.length/3,M=A.extractPoints(n);let R=M.shape;const F=M.holes;Ya.isClockWise(R)===!1&&(R=R.reverse());for(let O=0,W=F.length;O<W;O++){const K=F[O];Ya.isClockWise(K)===!0&&(F[O]=K.reverse())}const D=Ya.triangulateShape(R,F);for(let O=0,W=F.length;O<W;O++){const K=F[O];R=R.concat(K)}for(let O=0,W=R.length;O<W;O++){const K=R[O];a.push(K.x,K.y,0),c.push(0,0,1),m.push(K.x,K.y)}for(let O=0,W=D.length;O<W;O++){const K=D[O],V=K[0]+C,Y=K[1]+C,se=K[2]+C;s.push(V,Y,se),_+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return SI(n,e)}static fromJSON(e,n){const s=[];for(let a=0,c=e.shapes.length;a<c;a++){const m=n[e.shapes[a]];s.push(m)}return new ep(s,e.curveSegments)}}function SI(u,e){if(e.shapes=[],Array.isArray(u))for(let n=0,s=u.length;n<s;n++){const a=u[n];e.shapes.push(a.uuid)}else e.shapes.push(u.uuid);return e}class vd extends Rn{constructor(e=1,n=32,s=16,a=0,c=Math.PI*2,m=0,g=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:s,phiStart:a,phiLength:c,thetaStart:m,thetaLength:g},n=Math.max(3,Math.floor(n)),s=Math.max(2,Math.floor(s));const _=Math.min(m+g,Math.PI);let w=0;const A=[],C=new le,M=new le,R=[],F=[],D=[],O=[];for(let W=0;W<=s;W++){const K=[],V=W/s;let Y=0;W==0&&m==0?Y=.5/n:W==s&&_==Math.PI&&(Y=-.5/n);for(let se=0;se<=n;se++){const ue=se/n;C.x=-e*Math.cos(a+ue*c)*Math.sin(m+V*g),C.y=e*Math.cos(m+V*g),C.z=e*Math.sin(a+ue*c)*Math.sin(m+V*g),F.push(C.x,C.y,C.z),M.copy(C).normalize(),D.push(M.x,M.y,M.z),O.push(ue+Y,1-V),K.push(w++)}A.push(K)}for(let W=0;W<s;W++)for(let K=0;K<n;K++){const V=A[W][K+1],Y=A[W][K],se=A[W+1][K],ue=A[W+1][K+1];(W!==0||m>0)&&R.push(V,Y,ue),(W!==s-1||_<Math.PI)&&R.push(Y,se,ue)}this.setIndex(R),this.setAttribute("position",new Qt(F,3)),this.setAttribute("normal",new Qt(D,3)),this.setAttribute("uv",new Qt(O,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class tp extends Al{constructor(e=1,n=0){const s=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],a=[2,1,0,0,3,2,1,3,0,2,3,1];super(s,a,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new tp(e.radius,e.detail)}}class np extends Rn{constructor(e=1,n=.4,s=12,a=48,c=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:s,tubularSegments:a,arc:c},s=Math.floor(s),a=Math.floor(a);const m=[],g=[],_=[],w=[],A=new le,C=new le,M=new le;for(let R=0;R<=s;R++)for(let F=0;F<=a;F++){const D=F/a*c,O=R/s*Math.PI*2;C.x=(e+n*Math.cos(O))*Math.cos(D),C.y=(e+n*Math.cos(O))*Math.sin(D),C.z=n*Math.sin(O),g.push(C.x,C.y,C.z),A.x=e*Math.cos(D),A.y=e*Math.sin(D),M.subVectors(C,A).normalize(),_.push(M.x,M.y,M.z),w.push(F/a),w.push(R/s)}for(let R=1;R<=s;R++)for(let F=1;F<=a;F++){const D=(a+1)*R+F-1,O=(a+1)*(R-1)+F-1,W=(a+1)*(R-1)+F,K=(a+1)*R+F;m.push(D,O,K),m.push(O,W,K)}this.setIndex(m),this.setAttribute("position",new Qt(g,3)),this.setAttribute("normal",new Qt(_,3)),this.setAttribute("uv",new Qt(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new np(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class ip extends Rn{constructor(e=1,n=.4,s=64,a=8,c=2,m=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:s,radialSegments:a,p:c,q:m},s=Math.floor(s),a=Math.floor(a);const g=[],_=[],w=[],A=[],C=new le,M=new le,R=new le,F=new le,D=new le,O=new le,W=new le;for(let V=0;V<=s;++V){const Y=V/s*c*Math.PI*2;K(Y,c,m,e,R),K(Y+.01,c,m,e,F),O.subVectors(F,R),W.addVectors(F,R),D.crossVectors(O,W),W.crossVectors(D,O),D.normalize(),W.normalize();for(let se=0;se<=a;++se){const ue=se/a*Math.PI*2,me=-n*Math.cos(ue),J=n*Math.sin(ue);C.x=R.x+(me*W.x+J*D.x),C.y=R.y+(me*W.y+J*D.y),C.z=R.z+(me*W.z+J*D.z),_.push(C.x,C.y,C.z),M.subVectors(C,R).normalize(),w.push(M.x,M.y,M.z),A.push(V/s),A.push(se/a)}}for(let V=1;V<=s;V++)for(let Y=1;Y<=a;Y++){const se=(a+1)*(V-1)+(Y-1),ue=(a+1)*V+(Y-1),me=(a+1)*V+Y,J=(a+1)*(V-1)+Y;g.push(se,ue,J),g.push(ue,me,J)}this.setIndex(g),this.setAttribute("position",new Qt(_,3)),this.setAttribute("normal",new Qt(w,3)),this.setAttribute("uv",new Qt(A,2));function K(V,Y,se,ue,me){const J=Math.cos(V),ae=Math.sin(V),xe=se/Y*V,We=Math.cos(xe);me.x=ue*(2+We)*.5*J,me.y=ue*(2+We)*ae*.5,me.z=ue*Math.sin(xe)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ip(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class rp extends Rn{constructor(e=new Hy(new le(-1,-1,0),new le(-1,1,0),new le(1,1,0)),n=64,s=1,a=8,c=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:s,radialSegments:a,closed:c};const m=e.computeFrenetFrames(n,c);this.tangents=m.tangents,this.normals=m.normals,this.binormals=m.binormals;const g=new le,_=new le,w=new it;let A=new le;const C=[],M=[],R=[],F=[];D(),this.setIndex(F),this.setAttribute("position",new Qt(C,3)),this.setAttribute("normal",new Qt(M,3)),this.setAttribute("uv",new Qt(R,2));function D(){for(let V=0;V<n;V++)O(V);O(c===!1?n:0),K(),W()}function O(V){A=e.getPointAt(V/n,A);const Y=m.normals[V],se=m.binormals[V];for(let ue=0;ue<=a;ue++){const me=ue/a*Math.PI*2,J=Math.sin(me),ae=-Math.cos(me);_.x=ae*Y.x+J*se.x,_.y=ae*Y.y+J*se.y,_.z=ae*Y.z+J*se.z,_.normalize(),M.push(_.x,_.y,_.z),g.x=A.x+s*_.x,g.y=A.y+s*_.y,g.z=A.z+s*_.z,C.push(g.x,g.y,g.z)}}function W(){for(let V=1;V<=n;V++)for(let Y=1;Y<=a;Y++){const se=(a+1)*(V-1)+(Y-1),ue=(a+1)*V+(Y-1),me=(a+1)*V+Y,J=(a+1)*(V-1)+Y;F.push(se,ue,J),F.push(ue,me,J)}}function K(){for(let V=0;V<=n;V++)for(let Y=0;Y<=a;Y++)w.x=V/n,w.y=Y/a,R.push(w.x,w.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new rp(new o[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class WA extends Rn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],s=new Set,a=new le,c=new le;if(e.index!==null){const m=e.attributes.position,g=e.index;let _=e.groups;_.length===0&&(_=[{start:0,count:g.count,materialIndex:0}]);for(let w=0,A=_.length;w<A;++w){const C=_[w],M=C.start,R=C.count;for(let F=M,D=M+R;F<D;F+=3)for(let O=0;O<3;O++){const W=g.getX(F+O),K=g.getX(F+(O+1)%3);a.fromBufferAttribute(m,W),c.fromBufferAttribute(m,K),jA(a,c,s)===!0&&(n.push(a.x,a.y,a.z),n.push(c.x,c.y,c.z))}}}else{const m=e.attributes.position;for(let g=0,_=m.count/3;g<_;g++)for(let w=0;w<3;w++){const A=3*g+w,C=3*g+(w+1)%3;a.fromBufferAttribute(m,A),c.fromBufferAttribute(m,C),jA(a,c,s)===!0&&(n.push(a.x,a.y,a.z),n.push(c.x,c.y,c.z))}}this.setAttribute("position",new Qt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function jA(u,e,n){const s=`${u.x},${u.y},${u.z}-${e.x},${e.y},${e.z}`,a=`${e.x},${e.y},${e.z}-${u.x},${u.y},${u.z}`;return n.has(s)===!0||n.has(a)===!0?!1:(n.add(s),n.add(a),!0)}class XA extends Ir{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class YA extends no{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Yy extends Ir{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QA extends Yy{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new it(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ni(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ut(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ut(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ut(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class KA extends Ir{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class qA extends Ir{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class ZA extends Ir{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class JA extends Ir{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $A extends Ir{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Yo,this.normalScale=new it(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eS extends Es{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Io(u,e,n){return Qy(u)?new u.constructor(u.subarray(e,n!==void 0?n:u.length)):u.slice(e,n)}function Gu(u,e,n){return!u||!n&&u.constructor===e?u:typeof e.BYTES_PER_ELEMENT=="number"?new e(u):Array.prototype.slice.call(u)}function Qy(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)}function tS(u){function e(a,c){return u[a]-u[c]}const n=u.length,s=new Array(n);for(let a=0;a!==n;++a)s[a]=a;return s.sort(e),s}function Ky(u,e,n){const s=u.length,a=new u.constructor(s);for(let c=0,m=0;m!==s;++c){const g=n[c]*e;for(let _=0;_!==e;++_)a[m++]=u[g+_]}return a}function qy(u,e,n,s){let a=1,c=u[0];for(;c!==void 0&&c[s]===void 0;)c=u[a++];if(c===void 0)return;let m=c[s];if(m!==void 0)if(Array.isArray(m))do m=c[s],m!==void 0&&(e.push(c.time),n.push.apply(n,m)),c=u[a++];while(c!==void 0);else if(m.toArray!==void 0)do m=c[s],m!==void 0&&(e.push(c.time),m.toArray(n,n.length)),c=u[a++];while(c!==void 0);else do m=c[s],m!==void 0&&(e.push(c.time),n.push(m)),c=u[a++];while(c!==void 0)}function MI(u,e,n,s,a=30){const c=u.clone();c.name=e;const m=[];for(let _=0;_<c.tracks.length;++_){const w=c.tracks[_],A=w.getValueSize(),C=[],M=[];for(let R=0;R<w.times.length;++R){const F=w.times[R]*a;if(!(F<n||F>=s)){C.push(w.times[R]);for(let D=0;D<A;++D)M.push(w.values[R*A+D])}}C.length!==0&&(w.times=Gu(C,w.times.constructor),w.values=Gu(M,w.values.constructor),m.push(w))}c.tracks=m;let g=1/0;for(let _=0;_<c.tracks.length;++_)g>c.tracks[_].times[0]&&(g=c.tracks[_].times[0]);for(let _=0;_<c.tracks.length;++_)c.tracks[_].shift(-1*g);return c.resetDuration(),c}function EI(u,e=0,n=u,s=30){s<=0&&(s=30);const a=n.tracks.length,c=e/s;for(let m=0;m<a;++m){const g=n.tracks[m],_=g.ValueTypeName;if(_==="bool"||_==="string")continue;const w=u.tracks.find(function(W){return W.name===g.name&&W.ValueTypeName===_});if(w===void 0)continue;let A=0;const C=g.getValueSize();g.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=C/3);let M=0;const R=w.getValueSize();w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(M=R/3);const F=g.times.length-1;let D;if(c<=g.times[0]){const W=A,K=C-A;D=Io(g.values,W,K)}else if(c>=g.times[F]){const W=F*C+A,K=W+C-A;D=Io(g.values,W,K)}else{const W=g.createInterpolant(),K=A,V=C-A;W.evaluate(c),D=Io(W.resultBuffer,K,V)}_==="quaternion"&&new Vr().fromArray(D).normalize().conjugate().toArray(D);const O=w.times.length;for(let W=0;W<O;++W){const K=W*R+M;if(_==="quaternion")Vr.multiplyQuaternionsFlat(w.values,K,D,0,w.values,K);else{const V=R-M*2;for(let Y=0;Y<V;++Y)w.values[K+Y]-=D[Y]}}}return u.blendMode=br,u}const TI={arraySlice:Io,convertArray:Gu,isTypedArray:Qy,getKeyframeOrder:tS,sortedArray:Ky,flattenJSON:qy,subclip:MI,makeClipAdditive:EI};class sp{constructor(e,n,s,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new n.constructor(s),this.sampleValues=n,this.valueSize=s,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let s=this._cachedIndex,a=n[s],c=n[s-1];e:{t:{let m;n:{i:if(!(e<a)){for(let g=s+2;;){if(a===void 0){if(e<c)break i;return s=n.length,this._cachedIndex=s,this.copySampleValue_(s-1)}if(s===g)break;if(c=a,a=n[++s],e<a)break t}m=n.length;break n}if(!(e>=c)){const g=n[1];e<g&&(s=2,c=g);for(let _=s-2;;){if(c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===_)break;if(a=c,c=n[--s-1],e>=c)break t}m=s,s=0;break n}break e}for(;s<m;){const g=s+m>>>1;e<n[g]?m=g:s=g+1}if(a=n[s],c=n[s-1],c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===void 0)return s=n.length,this._cachedIndex=s,this.copySampleValue_(s-1)}this._cachedIndex=s,this.intervalChanged_(s,c,a)}return this.interpolate_(s,c,e,a)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a;for(let m=0;m!==a;++m)n[m]=s[c+m];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class nS extends sp{constructor(e,n,s,a){super(e,n,s,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_i,endingEnd:_i}}intervalChanged_(e,n,s){const a=this.parameterPositions;let c=e-2,m=e+1,g=a[c],_=a[m];if(g===void 0)switch(this.getSettings_().endingStart){case Xs:c=e,g=2*n-s;break;case So:c=a.length-2,g=n+a[c]-a[c+1];break;default:c=e,g=s}if(_===void 0)switch(this.getSettings_().endingEnd){case Xs:m=e,_=2*s-n;break;case So:m=1,_=s+a[1]-a[0];break;default:m=e-1,_=n}const w=(s-n)*.5,A=this.valueSize;this._weightPrev=w/(n-g),this._weightNext=w/(_-s),this._offsetPrev=c*A,this._offsetNext=m*A}interpolate_(e,n,s,a){const c=this.resultBuffer,m=this.sampleValues,g=this.valueSize,_=e*g,w=_-g,A=this._offsetPrev,C=this._offsetNext,M=this._weightPrev,R=this._weightNext,F=(s-n)/(a-n),D=F*F,O=D*F,W=-M*O+2*M*D-M*F,K=(1+M)*O+(-1.5-2*M)*D+(-.5+M)*F+1,V=(-1-R)*O+(1.5+R)*D+.5*F,Y=R*O-R*D;for(let se=0;se!==g;++se)c[se]=W*m[A+se]+K*m[w+se]+V*m[_+se]+Y*m[C+se];return c}}class Zy extends sp{constructor(e,n,s,a){super(e,n,s,a)}interpolate_(e,n,s,a){const c=this.resultBuffer,m=this.sampleValues,g=this.valueSize,_=e*g,w=_-g,A=(s-n)/(a-n),C=1-A;for(let M=0;M!==g;++M)c[M]=m[w+M]*C+m[_+M]*A;return c}}class iS extends sp{constructor(e,n,s,a){super(e,n,s,a)}interpolate_(e){return this.copySampleValue_(e-1)}}class ua{constructor(e,n,s,a){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Gu(n,this.TimeBufferType),this.values=Gu(s,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let s;if(n.toJSON!==this.toJSON)s=n.toJSON(e);else{s={name:e.name,times:Gu(e.times,Array),values:Gu(e.values,Array)};const a=e.getInterpolation();a!==e.DefaultInterpolation&&(s.interpolation=a)}return s.type=e.ValueTypeName,s}InterpolantFactoryMethodDiscrete(e){return new iS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Zy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nS(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case oi:n=this.InterpolantFactoryMethodDiscrete;break;case yi:n=this.InterpolantFactoryMethodLinear;break;case xr:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const s="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(s);return console.warn("THREE.KeyframeTrack:",s),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return oi;case this.InterpolantFactoryMethodLinear:return yi;case this.InterpolantFactoryMethodSmooth:return xr}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let s=0,a=n.length;s!==a;++s)n[s]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let s=0,a=n.length;s!==a;++s)n[s]*=e}return this}trim(e,n){const s=this.times,a=s.length;let c=0,m=a-1;for(;c!==a&&s[c]<e;)++c;for(;m!==-1&&s[m]>n;)--m;if(++m,c!==0||m!==a){c>=m&&(m=Math.max(m,1),c=m-1);const g=this.getValueSize();this.times=Io(s,c,m),this.values=Io(this.values,c*g,m*g)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const s=this.times,a=this.values,c=s.length;c===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let m=null;for(let g=0;g!==c;g++){const _=s[g];if(typeof _=="number"&&isNaN(_)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,g,_),e=!1;break}if(m!==null&&m>_){console.error("THREE.KeyframeTrack: Out of order keys.",this,g,_,m),e=!1;break}m=_}if(a!==void 0&&Qy(a))for(let g=0,_=a.length;g!==_;++g){const w=a[g];if(isNaN(w)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,g,w),e=!1;break}}return e}optimize(){const e=Io(this.times),n=Io(this.values),s=this.getValueSize(),a=this.getInterpolation()===xr,c=e.length-1;let m=1;for(let g=1;g<c;++g){let _=!1;const w=e[g],A=e[g+1];if(w!==A&&(g!==1||w!==e[0]))if(a)_=!0;else{const C=g*s,M=C-s,R=C+s;for(let F=0;F!==s;++F){const D=n[C+F];if(D!==n[M+F]||D!==n[R+F]){_=!0;break}}}if(_){if(g!==m){e[m]=e[g];const C=g*s,M=m*s;for(let R=0;R!==s;++R)n[M+R]=n[C+R]}++m}}if(c>0){e[m]=e[c];for(let g=c*s,_=m*s,w=0;w!==s;++w)n[_+w]=n[g+w];++m}return m!==e.length?(this.times=Io(e,0,m),this.values=Io(n,0,m*s)):(this.times=e,this.values=n),this}clone(){const e=Io(this.times,0),n=Io(this.values,0),s=this.constructor,a=new s(this.name,e,n);return a.createInterpolant=this.createInterpolant,a}}ua.prototype.TimeBufferType=Float32Array,ua.prototype.ValueBufferType=Float32Array,ua.prototype.DefaultInterpolation=yi;class Hu extends ua{}Hu.prototype.ValueTypeName="bool",Hu.prototype.ValueBufferType=Array,Hu.prototype.DefaultInterpolation=oi,Hu.prototype.InterpolantFactoryMethodLinear=void 0,Hu.prototype.InterpolantFactoryMethodSmooth=void 0;class Jy extends ua{}Jy.prototype.ValueTypeName="color";class op extends ua{}op.prototype.ValueTypeName="number";class rS extends sp{constructor(e,n,s,a){super(e,n,s,a)}interpolate_(e,n,s,a){const c=this.resultBuffer,m=this.sampleValues,g=this.valueSize,_=(s-n)/(a-n);let w=e*g;for(let A=w+g;w!==A;w+=4)Vr.slerpFlat(c,0,m,w-g,m,w,_);return c}}class yd extends ua{InterpolantFactoryMethodLinear(e){return new rS(this.times,this.values,this.getValueSize(),e)}}yd.prototype.ValueTypeName="quaternion",yd.prototype.DefaultInterpolation=yi,yd.prototype.InterpolantFactoryMethodSmooth=void 0;class Vu extends ua{}Vu.prototype.ValueTypeName="string",Vu.prototype.ValueBufferType=Array,Vu.prototype.DefaultInterpolation=oi,Vu.prototype.InterpolantFactoryMethodLinear=void 0,Vu.prototype.InterpolantFactoryMethodSmooth=void 0;class ap extends ua{}ap.prototype.ValueTypeName="vector";class lp{constructor(e,n=-1,s,a=Ki){this.name=e,this.tracks=s,this.duration=n,this.blendMode=a,this.uuid=vs(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],s=e.tracks,a=1/(e.fps||1);for(let m=0,g=s.length;m!==g;++m)n.push(PI(s[m]).scale(a));const c=new this(e.name,e.duration,n,e.blendMode);return c.uuid=e.uuid,c}static toJSON(e){const n=[],s=e.tracks,a={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let c=0,m=s.length;c!==m;++c)n.push(ua.toJSON(s[c]));return a}static CreateFromMorphTargetSequence(e,n,s,a){const c=n.length,m=[];for(let g=0;g<c;g++){let _=[],w=[];_.push((g+c-1)%c,g,(g+1)%c),w.push(0,1,0);const A=tS(_);_=Ky(_,1,A),w=Ky(w,1,A),!a&&_[0]===0&&(_.push(c),w.push(w[0])),m.push(new op(".morphTargetInfluences["+n[g].name+"]",_,w).scale(1/s))}return new this(e,-1,m)}static findByName(e,n){let s=e;if(!Array.isArray(e)){const a=e;s=a.geometry&&a.geometry.animations||a.animations}for(let a=0;a<s.length;a++)if(s[a].name===n)return s[a];return null}static CreateClipsFromMorphTargetSequences(e,n,s){const a={},c=/^([\w-]*?)([\d]+)$/;for(let g=0,_=e.length;g<_;g++){const w=e[g],A=w.name.match(c);if(A&&A.length>1){const C=A[1];let M=a[C];M||(a[C]=M=[]),M.push(w)}}const m=[];for(const g in a)m.push(this.CreateFromMorphTargetSequence(g,a[g],n,s));return m}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const s=function(C,M,R,F,D){if(R.length!==0){const O=[],W=[];qy(R,O,W,F),O.length!==0&&D.push(new C(M,O,W))}},a=[],c=e.name||"default",m=e.fps||30,g=e.blendMode;let _=e.length||-1;const w=e.hierarchy||[];for(let C=0;C<w.length;C++){const M=w[C].keys;if(!(!M||M.length===0))if(M[0].morphTargets){const R={};let F;for(F=0;F<M.length;F++)if(M[F].morphTargets)for(let D=0;D<M[F].morphTargets.length;D++)R[M[F].morphTargets[D]]=-1;for(const D in R){const O=[],W=[];for(let K=0;K!==M[F].morphTargets.length;++K){const V=M[F];O.push(V.time),W.push(V.morphTarget===D?1:0)}a.push(new op(".morphTargetInfluence["+D+"]",O,W))}_=R.length*m}else{const R=".bones["+n[C].name+"]";s(ap,R+".position",M,"pos",a),s(yd,R+".quaternion",M,"rot",a),s(ap,R+".scale",M,"scl",a)}}return a.length===0?null:new this(c,_,a,g)}resetDuration(){const e=this.tracks;let n=0;for(let s=0,a=e.length;s!==a;++s){const c=this.tracks[s];n=Math.max(n,c.times[c.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function CI(u){switch(u.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return op;case"vector":case"vector2":case"vector3":case"vector4":return ap;case"color":return Jy;case"quaternion":return yd;case"bool":case"boolean":return Hu;case"string":return Vu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+u)}function PI(u){if(u.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=CI(u.type);if(u.times===void 0){const n=[],s=[];qy(u.keys,n,s,"value"),u.times=n,u.values=s}return e.parse!==void 0?e.parse(u):new e(u.name,u.times,u.values,u.interpolation)}const Ec={enabled:!1,files:{},add:function(u,e){this.enabled!==!1&&(this.files[u]=e)},get:function(u){if(this.enabled!==!1)return this.files[u]},remove:function(u){delete this.files[u]},clear:function(){this.files={}}};class $y{constructor(e,n,s){const a=this;let c=!1,m=0,g=0,_;const w=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=s,this.itemStart=function(A){g++,c===!1&&a.onStart!==void 0&&a.onStart(A,m,g),c=!0},this.itemEnd=function(A){m++,a.onProgress!==void 0&&a.onProgress(A,m,g),m===g&&(c=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(A){a.onError!==void 0&&a.onError(A)},this.resolveURL=function(A){return _?_(A):A},this.setURLModifier=function(A){return _=A,this},this.addHandler=function(A,C){return w.push(A,C),this},this.removeHandler=function(A){const C=w.indexOf(A);return C!==-1&&w.splice(C,2),this},this.getHandler=function(A){for(let C=0,M=w.length;C<M;C+=2){const R=w[C],F=w[C+1];if(R.global&&(R.lastIndex=0),R.test(A))return F}return null}}}const sS=new $y;class so{constructor(e){this.manager=e!==void 0?e:sS,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const s=this;return new Promise(function(a,c){s.load(e,a,n,c)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}var e_=r(980);const Sl={};class RI extends Error{constructor(e,n){super(e),this.response=n}}class Ml extends so{constructor(e){super(e)}load(e,n,s,a,c){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let m=Ec.get(e);if(m===void 0&&c){this.manager.itemStart(e),(this.responseType==="arraybuffer"?(0,e_.LX)(c):(0,e_.Vu)(c)).then(C=>{Ec.add(e,C),n&&n(C),this.manager.itemEnd(e)});return}if(m!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(m),this.manager.itemEnd(e)},0),m;if(Sl[e]!==void 0){Sl[e].push({onLoad:n,onProgress:s,onError:a});return}Sl[e]=[],Sl[e].push({onLoad:n,onProgress:s,onError:a});const g=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),_=this.mimeType,w=this.responseType;fetch(g).then(A=>{if(A.status===200||A.status===0){if(A.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||A.body===void 0||A.body.getReader===void 0)return A;const C=Sl[e],M=A.body.getReader(),R=A.headers.get("Content-Length")||A.headers.get("X-File-Size"),F=R?parseInt(R):0,D=F!==0;let O=0;const W=new ReadableStream({start(K){V();function V(){M.read().then(({done:Y,value:se})=>{if(Y)K.close();else{O+=se.byteLength;const ue=new ProgressEvent("progress",{lengthComputable:D,loaded:O,total:F});for(let me=0,J=C.length;me<J;me++){const ae=C[me];ae.onProgress&&ae.onProgress(ue)}K.enqueue(se),V()}})}}});return new Response(W)}else throw new RI(`fetch for "${A.url}" responded with ${A.status}: ${A.statusText}`,A)}).then(A=>{switch(w){case"arraybuffer":return A.arrayBuffer();case"blob":return A.blob();case"document":return A.text().then(C=>new DOMParser().parseFromString(C,_));case"json":return A.json();default:if(_===void 0)return A.text();{const M=/charset="?([^;"\s]*)"?/i.exec(_),R=M&&M[1]?M[1].toLowerCase():void 0,F=new TextDecoder(R);return A.arrayBuffer().then(D=>F.decode(D))}}}).then(A=>{Ec.add(e,A);const C=Sl[e];delete Sl[e];for(let M=0,R=C.length;M<R;M++){const F=C[M];F.onLoad&&F.onLoad(A)}}).catch(A=>{const C=Sl[e];if(C===void 0)throw this.manager.itemError(e),A;delete Sl[e];for(let M=0,R=C.length;M<R;M++){const F=C[M];F.onError&&F.onError(A)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class DI extends so{constructor(e){super(e)}load(e,n,s,a){const c=this,m=new Ml(this.manager);m.setPath(this.path),m.setRequestHeader(this.requestHeader),m.setWithCredentials(this.withCredentials),m.load(e,function(g){try{n(c.parse(JSON.parse(g)))}catch(_){a?a(_):console.error(_),c.manager.itemError(e)}},s,a)}parse(e){const n=[];for(let s=0;s<e.length;s++){const a=lp.parse(e[s]);n.push(a)}return n}}class II extends so{constructor(e){super(e)}load(e,n,s,a){const c=this,m=[],g=new Fy,_=new Ml(this.manager);_.setPath(this.path),_.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setWithCredentials(c.withCredentials);let w=0;function A(C){_.load(e[C],function(M){const R=c.parse(M,!0);m[C]={width:R.width,height:R.height,format:R.format,mipmaps:R.mipmaps},w+=1,w===6&&(R.mipmapCount===1&&(g.minFilter=Ci),g.image=m,g.format=R.format,g.needsUpdate=!0,n&&n(g))},s,a)}if(Array.isArray(e))for(let C=0,M=e.length;C<M;++C)A(C);else _.load(e,function(C){const M=c.parse(C,!0);if(M.isCubemap){const R=M.mipmaps.length/M.mipmapCount;for(let F=0;F<R;F++){m[F]={mipmaps:[]};for(let D=0;D<M.mipmapCount;D++)m[F].mipmaps.push(M.mipmaps[F*M.mipmapCount+D]),m[F].format=M.format,m[F].width=M.width,m[F].height=M.height}g.image=m}else g.image.width=M.width,g.image.height=M.height,g.mipmaps=M.mipmaps;M.mipmapCount===1&&(g.minFilter=Ci),g.format=M.format,g.needsUpdate=!0,n&&n(g)},s,a);return g}}class cp extends so{constructor(e){super(e)}load(e,n,s,a,c){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const m=this,g=Ec.get(e);if(g!==void 0)return m.manager.itemStart(e),setTimeout(function(){n&&n(g),m.manager.itemEnd(e)},0),g;const _=wu("img");function w(){C(),Ec.add(e,this),n&&n(this),m.manager.itemEnd(e)}function A(M){C(),a&&a(M),m.manager.itemError(e),m.manager.itemEnd(e)}function C(){_.removeEventListener("load",w,!1),_.removeEventListener("error",A,!1)}return _.addEventListener("load",w,!1),_.addEventListener("error",A,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(_.crossOrigin=this.crossOrigin),m.manager.itemStart(e),c?(0,e_.hR)(c).then(M=>{_.src=M}):_.src=e,_}}class LI extends so{constructor(e){super(e)}load(e,n,s,a){const c=new _l,m=new cp(this.manager);m.setCrossOrigin(this.crossOrigin),m.setPath(this.path);let g=0;function _(w){m.load(e[w],function(A){c.images[w]=A,g++,g===6&&(c.needsUpdate=!0,n&&n(c))},void 0,a)}for(let w=0;w<e.length;++w)_(w);return c}}class OI extends so{constructor(e){super(e)}load(e,n,s,a,c){const m=this,g=new dd,_=new Ml(this.manager);return _.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setPath(this.path),_.setWithCredentials(m.withCredentials),_.load(e,function(w){const A=m.parse(w);A&&(A.image!==void 0?g.image=A.image:A.data!==void 0&&(g.image.width=A.width,g.image.height=A.height,g.image.data=A.data),g.wrapS=A.wrapS!==void 0?A.wrapS:Bi,g.wrapT=A.wrapT!==void 0?A.wrapT:Bi,g.magFilter=A.magFilter!==void 0?A.magFilter:Ci,g.minFilter=A.minFilter!==void 0?A.minFilter:Ci,g.anisotropy=A.anisotropy!==void 0?A.anisotropy:1,A.encoding!==void 0&&(g.encoding=A.encoding),A.flipY!==void 0&&(g.flipY=A.flipY),A.format!==void 0&&(g.format=A.format),A.type!==void 0&&(g.type=A.type),A.mipmaps!==void 0&&(g.mipmaps=A.mipmaps,g.minFilter=xo),A.mipmapCount===1&&(g.minFilter=Ci),A.generateMipmaps!==void 0&&(g.generateMipmaps=A.generateMipmaps),g.needsUpdate=!0,n&&n(g,A))},s,a,c),g}}class FI extends so{constructor(e){super(e)}load(e,n,s,a,c){const m=new ri,g=new cp(this.manager);return g.setCrossOrigin(this.crossOrigin),g.setPath(this.path),g.load(e,function(_){m.image=_,m.needsUpdate=!0,n!==void 0&&n(m)},s,a,c),m}}class Tc extends Gn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new Ut(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class oS extends Tc{constructor(e,n,s){super(e,s),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ut(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const t_=new Mn,aS=new le,lS=new le;class n_{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new it(512,512),this.map=null,this.mapPass=null,this.matrix=new Mn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new td,this._frameExtents=new it(1,1),this._viewportCount=1,this._viewports=[new Zn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,s=this.matrix;aS.setFromMatrixPosition(e.matrixWorld),n.position.copy(aS),lS.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(lS),n.updateMatrixWorld(),t_.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(t_),s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(t_)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class BI extends n_{constructor(){super(new Mr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,s=Qs*2*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,c=e.distance||n.far;(s!==n.fov||a!==n.aspect||c!==n.far)&&(n.fov=s,n.aspect=a,n.far=c,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class cS extends Tc{constructor(e,n,s=0,a=Math.PI/3,c=0,m=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.target=new Gn,this.distance=s,this.angle=a,this.penumbra=c,this.decay=m,this.map=null,this.shadow=new BI}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const uS=new Mn,up=new le,i_=new le;class kI extends n_{constructor(){super(new Mr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new it(4,2),this._viewportCount=6,this._viewports=[new Zn(2,1,1,1),new Zn(0,1,1,1),new Zn(3,1,1,1),new Zn(1,1,1,1),new Zn(3,0,1,1),new Zn(1,0,1,1)],this._cubeDirections=[new le(1,0,0),new le(-1,0,0),new le(0,0,1),new le(0,0,-1),new le(0,1,0),new le(0,-1,0)],this._cubeUps=[new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,0,1),new le(0,0,-1)]}updateMatrices(e,n=0){const s=this.camera,a=this.matrix,c=e.distance||s.far;c!==s.far&&(s.far=c,s.updateProjectionMatrix()),up.setFromMatrixPosition(e.matrixWorld),s.position.copy(up),i_.copy(s.position),i_.add(this._cubeDirections[n]),s.up.copy(this._cubeUps[n]),s.lookAt(i_),s.updateMatrixWorld(),a.makeTranslation(-up.x,-up.y,-up.z),uS.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(uS)}}class hS extends Tc{constructor(e,n,s=0,a=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=s,this.decay=a,this.shadow=new kI}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class UI extends n_{constructor(){super(new Ee(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dS extends Tc{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Gn.DEFAULT_UP),this.updateMatrix(),this.target=new Gn,this.shadow=new UI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class fS extends Tc{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class pS extends Tc{constructor(e,n,s=10,a=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=s,this.height=a}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class mS{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new le)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const s=e.x,a=e.y,c=e.z,m=this.coefficients;return n.copy(m[0]).multiplyScalar(.282095),n.addScaledVector(m[1],.488603*a),n.addScaledVector(m[2],.488603*c),n.addScaledVector(m[3],.488603*s),n.addScaledVector(m[4],1.092548*(s*a)),n.addScaledVector(m[5],1.092548*(a*c)),n.addScaledVector(m[6],.315392*(3*c*c-1)),n.addScaledVector(m[7],1.092548*(s*c)),n.addScaledVector(m[8],.546274*(s*s-a*a)),n}getIrradianceAt(e,n){const s=e.x,a=e.y,c=e.z,m=this.coefficients;return n.copy(m[0]).multiplyScalar(.886227),n.addScaledVector(m[1],2*.511664*a),n.addScaledVector(m[2],2*.511664*c),n.addScaledVector(m[3],2*.511664*s),n.addScaledVector(m[4],2*.429043*s*a),n.addScaledVector(m[5],2*.429043*a*c),n.addScaledVector(m[6],.743125*c*c-.247708),n.addScaledVector(m[7],2*.429043*s*c),n.addScaledVector(m[8],.429043*(s*s-a*a)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let s=0;s<9;s++)this.coefficients[s].addScaledVector(e.coefficients[s],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let s=0;s<9;s++)this.coefficients[s].lerp(e.coefficients[s],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const s=this.coefficients;for(let a=0;a<9;a++)s[a].fromArray(e,n+a*3);return this}toArray(e=[],n=0){const s=this.coefficients;for(let a=0;a<9;a++)s[a].toArray(e,n+a*3);return e}static getBasisAt(e,n){const s=e.x,a=e.y,c=e.z;n[0]=.282095,n[1]=.488603*a,n[2]=.488603*c,n[3]=.488603*s,n[4]=1.092548*s*a,n[5]=1.092548*a*c,n[6]=.315392*(3*c*c-1),n[7]=1.092548*s*c,n[8]=.546274*(s*s-a*a)}}class Ag extends Tc{constructor(e=new mS,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class Sg extends so{constructor(e){super(e),this.textures={}}load(e,n,s,a){const c=this,m=new Ml(c.manager);m.setPath(c.path),m.setRequestHeader(c.requestHeader),m.setWithCredentials(c.withCredentials),m.load(e,function(g){try{n(c.parse(JSON.parse(g)))}catch(_){a?a(_):console.error(_),c.manager.itemError(e)}},s,a)}parse(e){const n=this.textures;function s(c){return n[c]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",c),n[c]}const a=Sg.createMaterialFromType(e.type);if(e.uuid!==void 0&&(a.uuid=e.uuid),e.name!==void 0&&(a.name=e.name),e.color!==void 0&&a.color!==void 0&&a.color.setHex(e.color),e.roughness!==void 0&&(a.roughness=e.roughness),e.metalness!==void 0&&(a.metalness=e.metalness),e.sheen!==void 0&&(a.sheen=e.sheen),e.sheenColor!==void 0&&(a.sheenColor=new Ut().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(a.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&a.emissive!==void 0&&a.emissive.setHex(e.emissive),e.specular!==void 0&&a.specular!==void 0&&a.specular.setHex(e.specular),e.specularIntensity!==void 0&&(a.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&a.specularColor!==void 0&&a.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(a.shininess=e.shininess),e.clearcoat!==void 0&&(a.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(a.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(a.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(a.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(a.transmission=e.transmission),e.thickness!==void 0&&(a.thickness=e.thickness),e.attenuationDistance!==void 0&&(a.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&a.attenuationColor!==void 0&&a.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(a.fog=e.fog),e.flatShading!==void 0&&(a.flatShading=e.flatShading),e.blending!==void 0&&(a.blending=e.blending),e.combine!==void 0&&(a.combine=e.combine),e.side!==void 0&&(a.side=e.side),e.shadowSide!==void 0&&(a.shadowSide=e.shadowSide),e.opacity!==void 0&&(a.opacity=e.opacity),e.transparent!==void 0&&(a.transparent=e.transparent),e.alphaTest!==void 0&&(a.alphaTest=e.alphaTest),e.depthTest!==void 0&&(a.depthTest=e.depthTest),e.depthWrite!==void 0&&(a.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(a.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(a.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(a.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(a.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(a.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(a.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(a.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(a.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(a.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(a.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(a.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(a.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(a.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(a.rotation=e.rotation),e.linewidth!==1&&(a.linewidth=e.linewidth),e.dashSize!==void 0&&(a.dashSize=e.dashSize),e.gapSize!==void 0&&(a.gapSize=e.gapSize),e.scale!==void 0&&(a.scale=e.scale),e.polygonOffset!==void 0&&(a.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(a.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(a.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(a.dithering=e.dithering),e.alphaToCoverage!==void 0&&(a.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(a.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(a.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(a.visible=e.visible),e.toneMapped!==void 0&&(a.toneMapped=e.toneMapped),e.userData!==void 0&&(a.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?a.vertexColors=e.vertexColors>0:a.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const c in e.uniforms){const m=e.uniforms[c];switch(a.uniforms[c]={},m.type){case"t":a.uniforms[c].value=s(m.value);break;case"c":a.uniforms[c].value=new Ut().setHex(m.value);break;case"v2":a.uniforms[c].value=new it().fromArray(m.value);break;case"v3":a.uniforms[c].value=new le().fromArray(m.value);break;case"v4":a.uniforms[c].value=new Zn().fromArray(m.value);break;case"m3":a.uniforms[c].value=new Ar().fromArray(m.value);break;case"m4":a.uniforms[c].value=new Mn().fromArray(m.value);break;default:a.uniforms[c].value=m.value}}if(e.defines!==void 0&&(a.defines=e.defines),e.vertexShader!==void 0&&(a.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(a.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(a.glslVersion=e.glslVersion),e.extensions!==void 0)for(const c in e.extensions)a.extensions[c]=e.extensions[c];if(e.size!==void 0&&(a.size=e.size),e.sizeAttenuation!==void 0&&(a.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(a.map=s(e.map)),e.matcap!==void 0&&(a.matcap=s(e.matcap)),e.alphaMap!==void 0&&(a.alphaMap=s(e.alphaMap)),e.bumpMap!==void 0&&(a.bumpMap=s(e.bumpMap)),e.bumpScale!==void 0&&(a.bumpScale=e.bumpScale),e.normalMap!==void 0&&(a.normalMap=s(e.normalMap)),e.normalMapType!==void 0&&(a.normalMapType=e.normalMapType),e.normalScale!==void 0){let c=e.normalScale;Array.isArray(c)===!1&&(c=[c,c]),a.normalScale=new it().fromArray(c)}return e.displacementMap!==void 0&&(a.displacementMap=s(e.displacementMap)),e.displacementScale!==void 0&&(a.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(a.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(a.roughnessMap=s(e.roughnessMap)),e.metalnessMap!==void 0&&(a.metalnessMap=s(e.metalnessMap)),e.emissiveMap!==void 0&&(a.emissiveMap=s(e.emissiveMap)),e.emissiveIntensity!==void 0&&(a.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(a.specularMap=s(e.specularMap)),e.specularIntensityMap!==void 0&&(a.specularIntensityMap=s(e.specularIntensityMap)),e.specularColorMap!==void 0&&(a.specularColorMap=s(e.specularColorMap)),e.envMap!==void 0&&(a.envMap=s(e.envMap)),e.envMapIntensity!==void 0&&(a.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(a.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(a.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(a.lightMap=s(e.lightMap)),e.lightMapIntensity!==void 0&&(a.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(a.aoMap=s(e.aoMap)),e.aoMapIntensity!==void 0&&(a.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(a.gradientMap=s(e.gradientMap)),e.clearcoatMap!==void 0&&(a.clearcoatMap=s(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(a.clearcoatRoughnessMap=s(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(a.clearcoatNormalMap=s(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(a.clearcoatNormalScale=new it().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(a.iridescenceMap=s(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(a.iridescenceThicknessMap=s(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(a.transmissionMap=s(e.transmissionMap)),e.thicknessMap!==void 0&&(a.thicknessMap=s(e.thicknessMap)),e.sheenColorMap!==void 0&&(a.sheenColorMap=s(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(a.sheenRoughnessMap=s(e.sheenRoughnessMap)),a}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:XA,SpriteMaterial:Py,RawShaderMaterial:YA,ShaderMaterial:no,PointsMaterial:Ly,MeshPhysicalMaterial:QA,MeshStandardMaterial:Yy,MeshPhongMaterial:KA,MeshToonMaterial:qA,MeshNormalMaterial:ZA,MeshLambertMaterial:JA,MeshDepthMaterial:My,MeshDistanceMaterial:Ey,MeshBasicMaterial:Ua,MeshMatcapMaterial:$A,LineDashedMaterial:eS,LineBasicMaterial:Es,Material:Ir};return new n[e]}}class r_{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let s=0,a=e.length;s<a;s++)n+=String.fromCharCode(e[s]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class gS extends Rn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class vS extends so{constructor(e){super(e)}load(e,n,s,a){const c=this,m=new Ml(c.manager);m.setPath(c.path),m.setRequestHeader(c.requestHeader),m.setWithCredentials(c.withCredentials),m.load(e,function(g){try{n(c.parse(JSON.parse(g)))}catch(_){a?a(_):console.error(_),c.manager.itemError(e)}},s,a)}parse(e){const n={},s={};function a(R,F){if(n[F]!==void 0)return n[F];const O=R.interleavedBuffers[F],W=c(R,O.buffer),K=Eo(O.type,W),V=new rg(K,O.stride);return V.uuid=O.uuid,n[F]=V,V}function c(R,F){if(s[F]!==void 0)return s[F];const O=R.arrayBuffers[F],W=new Uint32Array(O).buffer;return s[F]=W,W}const m=e.isInstancedBufferGeometry?new gS:new Rn,g=e.data.index;if(g!==void 0){const R=Eo(g.type,g.array);m.setIndex(new ci(R,1))}const _=e.data.attributes;for(const R in _){const F=_[R];let D;if(F.isInterleavedBufferAttribute){const O=a(e.data,F.data);D=new ku(O,F.itemSize,F.offset,F.normalized)}else{const O=Eo(F.type,F.array),W=F.isInstancedBufferAttribute?fd:ci;D=new W(O,F.itemSize,F.normalized)}F.name!==void 0&&(D.name=F.name),F.usage!==void 0&&D.setUsage(F.usage),F.updateRange!==void 0&&(D.updateRange.offset=F.updateRange.offset,D.updateRange.count=F.updateRange.count),m.setAttribute(R,D)}const w=e.data.morphAttributes;if(w)for(const R in w){const F=w[R],D=[];for(let O=0,W=F.length;O<W;O++){const K=F[O];let V;if(K.isInterleavedBufferAttribute){const Y=a(e.data,K.data);V=new ku(Y,K.itemSize,K.offset,K.normalized)}else{const Y=Eo(K.type,K.array);V=new ci(Y,K.itemSize,K.normalized)}K.name!==void 0&&(V.name=K.name),D.push(V)}m.morphAttributes[R]=D}e.data.morphTargetsRelative&&(m.morphTargetsRelative=!0);const C=e.data.groups||e.data.drawcalls||e.data.offsets;if(C!==void 0)for(let R=0,F=C.length;R!==F;++R){const D=C[R];m.addGroup(D.start,D.count,D.materialIndex)}const M=e.data.boundingSphere;if(M!==void 0){const R=new le;M.center!==void 0&&R.fromArray(M.center),m.boundingSphere=new ml(R,M.radius)}return e.name&&(m.name=e.name),e.userData&&(m.userData=e.userData),m}}class NI extends so{constructor(e){super(e)}load(e,n,s,a){const c=this,m=this.path===""?r_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||m;const g=new Ml(this.manager);g.setPath(this.path),g.setRequestHeader(this.requestHeader),g.setWithCredentials(this.withCredentials),g.load(e,function(_){let w=null;try{w=JSON.parse(_)}catch(C){a!==void 0&&a(C),console.error("THREE:ObjectLoader: Can't parse "+e+".",C.message);return}const A=w.metadata;if(A===void 0||A.type===void 0||A.type.toLowerCase()==="geometry"){a!==void 0&&a(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}c.parse(w,n)},s,a)}async loadAsync(e,n){const s=this,a=this.path===""?r_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const c=new Ml(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials);const m=await c.loadAsync(e,n),g=JSON.parse(m),_=g.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await s.parseAsync(g)}parse(e,n){const s=this.parseAnimations(e.animations),a=this.parseShapes(e.shapes),c=this.parseGeometries(e.geometries,a),m=this.parseImages(e.images,function(){n!==void 0&&n(w)}),g=this.parseTextures(e.textures,m),_=this.parseMaterials(e.materials,g),w=this.parseObject(e.object,c,_,g,s),A=this.parseSkeletons(e.skeletons,w);if(this.bindSkeletons(w,A),n!==void 0){let C=!1;for(const M in m)if(m[M].data instanceof HTMLImageElement){C=!0;break}C===!1&&n(w)}return w}async parseAsync(e){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,s),c=await this.parseImagesAsync(e.images),m=this.parseTextures(e.textures,c),g=this.parseMaterials(e.materials,m),_=this.parseObject(e.object,a,g,m,n),w=this.parseSkeletons(e.skeletons,_);return this.bindSkeletons(_,w),_}parseShapes(e){const n={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const c=new Nu().fromJSON(e[s]);n[c.uuid]=c}return n}parseSkeletons(e,n){const s={},a={};if(n.traverse(function(c){c.isBone&&(a[c.uuid]=c)}),e!==void 0)for(let c=0,m=e.length;c<m;c++){const g=new cg().fromJSON(e[c],a);s[g.uuid]=g}return s}parseGeometries(e,n){const s={};if(e!==void 0){const a=new vS;for(let c=0,m=e.length;c<m;c++){let g;const _=e[c];switch(_.type){case"BufferGeometry":case"InstancedBufferGeometry":g=a.parse(_);break;default:_.type in p?g=p[_.type].fromJSON(_,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${_.type}"`)}g.uuid=_.uuid,_.name!==void 0&&(g.name=_.name),_.userData!==void 0&&(g.userData=_.userData),s[_.uuid]=g}}return s}parseMaterials(e,n){const s={},a={};if(e!==void 0){const c=new Sg;c.setTextures(n);for(let m=0,g=e.length;m<g;m++){const _=e[m];s[_.uuid]===void 0&&(s[_.uuid]=c.parse(_)),a[_.uuid]=s[_.uuid]}}return a}parseAnimations(e){const n={};if(e!==void 0)for(let s=0;s<e.length;s++){const a=e[s],c=lp.parse(a);n[c.uuid]=c}return n}parseImages(e,n){const s=this,a={};let c;function m(_){return s.manager.itemStart(_),c.load(_,function(){s.manager.itemEnd(_)},void 0,function(){s.manager.itemError(_),s.manager.itemEnd(_)})}function g(_){if(typeof _=="string"){const w=_,A=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:s.resourcePath+w;return m(A)}else return _.data?{data:Eo(_.type,_.data),width:_.width,height:_.height}:null}if(e!==void 0&&e.length>0){const _=new $y(n);c=new cp(_),c.setCrossOrigin(this.crossOrigin);for(let w=0,A=e.length;w<A;w++){const C=e[w],M=C.url;if(Array.isArray(M)){const R=[];for(let F=0,D=M.length;F<D;F++){const O=M[F],W=g(O);W!==null&&(W instanceof HTMLImageElement?R.push(W):R.push(new dd(W.data,W.width,W.height)))}a[C.uuid]=new Da(R)}else{const R=g(C.url);a[C.uuid]=new Da(R)}}}return a}async parseImagesAsync(e){const n=this,s={};let a;async function c(m){if(typeof m=="string"){const g=m,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(g)?g:n.resourcePath+g;return await a.loadAsync(_)}else return m.data?{data:Eo(m.type,m.data),width:m.width,height:m.height}:null}if(e!==void 0&&e.length>0){a=new cp(this.manager),a.setCrossOrigin(this.crossOrigin);for(let m=0,g=e.length;m<g;m++){const _=e[m],w=_.url;if(Array.isArray(w)){const A=[];for(let C=0,M=w.length;C<M;C++){const R=w[C],F=await c(R);F!==null&&(F instanceof HTMLImageElement?A.push(F):A.push(new dd(F.data,F.width,F.height)))}s[_.uuid]=new Da(A)}else{const A=await c(_.url);s[_.uuid]=new Da(A)}}}return s}parseTextures(e,n){function s(c,m){return typeof c=="number"?c:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",c),m[c])}const a={};if(e!==void 0)for(let c=0,m=e.length;c<m;c++){const g=e[c];g.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid),n[g.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",g.image);const _=n[g.image],w=_.data;let A;Array.isArray(w)?(A=new _l,w.length===6&&(A.needsUpdate=!0)):(w&&w.data?A=new dd:A=new ri,w&&(A.needsUpdate=!0)),A.source=_,A.uuid=g.uuid,g.name!==void 0&&(A.name=g.name),g.mapping!==void 0&&(A.mapping=s(g.mapping,zI)),g.offset!==void 0&&A.offset.fromArray(g.offset),g.repeat!==void 0&&A.repeat.fromArray(g.repeat),g.center!==void 0&&A.center.fromArray(g.center),g.rotation!==void 0&&(A.rotation=g.rotation),g.wrap!==void 0&&(A.wrapS=s(g.wrap[0],yS),A.wrapT=s(g.wrap[1],yS)),g.format!==void 0&&(A.format=g.format),g.internalFormat!==void 0&&(A.internalFormat=g.internalFormat),g.type!==void 0&&(A.type=g.type),g.encoding!==void 0&&(A.encoding=g.encoding),g.minFilter!==void 0&&(A.minFilter=s(g.minFilter,_S)),g.magFilter!==void 0&&(A.magFilter=s(g.magFilter,_S)),g.anisotropy!==void 0&&(A.anisotropy=g.anisotropy),g.flipY!==void 0&&(A.flipY=g.flipY),g.generateMipmaps!==void 0&&(A.generateMipmaps=g.generateMipmaps),g.premultiplyAlpha!==void 0&&(A.premultiplyAlpha=g.premultiplyAlpha),g.unpackAlignment!==void 0&&(A.unpackAlignment=g.unpackAlignment),g.userData!==void 0&&(A.userData=g.userData),a[g.uuid]=A}return a}parseObject(e,n,s,a,c){let m;function g(M){return n[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",M),n[M]}function _(M){if(M!==void 0){if(Array.isArray(M)){const R=[];for(let F=0,D=M.length;F<D;F++){const O=M[F];s[O]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",O),R.push(s[O])}return R}return s[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),s[M]}}function w(M){return a[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",M),a[M]}let A,C;switch(e.type){case"Scene":m=new oA,e.background!==void 0&&(Number.isInteger(e.background)?m.background=new Ut(e.background):m.background=w(e.background)),e.environment!==void 0&&(m.environment=w(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?m.fog=new ig(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(m.fog=new ng(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(m.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(m.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":m=new Mr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(m.focus=e.focus),e.zoom!==void 0&&(m.zoom=e.zoom),e.filmGauge!==void 0&&(m.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(m.filmOffset=e.filmOffset),e.view!==void 0&&(m.view=Object.assign({},e.view));break;case"OrthographicCamera":m=new Ee(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(m.zoom=e.zoom),e.view!==void 0&&(m.view=Object.assign({},e.view));break;case"AmbientLight":m=new fS(e.color,e.intensity);break;case"DirectionalLight":m=new dS(e.color,e.intensity);break;case"PointLight":m=new hS(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":m=new pS(e.color,e.intensity,e.width,e.height);break;case"SpotLight":m=new cS(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":m=new oS(e.color,e.groundColor,e.intensity);break;case"LightProbe":m=new Ag().fromJSON(e);break;case"SkinnedMesh":A=g(e.geometry),C=_(e.material),m=new vA(A,C),e.bindMode!==void 0&&(m.bindMode=e.bindMode),e.bindMatrix!==void 0&&m.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(m.skeleton=e.skeleton);break;case"Mesh":A=g(e.geometry),C=_(e.material),m=new ur(A,C);break;case"InstancedMesh":A=g(e.geometry),C=_(e.material);const M=e.count,R=e.instanceMatrix,F=e.instanceColor;m=new bA(A,C,M),m.instanceMatrix=new fd(new Float32Array(R.array),16),F!==void 0&&(m.instanceColor=new fd(new Float32Array(F.array),F.itemSize));break;case"LOD":m=new dA;break;case"Line":m=new Mc(g(e.geometry),_(e.material));break;case"LineLoop":m=new TA(g(e.geometry),_(e.material));break;case"LineSegments":m=new Xa(g(e.geometry),_(e.material));break;case"PointCloud":case"Points":m=new PA(g(e.geometry),_(e.material));break;case"Sprite":m=new uA(_(e.material));break;case"Group":m=new ad;break;case"Bone":m=new Dy;break;default:m=new Gn}if(m.uuid=e.uuid,e.name!==void 0&&(m.name=e.name),e.matrix!==void 0?(m.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(m.matrixAutoUpdate=e.matrixAutoUpdate),m.matrixAutoUpdate&&m.matrix.decompose(m.position,m.quaternion,m.scale)):(e.position!==void 0&&m.position.fromArray(e.position),e.rotation!==void 0&&m.rotation.fromArray(e.rotation),e.quaternion!==void 0&&m.quaternion.fromArray(e.quaternion),e.scale!==void 0&&m.scale.fromArray(e.scale)),e.castShadow!==void 0&&(m.castShadow=e.castShadow),e.receiveShadow!==void 0&&(m.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(m.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(m.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(m.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&m.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(m.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(m.visible=e.visible),e.frustumCulled!==void 0&&(m.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(m.renderOrder=e.renderOrder),e.userData!==void 0&&(m.userData=e.userData),e.layers!==void 0&&(m.layers.mask=e.layers),e.children!==void 0){const M=e.children;for(let R=0;R<M.length;R++)m.add(this.parseObject(M[R],n,s,a,c))}if(e.animations!==void 0){const M=e.animations;for(let R=0;R<M.length;R++){const F=M[R];m.animations.push(c[F])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(m.autoUpdate=e.autoUpdate);const M=e.levels;for(let R=0;R<M.length;R++){const F=M[R],D=m.getObjectByProperty("uuid",F.object);D!==void 0&&m.addLevel(D,F.distance,F.hysteresis)}}return m}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(s){if(s.isSkinnedMesh===!0&&s.skeleton!==void 0){const a=n[s.skeleton];a===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",s.skeleton):s.bind(a,s.bindMatrix)}})}}const zI={UVMapping:Kl,CubeReflectionMapping:yo,CubeRefractionMapping:_o,EquirectangularReflectionMapping:Ho,EquirectangularRefractionMapping:zn,CubeUVReflectionMapping:yr},yS={RepeatWrapping:Vs,ClampToEdgeWrapping:Bi,MirroredRepeatWrapping:wa},_S={NearestFilter:Ti,NearestMipmapNearestFilter:ql,NearestMipmapLinearFilter:_r,LinearFilter:Ci,LinearMipmapNearestFilter:cu,LinearMipmapLinearFilter:xo};class GI extends so{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,s,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,m=Ec.get(e);if(m!==void 0)return c.manager.itemStart(e),setTimeout(function(){n&&n(m),c.manager.itemEnd(e)},0),m;const g={};g.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",g.headers=this.requestHeader,fetch(e,g).then(function(_){return _.blob()}).then(function(_){return createImageBitmap(_,Object.assign(c.options,{colorSpaceConversion:"none"}))}).then(function(_){Ec.add(e,_),n&&n(_),c.manager.itemEnd(e)}).catch(function(_){a&&a(_),c.manager.itemError(e),c.manager.itemEnd(e)}),c.manager.itemStart(e)}}let Mg;class s_{static getContext(){return Mg===void 0&&(Mg=new(window.AudioContext||window.webkitAudioContext)),Mg}static setContext(e){Mg=e}}class HI extends so{constructor(e){super(e)}load(e,n,s,a,c){const m=this,g=new Ml(this.manager);g.setResponseType("arraybuffer"),g.setPath(this.path),g.setRequestHeader(this.requestHeader),g.setWithCredentials(this.withCredentials),g.load(e,function(_){try{const w=_.slice(0);s_.getContext().decodeAudioData(w,function(C){n(C)})}catch(w){a?a(w):console.error(w),m.manager.itemError(e)}},s,a,c==null?void 0:c.mainFile)}}class VI extends Ag{constructor(e,n,s=1){super(void 0,s),this.isHemisphereLightProbe=!0;const a=new Ut().set(e),c=new Ut().set(n),m=new le(a.r,a.g,a.b),g=new le(c.r,c.g,c.b),_=Math.sqrt(Math.PI),w=_*Math.sqrt(.75);this.sh.coefficients[0].copy(m).add(g).multiplyScalar(_),this.sh.coefficients[1].copy(m).sub(g).multiplyScalar(w)}}class WI extends Ag{constructor(e,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const s=new Ut().set(e);this.sh.coefficients[0].set(s.r,s.g,s.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const xS=new Mn,bS=new Mn,Wu=new Mn;class jI{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Mr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Mr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Wu.copy(e.projectionMatrix);const a=n.eyeSep/2,c=a*n.near/n.focus,m=n.near*Math.tan(ul*n.fov*.5)/n.zoom;let g,_;bS.elements[12]=-a,xS.elements[12]=a,g=-m*n.aspect+c,_=m*n.aspect+c,Wu.elements[0]=2*n.near/(_-g),Wu.elements[8]=(_+g)/(_-g),this.cameraL.projectionMatrix.copy(Wu),g=-m*n.aspect-c,_=m*n.aspect-c,Wu.elements[0]=2*n.near/(_-g),Wu.elements[8]=(_+g)/(_-g),this.cameraR.projectionMatrix.copy(Wu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(bS),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(xS)}}class wS{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=AS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=AS();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function AS(){return(typeof performance>"u"?Date:performance).now()}const ju=new le,SS=new Vr,XI=new le,Xu=new le;class YI extends Gn{constructor(){super(),this.type="AudioListener",this.context=s_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new wS}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,s=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ju,SS,XI),Xu.set(0,0,-1).applyQuaternion(SS),n.positionX){const a=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(ju.x,a),n.positionY.linearRampToValueAtTime(ju.y,a),n.positionZ.linearRampToValueAtTime(ju.z,a),n.forwardX.linearRampToValueAtTime(Xu.x,a),n.forwardY.linearRampToValueAtTime(Xu.y,a),n.forwardZ.linearRampToValueAtTime(Xu.z,a),n.upX.linearRampToValueAtTime(s.x,a),n.upY.linearRampToValueAtTime(s.y,a),n.upZ.linearRampToValueAtTime(s.z,a)}else n.setPosition(ju.x,ju.y,ju.z),n.setOrientation(Xu.x,Xu.y,Xu.z,s.x,s.y,s.z)}}class MS extends Gn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Yu=new le,ES=new Vr,QI=new le,Qu=new le;class KI extends MS{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,s){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=s,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Yu,ES,QI),Qu.set(0,0,1).applyQuaternion(ES);const n=this.panner;if(n.positionX){const s=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Yu.x,s),n.positionY.linearRampToValueAtTime(Yu.y,s),n.positionZ.linearRampToValueAtTime(Yu.z,s),n.orientationX.linearRampToValueAtTime(Qu.x,s),n.orientationY.linearRampToValueAtTime(Qu.y,s),n.orientationZ.linearRampToValueAtTime(Qu.z,s)}else n.setPosition(Yu.x,Yu.y,Yu.z),n.setOrientation(Qu.x,Qu.y,Qu.z)}}class qI{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let s=0;s<n.length;s++)e+=n[s];return e/n.length}}class TS{constructor(e,n,s){this.binding=e,this.valueSize=s;let a,c,m;switch(n){case"quaternion":a=this._slerp,c=this._slerpAdditive,m=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(s*6),this._workIndex=5;break;case"string":case"bool":a=this._select,c=this._select,m=this._setAdditiveIdentityOther,this.buffer=new Array(s*5);break;default:a=this._lerp,c=this._lerpAdditive,m=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(s*5)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=c,this._setIdentity=m,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const s=this.buffer,a=this.valueSize,c=e*a+a;let m=this.cumulativeWeight;if(m===0){for(let g=0;g!==a;++g)s[c+g]=s[g];m=n}else{m+=n;const g=n/m;this._mixBufferRegion(s,c,0,g,a)}this.cumulativeWeight=m}accumulateAdditive(e){const n=this.buffer,s=this.valueSize,a=s*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,a,0,e,s),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,s=this.buffer,a=e*n+n,c=this.cumulativeWeight,m=this.cumulativeWeightAdditive,g=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,c<1){const _=n*this._origIndex;this._mixBufferRegion(s,a,_,1-c,n)}m>0&&this._mixBufferRegionAdditive(s,a,this._addIndex*n,1,n);for(let _=n,w=n+n;_!==w;++_)if(s[_]!==s[_+n]){g.setValue(s,a);break}}saveOriginalState(){const e=this.binding,n=this.buffer,s=this.valueSize,a=s*this._origIndex;e.getValue(n,a);for(let c=s,m=a;c!==m;++c)n[c]=n[a+c%s];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let s=e;s<n;s++)this.buffer[s]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let s=0;s<this.valueSize;s++)this.buffer[n+s]=this.buffer[e+s]}_select(e,n,s,a,c){if(a>=.5)for(let m=0;m!==c;++m)e[n+m]=e[s+m]}_slerp(e,n,s,a){Vr.slerpFlat(e,n,e,n,e,s,a)}_slerpAdditive(e,n,s,a,c){const m=this._workIndex*c;Vr.multiplyQuaternionsFlat(e,m,e,n,e,s),Vr.slerpFlat(e,n,e,n,e,m,a)}_lerp(e,n,s,a,c){const m=1-a;for(let g=0;g!==c;++g){const _=n+g;e[_]=e[_]*m+e[s+g]*a}}_lerpAdditive(e,n,s,a,c){for(let m=0;m!==c;++m){const g=n+m;e[g]=e[g]+e[s+m]*a}}}const o_="\\[\\]\\.:\\/",ZI=new RegExp("["+o_+"]","g"),a_="[^"+o_+"]",JI="[^"+o_.replace("\\.","")+"]",$I=/((?:WC+[\/:])*)/.source.replace("WC",a_),eL=/(WCOD+)?/.source.replace("WCOD",JI),tL=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",a_),nL=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",a_),iL=new RegExp("^"+$I+eL+tL+nL+"$"),rL=["material","materials","bones","map"];class sL{constructor(e,n,s){const a=s||Xn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,a)}getValue(e,n){this.bind();const s=this._targetGroup.nCachedObjects_,a=this._bindings[s];a!==void 0&&a.getValue(e,n)}setValue(e,n){const s=this._bindings;for(let a=this._targetGroup.nCachedObjects_,c=s.length;a!==c;++a)s[a].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=e.length;n!==s;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=e.length;n!==s;++n)e[n].unbind()}}class Xn{constructor(e,n,s){this.path=n,this.parsedPath=s||Xn.parseTrackName(n),this.node=Xn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,s){return e&&e.isAnimationObjectGroup?new Xn.Composite(e,n,s):new Xn(e,n,s)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(ZI,"")}static parseTrackName(e){const n=iL.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const s={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},a=s.nodeName&&s.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){const c=s.nodeName.substring(a+1);rL.indexOf(c)!==-1&&(s.nodeName=s.nodeName.substring(0,a),s.objectName=c)}if(s.propertyName===null||s.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return s}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const s=e.skeleton.getBoneByName(n);if(s!==void 0)return s}if(e.children){const s=function(c){for(let m=0;m<c.length;m++){const g=c[m];if(g.name===n||g.uuid===n)return g;const _=s(g.children);if(_)return _}return null},a=s(e.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)e[n++]=s[a]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const s=this.resolvedProperty;for(let a=0,c=s.length;a!==c;++a)s[a]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,s=n.objectName,a=n.propertyName;let c=n.propertyIndex;if(e||(e=Xn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(s){let w=n.objectIndex;switch(s){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let A=0;A<e.length;A++)if(e[A].name===w){w=A;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[s]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[s]}if(w!==void 0){if(e[w]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[w]}}const m=e[a];if(m===void 0){const w=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+w+"."+a+" but it wasn't found.",e);return}let g=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?g=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(g=this.Versioning.MatrixWorldNeedsUpdate);let _=this.BindingType.Direct;if(c!==void 0){if(a==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[c]!==void 0&&(c=e.morphTargetDictionary[c])}_=this.BindingType.ArrayElement,this.resolvedProperty=m,this.propertyIndex=c}else m.fromArray!==void 0&&m.toArray!==void 0?(_=this.BindingType.HasFromToArray,this.resolvedProperty=m):Array.isArray(m)?(_=this.BindingType.EntireArray,this.resolvedProperty=m):this.propertyName=a;this.getValue=this.GetterByBindingType[_],this.setValue=this.SetterByBindingTypeAndVersioning[_][g]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xn.Composite=sL,Xn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xn.prototype.GetterByBindingType=[Xn.prototype._getValue_direct,Xn.prototype._getValue_array,Xn.prototype._getValue_arrayElement,Xn.prototype._getValue_toArray],Xn.prototype.SetterByBindingTypeAndVersioning=[[Xn.prototype._setValue_direct,Xn.prototype._setValue_direct_setNeedsUpdate,Xn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xn.prototype._setValue_array,Xn.prototype._setValue_array_setNeedsUpdate,Xn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xn.prototype._setValue_arrayElement,Xn.prototype._setValue_arrayElement_setNeedsUpdate,Xn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xn.prototype._setValue_fromArray,Xn.prototype._setValue_fromArray_setNeedsUpdate,Xn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class oL{constructor(){this.isAnimationObjectGroup=!0,this.uuid=vs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let s=0,a=arguments.length;s!==a;++s)e[arguments[s].uuid]=s;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,s=this._paths,a=this._parsedPaths,c=this._bindings,m=c.length;let g,_=e.length,w=this.nCachedObjects_;for(let A=0,C=arguments.length;A!==C;++A){const M=arguments[A],R=M.uuid;let F=n[R];if(F===void 0){F=_++,n[R]=F,e.push(M);for(let D=0,O=m;D!==O;++D)c[D].push(new Xn(M,s[D],a[D]))}else if(F<w){g=e[F];const D=--w,O=e[D];n[O.uuid]=F,e[F]=O,n[R]=D,e[D]=M;for(let W=0,K=m;W!==K;++W){const V=c[W],Y=V[D];let se=V[F];V[F]=Y,se===void 0&&(se=new Xn(M,s[W],a[W])),V[D]=se}}else e[F]!==g&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=w}remove(){const e=this._objects,n=this._indicesByUUID,s=this._bindings,a=s.length;let c=this.nCachedObjects_;for(let m=0,g=arguments.length;m!==g;++m){const _=arguments[m],w=_.uuid,A=n[w];if(A!==void 0&&A>=c){const C=c++,M=e[C];n[M.uuid]=A,e[A]=M,n[w]=C,e[C]=_;for(let R=0,F=a;R!==F;++R){const D=s[R],O=D[C],W=D[A];D[A]=O,D[C]=W}}}this.nCachedObjects_=c}uncache(){const e=this._objects,n=this._indicesByUUID,s=this._bindings,a=s.length;let c=this.nCachedObjects_,m=e.length;for(let g=0,_=arguments.length;g!==_;++g){const w=arguments[g],A=w.uuid,C=n[A];if(C!==void 0)if(delete n[A],C<c){const M=--c,R=e[M],F=--m,D=e[F];n[R.uuid]=C,e[C]=R,n[D.uuid]=M,e[M]=D,e.pop();for(let O=0,W=a;O!==W;++O){const K=s[O],V=K[M],Y=K[F];K[C]=V,K[M]=Y,K.pop()}}else{const M=--m,R=e[M];M>0&&(n[R.uuid]=C),e[C]=R,e.pop();for(let F=0,D=a;F!==D;++F){const O=s[F];O[C]=O[M],O.pop()}}}this.nCachedObjects_=c}subscribe_(e,n){const s=this._bindingsIndicesByPath;let a=s[e];const c=this._bindings;if(a!==void 0)return c[a];const m=this._paths,g=this._parsedPaths,_=this._objects,w=_.length,A=this.nCachedObjects_,C=new Array(w);a=c.length,s[e]=a,m.push(e),g.push(n),c.push(C);for(let M=A,R=_.length;M!==R;++M){const F=_[M];C[M]=new Xn(F,e,n)}return C}unsubscribe_(e){const n=this._bindingsIndicesByPath,s=n[e];if(s!==void 0){const a=this._paths,c=this._parsedPaths,m=this._bindings,g=m.length-1,_=m[g],w=e[g];n[w]=s,m[s]=_,m.pop(),c[s]=c[g],c.pop(),a[s]=a[g],a.pop()}}}class aL{constructor(e,n,s=null,a=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=s,this.blendMode=a;const c=n.tracks,m=c.length,g=new Array(m),_={endingStart:_i,endingEnd:_i};for(let w=0;w!==m;++w){const A=c[w].createInterpolant(null);g[w]=A,A.settings=_}this._interpolantSettings=_,this._interpolants=g,this._propertyBindings=new Array(m),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,s){if(e.fadeOut(n),this.fadeIn(n),s){const a=this._clip.duration,c=e._clip.duration,m=c/a,g=a/c;e.warp(1,m,n),this.warp(g,1,n)}return this}crossFadeTo(e,n,s){return e.crossFadeFrom(this,n,s)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,s){const a=this._mixer,c=a.time,m=this.timeScale;let g=this._timeScaleInterpolant;g===null&&(g=a._lendControlInterpolant(),this._timeScaleInterpolant=g);const _=g.parameterPositions,w=g.sampleValues;return _[0]=c,_[1]=c+s,w[0]=e/m,w[1]=n/m,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,s,a){if(!this.enabled){this._updateWeight(e);return}const c=this._startTime;if(c!==null){const _=(e-c)*s;_<0||s===0?n=0:(this._startTime=null,n=s*_)}n*=this._updateTimeScale(e);const m=this._updateTime(n),g=this._updateWeight(e);if(g>0){const _=this._interpolants,w=this._propertyBindings;switch(this.blendMode){case br:for(let A=0,C=_.length;A!==C;++A)_[A].evaluate(m),w[A].accumulateAdditive(g);break;case Ki:default:for(let A=0,C=_.length;A!==C;++A)_[A].evaluate(m),w[A].accumulate(a,g)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const s=this._weightInterpolant;if(s!==null){const a=s.evaluate(e)[0];n*=a,e>s.parameterPositions[1]&&(this.stopFading(),a===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const s=this._timeScaleInterpolant;if(s!==null){const a=s.evaluate(e)[0];n*=a,e>s.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,s=this.loop;let a=this.time+e,c=this._loopCount;const m=s===Ot;if(e===0)return c===-1?a:m&&(c&1)===1?n-a:a;if(s===Cn){c===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=n)a=n;else if(a<0)a=0;else{this.time=a;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(c===-1&&(e>=0?(c=0,this._setEndings(!0,this.repetitions===0,m)):this._setEndings(this.repetitions===0,!0,m)),a>=n||a<0){const g=Math.floor(a/n);a-=n*g,c+=Math.abs(g);const _=this.repetitions-c;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=e>0?n:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(_===1){const w=e<0;this._setEndings(w,!w,m)}else this._setEndings(!1,!1,m);this._loopCount=c,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:g})}}else this.time=a;if(m&&(c&1)===1)return n-a}return a}_setEndings(e,n,s){const a=this._interpolantSettings;s?(a.endingStart=Xs,a.endingEnd=Xs):(e?a.endingStart=this.zeroSlopeAtStart?Xs:_i:a.endingStart=So,n?a.endingEnd=this.zeroSlopeAtEnd?Xs:_i:a.endingEnd=So)}_scheduleFading(e,n,s){const a=this._mixer,c=a.time;let m=this._weightInterpolant;m===null&&(m=a._lendControlInterpolant(),this._weightInterpolant=m);const g=m.parameterPositions,_=m.sampleValues;return g[0]=c,_[0]=n,g[1]=c+e,_[1]=s,this}}const lL=new Float32Array(1);class cL extends Ko{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const s=e._localRoot||this._root,a=e._clip.tracks,c=a.length,m=e._propertyBindings,g=e._interpolants,_=s.uuid,w=this._bindingsByRootAndName;let A=w[_];A===void 0&&(A={},w[_]=A);for(let C=0;C!==c;++C){const M=a[C],R=M.name;let F=A[R];if(F!==void 0)++F.referenceCount,m[C]=F;else{if(F=m[C],F!==void 0){F._cacheIndex===null&&(++F.referenceCount,this._addInactiveBinding(F,_,R));continue}const D=n&&n._propertyBindings[C].binding.parsedPath;F=new TS(Xn.create(s,R,D),M.ValueTypeName,M.getValueSize()),++F.referenceCount,this._addInactiveBinding(F,_,R),m[C]=F}g[C].resultBuffer=F.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const s=(e._localRoot||this._root).uuid,a=e._clip.uuid,c=this._actionsByClip[a];this._bindAction(e,c&&c.knownActions[0]),this._addInactiveAction(e,a,s)}const n=e._propertyBindings;for(let s=0,a=n.length;s!==a;++s){const c=n[s];c.useCount++===0&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let s=0,a=n.length;s!==a;++s){const c=n[s];--c.useCount===0&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,s){const a=this._actions,c=this._actionsByClip;let m=c[n];if(m===void 0)m={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,c[n]=m;else{const g=m.knownActions;e._byClipCacheIndex=g.length,g.push(e)}e._cacheIndex=a.length,a.push(e),m.actionByRoot[s]=e}_removeInactiveAction(e){const n=this._actions,s=n[n.length-1],a=e._cacheIndex;s._cacheIndex=a,n[a]=s,n.pop(),e._cacheIndex=null;const c=e._clip.uuid,m=this._actionsByClip,g=m[c],_=g.knownActions,w=_[_.length-1],A=e._byClipCacheIndex;w._byClipCacheIndex=A,_[A]=w,_.pop(),e._byClipCacheIndex=null;const C=g.actionByRoot,M=(e._localRoot||this._root).uuid;delete C[M],_.length===0&&delete m[c],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let s=0,a=n.length;s!==a;++s){const c=n[s];--c.referenceCount===0&&this._removeInactiveBinding(c)}}_lendAction(e){const n=this._actions,s=e._cacheIndex,a=this._nActiveActions++,c=n[a];e._cacheIndex=a,n[a]=e,c._cacheIndex=s,n[s]=c}_takeBackAction(e){const n=this._actions,s=e._cacheIndex,a=--this._nActiveActions,c=n[a];e._cacheIndex=a,n[a]=e,c._cacheIndex=s,n[s]=c}_addInactiveBinding(e,n,s){const a=this._bindingsByRootAndName,c=this._bindings;let m=a[n];m===void 0&&(m={},a[n]=m),m[s]=e,e._cacheIndex=c.length,c.push(e)}_removeInactiveBinding(e){const n=this._bindings,s=e.binding,a=s.rootNode.uuid,c=s.path,m=this._bindingsByRootAndName,g=m[a],_=n[n.length-1],w=e._cacheIndex;_._cacheIndex=w,n[w]=_,n.pop(),delete g[c],Object.keys(g).length===0&&delete m[a]}_lendBinding(e){const n=this._bindings,s=e._cacheIndex,a=this._nActiveBindings++,c=n[a];e._cacheIndex=a,n[a]=e,c._cacheIndex=s,n[s]=c}_takeBackBinding(e){const n=this._bindings,s=e._cacheIndex,a=--this._nActiveBindings,c=n[a];e._cacheIndex=a,n[a]=e,c._cacheIndex=s,n[s]=c}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let s=e[n];return s===void 0&&(s=new Zy(new Float32Array(2),new Float32Array(2),1,lL),s.__cacheIndex=n,e[n]=s),s}_takeBackControlInterpolant(e){const n=this._controlInterpolants,s=e.__cacheIndex,a=--this._nActiveControlInterpolants,c=n[a];e.__cacheIndex=a,n[a]=e,c.__cacheIndex=s,n[s]=c}clipAction(e,n,s){const a=n||this._root,c=a.uuid;let m=typeof e=="string"?lp.findByName(a,e):e;const g=m!==null?m.uuid:e,_=this._actionsByClip[g];let w=null;if(s===void 0&&(m!==null?s=m.blendMode:s=Ki),_!==void 0){const C=_.actionByRoot[c];if(C!==void 0&&C.blendMode===s)return C;w=_.knownActions[0],m===null&&(m=w._clip)}if(m===null)return null;const A=new aL(this,m,n,s);return this._bindAction(A,w),this._addInactiveAction(A,g,c),A}existingAction(e,n){const s=n||this._root,a=s.uuid,c=typeof e=="string"?lp.findByName(s,e):e,m=c?c.uuid:e,g=this._actionsByClip[m];return g!==void 0&&g.actionByRoot[a]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let s=n-1;s>=0;--s)e[s].stop();return this}update(e){e*=this.timeScale;const n=this._actions,s=this._nActiveActions,a=this.time+=e,c=Math.sign(e),m=this._accuIndex^=1;for(let w=0;w!==s;++w)n[w]._update(a,e,c,m);const g=this._bindings,_=this._nActiveBindings;for(let w=0;w!==_;++w)g[w].apply(m);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,s=e.uuid,a=this._actionsByClip,c=a[s];if(c!==void 0){const m=c.knownActions;for(let g=0,_=m.length;g!==_;++g){const w=m[g];this._deactivateAction(w);const A=w._cacheIndex,C=n[n.length-1];w._cacheIndex=null,w._byClipCacheIndex=null,C._cacheIndex=A,n[A]=C,n.pop(),this._removeInactiveBindingsForAction(w)}delete a[s]}}uncacheRoot(e){const n=e.uuid,s=this._actionsByClip;for(const m in s){const g=s[m].actionByRoot,_=g[n];_!==void 0&&(this._deactivateAction(_),this._removeInactiveAction(_))}const a=this._bindingsByRootAndName,c=a[n];if(c!==void 0)for(const m in c){const g=c[m];g.restoreOriginalState(),this._removeInactiveBinding(g)}}uncacheAction(e,n){const s=this.existingAction(e,n);s!==null&&(this._deactivateAction(s),this._removeInactiveAction(s))}}class l_{constructor(e){this.value=e}clone(){return new l_(this.value.clone===void 0?this.value:this.value.clone())}}let uL=0;class hL extends Ko{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:uL++}),this.name="",this.usage=vu,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let s=0,a=n.length;s<a;s++)this.uniforms.push(n[s].clone());return this}clone(){return new this.constructor().copy(this)}}class dL extends rg{constructor(e,n,s=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class fL{constructor(e,n,s,a,c){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=s,this.elementSize=a,this.count=c,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class pL{constructor(e,n,s=0,a=1/0){this.ray=new jn(e,n),this.near=s,this.far=a,this.camera=null,this.layers=new ka,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,s=[]){return c_(e,this,s,n),s.sort(CS),s}intersectObjects(e,n=!0,s=[]){for(let a=0,c=e.length;a<c;a++)c_(e[a],this,s,n);return s.sort(CS),s}}function CS(u,e){return u.distance-e.distance}function c_(u,e,n,s){if(u.layers.test(e.layers)&&u.raycast(e,n),s===!0){const a=u.children;for(let c=0,m=a.length;c<m;c++)c_(a[c],e,n,!0)}}class mL{constructor(e=1,n=0,s=0){return this.radius=e,this.phi=n,this.theta=s,this}set(e,n,s){return this.radius=e,this.phi=n,this.theta=s,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,s){return this.radius=Math.sqrt(e*e+n*n+s*s),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,s),this.phi=Math.acos(ni(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class gL{constructor(e=1,n=0,s=0){return this.radius=e,this.theta=n,this.y=s,this}set(e,n,s){return this.radius=e,this.theta=n,this.y=s,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,s){return this.radius=Math.sqrt(e*e+s*s),this.theta=Math.atan2(e,s),this.y=n,this}clone(){return new this.constructor().copy(this)}}const PS=new it;class vL{constructor(e=new it(1/0,1/0),n=new it(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,s=e.length;n<s;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const s=PS.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,PS).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const RS=new le,Eg=new le;class yL{constructor(e=new le,n=new le){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){RS.subVectors(e,this.start),Eg.subVectors(this.end,this.start);const s=Eg.dot(Eg);let c=Eg.dot(RS)/s;return n&&(c=ni(c,0,1)),c}closestPointToPoint(e,n,s){const a=this.closestPointToPointParameter(e,n);return this.delta(s).multiplyScalar(a).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const DS=new le;class _L extends Gn{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const s=new Rn,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let m=0,g=1,_=32;m<_;m++,g++){const w=m/_*Math.PI*2,A=g/_*Math.PI*2;a.push(Math.cos(w),Math.sin(w),1,Math.cos(A),Math.sin(A),1)}s.setAttribute("position",new Qt(a,3));const c=new Es({fog:!1,toneMapped:!1});this.cone=new Xa(s,c),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),DS.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(DS),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Cc=new le,Tg=new Mn,u_=new Mn;class xL extends Xa{constructor(e){const n=IS(e),s=new Rn,a=[],c=[],m=new Ut(0,0,1),g=new Ut(0,1,0);for(let w=0;w<n.length;w++){const A=n[w];A.parent&&A.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),c.push(m.r,m.g,m.b),c.push(g.r,g.g,g.b))}s.setAttribute("position",new Qt(a,3)),s.setAttribute("color",new Qt(c,3));const _=new Es({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(s,_),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,s=this.geometry,a=s.getAttribute("position");u_.copy(this.root.matrixWorld).invert();for(let c=0,m=0;c<n.length;c++){const g=n[c];g.parent&&g.parent.isBone&&(Tg.multiplyMatrices(u_,g.matrixWorld),Cc.setFromMatrixPosition(Tg),a.setXYZ(m,Cc.x,Cc.y,Cc.z),Tg.multiplyMatrices(u_,g.parent.matrixWorld),Cc.setFromMatrixPosition(Tg),a.setXYZ(m+1,Cc.x,Cc.y,Cc.z),m+=2)}s.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function IS(u){const e=[];u.isBone===!0&&e.push(u);for(let n=0;n<u.children.length;n++)e.push.apply(e,IS(u.children[n]));return e}class bL extends ur{constructor(e,n,s){const a=new vd(n,4,2),c=new Ua({wireframe:!0,fog:!1,toneMapped:!1});super(a,c),this.light=e,this.color=s,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const wL=new le,LS=new Ut,OS=new Ut;class AL extends Gn{constructor(e,n,s){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=s,this.type="HemisphereLightHelper";const a=new gd(n);a.rotateY(Math.PI*.5),this.material=new Ua({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const c=a.getAttribute("position"),m=new Float32Array(c.count*3);a.setAttribute("color",new ci(m,3)),this.add(new ur(a,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");LS.copy(this.light.color),OS.copy(this.light.groundColor);for(let s=0,a=n.count;s<a;s++){const c=s<a/2?LS:OS;n.setXYZ(s,c.r,c.g,c.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(wL.setFromMatrixPosition(this.light.matrixWorld).negate())}}class SL extends Xa{constructor(e=10,n=10,s=4473924,a=8947848){s=new Ut(s),a=new Ut(a);const c=n/2,m=e/n,g=e/2,_=[],w=[];for(let M=0,R=0,F=-g;M<=n;M++,F+=m){_.push(-g,0,F,g,0,F),_.push(F,0,-g,F,0,g);const D=M===c?s:a;D.toArray(w,R),R+=3,D.toArray(w,R),R+=3,D.toArray(w,R),R+=3,D.toArray(w,R),R+=3}const A=new Rn;A.setAttribute("position",new Qt(_,3)),A.setAttribute("color",new Qt(w,3));const C=new Es({vertexColors:!0,toneMapped:!1});super(A,C),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class ML extends Xa{constructor(e=10,n=16,s=8,a=64,c=4473924,m=8947848){c=new Ut(c),m=new Ut(m);const g=[],_=[];if(n>1)for(let C=0;C<n;C++){const M=C/n*(Math.PI*2),R=Math.sin(M)*e,F=Math.cos(M)*e;g.push(0,0,0),g.push(R,0,F);const D=C&1?c:m;_.push(D.r,D.g,D.b),_.push(D.r,D.g,D.b)}for(let C=0;C<s;C++){const M=C&1?c:m,R=e-e/s*C;for(let F=0;F<a;F++){let D=F/a*(Math.PI*2),O=Math.sin(D)*R,W=Math.cos(D)*R;g.push(O,0,W),_.push(M.r,M.g,M.b),D=(F+1)/a*(Math.PI*2),O=Math.sin(D)*R,W=Math.cos(D)*R,g.push(O,0,W),_.push(M.r,M.g,M.b)}}const w=new Rn;w.setAttribute("position",new Qt(g,3)),w.setAttribute("color",new Qt(_,3));const A=new Es({vertexColors:!0,toneMapped:!1});super(w,A),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const FS=new le,Cg=new le,BS=new le;class EL extends Gn{constructor(e,n,s){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=s,this.type="DirectionalLightHelper",n===void 0&&(n=1);let a=new Rn;a.setAttribute("position",new Qt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const c=new Es({fog:!1,toneMapped:!1});this.lightPlane=new Mc(a,c),this.add(this.lightPlane),a=new Rn,a.setAttribute("position",new Qt([0,0,0,0,0,1],3)),this.targetLine=new Mc(a,c),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),FS.setFromMatrixPosition(this.light.matrixWorld),Cg.setFromMatrixPosition(this.light.target.matrixWorld),BS.subVectors(Cg,FS),this.lightPlane.lookAt(Cg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Cg),this.targetLine.scale.z=BS.length()}}const Pg=new le,Zi=new ed;class TL extends Xa{constructor(e){const n=new Rn,s=new Es({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],c=[],m={};g("n1","n2"),g("n2","n4"),g("n4","n3"),g("n3","n1"),g("f1","f2"),g("f2","f4"),g("f4","f3"),g("f3","f1"),g("n1","f1"),g("n2","f2"),g("n3","f3"),g("n4","f4"),g("p","n1"),g("p","n2"),g("p","n3"),g("p","n4"),g("u1","u2"),g("u2","u3"),g("u3","u1"),g("c","t"),g("p","c"),g("cn1","cn2"),g("cn3","cn4"),g("cf1","cf2"),g("cf3","cf4");function g(F,D){_(F),_(D)}function _(F){a.push(0,0,0),c.push(0,0,0),m[F]===void 0&&(m[F]=[]),m[F].push(a.length/3-1)}n.setAttribute("position",new Qt(a,3)),n.setAttribute("color",new Qt(c,3)),super(n,s),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=m,this.update();const w=new Ut(16755200),A=new Ut(16711680),C=new Ut(43775),M=new Ut(16777215),R=new Ut(3355443);this.setColors(w,A,C,M,R)}setColors(e,n,s,a,c){const g=this.geometry.getAttribute("color");g.setXYZ(0,e.r,e.g,e.b),g.setXYZ(1,e.r,e.g,e.b),g.setXYZ(2,e.r,e.g,e.b),g.setXYZ(3,e.r,e.g,e.b),g.setXYZ(4,e.r,e.g,e.b),g.setXYZ(5,e.r,e.g,e.b),g.setXYZ(6,e.r,e.g,e.b),g.setXYZ(7,e.r,e.g,e.b),g.setXYZ(8,e.r,e.g,e.b),g.setXYZ(9,e.r,e.g,e.b),g.setXYZ(10,e.r,e.g,e.b),g.setXYZ(11,e.r,e.g,e.b),g.setXYZ(12,e.r,e.g,e.b),g.setXYZ(13,e.r,e.g,e.b),g.setXYZ(14,e.r,e.g,e.b),g.setXYZ(15,e.r,e.g,e.b),g.setXYZ(16,e.r,e.g,e.b),g.setXYZ(17,e.r,e.g,e.b),g.setXYZ(18,e.r,e.g,e.b),g.setXYZ(19,e.r,e.g,e.b),g.setXYZ(20,e.r,e.g,e.b),g.setXYZ(21,e.r,e.g,e.b),g.setXYZ(22,e.r,e.g,e.b),g.setXYZ(23,e.r,e.g,e.b),g.setXYZ(24,n.r,n.g,n.b),g.setXYZ(25,n.r,n.g,n.b),g.setXYZ(26,n.r,n.g,n.b),g.setXYZ(27,n.r,n.g,n.b),g.setXYZ(28,n.r,n.g,n.b),g.setXYZ(29,n.r,n.g,n.b),g.setXYZ(30,n.r,n.g,n.b),g.setXYZ(31,n.r,n.g,n.b),g.setXYZ(32,s.r,s.g,s.b),g.setXYZ(33,s.r,s.g,s.b),g.setXYZ(34,s.r,s.g,s.b),g.setXYZ(35,s.r,s.g,s.b),g.setXYZ(36,s.r,s.g,s.b),g.setXYZ(37,s.r,s.g,s.b),g.setXYZ(38,a.r,a.g,a.b),g.setXYZ(39,a.r,a.g,a.b),g.setXYZ(40,c.r,c.g,c.b),g.setXYZ(41,c.r,c.g,c.b),g.setXYZ(42,c.r,c.g,c.b),g.setXYZ(43,c.r,c.g,c.b),g.setXYZ(44,c.r,c.g,c.b),g.setXYZ(45,c.r,c.g,c.b),g.setXYZ(46,c.r,c.g,c.b),g.setXYZ(47,c.r,c.g,c.b),g.setXYZ(48,c.r,c.g,c.b),g.setXYZ(49,c.r,c.g,c.b),g.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,s=1,a=1;Zi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),sr("c",n,e,Zi,0,0,-1),sr("t",n,e,Zi,0,0,1),sr("n1",n,e,Zi,-s,-a,-1),sr("n2",n,e,Zi,s,-a,-1),sr("n3",n,e,Zi,-s,a,-1),sr("n4",n,e,Zi,s,a,-1),sr("f1",n,e,Zi,-s,-a,1),sr("f2",n,e,Zi,s,-a,1),sr("f3",n,e,Zi,-s,a,1),sr("f4",n,e,Zi,s,a,1),sr("u1",n,e,Zi,s*.7,a*1.1,-1),sr("u2",n,e,Zi,-s*.7,a*1.1,-1),sr("u3",n,e,Zi,0,a*2,-1),sr("cf1",n,e,Zi,-s,0,1),sr("cf2",n,e,Zi,s,0,1),sr("cf3",n,e,Zi,0,-a,1),sr("cf4",n,e,Zi,0,a,1),sr("cn1",n,e,Zi,-s,0,-1),sr("cn2",n,e,Zi,s,0,-1),sr("cn3",n,e,Zi,0,-a,-1),sr("cn4",n,e,Zi,0,a,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function sr(u,e,n,s,a,c,m){Pg.set(a,c,m).unproject(s);const g=e[u];if(g!==void 0){const _=n.getAttribute("position");for(let w=0,A=g.length;w<A;w++)_.setXYZ(g[w],Pg.x,Pg.y,Pg.z)}}const Rg=new _s;class CL extends Xa{constructor(e,n=16776960){const s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(8*3),c=new Rn;c.setIndex(new ci(s,1)),c.setAttribute("position",new ci(a,3)),super(c,new Es({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Rg.setFromObject(this.object),Rg.isEmpty())return;const n=Rg.min,s=Rg.max,a=this.geometry.attributes.position,c=a.array;c[0]=s.x,c[1]=s.y,c[2]=s.z,c[3]=n.x,c[4]=s.y,c[5]=s.z,c[6]=n.x,c[7]=n.y,c[8]=s.z,c[9]=s.x,c[10]=n.y,c[11]=s.z,c[12]=s.x,c[13]=s.y,c[14]=n.z,c[15]=n.x,c[16]=s.y,c[17]=n.z,c[18]=n.x,c[19]=n.y,c[20]=n.z,c[21]=s.x,c[22]=n.y,c[23]=n.z,a.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class PL extends Xa{constructor(e,n=16776960){const s=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],c=new Rn;c.setIndex(new ci(s,1)),c.setAttribute("position",new Qt(a,3)),super(c,new Es({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class RL extends Mc{constructor(e,n=1,s=16776960){const a=s,c=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],m=new Rn;m.setAttribute("position",new Qt(c,3)),m.computeBoundingSphere(),super(m,new Es({color:a,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const g=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],_=new Rn;_.setAttribute("position",new Qt(g,3)),_.computeBoundingSphere(),this.add(new ur(_,new Ua({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const kS=new le;let Dg,h_;class DL extends Gn{constructor(e=new le(0,0,1),n=new le(0,0,0),s=1,a=16776960,c=s*.2,m=c*.2){super(),this.type="ArrowHelper",Dg===void 0&&(Dg=new Rn,Dg.setAttribute("position",new Qt([0,0,0,0,1,0],3)),h_=new Uu(0,.5,1,5,1),h_.translate(0,-.5,0)),this.position.copy(n),this.line=new Mc(Dg,new Es({color:a,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ur(h_,new Ua({color:a,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(s,c,m)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{kS.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(kS,n)}}setLength(e,n=e*.2,s=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(s,n,s),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class IL extends Xa{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],s=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],a=new Rn;a.setAttribute("position",new Qt(n,3)),a.setAttribute("color",new Qt(s,3));const c=new Es({vertexColors:!0,toneMapped:!1});super(a,c),this.type="AxesHelper"}setColors(e,n,s){const a=new Ut,c=this.geometry.attributes.color.array;return a.set(e),a.toArray(c,0),a.toArray(c,3),a.set(n),a.toArray(c,6),a.toArray(c,9),a.set(s),a.toArray(c,12),a.toArray(c,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class LL{constructor(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new Vf,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,s,a){return this.currentPath.quadraticCurveTo(e,n,s,a),this}bezierCurveTo(e,n,s,a,c,m){return this.currentPath.bezierCurveTo(e,n,s,a,c,m),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(W){const K=[];for(let V=0,Y=W.length;V<Y;V++){const se=W[V],ue=new Nu;ue.curves=se.curves,K.push(ue)}return K}function s(W,K){const V=K.length;let Y=!1;for(let se=V-1,ue=0;ue<V;se=ue++){let me=K[se],J=K[ue],ae=J.x-me.x,xe=J.y-me.y;if(Math.abs(xe)>Number.EPSILON){if(xe<0&&(me=K[ue],ae=-ae,J=K[se],xe=-xe),W.y<me.y||W.y>J.y)continue;if(W.y===me.y){if(W.x===me.x)return!0}else{const We=xe*(W.x-me.x)-ae*(W.y-me.y);if(We===0)return!0;if(We<0)continue;Y=!Y}}else{if(W.y!==me.y)continue;if(J.x<=W.x&&W.x<=me.x||me.x<=W.x&&W.x<=J.x)return!0}}return Y}const a=Ya.isClockWise,c=this.subPaths;if(c.length===0)return[];let m,g,_;const w=[];if(c.length===1)return g=c[0],_=new Nu,_.curves=g.curves,w.push(_),w;let A=!a(c[0].getPoints());A=e?!A:A;const C=[],M=[];let R=[],F=0,D;M[F]=void 0,R[F]=[];for(let W=0,K=c.length;W<K;W++)g=c[W],D=g.getPoints(),m=a(D),m=e?!m:m,m?(!A&&M[F]&&F++,M[F]={s:new Nu,p:D},M[F].s.curves=g.curves,A&&F++,R[F]=[]):R[F].push({h:g,p:D[0]});if(!M[0])return n(c);if(M.length>1){let W=!1,K=0;for(let V=0,Y=M.length;V<Y;V++)C[V]=[];for(let V=0,Y=M.length;V<Y;V++){const se=R[V];for(let ue=0;ue<se.length;ue++){const me=se[ue];let J=!0;for(let ae=0;ae<M.length;ae++)s(me.p,M[ae].p)&&(V!==ae&&K++,J?(J=!1,C[ae].push(me)):W=!0);J&&C[V].push(me)}}K>0&&W===!1&&(R=C)}let O;for(let W=0,K=M.length;W<K;W++){_=M[W].s,w.push(_),O=R[W];for(let V=0,Y=O.length;V<Y;V++)_.holes.push(O[V].h)}return w}}const El=OL();function OL(){const u=new ArrayBuffer(4),e=new Float32Array(u),n=new Uint32Array(u),s=new Uint32Array(512),a=new Uint32Array(512);for(let _=0;_<256;++_){const w=_-127;w<-27?(s[_]=0,s[_|256]=32768,a[_]=24,a[_|256]=24):w<-14?(s[_]=1024>>-w-14,s[_|256]=1024>>-w-14|32768,a[_]=-w-1,a[_|256]=-w-1):w<=15?(s[_]=w+15<<10,s[_|256]=w+15<<10|32768,a[_]=13,a[_|256]=13):w<128?(s[_]=31744,s[_|256]=64512,a[_]=24,a[_|256]=24):(s[_]=31744,s[_|256]=64512,a[_]=13,a[_|256]=13)}const c=new Uint32Array(2048),m=new Uint32Array(64),g=new Uint32Array(64);for(let _=1;_<1024;++_){let w=_<<13,A=0;for(;!(w&8388608);)w<<=1,A-=8388608;w&=-8388609,A+=947912704,c[_]=w|A}for(let _=1024;_<2048;++_)c[_]=939524096+(_-1024<<13);for(let _=1;_<31;++_)m[_]=_<<23;m[31]=1199570944,m[32]=2147483648;for(let _=33;_<63;++_)m[_]=2147483648+(_-32<<23);m[63]=3347054592;for(let _=1;_<64;++_)_!==32&&(g[_]=1024);return{floatView:e,uint32View:n,baseTable:s,shiftTable:a,mantissaTable:c,exponentTable:m,offsetTable:g}}function FL(u){Math.abs(u)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),u=ni(u,-65504,65504),El.floatView[0]=u;const e=El.uint32View[0],n=e>>23&511;return El.baseTable[n]+((e&8388607)>>El.shiftTable[n])}function BL(u){const e=u>>10;return El.uint32View[0]=El.mantissaTable[El.offsetTable[e]+(u&1023)]+El.exponentTable[e],El.floatView[0]}const kL={toHalfFloat:FL,fromHalfFloat:BL};class UL extends za{constructor(e,n,s,a,c,m){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,n,s,a,c,m)}}class NL extends Wf{constructor(e,n,s,a){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,n,s,a)}}class zL extends jf{constructor(e,n,s,a){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,n,s,a)}}class GL extends Xf{constructor(e,n,s,a,c,m,g){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,n,s,a,c,m,g)}}class HL extends Uu{constructor(e,n,s,a,c,m,g,_){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,n,s,a,c,m,g,_)}}class VL extends Yf{constructor(e,n){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,n)}}class WL extends Zf{constructor(e,n){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,n)}}class jL extends Jf{constructor(e,n){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,n)}}class XL extends pd{constructor(e,n,s,a){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,n,s,a)}}class YL extends gd{constructor(e,n){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,n)}}class QL extends wc{constructor(e,n,s,a){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,n,s,a)}}class KL extends Al{constructor(e,n,s,a){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,n,s,a)}}class qL extends $f{constructor(e,n,s,a,c,m){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,n,s,a,c,m)}}class ZL extends ep{constructor(e,n){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,n)}}class JL extends vd{constructor(e,n,s,a,c,m,g){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,n,s,a,c,m,g)}}class $L extends tp{constructor(e,n){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,n)}}class eO extends np{constructor(e,n,s,a,c){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,n,s,a,c)}}class tO extends ip{constructor(e,n,s,a,c,m){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,n,s,a,c,m)}}class nO extends rp{constructor(e,n,s,a,c){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,n,s,a,c)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:y}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=y)},980:(t,i,r)=>{r.d(i,{LX:()=>o,Vu:()=>p,hR:()=>y});async function o(d){return new Promise((E,L)=>{const k=new FileReader;k.onload=()=>E(k.result),k.onerror=L,k.readAsArrayBuffer(d)})}async function p(d){return new Promise((E,L)=>{const k=new FileReader;k.onload=()=>E(k.result),k.onerror=L,k.readAsText(d)})}async function y(d){return new Promise((E,L)=>{const k=new FileReader;k.onload=()=>E(k.result),k.onerror=L,k.readAsDataURL(d)})}},631:(t,i,r)=>{r.r(i),r.d(i,{TweenChain:()=>p});const o=r(622);class p{constructor(d){this._object=d,this._tween=new o.Tween(d)}start(){return this._tween.start(),this}stop(){return this._tween.stop(),this}repeat(d){return this._chainedTween.repeat(d),this}union(){return this._chainedTween=this._tween=new o.Tween(this._object).union(this._tween,this._chainedTween),this}call(d){return this._chainTween().call(d),this}delay(d){return this._chainTween().delay(d),this}to(d,E,L){let k=this._chainTween().to(d,E);return L&&(L.from&&k.from(L.from),L.easing&&k.easing(L.easing),L.onStart&&k.onStart(L.onStart),L.onStop&&k.onStop(L.onStop),L.onComplete&&k.onComplete(L.onComplete),L.onUpdate&&k.onUpdate(L.onUpdate),L.onRepeat&&k.onRepeat(L.onRepeat)),this}_chainTween(){let d=this._tween;return this._chainedTween&&(d=new o.Tween(this._object),this._chainedTween.chain(d)),this._chainedTween=d,d}}},622:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0});var r={Linear:{None:function(U){return U}},Quadratic:{In:function(U){return U*U},Out:function(U){return U*(2-U)},InOut:function(U){return(U*=2)<1?.5*U*U:-.5*(--U*(U-2)-1)}},Cubic:{In:function(U){return U*U*U},Out:function(U){return--U*U*U+1},InOut:function(U){return(U*=2)<1?.5*U*U*U:.5*((U-=2)*U*U+2)}},Quartic:{In:function(U){return U*U*U*U},Out:function(U){return 1- --U*U*U*U},InOut:function(U){return(U*=2)<1?.5*U*U*U*U:-.5*((U-=2)*U*U*U-2)}},Quintic:{In:function(U){return U*U*U*U*U},Out:function(U){return--U*U*U*U*U+1},InOut:function(U){return(U*=2)<1?.5*U*U*U*U*U:.5*((U-=2)*U*U*U*U+2)}},Sinusoidal:{In:function(U){return 1-Math.cos(U*Math.PI/2)},Out:function(U){return Math.sin(U*Math.PI/2)},InOut:function(U){return .5*(1-Math.cos(Math.PI*U))}},Exponential:{In:function(U){return U===0?0:Math.pow(1024,U-1)},Out:function(U){return U===1?1:1-Math.pow(2,-10*U)},InOut:function(U){return U===0?0:U===1?1:(U*=2)<1?.5*Math.pow(1024,U-1):.5*(-Math.pow(2,-10*(U-1))+2)}},Circular:{In:function(U){return 1-Math.sqrt(1-U*U)},Out:function(U){return Math.sqrt(1- --U*U)},InOut:function(U){return(U*=2)<1?-.5*(Math.sqrt(1-U*U)-1):.5*(Math.sqrt(1-(U-=2)*U)+1)}},Elastic:{In:function(U){return U===0?0:U===1?1:-Math.pow(2,10*(U-1))*Math.sin((U-1.1)*5*Math.PI)},Out:function(U){return U===0?0:U===1?1:Math.pow(2,-10*U)*Math.sin((U-.1)*5*Math.PI)+1},InOut:function(U){return U===0?0:U===1?1:(U*=2,U<1?-.5*Math.pow(2,10*(U-1))*Math.sin((U-1.1)*5*Math.PI):.5*Math.pow(2,-10*(U-1))*Math.sin((U-1.1)*5*Math.PI)+1)}},Back:{In:function(U){var re=1.70158;return U*U*((re+1)*U-re)},Out:function(U){var re=1.70158;return--U*U*((re+1)*U+re)+1},InOut:function(U){var re=2.5949095;return(U*=2)<1?.5*(U*U*((re+1)*U-re)):.5*((U-=2)*U*((re+1)*U+re)+2)}},Bounce:{In:function(U){return 1-r.Bounce.Out(1-U)},Out:function(U){return U<1/2.75?7.5625*U*U:U<2/2.75?7.5625*(U-=1.5/2.75)*U+.75:U<2.5/2.75?7.5625*(U-=2.25/2.75)*U+.9375:7.5625*(U-=2.625/2.75)*U+.984375},InOut:function(U){return U<.5?r.Bounce.In(U*2)*.5:r.Bounce.Out(U*2-1)*.5+.5}}},o;typeof self>"u"&&typeof process<"u"&&process.hrtime?o=function(){var U=process.hrtime();return U[0]*1e3+U[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?o=self.performance.now.bind(self.performance):Date.now!==void 0?o=Date.now:o=function(){return new Date().getTime()};function p(){return o()*.001}var y=function(){function U(){this._tweens={},this._tweensAddedDuringUpdate={}}return U.prototype.getAll=function(){var re=this;return Object.keys(this._tweens).map(function(ve){return re._tweens[ve]})},U.prototype.removeAll=function(){this._tweens={}},U.prototype.add=function(re){this._tweens[re.getId()]=re,this._tweensAddedDuringUpdate[re.getId()]=re},U.prototype.remove=function(re){delete this._tweens[re.getId()],delete this._tweensAddedDuringUpdate[re.getId()]},U.prototype.update=function(re,ve){re===void 0&&(re=p()),ve===void 0&&(ve=!1);var Be=Object.keys(this._tweens);if(Be.length===0)return!1;for(;Be.length>0;){this._tweensAddedDuringUpdate={};for(var Ge=0;Ge<Be.length;Ge++){var Ie=this._tweens[Be[Ge]],Ct=!ve;Ie&&Ie.update(re,Ct)===!1&&!ve&&delete this._tweens[Be[Ge]]}Be=Object.keys(this._tweensAddedDuringUpdate)}return!0},U}(),d={Linear:function(U,re){var ve=U.length-1,Be=ve*re,Ge=Math.floor(Be),Ie=d.Utils.Linear;return re<0?Ie(U[0],U[1],Be):re>1?Ie(U[ve],U[ve-1],ve-Be):Ie(U[Ge],U[Ge+1>ve?ve:Ge+1],Be-Ge)},Bezier:function(U,re){for(var ve=0,Be=U.length-1,Ge=Math.pow,Ie=d.Utils.Bernstein,Ct=0;Ct<=Be;Ct++)ve+=Ge(1-re,Be-Ct)*Ge(re,Ct)*U[Ct]*Ie(Be,Ct);return ve},CatmullRom:function(U,re){var ve=U.length-1,Be=ve*re,Ge=Math.floor(Be),Ie=d.Utils.CatmullRom;return U[0]===U[ve]?(re<0&&(Ge=Math.floor(Be=ve*(1+re))),Ie(U[(Ge-1+ve)%ve],U[Ge],U[(Ge+1)%ve],U[(Ge+2)%ve],Be-Ge)):re<0?U[0]-(Ie(U[0],U[0],U[1],U[1],-Be)-U[0]):re>1?U[ve]-(Ie(U[ve],U[ve],U[ve-1],U[ve-1],Be-ve)-U[ve]):Ie(U[Ge?Ge-1:0],U[Ge],U[ve<Ge+1?ve:Ge+1],U[ve<Ge+2?ve:Ge+2],Be-Ge)},Utils:{Linear:function(U,re,ve){return(re-U)*ve+U},Bernstein:function(U,re){var ve=d.Utils.Factorial;return ve(U)/ve(re)/ve(U-re)},Factorial:function(){var U=[1];return function(re){var ve=1;if(U[re])return U[re];for(var Be=re;Be>1;Be--)ve*=Be;return U[re]=ve,ve}}(),CatmullRom:function(U,re,ve,Be,Ge){var Ie=(ve-U)*.5,Ct=(Be-re)*.5,vt=Ge*Ge,Sn=Ge*vt;return(2*re-2*ve+Ie+Ct)*Sn+(-3*re+3*ve-2*Ie-Ct)*vt+Ie*Ge+re}}},E=function(){function U(){}return U.nextId=function(){return U._nextId++},U._nextId=0,U}(),L=new y,k=function(){function U(re,ve){ve===void 0&&(ve=L),this._object=re,this._group=ve,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=0,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=r.Linear.None,this._interpolationFunction=d.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=E.nextId(),this._isChainStopped=!1,this._goToEnd=!1,this._headTween=null,this._tailTween=null,this._headStart=!1}return U.prototype.getId=function(){return this._id},U.prototype.isPlaying=function(){return this._isPlaying},U.prototype.isPaused=function(){return this._isPaused},U.prototype.duration=function(re){return this._duration=re,this},U.prototype.start=function(re){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var ve in this._valuesStartRepeat)this._swapEndStartRepeatValues(ve),this._valuesStart[ve]=this._valuesStartRepeat[ve]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=re!==void 0?typeof re=="string"?p()+parseFloat(re):re:p(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},U.prototype._setupProperties=function(re,ve,Be,Ge){for(var Ie in Be){var Ct=re[Ie],vt=Array.isArray(Ct),Sn=vt?"array":typeof Ct,Oi=!vt&&Array.isArray(Be[Ie]);if(!(Sn==="undefined"||Sn==="function")){if(Oi){var Fi=Be[Ie];if(Fi.length===0)continue;Fi=Fi.map(this._handleRelativeValue.bind(this,Ct)),Be[Ie]=[Ct].concat(Fi)}if((Sn==="object"||vt)&&Ct&&!Oi){ve[Ie]=vt?[]:{};for(var $r in Ct)ve[Ie][$r]=Ct[$r];Ge[Ie]=vt?[]:{},this._setupProperties(Ct,ve[Ie],Be[Ie],Ge[Ie])}else typeof ve[Ie]>"u"&&(ve[Ie]=Ct),vt||(ve[Ie]*=1),Oi?Ge[Ie]=Be[Ie].slice().reverse():Ge[Ie]=ve[Ie]||0}}},U.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},U.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},U.prototype.pause=function(re){return re===void 0&&(re=p()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=re,this._group&&this._group.remove(this),this)},U.prototype.resume=function(re){return re===void 0&&(re=p()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=re-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},U.prototype.stopChainedTweens=function(){for(var re=0,ve=this._chainedTweens.length;re<ve;re++)this._chainedTweens[re].stop();return this._chainedTweens=[],this},U.prototype.group=function(re){return this._group=re,this},U.prototype.call=function(re){return this._onFinishCallback=re,this},U.prototype.from=function(re){return this._valuesStart=Object.create(re),this},U.prototype.to=function(re,ve){return this._valuesEnd=Object.create(re),ve!==void 0&&(this._duration=ve),this._chainedTween=this,this},U.prototype.delay=function(re){return this._delayTime=re,this},U.prototype.union=function(re,ve){return this._headTween=re,this._tailTween=ve.chain(this),this._headStart=!0,this},U.prototype.repeat=function(re){return this._initialRepeat=re,this._repeat=re,this},U.prototype.repeatDelay=function(re){return this._repeatDelayTime=re,this},U.prototype.yoyo=function(re){return this._yoyo=re,this},U.prototype.easing=function(re){return this._easingFunction=re,this},U.prototype.interpolation=function(re){return this._interpolationFunction=re,this},U.prototype.chain=function(){for(var re=[],ve=0;ve<arguments.length;ve++)re[ve]=arguments[ve];return this._chainedTweens=re,this},U.prototype.unchain=function(){for(var re=0;re<arguments.length;re++){let ve=this._chainedTweens.findIndex(Be=>Be==arguments[re]);ve>-1&&this._chainedTweens.splice(ve,1)}return this},U.prototype.onStart=function(re){return this._onStartCallback=re,this},U.prototype.onUpdate=function(re){return this._onUpdateCallback=re,this},U.prototype.onRepeat=function(re){return this._onRepeatCallback=re,this},U.prototype.onComplete=function(re){return this._onCompleteCallback=re,this},U.prototype.onStop=function(re){return this._onStopCallback=re,this},U.prototype.update=function(re,ve){if(re===void 0&&(re=p()),ve===void 0&&(ve=!0),this._isPaused)return!0;var Be,Ge,Ie=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(re>Ie)return!1;ve&&this.start(re)}if(this._goToEnd=!1,re<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),Ge=(re-this._startTime)/this._duration,Ge=this._duration===0||Ge>1?1:Ge;var Ct=this._easingFunction(Ge);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,Ct),this._onUpdateCallback&&this._onUpdateCallback(this._object,Ge),Ge===1){if(this._onFinishCallback&&this._onFinishCallback(this._object),this._headTween&&this._headStart)return this._headTween.start(this._startTime+this._duration),this._headStart=!1,this._isPlaying=!1,!1;if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(Be in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[Be]=="string"&&(this._valuesStartRepeat[Be]=this._valuesStartRepeat[Be]+parseFloat(this._valuesEnd[Be])),this._yoyo&&this._swapEndStartRepeatValues(Be),this._valuesStart[Be]=this._valuesStartRepeat[Be];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=re+this._repeatDelayTime:this._startTime=re+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._headTween&&(this._headStart=!0,this._initialRepeat=this._repeat),!0}else{this._tailTween&&this._tailTween.unchain(this),this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var vt=0,Sn=this._chainedTweens.length;vt<Sn;vt++)this._chainedTweens[vt].start(this._startTime+this._duration);return this._isPlaying=!1,!1}}return!0},U.prototype._updateProperties=function(re,ve,Be,Ge){for(var Ie in Be)if(ve[Ie]!==void 0){var Ct=ve[Ie]||0,vt=Be[Ie],Sn=Array.isArray(re[Ie]),Oi=Array.isArray(vt),Fi=!Sn&&Oi;Fi?re[Ie]=this._interpolationFunction(vt,Ge):typeof vt=="object"&&vt?(this._updateProperties(re[Ie],Ct,vt,Ge),re[Ie]=re[Ie]):(vt=this._handleRelativeValue(Ct,vt),typeof vt=="number"&&(re[Ie]=Ct+(vt-Ct)*Ge))}},U.prototype._handleRelativeValue=function(re,ve){return typeof ve!="string"?ve:ve.charAt(0)==="+"||ve.charAt(0)==="-"?re+parseFloat(ve):parseFloat(ve)},U.prototype._swapEndStartRepeatValues=function(re){var ve=this._valuesStartRepeat[re],Be=this._valuesEnd[re];typeof Be=="string"?this._valuesStartRepeat[re]=this._valuesStartRepeat[re]+parseFloat(Be):this._valuesStartRepeat[re]=this._valuesEnd[re],this._valuesEnd[re]=ve},U}(),X="18.6.4",$=E.nextId,Z=L,ge=Z.getAll.bind(Z),be=Z.removeAll.bind(Z),ye=Z.add.bind(Z),$e=Z.remove.bind(Z),ce=Z.update.bind(Z),ie={Easing:r,Group:y,Interpolation:d,now:p,Sequence:E,nextId:$,Tween:k,VERSION:X,getAll:ge,removeAll:be,add:ye,remove:$e,update:ce};i.Easing=r,i.Group=y,i.Interpolation=d,i.Sequence=E,i.Tween=k,i.VERSION=X,i.add=ye,i.default=ie,i.getAll=ge,i.nextId=$,i.now=p,i.remove=$e,i.removeAll=be,i.update=ce}},JM={};function ga(t){var i=JM[t];if(i!==void 0)return i.exports;var r=JM[t]={exports:{}};return FB[t](r,r.exports,ga),r.exports}ga.d=(t,i)=>{for(var r in i)ga.o(i,r)&&!ga.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};ga.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i);ga.r=t=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var N={};(()=>{ga.d(N,{J12:()=>t.J12,$c:()=>t.$c,I_b:()=>t.I_b,oGK:()=>t.oGK,$p:()=>t.$p,$q:()=>t.$q,$r:()=>t.$r,L0d:()=>t.L0d,i5S:()=>t.i5S,nXV:()=>t.nXV,bd1:()=>t.bd1,LY2:()=>t.LY2,iAO:()=>t.iAO,bGH:()=>t.bGH,NDo:()=>t.NDo,gSk:()=>t.gSk,WMw:()=>t.WMw,OTo:()=>t.OTo,Se2:()=>t.Se2,cum:()=>t.cum,Mig:()=>t.Mig,i_9:()=>t.i_9,fwF:()=>t.fwF,m7l:()=>t.m7l,vXP:()=>t.vXP,sYA:()=>t.sYA,Xcj:()=>t.Xcj,mzJ:()=>t.mzJ,ZZA:()=>t.ZZA,T__:()=>t.T__,HkE:()=>t.HkE,tGC:()=>t.tGC,gOo:()=>t.gOo,f03:()=>t.f03,BbS:()=>t.BbS,kqm:()=>t.kqm,GPr:()=>t.GPr,Hmr:()=>t.Hmr,SJI:()=>t.SJI,mTL:()=>t.mTL,y8_:()=>t.y8_,Xim:()=>t.Xim,_Li:()=>t._Li,z81:()=>t.z81,_MY:()=>t._MY,NBQ:()=>t.NBQ,dFZ:()=>wo,IIx:()=>t.IIx,N$j:()=>t.N$j,_YM:()=>t._YM,TUj:()=>t.TUj,ZzF:()=>t.ZzF,GQ:()=>t.GQ,nvb:()=>t.nvb,DvJ:()=>t.DvJ,fQA:()=>t.fQA,ePP:()=>t.ePP,TlE:()=>t.TlE,u9r:()=>t.u9r,s4_:()=>t.s4_,T95:()=>t.T95,CtF:()=>t.CtF,V1s:()=>t.V1s,Rki:()=>t.Rki,ROQ:()=>t.ROQ,YN5:()=>t.YN5,BVQ:()=>t.BVQ,YT8:()=>t.YT8,YGz:()=>t.YGz,WXy:()=>t.WXy,trn:()=>t.trn,zf8:()=>t.zf8,uWy:()=>t.uWy,SUY:()=>t.SUY,Ilk:()=>t.Ilk,R2R:()=>t.R2R,epp:()=>t.epp,Wrv:()=>t.Wrv,EKy:()=>t.EKy,$S:()=>t.$S,wA2:()=>t.wA2,Z_g:()=>t.Z_g,EB7:()=>t.EB7,DqL:()=>t.DqL,_3:()=>t._3,b_z:()=>t.b_z,unp:()=>t.unp,_am:()=>t._am,fY$:()=>t.fY$,vxC:()=>t.vxC,BtG:()=>t.BtG,cBK:()=>t.cBK,g8_:()=>t.g8_,AXT:()=>t.AXT,yj7:()=>t.yj7,dYG:()=>t.dYG,tm_:()=>t.tm_,S2y:()=>t.S2y,B02:()=>t.B02,PeU:()=>t.PeU,Hyl:()=>t.Hyl,Wqd:()=>t.Wqd,SVw:()=>t.SVw,Xaj:()=>t.Xaj,dZ3:()=>t.dZ3,m_w:()=>t.m_w,fHI:()=>t.fHI,LBq:()=>t.LBq,JUT:()=>t.JUT,p3g:()=>t.p3g,IEO:()=>t.IEO,yxD:()=>t.yxD,A5E:()=>t.A5E,jfJ:()=>t.jfJ,T_J:()=>t.T_J,tEQ:()=>t.tEQ,qkB:()=>t.qkB,brP:()=>t.brP,$YQ:()=>t.$YQ,iRp:()=>t.iRp,Ox3:()=>t.Ox3,cBI:()=>t.cBI,cU9:()=>t.cU9,ntt:()=>t.ntt,DT1:()=>t.DT1,Kgo:()=>t.Kgo,ehD:()=>t.ehD,fSK:()=>t.fSK,Vdb:()=>t.Vdb,l8J:()=>t.l8J,dj0:()=>t.dj0,QM0:()=>t.QM0,q7E:()=>t.q7E,TOt:()=>t.TOt,Ny0:()=>t.Ny0,qAh:()=>t.qAh,eD:()=>t.eD,jwo:()=>t.jwo,dSO:()=>t.dSO,Bf4:()=>t.Bf4,USm:()=>t.USm,pBf:()=>t.pBf,vpe:()=>t.vpe,$Vf:()=>t.$Vf,O7d:()=>t.O7d,Aek:()=>t.Aek,hH6:()=>t.hH6,e62:()=>t.e62,a$l:()=>t.a$l,OM3:()=>t.OM3,VzW:()=>t.VzW,ybr:()=>t.ybr,yo9:()=>t.yo9,Wzm:()=>t.Wzm,zUS:()=>t.zUS,Wl3:()=>t.Wl3,iWj:()=>t.iWj,ylh:()=>t.ylh,v9Y:()=>t.v9Y,LSk:()=>t.LSk,uoT:()=>t.uoT,w$m:()=>t.w$m,ksN:()=>t.ksN,j4z:()=>t.j4z,OAl:()=>t.OAl,VLJ:()=>t.VLJ,ZAu:()=>t.ZAu,k7s:()=>t.k7s,cLu:()=>t.cLu,vmT:()=>t.vmT,Qpg:()=>t.Qpg,So8:()=>t.So8,Wjw:()=>t.Wjw,cJO:()=>t.cJO,KCx:()=>t.KCx,QRU:()=>t.QRU,S3k:()=>t.S3k,PpQ:()=>t.PpQ,ZRs:()=>t.ZRs,oqc:()=>t.oqc,lb7:()=>t.lb7,L5s:()=>t.L5s,$TI:()=>t.$TI,SPe:()=>t.SPe,aVm:()=>t.aVm,j87:()=>t.j87,RNb:()=>t.RNb,Kz5:()=>t.Kz5,vpT:()=>t.vpT,kB5:()=>t.kB5,_C8:()=>t._C8,Syv:()=>t.Syv,NMF:()=>t.NMF,pIN:()=>t.pIN,eMJ:()=>t.eMJ,ZtY:()=>t.ZtY,x5V:()=>t.x5V,tUh:()=>t.tUh,z8B:()=>t.z8B,__J:()=>t.__J,GZb:()=>t.GZb,p7y:()=>t.p7y,udN:()=>t.udN,S9g:()=>t.S9g,Zr5:()=>t.Zr5,vCF:()=>t.vCF,yt0:()=>t.yt0,uXU:()=>t.uXU,_kC:()=>t._kC,lk7:()=>t.lk7,DvN:()=>t.DvN,x12:()=>t.x12,Zzh:()=>t.Zzh,nls:()=>t.nls,g_z:()=>t.g_z,U7:()=>t.U7,FT0:()=>t.FT0,blk:()=>t.blk,ejS:()=>t.ejS,rnI:()=>t.rnI,wem:()=>t.wem,lfu:()=>t.lfu,FDw:()=>t.FDw,lRj:()=>t.lRj,D1R:()=>t.D1R,qyh:()=>t.qyh,GUF:()=>t.GUF,EoG:()=>t.EoG,aNw:()=>t.aNw,Zp0:()=>t.Zp0,lLk:()=>t.lLk,jAl:()=>t.jAl,uEv:()=>t.uEv,YKA:()=>t.YKA,cRx:()=>t.cRx,Y8D:()=>t.Y8D,RsA:()=>t.RsA,B51:()=>t.B51,F5T:()=>t.F5T,u7G:()=>t.u7G,M8C:()=>t.M8C,Vkp:()=>t.Vkp,yGw:()=>t.yGw,Sm8:()=>t.Sm8,Kj0:()=>t.Kj0,vBJ:()=>t.vBJ,lRF:()=>t.lRF,Lun:()=>t.Lun,YBo:()=>t.YBo,kaV:()=>t.kaV,RSm:()=>t.RSm,xoR:()=>t.xoR,EJi:()=>t.EJi,Qme:()=>t.Qme,Wid:()=>t.Wid,jrH:()=>t.jrH,IKL:()=>t.IKL,r_:()=>t.r_,OPb:()=>t.OPb,OoA:()=>t.OoA,qhX:()=>t.qhX,M5h:()=>t.M5h,Ns1:()=>t.Ns1,TyD:()=>t.TyD,vZf:()=>t.vZf,HTd:()=>t.HTd,aH4:()=>t.aH4,YLQ:()=>t.YLQ,BVF:()=>t.BVF,MyG:()=>t.MyG,jFi:()=>t.jFi,aCh:()=>t.aCh,uL9:()=>t.uL9,fwl:()=>t.fwl,IFH:()=>t.IFH,bdR:()=>t.bdR,M6v:()=>t.M6v,RvT:()=>t.RvT,dUE:()=>t.dUE,Tme:()=>t.Tme,Gql:()=>t.Gql,PA7:()=>t.PA7,REq:()=>t.REq,pQR:()=>t.pQR,ghN:()=>t.ghN,Hy8:()=>t.Hy8,Wpd:()=>t.Wpd,LgZ:()=>t.LgZ,iWC:()=>t.iWC,i5E:()=>t.i5E,iKG:()=>t.iKG,_iA:()=>t._iA,ntZ:()=>t.ntZ,anP:()=>t.anP,y$t:()=>t.y$t,Ady:()=>t.Ady,H8x:()=>t.H8x,cPb:()=>t.cPb,JOQ:()=>t.JOQ,BKK:()=>t.BKK,_12:()=>t._12,tJx:()=>t.tJx,OdJ:()=>t.OdJ,SyM:()=>t.SyM,cek:()=>t.cek,xG9:()=>t.xG9,woe:()=>t.woe,UY4:()=>t.UY4,aq0:()=>t.aq0,ujx:()=>t.ujx,Uol:()=>t.Uol,VYz:()=>t.VYz,XgS:()=>t.XgS,iUV:()=>t.iUV,tf:()=>t.tf,ZQ6:()=>t.ZQ6,mXe:()=>t.mXe,_fP:()=>t._fP,iLg:()=>t.iLg,zbs:()=>t.zbs,ZTh:()=>t.ZTh,HdW:()=>t.HdW,UZH:()=>t.UZH,mSO:()=>t.mSO,wk1:()=>t.wk1,E2K:()=>t.E2K,FUD:()=>t.FUD,pKu:()=>t.pKu,GG6:()=>t.GG6,Gih:()=>t.Gih,iiP:()=>t.iiP,SvJ:()=>t.SvJ,ptH:()=>t.ptH,jZA:()=>t.jZA,y2t:()=>t.y2t,gi4:()=>t.gi4,Djp:()=>t.Djp,BG$:()=>t.BG$,NYV:()=>t.NYV,xJs:()=>t.xJs,bsb:()=>t.bsb,ekQ:()=>t.ekQ,CaW:()=>t.CaW,eaV:()=>t.eaV,BFQ:()=>t.BFQ,v3W:()=>t.v3W,ILR:()=>t.ILR,fto:()=>t.fto,l0P:()=>t.l0P,vCx:()=>t.vCx,_AM:()=>t._AM,wuA:()=>t.wuA,av9:()=>t.av9,CtA:()=>t.CtA,mIn:()=>t.mIn,FIo:()=>t.FIo,zHn:()=>t.zHn,iMs:()=>t.iMs,T_f:()=>t.T_f,hEm:()=>t.hEm,D9w:()=>t.D9w,CdI:()=>t.CdI,TIb:()=>t.TIb,rpg:()=>t.rpg,ce8:()=>t.ce8,rOj:()=>t.rOj,V4E:()=>t.V4E,o8S:()=>t.o8S,lGU:()=>t.lGU,vuL:()=>t.vuL,Rov:()=>Ao,KI_:()=>t.KI_,xsS:()=>t.xsS,b26:()=>t.b26,WdD:()=>t.WdD,Vj0:()=>t.Vj0,jyz:()=>t.jyz,Tn7:()=>t.Tn7,bnF:()=>t.bnF,HW6:()=>t.HW6,oa8:()=>t.oa8,T_1:()=>t.T_1,iDF:()=>t.iDF,iAb:()=>t.iAb,OdW:()=>t.OdW,_YX:()=>t._YX,TUv:()=>t.TUv,Hw6:()=>t.Hw6,aLr:()=>t.aLr,Aip:()=>t.Aip,xo$:()=>t.xo$,$V:()=>t.$V,lDi:()=>t.lDi,gti:()=>t.gti,PMe:()=>t.PMe,FvO:()=>t.FvO,jyi:()=>t.jyi,xeV:()=>t.xeV,k74:()=>t.k74,RlZ:()=>t.RlZ,KhW:()=>t.KhW,HgB:()=>t.HgB,W2J:()=>t.W2J,JWc:()=>t.JWc,kP0:()=>t.kP0,u37:()=>t.u37,Z6B:()=>t.Z6B,QZ1:()=>t.QZ1,Ir4:()=>t.Ir4,NwF:()=>t.NwF,Wbm:()=>t.Wbm,N4l:()=>t.N4l,QmN:()=>t.QmN,wes:()=>t.wes,IOt:()=>t.IOt,L5g:()=>t.L5g,H$k:()=>t.H$k,xEZ:()=>t.xEZ,YQ_:()=>t.YQ_,Yin:()=>t.Yin,dpR:()=>t.dpR,Cne:()=>t.Cne,XvJ:()=>t.XvJ,XZw:()=>t.XZw,FE5:()=>t.FE5,Ys8:()=>t.Ys8,CJI:()=>t.CJI,z$h:()=>t.z$h,UlW:()=>t.UlW,WwZ:()=>t.WwZ,Lcc:()=>t.Lcc,WXh:()=>t.WXh,ub3:()=>t.ub3,xfE:()=>t.xfE,qlB:()=>t.qlB,lCJ:()=>t.lCJ,WTc:()=>t.WTc,rAo:()=>t.rAo,xWb:()=>t.xWb,gH0:()=>t.gH0,rBU:()=>t.rBU,rDY:()=>t.rDY,ywz:()=>t.ywz,wJv:()=>t.wJv,JQ4:()=>t.JQ4,k0A:()=>t.k0A,irR:()=>t.irR,LsT:()=>t.LsT,MiG:()=>t.MiG,dwk:()=>t.dwk,FM8:()=>t.FM8,Pa4:()=>t.Pa4,Ltg:()=>t.Ltg,yC1:()=>t.yC1,fO1:()=>t.fO1,AEx:()=>t.AEx,_9o:()=>t._9o,k5T:()=>t.k5T,b5g:()=>t.b5g,Ywn:()=>t.Ywn,GVz:()=>t.GVz,oAp:()=>t.oAp,kFz:()=>t.kFz,dd2:()=>t.dd2,CP7:()=>t.CP7,fQK:()=>t.fQK,Uk6:()=>t.Uk6,_sL:()=>t._sL,Pnf:()=>t.Pnf,c8b:()=>t.c8b,_lf:()=>t._lf,ad5:()=>t.ad5,L_r:()=>t.L_r,eC3:()=>t.eC3,BRj:()=>t.BRj,rif:()=>t.rif,HOT:()=>t.HOT,jfB:()=>t.jfB,bkz:()=>t.bkz,lDs:()=>t.lDs,tQ:()=>t.tQ,Oe_:()=>t.Oe_,YRX:()=>t.YRX,S6$:()=>t.S6$,CbL:()=>t.CbL,knz:()=>t.knz,lKs:()=>t.lKs,GaT:()=>t.GaT,OEW:()=>t.OEW});var t=ga(651),i=ga(41),r=ga(25);const o="",p="srgb",y="srgb-linear",E=Number(r.UZH.replace(/\D+/g,""))>=152,L=new Map([[r.rnI,y],[r.knz,p]]),k=new Map([[y,r.rnI],[p,r.knz]]);function X(Pt){return Pt===null?null:E?Pt.outputColorSpace:L.get(Pt.outputEncoding)}function $(Pt,T){Pt!==null&&(E?Pt.colorSpace=T:Pt.encoding=k.get(T))}const Z={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},ge={DEPTH:0,LUMA:1,COLOR:2},be={NONE:0,DEPTH:1,CONVOLUTION:2},ye={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},$e={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},ce={DISABLED:0,DEPTH:1,CUSTOM:2},ie={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},U=`#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

varying vec2 vUv0;
varying vec2 vUv1;
varying vec2 vUv2;
varying vec2 vUv3;

void main() {

	vec4 sum = texture2D(inputBuffer, vUv0); // Top left
	sum += texture2D(inputBuffer, vUv1); // Top right
	sum += texture2D(inputBuffer, vUv2); // Bottom right
	sum += texture2D(inputBuffer, vUv3); // Bottom left
	gl_FragColor = sum * 0.25; // Compute the average

	#include <encodings_fragment>

}
`,re=`uniform vec4 texelSize; // XY = texel size, ZW = half texel size
uniform float kernel;
uniform float scale;

varying vec2 vUv0;
varying vec2 vUv1;
varying vec2 vUv2;
varying vec2 vUv3;

void main() {

	vec2 uv = position.xy * 0.5 + 0.5;
	vec2 dUv = (texelSize.xy * vec2(kernel) + texelSize.zw) * scale;

	vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
	vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
	vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
	vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`,ve=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])];class Be extends r.jyz{constructor(T=new r.Ltg){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new r.xWb(null),texelSize:new r.xWb(new r.Ltg),scale:new r.xWb(1),kernel:new r.xWb(0)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:U,vertexShader:re}),this.setTexelSize(T.x,T.y),this.kernelSize=$e.MEDIUM}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setInputBuffer(T){this.inputBuffer=T}get kernelSequence(){return ve[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(T){this.uniforms.scale.value=T}getScale(){return this.uniforms.scale.value}setScale(T){this.uniforms.scale.value=T}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(T){this.uniforms.kernel.value=T}setKernel(T){this.kernel=T}setTexelSize(T,q){this.uniforms.texelSize.value.set(T,q,T*.5,q*.5)}setSize(T,q){const he=1/T,Ce=1/q;this.uniforms.texelSize.value.set(he,Ce,he*.5,Ce*.5)}}const Ge=`#include <common>
#include <dithering_pars_fragment>

#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

uniform float opacity;

varying vec2 vUv;

void main() {

	vec4 texel = texture2D(inputBuffer, vUv);
	gl_FragColor = opacity * texel;

	#include <encodings_fragment>
	#include <dithering_fragment>

}
`,Ie=`varying vec2 vUv;

void main() {

	vUv = position.xy * 0.5 + 0.5;
	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class Ct extends r.jyz{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new r.xWb(null),opacity:new r.xWb(1)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ge,vertexShader:Ie})}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setInputBuffer(T){this.uniforms.inputBuffer.value=T}getOpacity(T){return this.uniforms.opacity.value}setOpacity(T){this.uniforms.opacity.value=T}}const vt=`#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

// (1 / 4) * 0.5 = 0.125
#define WEIGHT_INNER 0.125
// (1 / 9) * 0.5 = 0.0555555
#define WEIGHT_OUTER 0.0555555

varying vec2 vUv;
varying vec2 vUv00;
varying vec2 vUv01;
varying vec2 vUv02;
varying vec2 vUv03;
varying vec2 vUv04;
varying vec2 vUv05;
varying vec2 vUv06;
varying vec2 vUv07;
varying vec2 vUv08;
varying vec2 vUv09;
varying vec2 vUv10;
varying vec2 vUv11;

float clampToBorder(const in vec2 uv) {

	return float(uv.s >= 0.0 && uv.s <= 1.0 && uv.t >= 0.0 && uv.t <= 1.0);

}

void main() {

	vec4 c = vec4(0.0);

	vec4 w = WEIGHT_INNER * vec4(
		clampToBorder(vUv00),
		clampToBorder(vUv01),
		clampToBorder(vUv02),
		clampToBorder(vUv03)
	);

	c += w.x * texture2D(inputBuffer, vUv00);
	c += w.y * texture2D(inputBuffer, vUv01);
	c += w.z * texture2D(inputBuffer, vUv02);
	c += w.w * texture2D(inputBuffer, vUv03);

	w = WEIGHT_OUTER * vec4(
		clampToBorder(vUv04),
		clampToBorder(vUv05),
		clampToBorder(vUv06),
		clampToBorder(vUv07)
	);

	c += w.x * texture2D(inputBuffer, vUv04);
	c += w.y * texture2D(inputBuffer, vUv05);
	c += w.z * texture2D(inputBuffer, vUv06);
	c += w.w * texture2D(inputBuffer, vUv07);

	w = WEIGHT_OUTER * vec4(
		clampToBorder(vUv08),
		clampToBorder(vUv09),
		clampToBorder(vUv10),
		clampToBorder(vUv11)
	);

	c += w.x * texture2D(inputBuffer, vUv08);
	c += w.y * texture2D(inputBuffer, vUv09);
	c += w.z * texture2D(inputBuffer, vUv10);
	c += w.w * texture2D(inputBuffer, vUv11);

	c += WEIGHT_OUTER * texture2D(inputBuffer, vUv);
	gl_FragColor = c;

	#include <encodings_fragment>

}
`,Sn=`uniform vec2 texelSize;

varying vec2 vUv;
varying vec2 vUv00;
varying vec2 vUv01;
varying vec2 vUv02;
varying vec2 vUv03;
varying vec2 vUv04;
varying vec2 vUv05;
varying vec2 vUv06;
varying vec2 vUv07;
varying vec2 vUv08;
varying vec2 vUv09;
varying vec2 vUv10;
varying vec2 vUv11;

void main() {

	vUv = position.xy * 0.5 + 0.5;

	vUv00 = vUv + texelSize * vec2(-1.0, 1.0);
	vUv01 = vUv + texelSize * vec2(1.0, 1.0);
	vUv02 = vUv + texelSize * vec2(-1.0, -1.0);
	vUv03 = vUv + texelSize * vec2(1.0, -1.0);

	vUv04 = vUv + texelSize * vec2(-2.0, 2.0);
	vUv05 = vUv + texelSize * vec2(0.0, 2.0);
	vUv06 = vUv + texelSize * vec2(2.0, 2.0);
	vUv07 = vUv + texelSize * vec2(-2.0, 0.0);
	vUv08 = vUv + texelSize * vec2(2.0, 0.0);
	vUv09 = vUv + texelSize * vec2(-2.0, -2.0);
	vUv10 = vUv + texelSize * vec2(0.0, -2.0);
	vUv11 = vUv + texelSize * vec2(2.0, -2.0);

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class Oi extends r.jyz{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new r.xWb(null),texelSize:new r.xWb(new r.FM8)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:vt,vertexShader:Sn})}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setSize(T,q){this.uniforms.texelSize.value.set(1/T,1/q)}}const Fi=`varying vec2 vUv;
varying vec2 vUv0;
varying vec2 vUv1;

#if THREE_REVISION < 143

	#define luminance(v) linearToRelativeLuminance(v)

#endif

#if EDGE_DETECTION_MODE != 0

	varying vec2 vUv2;
	varying vec2 vUv3;
	varying vec2 vUv4;
	varying vec2 vUv5;

#endif

#if EDGE_DETECTION_MODE == 1

	#include <common>

#endif

#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1

	#ifdef GL_FRAGMENT_PRECISION_HIGH

		uniform highp sampler2D depthBuffer;

	#else

		uniform mediump sampler2D depthBuffer;

	#endif

	float readDepth(const in vec2 uv) {

		#if DEPTH_PACKING == 3201

			return unpackRGBAToDepth(texture2D(depthBuffer, uv));

		#else

			return texture2D(depthBuffer, uv).r;

		#endif

	}

	vec3 gatherNeighbors() {

		float p = readDepth(vUv);
		float pLeft = readDepth(vUv0);
		float pTop = readDepth(vUv1);

		return vec3(p, pLeft, pTop);

	}

#elif PREDICATION_MODE == 2

	uniform sampler2D predicationBuffer;

	vec3 gatherNeighbors() {

		float p = texture2D(predicationBuffer, vUv).r;
		float pLeft = texture2D(predicationBuffer, vUv0).r;
		float pTop = texture2D(predicationBuffer, vUv1).r;

		return vec3(p, pLeft, pTop);

	}

#endif

#if PREDICATION_MODE != 0

	vec2 calculatePredicatedThreshold() {

		vec3 neighbours = gatherNeighbors();
		vec2 delta = abs(neighbours.xx - neighbours.yz);
		vec2 edges = step(PREDICATION_THRESHOLD, delta);

		return PREDICATION_SCALE * EDGE_THRESHOLD * (1.0 - PREDICATION_STRENGTH * edges);

	}

#endif

#if EDGE_DETECTION_MODE != 0

	uniform sampler2D inputBuffer;

#endif

void main() {

	#if EDGE_DETECTION_MODE == 0

		const vec2 threshold = vec2(DEPTH_THRESHOLD);

	#elif PREDICATION_MODE != 0

		vec2 threshold = calculatePredicatedThreshold();

	#else

		const vec2 threshold = vec2(EDGE_THRESHOLD);

	#endif

	#if EDGE_DETECTION_MODE == 0

		// Depth-based edge detection.

		vec3 neighbors = gatherNeighbors();
		vec2 delta = abs(neighbors.xx - vec2(neighbors.y, neighbors.z));
		vec2 edges = step(threshold, delta);

		if(dot(edges, vec2(1.0)) == 0.0) {

			discard;

		}

		gl_FragColor = vec4(edges, 0.0, 1.0);

	#elif EDGE_DETECTION_MODE == 1

		// Luma-based edge detection.

		float l = luminance(texture2D(inputBuffer, vUv).rgb);
		float lLeft = luminance(texture2D(inputBuffer, vUv0).rgb);
		float lTop  = luminance(texture2D(inputBuffer, vUv1).rgb);

		vec4 delta;
		delta.xy = abs(l - vec2(lLeft, lTop));

		vec2 edges = step(threshold, delta.xy);

		if(dot(edges, vec2(1.0)) == 0.0) {

			discard;

		}

		// Calculate right and bottom deltas.
		float lRight = luminance(texture2D(inputBuffer, vUv2).rgb);
		float lBottom  = luminance(texture2D(inputBuffer, vUv3).rgb);
		delta.zw = abs(l - vec2(lRight, lBottom));

		// Calculate the maximum delta in the direct neighborhood.
		vec2 maxDelta = max(delta.xy, delta.zw);

		// Calculate left-left and top-top deltas.
		float lLeftLeft = luminance(texture2D(inputBuffer, vUv4).rgb);
		float lTopTop = luminance(texture2D(inputBuffer, vUv5).rgb);
		delta.zw = abs(vec2(lLeft, lTop) - vec2(lLeftLeft, lTopTop));

		// Calculate the final maximum delta.
		maxDelta = max(maxDelta.xy, delta.zw);
		float finalDelta = max(maxDelta.x, maxDelta.y);

		// Local contrast adaptation.
		edges.xy *= step(finalDelta, LOCAL_CONTRAST_ADAPTATION_FACTOR * delta.xy);

		gl_FragColor = vec4(edges, 0.0, 1.0);

	#elif EDGE_DETECTION_MODE == 2

		// Chroma-based edge detection.

		vec4 delta;
		vec3 c = texture2D(inputBuffer, vUv).rgb;

		vec3 cLeft = texture2D(inputBuffer, vUv0).rgb;
		vec3 t = abs(c - cLeft);
		delta.x = max(max(t.r, t.g), t.b);

		vec3 cTop = texture2D(inputBuffer, vUv1).rgb;
		t = abs(c - cTop);
		delta.y = max(max(t.r, t.g), t.b);

		vec2 edges = step(threshold, delta.xy);

		if(dot(edges, vec2(1.0)) == 0.0) {

			discard;

		}

		// Calculate right and bottom deltas.
		vec3 cRight = texture2D(inputBuffer, vUv2).rgb;
		t = abs(c - cRight);
		delta.z = max(max(t.r, t.g), t.b);

		vec3 cBottom = texture2D(inputBuffer, vUv3).rgb;
		t = abs(c - cBottom);
		delta.w = max(max(t.r, t.g), t.b);

		// Calculate the maximum delta in the direct neighborhood.
		vec2 maxDelta = max(delta.xy, delta.zw);

		// Calculate left-left and top-top deltas.
		vec3 cLeftLeft = texture2D(inputBuffer, vUv4).rgb;
		t = abs(c - cLeftLeft);
		delta.z = max(max(t.r, t.g), t.b);

		vec3 cTopTop = texture2D(inputBuffer, vUv5).rgb;
		t = abs(c - cTopTop);
		delta.w = max(max(t.r, t.g), t.b);

		// Calculate the final maximum delta.
		maxDelta = max(maxDelta.xy, delta.zw);
		float finalDelta = max(maxDelta.x, maxDelta.y);

		// Local contrast adaptation.
		edges *= step(finalDelta, LOCAL_CONTRAST_ADAPTATION_FACTOR * delta.xy);

		gl_FragColor = vec4(edges, 0.0, 1.0);

	#endif

}
`,$r=`uniform vec2 texelSize;

varying vec2 vUv;
varying vec2 vUv0;
varying vec2 vUv1;

#if EDGE_DETECTION_MODE != 0

	varying vec2 vUv2;
	varying vec2 vUv3;
	varying vec2 vUv4;
	varying vec2 vUv5;

#endif

void main() {

	vUv = position.xy * 0.5 + 0.5;

	// Left and top texel coordinates.
	vUv0 = vUv + texelSize * vec2(-1.0, 0.0);
	vUv1 = vUv + texelSize * vec2(0.0, -1.0);

	#if EDGE_DETECTION_MODE != 0

		// Right and bottom texel coordinates.
		vUv2 = vUv + texelSize * vec2(1.0, 0.0);
		vUv3 = vUv + texelSize * vec2(0.0, 1.0);

		// Left-left and top-top texel coordinates.
		vUv4 = vUv + texelSize * vec2(-2.0, 0.0);
		vUv5 = vUv + texelSize * vec2(0.0, -2.0);

	#endif

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class Ei extends r.jyz{constructor(T=new r.FM8,q=ge.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:r.UZH.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new r.xWb(null),depthBuffer:new r.xWb(null),predicationBuffer:new r.xWb(null),texelSize:new r.xWb(T)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Fi,vertexShader:$r}),this.edgeDetectionMode=q}set depthBuffer(T){this.uniforms.depthBuffer.value=T}set depthPacking(T){this.defines.DEPTH_PACKING=T.toFixed(0),this.needsUpdate=!0}setDepthBuffer(T,q=r.z81){this.depthBuffer=T,this.depthPacking=q}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(T){this.defines.EDGE_DETECTION_MODE=T.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(T){this.edgeDetectionMode=T}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(T){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=T.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(T){this.localContrastAdaptationFactor=T}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(T){this.defines.EDGE_THRESHOLD=T.toFixed("6"),this.defines.DEPTH_THRESHOLD=(T*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(T){this.edgeDetectionThreshold=T}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(T){this.defines.PREDICATION_MODE=T.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(T){this.predicationMode=T}set predicationBuffer(T){this.uniforms.predicationBuffer.value=T}setPredicationBuffer(T){this.uniforms.predicationBuffer.value=T}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(T){this.defines.PREDICATION_THRESHOLD=T.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(T){this.predicationThreshold=T}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(T){this.defines.PREDICATION_SCALE=T.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(T){this.predicationScale=T}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(T){this.defines.PREDICATION_STRENGTH=T.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(T){this.predicationStrength=T}setSize(T,q){this.uniforms.texelSize.value.set(1/T,1/q)}}const gr=`#include <common>
#include <packing>
#include <dithering_pars_fragment>

#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)

#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

#if DEPTH_PACKING == 3201

	uniform lowp sampler2D depthBuffer;

#elif defined(GL_FRAGMENT_PRECISION_HIGH)

	uniform highp sampler2D depthBuffer;

#else

	uniform mediump sampler2D depthBuffer;

#endif

uniform vec2 resolution;
uniform vec2 texelSize;

uniform float cameraNear;
uniform float cameraFar;
uniform float aspect;
uniform float time;

varying vec2 vUv;

#if THREE_REVISION < 143

	#define luminance(v) linearToRelativeLuminance(v)

#endif

#if THREE_REVISION >= 137

	vec4 sRGBToLinear(const in vec4 value) {

		return vec4(mix(
			pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)),
			value.rgb * 0.0773993808,
			vec3(lessThanEqual(value.rgb, vec3(0.04045)))
		), value.a);

	}

#endif

float readDepth(const in vec2 uv) {

	#if DEPTH_PACKING == 3201

		return unpackRGBAToDepth(texture2D(depthBuffer, uv));

	#else

		return texture2D(depthBuffer, uv).r;

	#endif

}

float getViewZ(const in float depth) {

	#ifdef PERSPECTIVE_CAMERA

		return perspectiveDepthToViewZ(depth, cameraNear, cameraFar);

	#else

		return orthographicDepthToViewZ(depth, cameraNear, cameraFar);

	#endif

}

/**
 * Based on work by Sam Hocevar, Emil Persson and Ian Taylor.
 * https://www.chilliant.com/rgb2hsv.html
 */

vec3 RGBToHCV(const in vec3 RGB) {

	vec4 P = mix(vec4(RGB.bg, -1.0, 2.0 / 3.0), vec4(RGB.gb, 0.0, -1.0 / 3.0), step(RGB.b, RGB.g));
	vec4 Q = mix(vec4(P.xyw, RGB.r), vec4(RGB.r, P.yzx), step(P.x, RGB.r));
	float C = Q.x - min(Q.w, Q.y);
	float H = abs((Q.w - Q.y) / (6.0 * C + EPSILON) + Q.z);
	return vec3(H, C, Q.x);

}

vec3 RGBToHSL(const in vec3 RGB) {

	vec3 HCV = RGBToHCV(RGB);
	float L = HCV.z - HCV.y * 0.5;
	float S = HCV.y / (1.0 - abs(L * 2.0 - 1.0) + EPSILON);
	return vec3(HCV.x, S, L);

}

vec3 HueToRGB(const in float H) {

	float R = abs(H * 6.0 - 3.0) - 1.0;
	float G = 2.0 - abs(H * 6.0 - 2.0);
	float B = 2.0 - abs(H * 6.0 - 4.0);
	return clamp(vec3(R, G, B), 0.0, 1.0);

}

vec3 HSLToRGB(const in vec3 HSL) {

	vec3 RGB = HueToRGB(HSL.x);
	float C = (1.0 - abs(2.0 * HSL.z - 1.0)) * HSL.y;
	return (RGB - 0.5) * C + HSL.z;

}

FRAGMENT_HEAD

void main() {

	FRAGMENT_MAIN_UV

	vec4 color0 = texture2D(inputBuffer, UV);
	vec4 color1 = vec4(0.0);

	FRAGMENT_MAIN_IMAGE

	gl_FragColor = color0;

	#ifdef ENCODE_OUTPUT

		#include <encodings_fragment>

	#endif

	#include <dithering_fragment>

}
`,ms=`uniform vec2 resolution;
uniform vec2 texelSize;

uniform float cameraNear;
uniform float cameraFar;
uniform float aspect;
uniform float time;

varying vec2 vUv;

VERTEX_HEAD

void main() {

	vUv = position.xy * 0.5 + 0.5;

	VERTEX_MAIN_SUPPORT

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class mt extends r.jyz{constructor(T,q,he,Ce,He=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:r.UZH.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new r.xWb(null),depthBuffer:new r.xWb(null),resolution:new r.xWb(new r.FM8),texelSize:new r.xWb(new r.FM8),cameraNear:new r.xWb(.3),cameraFar:new r.xWb(1e3),aspect:new r.xWb(1),time:new r.xWb(0)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:He}),T&&this.setShaderParts(T),q&&this.setDefines(q),he&&this.setUniforms(he),this.copyCameraSettings(Ce)}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setInputBuffer(T){this.uniforms.inputBuffer.value=T}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(T){this.uniforms.depthBuffer.value=T}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(T){this.defines.DEPTH_PACKING=T.toFixed(0),this.needsUpdate=!0}setDepthBuffer(T,q=r.z81){this.depthBuffer=T,this.depthPacking=q}setShaderData(T){this.setShaderParts(T.shaderParts),this.setDefines(T.defines),this.setUniforms(T.uniforms),this.setExtensions(T.extensions)}setShaderParts(T){return this.fragmentShader=gr.replace(ye.FRAGMENT_HEAD,T.get(ye.FRAGMENT_HEAD)||"").replace(ye.FRAGMENT_MAIN_UV,T.get(ye.FRAGMENT_MAIN_UV)||"").replace(ye.FRAGMENT_MAIN_IMAGE,T.get(ye.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=ms.replace(ye.VERTEX_HEAD,T.get(ye.VERTEX_HEAD)||"").replace(ye.VERTEX_MAIN_SUPPORT,T.get(ye.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(T){for(const q of T.entries())this.defines[q[0]]=q[1];return this.needsUpdate=!0,this}setUniforms(T){for(const q of T.entries())this.uniforms[q[0]]=q[1];return this}setExtensions(T){this.extensions={};for(const q of T)this.extensions[q]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(T){this.encodeOutput!==T&&(T?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(T){return this.encodeOutput}setOutputEncodingEnabled(T){this.encodeOutput=T}get time(){return this.uniforms.time.value}set time(T){this.uniforms.time.value=T}setDeltaTime(T){this.uniforms.time.value+=T}adoptCameraSettings(T){this.copyCameraSettings(T)}copyCameraSettings(T){T&&(this.uniforms.cameraNear.value=T.near,this.uniforms.cameraFar.value=T.far,T instanceof r.cPb?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(T,q){const he=this.uniforms;he.resolution.value.set(T,q),he.texelSize.value.set(1/T,1/q),he.aspect.value=T/q}static get Section(){return ye}}const tn=`#include <common>

#if THREE_REVISION < 143

	#define luminance(v) linearToRelativeLuminance(v)

#endif

#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

#ifdef RANGE

	uniform vec2 range;

#elif defined(THRESHOLD)

	uniform float threshold;
	uniform float smoothing;

#endif

varying vec2 vUv;

void main() {

	vec4 texel = texture2D(inputBuffer, vUv);
	float l = luminance(texel.rgb);

	#ifdef RANGE

		// Apply a luminance range mask.
		float low = step(range.x, l);
		float high = step(l, range.y);

		l *= low * high;

	#elif defined(THRESHOLD)

		l = smoothstep(threshold, threshold + smoothing, l);

	#endif

	#ifdef COLOR

		gl_FragColor = vec4(texel.rgb * l, l);

	#else

		gl_FragColor = vec4(l);

	#endif

}
`;class yn extends r.jyz{constructor(T=!1,q=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:r.UZH.replace(/\D+/g,"")},uniforms:{inputBuffer:new r.xWb(null),threshold:new r.xWb(0),smoothing:new r.xWb(1),range:new r.xWb(null)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:tn,vertexShader:Ie}),this.colorOutput=T,this.luminanceRange=q}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setInputBuffer(T){this.uniforms.inputBuffer.value=T}get threshold(){return this.uniforms.threshold.value}set threshold(T){this.smoothing>0||T>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=T}getThreshold(){return this.threshold}setThreshold(T){this.threshold=T}get smoothing(){return this.uniforms.smoothing.value}set smoothing(T){this.threshold>0||T>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=T}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(T){this.smoothing=T}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(T){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(T){T?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(T){return this.colorOutput}setColorOutputEnabled(T){this.colorOutput=T}get useRange(){return this.luminanceRange!==null}set useRange(T){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(T){T!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=T,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(T){this.luminanceRange=T}}const fi=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)

#if __VERSION__ < 300

	#define round(v) floor(v + 0.5)

#endif

#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;

#else

	uniform lowp sampler2D inputBuffer;

#endif

uniform lowp sampler2D areaTexture;
uniform lowp sampler2D searchTexture;

uniform vec2 texelSize;
uniform vec2 resolution;

varying vec2 vUv;
varying vec4 vOffset[3];
varying vec2 vPixCoord;


/**
 * Moves values to a target vector based on a given conditional vector.
 */

void movec(const in bvec2 c, inout vec2 variable, const in vec2 value) {

	if(c.x) { variable.x = value.x; }
	if(c.y) { variable.y = value.y; }

}

void movec(const in bvec4 c, inout vec4 variable, const in vec4 value) {

	movec(c.xy, variable.xy, value.xy);
	movec(c.zw, variable.zw, value.zw);

}

/**
 * Allows to decode two binary values from a bilinear-filtered access.
 *
 * Bilinear access for fetching 'e' have a 0.25 offset, and we are interested
 * in the R and G edges:
 *
 * +---G---+-------+
 * |   x o R   x   |
 * +-------+-------+
 *
 * Then, if one of these edge is enabled:
 *  Red: (0.75 * X + 0.25 * 1) => 0.25 or 1.0
 *  Green: (0.75 * 1 + 0.25 * X) => 0.75 or 1.0
 *
 * This function will unpack the values (mad + mul + round):
 * wolframalpha.com: round(x * abs(5 * x - 5 * 0.75)) plot 0 to 1
 */

vec2 decodeDiagBilinearAccess(in vec2 e) {

	e.r = e.r * abs(5.0 * e.r - 5.0 * 0.75);

	return round(e);

}

vec4 decodeDiagBilinearAccess(in vec4 e) {

	e.rb = e.rb * abs(5.0 * e.rb - 5.0 * 0.75);

	return round(e);

}

/**
 * Diagonal pattern searches.
 */

vec2 searchDiag1(const in vec2 texCoord, const in vec2 dir, out vec2 e) {

	vec4 coord = vec4(texCoord, -1.0, 1.0);
	vec3 t = vec3(texelSize, 1.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {

		if(!(coord.z < float(MAX_SEARCH_STEPS_DIAG_INT - 1) && coord.w > 0.9)) {

			break;

		}

		coord.xyz = t * vec3(dir, 1.0) + coord.xyz;
		e = texture2D(inputBuffer, coord.xy).rg;
		coord.w = dot(e, vec2(0.5));

	}

	return coord.zw;

}

vec2 searchDiag2(const in vec2 texCoord, const in vec2 dir, out vec2 e) {

	vec4 coord = vec4(texCoord, -1.0, 1.0);
	coord.x += 0.25 * texelSize.x; // See @SearchDiag2Optimization
	vec3 t = vec3(texelSize, 1.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {

		if(!(coord.z < float(MAX_SEARCH_STEPS_DIAG_INT - 1) && coord.w > 0.9)) {

			break;

		}

		coord.xyz = t * vec3(dir, 1.0) + coord.xyz;

		// @SearchDiag2Optimization
		// Fetch both edges at once using bilinear filtering.
		e = texture2D(inputBuffer, coord.xy).rg;
		e = decodeDiagBilinearAccess(e);

		// Non-optimized version:
		// e.g = texture2D(inputBuffer, coord.xy).g;
		// e.r = SMAASampleLevelZeroOffset(inputBuffer, coord.xy, vec2(1, 0)).r;

		coord.w = dot(e, vec2(0.5));

	}

	return coord.zw;

}

/**
 * Calculates the area corresponding to a certain diagonal distance and crossing
 * edges 'e'.
 */

vec2 areaDiag(const in vec2 dist, const in vec2 e, const in float offset) {

	vec2 texCoord = vec2(AREATEX_MAX_DISTANCE_DIAG, AREATEX_MAX_DISTANCE_DIAG) * e + dist;

	// Apply a scale and bias for mapping to texel space.
	texCoord = AREATEX_PIXEL_SIZE * texCoord + 0.5 * AREATEX_PIXEL_SIZE;

	// Diagonal areas are on the second half of the texture.
	texCoord.x += 0.5;

	// Move to the proper place, according to the subpixel offset.
	texCoord.y += AREATEX_SUBTEX_SIZE * offset;

	return texture2D(areaTexture, texCoord).rg;

}

/**
 * Searches for diagonal patterns and returns the corresponding weights.
 */

vec2 calculateDiagWeights(const in vec2 texCoord, const in vec2 e, const in vec4 subsampleIndices) {

	vec2 weights = vec2(0.0);

	// Search for the line ends.
	vec4 d;
	vec2 end;

	if(e.r > 0.0) {

		d.xz = searchDiag1(texCoord, vec2(-1.0,  1.0), end);
		d.x += float(end.y > 0.9);

	} else {

		d.xz = vec2(0.0);

	}

	d.yw = searchDiag1(texCoord, vec2(1.0, -1.0), end);

	if(d.x + d.y > 2.0) { // d.x + d.y + 1 > 3

		// Fetch the crossing edges.
		vec4 coords = vec4(-d.x + 0.25, d.x, d.y, -d.y - 0.25) * texelSize.xyxy + texCoord.xyxy;
		vec4 c;
		c.xy = sampleLevelZeroOffset(inputBuffer, coords.xy, vec2(-1, 0)).rg;
		c.zw = sampleLevelZeroOffset(inputBuffer, coords.zw, vec2(1, 0)).rg;
		c.yxwz = decodeDiagBilinearAccess(c.xyzw);

		// Non-optimized version:
		// vec4 coords = vec4(-d.x, d.x, d.y, -d.y) * texelSize.xyxy + texCoord.xyxy;
		// vec4 c;
		// c.x = sampleLevelZeroOffset(inputBuffer, coords.xy, vec2(-1, 0)).g;
		// c.y = sampleLevelZeroOffset(inputBuffer, coords.xy, vec2(0, 0)).r;
		// c.z = sampleLevelZeroOffset(inputBuffer, coords.zw, vec2(1, 0)).g;
		// c.w = sampleLevelZeroOffset(inputBuffer, coords.zw, vec2(1, -1)).r;

		// Merge crossing edges at each side into a single value.
		vec2 cc = vec2(2.0) * c.xz + c.yw;

		// Remove the crossing edge if no end of the line could be found.
		movec(bvec2(step(0.9, d.zw)), cc, vec2(0.0));

		// Fetch the areas for this line.
		weights += areaDiag(d.xy, cc, subsampleIndices.z);

	}

	// Search for the line ends.
	d.xz = searchDiag2(texCoord, vec2(-1.0, -1.0), end);

	if(sampleLevelZeroOffset(inputBuffer, texCoord, vec2(1, 0)).r > 0.0) {

		d.yw = searchDiag2(texCoord, vec2(1.0), end);
		d.y += float(end.y > 0.9);

	} else {

		d.yw = vec2(0.0);

	}

	if(d.x + d.y > 2.0) { // d.x + d.y + 1 > 3

		// Fetch the crossing edges.
		vec4 coords = vec4(-d.x, -d.x, d.y, d.y) * texelSize.xyxy + texCoord.xyxy;
		vec4 c;
		c.x = sampleLevelZeroOffset(inputBuffer, coords.xy, vec2(-1, 0)).g;
		c.y = sampleLevelZeroOffset(inputBuffer, coords.xy, vec2(0, -1)).r;
		c.zw = sampleLevelZeroOffset(inputBuffer, coords.zw, vec2(1, 0)).gr;
		vec2 cc = vec2(2.0) * c.xz + c.yw;

		// Remove the crossing edge if no end of the line could be found.
		movec(bvec2(step(0.9, d.zw)), cc, vec2(0.0));

		// Fetch the areas for this line.
		weights += areaDiag(d.xy, cc, subsampleIndices.w).gr;

	}

	return weights;

}

/**
 * Determines how much length should be added in the last step of the searches.
 *
 * Takes the bilinearly interpolated edge (see @PSEUDO_GATHER4), and adds 0, 1
 * or 2 depending on which edges and crossing edges are active.
 */

float searchLength(const in vec2 e, const in float offset) {

	/* The texture is flipped vertically, with left and right cases taking half
	of the space horizontally. */
	vec2 scale = SEARCHTEX_SIZE * vec2(0.5, -1.0);
	vec2 bias = SEARCHTEX_SIZE * vec2(offset, 1.0);

	// Scale and bias to access texel centers.
	scale += vec2(-1.0, 1.0);
	bias += vec2(0.5, -0.5);

	// Convert from pixel coordinates to texcoords.
	scale *= 1.0 / SEARCHTEX_PACKED_SIZE;
	bias *= 1.0 / SEARCHTEX_PACKED_SIZE;

	return texture2D(searchTexture, scale * e + bias).r;

}

/**
 * Horizontal search for the second pass.
 */

float searchXLeft(in vec2 texCoord, const in float end) {

	/* @PSEUDO_GATHER4
	This texCoord has been offset by (-0.25, -0.125) in the vertex shader to
	sample between edges, thus fetching four edges in a row.
	Sampling with different offsets in each direction allows to disambiguate
	which edges are active from the four fetched ones. */

	vec2 e = vec2(0.0, 1.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {

		if(!(texCoord.x > end && e.g > 0.8281 && e.r == 0.0)) {

			break;

		}

		e = texture2D(inputBuffer, texCoord).rg;
		texCoord = vec2(-2.0, 0.0) * texelSize + texCoord;

	}

	float offset = -(255.0 / 127.0) * searchLength(e, 0.0) + 3.25;

	return texelSize.x * offset + texCoord.x;

	// Non-optimized version:
	// Correct the previous (-0.25, -0.125) offset.
	// texCoord.x += 0.25 * texelSize.x;
	// The searches are biased by 1, so adjust the coords accordingly.
	// texCoord.x += texelSize.x;
	// Disambiguate the length added by the last step.
	// texCoord.x += 2.0 * texelSize.x; // Undo last step.
	// texCoord.x -= texelSize.x * (255.0 / 127.0) * searchLength(e, 0.0);
	// return texelSize.x * offset + texCoord.x);

}

float searchXRight(vec2 texCoord, const in float end) {

	vec2 e = vec2(0.0, 1.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {

		if(!(texCoord.x < end && e.g > 0.8281 && e.r == 0.0)) {

			break;

		}

		e = texture2D(inputBuffer, texCoord).rg;
		texCoord = vec2(2.0, 0.0) * texelSize.xy + texCoord;

	}

	float offset = -(255.0 / 127.0) * searchLength(e, 0.5) + 3.25;

	return -texelSize.x * offset + texCoord.x;

}

/**
 * Vertical search for the second pass.
 */

float searchYUp(vec2 texCoord, const in float end) {

	vec2 e = vec2(1.0, 0.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; ++i) {

		if(!(texCoord.y > end && e.r > 0.8281 && e.g == 0.0)) {

			break;

		}

		e = texture2D(inputBuffer, texCoord).rg;
		texCoord = -vec2(0.0, 2.0) * texelSize.xy + texCoord;

	}

	float offset = -(255.0 / 127.0) * searchLength(e.gr, 0.0) + 3.25;

	return texelSize.y * offset + texCoord.y;

}

float searchYDown(vec2 texCoord, const in float end) {

	vec2 e = vec2(1.0, 0.0);

	for(int i = 0; i < MAX_SEARCH_STEPS_INT; i++) {

		if(!(texCoord.y < end && e.r > 0.8281 && e.g == 0.0)) {

			break;

		}

		e = texture2D(inputBuffer, texCoord).rg;
		texCoord = vec2(0.0, 2.0) * texelSize.xy + texCoord;

	}

	float offset = -(255.0 / 127.0) * searchLength(e.gr, 0.5) + 3.25;

	return -texelSize.y * offset + texCoord.y;

}

/**
 * Determines the areas at each side of the current edge.
 */

vec2 area(const in vec2 dist, const in float e1, const in float e2, const in float offset) {

	// Rounding prevents precision errors of bilinear filtering.
	vec2 texCoord = vec2(AREATEX_MAX_DISTANCE) * round(4.0 * vec2(e1, e2)) + dist;

	// Apply a scale and bias for mapping to texel space.
	texCoord = AREATEX_PIXEL_SIZE * texCoord + 0.5 * AREATEX_PIXEL_SIZE;

	// Move to the proper place, according to the subpixel offset.
	texCoord.y = AREATEX_SUBTEX_SIZE * offset + texCoord.y;

	return texture2D(areaTexture, texCoord).rg;

}

/**
 * Corner detection.
 */

void detectHorizontalCornerPattern(inout vec2 weights, const in vec4 texCoord, const in vec2 d) {

	#if !defined(DISABLE_CORNER_DETECTION)

		vec2 leftRight = step(d.xy, d.yx);
		vec2 rounding = (1.0 - CORNER_ROUNDING_NORM) * leftRight;

		// Reduce blending for pixels in the center of a line.
		rounding /= leftRight.x + leftRight.y;

		vec2 factor = vec2(1.0);
		factor.x -= rounding.x * sampleLevelZeroOffset(inputBuffer, texCoord.xy, vec2(0, 1)).r;
		factor.x -= rounding.y * sampleLevelZeroOffset(inputBuffer, texCoord.zw, vec2(1, 1)).r;
		factor.y -= rounding.x * sampleLevelZeroOffset(inputBuffer, texCoord.xy, vec2(0, -2)).r;
		factor.y -= rounding.y * sampleLevelZeroOffset(inputBuffer, texCoord.zw, vec2(1, -2)).r;

		weights *= clamp(factor, 0.0, 1.0);

	#endif

}

void detectVerticalCornerPattern(inout vec2 weights, const in vec4 texCoord, const in vec2 d) {

	#if !defined(DISABLE_CORNER_DETECTION)

		vec2 leftRight = step(d.xy, d.yx);
		vec2 rounding = (1.0 - CORNER_ROUNDING_NORM) * leftRight;

		rounding /= leftRight.x + leftRight.y;

		vec2 factor = vec2(1.0);
		factor.x -= rounding.x * sampleLevelZeroOffset(inputBuffer, texCoord.xy, vec2(1, 0)).g;
		factor.x -= rounding.y * sampleLevelZeroOffset(inputBuffer, texCoord.zw, vec2(1, 1)).g;
		factor.y -= rounding.x * sampleLevelZeroOffset(inputBuffer, texCoord.xy, vec2(-2, 0)).g;
		factor.y -= rounding.y * sampleLevelZeroOffset(inputBuffer, texCoord.zw, vec2(-2, 1)).g;

		weights *= clamp(factor, 0.0, 1.0);

	#endif

}

void main() {

	vec4 weights = vec4(0.0);
	vec4 subsampleIndices = vec4(0.0);
	vec2 e = texture2D(inputBuffer, vUv).rg;

	if(e.g > 0.0) {

		// Edge at north.

		#if !defined(DISABLE_DIAG_DETECTION)

			/* Diagonals have both north and west edges, so searching for them in one of
			the boundaries is enough. */
			weights.rg = calculateDiagWeights(vUv, e, subsampleIndices);

			// Skip horizontal/vertical processing if there is a diagonal.
			if(weights.r == -weights.g) { // weights.r + weights.g == 0.0

		#endif

		vec2 d;

		// Find the distance to the left.
		vec3 coords;
		coords.x = searchXLeft(vOffset[0].xy, vOffset[2].x);
		coords.y = vOffset[1].y; // vOffset[1].y = vUv.y - 0.25 * texelSize.y (@CROSSING_OFFSET)
		d.x = coords.x;

		/* Now fetch the left crossing edges, two at a time using bilinear
		filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to discern what
		value each edge has. */
		float e1 = texture2D(inputBuffer, coords.xy).r;

		// Find the distance to the right.
		coords.z = searchXRight(vOffset[0].zw, vOffset[2].y);
		d.y = coords.z;

		/* Translate distances to pixel units for better interleave arithmetic and
		memory accesses. */
		d = round(resolution.xx * d + -vPixCoord.xx);

		// The area texture is compressed quadratically.
		vec2 sqrtD = sqrt(abs(d));

		// Fetch the right crossing edges.
		float e2 = sampleLevelZeroOffset(inputBuffer, coords.zy, vec2(1, 0)).r;

		// Pattern recognized, now get the actual area.
		weights.rg = area(sqrtD, e1, e2, subsampleIndices.y);

		// Fix corners.
		coords.y = vUv.y;
		detectHorizontalCornerPattern(weights.rg, coords.xyzy, d);

		#if !defined(DISABLE_DIAG_DETECTION)

			} else {

				// Skip vertical processing.
				e.r = 0.0;

			}

		#endif

	}

	if(e.r > 0.0) {

		// Edge at west.

		vec2 d;

		// Find the distance to the top.
		vec3 coords;
		coords.y = searchYUp(vOffset[1].xy, vOffset[2].z);
		coords.x = vOffset[0].x; // vOffset[1].x = vUv.x - 0.25 * texelSize.x;
		d.x = coords.y;

		// Fetch the top crossing edges.
		float e1 = texture2D(inputBuffer, coords.xy).g;

		// Find the distance to the bottom.
		coords.z = searchYDown(vOffset[1].zw, vOffset[2].w);
		d.y = coords.z;

		// Translate distances into pixel units.
		d = round(resolution.yy * d - vPixCoord.yy);

		// The area texture is compressed quadratically.
		vec2 sqrtD = sqrt(abs(d));

		// Fetch the bottom crossing edges.
		float e2 = sampleLevelZeroOffset(inputBuffer, coords.xz, vec2(0, 1)).g;

		// Get the area for this direction.
		weights.ba = area(sqrtD, e1, e2, subsampleIndices.x);

		// Fix corners.
		coords.x = vUv.x;
		detectVerticalCornerPattern(weights.ba, coords.xyxz, d);

	}

	gl_FragColor = weights;

}
`,wi=`uniform vec2 texelSize;
uniform vec2 resolution;

varying vec2 vUv;
varying vec4 vOffset[3];
varying vec2 vPixCoord;

void main() {

	vUv = position.xy * 0.5 + 0.5;
	vPixCoord = vUv * resolution;

	// Offsets for the searches (see @PSEUDO_GATHER4).
	vOffset[0] = vUv.xyxy + texelSize.xyxy * vec4(-0.25, -0.125, 1.25, -0.125);
	vOffset[1] = vUv.xyxy + texelSize.xyxy * vec4(-0.125, -0.25, -0.125, 1.25);

	// This indicates the ends of the loops.
	vOffset[2] = vec4(vOffset[0].xz, vOffset[1].yw) +
		vec4(-2.0, 2.0, -2.0, 2.0) * texelSize.xxyy * MAX_SEARCH_STEPS_FLOAT;

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class Ds extends r.jyz{constructor(T=new r.FM8,q=new r.FM8){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new r.xWb(null),searchTexture:new r.xWb(null),areaTexture:new r.xWb(null),resolution:new r.xWb(q),texelSize:new r.xWb(T)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:fi,vertexShader:wi})}set inputBuffer(T){this.uniforms.inputBuffer.value=T}setInputBuffer(T){this.uniforms.inputBuffer.value=T}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(T){this.uniforms.searchTexture.value=T}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(T){this.uniforms.areaTexture.value=T}setLookupTextures(T,q){this.searchTexture=T,this.areaTexture=q}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(T){const q=Math.min(Math.max(T,0),112);this.defines.MAX_SEARCH_STEPS_INT=q.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=q.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(T){this.orthogonalSearchSteps=T}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(T){const q=Math.min(Math.max(T,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=q.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=q.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(T){this.diagonalSearchSteps=T}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(T){T?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(T){this.diagonalDetection=T}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(T){const q=Math.min(Math.max(T,0),100);this.defines.CORNER_ROUNDING=q.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(q/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(T){this.cornerRounding=T}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(T){T?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(T){this.cornerDetection=T}setSize(T,q){const he=this.uniforms;he.texelSize.value.set(1/T,1/q),he.resolution.value.set(T,q)}}const es=`#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D inputBuffer;
	uniform mediump sampler2D supportBuffer;

#else

	uniform lowp sampler2D inputBuffer;
	uniform lowp sampler2D supportBuffer;

#endif

uniform float radius;

varying vec2 vUv;
varying vec2 vUv0;
varying vec2 vUv1;
varying vec2 vUv2;
varying vec2 vUv3;
varying vec2 vUv4;
varying vec2 vUv5;
varying vec2 vUv6;
varying vec2 vUv7;

void main() {

	vec4 c = vec4(0.0);

	c += texture2D(inputBuffer, vUv0) * 0.0625;
	c += texture2D(inputBuffer, vUv1) * 0.125;
	c += texture2D(inputBuffer, vUv2) * 0.0625;
	c += texture2D(inputBuffer, vUv3) * 0.125;
	c += texture2D(inputBuffer, vUv) * 0.25;
	c += texture2D(inputBuffer, vUv4) * 0.125;
	c += texture2D(inputBuffer, vUv5) * 0.0625;
	c += texture2D(inputBuffer, vUv6) * 0.125;
	c += texture2D(inputBuffer, vUv7) * 0.0625;

	vec4 baseColor = texture2D(supportBuffer, vUv);
	gl_FragColor = mix(baseColor, c, radius);

	#include <encodings_fragment>

}
`,ba=`uniform vec2 texelSize;

varying vec2 vUv;
varying vec2 vUv0;
varying vec2 vUv1;
varying vec2 vUv2;
varying vec2 vUv3;
varying vec2 vUv4;
varying vec2 vUv5;
varying vec2 vUv6;
varying vec2 vUv7;

void main() {

	vUv = position.xy * 0.5 + 0.5;

	vUv0 = vUv + texelSize * vec2(-1.0, 1.0);
	vUv1 = vUv + texelSize * vec2(0.0, 1.0);
	vUv2 = vUv + texelSize * vec2(1.0, 1.0);
	vUv3 = vUv + texelSize * vec2(-1.0, 0.0);

	vUv4 = vUv + texelSize * vec2(1.0, 0.0);
	vUv5 = vUv + texelSize * vec2(-1.0, -1.0);
	vUv6 = vUv + texelSize * vec2(0.0, -1.0);
	vUv7 = vUv + texelSize * vec2(1.0, -1.0);

	gl_Position = vec4(position.xy, 1.0, 1.0);

}
`;class gs extends r.jyz{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new r.xWb(null),supportBuffer:new r.xWb(null),texelSize:new r.xWb(new r.FM8),radius:new r.xWb(.85)},blending:r.jFi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:es,vertexShader:ba})}set inputBuffer(T){this.uniforms.inputBuffer.value=T}set supportBuffer(T){this.uniforms.supportBuffer.value=T}get radius(){return this.uniforms.radius.value}set radius(T){this.uniforms.radius.value=T}setSize(T,q){this.uniforms.texelSize.value.set(1/T,1/q)}}const vo=new r.V1s;let Hs=null;function nl(){if(Hs===null){const Pt=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),T=new Float32Array([0,0,2,0,0,2]);Hs=new r.u9r,Hs.setAttribute!==void 0?(Hs.setAttribute("position",new r.TlE(Pt,3)),Hs.setAttribute("uv",new r.TlE(T,2))):(Hs.addAttribute("position",new r.TlE(Pt,3)),Hs.addAttribute("uv",new r.TlE(T,2)))}return Hs}class vr{constructor(T="Pass",q=new r.xsS,he=vo){this.name=T,this.renderer=null,this.scene=q,this.camera=he,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(T){if(this.rtt===T){const q=this.fullscreenMaterial;q!==null&&(q.needsUpdate=!0),this.rtt=!T}}set mainScene(T){}set mainCamera(T){}setRenderer(T){this.renderer=T}isEnabled(){return this.enabled}setEnabled(T){this.enabled=T}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(T){let q=this.screen;q!==null?q.material=T:(q=new r.Kj0(nl(),T),q.frustumCulled=!1,this.scene===null&&(this.scene=new r.xsS),this.scene.add(q),this.screen=q)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(T){this.fullscreenMaterial=T}getDepthTexture(){return null}setDepthTexture(T,q=r.z81){}render(T,q,he,Ce,He){throw new Error("Render method not implemented!")}setSize(T,q){}initialize(T,q,he){}dispose(){for(const T of Object.keys(this)){const q=this[T];(q instanceof r.dd2||q instanceof r.F5T||q instanceof r.xEZ||q instanceof vr)&&this[T].dispose()}}}class ru extends vr{constructor(T,q=!0){super("CopyPass"),this.fullscreenMaterial=new Ct,this.needsSwap=!1,this.renderTarget=T,T===void 0&&(this.renderTarget=new r.dd2(1,1,{minFilter:r.wem,magFilter:r.wem,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=q}get resize(){return this.autoResize}set resize(T){this.autoResize=T}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(T){this.autoResize=T}render(T,q,he,Ce,He){this.fullscreenMaterial.inputBuffer=q.texture,T.setRenderTarget(this.renderToScreen?null:this.renderTarget),T.render(this.scene,this.camera)}setSize(T,q){this.autoResize&&this.renderTarget.setSize(T,q)}initialize(T,q,he){he!==void 0&&(this.renderTarget.texture.type=he,he!==r.ywz?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":X(T)===p&&$(this.renderTarget.texture,p))}}class G extends vr{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(T,q,he,Ce,He){const Ze=T.state.buffers.stencil;Ze.setLocked(!1),Ze.setTest(!1)}}const Xl=new r.Ilk;class Qi extends vr{constructor(T=!0,q=!0,he=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=T,this.depth=q,this.stencil=he,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(T,q,he){this.color=T,this.depth=q,this.stencil=he}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(T){this.overrideClearColor=T}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(T){this.overrideClearAlpha=T}render(T,q,he,Ce,He){const Ze=this.overrideClearColor,at=this.overrideClearAlpha,zt=T.getClearAlpha(),Cn=Ze!==null,qn=at>=0;Cn?(T.getClearColor(Xl),T.setClearColor(Ze,qn?at:zt)):qn&&T.setClearAlpha(at),T.setRenderTarget(this.renderToScreen?null:q),T.clear(this.color,this.depth,this.stencil),Cn?T.setClearColor(Xl,zt):qn&&T.setClearAlpha(zt)}}const lr=-1;class zr extends r.pBf{constructor(T,q=lr,he=lr,Ce=1){super(),this.resizable=T,this.baseSize=new r.FM8(1,1),this.preferredSize=new r.FM8(q,he),this.target=this.preferredSize,this.s=Ce,this.effectiveSize=new r.FM8,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const T=this.baseSize,q=this.preferredSize,he=this.effectiveSize,Ce=this.scale;q.width!==lr?he.width=q.width:q.height!==lr?he.width=Math.round(q.height*(T.width/Math.max(T.height,1))):he.width=Math.round(T.width*Ce),q.height!==lr?he.height=q.height:q.width!==lr?he.height=Math.round(q.width/Math.max(T.width/Math.max(T.height,1),1)):he.height=Math.round(T.height*Ce)}get width(){return this.effectiveSize.width}set width(T){this.preferredWidth=T}get height(){return this.effectiveSize.height}set height(T){this.preferredHeight=T}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(T){this.s!==T&&(this.s=T,this.preferredSize.setScalar(lr),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(T){this.scale=T}get baseWidth(){return this.baseSize.width}set baseWidth(T){this.baseSize.width!==T&&(this.baseSize.width=T,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(T){this.baseWidth=T}get baseHeight(){return this.baseSize.height}set baseHeight(T){this.baseSize.height!==T&&(this.baseSize.height=T,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(T){this.baseHeight=T}setBaseSize(T,q){(this.baseSize.width!==T||this.baseSize.height!==q)&&(this.baseSize.set(T,q),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(T){this.preferredSize.width!==T&&(this.preferredSize.width=T,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(T){this.preferredWidth=T}get preferredHeight(){return this.preferredSize.height}set preferredHeight(T){this.preferredSize.height!==T&&(this.preferredSize.height=T,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(T){this.preferredHeight=T}setPreferredSize(T,q){(this.preferredSize.width!==T||this.preferredSize.height!==q)&&(this.preferredSize.set(T,q),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(T){this.s=T.scale,this.baseSize.set(T.baseWidth,T.baseHeight),this.preferredSize.set(T.preferredWidth,T.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return lr}}let Gr=!1;class Yl{constructor(T=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(T),this.meshCount=0,this.replaceMaterial=q=>{if(q.isMesh){let he;if(q.material.flatShading)switch(q.material.side){case r.ehD:he=this.materialsFlatShadedDoubleSide;break;case r._Li:he=this.materialsFlatShadedBackSide;break;default:he=this.materialsFlatShaded;break}else switch(q.material.side){case r.ehD:he=this.materialsDoubleSide;break;case r._Li:he=this.materialsBackSide;break;default:he=this.materials;break}this.originalMaterials.set(q,q.material),q.isSkinnedMesh?q.material=he[2]:q.isInstancedMesh?q.material=he[1]:q.material=he[0],++this.meshCount}}}cloneMaterial(T){if(!(T instanceof r.jyz))return T.clone();const q=T.uniforms,he=new Map;for(const He in q){const Ze=q[He].value;Ze.isRenderTargetTexture&&(q[He].value=null,he.set(He,Ze))}const Ce=T.clone();for(const He of he)q[He[0]].value=He[1],Ce.uniforms[He[0]].value=He[1];return Ce}setMaterial(T){if(this.disposeMaterials(),this.material=T,T!==null){const q=this.materials=[this.cloneMaterial(T),this.cloneMaterial(T),this.cloneMaterial(T)];for(const he of q)he.uniforms=Object.assign({},T.uniforms),he.side=r.Wl3;q[2].skinning=!0,this.materialsBackSide=q.map(he=>{const Ce=this.cloneMaterial(he);return Ce.uniforms=Object.assign({},T.uniforms),Ce.side=r._Li,Ce}),this.materialsDoubleSide=q.map(he=>{const Ce=this.cloneMaterial(he);return Ce.uniforms=Object.assign({},T.uniforms),Ce.side=r.ehD,Ce}),this.materialsFlatShaded=q.map(he=>{const Ce=this.cloneMaterial(he);return Ce.uniforms=Object.assign({},T.uniforms),Ce.flatShading=!0,Ce}),this.materialsFlatShadedBackSide=q.map(he=>{const Ce=this.cloneMaterial(he);return Ce.uniforms=Object.assign({},T.uniforms),Ce.flatShading=!0,Ce.side=r._Li,Ce}),this.materialsFlatShadedDoubleSide=q.map(he=>{const Ce=this.cloneMaterial(he);return Ce.uniforms=Object.assign({},T.uniforms),Ce.flatShading=!0,Ce.side=r.ehD,Ce})}}render(T,q,he){const Ce=T.shadowMap.enabled;if(T.shadowMap.enabled=!1,Gr){const He=this.originalMaterials;this.meshCount=0,q.traverse(this.replaceMaterial),T.render(q,he);for(const Ze of He)Ze[0].material=Ze[1];this.meshCount!==He.size&&He.clear()}else{const He=q.overrideMaterial;q.overrideMaterial=this.material,T.render(q,he),q.overrideMaterial=He}T.shadowMap.enabled=Ce}disposeMaterials(){if(this.material!==null){const T=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const q of T)q.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Gr}static set workaroundEnabled(T){Gr=T}}class bh extends vr{constructor(T,q,he=null){super("RenderPass",T,q),this.needsSwap=!1,this.clearPass=new Qi,this.overrideMaterialManager=he===null?null:new Yl(he),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(T){this.scene=T}set mainCamera(T){this.camera=T}get renderToScreen(){return super.renderToScreen}set renderToScreen(T){super.renderToScreen=T,this.clearPass.renderToScreen=T}get overrideMaterial(){const T=this.overrideMaterialManager;return T!==null?T.material:null}set overrideMaterial(T){const q=this.overrideMaterialManager;T!==null?q!==null?q.setMaterial(T):this.overrideMaterialManager=new Yl(T):q!==null&&(q.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(T){this.overrideMaterial=T}get clear(){return this.clearPass.enabled}set clear(T){this.clearPass.enabled=T}getSelection(){return this.selection}setSelection(T){this.selection=T}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(T){this.ignoreBackground=T}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(T){this.skipShadowMapUpdate=T}getClearPass(){return this.clearPass}render(T,q,he,Ce,He){const Ze=this.scene,at=this.camera,zt=this.selection,Cn=at.layers.mask,qn=Ze.background,Ot=T.shadowMap.autoUpdate,oi=this.renderToScreen?null:q;zt!==null&&at.layers.set(zt.getLayer()),this.skipShadowMapUpdate&&(T.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(Ze.background=null),this.clearPass.enabled&&(this.clearPass.setClearFlags(T.autoClearColor,T.autoClearDepth,T.autoClearStencil),this.clearPass.render(T,q)),T.setRenderTarget(oi),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(T,Ze,at):T.render(Ze,at),at.layers.mask=Cn,Ze.background=qn,T.shadowMap.autoUpdate=Ot}}function Ql(Pt,T,q){for(const he of T){const Ce="$1"+Pt+he.charAt(0).toUpperCase()+he.slice(1),He=new RegExp("([^\\.])(\\b"+he+"\\b)","g");for(const Ze of q.entries())Ze[1]!==null&&q.set(Ze[0],Ze[1].replace(He,Ce))}}function su(Pt,T,q){let he=T.getFragmentShader(),Ce=T.getVertexShader();const He=he!==void 0&&/mainImage/.test(he),Ze=he!==void 0&&/mainUv/.test(he);if(q.attributes|=T.getAttributes(),he===void 0)throw new Error(`Missing fragment shader (${T.name})`);if(Ze&&q.attributes&be.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${T.name})`);if(!He&&!Ze)throw new Error(`Could not find mainImage or mainUv function (${T.name})`);{const at=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,zt=q.shaderParts;let Cn=zt.get(ye.FRAGMENT_HEAD)||"",qn=zt.get(ye.FRAGMENT_MAIN_UV)||"",Ot=zt.get(ye.FRAGMENT_MAIN_IMAGE)||"",oi=zt.get(ye.VERTEX_HEAD)||"",yi=zt.get(ye.VERTEX_MAIN_SUPPORT)||"";const xr=new Set,_i=new Set;if(Ze&&(qn+=`	${Pt}MainUv(UV);
`,q.uvTransformation=!0),Ce!==null&&/mainSupport/.test(Ce)){const Ki=/mainSupport *\([\w\s]*?uv\s*?\)/.test(Ce);yi+=`	${Pt}MainSupport(`,yi+=Ki?`vUv);
`:`);
`;for(const br of Ce.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const pu of br[1].split(/\s*,\s*/))q.varyings.add(pu),xr.add(pu),_i.add(pu);for(const br of Ce.matchAll(at))_i.add(br[1])}for(const Ki of he.matchAll(at))_i.add(Ki[1]);for(const Ki of T.defines.keys())_i.add(Ki.replace(/\([\w\s,]*\)/g,""));for(const Ki of T.uniforms.keys())_i.add(Ki);_i.delete("while"),_i.delete("for"),_i.delete("if"),T.uniforms.forEach((Ki,br)=>q.uniforms.set(Pt+br.charAt(0).toUpperCase()+br.slice(1),Ki)),T.defines.forEach((Ki,br)=>q.defines.set(Pt+br.charAt(0).toUpperCase()+br.slice(1),Ki));const Xs=new Map([["fragment",he],["vertex",Ce]]);Ql(Pt,_i,q.defines),Ql(Pt,_i,Xs),he=Xs.get("fragment"),Ce=Xs.get("vertex");const So=T.blendMode;if(q.blendModes.set(So.blendFunction,So),He){T.inputColorSpace!==null&&T.inputColorSpace!==q.colorSpace&&(Ot+=T.inputColorSpace===p?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),T.outputColorSpace!==o?q.colorSpace=T.outputColorSpace:T.inputColorSpace!==null&&(q.colorSpace=T.inputColorSpace);const Ki=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;Ot+=`${Pt}MainImage(color0, UV, `,q.attributes&be.DEPTH&&Ki.test(he)&&(Ot+="depth, ",q.readDepth=!0),Ot+=`color1);
	`;const br=Pt+"BlendOpacity";q.uniforms.set(br,So.opacity),Ot+=`color0 = blend${So.blendFunction}(color0, color1, ${br});

	`,Cn+=`uniform float ${br};

`}if(Cn+=he+`
`,Ce!==null&&(oi+=Ce+`
`),zt.set(ye.FRAGMENT_HEAD,Cn),zt.set(ye.FRAGMENT_MAIN_UV,qn),zt.set(ye.FRAGMENT_MAIN_IMAGE,Ot),zt.set(ye.VERTEX_HEAD,oi),zt.set(ye.VERTEX_MAIN_SUPPORT,yi),T.extensions!==null)for(const Ki of T.extensions)q.extensions.add(Ki)}}class ou extends vr{constructor(T,...q){super("EffectPass"),this.fullscreenMaterial=new mt(null,null,null,T),this.listener=he=>this.handleEvent(he),this.effects=[],this.setEffects(q),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(T){for(const q of this.effects)q.mainScene=T}set mainCamera(T){this.fullscreenMaterial.copyCameraSettings(T);for(const q of this.effects)q.mainCamera=T}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(T){this.fullscreenMaterial.encodeOutput=T}get dithering(){return this.fullscreenMaterial.dithering}set dithering(T){const q=this.fullscreenMaterial;q.dithering=T,q.needsUpdate=!0}setEffects(T){for(const q of this.effects)q.removeEventListener("change",this.listener);this.effects=T.sort((q,he)=>he.attributes-q.attributes);for(const q of this.effects)q.addEventListener("change",this.listener)}updateMaterial(){const T=new Ti;let q=0;for(const at of this.effects)if(at.blendMode.blendFunction===Z.DST)T.attributes|=at.getAttributes()&be.DEPTH;else{if(T.attributes&at.getAttributes()&be.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${at.name})`);su("e"+q++,at,T)}let he=T.shaderParts.get(ye.FRAGMENT_HEAD),Ce=T.shaderParts.get(ye.FRAGMENT_MAIN_IMAGE),He=T.shaderParts.get(ye.FRAGMENT_MAIN_UV);const Ze=/\bblend\b/g;for(const at of T.blendModes.values())he+=at.getShaderCode().replace(Ze,`blend${at.blendFunction}`)+`
`;T.attributes&be.DEPTH?(T.readDepth&&(Ce=`float depth = readDepth(UV);

	`+Ce),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,T.colorSpace===p&&(Ce+=`color0 = sRGBToLinear(color0);
	`),T.uvTransformation?(He=`vec2 transformedUv = vUv;
`+He,T.defines.set("UV","transformedUv")):T.defines.set("UV","vUv"),T.shaderParts.set(ye.FRAGMENT_HEAD,he),T.shaderParts.set(ye.FRAGMENT_MAIN_IMAGE,Ce),T.shaderParts.set(ye.FRAGMENT_MAIN_UV,He);for(const[at,zt]of T.shaderParts)zt!==null&&T.shaderParts.set(at,zt.trim().replace(/^#/,`
#`));this.skipRendering=q===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(T)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(T,q=r.z81){this.fullscreenMaterial.depthBuffer=T,this.fullscreenMaterial.depthPacking=q;for(const he of this.effects)he.setDepthTexture(T,q)}render(T,q,he,Ce,He){for(const Ze of this.effects)Ze.update(T,q,Ce);if(!this.skipRendering||this.renderToScreen){const Ze=this.fullscreenMaterial;Ze.inputBuffer=q.texture,Ze.time+=Ce*this.timeScale,T.setRenderTarget(this.renderToScreen?null:he),T.render(this.scene,this.camera)}}setSize(T,q){this.fullscreenMaterial.setSize(T,q);for(const he of this.effects)he.setSize(T,q)}initialize(T,q,he){this.renderer=T;for(const Ce of this.effects)Ce.initialize(T,q,he);this.updateMaterial(),he!==void 0&&he!==r.ywz&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const T of this.effects)T.removeEventListener("change",this.listener),T.dispose()}handleEvent(T){switch(T.type){case"change":this.recompile();break}}}class Kl extends vr{constructor({kernelSize:T=$e.MEDIUM,resolutionScale:q=.5,width:he=zr.AUTO_SIZE,height:Ce=zr.AUTO_SIZE,resolutionX:He=he,resolutionY:Ze=Ce}={}){super("KawaseBlurPass"),this.renderTargetA=new r.dd2(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const at=this.resolution=new zr(this,He,Ze,q);at.addEventListener("change",zt=>this.setSize(at.baseWidth,at.baseHeight)),this._blurMaterial=new Be,this._blurMaterial.kernelSize=T,this.copyMaterial=new Ct}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(T){this._blurMaterial=T}get dithering(){return this.copyMaterial.dithering}set dithering(T){this.copyMaterial.dithering=T}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(T){this.blurMaterial.kernelSize=T}get width(){return this.resolution.width}set width(T){this.resolution.preferredWidth=T}get height(){return this.resolution.height}set height(T){this.resolution.preferredHeight=T}get scale(){return this.blurMaterial.scale}set scale(T){this.blurMaterial.scale=T}getScale(){return this.blurMaterial.scale}setScale(T){this.blurMaterial.scale=T}getKernelSize(){return this.kernelSize}setKernelSize(T){this.kernelSize=T}getResolutionScale(){return this.resolution.scale}setResolutionScale(T){this.resolution.scale=T}render(T,q,he,Ce,He){const Ze=this.scene,at=this.camera,zt=this.renderTargetA,Cn=this.renderTargetB,qn=this.blurMaterial,Ot=qn.kernelSequence;let oi=q;this.fullscreenMaterial=qn;for(let yi=0,xr=Ot.length;yi<xr;++yi){const _i=yi&1?Cn:zt;qn.kernel=Ot[yi],qn.inputBuffer=oi.texture,T.setRenderTarget(_i),T.render(Ze,at),oi=_i}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=oi.texture,T.setRenderTarget(this.renderToScreen?null:he),T.render(Ze,at)}setSize(T,q){const he=this.resolution;he.setBaseSize(T,q);const Ce=he.width,He=he.height;this.renderTargetA.setSize(Ce,He),this.renderTargetB.setSize(Ce,He),this.blurMaterial.setSize(T,q)}initialize(T,q,he){he!==void 0&&(this.renderTargetA.texture.type=he,this.renderTargetB.texture.type=he,he!==r.ywz?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):X(T)===p&&($(this.renderTargetA.texture,p),$(this.renderTargetB.texture,p)))}static get AUTO_SIZE(){return zr.AUTO_SIZE}}class yo extends vr{constructor({renderTarget:T,luminanceRange:q,colorOutput:he,resolutionScale:Ce=1,width:He=zr.AUTO_SIZE,height:Ze=zr.AUTO_SIZE,resolutionX:at=He,resolutionY:zt=Ze}={}){super("LuminancePass"),this.fullscreenMaterial=new yn(he,q),this.needsSwap=!1,this.renderTarget=T,this.renderTarget===void 0&&(this.renderTarget=new r.dd2(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const Cn=this.resolution=new zr(this,at,zt,Ce);Cn.addEventListener("change",qn=>this.setSize(Cn.baseWidth,Cn.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(T,q,he,Ce,He){const Ze=this.fullscreenMaterial;Ze.inputBuffer=q.texture,T.setRenderTarget(this.renderToScreen?null:this.renderTarget),T.render(this.scene,this.camera)}setSize(T,q){const he=this.resolution;he.setBaseSize(T,q),this.renderTarget.setSize(he.width,he.height)}initialize(T,q,he){he!==void 0&&he!==r.ywz&&(this.renderTarget.texture.type=he,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}class _o extends vr{constructor(T,q){super("MaskPass",T,q),this.needsSwap=!1,this.clearPass=new Qi(!1,!1,!0),this.inverse=!1}set mainScene(T){this.scene=T}set mainCamera(T){this.camera=T}get inverted(){return this.inverse}set inverted(T){this.inverse=T}get clear(){return this.clearPass.enabled}set clear(T){this.clearPass.enabled=T}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(T){this.inverted=T}render(T,q,he,Ce,He){const Ze=T.getContext(),at=T.state.buffers,zt=this.scene,Cn=this.camera,qn=this.clearPass,Ot=this.inverted?0:1,oi=1-Ot;at.color.setMask(!1),at.depth.setMask(!1),at.color.setLocked(!0),at.depth.setLocked(!0),at.stencil.setTest(!0),at.stencil.setOp(Ze.REPLACE,Ze.REPLACE,Ze.REPLACE),at.stencil.setFunc(Ze.ALWAYS,Ot,4294967295),at.stencil.setClear(oi),at.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?qn.render(T,null):(qn.render(T,q),qn.render(T,he))),this.renderToScreen?(T.setRenderTarget(null),T.render(zt,Cn)):(T.setRenderTarget(q),T.render(zt,Cn),T.setRenderTarget(he),T.render(zt,Cn)),at.color.setLocked(!1),at.depth.setLocked(!1),at.stencil.setLocked(!1),at.stencil.setFunc(Ze.EQUAL,1,4294967295),at.stencil.setOp(Ze.KEEP,Ze.KEEP,Ze.KEEP),at.stencil.setLocked(!0)}}class Ho extends vr{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new r.dd2(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Oi,this.upsamplingMaterial=new gs,this.resolution=new r.FM8}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(T){if(this.levels!==T){const q=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let he=0;he<T;++he){const Ce=q.clone();Ce.texture.name="Downsampling.Mipmap"+he,this.downsamplingMipmaps.push(Ce)}this.upsamplingMipmaps.push(q);for(let he=1,Ce=T-1;he<Ce;++he){const He=q.clone();He.texture.name="Upsampling.Mipmap"+he,this.upsamplingMipmaps.push(He)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(T){this.upsamplingMaterial.radius=T}render(T,q,he,Ce,He){const{scene:Ze,camera:at}=this,{downsamplingMaterial:zt,upsamplingMaterial:Cn}=this,{downsamplingMipmaps:qn,upsamplingMipmaps:Ot}=this;let oi=q;this.fullscreenMaterial=zt;for(let yi=0,xr=qn.length;yi<xr;++yi){const _i=qn[yi];zt.setSize(oi.width,oi.height),zt.inputBuffer=oi.texture,T.setRenderTarget(_i),T.render(Ze,at),oi=_i}this.fullscreenMaterial=Cn;for(let yi=Ot.length-1;yi>=0;--yi){const xr=Ot[yi];Cn.setSize(oi.width,oi.height),Cn.inputBuffer=oi.texture,Cn.supportBuffer=qn[yi].texture,T.setRenderTarget(xr),T.render(Ze,at),oi=xr}}setSize(T,q){const he=this.resolution;he.set(T,q);let Ce=he.width,He=he.height;for(let Ze=0,at=this.downsamplingMipmaps.length;Ze<at;++Ze)Ce=Math.round(Ce*.5),He=Math.round(He*.5),this.downsamplingMipmaps[Ze].setSize(Ce,He),Ze<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[Ze].setSize(Ce,He)}initialize(T,q,he){if(he!==void 0){const Ce=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const He of Ce)He.texture.type=he;if(he!==r.ywz)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(X(T)===p)for(const He of Ce)$(He.texture,p)}}dispose(){super.dispose();for(const T of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))T.dispose()}}class zn extends vr{constructor(T,q="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=T,this.input=q}setInput(T){this.input=T}render(T,q,he,Ce,He){const Ze=this.fullscreenMaterial.uniforms;q!==null&&Ze!==void 0&&Ze[this.input]!==void 0&&(Ze[this.input].value=q.texture),T.setRenderTarget(this.renderToScreen?null:he),T.render(this.scene,this.camera)}initialize(T,q,he){he!==void 0&&he!==r.ywz&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}}const yr=1/1e3,Vs=1e3;class Bi{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(T){typeof document<"u"&&document.hidden!==void 0&&(T?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=T)}get delta(){return this._delta*yr}get fixedDelta(){return this._fixedDelta*yr}set fixedDelta(T){this._fixedDelta=T*Vs}get elapsed(){return this._elapsed*yr}update(T){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(T!==void 0?T:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(T){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}}class wa{constructor(T=null,{depthBuffer:q=!0,stencilBuffer:he=!1,multisampling:Ce=0,frameBufferType:He}={}){this.renderer=null,this.inputBuffer=this.createBuffer(q,he,He,Ce),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new ru,this.depthTexture=null,this.passes=[],this.timer=new Bi,this.autoRenderToScreen=!0,this.setRenderer(T)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(T){const q=this.inputBuffer,he=this.multisampling;he>0&&T>0?(this.inputBuffer.samples=T,this.outputBuffer.samples=T,this.inputBuffer.dispose(),this.outputBuffer.dispose()):he!==T&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(q.depthBuffer,q.stencilBuffer,q.texture.type,T),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(T){if(this.renderer=T,T!==null){const q=T.getSize(new r.FM8),he=T.getContext().getContextAttributes().alpha,Ce=this.inputBuffer.texture.type;Ce===r.ywz&&X(T)===p&&($(this.inputBuffer.texture,p),$(this.outputBuffer.texture,p),this.inputBuffer.dispose(),this.outputBuffer.dispose()),T.autoClear=!1,this.setSize(q.width,q.height);for(const He of this.passes)He.initialize(T,he,Ce)}}replaceRenderer(T,q=!0){const he=this.renderer,Ce=he.domElement.parentNode;return this.setRenderer(T),q&&Ce!==null&&(Ce.removeChild(he.domElement),Ce.appendChild(T.domElement)),he}createDepthTexture(){const T=this.depthTexture=new r.$YQ;return this.inputBuffer.depthTexture=T,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(T.format=r.brP,T.type=r.wJv):T.type=r.JQ4,T}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const T of this.passes)T.setDepthTexture(null)}}createBuffer(T,q,he,Ce){const He=this.renderer,Ze=He===null?new r.FM8:He.getDrawingBufferSize(new r.FM8),at={minFilter:r.wem,magFilter:r.wem,stencilBuffer:q,depthBuffer:T,type:he},zt=new r.dd2(Ze.width,Ze.height,at);return Ce>0&&(zt.ignoreDepthForMultisampleCopy=!1,zt.samples=Ce),he===r.ywz&&X(He)===p&&$(zt.texture,p),zt.texture.name="EffectComposer.Buffer",zt.texture.generateMipmaps=!1,zt}setMainScene(T){for(const q of this.passes)q.mainScene=T}setMainCamera(T){for(const q of this.passes)q.mainCamera=T}addPass(T,q){const he=this.passes,Ce=this.renderer,He=Ce.getDrawingBufferSize(new r.FM8),Ze=Ce.getContext().getContextAttributes().alpha,at=this.inputBuffer.texture.type;if(T.setRenderer(Ce),T.setSize(He.width,He.height),T.initialize(Ce,Ze,at),this.autoRenderToScreen&&(he.length>0&&(he[he.length-1].renderToScreen=!1),T.renderToScreen&&(this.autoRenderToScreen=!1)),q!==void 0?he.splice(q,0,T):he.push(T),this.autoRenderToScreen&&(he[he.length-1].renderToScreen=!0),T.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const zt=this.createDepthTexture();for(T of he)T.setDepthTexture(zt)}else T.setDepthTexture(this.depthTexture)}removePass(T){const q=this.passes,he=q.indexOf(T);if(he!==-1&&q.splice(he,1).length>0){if(this.depthTexture!==null){const Ze=(zt,Cn)=>zt||Cn.needsDepthTexture;q.reduce(Ze,!1)||(T.getDepthTexture()===this.depthTexture&&T.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&he===q.length&&(T.renderToScreen=!1,q.length>0&&(q[q.length-1].renderToScreen=!0))}}removeAllPasses(){const T=this.passes;this.deleteDepthTexture(),T.length>0&&(this.autoRenderToScreen&&(T[T.length-1].renderToScreen=!1),this.passes=[])}render(T){const q=this.renderer,he=this.copyPass;let Ce=this.inputBuffer,He=this.outputBuffer,Ze=!1,at,zt,Cn;T===void 0&&(this.timer.update(),T=this.timer.delta);let qn=null;for(let Ot=this.passes.length;Ot--;)if(this.passes[Ot].enabled){qn=this.passes[Ot];break}for(const Ot of this.passes)Ot.enabled&&(this.autoRenderToScreen&&(Ot.renderToScreen=Ot===qn),Ot.render(q,Ce,He,T,Ze),Ot.needsSwap&&(Ze&&(he.renderToScreen=Ot.renderToScreen,at=q.getContext(),zt=q.state.buffers.stencil,zt.setFunc(at.NOTEQUAL,1,4294967295),he.render(q,Ce,He,T,Ze),zt.setFunc(at.EQUAL,1,4294967295)),Cn=Ce,Ce=He,He=Cn),Ot instanceof _o?Ze=!0:Ot instanceof G&&(Ze=!1))}setSize(T,q,he){const Ce=this.renderer,He=Ce.getSize(new r.FM8);(T===void 0||q===void 0)&&(T=He.width,q=He.height),(He.width!==T||He.height!==q)&&Ce.setSize(T,q,he);const Ze=Ce.getDrawingBufferSize(new r.FM8);this.inputBuffer.setSize(Ze.width,Ze.height),this.outputBuffer.setSize(Ze.width,Ze.height);for(const at of this.passes)at.setSize(Ze.width,Ze.height)}reset(){const T=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=T}dispose(){for(const T of this.passes)T.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}}class Ti{constructor(){this.shaderParts=new Map([[ye.FRAGMENT_HEAD,null],[ye.FRAGMENT_MAIN_UV,null],[ye.FRAGMENT_MAIN_IMAGE,null],[ye.VERTEX_HEAD,null],[ye.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=be.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=y}}const ql=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, x + y, opacity);

}
`,au=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, y, min(y.a, opacity));

}
`,_r=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, (x + y) * 0.5, opacity);

}
`,lu=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec3 xHSL = RGBToHSL(x.rgb);
	vec3 yHSL = RGBToHSL(y.rgb);
	vec3 z = HSLToRGB(vec3(yHSL.rg, xHSL.b));
	return vec4(mix(x.rgb, z, opacity), y.a);

}
`,Ci=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = mix(step(0.0, y) * (1.0 - min(vec4(1.0), (1.0 - x) / y)), vec4(1.0), step(1.0, x));
	return mix(x, z, opacity);

}
`,cu=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = step(0.0, x) * mix(min(vec4(1.0), x / max(1.0 - y, 1e-9)), vec4(1.0), step(1.0, y));
	return mix(x, z, opacity);

}
`,nf=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, min(x, y), opacity);

}
`,xo=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, abs(x - y), opacity);

}
`,rf=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, x / max(y, 1e-12), opacity);

}
`,ts=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, (x + y - 2.0 * x * y), opacity);

}
`,wh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 a = min(x, 1.0), b = min(y, 1.0);
	vec4 z = mix(2.0 * a * b, 1.0 - 2.0 * (1.0 - a) * (1.0 - b), step(0.5, y));
	return mix(x, z, opacity);

}
`,Ah=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, step(1.0, x + y), opacity);

}
`,uu=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec3 xHSL = RGBToHSL(x.rgb);
	vec3 yHSL = RGBToHSL(y.rgb);
	vec3 z = HSLToRGB(vec3(yHSL.r, xHSL.gb));
	return vec4(mix(x.rgb, z, opacity), y.a);

}
`,hu=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, 1.0 - y, opacity);

}
`,Ws=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, y * (1.0 - x), opacity);

}
`,js=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, max(x, y), opacity);

}
`,Aa=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, clamp(y + x - 1.0, 0.0, 1.0), opacity);

}
`,Sh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, min(x + y, 1.0), opacity);

}
`,Mh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, clamp(2.0 * y + x - 1.0, 0.0, 1.0), opacity);

}
`,Vo=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec3 xHSL = RGBToHSL(x.rgb);
	vec3 yHSL = RGBToHSL(y.rgb);
	vec3 z = HSLToRGB(vec3(xHSL.rg, yHSL.b));
	return vec4(mix(x.rgb, z, opacity), y.a);

}
`,Eh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, x * y, opacity);

}
`,Hr=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, 1.0 - abs(1.0 - x - y), opacity);

}
`,Th=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, y, opacity);

}
`,Pn=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = mix(2.0 * y * x, 1.0 - 2.0 * (1.0 - y) * (1.0 - x), step(0.5, x));
	return mix(x, z, opacity);

}
`,Kn=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 y2 = 2.0 * y;

	vec4 z = mix(
		mix(y2, x, step(0.5 * x, y)),
		max(vec4(0.0), y2 - 1.0), 
		step(x, (y2 - 1.0))
	);

	return mix(x, z, opacity);

}
`,ki=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = mix(min(x * x / max(1.0 - y, 1e-12), 1.0), y, step(1.0, y));
	return mix(x, z, opacity);

}
`,Ch=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec3 xHSL = RGBToHSL(x.rgb);
	vec3 yHSL = RGBToHSL(y.rgb);
	vec3 z = HSLToRGB(vec3(xHSL.r, yHSL.g, xHSL.b));
	return vec4(mix(x.rgb, z, opacity), y.a);

}
`,Ph=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, x + y - min(x * y, 1.0), opacity);

}
`,Rh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 y2 = 2.0 * y;
	vec4 w = step(0.5, y);

	vec4 z = mix(
		x - (1.0 - y2) * x * (1.0 - x), 
		mix(
			x + (y2 - 1.0) * (sqrt(x) - x),
			x + (y2 - 1.0) * x * ((16.0 * x - 12.0) * x + 3.0),
			w * (1.0 - step(0.25, x))
		),
		w
	);

	return mix(x, z, opacity);

}
`,Dh=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return y;

}
`,Ih=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return mix(x, max(x + y - 1.0, 0.0), opacity);

}
`,Zl=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = mix(
		max(1.0 - min((1.0 - x) / (2.0 * y), 1.0), 0.0),
		min(x / (2.0 * (1.0 - y)), 1.0),
		step(0.5, y)
	);

	return mix(x, z, opacity);

}
`,il=new Map([[Z.ADD,ql],[Z.ALPHA,au],[Z.AVERAGE,_r],[Z.COLOR,lu],[Z.COLOR_BURN,Ci],[Z.COLOR_DODGE,cu],[Z.DARKEN,nf],[Z.DIFFERENCE,xo],[Z.DIVIDE,rf],[Z.DST,null],[Z.EXCLUSION,ts],[Z.HARD_LIGHT,wh],[Z.HARD_MIX,Ah],[Z.HUE,uu],[Z.INVERT,hu],[Z.INVERT_RGB,Ws],[Z.LIGHTEN,js],[Z.LINEAR_BURN,Aa],[Z.LINEAR_DODGE,Sh],[Z.LINEAR_LIGHT,Mh],[Z.LUMINOSITY,Vo],[Z.MULTIPLY,Eh],[Z.NEGATION,Hr],[Z.NORMAL,Th],[Z.OVERLAY,Pn],[Z.PIN_LIGHT,Kn],[Z.REFLECT,ki],[Z.SATURATION,Ch],[Z.SCREEN,Ph],[Z.SOFT_LIGHT,Rh],[Z.SRC,Dh],[Z.SUBTRACT,Ih],[Z.VIVID_LIGHT,Zl]]);class rl extends r.pBf{constructor(T,q=1){super(),this._blendFunction=T,this.opacity=new r.xWb(q)}getOpacity(){return this.opacity.value}setOpacity(T){this.opacity.value=T}get blendFunction(){return this._blendFunction}set blendFunction(T){this._blendFunction=T,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(T){this.blendFunction=T}getShaderCode(){return il.get(this.blendFunction)}}class sl extends r.pBf{constructor(T,q,{attributes:he=be.NONE,blendFunction:Ce=Z.NORMAL,defines:He=new Map,uniforms:Ze=new Map,extensions:at=null,vertexShader:zt=null}={}){super(),this.name=T,this.renderer=null,this.attributes=he,this.fragmentShader=q,this.vertexShader=zt,this.defines=He,this.uniforms=Ze,this.extensions=at,this.blendMode=new rl(Ce),this.blendMode.addEventListener("change",Cn=>this.setChanged()),this._inputColorSpace=y,this._outputColorSpace=o}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(T){this._inputColorSpace=T,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(T){this._outputColorSpace=T,this.setChanged()}set mainScene(T){}set mainCamera(T){}getName(){return this.name}setRenderer(T){this.renderer=T}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(T){this.attributes=T,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(T){this.fragmentShader=T,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(T){this.vertexShader=T,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(T,q=r.z81){}update(T,q,he){}setSize(T,q){}initialize(T,q,he){}dispose(){for(const T of Object.keys(this)){const q=this[T];(q instanceof r.dd2||q instanceof r.F5T||q instanceof r.xEZ||q instanceof vr)&&this[T].dispose()}}}const du=`#ifdef FRAMEBUFFER_PRECISION_HIGH

	uniform mediump sampler2D map;

#else

	uniform lowp sampler2D map;

#endif

uniform float intensity;

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {

	outputColor = texture2D(map, uv) * intensity;

}
`;class Jl extends sl{constructor({blendFunction:T=Z.SCREEN,luminanceThreshold:q=.9,luminanceSmoothing:he=.025,mipmapBlur:Ce=!1,intensity:He=1,radius:Ze=.85,levels:at=8,kernelSize:zt=$e.LARGE,resolutionScale:Cn=.5,width:qn=zr.AUTO_SIZE,height:Ot=zr.AUTO_SIZE,resolutionX:oi=qn,resolutionY:yi=Ot}={}){super("BloomEffect",du,{blendFunction:T,uniforms:new Map([["map",new r.xWb(null)],["intensity",new r.xWb(He)]])}),this.renderTarget=new r.dd2(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Kl({kernelSize:zt}),this.luminancePass=new yo({colorOutput:!0}),this.luminanceMaterial.threshold=q,this.luminanceMaterial.smoothing=he,this.mipmapBlurPass=new Ho,this.mipmapBlurPass.enabled=Ce,this.mipmapBlurPass.radius=Ze,this.mipmapBlurPass.levels=at,this.uniforms.get("map").value=Ce?this.mipmapBlurPass.texture:this.renderTarget.texture;const xr=this.resolution=new zr(this,oi,yi,Cn);xr.addEventListener("change",_i=>this.setSize(xr.baseWidth,xr.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(T){this.resolution.preferredWidth=T}get height(){return this.resolution.height}set height(T){this.resolution.preferredHeight=T}get dithering(){return this.blurPass.dithering}set dithering(T){this.blurPass.dithering=T}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(T){this.blurPass.kernelSize=T}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(T){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(T){this.uniforms.get("intensity").value=T}getIntensity(){return this.intensity}setIntensity(T){this.intensity=T}getResolutionScale(){return this.resolution.scale}setResolutionScale(T){this.resolution.scale=T}update(T,q,he){const Ce=this.renderTarget,He=this.luminancePass;He.enabled?(He.render(T,q),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(T,He.renderTarget):this.blurPass.render(T,He.renderTarget,Ce)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(T,q):this.blurPass.render(T,q,Ce)}setSize(T,q){const he=this.resolution;he.setBaseSize(T,q),this.renderTarget.setSize(he.width,he.height),this.blurPass.resolution.copy(he),this.luminancePass.setSize(T,q),this.mipmapBlurPass.setSize(T,q)}initialize(T,q,he){this.blurPass.initialize(T,q,he),this.luminancePass.initialize(T,q,he),this.mipmapBlurPass.initialize(T,q,he),he!==void 0&&(this.renderTarget.texture.type=he,X(T)===p&&$(this.renderTarget.texture,p))}}new r.Pa4,new r.yGw,new r.Ilk,new r.Pa4,new r.Pa4;const $l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",ec="data:image/png;base64,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",ol=`uniform sampler2D weightMap;

varying vec2 vOffset0;
varying vec2 vOffset1;

/**
 * Moves values to a target vector based on a given conditional vector.
 */

void movec(const in bvec2 c, inout vec2 variable, const in vec2 value) {

	if(c.x) { variable.x = value.x; }
	if(c.y) { variable.y = value.y; }

}

void movec(const in bvec4 c, inout vec4 variable, const in vec4 value) {

	movec(c.xy, variable.xy, value.xy);
	movec(c.zw, variable.zw, value.zw);

}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {

	// Fetch the blending weights for the current pixel.
	vec4 a;
	a.x = texture2D(weightMap, vOffset0).a;
	a.y = texture2D(weightMap, vOffset1).g;
	a.wz = texture2D(weightMap, uv).rb;

	vec4 color = inputColor;

	// Ignore tiny blending weights.
	if(dot(a, vec4(1.0)) >= 1e-5) {

		// max(horizontal) > max(vertical)
		bool h = max(a.x, a.z) > max(a.y, a.w);

		// Calculate the blending offsets.
		vec4 blendingOffset = vec4(0.0, a.y, 0.0, a.w);
		vec2 blendingWeight = a.yw;
		movec(bvec4(h), blendingOffset, vec4(a.x, 0.0, a.z, 0.0));
		movec(bvec2(h), blendingWeight, a.xz);
		blendingWeight /= dot(blendingWeight, vec2(1.0));

		// Calculate the texture coordinates.
		vec4 blendingCoord = blendingOffset * vec4(texelSize, -texelSize) + uv.xyxy;

		// Rely on bilinear filtering to mix the current pixel with the neighbor.
		color = blendingWeight.x * texture2D(inputBuffer, blendingCoord.xy);
		color += blendingWeight.y * texture2D(inputBuffer, blendingCoord.zw);

	}

	outputColor = color;

}
`,al=`varying vec2 vOffset0;
varying vec2 vOffset1;

void mainSupport(const in vec2 uv) {

	vOffset0 = uv + texelSize * vec2(1.0, 0.0);
	vOffset1 = uv + texelSize * vec2(0.0, 1.0);

}
`;class bo extends sl{constructor({blendFunction:T=Z.SRC,preset:q=ie.MEDIUM,edgeDetectionMode:he=ge.COLOR,predicationMode:Ce=ce.DISABLED}={}){super("SMAAEffect",ol,{vertexShader:al,blendFunction:T,attributes:be.CONVOLUTION|be.DEPTH,uniforms:new Map([["weightMap",new r.xWb(null)]])});let He,Ze;arguments.length>1&&(He=arguments[0],Ze=arguments[1],arguments.length>2&&(q=arguments[2]),arguments.length>3&&(he=arguments[3])),this.renderTargetEdges=new r.dd2(1,1,{depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Qi(!0,!1,!1),this.clearPass.overrideClearColor=new r.Ilk(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new zn(new Ei),this.edgeDetectionMaterial.edgeDetectionMode=he,this.edgeDetectionMaterial.predicationMode=Ce,this.weightsPass=new zn(new Ds);const at=new r.lLk;at.onLoad=()=>{const zt=new r.xEZ(He);zt.name="SMAA.Search",zt.magFilter=r.TyD,zt.minFilter=r.TyD,zt.generateMipmaps=!1,zt.needsUpdate=!0,zt.flipY=!0,this.weightsMaterial.searchTexture=zt;const Cn=new r.xEZ(Ze);Cn.name="SMAA.Area",Cn.magFilter=r.wem,Cn.minFilter=r.wem,Cn.generateMipmaps=!1,Cn.needsUpdate=!0,Cn.flipY=!1,this.weightsMaterial.areaTexture=Cn,this.dispatchEvent({type:"load"})},at.itemStart("search"),at.itemStart("area"),He!==void 0&&Ze!==void 0?(at.itemEnd("search"),at.itemEnd("area")):typeof Image<"u"&&(He=new Image,Ze=new Image,He.addEventListener("load",()=>at.itemEnd("search")),Ze.addEventListener("load",()=>at.itemEnd("area")),He.src=$l,Ze.src=ec),this.applyPreset(q)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(T){this.edgeDetectionMaterial.edgeDetectionThreshold=T}setOrthogonalSearchSteps(T){this.weightsMaterial.orthogonalSearchSteps=T}applyPreset(T){const q=this.edgeDetectionMaterial,he=this.weightsMaterial;switch(T){case ie.LOW:q.edgeDetectionThreshold=.15,he.orthogonalSearchSteps=4,he.diagonalDetection=!1,he.cornerDetection=!1;break;case ie.MEDIUM:q.edgeDetectionThreshold=.1,he.orthogonalSearchSteps=8,he.diagonalDetection=!1,he.cornerDetection=!1;break;case ie.HIGH:q.edgeDetectionThreshold=.1,he.orthogonalSearchSteps=16,he.diagonalSearchSteps=8,he.cornerRounding=25,he.diagonalDetection=!0,he.cornerDetection=!0;break;case ie.ULTRA:q.edgeDetectionThreshold=.05,he.orthogonalSearchSteps=32,he.diagonalSearchSteps=16,he.cornerRounding=25,he.diagonalDetection=!0,he.cornerDetection=!0;break}}setDepthTexture(T,q=r.z81){this.edgeDetectionMaterial.depthBuffer=T,this.edgeDetectionMaterial.depthPacking=q}update(T,q,he){this.clearPass.render(T,this.renderTargetEdges),this.edgeDetectionPass.render(T,q,this.renderTargetEdges),this.weightsPass.render(T,this.renderTargetEdges,this.renderTargetWeights)}setSize(T,q){this.edgeDetectionMaterial.setSize(T,q),this.weightsMaterial.setSize(T,q),this.renderTargetEdges.setSize(T,q),this.renderTargetWeights.setSize(T,q)}dispose(){const{searchTexture:T,areaTexture:q}=this.weightsMaterial;T!==null&&q!==null&&(T.dispose(),q.dispose()),super.dispose()}static get searchImageDataURL(){return $l}static get areaImageDataURL(){return ec}}var Sa=ga(992);class ll extends Sa.S{constructor(q){super();B(this,"_composer",null);this.onLoad=()=>{this._composer=new wa(this.viewer.renderer,q),this._composer.addPass(new bh(this.viewer.scene,this.viewer.camera)),this.viewer.resizeCallback=(he,Ce)=>this._composer.setSize(he,Ce),this.viewer.renderCallback=he=>this._composer.render(he)}}onDestroy(){this._composer&&this._composer.dispose()}addPass(q){this._composer&&this._composer.addPass(q)}removePass(q){this._composer&&this._composer.removePass(q)}}var cl=function(Pt,T,q,he){var Ce=arguments.length,He=Ce<3?T:he===null?he=Object.getOwnPropertyDescriptor(T,q):he,Ze;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")He=Reflect.decorate(Pt,T,q,he);else for(var at=Pt.length-1;at>=0;at--)(Ze=Pt[at])&&(He=(Ce<3?Ze(He):Ce>3?Ze(T,q,He):Ze(T,q))||He);return Ce>3&&He&&Object.defineProperty(T,q,He),He};let Wo=class extends Sa.S{constructor(){super(...arguments);B(this,"_effectPass",null);B(this,"_effects",[]);B(this,"_needsUpdate",!1);B(this,"_postprocessing")}onInit(){this._postprocessing=this.viewer.getPlugin(ll)}addEffect(q){this._effects.push(q),this._needsUpdate=!0}removeEffect(q){this._effects.remove(q),this._needsUpdate=!0}update(q){this._needsUpdate&&(this._needsUpdate=!1,this._effectPass&&(this._postprocessing.removePass(this._effectPass),this._effectPass=null),this._effectPass===null&&(this._effectPass=new ou(this.viewer.camera,...this._effects),this._postprocessing.addPass(this._effectPass)))}};Wo=cl([(0,i.HO)(ll)],Wo);var fu=function(Pt,T,q,he){var Ce=arguments.length,He=Ce<3?T:he===null?he=Object.getOwnPropertyDescriptor(T,q):he,Ze;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")He=Reflect.decorate(Pt,T,q,he);else for(var at=Pt.length-1;at>=0;at--)(Ze=Pt[at])&&(He=(Ce<3?Ze(He):Ce>3?Ze(T,q,He):Ze(T,q))||He);return Ce>3&&He&&Object.defineProperty(T,q,He),He};let Ma=class extends Sa.S{constructor(){super(...arguments);B(this,"effect");B(this,"isEffectPlugin",!0);B(this,"_manager")}onEnable(){var q;(q=this._manager)==null||q.addEffect(this.effect)}onDisable(){var q;(q=this._manager)==null||q.removeEffect(this.effect)}onInit(){this._manager=this.viewer.getPlugin(Wo)}};Ma=fu([(0,i.HO)(Wo)],Ma);var jo=function(Pt,T,q,he){var Ce=arguments.length,He=Ce<3?T:he===null?he=Object.getOwnPropertyDescriptor(T,q):he,Ze;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")He=Reflect.decorate(Pt,T,q,he);else for(var at=Pt.length-1;at>=0;at--)(Ze=Pt[at])&&(He=(Ce<3?Ze(He):Ce>3?Ze(T,q,He):Ze(T,q))||He);return Ce>3&&He&&Object.defineProperty(T,q,He),He};let wo=class extends Ma{constructor(T){super(),this.effect=new Jl({blendFunction:Z.ADD,...T})}get intensity(){return this.effect.intensity}set intensity(T){this.effect.intensity=T}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceThreshold(T){this.effect.luminanceMaterial.threshold=T}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set luminanceSmoothing(T){this.effect.luminanceMaterial.smoothing=T}};jo([(0,i.Cb)({min:0,max:1,step:.01})],wo.prototype,"intensity",null),jo([(0,i.Cb)({min:0,max:10,step:.01})],wo.prototype,"luminanceThreshold",null),jo([(0,i.Cb)({min:0,max:10,step:.01})],wo.prototype,"luminanceSmoothing",null),wo=jo([(0,i.jf)("BloomPlugin")],wo);var Xo=function(Pt,T,q,he){var Ce=arguments.length,He=Ce<3?T:he===null?he=Object.getOwnPropertyDescriptor(T,q):he,Ze;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")He=Reflect.decorate(Pt,T,q,he);else for(var at=Pt.length-1;at>=0;at--)(Ze=Pt[at])&&(He=(Ce<3?Ze(He):Ce>3?Ze(T,q,He):Ze(T,q))||He);return Ce>3&&He&&Object.defineProperty(T,q,He),He};let Ao=class extends Ma{constructor(q={}){super();B(this,"_preset",ie.MEDIUM);this.effect=new bo(q)}get preset(){return this._preset}set preset(q){this._preset=q,this.effect.applyPreset(q)}get edgeDetectionMode(){return this.effect.edgeDetectionMaterial.edgeDetectionMode}set edgeDetectionMode(q){this.effect.edgeDetectionMaterial.edgeDetectionMode=q}get predicationMode(){return this.effect.edgeDetectionMaterial.predicationMode}set predicationMode(q){this.effect.edgeDetectionMaterial.predicationMode=q}};Xo([(0,i.Cb)({value:ie})],Ao.prototype,"preset",null),Xo([(0,i.Cb)({value:ge})],Ao.prototype,"edgeDetectionMode",null),Xo([(0,i.Cb)({value:ce})],Ao.prototype,"predicationMode",null),Ao=Xo([(0,i.jf)("SMAAPlugin")],Ao)})();N.J12;N.$c;N.I_b;N.oGK;N.$p;N.$q;N.$r;N.L0d;N.i5S;var kP=N.nXV;N.bd1;var BB=N.LY2;N.iAO;N.bGH;N.NDo;N.gSk;var cw=N.WMw;N.OTo;N.Se2;N.cum;N.Mig;N.i_9;N.fwF;N.m7l;N.vXP;N.sYA;N.Xcj;N.mzJ;N.ZZA;N.T__;N.HkE;N.tGC;N.gOo;N.f03;N.BbS;N.kqm;N.GPr;N.Hmr;N.SJI;N.mTL;N.y8_;N.Xim;N._Li;N.z81;N._MY;var kB=N.NBQ,UB=N.dFZ;N.IIx;N.N$j;N._YM;N.TUj;N.ZzF;N.GQ;N.nvb;N.DvJ;N.fQA;N.ePP;N.TlE;N.u9r;N.s4_;N.T95;N.CtF;N.V1s;N.Rki;N.ROQ;N.YN5;N.BVQ;N.YT8;N.YGz;N.WXy;N.trn;N.zf8;var $M=N.uWy;N.SUY;var bi=N.Ilk;N.R2R;N.epp;N.Wrv;N.EKy;N.$S;var xa=N.wA2;N.Z_g;N.EB7;N.DqL;N._3;N.b_z;N.unp;N._am;N.fY$;N.vxC;N.BtG;N.cBK;var NB=N.g8_;N.AXT;N.yj7;N.dYG;N.tm_;N.S2y;N.B02;N.PeU;N.Hyl;N.Wqd;N.SVw;N.Xaj;N.dZ3;N.m_w;N.fHI;N.LBq;N.JUT;N.p3g;var zB=N.IEO;N.yxD;N.A5E;N.jfJ;N.T_J;N.tEQ;N.qkB;N.brP;N.$YQ;var us=N.iRp;N.Ox3;N.cBI;N.cU9;N.ntt;N.DT1;N.Kgo;var o0=N.ehD;N.fSK;N.Vdb;N.l8J;N.dj0;N.QM0;N.q7E;N.TOt;N.Ny0;var GB=N.qAh;N.eD;N.jwo;N.dSO;N.Bf4;var lo=N.USm;N.pBf;var HB=N.vpe;N.$Vf;N.O7d;N.Aek;N.hH6;N.e62;N.a$l;N.OM3;var VB=N.VzW;N.ybr;N.yo9;N.Wzm;N.zUS;N.Wl3;N.iWj;N.ylh;N.v9Y;N.LSk;N.uoT;N.w$m;N.ksN;N.j4z;N.OAl;N.VLJ;N.ZAu;N.k7s;var WB=N.cLu;N.vmT;N.Qpg;N.So8;N.Wjw;N.cJO;N.KCx;N.QRU;N.S3k;N.PpQ;N.ZRs;N.oqc;N.lb7;N.L5s;N.$TI;var jB=N.SPe;N.aVm;N.j87;N.RNb;N.Kz5;N.vpT;N.kB5;N._C8;N.Syv;N.NMF;N.pIN;N.eMJ;N.ZtY;N.x5V;N.tUh;N.z8B;N.__J;N.GZb;N.p7y;N.udN;N.S9g;N.Zr5;N.vCF;N.yt0;N.uXU;N._kC;N.lk7;N.DvN;N.x12;N.Zzh;N.nls;N.g_z;N.U7;N.FT0;N.blk;N.ejS;var bd=N.rnI,eE=N.wem;N.lfu;N.FDw;N.lRj;var tE=N.D1R;N.qyh;N.GUF;N.EoG;N.aNw;N.Zp0;N.lLk;N.jAl;N.uEv;N.YKA;N.cRx;N.Y8D;N.RsA;N.B51;var XB=N.F5T;N.u7G;var UP=N.M8C;N.Vkp;var Jx=N.yGw;N.Sm8;var NP=N.Kj0,YB=N.vBJ;N.lRF;N.Lun;N.YBo;var QB=N.kaV;N.RSm;N.xoR;N.EJi;N.Qme;var KB=N.Wid;N.jrH;N.IKL;N.r_;N.OPb;N.OoA;N.qhX;N.M5h;N.Ns1;var nE=N.TyD;N.vZf;N.HTd;N.aH4;N.YLQ;N.BVF;N.MyG;N.jFi;N.aCh;N.uL9;N.fwl;N.IFH;N.bdR;N.M6v;N.RvT;N.dUE;N.Tme;N.Gql;N.PA7;N.REq;N.pQR;N.ghN;N.Hy8;N.Wpd;N.LgZ;N.iWC;var qB=N.i5E;N.iKG;N._iA;N.ntZ;var ZB=N.anP;N.y$t;N.Ady;var H_=N.H8x,zP=N.cPb,JB=N.JOQ;N.BKK;var GP=N._12;N.tJx;N.OdJ;N.SyM;N.cek;N.xG9;N.woe;N.UY4;N.aq0;N.ujx;N.Uol;N.VYz;var $B=N.XgS;N.iUV;N.tf;N.ZQ6;N.mXe;var $a=N._fP;N.iLg;N.zbs;N.ZTh;N.HdW;N.UZH;N.mSO;var HP=N.wk1;N.E2K;N.FUD;N.pKu;N.GG6;N.Gih;N.iiP;N.SvJ;N.ptH;N.jZA;N.y2t;N.gi4;N.Djp;N.BG$;N.NYV;N.xJs;N.bsb;N.ekQ;N.CaW;N.eaV;N.BFQ;N.v3W;N.ILR;N.fto;N.l0P;N.vCx;N._AM;N.wuA;N.av9;N.CtA;N.mIn;N.FIo;N.zHn;N.iMs;N.T_f;N.hEm;N.D9w;N.CdI;N.TIb;var Rc=N.rpg;N.ce8;N.rOj;N.V4E;N.o8S;N.lGU;N.vuL;var ek=N.Rov;N.KI_;N.xsS;N.b26;N.WdD;N.Vj0;var go=N.jyz;N.Tn7;N.bnF;N.HW6;N.oa8;N.T_1;N.iDF;N.iAb;N.OdW;N._YX;N.TUv;N.Hw6;N.aLr;N.Aip;var tk=N.xo$;N.$V;N.lDi;N.gti;N.PMe;N.FvO;N.jyi;N.xeV;N.k74;N.RlZ;N.KhW;N.HgB;N.W2J;N.JWc;var nk=N.kP0;N.u37;N.Z6B;N.QZ1;N.Ir4;N.NwF;N.Wbm;N.N4l;N.QmN;var Zt=N.wes;N.IOt;N.L5g;N.H$k;N.xEZ;N.YQ_;N.Yin;N.dpR;N.Cne;N.XvJ;N.XZw;N.FE5;N.Ys8;N.CJI;N.z$h;N.UlW;N.WwZ;N.Lcc;N.WXh;N.ub3;N.xfE;N.qlB;N.lCJ;N.WTc;N.rAo;N.xWb;N.gH0;var iE=N.rBU;N.rDY;N.ywz;N.wJv;N.JQ4;N.k0A;N.irR;N.LsT;N.MiG;N.dwk;var rm=N.FM8,Yn=N.Pa4,sm=N.Ltg;N.yC1;N.fO1;var ik=N.AEx;N._9o;N.k5T;N.b5g;N.Ywn;N.GVz;N.oAp;N.kFz;var VP=N.dd2;N.CP7;N.fQK;N.Uk6;N._sL;N.Pnf;N.c8b;N._lf;N.ad5;N.L_r;N.eC3;N.BRj;N.rif;N.HOT;N.jfB;N.bkz;N.lDs;N.tQ;N.Oe_;N.YRX;N.S6$;var tl=N.CbL,rk=N.knz;N.lKs;N.GaT;N.OEW;class sk{constructor(){B(this,"RES_VERSION","1.0.1");B(this,"CODE_VERSION","1.0.7");B(this,"DEBUG",location.href.includes("localhost")||location.href.includes("192.168"));B(this,"COMPRESS",!0)}get VERSION(){return`res ${this.RES_VERSION} code ${this.CODE_VERSION}`}autoURL(i){return this.COMPRESS?(i.includes(".raw")||(i=i.replace("jpg","webp"),i=i.replace("jpeg","webp"),i=i.replace("png","webp")),i.replace("res/",`./${this.RES_VERSION}/`)):i}}const vi=new sk;var Tn=(t=>(t[t.Loading=0]="Loading",t[t.BeginAnim=1]="BeginAnim",t[t.State1=2]="State1",t[t.State2=3]="State2",t[t.State3=4]="State3",t[t.State4=5]="State4",t))(Tn||{});class ok extends HB{constructor(){super(...arguments);B(this,"loading",0);B(this,"PRELOADED","preloaded");B(this,"UPDATESHOWINGSTATE","updateShowingState");B(this,"CLICKEFFECT","clickEffect");B(this,"CHANGECOLOR","changeColor");B(this,"_isInClickEffect",!1);B(this,"_currentShowingState",0)}get currentShowingState(){return this._currentShowingState}get isInClickEffect(){return this._isInClickEffect}reset(){this.on(this.UPDATESHOWINGSTATE,r=>{this._currentShowingState=r}),this.on(this.CLICKEFFECT,r=>{this._isInClickEffect=r}),this.on(this.PRELOADED,()=>{this.emit(this.UPDATESHOWINGSTATE,1)})}}const Lt=new ok;class ak{constructor(){B(this,"reflectMeshes",[]);B(this,"maxSpeed",20);B(this,"speedUpDuration",2);B(this,"sceneCaptureLayer",31);B(this,"PlaneReflectLayer",29);B(this,"lightUpTime",2);B(this,"sm_car");B(this,"sm_size");B(this,"sm_startroom");B(this,"sm_speedup");B(this,"sm_curvature");B(this,"sm_windspeed");B(this,"sm_linecar");B(this,"sm_carradar");B(this,"sm_simpleCar");B(this,"ut_car_body_ao",{value:null});B(this,"ut_startroom_ao",{value:null});B(this,"ut_startroom_light",{value:null});B(this,"ut_floor_normal",{value:null});B(this,"ut_floor_roughness",{value:null});B(this,"ut_cubeCapture",{value:null});B(this,"ut_blurCapture",{value:null});B(this,"ut_saLine",{value:null});B(this,"ut_street",{value:null});B(this,"ut_scar_matcap",{value:null});B(this,"ut_white",{value:null});B(this,"ut_car_body_t_cat",{value:null});B(this,"ut_car_body_t_gm",{value:null});B(this,"ut_env_night",{value:null});B(this,"ut_env_light",{value:null});B(this,"u_time",{value:0});B(this,"u_car_envMapIntensity",{value:1});B(this,"u_floor_typeSwitch",{value:0});B(this,"u_speedUpBackgroundValue",{value:0});B(this,"u_car_discard",{value:1});B(this,"u_speedTime",{value:0});B(this,"u_floorLightMapIntensity",{value:0});B(this,"u_floorLightMapColor",{value:new bi("#000000")});B(this,"u_floorReflectIntensity",{value:0});B(this,"u_floorUVOffset",{value:new rm});B(this,"u_simpleCarCenter1",{value:new Yn});B(this,"u_simpleCarCenter2",{value:new Yn});B(this,"u_reflect",{u_reflectTexture:{value:null},u_reflectMatrix:{value:null}})}}const Ne=new ak;var lk=Object.defineProperty,ck=Object.getOwnPropertyDescriptor,nu=(t,i,r,o)=>{for(var p=o>1?void 0:o?ck(i,r):i,y=t.length-1,d;y>=0;y--)(d=t[y])&&(p=(o?d(i,r,p):d(p))||p);return o&&p&&lk(i,r,p),p};const rE=new Yn,V_=new lo,uk=new $a,hk=kP();class jl extends xa{constructor({near:r=.01,far:o=100,fov:p=45,rotation:y=new lo(0,-Math.PI/2,0),lookAt:d=new Yn,springLength:E=2}){super();B(this,"enablePositionNoise",!0);B(this,"positionFrequency",1.5);B(this,"positionAmplitude",.04);B(this,"positionScale",kP(1));B(this,"positionFractalLevel",3);B(this,"_time",[]);B(this,"_fbmNorm",1/.75);B(this,"_springLength",2);B(this,"_lookAt",new Yn(0,.23686,0));B(this,"rotation",new lo(0,-Math.PI/2,0));B(this,"targetCameraPosition",new Yn);this.onLoad=()=>{this.viewer.camera.near=r,this.viewer.camera.far=o,this.viewer.camera.fov=p,this.viewer.camera.updateProjectionMatrix(),this.rotation.copy(y),this._lookAt.copy(d),this._springLength=E,this.calculateCameraPosition(),this.viewer.camera.position.copy(this.targetCameraPosition),this.viewer.camera.lookAt(this._lookAt),this.rehash()}}rehash(){for(let r=0;r<6;r++)this._time[r]=UP.randFloat(-1e4,0)}get springLength(){return this._springLength}set springLength(r){this._springLength=r}get __rotation(){return this.rotation}set __rotation(r){this.rotation.copy(r)}get lookAt(){return this._lookAt}set lookAt(r){this._lookAt.copy(r)}gotoPOI(r,o,p,y=1.5,d=Zt.Easing.Cubic.InOut,E=0){return new Promise(L=>{const k=new $a().setFromEuler(this.rotation),X=new $a;Zt.TweenManager.KillTweensOf(this),Zt.TweenManager.Tween(this).to({lookAt:r,springLength:o},y).delay(E).onUpdate(($,Z)=>{const ge=uk.setFromEuler(p);X.copy(k).slerp(ge,d(Z)),this.rotation.copy(V_.setFromQuaternion(X,"YZX"))}).easing(d).start().onComplete(()=>{L(!0)})})}calculateCameraPosition(){V_.set(0,this.rotation.y,this.rotation.z),rE.set(1,0,0).applyEuler(V_).multiplyScalar(this._springLength).add(this._lookAt),this.targetCameraPosition.copy(rE)}update(r){if(this.calculateCameraPosition(),this.viewer.camera.position.copy(this.targetCameraPosition),this.viewer.camera.lookAt(this._lookAt),this.enablePositionNoise){for(let p=0;p<3;p++)this._time[p]+=this.positionFrequency*r;let o=hk.set(H_.Fbm(this.positionFractalLevel,this._time[0]),H_.Fbm(this.positionFractalLevel,this._time[1]),H_.Fbm(this.positionFractalLevel,this._time[2]));o=o.multiply(this.positionScale),o.multiplyScalar(this.positionAmplitude*this._fbmNorm),this.viewer.camera.position.add(o)}}}nu([tl({dir:"position"})],jl.prototype,"enablePositionNoise",2);nu([tl({dir:"position"})],jl.prototype,"positionFrequency",2);nu([tl({dir:"position"})],jl.prototype,"positionAmplitude",2);nu([tl({dir:"position"})],jl.prototype,"positionScale",2);nu([tl({dir:"position",min:0,max:8,step:1})],jl.prototype,"positionFractalLevel",2);nu([tl()],jl.prototype,"springLength",1);nu([tl()],jl.prototype,"__rotation",1);nu([tl()],jl.prototype,"lookAt",1);new $a;new Yn;function uw(){const t=navigator.userAgent;return/iPad/.test(t)?!1:/Mobile|Android|iPhone|iPod|BlackBerry|Windows Phone|iPad/gi.test(t)}function dk(){const t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;return!(t>i)}const WP=new zP;WP.position.set(5,0,0);WP.lookAt(new Yn(0,0,0));new NP(new tk(1),[new XB]);function Fl(t,i,r){return t+(i-t)*r}function fk(t,i,r){return i.x=Fl(0,t.x,r),i.y=Fl(0,t.y,r),i.z=Fl(0,t.z,r),i}function pk(t,i){t.x-=i.x,t.y-=i.y,t.z-=i.z}function mk(t,i){t.x+=i.x,t.y+=i.y,t.z+=i.z}function sE(t,i,r){return t=Math.max(i,t),t=Math.min(r,t),t}function oE(){return"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0}const xd=new rm,W_=new lo,xp=new $a,aE=new $a,gk=new lo;class vk extends xa{constructor({springCamera:r}){super();B(this,"enableClamp",!0);B(this,"targetFov",45);B(this,"springlengthOffset",0);B(this,"lerpStrength",1);B(this,"moveSpeed",[1,1]);B(this,"_currentLengthOffset",0);B(this,"_springRotationZClampRange",[.02,.3]);B(this,"_springRotationYClampRange",[-100,100]);B(this,"_deltaRotation",new lo);B(this,"_targetRotation",new lo);B(this,"_targetSpringLength",0);B(this,"_targetLookAt",new Yn);B(this,"_button",-1);B(this,"_preLoc0",new rm);B(this,"_preLoc1",new rm);B(this,"_touchID");B(this,"_springCamera");B(this,"_enableControlCamera",!1);B(this,"_lerpQuatStrength",5);B(this,"_lerpLengthStrength",3);B(this,"_mouseWheelSum",0);this.onLoad=()=>{this._springCamera=r,this.reset()}}get lerpLengthStrength(){return this._lerpLengthStrength}set lerpLengthStrength(r){this._lerpLengthStrength=r}get springLength(){return this._targetSpringLength}set springLength(r){this._targetSpringLength=r}get enableControlCamera(){return this._enableControlCamera}set enableControlCamera(r){this._enableControlCamera!==r&&(this._enableControlCamera=r,r?(oE()?(this.viewer.on(us.TOUCH_START,this._onTouchStart,this),this.viewer.on(us.TOUCH_MOVE,this._onTouchMove,this)):(this.viewer.on(us.POINTER_DOWN,this._onMouseDown,this),this.viewer.on(us.POINTER_UP,this._onMouseUp,this),this.viewer.on(us.POINTER_MOVE,this._onMouseMove,this)),this.viewer.on(us.MOUSE_WHEEL,this._onMouseWheel,this),this.reset()):(oE()?(this.viewer.off(us.TOUCH_START,this._onTouchStart,this),this.viewer.off(us.TOUCH_MOVE,this._onTouchMove,this)):(this.viewer.off(us.POINTER_DOWN,this._onMouseDown,this),this.viewer.off(us.POINTER_UP,this._onMouseUp,this),this.viewer.off(us.POINTER_MOVE,this._onMouseMove,this)),this.viewer.off(us.MOUSE_WHEEL,this._onMouseWheel,this)))}reset(){this._button=-1,this._touchID=-1,this.springLength=this._springCamera.springLength,this._targetLookAt.copy(this._springCamera.lookAt),this._targetRotation.copy(this._springCamera.rotation),this._deltaRotation.set(0,0,0),this.targetFov=this.viewer.camera.fov}_onMouseDown(r){this._button=r.button,this._preLoc0.set(r.pageX,r.pageY)}_onMouseUp(r){this._button=-1}_onMouseMove(r){switch(xd.set(r.pageX,r.pageY),this._button){case 0:this._preLoc0.sub(xd).multiplyScalar(this._springCamera.springLength*.001),this.updateDeltaRotation();break}this._preLoc0.copy(xd)}updateDeltaRotation(){this._deltaRotation.y+=this._preLoc0.x*this.moveSpeed[0],this._deltaRotation.z-=this._preLoc0.y*this.moveSpeed[1]}_onMouseWheel(r){this._mouseWheelSum+=r.deltaY,this._mouseWheelSum>200?(this._mouseWheelSum=0,cE(!0)):this._mouseWheelSum<-200&&(this._mouseWheelSum=0,cE(!1))}_onTouchStart(r){const o=r.touches;o.length==1&&(this._preLoc0.set(o[0].pageX,o[0].pageY),this._touchID=r.touches[0].identifier),o.length>1&&(this._preLoc1.set(o[1].pageX,o[1].pageY),console.log("preLoc1="+Math.round(this._preLoc1.x)+"  "+Math.round(this._preLoc1.y)))}_onTouchMove(r){const o=r.touches;o.length===1&&this._touchID===o[0].identifier&&(xd.set(o[0].pageX,o[0].pageY),this._preLoc0.sub(xd).multiplyScalar(this._springCamera.springLength*.0016),this.updateDeltaRotation(),this._preLoc0.copy(xd))}update(r){Math.abs(this.viewer.camera.fov-this.targetFov)>.01&&(this.viewer.camera.fov=Fl(this.viewer.camera.fov,this.targetFov,this.lerpStrength*r),this.viewer.camera.updateProjectionMatrix()),this._currentLengthOffset=Fl(this._currentLengthOffset,this.springlengthOffset,this.lerpStrength*r);const o=this._targetSpringLength+this._currentLengthOffset;this._springCamera.lookAt.lerp(this._targetLookAt,r),this._springCamera.springLength=Fl(this._springCamera.springLength,o,.016*this._lerpLengthStrength),fk(this._deltaRotation,W_,r*10),pk(this._deltaRotation,W_),mk(this._targetRotation,W_),xp.setFromEuler(this._targetRotation),this._targetRotation.setFromQuaternion(xp,"YZX"),this.enableClamp&&(this._targetRotation.z=sE(this._targetRotation.z,this._springRotationZClampRange[0],this._springRotationZClampRange[1]),this._targetRotation.y=sE(this._targetRotation.y,this._springRotationYClampRange[0],this._springRotationYClampRange[1])),xp.setFromEuler(this._springCamera.rotation),aE.setFromEuler(this._targetRotation),xp.slerp(aE,r*this._lerpQuatStrength),this._springCamera.rotation.copy(gk.setFromQuaternion(xp,"YZX"))}gotoPOI(r,o,p,y=1.5,d=Zt.Easing.Cubic.InOut,E=0){return new Promise(L=>{var k;Zt.TweenManager.KillTweensOf(this),Zt.TweenManager.Timeline(this).delay(y).call(()=>{this.reset()}).start(),(k=this._springCamera)==null||k.gotoPOI(r,o,p,y,d,E).then(()=>{L(!0)})})}setNewTarget(r,o,p){this.reset(),this._lerpQuatStrength=0,Zt.TweenManager.KillTweensOf(this),Zt.TweenManager.Timeline(this).to({_lerpQuatStrength:5},1).start(),this.springLength=o,this._targetLookAt.copy(r),this._targetRotation.copy(p)}setNewRange(r=[.02,.3],o=[-100,100]){this._springRotationZClampRange=r,this._springRotationYClampRange=o}}const lE=.3;let j_=!0;function cE(t){if(!Lt.isInClickEffect&&j_)switch(j_=!1,Zt.TweenManager.Timeline(lE).delay(lE).call(()=>j_=!0).start(),Lt.currentShowingState){case Tn.State1:t?Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State2):Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State4);break;case Tn.State2:t?Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State3):Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State1);break;case Tn.State3:t?Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State4):Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State2);break;case Tn.State4:t?Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State1):Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State3);break}}class yk extends xa{constructor(r=new rm(1024,1024)){super();B(this,"clipBias",0);B(this,"_camera");B(this,"reflectPlane");B(this,"_reflectMatrix");B(this,"_renderTexture");B(this,"debugPlane");const o=r;this._camera=new zP,this.reflectPlane=new JB,this._reflectMatrix=new Jx,this._renderTexture=new VP(o.x,o.y),this._renderTexture.texture.generateMipmaps=!0,this._renderTexture.texture.minFilter=tE,this._renderTexture.texture.magFilter=tE,this._renderTexture.texture.wrapS=$M,this._renderTexture.texture.wrapT=$M;const p=new YB({depthWrite:!1,transparent:!0});this.debugPlane=new NP(new GP(.01,.01),p),this.debugPlane.rotateX(-Math.PI*.5),this.debugPlane.renderOrder=0,this.onLoad=()=>{this.node.add(this.debugPlane),this.viewer.addNode(this._camera),this.reflectPlane.set(Yn.UP,0),this.reflectPlane.applyMatrix4(this.node.matrixWorld),Ne.u_reflect.u_reflectMatrix.value=this._reflectMatrix,Ne.u_reflect.u_reflectTexture.value=this._renderTexture.texture}}lastUpdate(r){this.beforeRender()}beforeRender(){this.reflectPlane.set(Yn.UP,0),this.reflectPlane.applyMatrix4(this.node.matrixWorld),this._camera.copy(this.viewer.camera);const r=Yn.UNIT_Z.clone().negate(),o=this.viewer.camera.getWorldPosition(new Yn);if(r.applyQuaternion(this.viewer.camera.getWorldQuaternion(new $a)),r.dot(this.reflectPlane.normal)>.2){console.log("no need capture reflect:",r.dot(this.reflectPlane.normal),r,this.reflectPlane.normal);return}r.reflect(this.reflectPlane.normal);const p=new Yn;this.reflectPlane.projectPoint(o,p);const y=p.clone();y.sub(o),y.add(p),this._camera.position.copy(y);const d=new Yn(0,0,-1);d.applyQuaternion(this.viewer.camera.getWorldQuaternion(new $a)),d.add(o);const E=new Yn;this.node.getWorldPosition(E),E.sub(d),E.reflect(this.reflectPlane.normal).negate(),E.add(this.node.getWorldPosition(new Yn)),this._camera.up.set(0,1,0),this._camera.applyQuaternion(this.viewer.camera.getWorldQuaternion(new $a)),this._camera.up.reflect(this.reflectPlane.normal),this._camera.lookAt(E),this._camera.updateMatrixWorld();const L=new Jx;L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(this._camera.projectionMatrix),L.multiply(this._camera.matrixWorldInverse),this._reflectMatrix.copy(L),this.reflectPlane.applyMatrix4(this._camera.matrixWorldInverse);const k=new sm(this.reflectPlane.normal.x,this.reflectPlane.normal.y,this.reflectPlane.normal.z,this.reflectPlane.constant),X=this._camera.projectionMatrix,$=new sm;$.x=(Math.sign(k.x)+X.elements[8])/X.elements[0],$.y=(Math.sign(k.y)+X.elements[9])/X.elements[5],$.z=-1,$.w=(1+X.elements[10])/X.elements[14],k.multiplyScalar(2/k.dot($)),X.elements[2]=k.x,X.elements[6]=k.y,X.elements[10]=k.z+1-this.clipBias,X.elements[14]=k.w;const Z=this.viewer.renderer.getRenderTarget();this.viewer.renderer.setRenderTarget(this._renderTexture),this.viewer.renderer.state.buffers.depth.setMask(!0),this.viewer.renderer.autoClear===!1&&this.viewer.renderer.clear(),this.debugPlane.visible=!1,Ne.reflectMeshes.forEach(be=>be.visible=!1),this.viewer.renderer.render(this.viewer.scene,this._camera),Ne.reflectMeshes.forEach(be=>be.visible=!0),this.debugPlane.visible=!0,this.viewer.renderer.setRenderTarget(Z);const ge=this.viewer.camera.viewport;ge!==void 0&&this.viewer.renderer.state.viewport(ge)}}const a0=`
	vec2 hash( vec2 p ) {
		p = vec2(dot(p,vec2(127.1,311.7)), dot(p,vec2(269.5,183.3)));
		return -1.0 + 2.0*fract(sin(p)*43758.5453123);
	}
	float noise2d( in vec2 p ) {
		const float K1 = 0.366025404; // (sqrt(3)-1)/2;
		const float K2 = 0.211324865; // (3-sqrt(3))/6;
		vec2 i = floor(p + (p.x+p.y)*K1);	
		vec2 a = p - i + (i.x+i.y)*K2;
		vec2 o = (a.x>a.y) ? vec2(1.0,0.0) : vec2(0.0,1.0); //vec2 of = 0.5 + 0.5*vec2(sign(a.x-a.y), sign(a.y-a.x));
		vec2 b = a - o + K2;
		vec2 c = a - 1.0 + 2.0*K2;
		vec3 h = max(0.5-vec3(dot(a,a), dot(b,b), dot(c,c) ), 0.0 );
		vec3 n = h*h*h*h*vec3( dot(a,hash(i+0.0)), dot(b,hash(i+o)), dot(c,hash(i+1.0)));
		return dot(n, vec3(70.0));	
}`,_k=`
float random (vec2 st) {
    return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))*
        43758.5453123);
}

vec3 pos2col ( vec2 ipos ) {

    ipos += vec2(9.,0.); // Just moved to pick some nice colors
    
    float r = random( ipos + vec2( 12., 2. ) );
    float g = random( ipos + vec2(7., 5. ) );
    float b = random( ipos );

    
    vec3 col = vec3(r,g,b);
    return col;
}

vec3 colorNoise ( vec2 st ) {
    vec2 ipos = floor( st );
    vec2 fpos = fract( st );

    
    // Four corners in 2D of a tile
    vec3 a = pos2col(ipos);
    vec3 b = pos2col(ipos + vec2(1.0, 0.0));
    vec3 c = pos2col(ipos + vec2(0.0, 1.0));
    vec3 d = pos2col(ipos + vec2(1.0, 1.0));
    
    // Cubic Hermine Curve.  Same as SmoothStep()
    vec2 u = fpos*fpos*(3.0-2.0*fpos);
    // u = smoothstep(0.,1.,fpos);
    
    // Mix 4 coorners percentages
    return mix(a, b, u.x) +
            (c - a)* u.y * (1.0 - u.x) +
            (d - b) * u.x * u.y;
}
`,gm=`
varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vPositionObj;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec3 vViewPosition;
varying vec4 viewerUV;

#ifdef USE_INSTANCING
  varying vec3 vPositionIns;
  varying vec3 vPositionInsModel;
  varying vec3 vInstanceColor;
  attribute vec3 instanceColor; // 
#endif

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vPositionObj = vec3( modelMatrix*vec4( vec3(0.), 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    vUv = uv;
    vColor=color;

    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    vViewPosition = -mvPosition.xyz;

    #ifdef USE_INSTANCING
      vPositionInsModel = position;
      vPositionIns = vec3(instanceMatrix * vec4(vec3(0.),1.));
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
      vInstanceColor = instanceColor;
    #endif
    
    gl_Position = projectionMatrix * mvPosition;
    viewerUV = vec4((gl_Position.xyz / gl_Position.w).xy* 0.5 + 0.5,0.,1.);
}`,xk=`
varying vec4 vWorldPosition;
    varying vec2 vUv;
    varying vec2 vUv2;
    varying vec4 vViewPosition;
    varying vec3 vNormal;
    varying vec4 vTangent;

    uniform vec3 color;
    uniform sampler2D map;
    uniform float opacity;
    uniform float roughness;
    uniform sampler2D roughnessMap;
    uniform float metalness;
    uniform sampler2D metalnessMap;
    uniform sampler2D aoMap;
    uniform sampler2D lightMap;
    uniform vec3 lightMapColor;
    uniform float lightMapIntensity;
    uniform vec3 emissive;
    uniform sampler2D emissiveMap;
    uniform sampler2D normalMap;
    uniform float distortionScale;
    uniform float u_floor_typeSwitch;
    uniform sampler2D ut_street;

    uniform float u_lightIntensity;
    uniform float u_reflectIntensity;
    uniform vec2 u_floorUVOffset;

    uniform mat4 u_reflectMatrix;
    uniform sampler2D u_reflectTexture;

    #include <common>
    #include <packing>
    #include <bsdfs>
    #include <fog_pars_fragment>
    #include <logdepthbuf_pars_fragment>
    #include <lights_pars_begin>
    #include <shadowmap_pars_fragment>
    #include <shadowmask_pars_fragment>

    vec4 getNoise( vec2 uv ) {
        vec2 uv0 = ( uv / 103.0 );
        vec2 uv1 = uv / 107.0;
        vec2 uv2 = uv / vec2( 8907.0, 9803.0 );
        vec2 uv3 = uv / vec2( 1091.0, 1027.0 );
        vec4 noise = texture2D( normalMap, uv0 ) +
            texture2D( normalMap, uv1 ) +
            texture2D( normalMap, uv2 ) +
            texture2D( normalMap, uv3 );
        return noise * 0.5 - 1.0;
    }

    void main(){
        #include <logdepthbuf_fragment>

        vec3 surfaceNormal = vec3(0.,1.,0.);
        #ifdef USE_NORMAL_MAP
            vec3 normalSample = texture2D( normalMap, vWorldPosition.xz+u_floorUVOffset).rgb*2.-vec3(1.);
            surfaceNormal = normalize( normalSample.xzy );
        #endif

        vec3 diffuseLight = vec3(0.0);
        vec3 eyeDirection = -vViewPosition.xyz;
        float d = length(eyeDirection);
        eyeDirection = normalize(eyeDirection);

        //
        vec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / d ) * distortionScale;

        float metallic = metalness;
        #ifdef USE_METALNESS_MAP
            metallic = texture2D(metalnessMap, vUv).b * metallic;
        #endif

        float theta = max( dot( eyeDirection, vNormal ), 0.0 );
        float rf0 = 0.02;
        float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 2.0 );

        float roughness_factory = roughness;
        #ifdef USE_ROUGHNESS_MAP
            roughness_factory *= texture2D(roughnessMap, (vWorldPosition.xz+u_floorUVOffset)*0.2).g;
        #endif
        roughness_factory = roughness_factory*(1.7 - 0.7*roughness_factory);

        vec4 samplePoint = u_reflectMatrix * vWorldPosition;
        samplePoint = samplePoint / samplePoint.w;
        vec3 reflectionSample = texture2D(u_reflectTexture, samplePoint.xy + distortion, roughness_factory*6.).xyz * u_reflectIntensity;
        vec3 lightSample = vec3(lightMapIntensity * u_lightIntensity)*lightMapColor;

		#ifdef USE_LIGHT_MAP
			lightSample *= texture2D(lightMap,vUv2).rgb;
		#endif

        #ifdef USE_AO_MAP
			float aoSample = texture2D(aoMap,vUv2).r;
			lightSample*=aoSample;
		#endif

        vec3 streetCol = texture(ut_street,vec2((vWorldPosition.z+15.)/30.,(vWorldPosition.x+u_floorUVOffset.x)/60.)).rgb;
        lightSample = mix(lightSample,streetCol,vec3(u_floor_typeSwitch));

        vec3 colorFactory = color;
        #ifdef USE_MAP
            vec3 mapColor = texture2D(map, vUv);
            colorFactory *= mapColor.rgb;
        #endif

        //
        diffuseLight = lightSample * colorFactory; //* theta;
        vec3 outColor = mix(diffuseLight, reflectionSample, reflectance);

        gl_FragColor = vec4(outColor, opacity);
        // gl_FragColor = vec4(vec3(theta*(roughness_factory)), 1.);
        // gl_FragColor = vec4(vec3(texture2D(lightMap,vUv2).rgb), 1.);
        #include <tonemapping_fragment>
        #include <encodings_fragment>
        #include <fog_fragment>
    }
`,bk=`
varying vec4 vWorldPosition;
    varying vec2 vUv;
    varying vec2 vUv2;
    varying vec4 vViewPosition;
    varying vec3 vNormal;
    varying vec4 vTangent;

    attribute vec2 uv2;

    #include <common>
    #include <fog_pars_vertex>
    #include <shadowmap_pars_vertex>
    #include <logdepthbuf_pars_vertex>

    void main() {
        vUv = uv;
        vUv2 = uv2;
        vWorldPosition = modelMatrix * vec4( position, 1.0 );
        vec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );
        vViewPosition = mvPosition / mvPosition.w;
        vNormal = normalMatrix * normal;
        #ifdef USE_TANGENT
        vTangent = tangent;
        #endif
        gl_Position = projectionMatrix * mvPosition;
    
        #include <beginnormal_vertex>
        #include <defaultnormal_vertex>
        #include <logdepthbuf_vertex>
        #include <fog_vertex>
        #include <shadowmap_vertex>
    }`,wk=`varying vec3 vPosition;
varying vec3 vNormal;
varying vec2 vUv;
varying vec3 vPositionW;
varying vec3 vNormalW;
attribute vec3 color;
varying vec3 vColor;
varying vec4 viewerUV;

void main() {
    vPosition = position;
    vNormal = normalMatrix * normal;
    vPositionW = vec3( modelMatrix*vec4( position, 1.0 ));
    vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
    vUv = uv;
    vColor=color;

    #ifdef USE_INSTANCING
      vPositionW = vec3(instanceMatrix * vec4(vPositionW,1.));
      vPosition = vec3(instanceMatrix * vec4(vPosition,1.));
    #endif

    // 
    vec3 instancePosition = vec3(modelMatrix * vec4(vec3(0.),1.));
    #ifdef USE_INSTANCING
      instancePosition = vec3(instanceMatrix * vec4(vec3(0.),1.));
    #endif

    vec3 normalFace = vec3(0.,1.,0.);
    vec3 cameraDir = normalize(cameraPosition.xyz - instancePosition);
    vec3 vcV = normalize(cross( normalFace,cameraDir ));
    vec3 vcU = normalize(cross( cameraDir,vcV ));
    vec3 vcN = normalize(cross( vcV,vcU ));
    mat3 viewMatrix = mat3( vcV, vcU, vcN );
    

    float scale = 1.;
    #ifdef USE_DISTANCE_SCALING
      scale = pow(length(cameraPosition - instancePosition) / 50000., 0.8);
    #endif

    vec3 mvPosition = viewMatrix * vec3( position * scale);
    #ifdef USE_INSTANCING
      mvPosition.xyz += instancePosition;
    #endif
    gl_Position = projectionMatrix * modelViewMatrix * vec4(mvPosition, 1.0);
    viewerUV = vec4((gl_Position.xyz / gl_Position.w).xy* 0.5 + 0.5,0.,1.);
}`;function Ak(){l0.matcap=Ne.ut_scar_matcap.value}function Sk(t){if(!t){console.warn("ReflectMaterial: no mesh parameter");return}const i={color:{value:new bi},map:{value:null},opacity:{value:1},roughness:{value:1},roughnessMap:{value:null},metalness:{value:1},metalnessMap:{value:null},aoMap:{value:null},lightMap:{value:null},lightMapColor:Ne.u_floorLightMapColor,lightMapIntensity:{value:1},emissive:{value:new bi},emissiveMap:{value:null},normalMap:{value:null},distortionScale:{value:0},u_lightIntensity:Ne.u_floorLightMapIntensity,u_reflectIntensity:Ne.u_floorReflectIntensity,u_floor_typeSwitch:Ne.u_floor_typeSwitch,ut_street:Ne.ut_street,u_floorUVOffset:Ne.u_floorUVOffset,...iE.fog,...iE.lights,...Ne.u_reflect},r={},o=t.material;if(o){i.color={value:o.color},o.map&&(o.map.anisotropy=4,i.map={value:o.map},r.USE_MAP=""),i.opacity={value:o.opacity},o.roughnessMap&&(i.roughnessMap={value:o.roughnessMap},r.USE_ROUGHNESS_MAP=""),i.metalness={value:o.metalness},o.metalnessMap&&(i.metalnessMap={value:o.metalnessMap},r.USE_METALNESS_MAP=""),i.emissive={value:o.emissive},o.emissiveMap&&(i.emissiveMap={value:o.emissiveMap},r.USE_EMISSIVE_MAP=""),o.aoMap&&(i.aoMap={value:o.aoMap},r.USE_AO_MAP=""),i.lightMapIntensity={value:o.lightMapIntensity},o.lightMap&&(i.lightMap={value:o.lightMap},r.USE_LIGHT_MAP=""),o.normalMap&&(o.normalMap.anisotropy=4,i.normalMap={value:o.normalMap},r.USE_NORMAL_MAP="");const p=new go({defines:r,uniforms:i,vertexShader:bk,fragmentShader:xk});p.name="M_Reflect",t.layers.disable(Ne.PlaneReflectLayer),Ne.reflectMeshes.push(t),t.material=p}else console.log("ReflectMaterial: not a MeshStandardMaterial")}const Mk=new go({uniforms:{time:Ne.u_speedTime,vSpeed:Ne.u_speedUpBackgroundValue},vertexShader:gm,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;

    uniform float vSpeed;
    uniform float time;

    ${a0}
    ${_k}
    void main() {
        vec2 uv_0 = vUv+vec2(-time*0.5,0.);
        float noiseMask = (noise2d(uv_0*vec2(3.,100.))+1.)/2.;
        noiseMask = pow(clamp(noiseMask-0.1,0.,1.),11.);
        noiseMask = smoothstep(0.0,0.04,noiseMask)*2.;

        vec3 colorNoiseMask = colorNoise(uv_0*vec2(10.,100.))*vec3(1.5,1.,400.);
        noiseMask*=smoothstep(0.02,0.5,vUv.x)*smoothstep(0.02,0.5,1.-vUv.x);
        noiseMask*=smoothstep(0.01,0.1,vUv.y)*smoothstep(0.01,0.1,1.-vUv.y);

        noiseMask*=smoothstep(1.,10.,vSpeed);

        gl_FragColor = vec4(vec3(colorNoiseMask),noiseMask);
        // #include <tonemapping_fragment>
        // #include <encodings_fragment>
    }
    `,depthWrite:!1,transparent:!0});function Ek(t){if(t instanceof KB){const i=t;i.onBeforeCompile=r=>{let o=r.fragmentShader,p=r.vertexShader;p=p.replace("#include <common>",`
            #include <common>
            varying vec3 reflectVec;
            #if (!defined(USE_UV))
                #define USE_UV
            #endif
            `),p=p.replace("#include <fog_vertex>",`
            #include <fog_vertex>
            vec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );
            vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
            reflectVec = reflect( cameraToVertex, worldNormal);
            `),o=o.replace("#include <common>",`
            #include <common>
            varying vec3 reflectVec;
            uniform samplerCube cubeCaptureReflectMap;
            uniform samplerCube blurCaptureReflectMap;
            uniform float vEnvMapIntensity;
            uniform float vDiscardOpacity;
            ${a0}
            #if (!defined(USE_UV))
                #define USE_UV
            #endif
            
            `),o=o.replace("#include <envmap_physical_pars_fragment>",`
            #if defined( USE_ENVMAP )

            #if defined( USE_BOX_PROJECTION )

                uniform vec4 probePos;
                uniform vec3 probeBoxMin;
                uniform vec3 probeBoxMax;

                vec3 boxProjection(vec3 nrdir, vec3 worldPos, vec3 probePos, vec3 boxMin, vec3 boxMax) {

                    vec3 tbot = boxMin - worldPos;
                    vec3 ttop = boxMax - worldPos;
                    vec3 tmax = mix(tbot, ttop, step(vec3(0), nrdir));
                    tmax /= nrdir;
                    float t = min(min(tmax.x, tmax.y), tmax.z);
                    return worldPos + nrdir * t - probePos;
                
                }
            #endif
                vec3 getIBLIrradiance( const in vec3 normal ) {

                    //
                    #if defined( ENVMAP_TYPE_CUBE_UV )

                        vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

                        #if defined( USE_BOX_PROJECTION )
                            if (probePos.w > 0.001) {
                                worldNormal = boxProjection(worldNormal, vWorldPosition, probePos.xyz, probeBoxMin.xyz, probeBoxMax.xyz);
                            }
                        #endif

                        vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1. );
                        vec4 reflectColor = textureLod( blurCaptureReflectMap, worldNormal, 0.);
                            
                        return PI * mix( reflectColor.rgb, envMapColor.rgb, vEnvMapIntensity);
                    #else

                        return vec3( 0.0 );

                    #endif

                }

                vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

                    #if defined( ENVMAP_TYPE_CUBE_UV )

                        vec3 reflectVec = reflect( - viewDir, normal );

                        // Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
                        reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

                        reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

                    #if defined( USE_BOX_PROJECTION )
                        if (probePos.w > 0.001) {
                            reflectVec = boxProjection(reflectVec, vWorldPosition, probePos.xyz, probeBoxMin.xyz, probeBoxMax.xyz);
                        }
                    #endif

                        vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
                        envMapColor.rgb *= vEnvMapIntensity;

                        float lod = roughness*(1.7 - 0.7*roughness);
                        envMapColor.rgb += textureLod( cubeCaptureReflectMap, reflectVec, lod ).rgb * 4.;

                        return envMapColor.rgb;
                    #else

                        return vec3( 0.0 );

                    #endif

                }

            #endif
            `),o=o.replace("#include <clipping_planes_fragment>",`

            float discardMask = (noise2d(vUv*15.)+1.)/2.;
            float mm = 1.-(vWorldPosition.x+2.7)/5.4;
            if(mm < (1. - vDiscardOpacity)) discard;
            #include <clipping_planes_fragment>
            `),o=o.replace("#include <dithering_fragment>",`
            #include <dithering_fragment>
            float discardLightMask = (1.-step(mm,(1. - vDiscardOpacity)))*step(mm,(1. - vDiscardOpacity)+0.002);
            gl_FragColor = vec4(vec3(mix(gl_FragColor.rgb,vec3(0.5,0.9,1.),vec3(discardLightMask))),gl_FragColor.a);
            `),r.uniforms.cubeCaptureReflectMap=Ne.ut_cubeCapture,r.uniforms.blurCaptureReflectMap=Ne.ut_blurCapture,r.uniforms.vEnvMapIntensity=Ne.u_car_envMapIntensity,r.uniforms.vDiscardOpacity=Ne.u_car_discard,r.vertexShader=p,r.fragmentShader=o}}else return}const Tk=new go({name:"m_curvature",uniforms:{opacity:{value:1},vColor:{value:new bi("#fdffc7")},tSaLine:Ne.ut_saLine,time:Ne.u_time},vertexShader:gm,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;

    uniform sampler2D tSaLine;
    uniform vec3 vColor;
    uniform float opacity;
    uniform float time;
    void main() {
        vec2 l_uv = vUv*50.+vec2(-time,0.);
        float mask = texture(tSaLine,l_uv).r;
        mask*=(1.-smoothstep(0.2,0.28,vUv.x));
        
        gl_FragColor = vec4(vec3(vColor),mask*opacity);
    }
    `,depthWrite:!1,side:o0,transparent:!0}),Ck=new go({name:"m_windLine",uniforms:{vNoiseParams_alpha:{value:new sm(6,2,2,.5)},vNoiseParams_wave:{value:new sm(2,1,1,.5)},vIntensity:{value:3},vColor:{value:new bi("#cdeffe")},tSaLine:Ne.ut_saLine,time:Ne.u_time,opacity:{value:1}},vertexShader:gm,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;

    uniform vec4 vNoiseParams_alpha;
    uniform vec4 vNoiseParams_wave;
    uniform float vIntensity;
    uniform vec3 vColor;
    uniform float time;
    uniform float opacity;
    uniform sampler2D tSaLine;
    ${a0}

    void main() {
        float noiseMask_alpha = noise2d((vUv+vec2(0.,time*vNoiseParams_alpha.w))*vNoiseParams_alpha.xy)*vNoiseParams_alpha.z;
        float noiseMask_wave = noise2d((vUv+vec2(0.,time*vNoiseParams_wave.w))*vNoiseParams_wave.xy)*vNoiseParams_wave.z;
        vec2 l_uv = vUv*10.;
        float mask = texture(tSaLine,l_uv+vec2(noiseMask_wave,0.)).r;
        // float mask = texture(tSaLine,l_uv).r;
        mask*=(smoothstep(0.,0.5,vUv.y))*(1.-smoothstep(0.5,1.,vUv.y));

        gl_FragColor = vec4(vec3(vColor),mask*(noiseMask_alpha+0.5)*vIntensity*opacity);
    }
    `,transparent:!0,depthWrite:!1,side:o0}),Pk=new go({name:"m_linecar",uniforms:{time:Ne.u_time,opacity:{value:1},vNoiseParams_wave:{value:new sm(1,20,10,1.2)}},vertexShader:gm,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;
    varying vec3 vColor;

    uniform float time;
    uniform float opacity;
    uniform vec4 vNoiseParams_wave;
    ${a0}

    void main() {
        float noiseMask_alpha = noise2d((vUv+vec2(time*vNoiseParams_wave.w,0.))*vNoiseParams_wave.xy)*vNoiseParams_wave.z;
        float mask = noiseMask_alpha*(smoothstep(0.05,0.4,vUv.x))*(1.-smoothstep(0.6,0.95,vUv.x));
        mask = mask*(smoothstep(0.05,0.4,vUv.y))*(1.-smoothstep(0.6,0.95,vUv.y));
        gl_FragColor = vec4(vec3(vColor*2.),mask*opacity);
    }

    `,transparent:!0,depthWrite:!1,blending:cw,side:o0}),Rk=new go({name:"m_carradar",uniforms:{time:Ne.u_time,opacity:{value:1},uColor:{value:new bi("#88eeff")},uCenter1:Ne.u_simpleCarCenter1,uCenter2:Ne.u_simpleCarCenter2},vertexShader:gm,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;

    uniform vec3 uColor;
    uniform float time;
    uniform float opacity;
    uniform vec3 uCenter1;
    uniform vec3 uCenter2;

    const float X_By_Y = 2.3; //  x/z

    //
    float normalizedEllipticalDistance(vec3 position, vec3 center, float radius) {
        vec2 d = center.xz - position.xz;
        d.y *= X_By_Y;
        return length(d) / radius;
    }

    void main() {

        float distanceP = clamp(1. - normalizedEllipticalDistance(vPositionW, uCenter1, 4.3), 0., 1.);
        distanceP += clamp(1. - normalizedEllipticalDistance(vPositionW, uCenter2, 4.3), 0., 1.);

        float uv_x = vUv.x*10. - time*3.;
        float maskCos = cos(uv_x);

        float maskX = mod(vUv.x*10.-time*3.,1.);
        maskX = step(maskX,0.2+distanceP*0.8);
        maskX *= maskCos;

        float maskY = mod(vUv.y*100.,1.);
        maskY = step(maskY,0.2);

        float mask = maskX*maskY;

        vec3 color = mix(uColor,vec3(0.1,1.,0.2),vec3(smoothstep(0.,0.5,distanceP)));

        gl_FragColor = vec4(vec3(color),mask*opacity);
        // gl_FragColor = vec4(vec3(distanceP),1.);
    }

    `,transparent:!0,depthWrite:!1,blending:cw,side:o0}),l0=new QB({transparent:!0,blending:cw});l0.onBeforeCompile=t=>{let i=t.fragmentShader,r=t.vertexShader;r=r.replace("#include <common>",`
        #include <common>
        varying vec3 vWorldPosition;
        `),r=r.replace("#include <fog_vertex>",`
        #include <fog_vertex>
        vWorldPosition = vec3( modelMatrix*vec4( position, 1.0 ));
        `),i=i.replace("#include <common>",`
        #include <common>
        varying vec3 vWorldPosition;
        `),i=i.replace("vec4 diffuseColor = vec4( diffuse, opacity );",`
        float op = opacity*clamp(1.-abs(vWorldPosition.x)/14.,0.,1.);
        vec4 diffuseColor = vec4( diffuse, op );
        `),t.vertexShader=r,t.fragmentShader=i};const uE=new go({name:"m_radarPoints",uniforms:{time:Ne.u_time,opacity:{value:0},vColor:{value:new bi("#fff")}},vertexShader:wk,fragmentShader:`
    varying vec3 vPosition;
    varying vec3 vNormal;
    varying vec2 vUv;
    varying vec3 vPositionW;
    varying vec3 vNormalW;

    uniform float time;
    uniform float opacity;
    uniform vec3 vColor;

    void main() {
        float distanceUV = length(vUv-vec2(0.5,0.5));
        distanceUV = smoothstep(distanceUV,0.2,1.);
        gl_FragColor = vec4(vec3(vColor),opacity*distanceUV);
        // gl_FragColor = vec4(vec3(distanceP),1.);
    }

    `,transparent:!0});var Dk=Object.defineProperty,Ik=Object.getOwnPropertyDescriptor,jP=(t,i,r,o)=>{for(var p=o>1?void 0:o?Ik(i,r):i,y=t.length-1,d;y>=0;y--)(d=t[y])&&(p=(o?d(i,r,p):d(p))||p);return o&&p&&Dk(i,r,p),p};const Lk=`
varying vec2   vUv;

void main() {
    vUv = uv;
    gl_Position = vec4(position, 1.);
}
`,Ok=`
uniform sampler2D tEnv0;
uniform sampler2D tEnv1;
uniform float     weight;
uniform float     intensity;

varying vec2      vUv;

void main() {
    vec3 col0 = texture(tEnv0, vUv).rgb;
    vec3 col1 = texture(tEnv1, vUv).rgb;
    gl_FragColor = vec4(mix(col0, col1, weight) * intensity, 1.);
}
`;class hw extends xa{constructor(r){super();B(this,"_envRT");B(this,"_mixMaterial");B(this,"_pmremGenerator");B(this,"_needsUpdate",!0);this._init=()=>{const o=r.envMap0,p=r.envMap1;this._mixMaterial=new go({vertexShader:Lk,fragmentShader:Ok,uniforms:{tEnv0:{value:o},tEnv1:{value:p},intensity:{value:1},weight:{value:0}}});const y=o.source.data;this._envRT=new VP(y.width,y.height,{magFilter:eE,minFilter:eE,generateMipmaps:!1,type:WB,format:HP,encoding:bd,depthBuffer:!1}),this._envRT.texture.mapping=NB}}get intensity(){return this._mixMaterial.uniforms.intensity.value}set intensity(r){this._mixMaterial.uniforms.intensity.value!==r&&(this._mixMaterial.uniforms.intensity.value=r,this._needsUpdate=!0)}get weight(){return this._mixMaterial.uniforms.weight.value}set weight(r){this._mixMaterial.uniforms.weight.value!==r&&(this._mixMaterial.uniforms.weight.value=r,this._needsUpdate=!0)}get envMap(){return this._envRT.texture}onLoad(){this._init&&this._init()}update(){this._needsUpdate&&(this._needsUpdate=!1,kB(this.viewer.renderer,this._envRT,this._mixMaterial))}onDestroy(){var r;this._envRT.dispose(),this._mixMaterial.dispose(),(r=this._pmremGenerator)==null||r.dispose()}}jP([tl({min:0,max:1,step:.01})],hw.prototype,"intensity",1);jP([tl({min:0,max:1,step:.01})],hw.prototype,"weight",1);var $x=(t=>(t[t.dark=0]="dark",t[t.night=1]="night",t[t.light=2]="light",t))($x||{});class Fk extends xa{constructor(r,o){super();B(this,"_dynamicEnv");this.onLoad=()=>{this._dynamicEnv=this.viewer.addNode(new hw({envMap0:r,envMap1:o})),this._dynamicEnv.intensity=0,this._dynamicEnv.weight=0,this.viewer.scene.environment=this._dynamicEnv.envMap}}setState(r,o=1,p=Zt.Easing.Cubic.InOut,y=1){switch(r){case 0:Zt.TweenManager.KillTweensOf(this._dynamicEnv),Zt.TweenManager.Tween(this._dynamicEnv).to({intensity:0,weight:0},o).easing(p).start();break;case 1:Zt.TweenManager.KillTweensOf(this._dynamicEnv),Zt.TweenManager.Tween(this._dynamicEnv).to({intensity:y,weight:0},o).easing(p).start();break;case 2:Zt.TweenManager.KillTweensOf(this._dynamicEnv),Zt.TweenManager.Tween(this._dynamicEnv).to({intensity:y,weight:1},o).easing(p).start();break}}}const hE=new bi("#000000"),Bk=new bi("#000000"),kk=new bi("#ffffff");class Uk extends xa{constructor(r){super();B(this,"_lightMaterial");B(this,"_lightValue",0);this.onLoad=()=>{this._lightMaterial=r.meshData.materials.Car_ight,this._lightMaterial.toneMapped=!1,this._lightMaterial.aoMapIntensity=0,this._lightMaterial.color=hE,this._lightMaterial.needsUpdate=!0}}set lightValue(r){this._lightValue=r,hE.copy(Bk).lerp(kk,r)}get lightValue(){return this._lightValue}}class Nk extends xa{constructor(r){super();B(this,"_lightMaterial");this.onLoad=()=>{this._lightMaterial=r.meshData.materials.light,this._lightMaterial.emissive.setRGB(0,0,0),this._lightMaterial.transparent=!0,this._lightMaterial.depthWrite=!1,this._lightMaterial.needsUpdate=!0,this.opacity=1}}get lightEmissiveIntensity(){return this._lightMaterial.emissiveIntensity}set lightEmissiveIntensity(r){this._lightMaterial.emissiveIntensity=r}get lightEmissiveColor(){return this._lightMaterial.emissive}set lightEmissiveColor(r){this._lightMaterial.emissive.copy(r)}get opacity(){return this._lightMaterial.opacity}set opacity(r){this._lightMaterial.opacity=r}}class zk extends xa{onEnable(){this.viewer.on(us.POINTER_DOWN,this._onPointerDown,this),this.viewer.on(us.POINTER_UP,this._onPointerUp,this)}onDisable(){this.viewer.off(us.POINTER_DOWN,this._onPointerDown,this),this.viewer.off(us.POINTER_UP,this._onPointerUp,this)}_onPointerDown(){Lt.emit(Lt.CLICKEFFECT,!0)}_onPointerUp(){Lt.emit(Lt.CLICKEFFECT,!1)}}const dE=new Yn;class Gk extends xa{constructor(r,o){super();B(this,"_wheels");B(this,"_targetVelocity",0);B(this,"_currentVelocity",0);B(this,"_lerpStrength",1);B(this,"_springCameraOB");this.onLoad=()=>{const p=r.children[0].children.find(y=>y.name=="Wheel");this._wheels=p,this._springCameraOB=o}}set targetVelocity(r){this._targetVelocity=r}set lerpStrength(r){this._lerpStrength=r}update(r){this._currentVelocity=Fl(this._currentVelocity,this._targetVelocity,r*this._lerpStrength);for(const p of this._wheels.children)p.rotateZ(-this._currentVelocity*r/(Math.PI*.737774)*2*Math.PI);Ne.u_floorUVOffset.value.x+=this._currentVelocity*r;let o=Ne.u_speedUpBackgroundValue.value;Lt.currentShowingState==Tn.State1?o=Fl(o,this._currentVelocity,r*2):o=Fl(o,0,r*5),Ne.u_speedUpBackgroundValue.value=o,dE.set(1,1,1).multiplyScalar(o/5),this._springCameraOB._springCamera.positionScale.copy(dE),o<.1?Ne.sm_speedup.visible=!1:Ne.sm_speedup.visible=!0}}class _h extends xa{constructor(){super(...arguments);B(this,"controller",null)}show(r=1,o=0){Zt.TweenManager.KillTweensOf(this.controller),Zt.TweenManager.Tween(this.controller).delay(o).to({visibility:1},r).easing(Zt.Easing.Cubic.InOut).start()}hide(r=1,o=0){Zt.TweenManager.KillTweensOf(this.controller),Zt.TweenManager.Tween(this.controller).delay(o).to({visibility:0},r).easing(Zt.Easing.Cubic.InOut).start()}}class Hk extends _h{onLoad(){const{materials:i}=Ne.sm_size.meshData;this.viewer.addNode(Ne.sm_size),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,p>=.005?Ne.sm_size.visible=!0:Ne.sm_size.visible=!1,Object.values(i).forEach(y=>{y.opacity=p,y instanceof go&&(y.uniforms.opacity.value=p)}),!0)}),this.controller.visibility=0}}class Vk extends _h{onLoad(){const{materials:i}=Ne.sm_curvature.meshData;this.viewer.addNode(Ne.sm_curvature),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,p>=.005?Ne.sm_curvature.visible=!0:Ne.sm_curvature.visible=!1,Object.values(i).forEach(y=>{y.opacity=p,y instanceof go&&(y.uniforms.opacity.value=p)}),!0)}),this.controller.visibility=0}}class Wk extends _h{onLoad(){const{materials:i}=Ne.sm_windspeed.meshData;this.viewer.addNode(Ne.sm_windspeed),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,p>=.005?Ne.sm_windspeed.visible=!0:Ne.sm_windspeed.visible=!1,Object.values(i).forEach(y=>{y.opacity=p,y instanceof go&&(y.uniforms.opacity.value=p)}),!0)}),this.controller.visibility=0}}class jk extends _h{onLoad(){const{materials:i}=Ne.sm_linecar.meshData;this.viewer.addNode(Ne.sm_linecar),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,p>=.005?Ne.sm_linecar.visible=!0:Ne.sm_linecar.visible=!1,Object.values(i).forEach(y=>{Ne.u_car_discard.value=1-p,y.opacity=p,y instanceof go&&(y.uniforms.opacity.value=p)}),!0)}),this.controller.visibility=0}}class Xk extends _h{onLoad(){const{materials:i}=Ne.sm_carradar.meshData;this.viewer.addNode(Ne.sm_carradar),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,Ne.u_floor_typeSwitch.value=p,p>=.005?Ne.sm_carradar.visible=!0:Ne.sm_carradar.visible=!1,Object.values(i).forEach(y=>{y.opacity=p,y instanceof go&&(y.uniforms.opacity.value=p)}),!0)}),this.controller.visibility=0}}class Yk extends _h{constructor(){super(...arguments);B(this,"_length",17);B(this,"_car1");B(this,"_car2");B(this,"_moveParams1",new Yn);B(this,"_moveParams2",new Yn)}onLoad(){this._car1=Ne.sm_simpleCar.children[0],this._car2=this._car1.clone(),Ne.sm_simpleCar.add(this._car2),this.viewer.addNode(Ne.sm_simpleCar),this.controller=new Proxy({visibility:1},{set:(r,o,p)=>(r[o]=p,p>=.005?Ne.sm_simpleCar.visible=!0:Ne.sm_simpleCar.visible=!1,l0.opacity=p,!0)}),this.controller.visibility=0,this.randomUpdate(this._moveParams1,this._car1),this.randomUpdate(this._moveParams2,this._car2)}randomUpdate(r,o){r.x=Math.random()>.5?-1:1,r.y=Math.random()*3+2.5,r.z=Math.random()*2+1,o.position.x=this._length*-r.x}update(r){if(this._car1&&this._car2){const o=this._car1.position;o.set(o.x+r*this._moveParams1.z*this._moveParams1.x,o.y,this._moveParams1.y),Ne.u_simpleCarCenter1.value.copy(o),Math.abs(o.x)>this._length&&this.randomUpdate(this._moveParams1,this._car1);const p=this._car2.position;p.set(p.x+r*this._moveParams2.z*this._moveParams2.x,o.y,-this._moveParams2.y),Ne.u_simpleCarCenter2.value.copy(p),Math.abs(p.x)>this._length&&this.randomUpdate(this._moveParams2,this._car2)}}}const bp=[[.65,1.04,-1.16],[-.35,1.43,-.69],[1.08,.72,-1.01],[1.95,.76,-1],[-1.66,1.34,0],[-1.95,.58,-1],[.35,1.44,-.08],[.26,1.46,-0],[2.53,.45,-.64],[2.73,.43,-.3],[2.78,.43,-0],[-2.3,.67,-.88],[-2.72,.68,0],[-2.69,.62,-.4],[-2.24,.53,-.94],[.65,1.04,1.16],[-.35,1.43,.69],[1.08,.72,1.01],[1.95,.76,1],[-1.95,.58,1],[.35,1.44,.08],[2.53,.45,.64],[2.73,.43,.3],[-2.3,.67,.88],[-2.69,.62,.4],[-2.24,.53,.94],[2.62,.43,.4],[-2.69,.62,-.4]],fE=new Jx,pE=new Yn,Qk=new $a,Kk=new Yn(1,1,1);class qk extends _h{onLoad(){const i=new GP(.1,.1),r=new jB(i,uE,bp.length);for(let o=0;o<bp.length;o++)pE.set(bp[o][0],bp[o][1],bp[o][2]),fE.compose(pE,Qk,Kk),r.setMatrixAt(o,fE);r.instanceMatrix.needsUpdate=!0,this.viewer.scene.add(r),this.controller=new Proxy({visibility:1},{set:(o,p,y)=>(o[p]=y,y>=.005?r.visible=!0:r.visible=!1,uE.uniforms.opacity.value=y,!0)}),this.controller.visibility=0}}class Zk extends xa{constructor(){super(...arguments);B(this,"environment")}start(){console.log(vi.VERSION),this._preload().then(()=>{this._prepareScene(),this._createScene(),this._compileScene()})}async _preload(){const r=new ZB(this.viewer.renderer);return Promise.all([this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_car.glb")}).then(o=>{Ne.sm_car=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_startroom.raw.glb")}).then(o=>{Ne.sm_startroom=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_speedup.glb")}).then(o=>{Ne.sm_speedup=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_size.glb")}).then(o=>{Ne.sm_size=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_curvature.glb")}).then(o=>{Ne.sm_curvature=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_windspeed.glb")}).then(o=>{Ne.sm_windspeed=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_linecar.glb")}).then(o=>{Ne.sm_linecar=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_carradar.glb")}).then(o=>{Ne.sm_carradar=o}),this.viewer.loadAsset({url:vi.autoURL("res/mesh/sm_simplecar.glb")}).then(o=>{Ne.sm_simpleCar=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_saLine.png"),flipY:!1,encoding:bd,wrapS:Rc,wrapT:Rc,anisotropy:4}).then(o=>Ne.ut_saLine.value=o),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_car_body_AO.raw.jpg"),flipY:!1,encoding:bd,minFilter:nE,magFilter:nE}).then(o=>Ne.ut_car_body_ao.value=o),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_startroom_ao.raw.jpg"),flipY:!1,encoding:bd}).then(o=>{Ne.ut_startroom_ao.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_startroom_light.raw.jpg"),flipY:!1,encoding:rk}).then(o=>{Ne.ut_startroom_light.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_floor_normal.webp"),flipY:!1,encoding:bd,wrapS:Rc,wrapT:Rc}).then(o=>{Ne.ut_floor_normal.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_floor_roughness.jpg"),flipY:!1,encoding:bd,wrapS:Rc,wrapT:Rc}).then(o=>{Ne.ut_floor_roughness.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_street.png"),flipY:!1,wrapS:Rc,wrapT:Rc}).then(o=>{Ne.ut_street.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_scar_matcap.png"),flipY:!1}).then(o=>{Ne.ut_scar_matcap.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_cat_car_body_bc.png"),flipY:!1}).then(o=>{Ne.ut_car_body_t_cat.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_gm_car_body_bc.png"),flipY:!1}).then(o=>{Ne.ut_car_body_t_gm.value=o}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_env_night.hdr")}).then(o=>{Ne.ut_env_night.value=r.fromEquirectangular(o).texture}),this.viewer.loadAsset({url:vi.autoURL("res/texture/t_env_light.hdr")}).then(o=>{Ne.ut_env_light.value=r.fromEquirectangular(o).texture})])}_prepareScene(){const r=this.viewer,o=r.addNode(new GB({scene:r.scene,layer:Ne.sceneCaptureLayer,resolution:512}));o.blurIntensity=4.5,this.environment=o,Ne.ut_cubeCapture=o.cubeTexture,Ne.ut_blurCapture=o.blurTexture;const p=new Float32Array(4);p.set([1,1,1,1]);const y=new zB(p,1,1,HP,VB);y.needsUpdate=!0,Ne.ut_white.value=y;let d=Ne.sm_car.meshData;Object.values(d.meshes).forEach(E=>{E.layers.enable(Ne.PlaneReflectLayer)}),Object.values(d.materials).forEach(E=>{E.aoMap=Ne.ut_car_body_ao.value,Ek(E)}),d.materials.Car_body.map=y,d.materials.Car_body.needsUpdate=!0,d=Ne.sm_startroom.meshData,Object.values(d.materials).forEach(E=>{E.aoMap=Ne.ut_startroom_ao.value,E.lightMap=Ne.ut_startroom_light.value,E.normalMap=Ne.ut_floor_normal.value,E.roughnessMap=Ne.ut_floor_roughness.value,E.envMapIntensity=0}),d=Ne.sm_speedup.meshData,d.meshes.forEach(E=>{E.material=Mk,E.layers.enable(Ne.sceneCaptureLayer)}),d=Ne.sm_size.meshData,Object.values(d.materials).forEach(E=>{E.transparent=!0,E.needsUpdate=!0,E.map.anisotropy=4}),d=Ne.sm_curvature.meshData,d.meshes.forEach(E=>{E.name==""&&(E.material=Tk,d.materials.m_curvature=E.material,E.layers.enable(Ne.sceneCaptureLayer))}),Object.values(d.materials).forEach(E=>{E.transparent=!0,E.needsUpdate=!0}),d=Ne.sm_windspeed.meshData,d.meshes.forEach(E=>{E.material=Ck,d.materials.m_windLine=E.material,E.layers.enable(Ne.sceneCaptureLayer)}),d=Ne.sm_linecar.meshData,d.meshes.forEach(E=>{E.material=Pk,d.materials.m_linecar=E.material}),d=Ne.sm_carradar.meshData,d.meshes.forEach(E=>{E.material=Rk,d.materials.m_carradar=E.material,E.layers.enable(Ne.sceneCaptureLayer)}),d=Ne.sm_simpleCar.meshData,d.meshes.forEach(E=>{E.material=l0,d.materials.m_simpleCar=E.material,E.renderOrder=10})}_createScene(){const r=this.viewer;r.scene.background=new bi(0,0,0),r.addNode(yk),Ne.sm_startroom.traverse(re=>{(re.name==="ReflecFloor"||re.name==="Floor")&&Sk(re)});const o=r.addNode(new Fk(Ne.ut_env_night.value,Ne.ut_env_light.value)),p=r.addNode(Ne.sm_startroom),y=r.addNode(new Nk(p)),d=new $B;this.viewer.addComponent(Ne.sm_car,d),d.probeBoxMin.set(-3,-.1,-1.5),d.probeBoxMax.set(3.6,3,1.5);const E=this.viewer.addNode(Ne.sm_car),L=r.addNode(new Uk(E)),k=r.addNode(new jl({springLength:11,rotation:new lo(0,Math.PI*.5,0),fov:33.4,lookAt:new Yn(0,.8,0)})),X=r.addNode(new vk({springCamera:k}));r.addNode(zk);const $=r.addNode(new Gk(E,X));r.addNode(Ne.sm_speedup);const Z=r.addNode(Hk),ge=r.addNode(Vk),be=r.addNode(Wk),ye=r.addNode(jk),$e=r.addNode(qk),ce=r.addNode(Xk),ie=r.addNode(Yk),U=r.addPlugin(new UB({luminanceThreshold:0,luminanceSmoothing:1.6,mipmapBlur:!0}));r.addPlugin(ek),vi.DEBUG&&r.addPlugin(nk),this.eventRegister({envController:o,springCtr:X,carLightController:L,topLightController:y,carSpeedUpdate:$,bloom:U,projectionProbe:d,accessories:{s2_b:Z,s2_c:ge,s3_b:be,s3_c:ye,s4_b:$e,s4_c:ce,s4_cSC:ie}})}_compileScene(){Ak(),this.viewer.compile(),Lt.emit(Lt.PRELOADED)}eventRegister(r){const o=r.envController,p=r.springCtr,y=r.carLightController,d=r.topLightController,E=r.carSpeedUpdate,L=r.bloom,k=r.projectionProbe,X=r.accessories,$=(Z=1,ge=1,be=1,ye=1,$e=1.8)=>{Zt.TweenManager.KillTweensOf(k),Zt.TweenManager.Timeline(k).to({probeCenter:new Yn(0,0,0),probeBoxMax:new Yn(3.6,3,1.5)},1,{easing:Zt.Easing.Cubic.InOut,onUpdate:()=>{k.probeCenter=k.probeCenter}}).start(),Zt.TweenManager.KillTweensOf(Ne.u_floorLightMapIntensity),Zt.TweenManager.Timeline(Ne.u_floorLightMapIntensity).to({value:Z},1).start(),Zt.TweenManager.KillTweensOf(Ne.u_car_envMapIntensity),Zt.TweenManager.Timeline(Ne.u_car_envMapIntensity).to({value:ge},1.5,{easing:Zt.Easing.Cubic.InOut}).start(),Zt.TweenManager.KillTweensOf(this.environment),Zt.TweenManager.Tween(this.environment).to({exposure:be},1).start(),Zt.TweenManager.KillTweensOf(d),Zt.TweenManager.Timeline(d).to({opacity:ye},.5,{}).start(),Zt.TweenManager.KillTweensOf(L),Zt.TweenManager.Timeline(L).to({luminanceSmoothing:$e},2,{}).start()};Lt.on(Lt.UPDATESHOWINGSTATE,Z=>{const ge=Ne.u_floorLightMapColor.value.clone(),be=new bi("#000000"),ye=new bi("#C9D573"),$e=new bi("#ffffff"),ce=new bi;switch(Object.values(X).forEach(ie=>ie.hide()),E.targetVelocity=0,p.setNewRange(),Z){case Tn.BeginAnim:Zt.TweenManager.KillTweensOf(o),Zt.TweenManager.Timeline(o).delay(1.5).call(()=>{o.setState($x.night,2.5,Zt.Easing.Cubic.In),p.gotoPOI(new Yn(0,.8,0),7,new lo(0,Math.PI*.5,0),4).then(()=>{Lt.emit(Lt.UPDATESHOWINGSTATE,Tn.State1),p.enableControlCamera=!0})}).delay(2.5).call(()=>{o.setState($x.light,4,Zt.Easing.Cubic.Out)}).start(),Zt.TweenManager.KillTweensOf(d),Zt.TweenManager.Timeline(d).delay(1.5).to({},2.5,{onUpdate:(ie,U)=>{ce.copy(be).lerp(ye,U),d.lightEmissiveColor=ce,d.lightEmissiveIntensity=U*.4}}).to({},2,{onUpdate:(ie,U)=>{ce.copy(ye).lerpHSL($e,U),d.lightEmissiveColor=ce,d.lightEmissiveIntensity=U*2.3+.4}}).start(),Zt.TweenManager.KillTweensOf(y),Zt.TweenManager.Timeline(y).delay(1).to({lightValue:1},1,{easing:Zt.Easing.Cubic.In}).start(),Zt.TweenManager.KillTweensOf(Ne.u_floorLightMapIntensity),Zt.TweenManager.Timeline(Ne.u_floorLightMapIntensity).delay(1.5).to({value:.1},2.5,{easing:Zt.Easing.Cubic.In,onUpdate:(ie,U)=>{ce.copy(ge).lerpHSL(ye,U),Ne.u_floorLightMapColor.value.copy(ce)}}).to({value:1},2,{easing:Zt.Easing.Linear.None,onUpdate:(ie,U)=>{ce.copy(ye).lerpHSL($e,U),Ne.u_floorLightMapColor.value.copy(ce)}}).start(),Zt.TweenManager.KillTweensOf(Ne.u_floorReflectIntensity),Zt.TweenManager.Timeline(Ne.u_floorReflectIntensity).delay(1.8).to({value:.1},1.5,{easing:Zt.Easing.Cubic.In}).to({value:1},1.5,{easing:Zt.Easing.Linear.None}).start();break;case Tn.State1:p.setNewTarget(new Yn(0,.8,0),7,new lo(0,Math.PI*.5,0)),$();break;case Tn.State2:p.setNewTarget(new Yn(0,.8,0),7,new lo(0,-.89,.1)),X.s2_b.show(),$();break;case Tn.State3:p.setNewTarget(new Yn(.3,.8,0),7,new lo(0,.65,.1)),X.s3_b.show(),$(0,0,10,0,.5),Zt.TweenManager.KillTweensOf(k),Zt.TweenManager.Timeline(k).to({probeCenter:new Yn(0,.5,0),probeBoxMax:new Yn(3.6,1.6,1.5)},1,{easing:Zt.Easing.Cubic.InOut,onUpdate:()=>{k.probeCenter=k.probeCenter}}).start();break;case Tn.State4:p.setNewTarget(new Yn(.3,.8,0),14,new lo(0,Math.PI,1.2)),p.setNewRange([.2,1.3]),$(.2,1,3,0,1.5),X.s4_b.show(),Zt.TweenManager.KillTweensOf(k),Zt.TweenManager.Timeline(k).to({probeBoxMax:new Yn(3.6,1.6,1.5)},1,{easing:Zt.Easing.Cubic.InOut,onUpdate:()=>{k.probeCenter=k.probeCenter}}).start();break}}),Lt.on(Lt.CLICKEFFECT,Z=>{switch(Object.entries(X).map(([ge,be])=>{be.hide()}),Lt.currentShowingState){case Tn.State1:Z?(E.targetVelocity=8,E.lerpStrength=.5,p.targetFov=60,p.springlengthOffset=-3,p.lerpStrength=.5,$(0,.1,1,0,0)):(E.targetVelocity=0,E.lerpStrength=1.5,p.targetFov=33.4,p.lerpStrength=1.5,p.springlengthOffset=0,$());break;case Tn.State2:Z?(X.s2_c.show(),p.targetFov=45,p.lerpStrength=.5):(X.s2_b.show(),p.targetFov=33.4,p.lerpStrength=.5);break;case Tn.State3:Z?(X.s3_c.show(1,.2),p.targetFov=60,p.springlengthOffset=-3,p.lerpStrength=1.5):(X.s3_b.show(),p.targetFov=33.4,p.springlengthOffset=0,p.lerpStrength=1.5);break;case Tn.State4:Z?(E.targetVelocity=16,E.lerpStrength=.5,X.s4_c.show(),X.s4_cSC.show(),p.targetFov=25,p.lerpStrength=1.5,p.springlengthOffset=20,p.moveSpeed=[.1,.1],$(.2,.3,3,0,1.5)):(E.targetVelocity=0,E.lerpStrength=1.5,p.targetFov=33.4,p.lerpStrength=1.5,p.springlengthOffset=0,p.moveSpeed=[1,1],X.s4_b.show(),$(.2,1,3,0,1.5));break}}),Lt.on(Lt.CHANGECOLOR,(Z,ge)=>{const be=Ne.sm_car.meshData.materials.Car_body.color.clone(),ye=new bi,$e=new bi(1,1,1),ce=new bi(0,0,0);be.equals($e)&&be.copy(ce),ge?Ne.sm_car.meshData.materials.Car_body.map=ge.value:Ne.sm_car.meshData.materials.Car_body.map=Ne.ut_white.value,Zt.TweenManager.KillTweensOf(Ne.sm_car.meshData.materials.Car_body),Zt.TweenManager.Timeline(Ne.sm_car.meshData.materials.Car_body).to({},.2,{easing:Zt.Easing.Linear.None,onUpdate:(ie,U)=>{ye.copy(be).lerp(Z,U),Ne.sm_car.meshData.materials.Car_body.color.copy(ye)}}).start()})}update(r){Ne.u_speedTime.value+=r*Ne.u_speedUpBackgroundValue.value*.2,Ne.u_time.value+=r}}function Jk(){const t=pt.useRef(null);return pt.useEffect(()=>{const i=new ik({root:document.getElementById("root"),canvas:t.current,orientation:qB.LANDSCAPE,antialias:!0,toneMapping:BB,loader:{onProgress:(r,o,p)=>Lt.loading=Math.max(Lt.loading,o/p),onLoad:()=>Lt.loading=1}});return i.addNode(Zk),()=>{i.destroy()}},[]),Xe.jsxs("aside",{className:"webgl-wrapper",children:[Xe.jsx("canvas",{ref:t,className:"webgl-canvas",children:"No Canvas!"}),Xe.jsx("div",{id:"css-container"})]})}const dw=pt.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),c0=pt.createContext({}),u0=pt.createContext(null),fw=typeof document<"u",pw=fw?pt.useLayoutEffect:pt.useEffect,XP=pt.createContext({strict:!1}),mw=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$k="framerAppearId",YP="data-"+mw($k),e3={skipAnimations:!1,useManualTiming:!1};class mE{constructor(){this.order=[],this.scheduled=new Set}add(i){if(!this.scheduled.has(i))return this.scheduled.add(i),this.order.push(i),!0}remove(i){const r=this.order.indexOf(i);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(i))}clear(){this.order.length=0,this.scheduled.clear()}}function t3(t){let i=new mE,r=new mE,o=0,p=!1,y=!1;const d=new WeakSet,E={schedule:(L,k=!1,X=!1)=>{const $=X&&p,Z=$?i:r;return k&&d.add(L),Z.add(L)&&$&&p&&(o=i.order.length),L},cancel:L=>{r.remove(L),d.delete(L)},process:L=>{if(p){y=!0;return}if(p=!0,[i,r]=[r,i],r.clear(),o=i.order.length,o)for(let k=0;k<o;k++){const X=i.order[k];d.has(X)&&(E.schedule(X),t()),X(L)}p=!1,y&&(y=!1,E.process(L))}};return E}const Kg=["read","resolveKeyframes","update","preRender","render","postRender"],n3=40;function QP(t,i){let r=!1,o=!0;const p={delta:0,timestamp:0,isProcessing:!1},y=Kg.reduce(($,Z)=>($[Z]=t3(()=>r=!0),$),{}),d=$=>{y[$].process(p)},E=()=>{const $=performance.now();r=!1,p.delta=o?1e3/60:Math.max(Math.min($-p.timestamp,n3),1),p.timestamp=$,p.isProcessing=!0,Kg.forEach(d),p.isProcessing=!1,r&&i&&(o=!1,t(E))},L=()=>{r=!0,o=!0,p.isProcessing||t(E)};return{schedule:Kg.reduce(($,Z)=>{const ge=y[Z];return $[Z]=(be,ye=!1,$e=!1)=>(r||L(),ge.schedule(be,ye,$e)),$},{}),cancel:$=>Kg.forEach(Z=>y[Z].cancel($)),state:p,steps:y}}const{schedule:gw,cancel:R4}=QP(queueMicrotask,!1);function i3(t,i,r,o){const{visualElement:p}=pt.useContext(c0),y=pt.useContext(XP),d=pt.useContext(u0),E=pt.useContext(dw).reducedMotion,L=pt.useRef();o=o||y.renderer,!L.current&&o&&(L.current=o(t,{visualState:i,parent:p,props:r,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:E}));const k=L.current;pt.useInsertionEffect(()=>{k&&k.update(r,d)});const X=pt.useRef(!!(r[YP]&&!window.HandoffComplete));return pw(()=>{k&&(gw.postRender(k.render),X.current&&k.animationState&&k.animationState.animateChanges())}),pt.useEffect(()=>{k&&(k.updateFeatures(),!X.current&&k.animationState&&k.animationState.animateChanges(),X.current&&(X.current=!1,window.HandoffComplete=!0))}),k}function Od(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function r3(t,i,r){return pt.useCallback(o=>{o&&t.mount&&t.mount(o),i&&(o?i.mount(o):i.unmount()),r&&(typeof r=="function"?r(o):Od(r)&&(r.current=o))},[i])}function om(t){return typeof t=="string"||Array.isArray(t)}function h0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const vw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yw=["initial",...vw];function d0(t){return h0(t.animate)||yw.some(i=>om(t[i]))}function KP(t){return!!(d0(t)||t.variants)}function s3(t,i){if(d0(t)){const{initial:r,animate:o}=t;return{initial:r===!1||om(r)?r:void 0,animate:om(o)?o:void 0}}return t.inherit!==!1?i:{}}function o3(t){const{initial:i,animate:r}=s3(t,pt.useContext(c0));return pt.useMemo(()=>({initial:i,animate:r}),[gE(i),gE(r)])}function gE(t){return Array.isArray(t)?t.join(" "):t}const vE={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},am={};for(const t in vE)am[t]={isEnabled:i=>vE[t].some(r=>!!i[r])};function a3(t){for(const i in t)am[i]={...am[i],...t[i]}}const _w=pt.createContext({}),qP=pt.createContext({}),l3=Symbol.for("motionComponentSymbol");function c3({preloadedFeatures:t,createVisualElement:i,useRender:r,useVisualState:o,Component:p}){t&&a3(t);function y(E,L){let k;const X={...pt.useContext(dw),...E,layoutId:u3(E)},{isStatic:$}=X,Z=o3(E),ge=o(E,$);if(!$&&fw){Z.visualElement=i3(p,ge,X,i);const be=pt.useContext(qP),ye=pt.useContext(XP).strict;Z.visualElement&&(k=Z.visualElement.loadFeatures(X,ye,t,be))}return pt.createElement(c0.Provider,{value:Z},k&&Z.visualElement?pt.createElement(k,{visualElement:Z.visualElement,...X}):null,r(p,E,r3(ge,Z.visualElement,L),ge,$,Z.visualElement))}const d=pt.forwardRef(y);return d[l3]=p,d}function u3({layoutId:t}){const i=pt.useContext(_w).id;return i&&t!==void 0?i+"-"+t:t}function h3(t){function i(o,p={}){return c3(t(o,p))}if(typeof Proxy>"u")return i;const r=new Map;return new Proxy(i,{get:(o,p)=>(r.has(p)||r.set(p,i(p)),r.get(p))})}const d3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xw(t){return typeof t!="string"||t.includes("-")?!1:!!(d3.indexOf(t)>-1||/[A-Z]/u.test(t))}const kv={};function f3(t){Object.assign(kv,t)}const vm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xh=new Set(vm);function ZP(t,{layout:i,layoutId:r}){return xh.has(t)||t.startsWith("origin")||(i||r!==void 0)&&(!!kv[t]||t==="opacity")}const fs=t=>!!(t&&t.getVelocity),p3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},m3=vm.length;function g3(t,{enableHardwareAcceleration:i=!0,allowTransformNone:r=!0},o,p){let y="";for(let d=0;d<m3;d++){const E=vm[d];if(t[E]!==void 0){const L=p3[E]||E;y+=`${L}(${t[E]}) `}}return i&&!t.z&&(y+="translateZ(0)"),y=y.trim(),p?y=p(t,o?"":y):r&&o&&(y="none"),y}const JP=t=>i=>typeof i=="string"&&i.startsWith(t),$P=JP("--"),v3=JP("var(--"),bw=t=>v3(t)?y3.test(t.split("/*")[0].trim()):!1,y3=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,_3=(t,i)=>i&&typeof t=="number"?i.transform(t):t,qc=(t,i,r)=>r>i?i:r<t?t:r,tf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},kp={...tf,transform:t=>qc(0,1,t)},qg={...tf,default:1},Up=t=>Math.round(t*1e5)/1e5,ww=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,x3=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,b3=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function ym(t){return typeof t=="string"}const _m=t=>({test:i=>ym(i)&&i.endsWith(t)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${t}`}),Dc=_m("deg"),el=_m("%"),mn=_m("px"),w3=_m("vh"),A3=_m("vw"),yE={...el,parse:t=>el.parse(t)/100,transform:t=>el.transform(t*100)},_E={...tf,transform:Math.round},eR={borderWidth:mn,borderTopWidth:mn,borderRightWidth:mn,borderBottomWidth:mn,borderLeftWidth:mn,borderRadius:mn,radius:mn,borderTopLeftRadius:mn,borderTopRightRadius:mn,borderBottomRightRadius:mn,borderBottomLeftRadius:mn,width:mn,maxWidth:mn,height:mn,maxHeight:mn,size:mn,top:mn,right:mn,bottom:mn,left:mn,padding:mn,paddingTop:mn,paddingRight:mn,paddingBottom:mn,paddingLeft:mn,margin:mn,marginTop:mn,marginRight:mn,marginBottom:mn,marginLeft:mn,rotate:Dc,rotateX:Dc,rotateY:Dc,rotateZ:Dc,scale:qg,scaleX:qg,scaleY:qg,scaleZ:qg,skew:Dc,skewX:Dc,skewY:Dc,distance:mn,translateX:mn,translateY:mn,translateZ:mn,x:mn,y:mn,z:mn,perspective:mn,transformPerspective:mn,opacity:kp,originX:yE,originY:yE,originZ:mn,zIndex:_E,backgroundPositionX:mn,backgroundPositionY:mn,fillOpacity:kp,strokeOpacity:kp,numOctaves:_E};function Aw(t,i,r,o){const{style:p,vars:y,transform:d,transformOrigin:E}=t;let L=!1,k=!1,X=!0;for(const $ in i){const Z=i[$];if($P($)){y[$]=Z;continue}const ge=eR[$],be=_3(Z,ge);if(xh.has($)){if(L=!0,d[$]=be,!X)continue;Z!==(ge.default||0)&&(X=!1)}else $.startsWith("origin")?(k=!0,E[$]=be):p[$]=be}if(i.transform||(L||o?p.transform=g3(t.transform,r,X,o):p.transform&&(p.transform="none")),k){const{originX:$="50%",originY:Z="50%",originZ:ge=0}=E;p.transformOrigin=`${$} ${Z} ${ge}`}}const Sw=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function tR(t,i,r){for(const o in i)!fs(i[o])&&!ZP(o,r)&&(t[o]=i[o])}function S3({transformTemplate:t},i,r){return pt.useMemo(()=>{const o=Sw();return Aw(o,i,{enableHardwareAcceleration:!r},t),Object.assign({},o.vars,o.style)},[i])}function M3(t,i,r){const o=t.style||{},p={};return tR(p,o,t),Object.assign(p,S3(t,i,r)),p}function E3(t,i,r){const o={},p=M3(t,i,r);return t.drag&&t.dragListener!==!1&&(o.draggable=!1,p.userSelect=p.WebkitUserSelect=p.WebkitTouchCallout="none",p.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(o.tabIndex=0),o.style=p,o}const T3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Uv(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||T3.has(t)}let nR=t=>!Uv(t);function C3(t){t&&(nR=i=>i.startsWith("on")?!Uv(i):t(i))}try{C3(require("@emotion/is-prop-valid").default)}catch{}function P3(t,i,r){const o={};for(const p in t)p==="values"&&typeof t.values=="object"||(nR(p)||r===!0&&Uv(p)||!i&&!Uv(p)||t.draggable&&p.startsWith("onDrag"))&&(o[p]=t[p]);return o}function xE(t,i,r){return typeof t=="string"?t:mn.transform(i+r*t)}function R3(t,i,r){const o=xE(i,t.x,t.width),p=xE(r,t.y,t.height);return`${o} ${p}`}const D3={offset:"stroke-dashoffset",array:"stroke-dasharray"},I3={offset:"strokeDashoffset",array:"strokeDasharray"};function L3(t,i,r=1,o=0,p=!0){t.pathLength=1;const y=p?D3:I3;t[y.offset]=mn.transform(-o);const d=mn.transform(i),E=mn.transform(r);t[y.array]=`${d} ${E}`}function Mw(t,{attrX:i,attrY:r,attrScale:o,originX:p,originY:y,pathLength:d,pathSpacing:E=1,pathOffset:L=0,...k},X,$,Z){if(Aw(t,k,X,Z),$){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:ge,style:be,dimensions:ye}=t;ge.transform&&(ye&&(be.transform=ge.transform),delete ge.transform),ye&&(p!==void 0||y!==void 0||be.transform)&&(be.transformOrigin=R3(ye,p!==void 0?p:.5,y!==void 0?y:.5)),i!==void 0&&(ge.x=i),r!==void 0&&(ge.y=r),o!==void 0&&(ge.scale=o),d!==void 0&&L3(ge,d,E,L,!1)}const iR=()=>({...Sw(),attrs:{}}),Ew=t=>typeof t=="string"&&t.toLowerCase()==="svg";function O3(t,i,r,o){const p=pt.useMemo(()=>{const y=iR();return Mw(y,i,{enableHardwareAcceleration:!1},Ew(o),t.transformTemplate),{...y.attrs,style:{...y.style}}},[i]);if(t.style){const y={};tR(y,t.style,t),p.style={...y,...p.style}}return p}function F3(t=!1){return(r,o,p,{latestValues:y},d)=>{const L=(xw(r)?O3:E3)(o,y,d,r),k=P3(o,typeof r=="string",t),X=r!==pt.Fragment?{...k,...L,ref:p}:{},{children:$}=o,Z=pt.useMemo(()=>fs($)?$.get():$,[$]);return pt.createElement(r,{...X,children:Z})}}function rR(t,{style:i,vars:r},o,p){Object.assign(t.style,i,p&&p.getProjectionStyles(o));for(const y in r)t.style.setProperty(y,r[y])}const sR=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function oR(t,i,r,o){rR(t,i,void 0,o);for(const p in i.attrs)t.setAttribute(sR.has(p)?p:mw(p),i.attrs[p])}function Tw(t,i){const{style:r}=t,o={};for(const p in r)(fs(r[p])||i.style&&fs(i.style[p])||ZP(p,t))&&(o[p]=r[p]);return o}function aR(t,i){const r=Tw(t,i);for(const o in t)if(fs(t[o])||fs(i[o])){const p=vm.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[p]=t[o]}return r}function Cw(t,i,r,o={},p={}){return typeof i=="function"&&(i=i(r!==void 0?r:t.custom,o,p)),typeof i=="string"&&(i=t.variants&&t.variants[i]),typeof i=="function"&&(i=i(r!==void 0?r:t.custom,o,p)),i}function lR(t){const i=pt.useRef(null);return i.current===null&&(i.current=t()),i.current}const eb=t=>Array.isArray(t),B3=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),k3=t=>eb(t)?t[t.length-1]||0:t;function uv(t){const i=fs(t)?t.get():t;return B3(i)?i.toValue():i}function U3({scrapeMotionValuesFromProps:t,createRenderState:i,onMount:r},o,p,y){const d={latestValues:N3(o,p,y,t),renderState:i()};return r&&(d.mount=E=>r(o,E,d)),d}const cR=t=>(i,r)=>{const o=pt.useContext(c0),p=pt.useContext(u0),y=()=>U3(t,i,o,p);return r?y():lR(y)};function N3(t,i,r,o){const p={},y=o(t,{});for(const Z in y)p[Z]=uv(y[Z]);let{initial:d,animate:E}=t;const L=d0(t),k=KP(t);i&&k&&!L&&t.inherit!==!1&&(d===void 0&&(d=i.initial),E===void 0&&(E=i.animate));let X=r?r.initial===!1:!1;X=X||d===!1;const $=X?E:d;return $&&typeof $!="boolean"&&!h0($)&&(Array.isArray($)?$:[$]).forEach(ge=>{const be=Cw(t,ge);if(!be)return;const{transitionEnd:ye,transition:$e,...ce}=be;for(const ie in ce){let U=ce[ie];if(Array.isArray(U)){const re=X?U.length-1:0;U=U[re]}U!==null&&(p[ie]=U)}for(const ie in ye)p[ie]=ye[ie]}),p}const Zr=t=>t,{schedule:Nr,cancel:Zc,state:Kr,steps:X_}=QP(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zr,!0),z3={useVisualState:cR({scrapeMotionValuesFromProps:aR,createRenderState:iR,onMount:(t,i,{renderState:r,latestValues:o})=>{Nr.read(()=>{try{r.dimensions=typeof i.getBBox=="function"?i.getBBox():i.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Nr.render(()=>{Mw(r,o,{enableHardwareAcceleration:!1},Ew(i.tagName),t.transformTemplate),oR(i,r)})}})},G3={useVisualState:cR({scrapeMotionValuesFromProps:Tw,createRenderState:Sw})};function H3(t,{forwardMotionProps:i=!1},r,o){return{...xw(t)?z3:G3,preloadedFeatures:r,useRender:F3(i),createVisualElement:o,Component:t}}function Ll(t,i,r,o={passive:!0}){return t.addEventListener(i,r,o),()=>t.removeEventListener(i,r)}const uR=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function f0(t,i="page"){return{point:{x:t[i+"X"],y:t[i+"Y"]}}}const V3=t=>i=>uR(i)&&t(i,f0(i));function Bl(t,i,r,o){return Ll(t,i,V3(r),o)}const W3=(t,i)=>r=>i(t(r)),kl=(...t)=>t.reduce(W3);function hR(t){let i=null;return()=>{const r=()=>{i=null};return i===null?(i=t,r):!1}}const bE=hR("dragHorizontal"),wE=hR("dragVertical");function dR(t){let i=!1;if(t==="y")i=wE();else if(t==="x")i=bE();else{const r=bE(),o=wE();r&&o?i=()=>{r(),o()}:(r&&r(),o&&o())}return i}function fR(){const t=dR(!0);return t?(t(),!1):!0}class iu{constructor(i){this.isMounted=!1,this.node=i}update(){}}function AE(t,i){const r="pointer"+(i?"enter":"leave"),o="onHover"+(i?"Start":"End"),p=(y,d)=>{if(y.pointerType==="touch"||fR())return;const E=t.getProps();t.animationState&&E.whileHover&&t.animationState.setActive("whileHover",i),E[o]&&E[o](y,d)};return Bl(t.current,r,p,{passive:!t.getProps()[o]})}class j3 extends iu{mount(){this.unmount=kl(AE(this.node,!0),AE(this.node,!1))}unmount(){}}class X3 extends iu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=kl(Ll(this.node.current,"focus",()=>this.onFocus()),Ll(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const pR=(t,i)=>i?t===i?!0:pR(t,i.parentElement):!1;function Y_(t,i){if(!i)return;const r=new PointerEvent("pointer"+t);i(r,f0(r))}class Y3 extends iu{constructor(){super(...arguments),this.removeStartListeners=Zr,this.removeEndListeners=Zr,this.removeAccessibleListeners=Zr,this.startPointerPress=(i,r)=>{if(this.isPressing)return;this.removeEndListeners();const o=this.node.getProps(),y=Bl(window,"pointerup",(E,L)=>{if(!this.checkPressEnd())return;const{onTap:k,onTapCancel:X,globalTapTarget:$}=this.node.getProps();!$&&!pR(this.node.current,E.target)?X&&X(E,L):k&&k(E,L)},{passive:!(o.onTap||o.onPointerUp)}),d=Bl(window,"pointercancel",(E,L)=>this.cancelPress(E,L),{passive:!(o.onTapCancel||o.onPointerCancel)});this.removeEndListeners=kl(y,d),this.startPress(i,r)},this.startAccessiblePress=()=>{const i=y=>{if(y.key!=="Enter"||this.isPressing)return;const d=E=>{E.key!=="Enter"||!this.checkPressEnd()||Y_("up",(L,k)=>{const{onTap:X}=this.node.getProps();X&&X(L,k)})};this.removeEndListeners(),this.removeEndListeners=Ll(this.node.current,"keyup",d),Y_("down",(E,L)=>{this.startPress(E,L)})},r=Ll(this.node.current,"keydown",i),o=()=>{this.isPressing&&Y_("cancel",(y,d)=>this.cancelPress(y,d))},p=Ll(this.node.current,"blur",o);this.removeAccessibleListeners=kl(r,p)}}startPress(i,r){this.isPressing=!0;const{onTapStart:o,whileTap:p}=this.node.getProps();p&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),o&&o(i,r)}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!fR()}cancelPress(i,r){if(!this.checkPressEnd())return;const{onTapCancel:o}=this.node.getProps();o&&o(i,r)}mount(){const i=this.node.getProps(),r=Bl(i.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(i.onTapStart||i.onPointerStart)}),o=Ll(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=kl(r,o)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const tb=new WeakMap,Q_=new WeakMap,Q3=t=>{const i=tb.get(t.target);i&&i(t)},K3=t=>{t.forEach(Q3)};function q3({root:t,...i}){const r=t||document;Q_.has(r)||Q_.set(r,{});const o=Q_.get(r),p=JSON.stringify(i);return o[p]||(o[p]=new IntersectionObserver(K3,{root:t,...i})),o[p]}function Z3(t,i,r){const o=q3(i);return tb.set(t,r),o.observe(t),()=>{tb.delete(t),o.unobserve(t)}}const J3={some:0,all:1};class $3 extends iu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:r,margin:o,amount:p="some",once:y}=i,d={root:r?r.current:void 0,rootMargin:o,threshold:typeof p=="number"?p:J3[p]},E=L=>{const{isIntersecting:k}=L;if(this.isInView===k||(this.isInView=k,y&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:X,onViewportLeave:$}=this.node.getProps(),Z=k?X:$;Z&&Z(L)};return Z3(this.node.current,d,E)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:r}=this.node;["amount","margin","root"].some(eU(i,r))&&this.startObserver()}unmount(){}}function eU({viewport:t={}},{viewport:i={}}={}){return r=>t[r]!==i[r]}const tU={inView:{Feature:$3},tap:{Feature:Y3},focus:{Feature:X3},hover:{Feature:j3}};function mR(t,i){if(!Array.isArray(i))return!1;const r=i.length;if(r!==t.length)return!1;for(let o=0;o<r;o++)if(i[o]!==t[o])return!1;return!0}function nU(t){const i={};return t.values.forEach((r,o)=>i[o]=r.get()),i}function iU(t){const i={};return t.values.forEach((r,o)=>i[o]=r.getVelocity()),i}function p0(t,i,r){const o=t.getProps();return Cw(o,i,r!==void 0?r:o.custom,nU(t),iU(t))}const Ul=t=>t*1e3,Nl=t=>t/1e3,rU={type:"spring",stiffness:500,damping:25,restSpeed:10},sU=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),oU={type:"keyframes",duration:.8},aU={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lU=(t,{keyframes:i})=>i.length>2?oU:xh.has(t)?t.startsWith("scale")?sU(i[1]):rU:aU;function cU({when:t,delay:i,delayChildren:r,staggerChildren:o,staggerDirection:p,repeat:y,repeatType:d,repeatDelay:E,from:L,elapsed:k,...X}){return!!Object.keys(X).length}function Pw(t,i){return t[i]||t.default||t}const uU=t=>t!==null;function m0(t,{repeat:i,repeatType:r="loop"},o){const p=t.filter(uU),y=i&&r!=="loop"&&i%2===1?0:p.length-1;return!y||o===void 0?p[y]:o}let hv;function hU(){hv=void 0}const Yc={now:()=>(hv===void 0&&Yc.set(Kr.isProcessing||e3.useManualTiming?Kr.timestamp:performance.now()),hv),set:t=>{hv=t,queueMicrotask(hU)}},gR=t=>/^0[^.\s]+$/u.test(t);function dU(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||gR(t):!0}let fU=Zr,vR=Zr;const yR=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),pU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function mU(t){const i=pU.exec(t);if(!i)return[,];const[,r,o,p]=i;return[`--${r??o}`,p]}function _R(t,i,r=1){const[o,p]=mU(t);if(!o)return;const y=window.getComputedStyle(i).getPropertyValue(o);if(y){const d=y.trim();return yR(d)?parseFloat(d):d}return bw(p)?_R(p,i,r+1):p}const gU=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),SE=t=>t===tf||t===mn,ME=(t,i)=>parseFloat(t.split(", ")[i]),EE=(t,i)=>(r,{transform:o})=>{if(o==="none"||!o)return 0;const p=o.match(/^matrix3d\((.+)\)$/u);if(p)return ME(p[1],i);{const y=o.match(/^matrix\((.+)\)$/u);return y?ME(y[1],t):0}},vU=new Set(["x","y","z"]),yU=vm.filter(t=>!vU.has(t));function TE(t){const i=[];return yU.forEach(r=>{const o=t.getValue(r);o!==void 0&&(i.push([r,o.get()]),o.set(r.startsWith("scale")?1:0))}),i}const Zd={width:({x:t},{paddingLeft:i="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(i)-parseFloat(r),height:({y:t},{paddingTop:i="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(i)-parseFloat(r),top:(t,{top:i})=>parseFloat(i),left:(t,{left:i})=>parseFloat(i),bottom:({y:t},{top:i})=>parseFloat(i)+(t.max-t.min),right:({x:t},{left:i})=>parseFloat(i)+(t.max-t.min),x:EE(4,13),y:EE(5,14)};Zd.translateX=Zd.x;Zd.translateY=Zd.y;const xR=t=>i=>i.test(t),_U={test:t=>t==="auto",parse:t=>t},bR=[tf,mn,el,Dc,A3,w3,_U],CE=t=>bR.find(xR(t)),hh=new Set;let nb=!1,ib=!1;function wR(){if(ib){const t=Array.from(hh).filter(o=>o.needsMeasurement),i=new Set(t.map(o=>o.element)),r=new Map;i.forEach(o=>{TE(o).length&&(r.set(o,TE(o)),o.render())}),t.forEach(o=>o.measureInitialState()),i.forEach(o=>{o.render()}),t.forEach(o=>o.measureEndState()),t.forEach(o=>{o.suspendedScrollY!==void 0&&window.scrollTo(0,o.suspendedScrollY)})}ib=!1,nb=!1,hh.forEach(t=>t.complete()),hh.clear()}function AR(){hh.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(ib=!0)})}function xU(){AR(),wR()}class Rw{constructor(i,r,o,p,y,d=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...i],this.onComplete=r,this.name=o,this.motionValue=p,this.element=y,this.isAsync=d}scheduleResolve(){this.isScheduled=!0,this.isAsync?(hh.add(this),nb||(nb=!0,Nr.read(AR),Nr.resolveKeyframes(wR))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:i,name:r,element:o,motionValue:p}=this;for(let y=0;y<i.length;y++)if(i[y]===null)if(y===0){const d=p==null?void 0:p.get(),E=i[i.length-1];if(d!==void 0)i[0]=d;else if(o&&r){const L=o.readValue(r,E);L!=null&&(i[0]=L)}i[0]===void 0&&(i[0]=E),p&&d===void 0&&p.set(i[0])}else i[y]=i[y-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),hh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,hh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Dw=(t,i)=>r=>!!(ym(r)&&b3.test(r)&&r.startsWith(t)||i&&Object.prototype.hasOwnProperty.call(r,i)),SR=(t,i,r)=>o=>{if(!ym(o))return o;const[p,y,d,E]=o.match(ww);return{[t]:parseFloat(p),[i]:parseFloat(y),[r]:parseFloat(d),alpha:E!==void 0?parseFloat(E):1}},bU=t=>qc(0,255,t),K_={...tf,transform:t=>Math.round(bU(t))},lh={test:Dw("rgb","red"),parse:SR("red","green","blue"),transform:({red:t,green:i,blue:r,alpha:o=1})=>"rgba("+K_.transform(t)+", "+K_.transform(i)+", "+K_.transform(r)+", "+Up(kp.transform(o))+")"};function wU(t){let i="",r="",o="",p="";return t.length>5?(i=t.substring(1,3),r=t.substring(3,5),o=t.substring(5,7),p=t.substring(7,9)):(i=t.substring(1,2),r=t.substring(2,3),o=t.substring(3,4),p=t.substring(4,5),i+=i,r+=r,o+=o,p+=p),{red:parseInt(i,16),green:parseInt(r,16),blue:parseInt(o,16),alpha:p?parseInt(p,16)/255:1}}const rb={test:Dw("#"),parse:wU,transform:lh.transform},Fd={test:Dw("hsl","hue"),parse:SR("hue","saturation","lightness"),transform:({hue:t,saturation:i,lightness:r,alpha:o=1})=>"hsla("+Math.round(t)+", "+el.transform(Up(i))+", "+el.transform(Up(r))+", "+Up(kp.transform(o))+")"},hs={test:t=>lh.test(t)||rb.test(t)||Fd.test(t),parse:t=>lh.test(t)?lh.parse(t):Fd.test(t)?Fd.parse(t):rb.parse(t),transform:t=>ym(t)?t:t.hasOwnProperty("red")?lh.transform(t):Fd.transform(t)};function AU(t){var i,r;return isNaN(t)&&ym(t)&&(((i=t.match(ww))===null||i===void 0?void 0:i.length)||0)+(((r=t.match(x3))===null||r===void 0?void 0:r.length)||0)>0}const MR="number",ER="color",SU="var",MU="var(",PE="${}",EU=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Nv(t){const i=t.toString(),r=[],o={color:[],number:[],var:[]},p=[];let y=0;const E=i.replace(EU,L=>(hs.test(L)?(o.color.push(y),p.push(ER),r.push(hs.parse(L))):L.startsWith(MU)?(o.var.push(y),p.push(SU),r.push(L)):(o.number.push(y),p.push(MR),r.push(parseFloat(L))),++y,PE)).split(PE);return{values:r,split:E,indexes:o,types:p}}function TR(t){return Nv(t).values}function CR(t){const{split:i,types:r}=Nv(t),o=i.length;return p=>{let y="";for(let d=0;d<o;d++)if(y+=i[d],p[d]!==void 0){const E=r[d];E===MR?y+=Up(p[d]):E===ER?y+=hs.transform(p[d]):y+=p[d]}return y}}const TU=t=>typeof t=="number"?0:t;function CU(t){const i=TR(t);return CR(t)(i.map(TU))}const Jc={test:AU,parse:TR,createTransformer:CR,getAnimatableNone:CU},PU=new Set(["brightness","contrast","saturate","opacity"]);function RU(t){const[i,r]=t.slice(0,-1).split("(");if(i==="drop-shadow")return t;const[o]=r.match(ww)||[];if(!o)return t;const p=r.replace(o,"");let y=PU.has(i)?1:0;return o!==r&&(y*=100),i+"("+y+p+")"}const DU=/\b([a-z-]*)\(.*?\)/gu,sb={...Jc,getAnimatableNone:t=>{const i=t.match(DU);return i?i.map(RU).join(" "):t}},IU={...eR,color:hs,backgroundColor:hs,outlineColor:hs,fill:hs,stroke:hs,borderColor:hs,borderTopColor:hs,borderRightColor:hs,borderBottomColor:hs,borderLeftColor:hs,filter:sb,WebkitFilter:sb},Iw=t=>IU[t];function PR(t,i){let r=Iw(t);return r!==sb&&(r=Jc),r.getAnimatableNone?r.getAnimatableNone(i):void 0}function LU(t,i,r){let o=0,p;for(;o<t.length&&!p;)typeof t[o]=="string"&&t[o]!=="none"&&t[o]!=="0"&&(p=t[o]),o++;if(p&&r)for(const y of i)t[y]=PR(r,p)}class RR extends Rw{constructor(i,r,o,p){super(i,r,o,p,p==null?void 0:p.owner,!0)}readKeyframes(){const{unresolvedKeyframes:i,element:r,name:o}=this;if(!r.current)return;super.readKeyframes();for(let L=0;L<i.length;L++){const k=i[L];if(typeof k=="string"&&bw(k)){const X=_R(k,r.current);X!==void 0&&(i[L]=X)}}if(!gU.has(o)||i.length!==2)return this.resolveNoneKeyframes();const[p,y]=i,d=CE(p),E=CE(y);if(d!==E)if(SE(d)&&SE(E))for(let L=0;L<i.length;L++){const k=i[L];typeof k=="string"&&(i[L]=parseFloat(k))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:i,name:r}=this,o=[];for(let p=0;p<i.length;p++)dU(i[p])&&o.push(p);o.length&&LU(i,o,r)}measureInitialState(){const{element:i,unresolvedKeyframes:r,name:o}=this;if(!i.current)return;o==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zd[o](i.measureViewportBox(),window.getComputedStyle(i.current)),r[0]=this.measuredOrigin;const p=r[r.length-1];p!==void 0&&i.getValue(o,p).jump(p,!1)}measureEndState(){var i;const{element:r,name:o,unresolvedKeyframes:p}=this;if(!r.current)return;const y=r.getValue(o);y&&y.jump(this.measuredOrigin,!1);const d=p.length-1,E=p[d];p[d]=Zd[o](r.measureViewportBox(),window.getComputedStyle(r.current)),E!==null&&(this.finalKeyframe=E),!((i=this.removedTransforms)===null||i===void 0)&&i.length&&this.removedTransforms.forEach(([L,k])=>{r.getValue(L).set(k)}),this.resolveNoneKeyframes()}}function OU(t){let i;return()=>(i===void 0&&(i=t()),i)}const RE=(t,i)=>i==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Jc.test(t)||t==="0")&&!t.startsWith("url("));function FU(t){const i=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==i)return!0}function BU(t,i,r,o){const p=t[0];if(p===null)return!1;const y=t[t.length-1],d=RE(p,i),E=RE(y,i);return!d||!E?!1:FU(t)||r==="spring"&&o}class DR{constructor({autoplay:i=!0,delay:r=0,type:o="keyframes",repeat:p=0,repeatDelay:y=0,repeatType:d="loop",...E}){this.isStopped=!1,this.options={autoplay:i,delay:r,type:o,repeat:p,repeatDelay:y,repeatType:d,...E},this.updateFinishedPromise()}get resolved(){return this._resolved||xU(),this._resolved}onKeyframesResolved(i,r){const{name:o,type:p,velocity:y,delay:d,onComplete:E,onUpdate:L}=this.options;if(!BU(i,o,p,y))if(d)this.options.duration=0;else{L==null||L(m0(i,this.options,r)),E==null||E(),this.resolveFinishedPromise();return}const k=this.initPlayback(i,r);k!==!1&&(this._resolved={keyframes:i,finalKeyframe:r,...k},this.onPostResolved())}onPostResolved(){}then(i,r){return this.currentFinishedPromise.then(i,r)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(i=>{this.resolveFinishedPromise=i})}}function IR(t,i){return i?t*(1e3/i):0}const kU=5;function LR(t,i,r){const o=Math.max(i-kU,0);return IR(r-t(o),i-o)}const q_=.001,UU=.01,DE=10,NU=.05,zU=1;function GU({duration:t=800,bounce:i=.25,velocity:r=0,mass:o=1}){let p,y;fU(t<=Ul(DE));let d=1-i;d=qc(NU,zU,d),t=qc(UU,DE,Nl(t)),d<1?(p=k=>{const X=k*d,$=X*t,Z=X-r,ge=ob(k,d),be=Math.exp(-$);return q_-Z/ge*be},y=k=>{const $=k*d*t,Z=$*r+r,ge=Math.pow(d,2)*Math.pow(k,2)*t,be=Math.exp(-$),ye=ob(Math.pow(k,2),d);return(-p(k)+q_>0?-1:1)*((Z-ge)*be)/ye}):(p=k=>{const X=Math.exp(-k*t),$=(k-r)*t+1;return-q_+X*$},y=k=>{const X=Math.exp(-k*t),$=(r-k)*(t*t);return X*$});const E=5/t,L=VU(p,y,E);if(t=Ul(t),isNaN(L))return{stiffness:100,damping:10,duration:t};{const k=Math.pow(L,2)*o;return{stiffness:k,damping:d*2*Math.sqrt(o*k),duration:t}}}const HU=12;function VU(t,i,r){let o=r;for(let p=1;p<HU;p++)o=o-t(o)/i(o);return o}function ob(t,i){return t*Math.sqrt(1-i*i)}const WU=["duration","bounce"],jU=["stiffness","damping","mass"];function IE(t,i){return i.some(r=>t[r]!==void 0)}function XU(t){let i={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!IE(t,jU)&&IE(t,WU)){const r=GU(t);i={...i,...r,mass:1},i.isResolvedFromDuration=!0}return i}function OR({keyframes:t,restDelta:i,restSpeed:r,...o}){const p=t[0],y=t[t.length-1],d={done:!1,value:p},{stiffness:E,damping:L,mass:k,duration:X,velocity:$,isResolvedFromDuration:Z}=XU({...o,velocity:-Nl(o.velocity||0)}),ge=$||0,be=L/(2*Math.sqrt(E*k)),ye=y-p,$e=Nl(Math.sqrt(E/k)),ce=Math.abs(ye)<5;r||(r=ce?.01:2),i||(i=ce?.005:.5);let ie;if(be<1){const U=ob($e,be);ie=re=>{const ve=Math.exp(-be*$e*re);return y-ve*((ge+be*$e*ye)/U*Math.sin(U*re)+ye*Math.cos(U*re))}}else if(be===1)ie=U=>y-Math.exp(-$e*U)*(ye+(ge+$e*ye)*U);else{const U=$e*Math.sqrt(be*be-1);ie=re=>{const ve=Math.exp(-be*$e*re),Be=Math.min(U*re,300);return y-ve*((ge+be*$e*ye)*Math.sinh(Be)+U*ye*Math.cosh(Be))/U}}return{calculatedDuration:Z&&X||null,next:U=>{const re=ie(U);if(Z)d.done=U>=X;else{let ve=ge;U!==0&&(be<1?ve=LR(ie,U,re):ve=0);const Be=Math.abs(ve)<=r,Ge=Math.abs(y-re)<=i;d.done=Be&&Ge}return d.value=d.done?y:re,d}}}function LE({keyframes:t,velocity:i=0,power:r=.8,timeConstant:o=325,bounceDamping:p=10,bounceStiffness:y=500,modifyTarget:d,min:E,max:L,restDelta:k=.5,restSpeed:X}){const $=t[0],Z={done:!1,value:$},ge=Ie=>E!==void 0&&Ie<E||L!==void 0&&Ie>L,be=Ie=>E===void 0?L:L===void 0||Math.abs(E-Ie)<Math.abs(L-Ie)?E:L;let ye=r*i;const $e=$+ye,ce=d===void 0?$e:d($e);ce!==$e&&(ye=ce-$);const ie=Ie=>-ye*Math.exp(-Ie/o),U=Ie=>ce+ie(Ie),re=Ie=>{const Ct=ie(Ie),vt=U(Ie);Z.done=Math.abs(Ct)<=k,Z.value=Z.done?ce:vt};let ve,Be;const Ge=Ie=>{ge(Z.value)&&(ve=Ie,Be=OR({keyframes:[Z.value,be(Z.value)],velocity:LR(U,Ie,Z.value),damping:p,stiffness:y,restDelta:k,restSpeed:X}))};return Ge(0),{calculatedDuration:null,next:Ie=>{let Ct=!1;return!Be&&ve===void 0&&(Ct=!0,re(Ie),Ge(Ie)),ve!==void 0&&Ie>=ve?Be.next(Ie-ve):(!Ct&&re(Ie),Z)}}}const FR=(t,i,r)=>(((1-3*r+3*i)*t+(3*r-6*i))*t+3*i)*t,YU=1e-7,QU=12;function KU(t,i,r,o,p){let y,d,E=0;do d=i+(r-i)/2,y=FR(d,o,p)-t,y>0?r=d:i=d;while(Math.abs(y)>YU&&++E<QU);return d}function xm(t,i,r,o){if(t===i&&r===o)return Zr;const p=y=>KU(y,0,1,t,r);return y=>y===0||y===1?y:FR(p(y),i,o)}const qU=xm(.42,0,1,1),ZU=xm(0,0,.58,1),BR=xm(.42,0,.58,1),JU=t=>Array.isArray(t)&&typeof t[0]!="number",kR=t=>i=>i<=.5?t(2*i)/2:(2-t(2*(1-i)))/2,UR=t=>i=>1-t(1-i),Lw=t=>1-Math.sin(Math.acos(t)),NR=UR(Lw),$U=kR(Lw),zR=xm(.33,1.53,.69,.99),Ow=UR(zR),eN=kR(Ow),tN=t=>(t*=2)<1?.5*Ow(t):.5*(2-Math.pow(2,-10*(t-1))),nN={linear:Zr,easeIn:qU,easeInOut:BR,easeOut:ZU,circIn:Lw,circInOut:$U,circOut:NR,backIn:Ow,backInOut:eN,backOut:zR,anticipate:tN},OE=t=>{if(Array.isArray(t)){vR(t.length===4);const[i,r,o,p]=t;return xm(i,r,o,p)}else if(typeof t=="string")return nN[t];return t},lm=(t,i,r)=>{const o=i-t;return o===0?1:(r-t)/o},ji=(t,i,r)=>t+(i-t)*r;function Z_(t,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(i-t)*6*r:r<1/2?i:r<2/3?t+(i-t)*(2/3-r)*6:t}function iN({hue:t,saturation:i,lightness:r,alpha:o}){t/=360,i/=100,r/=100;let p=0,y=0,d=0;if(!i)p=y=d=r;else{const E=r<.5?r*(1+i):r+i-r*i,L=2*r-E;p=Z_(L,E,t+1/3),y=Z_(L,E,t),d=Z_(L,E,t-1/3)}return{red:Math.round(p*255),green:Math.round(y*255),blue:Math.round(d*255),alpha:o}}const J_=(t,i,r)=>{const o=t*t,p=r*(i*i-o)+o;return p<0?0:Math.sqrt(p)},rN=[rb,lh,Fd],sN=t=>rN.find(i=>i.test(t));function FE(t){const i=sN(t);let r=i.parse(t);return i===Fd&&(r=iN(r)),r}const BE=(t,i)=>{const r=FE(t),o=FE(i),p={...r};return y=>(p.red=J_(r.red,o.red,y),p.green=J_(r.green,o.green,y),p.blue=J_(r.blue,o.blue,y),p.alpha=ji(r.alpha,o.alpha,y),lh.transform(p))};function ab(t,i){return r=>r>0?i:t}function oN(t,i){return r=>ji(t,i,r)}function Fw(t){return typeof t=="number"?oN:typeof t=="string"?bw(t)?ab:hs.test(t)?BE:cN:Array.isArray(t)?GR:typeof t=="object"?hs.test(t)?BE:aN:ab}function GR(t,i){const r=[...t],o=r.length,p=t.map((y,d)=>Fw(y)(y,i[d]));return y=>{for(let d=0;d<o;d++)r[d]=p[d](y);return r}}function aN(t,i){const r={...t,...i},o={};for(const p in r)t[p]!==void 0&&i[p]!==void 0&&(o[p]=Fw(t[p])(t[p],i[p]));return p=>{for(const y in o)r[y]=o[y](p);return r}}function lN(t,i){var r;const o=[],p={color:0,var:0,number:0};for(let y=0;y<i.values.length;y++){const d=i.types[y],E=t.indexes[d][p[d]],L=(r=t.values[E])!==null&&r!==void 0?r:0;o[y]=L,p[d]++}return o}const cN=(t,i)=>{const r=Jc.createTransformer(i),o=Nv(t),p=Nv(i);return o.indexes.var.length===p.indexes.var.length&&o.indexes.color.length===p.indexes.color.length&&o.indexes.number.length>=p.indexes.number.length?kl(GR(lN(o,p),p.values),r):ab(t,i)};function HR(t,i,r){return typeof t=="number"&&typeof i=="number"&&typeof r=="number"?ji(t,i,r):Fw(t)(t,i)}function uN(t,i,r){const o=[],p=r||HR,y=t.length-1;for(let d=0;d<y;d++){let E=p(t[d],t[d+1]);if(i){const L=Array.isArray(i)?i[d]||Zr:i;E=kl(L,E)}o.push(E)}return o}function hN(t,i,{clamp:r=!0,ease:o,mixer:p}={}){const y=t.length;if(vR(y===i.length),y===1)return()=>i[0];if(y===2&&t[0]===t[1])return()=>i[1];t[0]>t[y-1]&&(t=[...t].reverse(),i=[...i].reverse());const d=uN(i,o,p),E=d.length,L=k=>{let X=0;if(E>1)for(;X<t.length-2&&!(k<t[X+1]);X++);const $=lm(t[X],t[X+1],k);return d[X]($)};return r?k=>L(qc(t[0],t[y-1],k)):L}function dN(t,i){const r=t[t.length-1];for(let o=1;o<=i;o++){const p=lm(0,i,o);t.push(ji(r,1,p))}}function fN(t){const i=[0];return dN(i,t.length-1),i}function pN(t,i){return t.map(r=>r*i)}function mN(t,i){return t.map(()=>i||BR).splice(0,t.length-1)}function zv({duration:t=300,keyframes:i,times:r,ease:o="easeInOut"}){const p=JU(o)?o.map(OE):OE(o),y={done:!1,value:i[0]},d=pN(r&&r.length===i.length?r:fN(i),t),E=hN(d,i,{ease:Array.isArray(p)?p:mN(i,p)});return{calculatedDuration:t,next:L=>(y.value=E(L),y.done=L>=t,y)}}const kE=2e4;function gN(t){let i=0;const r=50;let o=t.next(i);for(;!o.done&&i<kE;)i+=r,o=t.next(i);return i>=kE?1/0:i}const vN=t=>{const i=({timestamp:r})=>t(r);return{start:()=>Nr.update(i,!0),stop:()=>Zc(i),now:()=>Kr.isProcessing?Kr.timestamp:Yc.now()}},yN={decay:LE,inertia:LE,tween:zv,keyframes:zv,spring:OR},_N=t=>t/100;class Bw extends DR{constructor({KeyframeResolver:i=Rw,...r}){super(r),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle";const{name:o,motionValue:p,keyframes:y}=this.options,d=(E,L)=>this.onKeyframesResolved(E,L);o&&p&&p.owner?this.resolver=p.owner.resolveKeyframes(y,d,o,p):this.resolver=new i(y,d,o,p),this.resolver.scheduleResolve()}initPlayback(i){const{type:r="keyframes",repeat:o=0,repeatDelay:p=0,repeatType:y,velocity:d=0}=this.options,E=yN[r]||zv;let L,k;E!==zv&&typeof i[0]!="number"&&(L=kl(_N,HR(i[0],i[1])),i=[0,100]);const X=E({...this.options,keyframes:i});y==="mirror"&&(k=E({...this.options,keyframes:[...i].reverse(),velocity:-d})),X.calculatedDuration===null&&(X.calculatedDuration=gN(X));const{calculatedDuration:$}=X,Z=$+p,ge=Z*(o+1)-p;return{generator:X,mirroredGenerator:k,mapPercentToKeyframes:L,calculatedDuration:$,resolvedDuration:Z,totalDuration:ge}}onPostResolved(){const{autoplay:i=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!i?this.pause():this.state=this.pendingPlayState}tick(i,r=!1){const{resolved:o}=this;if(!o){const{keyframes:Ie}=this.options;return{done:!0,value:Ie[Ie.length-1]}}const{finalKeyframe:p,generator:y,mirroredGenerator:d,mapPercentToKeyframes:E,keyframes:L,calculatedDuration:k,totalDuration:X,resolvedDuration:$}=o;if(this.startTime===null)return y.next(0);const{delay:Z,repeat:ge,repeatType:be,repeatDelay:ye,onUpdate:$e}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,i):this.speed<0&&(this.startTime=Math.min(i-X/this.speed,this.startTime)),r?this.currentTime=i:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(i-this.startTime)*this.speed;const ce=this.currentTime-Z*(this.speed>=0?1:-1),ie=this.speed>=0?ce<0:ce>X;this.currentTime=Math.max(ce,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=X);let U=this.currentTime,re=y;if(ge){const Ie=Math.min(this.currentTime,X)/$;let Ct=Math.floor(Ie),vt=Ie%1;!vt&&Ie>=1&&(vt=1),vt===1&&Ct--,Ct=Math.min(Ct,ge+1),!!(Ct%2)&&(be==="reverse"?(vt=1-vt,ye&&(vt-=ye/$)):be==="mirror"&&(re=d)),U=qc(0,1,vt)*$}const ve=ie?{done:!1,value:L[0]}:re.next(U);E&&(ve.value=E(ve.value));let{done:Be}=ve;!ie&&k!==null&&(Be=this.speed>=0?this.currentTime>=X:this.currentTime<=0);const Ge=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Be);return Ge&&p!==void 0&&(ve.value=m0(L,this.options,p)),$e&&$e(ve.value),Ge&&this.finish(),ve}get duration(){const{resolved:i}=this;return i?Nl(i.calculatedDuration):0}get time(){return Nl(this.currentTime)}set time(i){i=Ul(i),this.currentTime=i,this.holdTime!==null||this.speed===0?this.holdTime=i:this.driver&&(this.startTime=this.driver.now()-i/this.speed)}get speed(){return this.playbackSpeed}set speed(i){const r=this.playbackSpeed!==i;this.playbackSpeed=i,r&&(this.time=Nl(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:i=vN,onPlay:r}=this.options;this.driver||(this.driver=i(p=>this.tick(p))),r&&r();const o=this.driver.now();this.holdTime!==null?this.startTime=o-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=o),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var i;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(i=this.currentTime)!==null&&i!==void 0?i:0}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:i}=this.options;i&&i()}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:i}=this.options;i&&i()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(i){return this.startTime=0,this.tick(i,!0)}}const VR=t=>Array.isArray(t)&&typeof t[0]=="number";function WR(t){return!!(!t||typeof t=="string"&&jR[t]||VR(t)||Array.isArray(t)&&t.every(WR))}const Tp=([t,i,r,o])=>`cubic-bezier(${t}, ${i}, ${r}, ${o})`,jR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Tp([0,.65,.55,1]),circOut:Tp([.55,0,1,.45]),backIn:Tp([.31,.01,.66,-.59]),backOut:Tp([.33,1.53,.69,.99])};function XR(t){if(t)return VR(t)?Tp(t):Array.isArray(t)?t.map(XR):jR[t]}function xN(t,i,r,{delay:o=0,duration:p=300,repeat:y=0,repeatType:d="loop",ease:E,times:L}={}){const k={[i]:r};L&&(k.offset=L);const X=XR(E);return Array.isArray(X)&&(k.easing=X),t.animate(k,{delay:o,duration:p,easing:Array.isArray(X)?"linear":X,fill:"both",iterations:y+1,direction:d==="reverse"?"alternate":"normal"})}const bN=OU(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),wN=new Set(["opacity","clipPath","filter","transform"]),Gv=10,AN=2e4;function SN(t){return t.type==="spring"||t.name==="backgroundColor"||!WR(t.ease)}function MN(t,i){const r=new Bw({...i,keyframes:t,repeat:0,delay:0});let o={done:!1,value:t[0]};const p=[];let y=0;for(;!o.done&&y<AN;)o=r.sample(y),p.push(o.value),y+=Gv;return{times:void 0,keyframes:p,duration:y-Gv,ease:"linear"}}class UE extends DR{constructor(i){super(i);const{name:r,motionValue:o,keyframes:p}=this.options;this.resolver=new RR(p,(y,d)=>this.onKeyframesResolved(y,d),r,o),this.resolver.scheduleResolve()}initPlayback(i,r){var o;let{duration:p=300,motionValue:y,name:d}=this.options;if(!(!((o=y.owner)===null||o===void 0)&&o.current))return!1;if(SN(this.options)){const{onComplete:L,onUpdate:k,motionValue:X,...$}=this.options,Z=MN(i,$);i=Z.keyframes,p=Z.duration,this.options.times=Z.times,this.options.ease=Z.ease}const E=xN(y.owner.current,d,i,{...this.options,duration:p});return E.startTime=Yc.now(),this.pendingTimeline?(E.timeline=this.pendingTimeline,this.pendingTimeline=void 0):E.onfinish=()=>{const{onComplete:L}=this.options;y.set(m0(i,this.options,r)),L&&L(),this.cancel(),this.resolveFinishedPromise()},{animation:E,duration:p,keyframes:i}}get duration(){const{resolved:i}=this;if(!i)return 0;const{duration:r}=i;return Nl(r)}get time(){const{resolved:i}=this;if(!i)return 0;const{animation:r}=i;return Nl(r.currentTime||0)}set time(i){const{resolved:r}=this;if(!r)return;const{animation:o}=r;o.currentTime=Ul(i)}get speed(){const{resolved:i}=this;if(!i)return 1;const{animation:r}=i;return r.playbackRate}set speed(i){const{resolved:r}=this;if(!r)return;const{animation:o}=r;o.playbackRate=i}get state(){const{resolved:i}=this;if(!i)return"idle";const{animation:r}=i;return r.playState}attachTimeline(i){if(!this._resolved)this.pendingTimeline=i;else{const{resolved:r}=this;if(!r)return Zr;const{animation:o}=r;o.timeline=i,o.onfinish=null}return Zr}play(){if(this.isStopped)return;const{resolved:i}=this;if(!i)return;const{animation:r}=i;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:i}=this;if(!i)return;const{animation:r}=i;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:i}=this;if(!i)return;const{animation:r,keyframes:o}=i;if(!(r.playState==="idle"||r.playState==="finished")){if(this.time){const{motionValue:p,onUpdate:y,onComplete:d,...E}=this.options,L=new Bw({...E,keyframes:o}),k=Ul(this.time);p.setWithVelocity(L.sample(k-Gv).value,L.sample(k).value,Gv)}this.cancel()}}complete(){const{resolved:i}=this;i&&i.animation.finish()}cancel(){const{resolved:i}=this;i&&i.animation.cancel()}static supports(i){const{motionValue:r,name:o,repeatDelay:p,repeatType:y,damping:d,type:E}=i;return bN()&&o&&wN.has(o)&&r&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate&&!p&&y!=="mirror"&&d!==0&&E!=="inertia"}}const kw=(t,i,r,o={},p,y)=>d=>{const E=Pw(o,t)||{},L=E.delay||o.delay||0;let{elapsed:k=0}=o;k=k-Ul(L);let X={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:i.getVelocity(),...E,delay:-k,onUpdate:Z=>{i.set(Z),E.onUpdate&&E.onUpdate(Z)},onComplete:()=>{d(),E.onComplete&&E.onComplete()},name:t,motionValue:i,element:y?void 0:p};cU(E)||(X={...X,...lU(t,X)}),X.duration&&(X.duration=Ul(X.duration)),X.repeatDelay&&(X.repeatDelay=Ul(X.repeatDelay)),X.from!==void 0&&(X.keyframes[0]=X.from);let $=!1;if(X.type===!1&&(X.duration=0,X.delay===0&&($=!0)),$&&!y&&i.get()!==void 0){const Z=m0(X.keyframes,E);if(Z!==void 0){Nr.update(()=>{X.onUpdate(Z),X.onComplete()});return}}return!y&&UE.supports(X)?new UE(X):new Bw(X)};function Hv(t){return!!(fs(t)&&t.add)}function Uw(t,i){t.indexOf(i)===-1&&t.push(i)}function Nw(t,i){const r=t.indexOf(i);r>-1&&t.splice(r,1)}class zw{constructor(){this.subscriptions=[]}add(i){return Uw(this.subscriptions,i),()=>Nw(this.subscriptions,i)}notify(i,r,o){const p=this.subscriptions.length;if(p)if(p===1)this.subscriptions[0](i,r,o);else for(let y=0;y<p;y++){const d=this.subscriptions[y];d&&d(i,r,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const NE=30,EN=t=>!isNaN(parseFloat(t));class TN{constructor(i,r={}){this.version="11.0.20",this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(o,p=!0)=>{const y=Yc.now();this.updatedAt!==y&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(o),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),p&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(i),this.canTrackVelocity=EN(this.current),this.owner=r.owner}setCurrent(i){this.current=i,this.updatedAt=Yc.now()}setPrevFrameValue(i=this.current){this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt}onChange(i){return this.on("change",i)}on(i,r){this.events[i]||(this.events[i]=new zw);const o=this.events[i].add(r);return i==="change"?()=>{o(),Nr.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,r){this.passiveEffect=i,this.stopPassiveEffect=r}set(i,r=!0){!r||!this.passiveEffect?this.updateAndNotify(i,r):this.passiveEffect(i,this.updateAndNotify)}setWithVelocity(i,r,o){this.set(r),this.prev=void 0,this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt-o}jump(i,r=!0){this.updateAndNotify(i),this.prev=i,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const i=Yc.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||i-this.updatedAt>NE)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,NE);return IR(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(i){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=i(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cm(t,i){return new TN(t,i)}function CN(t,i,r){t.hasValue(i)?t.getValue(i).set(r):t.addValue(i,cm(r))}function PN(t,i){const r=p0(t,i);let{transitionEnd:o={},transition:p={},...y}=r||{};y={...y,...o};for(const d in y){const E=k3(y[d]);CN(t,d,E)}}function RN({protectedKeys:t,needsAnimating:i},r){const o=t.hasOwnProperty(r)&&i[r]!==!0;return i[r]=!1,o}function YR(t,i,{delay:r=0,transitionOverride:o,type:p}={}){var y;let{transition:d=t.getDefaultTransition(),transitionEnd:E,...L}=i;const k=t.getValue("willChange");o&&(d=o);const X=[],$=p&&t.animationState&&t.animationState.getState()[p];for(const Z in L){const ge=t.getValue(Z,(y=t.latestValues[Z])!==null&&y!==void 0?y:null),be=L[Z];if(be===void 0||$&&RN($,Z))continue;const ye={delay:r,elapsed:0,...Pw(d||{},Z)};let $e=!1;if(window.HandoffAppearAnimations){const ie=t.getProps()[YP];if(ie){const U=window.HandoffAppearAnimations(ie,Z);U!==null&&(ye.elapsed=U,$e=!0)}}ge.start(kw(Z,ge,be,t.shouldReduceMotion&&xh.has(Z)?{type:!1}:ye,t,$e));const ce=ge.animation;ce&&(Hv(k)&&(k.add(Z),ce.then(()=>k.remove(Z))),X.push(ce))}return E&&Promise.all(X).then(()=>{Nr.update(()=>{E&&PN(t,E)})}),X}function lb(t,i,r={}){var o;const p=p0(t,i,r.type==="exit"?(o=t.presenceContext)===null||o===void 0?void 0:o.custom:void 0);let{transition:y=t.getDefaultTransition()||{}}=p||{};r.transitionOverride&&(y=r.transitionOverride);const d=p?()=>Promise.all(YR(t,p,r)):()=>Promise.resolve(),E=t.variantChildren&&t.variantChildren.size?(k=0)=>{const{delayChildren:X=0,staggerChildren:$,staggerDirection:Z}=y;return DN(t,i,X+k,$,Z,r)}:()=>Promise.resolve(),{when:L}=y;if(L){const[k,X]=L==="beforeChildren"?[d,E]:[E,d];return k().then(()=>X())}else return Promise.all([d(),E(r.delay)])}function DN(t,i,r=0,o=0,p=1,y){const d=[],E=(t.variantChildren.size-1)*o,L=p===1?(k=0)=>k*o:(k=0)=>E-k*o;return Array.from(t.variantChildren).sort(IN).forEach((k,X)=>{k.notify("AnimationStart",i),d.push(lb(k,i,{...y,delay:r+L(X)}).then(()=>k.notify("AnimationComplete",i)))}),Promise.all(d)}function IN(t,i){return t.sortNodePosition(i)}function LN(t,i,r={}){t.notify("AnimationStart",i);let o;if(Array.isArray(i)){const p=i.map(y=>lb(t,y,r));o=Promise.all(p)}else if(typeof i=="string")o=lb(t,i,r);else{const p=typeof i=="function"?p0(t,i,r.custom):i;o=Promise.all(YR(t,p,r))}return o.then(()=>{Nr.postRender(()=>{t.notify("AnimationComplete",i)})})}const ON=[...vw].reverse(),FN=vw.length;function BN(t){return i=>Promise.all(i.map(({animation:r,options:o})=>LN(t,r,o)))}function kN(t){let i=BN(t);const r=NN();let o=!0;const p=L=>(k,X)=>{var $;const Z=p0(t,X,L==="exit"?($=t.presenceContext)===null||$===void 0?void 0:$.custom:void 0);if(Z){const{transition:ge,transitionEnd:be,...ye}=Z;k={...k,...ye,...be}}return k};function y(L){i=L(t)}function d(L){const k=t.getProps(),X=t.getVariantContext(!0)||{},$=[],Z=new Set;let ge={},be=1/0;for(let $e=0;$e<FN;$e++){const ce=ON[$e],ie=r[ce],U=k[ce]!==void 0?k[ce]:X[ce],re=om(U),ve=ce===L?ie.isActive:null;ve===!1&&(be=$e);let Be=U===X[ce]&&U!==k[ce]&&re;if(Be&&o&&t.manuallyAnimateOnMount&&(Be=!1),ie.protectedKeys={...ge},!ie.isActive&&ve===null||!U&&!ie.prevProp||h0(U)||typeof U=="boolean")continue;let Ie=UN(ie.prevProp,U)||ce===L&&ie.isActive&&!Be&&re||$e>be&&re,Ct=!1;const vt=Array.isArray(U)?U:[U];let Sn=vt.reduce(p(ce),{});ve===!1&&(Sn={});const{prevResolvedValues:Oi={}}=ie,Fi={...Oi,...Sn},$r=Ei=>{Ie=!0,Z.has(Ei)&&(Ct=!0,Z.delete(Ei)),ie.needsAnimating[Ei]=!0};for(const Ei in Fi){const gr=Sn[Ei],ms=Oi[Ei];if(ge.hasOwnProperty(Ei))continue;let mt=!1;eb(gr)&&eb(ms)?mt=!mR(gr,ms):mt=gr!==ms,mt?gr!=null?$r(Ei):Z.add(Ei):gr!==void 0&&Z.has(Ei)?$r(Ei):ie.protectedKeys[Ei]=!0}ie.prevProp=U,ie.prevResolvedValues=Sn,ie.isActive&&(ge={...ge,...Sn}),o&&t.blockInitialAnimation&&(Ie=!1),Ie&&(!Be||Ct)&&$.push(...vt.map(Ei=>({animation:Ei,options:{type:ce}})))}if(Z.size){const $e={};Z.forEach(ce=>{const ie=t.getBaseTarget(ce);$e[ce]=ie===void 0?null:ie}),$.push({animation:$e})}let ye=!!$.length;return o&&(k.initial===!1||k.initial===k.animate)&&!t.manuallyAnimateOnMount&&(ye=!1),o=!1,ye?i($):Promise.resolve()}function E(L,k){var X;if(r[L].isActive===k)return Promise.resolve();(X=t.variantChildren)===null||X===void 0||X.forEach(Z=>{var ge;return(ge=Z.animationState)===null||ge===void 0?void 0:ge.setActive(L,k)}),r[L].isActive=k;const $=d(L);for(const Z in r)r[Z].protectedKeys={};return $}return{animateChanges:d,setActive:E,setAnimateFunction:y,getState:()=>r}}function UN(t,i){return typeof i=="string"?i!==t:Array.isArray(i)?!mR(i,t):!1}function $u(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function NN(){return{animate:$u(!0),whileInView:$u(),whileHover:$u(),whileTap:$u(),whileDrag:$u(),whileFocus:$u(),exit:$u()}}class zN extends iu{constructor(i){super(i),i.animationState||(i.animationState=kN(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();this.unmount(),h0(i)&&(this.unmount=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:r}=this.node.prevProps||{};i!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let GN=0;class HN extends iu{constructor(){super(...arguments),this.id=GN++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:r}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===o)return;const p=this.node.animationState.setActive("exit",!i);r&&!i&&p.then(()=>r(this.id))}mount(){const{register:i}=this.node.presenceContext||{};i&&(this.unmount=i(this.id))}unmount(){}}const VN={animation:{Feature:zN},exit:{Feature:HN}},zE=(t,i)=>Math.abs(t-i);function WN(t,i){const r=zE(t.x,i.x),o=zE(t.y,i.y);return Math.sqrt(r**2+o**2)}class QR{constructor(i,r,{transformPagePoint:o,contextWindow:p,dragSnapToOrigin:y=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const $=ex(this.lastMoveEventInfo,this.history),Z=this.startEvent!==null,ge=WN($.offset,{x:0,y:0})>=3;if(!Z&&!ge)return;const{point:be}=$,{timestamp:ye}=Kr;this.history.push({...be,timestamp:ye});const{onStart:$e,onMove:ce}=this.handlers;Z||($e&&$e(this.lastMoveEvent,$),this.startEvent=this.lastMoveEvent),ce&&ce(this.lastMoveEvent,$)},this.handlePointerMove=($,Z)=>{this.lastMoveEvent=$,this.lastMoveEventInfo=$_(Z,this.transformPagePoint),Nr.update(this.updatePoint,!0)},this.handlePointerUp=($,Z)=>{this.end();const{onEnd:ge,onSessionEnd:be,resumeAnimation:ye}=this.handlers;if(this.dragSnapToOrigin&&ye&&ye(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const $e=ex($.type==="pointercancel"?this.lastMoveEventInfo:$_(Z,this.transformPagePoint),this.history);this.startEvent&&ge&&ge($,$e),be&&be($,$e)},!uR(i))return;this.dragSnapToOrigin=y,this.handlers=r,this.transformPagePoint=o,this.contextWindow=p||window;const d=f0(i),E=$_(d,this.transformPagePoint),{point:L}=E,{timestamp:k}=Kr;this.history=[{...L,timestamp:k}];const{onSessionStart:X}=r;X&&X(i,ex(E,this.history)),this.removeListeners=kl(Bl(this.contextWindow,"pointermove",this.handlePointerMove),Bl(this.contextWindow,"pointerup",this.handlePointerUp),Bl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),Zc(this.updatePoint)}}function $_(t,i){return i?{point:i(t.point)}:t}function GE(t,i){return{x:t.x-i.x,y:t.y-i.y}}function ex({point:t},i){return{point:t,delta:GE(t,KR(i)),offset:GE(t,jN(i)),velocity:XN(i,.1)}}function jN(t){return t[0]}function KR(t){return t[t.length-1]}function XN(t,i){if(t.length<2)return{x:0,y:0};let r=t.length-1,o=null;const p=KR(t);for(;r>=0&&(o=t[r],!(p.timestamp-o.timestamp>Ul(i)));)r--;if(!o)return{x:0,y:0};const y=Nl(p.timestamp-o.timestamp);if(y===0)return{x:0,y:0};const d={x:(p.x-o.x)/y,y:(p.y-o.y)/y};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function fo(t){return t.max-t.min}function cb(t,i=0,r=.01){return Math.abs(t-i)<=r}function HE(t,i,r,o=.5){t.origin=o,t.originPoint=ji(i.min,i.max,t.origin),t.scale=fo(r)/fo(i),(cb(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=ji(r.min,r.max,t.origin)-t.originPoint,(cb(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Np(t,i,r,o){HE(t.x,i.x,r.x,o?o.originX:void 0),HE(t.y,i.y,r.y,o?o.originY:void 0)}function VE(t,i,r){t.min=r.min+i.min,t.max=t.min+fo(i)}function YN(t,i,r){VE(t.x,i.x,r.x),VE(t.y,i.y,r.y)}function WE(t,i,r){t.min=i.min-r.min,t.max=t.min+fo(i)}function zp(t,i,r){WE(t.x,i.x,r.x),WE(t.y,i.y,r.y)}function QN(t,{min:i,max:r},o){return i!==void 0&&t<i?t=o?ji(i,t,o.min):Math.max(t,i):r!==void 0&&t>r&&(t=o?ji(r,t,o.max):Math.min(t,r)),t}function jE(t,i,r){return{min:i!==void 0?t.min+i:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function KN(t,{top:i,left:r,bottom:o,right:p}){return{x:jE(t.x,r,p),y:jE(t.y,i,o)}}function XE(t,i){let r=i.min-t.min,o=i.max-t.max;return i.max-i.min<t.max-t.min&&([r,o]=[o,r]),{min:r,max:o}}function qN(t,i){return{x:XE(t.x,i.x),y:XE(t.y,i.y)}}function ZN(t,i){let r=.5;const o=fo(t),p=fo(i);return p>o?r=lm(i.min,i.max-o,t.min):o>p&&(r=lm(t.min,t.max-p,i.min)),qc(0,1,r)}function JN(t,i){const r={};return i.min!==void 0&&(r.min=i.min-t.min),i.max!==void 0&&(r.max=i.max-t.min),r}const ub=.35;function $N(t=ub){return t===!1?t=0:t===!0&&(t=ub),{x:YE(t,"left","right"),y:YE(t,"top","bottom")}}function YE(t,i,r){return{min:QE(t,i),max:QE(t,r)}}function QE(t,i){return typeof t=="number"?t:t[i]||0}const KE=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bd=()=>({x:KE(),y:KE()}),qE=()=>({min:0,max:0}),or=()=>({x:qE(),y:qE()});function Fo(t){return[t("x"),t("y")]}function qR({top:t,left:i,right:r,bottom:o}){return{x:{min:i,max:r},y:{min:t,max:o}}}function ez({x:t,y:i}){return{top:i.min,right:t.max,bottom:i.max,left:t.min}}function tz(t,i){if(!i)return t;const r=i({x:t.left,y:t.top}),o=i({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:o.y,right:o.x}}function tx(t){return t===void 0||t===1}function hb({scale:t,scaleX:i,scaleY:r}){return!tx(t)||!tx(i)||!tx(r)}function nh(t){return hb(t)||ZR(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function ZR(t){return ZE(t.x)||ZE(t.y)}function ZE(t){return t&&t!=="0%"}function Vv(t,i,r){const o=t-r,p=i*o;return r+p}function JE(t,i,r,o,p){return p!==void 0&&(t=Vv(t,p,o)),Vv(t,r,o)+i}function db(t,i=0,r=1,o,p){t.min=JE(t.min,i,r,o,p),t.max=JE(t.max,i,r,o,p)}function JR(t,{x:i,y:r}){db(t.x,i.translate,i.scale,i.originPoint),db(t.y,r.translate,r.scale,r.originPoint)}function nz(t,i,r,o=!1){const p=r.length;if(!p)return;i.x=i.y=1;let y,d;for(let E=0;E<p;E++){y=r[E],d=y.projectionDelta;const L=y.instance;L&&L.style&&L.style.display==="contents"||(o&&y.options.layoutScroll&&y.scroll&&y!==y.root&&kd(t,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),d&&(i.x*=d.x.scale,i.y*=d.y.scale,JR(t,d)),o&&nh(y.latestValues)&&kd(t,y.latestValues))}i.x=$E(i.x),i.y=$E(i.y)}function $E(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Oc(t,i){t.min=t.min+i,t.max=t.max+i}function eT(t,i,[r,o,p]){const y=i[p]!==void 0?i[p]:.5,d=ji(t.min,t.max,y);db(t,i[r],i[o],d,i.scale)}const iz=["x","scaleX","originX"],rz=["y","scaleY","originY"];function kd(t,i){eT(t.x,i,iz),eT(t.y,i,rz)}function $R(t,i){return qR(tz(t.getBoundingClientRect(),i))}function sz(t,i,r){const o=$R(t,r),{scroll:p}=i;return p&&(Oc(o.x,p.offset.x),Oc(o.y,p.offset.y)),o}const e2=({current:t})=>t?t.ownerDocument.defaultView:null,oz=new WeakMap;class az{constructor(i){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=or(),this.visualElement=i}start(i,{snapToCursor:r=!1}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const p=X=>{const{dragSnapToOrigin:$}=this.getProps();$?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(f0(X,"page").point)},y=(X,$)=>{const{drag:Z,dragPropagation:ge,onDragStart:be}=this.getProps();if(Z&&!ge&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=dR(Z),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Fo($e=>{let ce=this.getAxisMotionValue($e).get()||0;if(el.test(ce)){const{projection:ie}=this.visualElement;if(ie&&ie.layout){const U=ie.layout.layoutBox[$e];U&&(ce=fo(U)*(parseFloat(ce)/100))}}this.originPoint[$e]=ce}),be&&be(X,$);const{animationState:ye}=this.visualElement;ye&&ye.setActive("whileDrag",!0)},d=(X,$)=>{const{dragPropagation:Z,dragDirectionLock:ge,onDirectionLock:be,onDrag:ye}=this.getProps();if(!Z&&!this.openGlobalLock)return;const{offset:$e}=$;if(ge&&this.currentDirection===null){this.currentDirection=lz($e),this.currentDirection!==null&&be&&be(this.currentDirection);return}this.updateAxis("x",$.point,$e),this.updateAxis("y",$.point,$e),this.visualElement.render(),ye&&ye(X,$)},E=(X,$)=>this.stop(X,$),L=()=>Fo(X=>{var $;return this.getAnimationState(X)==="paused"&&(($=this.getAxisMotionValue(X).animation)===null||$===void 0?void 0:$.play())}),{dragSnapToOrigin:k}=this.getProps();this.panSession=new QR(i,{onSessionStart:p,onStart:y,onMove:d,onSessionEnd:E,resumeAnimation:L},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:k,contextWindow:e2(this.visualElement)})}stop(i,r){const o=this.isDragging;if(this.cancel(),!o)return;const{velocity:p}=r;this.startAnimation(p);const{onDragEnd:y}=this.getProps();y&&y(i,r)}cancel(){this.isDragging=!1;const{projection:i,animationState:r}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:o}=this.getProps();!o&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(i,r,o){const{drag:p}=this.getProps();if(!o||!Zg(i,p,this.currentDirection))return;const y=this.getAxisMotionValue(i);let d=this.originPoint[i]+o[i];this.constraints&&this.constraints[i]&&(d=QN(d,this.constraints[i],this.elastic[i])),y.set(d)}resolveConstraints(){var i;const{dragConstraints:r,dragElastic:o}=this.getProps(),p=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)===null||i===void 0?void 0:i.layout,y=this.constraints;r&&Od(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&p?this.constraints=KN(p.layoutBox,r):this.constraints=!1,this.elastic=$N(o),y!==this.constraints&&p&&this.constraints&&!this.hasMutatedConstraints&&Fo(d=>{this.getAxisMotionValue(d)&&(this.constraints[d]=JN(p.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:r}=this.getProps();if(!i||!Od(i))return!1;const o=i.current,{projection:p}=this.visualElement;if(!p||!p.layout)return!1;const y=sz(o,p.root,this.visualElement.getTransformPagePoint());let d=qN(p.layout.layoutBox,y);if(r){const E=r(ez(d));this.hasMutatedConstraints=!!E,E&&(d=qR(E))}return d}startAnimation(i){const{drag:r,dragMomentum:o,dragElastic:p,dragTransition:y,dragSnapToOrigin:d,onDragTransitionEnd:E}=this.getProps(),L=this.constraints||{},k=Fo(X=>{if(!Zg(X,r,this.currentDirection))return;let $=L&&L[X]||{};d&&($={min:0,max:0});const Z=p?200:1e6,ge=p?40:1e7,be={type:"inertia",velocity:o?i[X]:0,bounceStiffness:Z,bounceDamping:ge,timeConstant:750,restDelta:1,restSpeed:10,...y,...$};return this.startAxisValueAnimation(X,be)});return Promise.all(k).then(E)}startAxisValueAnimation(i,r){const o=this.getAxisMotionValue(i);return o.start(kw(i,o,0,r,this.visualElement))}stopAnimation(){Fo(i=>this.getAxisMotionValue(i).stop())}pauseAnimation(){Fo(i=>{var r;return(r=this.getAxisMotionValue(i).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(i){var r;return(r=this.getAxisMotionValue(i).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(i){const r="_drag"+i.toUpperCase(),o=this.visualElement.getProps(),p=o[r];return p||this.visualElement.getValue(i,(o.initial?o.initial[i]:void 0)||0)}snapToCursor(i){Fo(r=>{const{drag:o}=this.getProps();if(!Zg(r,o,this.currentDirection))return;const{projection:p}=this.visualElement,y=this.getAxisMotionValue(r);if(p&&p.layout){const{min:d,max:E}=p.layout.layoutBox[r];y.set(i[r]-ji(d,E,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:r}=this.getProps(),{projection:o}=this.visualElement;if(!Od(r)||!o||!this.constraints)return;this.stopAnimation();const p={x:0,y:0};Fo(d=>{const E=this.getAxisMotionValue(d);if(E){const L=E.get();p[d]=ZN({min:L,max:L},this.constraints[d])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.resolveConstraints(),Fo(d=>{if(!Zg(d,i,null))return;const E=this.getAxisMotionValue(d),{min:L,max:k}=this.constraints[d];E.set(ji(L,k,p[d]))})}addListeners(){if(!this.visualElement.current)return;oz.set(this.visualElement,this);const i=this.visualElement.current,r=Bl(i,"pointerdown",L=>{const{drag:k,dragListener:X=!0}=this.getProps();k&&X&&this.start(L)}),o=()=>{const{dragConstraints:L}=this.getProps();Od(L)&&(this.constraints=this.resolveRefConstraints())},{projection:p}=this.visualElement,y=p.addEventListener("measure",o);p&&!p.layout&&(p.root&&p.root.updateScroll(),p.updateLayout()),o();const d=Ll(window,"resize",()=>this.scalePositionWithinConstraints()),E=p.addEventListener("didUpdate",({delta:L,hasLayoutChanged:k})=>{this.isDragging&&k&&(Fo(X=>{const $=this.getAxisMotionValue(X);$&&(this.originPoint[X]+=L[X].translate,$.set($.get()+L[X].translate))}),this.visualElement.render())});return()=>{d(),r(),y(),E&&E()}}getProps(){const i=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:o=!1,dragPropagation:p=!1,dragConstraints:y=!1,dragElastic:d=ub,dragMomentum:E=!0}=i;return{...i,drag:r,dragDirectionLock:o,dragPropagation:p,dragConstraints:y,dragElastic:d,dragMomentum:E}}}function Zg(t,i,r){return(i===!0||i===t)&&(r===null||r===t)}function lz(t,i=10){let r=null;return Math.abs(t.y)>i?r="y":Math.abs(t.x)>i&&(r="x"),r}class cz extends iu{constructor(i){super(i),this.removeGroupControls=Zr,this.removeListeners=Zr,this.controls=new az(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zr}unmount(){this.removeGroupControls(),this.removeListeners()}}const tT=t=>(i,r)=>{t&&t(i,r)};class uz extends iu{constructor(){super(...arguments),this.removePointerDownListener=Zr}onPointerDown(i){this.session=new QR(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:e2(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:r,onPan:o,onPanEnd:p}=this.node.getProps();return{onSessionStart:tT(i),onStart:tT(r),onMove:o,onEnd:(y,d)=>{delete this.session,p&&p(y,d)}}}mount(){this.removePointerDownListener=Bl(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function hz(){const t=pt.useContext(u0);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:r,register:o}=t,p=pt.useId();return pt.useEffect(()=>o(p),[]),!i&&r?[!1,()=>r&&r(p)]:[!0]}const dv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function nT(t,i){return i.max===i.min?0:t/(i.max-i.min)*100}const wp={correct:(t,i)=>{if(!i.target)return t;if(typeof t=="string")if(mn.test(t))t=parseFloat(t);else return t;const r=nT(t,i.target.x),o=nT(t,i.target.y);return`${r}% ${o}%`}},dz={correct:(t,{treeScale:i,projectionDelta:r})=>{const o=t,p=Jc.parse(t);if(p.length>5)return o;const y=Jc.createTransformer(t),d=typeof p[0]!="number"?1:0,E=r.x.scale*i.x,L=r.y.scale*i.y;p[0+d]/=E,p[1+d]/=L;const k=ji(E,L,.5);return typeof p[2+d]=="number"&&(p[2+d]/=k),typeof p[3+d]=="number"&&(p[3+d]/=k),y(p)}};class fz extends yb.Component{componentDidMount(){const{visualElement:i,layoutGroup:r,switchLayoutGroup:o,layoutId:p}=this.props,{projection:y}=i;f3(pz),y&&(r.group&&r.group.add(y),o&&o.register&&p&&o.register(y),y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),dv.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:r,visualElement:o,drag:p,isPresent:y}=this.props,d=o.projection;return d&&(d.isPresent=y,p||i.layoutDependency!==r||r===void 0?d.willUpdate():this.safeToRemove(),i.isPresent!==y&&(y?d.promote():d.relegate()||Nr.postRender(()=>{const E=d.getStack();(!E||!E.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),gw.postRender(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:r,switchLayoutGroup:o}=this.props,{projection:p}=i;p&&(p.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(p),o&&o.deregister&&o.deregister(p))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function t2(t){const[i,r]=hz(),o=pt.useContext(_w);return yb.createElement(fz,{...t,layoutGroup:o,switchLayoutGroup:pt.useContext(qP),isPresent:i,safeToRemove:r})}const pz={borderRadius:{...wp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:wp,borderTopRightRadius:wp,borderBottomLeftRadius:wp,borderBottomRightRadius:wp,boxShadow:dz},n2=["TopLeft","TopRight","BottomLeft","BottomRight"],mz=n2.length,iT=t=>typeof t=="string"?parseFloat(t):t,rT=t=>typeof t=="number"||mn.test(t);function gz(t,i,r,o,p,y){p?(t.opacity=ji(0,r.opacity!==void 0?r.opacity:1,vz(o)),t.opacityExit=ji(i.opacity!==void 0?i.opacity:1,0,yz(o))):y&&(t.opacity=ji(i.opacity!==void 0?i.opacity:1,r.opacity!==void 0?r.opacity:1,o));for(let d=0;d<mz;d++){const E=`border${n2[d]}Radius`;let L=sT(i,E),k=sT(r,E);if(L===void 0&&k===void 0)continue;L||(L=0),k||(k=0),L===0||k===0||rT(L)===rT(k)?(t[E]=Math.max(ji(iT(L),iT(k),o),0),(el.test(k)||el.test(L))&&(t[E]+="%")):t[E]=k}(i.rotate||r.rotate)&&(t.rotate=ji(i.rotate||0,r.rotate||0,o))}function sT(t,i){return t[i]!==void 0?t[i]:t.borderRadius}const vz=i2(0,.5,NR),yz=i2(.5,.95,Zr);function i2(t,i,r){return o=>o<t?0:o>i?1:r(lm(t,i,o))}function oT(t,i){t.min=i.min,t.max=i.max}function Oo(t,i){oT(t.x,i.x),oT(t.y,i.y)}function aT(t,i,r,o,p){return t-=i,t=Vv(t,1/r,o),p!==void 0&&(t=Vv(t,1/p,o)),t}function _z(t,i=0,r=1,o=.5,p,y=t,d=t){if(el.test(i)&&(i=parseFloat(i),i=ji(d.min,d.max,i/100)-d.min),typeof i!="number")return;let E=ji(y.min,y.max,o);t===y&&(E-=i),t.min=aT(t.min,i,r,E,p),t.max=aT(t.max,i,r,E,p)}function lT(t,i,[r,o,p],y,d){_z(t,i[r],i[o],i[p],i.scale,y,d)}const xz=["x","scaleX","originX"],bz=["y","scaleY","originY"];function cT(t,i,r,o){lT(t.x,i,xz,r?r.x:void 0,o?o.x:void 0),lT(t.y,i,bz,r?r.y:void 0,o?o.y:void 0)}function uT(t){return t.translate===0&&t.scale===1}function r2(t){return uT(t.x)&&uT(t.y)}function wz(t,i){return t.x.min===i.x.min&&t.x.max===i.x.max&&t.y.min===i.y.min&&t.y.max===i.y.max}function s2(t,i){return Math.round(t.x.min)===Math.round(i.x.min)&&Math.round(t.x.max)===Math.round(i.x.max)&&Math.round(t.y.min)===Math.round(i.y.min)&&Math.round(t.y.max)===Math.round(i.y.max)}function hT(t){return fo(t.x)/fo(t.y)}class Az{constructor(){this.members=[]}add(i){Uw(this.members,i),i.scheduleRender()}remove(i){if(Nw(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(i){const r=this.members.findIndex(p=>i===p);if(r===0)return!1;let o;for(let p=r;p>=0;p--){const y=this.members[p];if(y.isPresent!==!1){o=y;break}}return o?(this.promote(o),!0):!1}promote(i,r){const o=this.lead;if(i!==o&&(this.prevLead=o,this.lead=i,i.show(),o)){o.instance&&o.scheduleRender(),i.scheduleRender(),i.resumeFrom=o,r&&(i.resumeFrom.preserveOpacity=!0),o.snapshot&&(i.snapshot=o.snapshot,i.snapshot.latestValues=o.animationValues||o.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0);const{crossfade:p}=i.options;p===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:r,resumingFrom:o}=i;r.onExitComplete&&r.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function dT(t,i,r){let o="";const p=t.x.translate/i.x,y=t.y.translate/i.y;if((p||y)&&(o=`translate3d(${p}px, ${y}px, 0) `),(i.x!==1||i.y!==1)&&(o+=`scale(${1/i.x}, ${1/i.y}) `),r){const{rotate:L,rotateX:k,rotateY:X,skewX:$,skewY:Z}=r;L&&(o+=`rotate(${L}deg) `),k&&(o+=`rotateX(${k}deg) `),X&&(o+=`rotateY(${X}deg) `),$&&(o+=`skewX(${$}deg) `),Z&&(o+=`skewY(${Z}deg) `)}const d=t.x.scale*i.x,E=t.y.scale*i.y;return(d!==1||E!==1)&&(o+=`scale(${d}, ${E})`),o||"none"}const Sz=(t,i)=>t.depth-i.depth;class Mz{constructor(){this.children=[],this.isDirty=!1}add(i){Uw(this.children,i),this.isDirty=!0}remove(i){Nw(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(Sz),this.isDirty=!1,this.children.forEach(i)}}function Ez(t,i){const r=Yc.now(),o=({timestamp:p})=>{const y=p-r;y>=i&&(Zc(o),t(y-i))};return Nr.read(o,!0),()=>Zc(o)}function Tz(t){window.MotionDebug&&window.MotionDebug.record(t)}function Cz(t){return t instanceof SVGElement&&t.tagName!=="svg"}function Pz(t,i,r){const o=fs(t)?t:cm(t);return o.start(kw("",o,i,r)),o.animation}const nx=["","X","Y","Z"],Rz={visibility:"hidden"},fT=1e3;let Dz=0;const ih={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function pT(t,i,r,o){const{latestValues:p}=i;p[t]&&(r[t]=p[t],i.setStaticValue(t,0),o&&(o[t]=0))}function o2({attachResizeListener:t,defaultParent:i,measureScroll:r,checkIsScrollRoot:o,resetTransform:p}){return class{constructor(d={},E=i==null?void 0:i()){this.id=Dz++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ih.totalNodes=ih.resolvedTargetDeltas=ih.recalculatedProjection=0,this.nodes.forEach(Oz),this.nodes.forEach(Nz),this.nodes.forEach(zz),this.nodes.forEach(Fz),Tz(ih)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=E?E.root||E:this,this.path=E?[...E.path,E]:[],this.parent=E,this.depth=E?E.depth+1:0;for(let L=0;L<this.path.length;L++)this.path[L].shouldResetTransform=!0;this.root===this&&(this.nodes=new Mz)}addEventListener(d,E){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new zw),this.eventHandlers.get(d).add(E)}notifyListeners(d,...E){const L=this.eventHandlers.get(d);L&&L.notify(...E)}hasListeners(d){return this.eventHandlers.has(d)}mount(d,E=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Cz(d),this.instance=d;const{layoutId:L,layout:k,visualElement:X}=this.options;if(X&&!X.current&&X.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),E&&(k||L)&&(this.isLayoutDirty=!0),t){let $;const Z=()=>this.root.updateBlockedByResize=!1;t(d,()=>{this.root.updateBlockedByResize=!0,$&&$(),$=Ez(Z,250),dv.hasAnimatedSinceResize&&(dv.hasAnimatedSinceResize=!1,this.nodes.forEach(gT))})}L&&this.root.registerSharedNode(L,this),this.options.animate!==!1&&X&&(L||k)&&this.addEventListener("didUpdate",({delta:$,hasLayoutChanged:Z,hasRelativeTargetChanged:ge,layout:be})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const ye=this.options.transition||X.getDefaultTransition()||jz,{onLayoutAnimationStart:$e,onLayoutAnimationComplete:ce}=X.getProps(),ie=!this.targetLayout||!s2(this.targetLayout,be)||ge,U=!Z&&ge;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||U||Z&&(ie||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin($,U);const re={...Pw(ye,"layout"),onPlay:$e,onComplete:ce};(X.shouldReduceMotion||this.options.layoutRoot)&&(re.delay=0,re.type=!1),this.startAnimation(re)}else Z||gT(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=be})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Zc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Gz),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let X=0;X<this.path.length;X++){const $=this.path[X];$.shouldResetTransform=!0,$.updateScroll("snapshot"),$.options.layoutRoot&&$.willUpdate(!1)}const{layoutId:E,layout:L}=this.options;if(E===void 0&&!L)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(mT);return}this.isUpdating||this.nodes.forEach(kz),this.isUpdating=!1,window.HandoffCancelAllAnimations&&window.HandoffCancelAllAnimations(),this.nodes.forEach(Uz),this.nodes.forEach(Iz),this.nodes.forEach(Lz),this.clearAllSnapshots();const E=Yc.now();Kr.delta=qc(0,1e3/60,E-Kr.timestamp),Kr.timestamp=E,Kr.isProcessing=!0,X_.update.process(Kr),X_.preRender.process(Kr),X_.render.process(Kr),Kr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,gw.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Bz),this.sharedNodes.forEach(Hz)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let L=0;L<this.path.length;L++)this.path[L].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=or(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:E}=this.options;E&&E.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let E=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(E=!1),E&&(this.scroll={animationId:this.root.animationId,phase:d,isRoot:o(this.instance),offset:r(this.instance)})}resetTransform(){if(!p)return;const d=this.isLayoutDirty||this.shouldResetTransform,E=this.projectionDelta&&!r2(this.projectionDelta),L=this.getTransformTemplate(),k=L?L(this.latestValues,""):void 0,X=k!==this.prevTransformTemplateValue;d&&(E||nh(this.latestValues)||X)&&(p(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const E=this.measurePageBox();let L=this.removeElementScroll(E);return d&&(L=this.removeTransform(L)),Xz(L),{animationId:this.root.animationId,measuredBox:E,layoutBox:L,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:d}=this.options;if(!d)return or();const E=d.measureViewportBox(),{scroll:L}=this.root;return L&&(Oc(E.x,L.offset.x),Oc(E.y,L.offset.y)),E}removeElementScroll(d){const E=or();Oo(E,d);for(let L=0;L<this.path.length;L++){const k=this.path[L],{scroll:X,options:$}=k;if(k!==this.root&&X&&$.layoutScroll){if(X.isRoot){Oo(E,d);const{scroll:Z}=this.root;Z&&(Oc(E.x,-Z.offset.x),Oc(E.y,-Z.offset.y))}Oc(E.x,X.offset.x),Oc(E.y,X.offset.y)}}return E}applyTransform(d,E=!1){const L=or();Oo(L,d);for(let k=0;k<this.path.length;k++){const X=this.path[k];!E&&X.options.layoutScroll&&X.scroll&&X!==X.root&&kd(L,{x:-X.scroll.offset.x,y:-X.scroll.offset.y}),nh(X.latestValues)&&kd(L,X.latestValues)}return nh(this.latestValues)&&kd(L,this.latestValues),L}removeTransform(d){const E=or();Oo(E,d);for(let L=0;L<this.path.length;L++){const k=this.path[L];if(!k.instance||!nh(k.latestValues))continue;hb(k.latestValues)&&k.updateSnapshot();const X=or(),$=k.measurePageBox();Oo(X,$),cT(E,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,X)}return nh(this.latestValues)&&cT(E,this.latestValues),E}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Kr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var E;const L=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=L.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=L.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=L.isSharedProjectionDirty);const k=!!this.resumingFrom||this!==L;if(!(d||k&&this.isSharedProjectionDirty||this.isProjectionDirty||!((E=this.parent)===null||E===void 0)&&E.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:$,layoutId:Z}=this.options;if(!(!this.layout||!($||Z))){if(this.resolvedRelativeTargetAt=Kr.timestamp,!this.targetDelta&&!this.relativeTarget){const ge=this.getClosestProjectingParent();ge&&ge.layout&&this.animationProgress!==1?(this.relativeParent=ge,this.forceRelativeParentToResolveTarget(),this.relativeTarget=or(),this.relativeTargetOrigin=or(),zp(this.relativeTargetOrigin,this.layout.layoutBox,ge.layout.layoutBox),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=or(),this.targetWithTransforms=or()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),YN(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Oo(this.target,this.layout.layoutBox),JR(this.target,this.targetDelta)):Oo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const ge=this.getClosestProjectingParent();ge&&!!ge.resumingFrom==!!this.resumingFrom&&!ge.options.layoutScroll&&ge.target&&this.animationProgress!==1?(this.relativeParent=ge,this.forceRelativeParentToResolveTarget(),this.relativeTarget=or(),this.relativeTargetOrigin=or(),zp(this.relativeTargetOrigin,this.target,ge.target),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ih.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hb(this.parent.latestValues)||ZR(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var d;const E=this.getLead(),L=!!this.resumingFrom||this!==E;let k=!0;if((this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty)&&(k=!1),L&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(k=!1),this.resolvedRelativeTargetAt===Kr.timestamp&&(k=!1),k)return;const{layout:X,layoutId:$}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(X||$))return;Oo(this.layoutCorrected,this.layout.layoutBox);const Z=this.treeScale.x,ge=this.treeScale.y;nz(this.layoutCorrected,this.treeScale,this.path,L),E.layout&&!E.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(E.target=E.layout.layoutBox,E.targetWithTransforms=or());const{target:be}=E;if(!be){this.projectionTransform&&(this.projectionDelta=Bd(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Bd(),this.projectionDeltaWithTransform=Bd());const ye=this.projectionTransform;Np(this.projectionDelta,this.layoutCorrected,be,this.latestValues),this.projectionTransform=dT(this.projectionDelta,this.treeScale),(this.projectionTransform!==ye||this.treeScale.x!==Z||this.treeScale.y!==ge)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",be)),ih.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),d){const E=this.getStack();E&&E.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(d,E=!1){const L=this.snapshot,k=L?L.latestValues:{},X={...this.latestValues},$=Bd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!E;const Z=or(),ge=L?L.source:void 0,be=this.layout?this.layout.source:void 0,ye=ge!==be,$e=this.getStack(),ce=!$e||$e.members.length<=1,ie=!!(ye&&!ce&&this.options.crossfade===!0&&!this.path.some(Wz));this.animationProgress=0;let U;this.mixTargetDelta=re=>{const ve=re/1e3;vT($.x,d.x,ve),vT($.y,d.y,ve),this.setTargetDelta($),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(zp(Z,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Vz(this.relativeTarget,this.relativeTargetOrigin,Z,ve),U&&wz(this.relativeTarget,U)&&(this.isProjectionDirty=!1),U||(U=or()),Oo(U,this.relativeTarget)),ye&&(this.animationValues=X,gz(X,k,this.latestValues,ve,ie,ce)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ve},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Zc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nr.update(()=>{dv.hasAnimatedSinceResize=!0,this.currentAnimation=Pz(0,fT,{...d,onUpdate:E=>{this.mixTargetDelta(E),d.onUpdate&&d.onUpdate(E)},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fT),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:E,target:L,layout:k,latestValues:X}=d;if(!(!E||!L||!k)){if(this!==d&&this.layout&&k&&a2(this.options.animationType,this.layout.layoutBox,k.layoutBox)){L=this.target||or();const $=fo(this.layout.layoutBox.x);L.x.min=d.target.x.min,L.x.max=L.x.min+$;const Z=fo(this.layout.layoutBox.y);L.y.min=d.target.y.min,L.y.max=L.y.min+Z}Oo(E,L),kd(E,X),Np(this.projectionDeltaWithTransform,this.layoutCorrected,E,X)}}registerSharedNode(d,E){this.sharedNodes.has(d)||this.sharedNodes.set(d,new Az),this.sharedNodes.get(d).add(E);const k=E.options.initialPromotionConfig;E.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(E):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var d;const{layoutId:E}=this.options;return E?((d=this.getStack())===null||d===void 0?void 0:d.lead)||this:this}getPrevLead(){var d;const{layoutId:E}=this.options;return E?(d=this.getStack())===null||d===void 0?void 0:d.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:E,preserveFollowOpacity:L}={}){const k=this.getStack();k&&k.promote(this,L),d&&(this.projectionDelta=void 0,this.needsReset=!0),E&&this.setOptions({transition:E})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetSkewAndRotation(){const{visualElement:d}=this.options;if(!d)return;let E=!1;const{latestValues:L}=d;if((L.rotate||L.rotateX||L.rotateY||L.rotateZ||L.skewX||L.skewY)&&(E=!0),!E)return;const k={};for(let X=0;X<nx.length;X++)pT(`rotate${nx[X]}`,d,k,this.animationValues),pT(`skew${nx[X]}`,d,k,this.animationValues);d.render();for(const X in k)d.setStaticValue(X,k[X]),this.animationValues&&(this.animationValues[X]=k[X]);d.scheduleRender()}getProjectionStyles(d){var E,L;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Rz;const k={visibility:""},X=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,k.opacity="",k.pointerEvents=uv(d==null?void 0:d.pointerEvents)||"",k.transform=X?X(this.latestValues,""):"none",k;const $=this.getLead();if(!this.projectionDelta||!this.layout||!$.target){const ye={};return this.options.layoutId&&(ye.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,ye.pointerEvents=uv(d==null?void 0:d.pointerEvents)||""),this.hasProjected&&!nh(this.latestValues)&&(ye.transform=X?X({},""):"none",this.hasProjected=!1),ye}const Z=$.animationValues||$.latestValues;this.applyTransformsToTarget(),k.transform=dT(this.projectionDeltaWithTransform,this.treeScale,Z),X&&(k.transform=X(Z,k.transform));const{x:ge,y:be}=this.projectionDelta;k.transformOrigin=`${ge.origin*100}% ${be.origin*100}% 0`,$.animationValues?k.opacity=$===this?(L=(E=Z.opacity)!==null&&E!==void 0?E:this.latestValues.opacity)!==null&&L!==void 0?L:1:this.preserveOpacity?this.latestValues.opacity:Z.opacityExit:k.opacity=$===this?Z.opacity!==void 0?Z.opacity:"":Z.opacityExit!==void 0?Z.opacityExit:0;for(const ye in kv){if(Z[ye]===void 0)continue;const{correct:$e,applyTo:ce}=kv[ye],ie=k.transform==="none"?Z[ye]:$e(Z[ye],$);if(ce){const U=ce.length;for(let re=0;re<U;re++)k[ce[re]]=ie}else k[ye]=ie}return this.options.layoutId&&(k.pointerEvents=$===this?uv(d==null?void 0:d.pointerEvents)||"":"none"),k}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var E;return(E=d.currentAnimation)===null||E===void 0?void 0:E.stop()}),this.root.nodes.forEach(mT),this.root.sharedNodes.clear()}}}function Iz(t){t.updateLayout()}function Lz(t){var i;const r=((i=t.resumeFrom)===null||i===void 0?void 0:i.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:o,measuredBox:p}=t.layout,{animationType:y}=t.options,d=r.source!==t.layout.source;y==="size"?Fo($=>{const Z=d?r.measuredBox[$]:r.layoutBox[$],ge=fo(Z);Z.min=o[$].min,Z.max=Z.min+ge}):a2(y,r.layoutBox,o)&&Fo($=>{const Z=d?r.measuredBox[$]:r.layoutBox[$],ge=fo(o[$]);Z.max=Z.min+ge,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[$].max=t.relativeTarget[$].min+ge)});const E=Bd();Np(E,o,r.layoutBox);const L=Bd();d?Np(L,t.applyTransform(p,!0),r.measuredBox):Np(L,o,r.layoutBox);const k=!r2(E);let X=!1;if(!t.resumeFrom){const $=t.getClosestProjectingParent();if($&&!$.resumeFrom){const{snapshot:Z,layout:ge}=$;if(Z&&ge){const be=or();zp(be,r.layoutBox,Z.layoutBox);const ye=or();zp(ye,o,ge.layoutBox),s2(be,ye)||(X=!0),$.options.layoutRoot&&(t.relativeTarget=ye,t.relativeTargetOrigin=be,t.relativeParent=$)}}}t.notifyListeners("didUpdate",{layout:o,snapshot:r,delta:L,layoutDelta:E,hasLayoutChanged:k,hasRelativeTargetChanged:X})}else if(t.isLead()){const{onExitComplete:o}=t.options;o&&o()}t.options.transition=void 0}function Oz(t){ih.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Fz(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Bz(t){t.clearSnapshot()}function mT(t){t.clearMeasurements()}function kz(t){t.isLayoutDirty=!1}function Uz(t){const{visualElement:i}=t.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),t.resetTransform()}function gT(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Nz(t){t.resolveTargetDelta()}function zz(t){t.calcProjection()}function Gz(t){t.resetSkewAndRotation()}function Hz(t){t.removeLeadSnapshot()}function vT(t,i,r){t.translate=ji(i.translate,0,r),t.scale=ji(i.scale,1,r),t.origin=i.origin,t.originPoint=i.originPoint}function yT(t,i,r,o){t.min=ji(i.min,r.min,o),t.max=ji(i.max,r.max,o)}function Vz(t,i,r,o){yT(t.x,i.x,r.x,o),yT(t.y,i.y,r.y,o)}function Wz(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const jz={duration:.45,ease:[.4,0,.1,1]},_T=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),xT=_T("applewebkit/")&&!_T("chrome/")?Math.round:Zr;function bT(t){t.min=xT(t.min),t.max=xT(t.max)}function Xz(t){bT(t.x),bT(t.y)}function a2(t,i,r){return t==="position"||t==="preserve-aspect"&&!cb(hT(i),hT(r),.2)}const Yz=o2({attachResizeListener:(t,i)=>Ll(t,"resize",i),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ix={current:void 0},l2=o2({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!ix.current){const t=new Yz({});t.mount(window),t.setOptions({layoutScroll:!0}),ix.current=t}return ix.current},resetTransform:(t,i)=>{t.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Qz={pan:{Feature:uz},drag:{Feature:cz,ProjectionNode:l2,MeasureLayout:t2}},fb={current:null},c2={current:!1};function Kz(){if(c2.current=!0,!!fw)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),i=()=>fb.current=t.matches;t.addListener(i),i()}else fb.current=!1}function qz(t,i,r){const{willChange:o}=i;for(const p in i){const y=i[p],d=r[p];if(fs(y))t.addValue(p,y),Hv(o)&&o.add(p);else if(fs(d))t.addValue(p,cm(y,{owner:t})),Hv(o)&&o.remove(p);else if(d!==y)if(t.hasValue(p)){const E=t.getValue(p);!E.hasAnimated&&E.set(y)}else{const E=t.getStaticValue(p);t.addValue(p,cm(E!==void 0?E:y,{owner:t}))}}for(const p in r)i[p]===void 0&&t.removeValue(p);return i}const wT=new WeakMap,Zz=[...bR,hs,Jc],Jz=t=>Zz.find(xR(t)),u2=Object.keys(am),$z=u2.length,AT=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],e4=yw.length;class t4{constructor({parent:i,props:r,presenceContext:o,reducedMotionConfig:p,blockInitialAnimation:y,visualState:d},E={}){this.resolveKeyframes=(Z,ge,be,ye)=>new this.KeyframeResolver(Z,ge,be,ye,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Rw,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Nr.render(this.render,!1,!0);const{latestValues:L,renderState:k}=d;this.latestValues=L,this.baseTarget={...L},this.initialValues=r.initial?{...L}:{},this.renderState=k,this.parent=i,this.props=r,this.presenceContext=o,this.depth=i?i.depth+1:0,this.reducedMotionConfig=p,this.options=E,this.blockInitialAnimation=!!y,this.isControllingVariants=d0(r),this.isVariantNode=KP(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:X,...$}=this.scrapeMotionValuesFromProps(r,{});for(const Z in $){const ge=$[Z];L[Z]!==void 0&&fs(ge)&&(ge.set(L[Z],!1),Hv(X)&&X.add(Z))}}scrapeMotionValuesFromProps(i,r){return{}}mount(i){this.current=i,wT.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),c2.current||Kz(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fb.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wT.delete(this.current),this.projection&&this.projection.unmount(),Zc(this.notifyUpdate),Zc(this.render),this.valueSubscriptions.forEach(i=>i()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const i in this.events)this.events[i].clear();for(const i in this.features)this.features[i].unmount();this.current=null}bindToMotionValue(i,r){const o=xh.has(i),p=r.on("change",d=>{this.latestValues[i]=d,this.props.onUpdate&&Nr.preRender(this.notifyUpdate),o&&this.projection&&(this.projection.isTransformDirty=!0)}),y=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(i,()=>{p(),y(),r.owner&&r.stop()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}loadFeatures({children:i,...r},o,p,y){let d,E;for(let L=0;L<$z;L++){const k=u2[L],{isEnabled:X,Feature:$,ProjectionNode:Z,MeasureLayout:ge}=am[k];Z&&(d=Z),X(r)&&(!this.features[k]&&$&&(this.features[k]=new $(this)),ge&&(E=ge))}if((this.type==="html"||this.type==="svg")&&!this.projection&&d){this.projection=new d(this.latestValues,this.parent&&this.parent.projection);const{layoutId:L,layout:k,drag:X,dragConstraints:$,layoutScroll:Z,layoutRoot:ge}=r;this.projection.setOptions({layoutId:L,layout:k,alwaysMeasureLayout:!!X||$&&Od($),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof k=="string"?k:"both",initialPromotionConfig:y,layoutScroll:Z,layoutRoot:ge})}return E}updateFeatures(){for(const i in this.features){const r=this.features[i];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):or()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,r){this.latestValues[i]=r}update(i,r){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let o=0;o<AT.length;o++){const p=AT[o];this.propEventSubscriptions[p]&&(this.propEventSubscriptions[p](),delete this.propEventSubscriptions[p]);const y=i["on"+p];y&&(this.propEventSubscriptions[p]=this.on(p,y))}this.prevMotionValues=qz(this,this.scrapeMotionValuesFromProps(i,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(i=!1){if(i)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const o=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(o.initial=this.props.initial),o}const r={};for(let o=0;o<e4;o++){const p=yw[o],y=this.props[p];(om(y)||y===!1)&&(r[p]=y)}return r}addVariantChild(i){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(i),()=>r.variantChildren.delete(i)}addValue(i,r){r!==this.values.get(i)&&(this.removeValue(i),this.bindToMotionValue(i,r)),this.values.set(i,r),this.latestValues[i]=r.get()}removeValue(i){this.values.delete(i);const r=this.valueSubscriptions.get(i);r&&(r(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,r){if(this.props.values&&this.props.values[i])return this.props.values[i];let o=this.values.get(i);return o===void 0&&r!==void 0&&(o=cm(r===null?void 0:r,{owner:this}),this.addValue(i,o)),o}readValue(i,r){var o;let p=this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:(o=this.getBaseTargetFromProps(this.props,i))!==null&&o!==void 0?o:this.readValueFromInstance(this.current,i,this.options);return p!=null&&(typeof p=="string"&&(yR(p)||gR(p))?p=parseFloat(p):!Jz(p)&&Jc.test(r)&&(p=PR(i,r)),this.setBaseTarget(i,fs(p)?p.get():p)),fs(p)?p.get():p}setBaseTarget(i,r){this.baseTarget[i]=r}getBaseTarget(i){var r,o;const{initial:p}=this.props,y=typeof p=="string"||typeof p=="object"?(o=Cw(this.props,p,(r=this.presenceContext)===null||r===void 0?void 0:r.custom))===null||o===void 0?void 0:o[i]:void 0;if(p&&y!==void 0)return y;const d=this.getBaseTargetFromProps(this.props,i);return d!==void 0&&!fs(d)?d:this.initialValues[i]!==void 0&&y===void 0?void 0:this.baseTarget[i]}on(i,r){return this.events[i]||(this.events[i]=new zw),this.events[i].add(r)}notify(i,...r){this.events[i]&&this.events[i].notify(...r)}}class h2 extends t4{constructor(){super(...arguments),this.KeyframeResolver=RR}sortInstanceNodePosition(i,r){return i.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(i,r){return i.style?i.style[r]:void 0}removeValueFromRenderState(i,{vars:r,style:o}){delete r[i],delete o[i]}}function n4(t){return window.getComputedStyle(t)}class i4 extends h2{constructor(){super(...arguments),this.type="html"}readValueFromInstance(i,r){if(xh.has(r)){const o=Iw(r);return o&&o.default||0}else{const o=n4(i),p=($P(r)?o.getPropertyValue(r):o[r])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(i,{transformPagePoint:r}){return $R(i,r)}build(i,r,o,p){Aw(i,r,o,p.transformTemplate)}scrapeMotionValuesFromProps(i,r){return Tw(i,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;fs(i)&&(this.childSubscription=i.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(i,r,o,p){rR(i,r,o,p)}}class r4 extends h2{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(i,r){return i[r]}readValueFromInstance(i,r){if(xh.has(r)){const o=Iw(r);return o&&o.default||0}return r=sR.has(r)?r:mw(r),i.getAttribute(r)}measureInstanceViewportBox(){return or()}scrapeMotionValuesFromProps(i,r){return aR(i,r)}build(i,r,o,p){Mw(i,r,o,this.isSVGTag,p.transformTemplate)}renderInstance(i,r,o,p){oR(i,r,o,p)}mount(i){this.isSVGTag=Ew(i.tagName),super.mount(i)}}const s4=(t,i)=>xw(t)?new r4(i,{enableHardwareAcceleration:!1}):new i4(i,{enableHardwareAcceleration:!0}),o4={layout:{ProjectionNode:l2,MeasureLayout:t2}},a4={...VN,...tU,...Qz,...o4},fa=h3((t,i)=>H3(t,i,a4,s4));function d2(){const t=pt.useRef(!1);return pw(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function l4(){const t=d2(),[i,r]=pt.useState(0),o=pt.useCallback(()=>{t.current&&r(i+1)},[i]);return[pt.useCallback(()=>Nr.postRender(o),[o]),i]}class c4 extends pt.Component{getSnapshotBeforeUpdate(i){const r=this.props.childRef.current;if(r&&i.isPresent&&!this.props.isPresent){const o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u4({children:t,isPresent:i}){const r=pt.useId(),o=pt.useRef(null),p=pt.useRef({width:0,height:0,top:0,left:0}),{nonce:y}=pt.useContext(dw);return pt.useInsertionEffect(()=>{const{width:d,height:E,top:L,left:k}=p.current;if(i||!o.current||!d||!E)return;o.current.dataset.motionPopId=r;const X=document.createElement("style");return y&&(X.nonce=y),document.head.appendChild(X),X.sheet&&X.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${E}px !important;
            top: ${L}px !important;
            left: ${k}px !important;
          }
        `),()=>{document.head.removeChild(X)}},[i]),pt.createElement(c4,{isPresent:i,childRef:o,sizeRef:p},pt.cloneElement(t,{ref:o}))}const rx=({children:t,initial:i,isPresent:r,onExitComplete:o,custom:p,presenceAffectsLayout:y,mode:d})=>{const E=lR(h4),L=pt.useId(),k=pt.useMemo(()=>({id:L,initial:i,isPresent:r,custom:p,onExitComplete:X=>{E.set(X,!0);for(const $ of E.values())if(!$)return;o&&o()},register:X=>(E.set(X,!1),()=>E.delete(X))}),y?void 0:[r]);return pt.useMemo(()=>{E.forEach((X,$)=>E.set($,!1))},[r]),pt.useEffect(()=>{!r&&!E.size&&o&&o()},[r]),d==="popLayout"&&(t=pt.createElement(u4,{isPresent:r},t)),pt.createElement(u0.Provider,{value:k},t)};function h4(){return new Map}function d4(t){return pt.useEffect(()=>()=>t(),[])}const rh=t=>t.key||"";function f4(t,i){t.forEach(r=>{const o=rh(r);i.set(o,r)})}function p4(t){const i=[];return pt.Children.forEach(t,r=>{pt.isValidElement(r)&&i.push(r)}),i}const um=({children:t,custom:i,initial:r=!0,onExitComplete:o,exitBeforeEnter:p,presenceAffectsLayout:y=!0,mode:d="sync"})=>{const E=pt.useContext(_w).forceRender||l4()[0],L=d2(),k=p4(t);let X=k;const $=pt.useRef(new Map).current,Z=pt.useRef(X),ge=pt.useRef(new Map).current,be=pt.useRef(!0);if(pw(()=>{be.current=!1,f4(k,ge),Z.current=X}),d4(()=>{be.current=!0,ge.clear(),$.clear()}),be.current)return pt.createElement(pt.Fragment,null,X.map(ie=>pt.createElement(rx,{key:rh(ie),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:y,mode:d},ie)));X=[...X];const ye=Z.current.map(rh),$e=k.map(rh),ce=ye.length;for(let ie=0;ie<ce;ie++){const U=ye[ie];$e.indexOf(U)===-1&&!$.has(U)&&$.set(U,void 0)}return d==="wait"&&$.size&&(X=[]),$.forEach((ie,U)=>{if($e.indexOf(U)!==-1)return;const re=ge.get(U);if(!re)return;const ve=ye.indexOf(U);let Be=ie;if(!Be){const Ge=()=>{$.delete(U);const Ie=Array.from(ge.keys()).filter(Ct=>!$e.includes(Ct));if(Ie.forEach(Ct=>ge.delete(Ct)),Z.current=k.filter(Ct=>{const vt=rh(Ct);return vt===U||Ie.includes(vt)}),!$.size){if(L.current===!1)return;E(),o&&o()}};Be=pt.createElement(rx,{key:rh(re),isPresent:!1,onExitComplete:Ge,custom:i,presenceAffectsLayout:y,mode:d},re),$.set(U,Be)}X.splice(ve,0,Be)}),X=X.map(ie=>{const U=ie.key;return $.has(U)?ie:pt.createElement(rx,{key:rh(ie),isPresent:!0,presenceAffectsLayout:y,mode:d},ie)}),pt.createElement(pt.Fragment,null,$.size?X:X.map(ie=>pt.cloneElement(ie)))},m4=[Tn.State1,Tn.State2,Tn.State3,Tn.State4],g4=["SU7","","",""];function v4(){const[t,i]=pt.useState(Tn.Loading),[r,o]=pt.useState(!1);return pt.useEffect(()=>{const p=d=>{i(d)},y=d=>{o(d)};return Lt.on(Lt.UPDATESHOWINGSTATE,p),Lt.on(Lt.CLICKEFFECT,y),()=>{Lt.off(Lt.UPDATESHOWINGSTATE,p),Lt.off(Lt.CLICKEFFECT,y)}},[]),Xe.jsx(Xe.Fragment,{children:Xe.jsx("div",{className:"StateTable-container",style:{opacity:r?0:1,transition:"all,0.5s"},children:Xe.jsx(um,{mode:"popLayout",children:t!=Tn.BeginAnim&&t!=Tn.Loading&&Xe.jsxs(fa.div,{className:"StateTable-content",initial:{x:10,opacity:0},animate:{x:0,opacity:1},exit:{x:-10,opacity:0},transition:{duration:.5},children:[Xe.jsx("div",{className:"backgroundLine"}),m4.map((p,y)=>Xe.jsxs("div",{className:"item",style:{backgroundColor:p==t?"rgb(255, 146, 69)":""},onClick:()=>{!Lt.isInClickEffect&&p!=t&&Lt.emit(Lt.UPDATESHOWINGSTATE,p)},children:[p==t&&Xe.jsx("div",{className:"item-Line"}),Xe.jsx("div",{className:"tableName",children:Xe.jsx("div",{style:{color:p==t?"#fff":"",fontSize:p==t?"0.9rem":""},children:g4[y]})}),Xe.jsx("div",{className:"clickBox"})]},y))]})})})})}function y4(){const t=pt.useRef(null),[i,r]=pt.useState(0);return pt.useEffect(()=>{let o=0,p=!1;const y=setInterval(()=>{o=UP.damp(o,Lt.loading,.016,1),o>=.99&&(o=1),r(o),p&&o>=1&&(p=!1,t.current.style.transition="opacity 600ms cubic-bezier(0,0,.58,1)",t.current.style.opacity="0",setTimeout(()=>t.current.style.display="none",600))}),d=()=>{p=!0};return Lt.reset(),Lt.on(Lt.PRELOADED,d),()=>{clearInterval(y),Lt.clear()}},[]),Xe.jsxs("aside",{id:"preloader",ref:t,children:[Xe.jsx("div",{className:"progress-bar",children:Xe.jsxs("svg",{className:"progress-bar-svg",viewBox:"0 0 1709.0400390625 323.0625",fill:"none",children:[Xe.jsx("path",{className:"speed-line",id:"process",d:"M2.30809 318.07Q21.0208 316.441 50.1395 311.552Q108.449 301.761 160.401 285.447Q187.503 276.937 211.151 264.212Q225.389 256.551 250.01 240.238Q275.87 223.104 291.318 214.863Q317.146 201.086 347.378 191.695Q407.665 172.97 460.721 167.081Q495.936 163.173 558.47 163.173Q585.817 163.173 628.557 141.714Q654.353 128.763 708.923 94.4123Q742.671 73.1683 758.993 63.6874Q786.229 47.8662 806.111 39.6039Q862.305 16.252 914.714 7.87042Q961.797 0.340553 1040.78 0.0125411Q1117.18 -0.304734 1171.71 7.40653Q1227.48 15.2934 1289.78 35.6259Q1321.15 45.8667 1370.62 65.0861Q1407.99 79.6092 1425.84 85.4202Q1454.72 94.8298 1481 99.0339Q1520.17 105.3 1617.15 102.785Q1665.69 101.526 1706.36 99.0087C1706.42 99.0046 1706.48 99.0025 1706.54 99.0025C1707.92 99.0025 1709.04 100.122 1709.04 101.503C1709.04 102.838 1707.99 103.928 1706.68 103.999Q1665.91 106.522 1617.28 107.783Q1519.84 110.31 1480.22 103.971Q1453.55 99.7051 1424.29 90.1744Q1406.31 84.3207 1368.81 69.7466Q1319.47 50.5771 1288.22 40.3791Q1226.35 20.1827 1171.01 12.3573Q1116.83 4.69672 1040.8 5.0125Q962.205 5.3389 915.504 12.8077Q863.678 21.0959 808.029 44.2211Q788.454 52.356 761.504 68.0109Q745.26 77.4469 711.586 98.6438Q656.812 133.123 630.801 146.182Q587.002 168.173 558.47 168.173Q496.212 168.173 461.273 172.051Q408.69 177.886 348.862 196.47Q319.081 205.72 293.672 219.274Q278.433 227.403 252.771 244.406Q227.96 260.845 213.52 268.615Q189.453 281.565 161.899 290.218Q109.617 306.635 50.9674 316.483Q21.6568 321.404 2.74708 323.05C2.6658 323.058 2.58338 323.063 2.5 323.063C1.11929 323.063 0 321.943 0 320.563C0 319.246 1.01704 318.168 2.30809 318.07Z"}),Xe.jsx("defs",{children:Xe.jsxs("linearGradient",{xmlns:"http://www.w3.org/2000/svg",id:"linear_0",x1:"0.14628095304966532%",y1:"50%",x2:"99.85371904695035%",y2:"50%",gradientUnits:"objectBoundingBox",children:[Xe.jsx("stop",{offset:"0",stopColor:"#000000",stopOpacity:"0"}),Xe.jsx("stop",{offset:.2341*i,stopColor:"#FFFFFF",stopOpacity:"0.44"}),Xe.jsx("stop",{offset:.5278*i,stopColor:"#FFFFFF",stopOpacity:"1"}),Xe.jsx("stop",{offset:.7698*i,stopColor:"#FFFFFF",stopOpacity:"0.49"}),Xe.jsx("stop",{offset:1*i,stopColor:"#000000",stopOpacity:"0"})]})})]})}),Xe.jsx("div",{className:"progress-num",children:Xe.jsxs("p",{children:[Math.floor(i*100),"%"]})}),Xe.jsx("div",{className:"version",children:vi.VERSION})]})}function _4(){const[t,i]=pt.useState(Tn.Loading),[r,o]=pt.useState(!1);return pt.useEffect(()=>{const p=d=>{i(d)},y=d=>{o(d)};return Lt.on(Lt.UPDATESHOWINGSTATE,p),Lt.on(Lt.CLICKEFFECT,y),()=>{Lt.off(Lt.UPDATESHOWINGSTATE,p),Lt.off(Lt.CLICKEFFECT,y)}},[]),Xe.jsx(Xe.Fragment,{children:uw()?Xe.jsx("div",{className:"TopInfo-container",style:{opacity:r?0:1},children:Xe.jsxs(um,{mode:"popLayout",children:[t==Tn.State1&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("img",{src:`${vi.autoURL("res/icon/xiaomi_su7.webp")}`,alt:"",style:{width:"50vmin",marginTop:"10vmin"}}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fffb",fontSize:"3vmin"},children:"C "})]},"s1"),t==Tn.State2&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"6vmin",color:"rgba(240, 198, 159, 1)",fontSize:"3vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fff",fontSize:"3vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"2.5vmin"},children:"Xiaomi SU7 "}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"2.5vmin"},children:""})]},"s2"),t==Tn.State3&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fff",fontSize:"2.5vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"rgba(240, 198, 159, 1)",fontSize:"5vmin"},children:"Cd 0.195"}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"2.5vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"2.5vmin"},children:" 1000  300"}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"2.5vmin"},children:" Cd0.195 "})]},"s3"),t==Tn.State4&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"0vmin",color:"rgba(240, 198, 159, 1)",fontSize:"3vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fff",fontSize:"3vmin"},children:"XiaomiPilot"}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"2.5vmin"},children:" NVIDIA DRIVE Orin  508 TOPS"}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"2.5vmin"},children:""}),Xe.jsxs("div",{className:"addon",children:[Xe.jsxs("div",{style:{marginTop:"10vmin"},children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x1"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x11"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x3"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x12"})]})]})]},"s4")]})},"t1"):Xe.jsx("div",{className:"TopInfo-container",style:{opacity:r?0:1},children:Xe.jsxs(um,{mode:"popLayout",children:[t==Tn.State1&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("img",{src:`${vi.autoURL("res/icon/xiaomi_su7.webp")}`,alt:"",style:{width:"40vmin",marginTop:"10vmin"}}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fffb",fontSize:"2vmin"},children:"C "})]},"s1"),t==Tn.State2&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"6vmin",color:"rgba(240, 198, 159, 1)",fontSize:"2vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fff",fontSize:"2vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"1.4vmin"},children:"Xiaomi SU7 "}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"1.4vmin"},children:""})]},"s2"),t==Tn.State3&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"4vmin",color:"#fff",fontSize:"1.6vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"rgba(240, 198, 159, 1)",fontSize:"4vmin"},children:"Cd 0.195"}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"1.6vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"1.6vmin"},children:" 1000  300"}),Xe.jsx("div",{style:{marginTop:"1.2vmin",color:"#fff",fontSize:"1.6vmin"},children:" Cd0.195 "})]},"s3"),t==Tn.State4&&Xe.jsxs(fa.div,{className:"TopInfo-content",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:[Xe.jsx("div",{style:{marginTop:"4vmin",color:"rgba(240, 198, 159, 1)",fontSize:"1.8vmin"},children:""}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#fff",fontSize:"2vmin"},children:"XiaomiPilot"}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"1.4vmin"},children:" NVIDIA DRIVE Orin  508 TOPS"}),Xe.jsx("div",{style:{marginTop:"2vmin",color:"#aaa",fontSize:"1.4vmin"},children:""}),Xe.jsxs("div",{className:"addon",style:{fontSize:"2vmin"},children:[Xe.jsxs("div",{style:{marginTop:"10vmin"},children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x1"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x11"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x3"})]}),Xe.jsxs("div",{children:[Xe.jsx("div",{children:""}),Xe.jsx("div",{style:{color:"rgba(255, 146, 69, 1)"},children:"x12"})]})]})]},"s4")]})},"t2")})}const x4=[{col:new bi("#25d6e9").convertSRGBToLinear(),bgUrl:"c1.png"},{col:new bi("#7c8670").convertSRGBToLinear(),bgUrl:"c2.png"},{col:new bi("#bababa").convertSRGBToLinear(),bgUrl:"c3.png"},{col:new bi("#645A64").convertSRGBToLinear(),bgUrl:"c4.png"},{col:new bi("#B3A0AC").convertSRGBToLinear(),bgUrl:"c5.png"},{col:new bi("#FF8E42").convertSRGBToLinear(),bgUrl:"c6.png"},{col:new bi("#CF9C33").convertSRGBToLinear(),bgUrl:"c7.png"},{col:new bi("#FFFFFF").convertSRGBToLinear(),bgUrl:"c8.png",tcar:Ne.ut_car_body_t_gm},{col:new bi("#FFFFFF").convertSRGBToLinear(),bgUrl:"c9.png",tcar:Ne.ut_car_body_t_cat}];function b4(){const[t,i]=pt.useState(Tn.Loading),[r,o]=pt.useState(!1),[p,y]=pt.useState("0");return pt.useEffect(()=>{const d=L=>{i(L)},E=L=>{o(L)};return Lt.on(Lt.UPDATESHOWINGSTATE,d),Lt.on(Lt.CLICKEFFECT,E),()=>{Lt.off(Lt.UPDATESHOWINGSTATE,d),Lt.off(Lt.CLICKEFFECT,E)}},[]),Xe.jsx(Xe.Fragment,{children:Xe.jsxs("div",{style:{opacity:r?0:1,transition:"all 0.3s"},children:[Xe.jsx(um,{mode:"popLayout",children:t!=Tn.BeginAnim&&t!=Tn.Loading&&Xe.jsx(fa.img,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.5},src:`${vi.autoURL("res/icon/logo.png")}`,alt:"",style:{position:"absolute",height:uw()?"2rem":"5vmin",top:"5vmin",left:"5vmin"}})}),Xe.jsx(um,{mode:"popLayout",children:t!=Tn.BeginAnim&&t!=Tn.Loading&&Xe.jsx(fa.div,{className:"ColorBar-container",initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.5},children:Xe.jsx("div",{className:"ColorBar-content",children:x4.map((d,E)=>Xe.jsx("div",{className:"Bar",style:{backgroundImage:`url(${vi.autoURL("res/icon/"+d.bgUrl)})`},onClick:()=>{Lt.emit(Lt.CHANGECOLOR,d.col,d.tcar),y(E.toString())},children:p==E.toString()&&Xe.jsx("div",{className:"Bar-Line"})},E))})})})]})})}function w4(){return pt.useEffect(()=>{const t=document.getElementById("custom-cursor"),i=document.getElementById("custom-cursor-inner"),r=document.getElementById("custom-cursor-outer"),o=d=>{t.style.display="flex",dk()?(t.style.top=window.innerWidth-d.clientX+"px",t.style.left=d.clientY+"px"):(t.style.left=d.clientX+"px",t.style.top=d.clientY+"px")},p=()=>{i.style.width="1rem",i.style.height="1rem",i.style.backgroundColor="rgb(255, 146, 69)",r.style.boxShadow="0 0 0 0.5px rgb(255, 146, 69)",r.style.width=1.8+"rem",r.style.height=1.8+"rem"},y=()=>{i.style.width="4px",i.style.height="4px",i.style.backgroundColor="#fff",r.style.boxShadow="0 0 0 0.5px #fff",r.style.width="2rem",r.style.height="2rem"};return document.addEventListener("pointermove",o),document.addEventListener("pointerdown",p),document.addEventListener("pointerup",y),()=>{document.removeEventListener("pointermove",o),document.addEventListener("pointerdown",p),document.addEventListener("pointerup",y)}},[]),Xe.jsxs("div",{id:"custom-cursor",children:[Xe.jsx("div",{id:"custom-cursor-outer"}),Xe.jsx("div",{id:"custom-cursor-inner"})]})}function A4(){return Xe.jsx("div",{className:"Logo-container",onClick:()=>{window.open("https://x.com/@theawesomesites")},children:Xe.jsxs("div",{className:"Logo-content",children:[Xe.jsx("p",{style:{marginRight:"0.4rem",fontWeight:"300"},children:"Share by"}),Xe.jsx("p",{style:{color:"rgba(255, 141, 26, 1)",fontWeight:"600"},children:"AwesomeSites"})]})})}function S4(){return Xe.jsxs(Xe.Fragment,{children:[Xe.jsx(y4,{}),Xe.jsx(Jk,{}),Xe.jsx(v4,{}),Xe.jsx(_4,{}),Xe.jsx(b4,{}),!uw()&&Xe.jsx(w4,{}),Xe.jsx(A4,{})]})}sx.createRoot(document.getElementById("root")).render(Xe.jsx(yb.StrictMode,{children:Xe.jsx(S4,{})}));
