!function(e){function t(t){for(var i,s,o=t[0],l=t[1],u=t[2],c=0,d=[];c<o.length;c++)s=o[c],r[s]&&d.push(r[s][0]),r[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(h&&h(t);d.length;)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,o=1;o<n.length;o++){var l=n[o];0!==r[l]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},r={app:0},a=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=i);var a,o=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=function(e){return s.p+"version/1611764881753/js/"+e+".js"}(e),a=function(t){l.onerror=l.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+i+": "+a+")");s.type=i,s.request=a,n[1](s)}r[e]=void 0}};var u=setTimeout(function(){a({type:"timeout",target:l})},12e4);l.onerror=l.onload=a,o.appendChild(l)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/intothestorm/",s.oe=function(e){throw console.error(e),e};var o=this.webpackJsonp=this.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var h=l;a.push([253,"vendors"]),n()}(Array(57).concat([function(e){e.exports={b:{XXXSMALL:"(min-width: 0px)",XXSMALL:"(min-width: 480px)",XSMALL:"'(min-width: 480px) and (max-height: 415px)'",SMALL:"'(min-width: 600px) and (min-height: 415px)'",MEDIUM:"(min-width: 960px)",LARGE:"(min-width: 1280px)",XLARGE:"(min-width: 1440px)",XXLARGE:"(min-width: 1920px)",SMALL_HEIGHT:"(max-height: 640px)",SMALL_INVERTED:"(max-width: 599px)"},a:{XXSMALL:0,XSMALL:1,SMALL:2,MEDIUM:3,LARGE:4,XLARGE:5,SMALL_HEIGHT:6}}},,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports={icon:"icon-2zstGlB"}},function(e,t,n){e.exports={intro:"intro-2hc_0RO","skip-button":"skip-button-3Zz_Yv0",skipButton:"skip-button-3Zz_Yv0",icon:"icon-2y6tQ1X",step:"step-1bVpTP8",border:"border-M5YcX2a",show:"show-3oJqKLn","step-1":"step-1-3nHpKyw",step1:"step-1-3nHpKyw","step-1-copy":"step-1-copy-2azSxpX",step1Copy:"step-1-copy-2azSxpX",copy:"copy-2xvlCP0","step-2":"step-2-1ZVNjse",step2:"step-2-1ZVNjse","step-3":"step-3-2CSGVaR",step3:"step-3-2CSGVaR","step-4":"step-4-3LjuChq",step4:"step-4-3LjuChq"}},function(e,t,n){e.exports={"cta-button":"cta-button-1-dPjox",ctaButton:"cta-button-1-dPjox","label-wrapper":"label-wrapper-3i-Fvfc",labelWrapper:"label-wrapper-3i-Fvfc",background:"background-1V-GtN1","hover-state":"hover-state-p9mvRLs",hoverState:"hover-state-p9mvRLs","hover-label":"hover-label-3c7Agbv",hoverLabel:"hover-label-3c7Agbv"}},function(e,t,n){e.exports={landing:"landing-iuQrKNu",content:"content-13rifo5","line-desktop":"line-desktop-LyG8IUa",lineDesktop:"line-desktop-LyG8IUa",cta:"cta-3-0efkK",label:"label-2GisHah",title:"title-1-ij63Y",text:"text-3DL8PfM"}},function(e,t,n){e.exports={"interaction-box":"interaction-box-110HkAc",interactionBox:"interaction-box-110HkAc",borders:"borders-3mMjGGp","tutorial-background":"tutorial-background-hsye3y2",tutorialBackground:"tutorial-background-hsye3y2",top:"top-1pLRhOq",right:"right-2kGAoXM",bottom:"bottom-MvsX4LO",left:"left-1gV6vpR","left-label":"left-label-oOkh_kr",leftLabel:"left-label-oOkh_kr","right-label":"right-label-32-UKfE",rightLabel:"right-label-32-UKfE",tutorial:"tutorial-21rzmHA","tutorial-icon":"tutorial-icon-sEqfyFu",tutorialIcon:"tutorial-icon-sEqfyFu",icon:"icon-2gSgsUQ","tutorial-label":"tutorial-label-2bPaD57",tutorialLabel:"tutorial-label-2bPaD57"}},function(e,t,n){e.exports={"drag-down-interaction":"drag-down-interaction-1oRabue",dragDownInteraction:"drag-down-interaction-1oRabue"}},function(e,t,n){e.exports={rescue:"rescue-2sNWbUN"}},function(e,t,n){e.exports={scroller:"scroller-2wK-Tar",icon:"icon-2pEGnBv"}},function(e,t,n){e.exports={"trek-to-survivors":"trek-to-survivors-XWfru2v",trekToSurvivors:"trek-to-survivors-XWfru2v",scroller:"scroller-3eRVdRe","hotspot-1":"hotspot-1-2-zu_uW",hotspot1:"hotspot-1-2-zu_uW","hotspot-2":"hotspot-2-2abm0lW",hotspot2:"hotspot-2-2abm0lW"}},function(e,t,n){e.exports={"helicopter-crash":"helicopter-crash-1tlwDjF",helicopterCrash:"helicopter-crash-1tlwDjF","box-popup":"box-popup-1eLuki-",boxPopup:"box-popup-1eLuki-"}},function(e,t,n){e.exports={"drag-up-interaction":"drag-up-interaction-3Xew2Zs",dragUpInteraction:"drag-up-interaction-3Xew2Zs"}},function(e,t,n){e.exports={"airlift-out":"airlift-out-11wC6SX",airliftOut:"airlift-out-11wC6SX","press-hold-button":"press-hold-button-2vxKj7K",pressHoldButton:"press-hold-button-2vxKj7K"}},function(e,t,n){e.exports={"half-turn-interaction":"half-turn-interaction-3xj-dKA",halfTurnInteraction:"half-turn-interaction-3xj-dKA"}},function(e,t,n){e.exports={"first-pickup":"first-pickup-1UH0XxS",firstPickup:"first-pickup-1UH0XxS","bt-continue":"bt-continue-319uRtr",btContinue:"bt-continue-319uRtr","box-popup":"box-popup-1t0Bqsi",boxPopup:"box-popup-1t0Bqsi","drag-slider":"drag-slider-13j8Snq",dragSlider:"drag-slider-13j8Snq",show:"show-Vnbr3nD",scroller:"scroller-12RhP7M"}},function(e,t,n){e.exports={"trek-to-helicopter":"trek-to-helicopter-2ntgP1H",trekToHelicopter:"trek-to-helicopter-2ntgP1H",scroller:"scroller-NfmdKMG"}},function(e,t,n){e.exports={"last-pickup":"last-pickup-1etrXNk",lastPickup:"last-pickup-1etrXNk",scroller:"scroller-2JOEI1v"}},function(e,t,n){e.exports={"full-circle-interaction":"full-circle-interaction-1msVsKd",fullCircleInteraction:"full-circle-interaction-1msVsKd"}},function(e,t,n){e.exports={waiting:"waiting-CuimXDP","press-hold-button":"press-hold-button-334Jhrl",pressHoldButton:"press-hold-button-334Jhrl"}},function(e,t,n){e.exports={conclusion:"conclusion--adpcaY",step:"step-38SuOeA",step2:"step2-2Qpr50p",step3:"step3-3lmrRPL",step4:"step4-172MAar",tag:"tag-KO5lECQ",step1:"step1-3g76wcH",content:"content-3RbiC_S"}},function(e,t,n){e.exports={"end-screen":"end-screen-2H4nvXY",endScreen:"end-screen-2H4nvXY",buttons:"buttons-3Pu5vMj",cta:"cta-1y1ypkJ",knob:"knob-3ZGCnce",subtitle:"subtitle-3LzA5jk",scroller:"scroller-3tCDzD6",wrapper:"wrapper-3ZtHK7E",info:"info-17DD11D",cards:"cards-N9EgYxn","story-card":"story-card-1Q_sHuO",storyCard:"story-card-1Q_sHuO",gradient:"gradient-9NWF9lb","inner-content":"inner-content-3MPOWbY",innerContent:"inner-content-3MPOWbY","thumb-info":"thumb-info-C-rSR1w",thumbInfo:"thumb-info-C-rSR1w","content-info":"content-info-zSC-D6g",contentInfo:"content-info-zSC-D6g",hover:"hover-NlnBGuG",title:"title-2Fel1GE","bt-play":"bt-play-100CJO1",btPlay:"bt-play-100CJO1","icon-play":"icon-play-2R-bp8B",iconPlay:"icon-play-2R-bp8B",content:"content-3gSEVsC"}},function(e,t,n){},function(e,t,n){e.exports={subtitle:"subtitle-1uhgOPZ",line:"line-1sJQVnD",name:"name-O33jOSF"}},function(e,t,n){e.exports={narration:"narration-_mD1uZJ",subtitle:"subtitle-32KHzs3"}},function(e,t,n){e.exports={"rotate-device":"rotate-device-3exSe0F",rotateDevice:"rotate-device-3exSe0F",content:"content-1SzHMow",icon:"icon-3Q3zRJN"}},function(e,t,n){e.exports={"preloader-screen":"preloader-screen-1YjE81K",preloaderScreen:"preloader-screen-1YjE81K",disabled:"disabled-2JrGhlq",logo:"logo-3AvH4J5",content:"content-1FFkknh",description:"description-4gLopNQ",cta:"cta-9W9ZsBh",background:"background-11V0c20","circle-preloader":"circle-preloader-1NPw0Mu",circlePreloader:"circle-preloader-1NPw0Mu","hide-preloader":"hide-preloader-2tSXbYl",hidePreloader:"hide-preloader-2tSXbYl","progress-ring":"progress-ring-23UNDb3",progressRing:"progress-ring-23UNDb3","progress-label":"progress-label-1JHlMpu",progressLabel:"progress-label-1JHlMpu"}},function(e,t,n){e.exports={"story-progress":"story-progress-1TwjEYt",storyProgress:"story-progress-1TwjEYt",progress:"progress-FcDxlDg"}},function(e,t,n){e.exports={"hotspot-button":"hotspot-button-1j53b2j",hotspotButton:"hotspot-button-1j53b2j",icon:"icon-2tD5TSD"}},function(e,t,n){e.exports={"wave-form":"wave-form-2-OE3nu",waveForm:"wave-form-2-OE3nu"}},function(e,t,n){e.exports={"sound-player":"sound-player-bPaqz6S",soundPlayer:"sound-player-bPaqz6S",button:"button-3O-69Xk"}},function(e,t,n){e.exports={hotspot:"hotspot-2Ylldqg",show:"show-n9lF2_d",box:"box-2Grq2pd",speaker:"speaker-3hKzasq",label:"label-2mBajVv","label-close":"label-close-syGerNh",labelClose:"label-close-syGerNh",border:"border-236D5XP",right:"right-nDFBFqj",bottom:"bottom-2rLl52P",left:"left-3cs9aEm",media:"media-3fx5xdc",image:"image-2yWnXkw",top:"top-2tocR5l","close-button-wrapper":"close-button-wrapper-1aIRlNB",closeButtonWrapper:"close-button-wrapper-1aIRlNB",line:"line-1gt3-S-",close:"close-Deh7FJ_",underline:"underline-1Zp5BrC"}},function(e,t,n){e.exports={"mute-button":"mute-button-1JieeZo",muteButton:"mute-button-1JieeZo"}},function(e,t,n){e.exports={"main-page":"main-page-2QHRlQk",mainPage:"main-page-2QHRlQk",header:"header-2vgGzur",menu:"menu-1P7PiRH",sound:"sound-rpO-c8j",logo:"logo-3_90qLs","sound-player":"sound-player-1fAG3fx",soundPlayer:"sound-player-1fAG3fx","preloader-screen":"preloader-screen-vvpaFfY",preloaderScreen:"preloader-screen-vvpaFfY","end-screen":"end-screen-11BhCfT",endScreen:"end-screen-11BhCfT","rotate-device":"rotate-device-1M6HNdq",rotateDevice:"rotate-device-1M6HNdq"}},function(e,t,n){e.exports={"web-g-l-page":"web-g-l-page-2Ya8Mdt",webGLPage:"web-g-l-page-2Ya8Mdt"}},function(e,t,n){},function(e,t,n){e.exports={app:"app-z4A2wMH","no-ie-message":"no-ie-message-QO9K16a",noIeMessage:"no-ie-message-QO9K16a"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(77),r=n.n(i);t.default=r.a},,function(e,t,n){"use strict";var i=n(78),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(79),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(80),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(81),r=n.n(i);t.default=r.a},,function(e,t,n){"use strict";var i=n(82),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(83),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(84),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(85),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(86),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(87),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(88),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(89),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(90),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(91),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(92),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(93),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(94),r=n.n(i);t.default=r.a},,function(e,t,n){"use strict";var i=n(95),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(96),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(97),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(98),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(99),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(100),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(101),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(102),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(103),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(104),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(105),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(106),r=n.n(i);t.default=r.a},,function(e,t,n){"use strict";var i=n(107),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(108),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(109),r=n.n(i);t.default=r.a},function(e,t,n){"use strict";var i=n(110),r=n.n(i);t.default=r.a},,,function(e,t,n){"use strict";var i=n(111),r=n.n(i);t.default=r.a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){n(254),e.exports=n(579)},function(e,t,n){"use strict";n.r(t);n(255),n(257),n(258),n(262),n(263),n(189),n(191),n(267),n(268),n(270),n(271),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(285),n(287),n(200),n(201),n(202),n(289),n(290),n(204),n(292),n(294),n(205),n(206),n(295),n(296),n(298),n(299),n(300),n(301),n(302),n(303),n(207),n(304),n(212),n(309),n(213),n(310),n(311),n(312),n(313),n(314),n(315),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(215),n(218),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(342),n(343),n(344),n(220),n(345);t.default={}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n){function i(e,t){return typeof e===t}var r=[],a={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){r.push({name:e,fn:t,options:n})},addAsyncTest:function(e){r.push({name:null,fn:e})}},s=function(){};s.prototype=a,s=new s;var o=[],l=t.documentElement,u="svg"===l.nodeName.toLowerCase();(function(){var e,t,n,a,l,u;for(var h in r)if(r.hasOwnProperty(h)){if(e=[],(t=r[h]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(a=i(t.fn,"function")?t.fn():t.fn,l=0;l<e.length;l++)1===(u=e[l].split(".")).length?s[u[0]]=a:(!s[u[0]]||s[u[0]]instanceof Boolean||(s[u[0]]=new Boolean(s[u[0]])),s[u[0]][u[1]]=a),o.push((a?"":"no-")+u.join("-"))}})(),function(e){var t=l.className,n=s._config.classPrefix||"";if(u&&(t=t.baseVal),s._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}s._config.enableClasses&&(t+=" "+n+e.join(" "+n),u?l.className.baseVal=t:l.className=t)}(o),delete a.addTest,delete a.addAsyncTest;for(var h=0;h<s._q.length;h++)s._q[h]();e.Modernizr=s}(t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},function(e,t,n){},,function(e,t,n){var i={"./close.svg":352,"./conclusion-bg.svg":353,"./drag-down.svg":354,"./drag-up.svg":355,"./fast-forward.svg":356,"./full-circle.svg":357,"./half-turn.svg":358,"./logo.svg":359,"./play.svg":360,"./sound.svg":361};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=351},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 23"><path fill-rule="evenodd" fill="#FFFFFF" d="M20.539 18.468l-2.368 2.367-7.424-7.424-7.425 7.424-2.367-2.367 7.425-7.425L.955 3.619l2.367-2.367 7.425 7.424 7.424-7.424 2.368 2.367-7.425 7.424 7.425 7.425z"></path></svg>'},function(e,t){e.exports=""},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 57"><defs><linearGradient id="a" x1="0%" x2="0%" y1="100%" y2="0%"><stop offset="0%" stop-color="#FFFFFF"></stop><stop offset="100%" stop-color="#FFFFFF" stop-opacity="0"></stop></linearGradient></defs><path fill-rule="evenodd" fill="#FFFFFF" d="M14.106.065c5.095 0 9.226 4.143 9.226 9.253s-4.131 9.253-9.226 9.253c-5.095 0-9.226-4.143-9.226-9.253S9.011.065 14.106.065z"></path><path fill-rule="evenodd" fill="url(#a)" d="M27.294 43.23L14.102 56.422.909 43.23h8.564V6.913h9.266V43.23h8.555z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 57"><defs><linearGradient id="a" x1="0%" x2="0%" y1="100%" y2="0%"><stop offset="0%" stop-color="#FFFFFF"></stop><stop offset="100%" stop-color="#FFFFFF" stop-opacity="0"></stop></linearGradient></defs><g fill-rule="evenodd"><path fill="#FFFFFF" d="M14.106.065c5.095 0 9.226 4.143 9.226 9.253s-4.131 9.253-9.226 9.253c-5.095 0-9.226-4.143-9.226-9.253S9.011.065 14.106.065z"></path><path fill="url(#a)" d="M27.294 43.23L14.102 56.422.909 43.23h8.564V6.913h9.266V43.23h8.555z"></path></g></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 10.094"><path d="M0 0l7.32 5.048L0 10.1V0zm10 0h2v10h-2V0z" fill="#fff" fill-rule="evenodd"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 38 39"><image width="38" height="39" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABOCAYAAABog+tZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjdFNkYwMEY5NkI2RTExRUFBOEE4RUNERTJEMEI4MEE2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjdFNkYwMEZBNkI2RTExRUFBOEE4RUNERTJEMEI4MEE2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6N0U2RjAwRjc2QjZFMTFFQUE4QThFQ0RFMkQwQjgwQTYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6N0U2RjAwRjg2QjZFMTFFQUE4QThFQ0RFMkQwQjgwQTYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5RQcMjAAAJM0lEQVR42uRcaWwVVRS+b6EsZZFNgSrGBxohiJElAiq4VIyiuLFoIhFQi6jRiEuLPxTBKKgxGjVIjeJGMGAEYgyKBUNcYhVEg4CkUAKKqBELCi104XkOc8bcd5m7zZvXmfc4ydc3r52ZO/3mnHPPOXeJpdNpFiE5DXAB4BTAX4CNgLrIPB2SFQGMAKwDtKQzpQmwAjAwCs8Zi4BmPQRYAEgozjkCmA5YGuaDhk3WXYBKw3NbANcCPjkZyeoNqAEUW1yzF3Au4FAYDxwPUatmWhKFUgK4B9AL0B3QCZA8Gci6zud1V5B/60CE9SUSu+T6/0mGSNYAn9el0H0QMTFCMWkZmvY/FHY0FhJZ8Syui3Hgv6PG9QD0pPhsH6CpEMxwp8/rfuUI4j/5YyTtVMD5pG2xfCdrtc/rvvAgiieMB1rOWZQVdMzn0KE/YCugjcU1BwBjAP+S9iQ4TeKPecISnFLsoPAjMLLwLY0HHOZ+dwxwkPveTA/sSiN3fgNF3CbyBGCOxfNOBSynnhAdejsNWQkPbfsDsIWC3KwdfJrI+RhQ5OMFzAbMNzx3Ljnje3UpLN33bfpeTz1ee0A3CiHiEo0SUUJEbwAcDcJnfQS41Wf3e9gmjwfcB7gFUCs55wfAWMofRWkgs9pCPV9aICohARJ8MZEdmM+aAHhfk+SKghH2Qp+dzXDAEAowUXOqAZst7oH+70xAH7KauAb4Ytebug0TBz8ZsMSCML9kBSmdAYOoB/QyR773xCB2rUk8ZhI6oEnutnjQoyx8QQK+JWcu6zHdYzTJS0xiMROyXqEUw1SOsGgI9tg/ArZ59JAJgbDTAYOzJWsKYBrLb8FM4XsuHZJp2BCK9n2R1c+n7zkWQcL2kFnGFYQlqKLR1pYsfAuv+6g3MSFYjZL8QhrGk5MUvmOHcJEtWRhjXZaj3C5M2Q74WRF/IQYyp7hoRBaq4TOaRlcAxjFnsCHf5DvAfg1hl5qSVcac6qNMMGKeTtHyC5SG5IMZ8j61ip5fRlYJ+WwlWZgLPqppbBZl/65gHvh4xB28l1/doNGukTqyJlPMIZM1gGUev58HeDLPzHETvfSkJPY6Q+Qi6WGCqqRXpXVzKDdryBOy0AK+pPw3xkXw/Ocw5lRmT8gNsRhXo7j5KsANBg9RxHIwWJBDuYNllp75T8wCnndTuLgQLqjkRcPGG/PMHDcq/BZGBgO8fNY4xQ13USmjEGUrmSQfpPJ+7ASyOpN9yuQ98lnmhbJY7Diam5tTgDLAMkCaw2fuOSLgb0OFcxcpzi0Xzi21JKuRAtWkRLv6u6bpkjVGU6/6wPZ1NTU1lQE2UCK7CDDRuILXpg2aBj9hBO+V8mgjxTJL2Mvh2iof2vWTwhQ7uxG9S9ZoxY2wYrnZxwMgOUOzMA8sI/MT2RZ5nCPW+it8trWLq0p4aVg/nqyBihutszVBieCoTK2FdtWyzLp7KWhSKadVpYK2LqBr/AjW4PYptKs3T5Zq3kF1lgTNAHSDf2SSDVkklQrtKueO65j3gIZtVSKpIgv/2E6TC27x0zKQc2W2qgj3qAMNquBISqEvdDVN0Kps557uU/jt/31Wica572QhCpBQSbEQ76d4raqFcxYE0NTfkrQHgeOSSTzoZMB42MI77q4sc0ygIqA2DmoS6+I4U0+YwOGhw2EzReGAV0hQBX9bHlAzDYLPEkvOHfAXXRQ3qI9QpD1DEl4EJUcUWnWcuKSm/lQUIbK8YrZUwG0kuDBJ/IzFmbqy2Z6FOztQFYAeDx+gd+wa0P07aHxWszt8rZKOYbMEhJRLtCilqcHZSEeZ+dFnvQlZvUMmqqsQKmwUnH1Q2tWNyQdgEYfwx14qcskkFbJilVG4wIcKC4RQYn4A7fSSkJSgGKwlTuGBKvA8L0St8qwqUCihrUpYSkoSMsTdWNPNDbcrbjIqRK0qVwSnJlUJGxkk0SrEbzxZqhLMaGY3mS0orSoVnHdGVUFXlbCULlSGkaU7e3iy1mtuNCxkrZJVFSoD0q4hzHvSm0vaZp4sHBJSTUKb1MpaNdGkqkC/400zRWGGrVyhiNz3UyeYMRS2nskrpr8zZ9CxmRWeYNl4FQXfaQ986mo1P7qzStOtXs0KU65iTk0vITHFr90TebKWafLEigIkCrVpisRPJagSUe1FFg5Tr9GEEJcXGFk4VlrC5FO/cfyh0YsslNcMktl4gRCFRYKZTD1PfiV/gfiP4zTuHYoGhgeYuIYtdzNncYFs6QpOeqtRkYU+a56mkadJdfNZcFH6NI1WLRYv8jIpXE2xTdEQJq5Lw4jqA6xb4SSXIgVR3zBnsq6WLFxaNkvTIK5ImJuHRMXIMvox+fIUd/onMyELBTea0A0EPEYOMp8EJ+ONZ+rVr0tkVRjVQicMRHHCRHdF46iFE8ReI6IylTlTOd31lGmPY0zOb2KSJTWqMABTnDs1D5CgYHZKxIl6APAUU68Oa6HkXbr2SBczrWT6GX84jxRXmD4S0QgdfdRsD4LEbQ6e05SqjNYbJimZNInecTEBzpE/EAGicOwAl9RcSKbmZXru54fMYAGE6ep7rGnhFgEmJWac64S7F60NkagbAc8yZxDCixz+GMtTt7OAFmei4DyAsZro3hXcR6GKYrE+rUzS2VQ9eYs5C9VjTL67CB5vohdrtKuI7b4OfYgI031k0Fm+Qf5gdw5Jwsl4DwNupk5HpUnuZzV1TMbLZ/xsgtGT3t5Ii2uaqLNYTGQHsT8MJsLXkAm5c8HSBmaHWE25odUCB787hmCxbCHFLraynzqMdZRW1DCzufPtSKNHETm4xK9YQ4p4jHiJOaverDfByHZ7FSTrVcq3/EozdQo7ySTqSPPaUseCuShOr+4r+FgvQlRk/cmcPSTW+M6VAtiLBt/2O6z1R4DSCpLE72j6uCtJVhPzgijkYYViBODBVo6v+MVJTOj13O+4VcEMSmGynsEY9C5HPShansksty4JWLsOkG96mQW4mWKutoTCnWzvZ05VtUcrkrWbfOibLHNXpkiT5Qo66esBt1FQ2zYHbWCngMtl3mXO2GfOVtK25mZjOCt6NHX5mGcOZv6qrdhTYn38c8JXrJV2KQlzZ7YiCgmwHn4OmW53iqdcqae4DJ0zrtzaTmFGKCPj/wkwAHRvkK/M/p4GAAAAAElFTkSuQmCC"></image></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 84 76"><defs><linearGradient id="a" x1="0%" x2="90.631%" y1="42.262%" y2="0%"><stop offset="0%" stop-color="#FFFFFF"></stop><stop offset="100%" stop-color="#FFFFFF" stop-opacity="0"></stop></linearGradient></defs><path fill-rule="evenodd" fill="#FFFFFF" d="M74.217 24.609a9.13 9.13 0 1 1 0 18.261 9.13 9.13 0 0 1 0-18.261z"></path><path fill-rule="evenodd" fill="url(#a)" d="M38.13 75.913c-10.115 0-19.291-3.965-26.097-10.407l-5.318 5.132.27-15.472 15.481.271-5.053 4.877c5.438 5.022 12.701 8.099 20.69 8.099 16.854 0 30.517-13.65 30.517-30.489h7.499l.001.027c0 20.966-17.009 37.962-37.99 37.962z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 78"><path class="st0" d="M46.5 44.6c0-1.9 1.6-3.5 3.5-3.5s3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5-3.5-1.5-3.5-3.5zM41.2 43.5l-6.4 4.6 7.7 5.6 2.5-7.4-3.8-2.8zm13.9 2.8l2.4 7.4 7.7-5.6-6.3-4.6-3.8 2.8zm-11.4 8.3l6.3 4.6 6.4-4.6-6.4-4.7-6.3 4.7zM46.9 40.3L23.6 23.4l5.5 11.3 7.7 5.6h10.1zm16.4 0l7.7-5.6 5.4-11.3-23.2 16.9h10.1zM49.3 32.9L16.8 9.3l5.5 11.3 25.1 18.2 1.9-5.9zm1.4 0l2 5.9 25.1-18.2 5.4-11.3-32.5 23.6zM21.5 0l-3.9 8 11.8 8.5L21.5 0zm57.1 0l-8 16.5L82.4 8l-3.8-8zM0 70.6h2.5v4.1c0 .4 0 .8.2 1 .3.6 1 .7 1.5.7.7 0 1.1-.2 1.2-.4.4-.4.4-1.1.4-1.4v-4h2.5v3.7c0 .8 0 1.7-.4 2.3-.6 1.3-2.5 1.4-3.7 1.4-1.6 0-2.5-.2-3-.5C.1 76.9 0 75.8 0 75.2v-4.6zm9.1 5.3h2.3v1.9H9.1v-1.9zm6.3-3.5c0 .1 0 .2.1.3.2.2.9.4 1.3.5l1.5.3c.3.1.6.1.9.3 1 .4 1.3 1.1 1.3 1.7 0 .5-.2.9-.4 1.2-.6.9-1.8 1.3-3.7 1.3-.7 0-2.1-.1-3-.8-.6-.5-.7-1.2-.7-1.5l2.5-.1c.1.5.6.8 1.6.8.3 0 .6 0 .9-.2.2-.1.4-.3.4-.5 0-.3-.3-.5-.5-.5-.3-.1-1.9-.4-2.3-.5-.3-.1-.5-.1-.8-.2s-1.4-.5-1.4-1.8c0-.5.2-1 .6-1.4.8-.8 2.2-.9 3-.9.9 0 1.7.1 2.2.3 1.3.4 1.5 1.4 1.6 1.8l-2.5.1c-.1-.2-.2-.7-1.3-.7-.6 0-1.3 0-1.3.5zm5.8 3.5h2.3v1.9h-2.3v-1.9zm11.6-.9h-1.7l.8-2.4.9 2.4zm-5.4 2.7h2.8l.4-1.2h2.7l.4 1.2h2.8l-3.1-7.1h-2.9l-3.1 7.1zM40 70.6v7.1h-2.6v-7.1H40zm4.5 1.6h2.1c.2 0 .5 0 .7.2.1.1.2.3.2.5 0 .6-.6.6-1 .6h-1.9l-.1-1.3zm-2.6 5.5h2.6v-2.6h1.4l1.5 2.6h2.8l-1.8-2.9c.3-.1.8-.2 1.2-.7.3-.4.5-.8.5-1.4 0-.7-.3-1.4-.8-1.8-.6-.4-1.4-.4-2-.5h-5.2v7.3h-.2zm12-7.1h7v1.6h-4.4v1.4h4.1v1.6h-4.1v2.6h-2.6v-7.2zm12.8 1.3c1.7 0 2.1 1.5 2.1 2.2s-.3 1.6-1.1 2c-.3.2-.7.2-1 .2-1.5 0-2.1-1.1-2.1-2.2-.1-.9.5-2.2 2.1-2.2zm-.2-1.6c-1.3 0-3 .3-4 1.7-.5.6-.7 1.4-.7 2.2s.2 1.5.7 2.2 1.5 1.6 4 1.6c1.3 0 2.4-.2 3.4-1 .3-.3.6-.6.8-1 .4-.6.5-1.3.5-1.9 0-1.2-.6-2.7-2.2-3.4-.6-.3-1.6-.4-2.5-.4zm8.9 1.9h2.1c.2 0 .5 0 .7.2.1.1.2.3.2.5 0 .6-.6.6-1 .6h-1.9l-.1-1.3zm-2.6 5.5h2.6v-2.6h1.4l1.5 2.6H81l-1.8-2.9c.3-.1.8-.2 1.2-.7.3-.4.5-.8.5-1.4 0-.7-.3-1.4-.8-1.8-.6-.4-1.4-.4-2-.5h-5.2l-.1 7.3zm12-3.5c0 1.1.6 2.2 2.1 2.2.6 0 1.1-.2 1.4-.5s.4-.5.5-.7l2.4.3c-.1.3-.2.5-.4.9-.8 1.3-2.5 1.7-4 1.7-.7 0-1.4-.1-2-.3-1.5-.5-2.7-1.6-2.7-3.5 0-1.4.7-3.9 4.8-3.9 3.5 0 4 1.6 4.2 2.3l-2.3.3c-.1-.2-.2-.5-.6-.7s-.9-.3-1.2-.3c-1.2-.1-2.2.7-2.2 2.2zm15.1-3.6v1.6h-5v1.2h4.6V75h-4.6v1.1h5.1v1.6h-7.6v-7.1h7.5z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 15"><path fill-rule="evenodd" fill="#000000" d="M.478.103l9.115 7.158-9.115 7.158V.103z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 206 81"><path fill-rule="evenodd" stroke="#FFFFFF" fill="#FFFFFF" d="M198.5 42.687V37.5h5.188v5.187H198.5zM188.094 37.5h5.218v5.187h-5.218V37.5zm-10.407-10.406h5.219v26h-5.219v-26zm-10.374-5.188h5.187v36.407h-5.187V21.906zM156.906 11.5h5.188v57.188h-5.188V11.5zM146.5 1.094h5.188v78H146.5v-78zM136.094 11.5h5.218v57.188h-5.218V11.5zm-10.407 10.406h5.219v36.407h-5.219V21.906zm-10.375 5.188h5.188v26h-5.188v-26zM104.906 37.5h5.188v5.187h-5.188V37.5zm-10.406 0h5.188v5.187H94.5V37.5zM84.094 27.094h5.219v26h-5.219v-26zm-10.407-5.188h5.219v36.407h-5.219V21.906zM63.312 11.5H68.5v57.188h-5.188V11.5zM52.906 1.094h5.188v78h-5.188v-78zM42.5 11.5h5.188v57.188H42.5V11.5zM32.094 21.906h5.219v36.407h-5.219V21.906zm-10.407 5.188h5.219v26h-5.219v-26zM11.312 37.5H16.5v5.187h-5.188V37.5zm-10.406 0h5.188v5.187H.906V37.5z"></path></svg>'},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i={"./default/default.fs.glsl":453,"./default/default.vs.glsl":454};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=452},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nvarying vec2 vUV;\n\nuniform sampler2D uTexture;\t\n\nvoid main(void) {\n\tgl_FragColor = texture2D(uTexture, vUV);\n}"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\tgl_Position = vec4(aPos, 1.0);\n}"},function(e,t,n){var i={"./Heli_Meinte_Shadow.png":456,"./Heli_Meinte_Shadow_original.png":457,"./airplane/plane_basecolor.png":458,"./airplane/plane_metallic_roughness.png":459,"./airplane/plane_normal.png":460,"./airplane/windows_transparency.png":461,"./detail.png":462,"./endscreen/outro_1.png":463,"./endscreen/outro_2.png":464,"./endscreen/outro_3.png":465,"./helicopter/pave_hawk_basecolor.png":466,"./helicopter/pave_hawk_metallic_roughness.png":467,"./helicopter/pave_hawk_normal.png":468,"./hotspot.png":469,"./hotspot_text.png":470,"./into_the_storm.png":471,"./plane_ao.png":472,"./plane_ao_original.png":473,"./us_ariforce_mask.png":474,"./us_ariforce_mask_small.png":475};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=455},function(e,t,n){e.exports=n.p+"version/1611764881753/image/Heli_Meinte_Shadow.924e1fd.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/Heli_Meinte_Shadow_original.b3b0e6f.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_basecolor.8442d50.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_metallic_roughness.29a528d.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_normal.ad944d9.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/windows_transparency.ffd31ce.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/detail.683759b.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_1.9f2ad78.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_2.2265fe1.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_3.06e5565.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_basecolor.3c68cdd.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_metallic_roughness.d1b7480.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_normal.fac2cf1.png"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAYAAADS1n9/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDAzIDc5LjE2NDUyNywgMjAyMC8xMC8xNS0xNzo0ODozMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjEgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzZGNzYxRjkzMzA0MTFFQjg5NjlBNzI3ODE0NjgzNzUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzZGNzYxRkEzMzA0MTFFQjg5NjlBNzI3ODE0NjgzNzUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozNkY3NjFGNzMzMDQxMUVCODk2OUE3Mjc4MTQ2ODM3NSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozNkY3NjFGODMzMDQxMUVCODk2OUE3Mjc4MTQ2ODM3NSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoFFu00AAAEWSURBVHja7N1BboMwEEBRJnA4jszlkKMs2CUWMQKD/d62jdQ6n5FNURoppYF+vSyBABAAAkAACIDOTNmvLmMrZ8QofF0bv/+8hglAwQQ4fgXV5i6XPQACQAAIAAEgAATA//cB8ua1zk+/jN5BEwABIAAEgAAQAI8KIA09/8n286BG5mENE4DTTZagohvcyDIB7AEQAALAJvDMo96R74lHr/B2zMtv+OLL67aNYjIBePQEiB1XfjS7wvkrOH5OwIuOiCaATSACQAAIgOuPiPUeqBUAVx0DS4+I7bvBB3CYAPYACAABIAAEgGNg2XHGSpoACAABIAAEgAAQAO3cB/Cp2yYALQr/ONIEQAAIAAEgAARAT94CDAACvyRFm4uTFwAAAABJRU5ErkJggg=="},function(e,t,n){e.exports=n.p+"version/1611764881753/image/hotspot_text.89fefad.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/into_the_storm.c7b0d35.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_ao.d8aa3a6.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_ao_original.0598021.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/us_ariforce_mask.623f02b.png"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/us_ariforce_mask_small.c96386d.png"},function(e,t,n){var i={"./Heli_Meinte_Shadow.jpg":477,"./airplane/plane_basecolor.jpg":478,"./airplane/plane_metallic_roughness.jpg":479,"./airplane/plane_normal.jpg":480,"./airplane/windows_transparency.jpg":481,"./clouds.jpg":482,"./helicopter/pave_hawk_basecolor.jpg":483,"./helicopter/pave_hawk_metallic_roughness.jpg":484,"./helicopter/pave_hawk_normal.jpg":485,"./hotspot.jpg":486,"./mountain_2k.jpg":487,"./mountain_4k.jpg":488,"./mountain_8k.jpg":489,"./particle.jpg":490,"./plane_ao.jpg":491};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=476},function(e,t,n){e.exports=n.p+"version/1611764881753/image/Heli_Meinte_Shadow.8bfd1e3.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_basecolor.80f6f5e.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_metallic_roughness.f72535e.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_normal.a14457c.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/windows_transparency.af90fcb.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/clouds.a63d599.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_basecolor.5c82485.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_metallic_roughness.03f0d15.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_normal.83a0bf7.jpg"},function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QZKRXhpZgAASUkqAAgAAAACADIBAgAUAAAAJgAAAGmHBAABAAAAOgAAAEAAAAAyMDE5OjAyOjE1IDE0OjEwOjUzAAAAAAAAAAMAAwEEAAEAAAAGAAAAAQIEAAEAAABqAAAAAgIEAAEAAADYBQAAAAAAAP/Y/+AAEEpGSUYAAQEAAAEAAQAA/9sAQwAGBAUGBQQGBgUGBwcGCAoQCgoJCQoUDg8MEBcUGBgXFBYWGh0lHxobIxwWFiAsICMmJykqKRkfLTAtKDAlKCko/9sAQwEHBwcKCAoTCgoTKBoWGigoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgo/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+p5HSKNpJGVEUFmZjgADqSao/wBt6V/0E7H/AMCE/wAaPEX/ACL+p/8AXrL/AOgGqOhaPpsuh6dJJp1m7tbxszNApJJUZJOK0jGPLzSOKtWre2VKkltfW/e3Qvf23pX/AEE7H/wIT/Gj+29K/wCgnY/+BCf40f2JpX/QMsf/AAHT/Cj+xNK/6Blj/wCA6f4Ufu/MP9s/u/iH9t6V/wBBOx/8CE/xo/tvSv8AoJ2P/gQn+NH9iaV/0DLH/wAB0/wo/sTSv+gZY/8AgOn+FH7vzD/bP7v4h/belf8AQTsf/AhP8avRuksayRsrowDKynIIPQg1h67o+mxaHqMkenWaOtvIyssCgghTgg4q94d/5F/TP+vWL/0AUSjHl5ohRrVvbOlVS2vpfvbqHiL/AJF/U/8Ar1l/9ANHh3/kX9M/69Yv/QBR4i/5F/U/+vWX/wBANHh3/kX9M/69Yv8A0AUf8u/mH/MZ/wBu/qaFFFFZnaFFFFAGf4i/5F/U/wDr1l/9ANHh3/kX9M/69Yv/AEAUeIv+Rf1P/r1l/wDQDR4d/wCRf0z/AK9Yv/QBWn/Lv5nF/wAxn/bv6h4i/wCRf1P/AK9Zf/QDR4d/5F/TP+vWL/0AUeIv+Rf1P/r1l/8AQDR4d/5F/TP+vWL/ANAFH/Lv5h/zGf8Abv6mhRRRWZ2hRRRQBn+Iv+Rf1P8A69Zf/QDR4d/5F/TP+vWL/wBAFHiL/kX9T/69Zf8A0A0eHf8AkX9M/wCvWL/0AVp/y7+Zxf8AMZ/27+oeIv8AkX9T/wCvWX/0A1R0LWNNi0PTo5NRs0dbeNWVp1BBCjIIzW5IiSxtHIqujAqysMgg9QRVH+xNK/6Blj/4Dp/hRGUeXlkFajW9sqtJra2t+9+gf23pX/QTsf8AwIT/ABo/tvSv+gnY/wDgQn+NH9iaV/0DLH/wHT/Cj+xNK/6Blj/4Dp/hR+78w/2z+7+If23pX/QTsf8AwIT/ABo/tvSv+gnY/wDgQn+NH9iaV/0DLH/wHT/Cj+xNK/6Blj/4Dp/hR+78w/2z+7+JR13WNNl0PUY49Rs3dreRVVZ1JJKnAAzV7w7/AMi/pn/XrF/6AKP7E0r/AKBlj/4Dp/hV6NEijWONVRFAVVUYAA6ACiUo8vLEKNGt7Z1arW1tL979T//Z/9sAQwAGBAUGBQQGBgUGBwcGCAoQCgoJCQoUDg8MEBcUGBgXFBYWGh0lHxobIxwWFiAsICMmJykqKRkfLTAtKDAlKCko/9sAQwEHBwcKCAoTCgoTKBoWGigoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgo/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+p5HSKNpJGVEUFmZjgADqSao/wBt6V/0E7H/AMCE/wAaPEX/ACL+p/8AXrL/AOgGqOhaPpsuh6dJJp1m7tbxszNApJJUZJOK0jGPLzSOKtWre2VKkltfW/e3Qvf23pX/AEE7H/wIT/Gj+29K/wCgnY/+BCf40f2JpX/QMsf/AAHT/Cj+xNK/6Blj/wCA6f4Ufu/MP9s/u/iH9t6V/wBBOx/8CE/xo/tvSv8AoJ2P/gQn+NH9iaV/0DLH/wAB0/wo/sTSv+gZY/8AgOn+FH7vzD/bP7v4h/belf8AQTsf/AhP8avRuksayRsrowDKynIIPQg1h67o+mxaHqMkenWaOtvIyssCgghTgg4q94d/5F/TP+vWL/0AUSjHl5ohRrVvbOlVS2vpfvbqHiL/AJF/U/8Ar1l/9ANHh3/kX9M/69Yv/QBR4i/5F/U/+vWX/wBANHh3/kX9M/69Yv8A0AUf8u/mH/MZ/wBu/qaFFFFZnaFFFFAGf4i/5F/U/wDr1l/9ANHh3/kX9M/69Yv/AEAUeIv+Rf1P/r1l/wDQDR4d/wCRf0z/AK9Yv/QBWn/Lv5nF/wAxn/bv6h4i/wCRf1P/AK9Zf/QDR4d/5F/TP+vWL/0AUeIv+Rf1P/r1l/8AQDR4d/5F/TP+vWL/ANAFH/Lv5h/zGf8Abv6mhRRRWZ2hRRRQBn+Iv+Rf1P8A69Zf/QDR4d/5F/TP+vWL/wBAFHiL/kX9T/69Zf8A0A0eHf8AkX9M/wCvWL/0AVp/y7+Zxf8AMZ/27+oeIv8AkX9T/wCvWX/0A1R0LWNNi0PTo5NRs0dbeNWVp1BBCjIIzW5IiSxtHIqujAqysMgg9QRVH+xNK/6Blj/4Dp/hRGUeXlkFajW9sqtJra2t+9+gf23pX/QTsf8AwIT/ABo/tvSv+gnY/wDgQn+NH9iaV/0DLH/wHT/Cj+xNK/6Blj/4Dp/hR+78w/2z+7+If23pX/QTsf8AwIT/ABo/tvSv+gnY/wDgQn+NH9iaV/0DLH/wHT/Cj+xNK/6Blj/4Dp/hR+78w/2z+7+JR13WNNl0PUY49Rs3dreRVVZ1JJKnAAzV7w7/AMi/pn/XrF/6AKP7E0r/AKBlj/4Dp/hV6NEijWONVRFAVVUYAA6ACiUo8vLEKNGt7Z1arW1tL979T//Z"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_2k.b63c078.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_4k.f47e8b5.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_8k.cd2cb89.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/particle.1d2de85.jpg"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_ao.ecd02c7.jpg"},function(e,t,n){var i={"./Heli_Meinte_Shadow.webp":493,"./airplane/plane_basecolor.webp":494,"./airplane/plane_metallic_roughness.webp":495,"./airplane/plane_normal.webp":496,"./airplane/windows_transparency.webp":497,"./clouds.webp":498,"./detail.webp":499,"./endscreen/outro_1.webp":500,"./endscreen/outro_2.webp":501,"./endscreen/outro_3.webp":502,"./helicopter/pave_hawk_basecolor.webp":503,"./helicopter/pave_hawk_metallic_roughness.webp":504,"./helicopter/pave_hawk_normal.webp":505,"./hotspot.webp":506,"./hotspot_text.webp":507,"./into_the_storm.webp":508,"./mountain_2k.webp":509,"./mountain_4k.webp":510,"./mountain_8k.webp":511,"./particle.webp":512,"./plane_ao.webp":513,"./us_ariforce_mask_small.webp":514};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=492},function(e,t,n){e.exports=n.p+"version/1611764881753/image/Heli_Meinte_Shadow.1d65531.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_basecolor.d0e74ab.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_metallic_roughness.a431879.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_normal.72c9259.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/windows_transparency.14295da.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/clouds.7ddb054.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/detail.3267532.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_1.10a8369.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_2.5bc6ad2.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/outro_3.d6d417a.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_basecolor.74296ae.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_metallic_roughness.97c6c3f.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/pave_hawk_normal.a9eaa37.webp"},function(e,t){e.exports="data:image/webp;base64,UklGRuIEAABXRUJQVlA4WAoAAAAUAAAAfwAAPwAAQUxQSDcAAAABDzD/ERGCcRtJiqoj3458GQ+/Ef2fAF7XqSunrjYIwP/K6oX4Fin1YJfVC/EtoNf+odQ9wOsCAFZQOCBsAQAAUA0AnQEqgABAAD4xEohCoiEhFQ2e5CADBLQAaGTrv0n8ZtrB4p+QHCBDRvyA9gH9A9gGcA/gH8a/3P9P95L9QOsA/YDrK/QA/TP0pvYa/dD0Uv/gA+JGdbO3TBGzlc6kxzZyzzH68XXeckpxtL5l/xkfAAD+95BQW4IUk88bCiKgjQmJK6T4IT8xL6Stn+0ddpfJ3J6RFBH6trAm/qn/lvDgLUkWgk8+/vG3hjFQj5HGoDu90jv3Jn+721Gz4bGCe06DME8nnF1SGIZj90r+splCp8cxaGesPsp41cMCahbalk8L+V+p17qod0dPcUQTTQIA1f4PdyO52mv7PBR+sXwiESQAB2xIIAxpcSYUwkHjue0cQq+KXXhh//ZNrlUExvNb0chPal+IFxr9kyEJXAIsdURXww/TCITraYDGuXO+QbtOGWxHVgMZrzhcbFIqUngSR4G0r/8FttisasU79ZAfceaYt8GDOAAAAFhNUCAQAwAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNkY3NjFGOTMzMDQxMUVCODk2OUE3Mjc4MTQ2ODM3NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNkY3NjFGQTMzMDQxMUVCODk2OUE3Mjc4MTQ2ODM3NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM2Rjc2MUY3MzMwNDExRUI4OTY5QTcyNzgxNDY4Mzc1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM2Rjc2MUY4MzMwNDExRUI4OTY5QTcyNzgxNDY4Mzc1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+AA=="},function(e,t,n){e.exports=n.p+"version/1611764881753/image/hotspot_text.faa1084.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/into_the_storm.5898d9a.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_2k.3a87354.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_4k.404103f.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/mountain_8k.7582c68.webp"},function(e,t){e.exports="data:image/webp;base64,UklGRiIaAABXRUJQVlA4WAoAAAAMAAAA/wAA/wAAVlA4IE4EAACQQgCdASoAAQABPm0ylUckJa4hKRmJWcANiWlu4WxhG926zUedZdJf/mI///U2ndGEcbtRaoVBtIFKzZ2F88MVgrrjLThMozKl4H4J4EEmXFlrI/ejFTbkiou+m58lmkORi6JktuM+PCsYssV6hM/0zsHmVHlSyKWhR+pfoaz2ndkEkLBOqS6tFCjmlCt5gv8Y/BT6fR9qVmfCMwHJ87X1NaB+uvxWYSr5+WXs0qw8c1cKQ6dP57PqwLgYR6b/3GjMo6R20rCMS6T/3rbzRBcfe7hgYydjALew2EKDh1cuWXadHnIbIRv2XlgxY0D4lDPIGuDU8ZDZ2IoTYS7p2KPYKa+KT5mxqDZutdM6hd1y05/dMhxKkKLUWN4UX0c+lpOxGjz1uv5EOVL5597CZOYeu0vSr1CQ0/rEO0eb524KBtDN69gJoLKemFeQAPMkdXkUo3+NXeNMAGyPVlAvKRPhyxfYosgYDYm6DUMw0yAgIgvaq8mdVZeaxnq8vpkRogfwgbkrIuEgYuqHspvI/4cZT30w66W7Suxd6K/aH6xBkQRjAecaYGHug4TQFhZnsG9ahVsW/MzyhHOboGaC+utb1w8A9aHo/ZqB8gRYWhGQFk0TCyViuHsGuxszsN5PCemiYWTRMLJomFk0TCyaJhZNEwsmiYWTRMLJomFk0TCyaJhZNEwsmiYWTRMLJomFk0TCyaJhZNEwsmiYWSUAAP7+mCKNw3nzLcFDdsFA47n3mipIsKZyIhJE+c07gbrWzU26Kcb2jQMx+yuGasRyRIpID2HqUQX8SVpP9VBGAfho3Vh9KU3c3MMh8R+CRNAxsZxuU8CQv+iUDSl1PILIY9d1Rt+QUZJc2IPhFzYW5uP/9zz8DCWCUh4OYb3xqsd7HxH5tOmhEX5IISMWz76n6pNIzmozGu1L3JKxhl3qsohC8V0dhSBCcEpDIXnHDSGr7ITUGP80fTyqoCluM25jzXKqHay5JyqfBhd8sHUcJYpfVAK2AoqERAK0wFoa2jMhNk4Jp041N/SrdiWl5xLKqJ0ETHYpVT0PzE4fQBY44aB0zWptPKuCYlrP33m8wLffTqL2yAp4K5e+3tG5rDoN6uod8V3Fu+RCLHCz6PRUELnEaa6GajXCWCm2/DDXhUiUKywEXa9jdkbloX4QuTGXF64ubueEUprOvc7UmG45cxnq7hOgoDKw/yO+bYFBxjaCKWFwaEwfjOwVxveTNj9C6iwjyAZYlvl4bEVILX7SuSZ2HtEVkT6MDXcoX90fi7dmcx6Iugq6L6a6f1a4q2xCAI+o5uyISwUowDogWH/+g01fMF6ZGt6xom386HjiD4A0Yk+4h7Yu+2URl/phEEQ3nWvZali0crGRHC7fmlg/KyegQQ3rhISW2OL+HuJgRZllpvNSfx5hVDIS6Wh2YgDz4Pvl+hqKqvn0KKniMV81f1a1+suUDHnpUkgAAAAAAAAARVhJRjwIAABJSSoACAAAAAwAAAEDAAEAAAAAAQAAAQEDAAEAAAAAAQAAAgEDAAMAAACeAAAABgEDAAEAAAACAAAAEgEDAAEAAAABAAAAFQEDAAEAAAADAAAAGgEFAAEAAACkAAAAGwEFAAEAAACsAAAAKAEDAAEAAAACAAAAMQECACQAAAC0AAAAMgECABQAAADYAAAAaYcEAAEAAADsAAAAJAEAAAgACAAIAID8CgAQJwAAgPwKABAnAABBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNS41IChXaW5kb3dzKQAyMDE5OjAxOjI1IDEwOjU3OjE1AAQAAJAHAAQAAAAwMjIxAaADAAEAAAABAAAAAqAEAAEAAAAAAQAAA6AEAAEAAAAAAQAAAAAAAAAABgADAQMAAQAAAAYAAAAaAQUAAQAAAHIBAAAbAQUAAQAAAHoBAAAoAQMAAQAAAAIAAAABAgQAAQAAAIIBAAACAgQAAQAAALoGAAAAAAAASAAAAAEAAABIAAAAAQAAAP/Y/+0ADEFkb2JlX0NNAAH/7gAOQWRvYmUAZIAAAAAB/9sAhAAMCAgICQgMCQkMEQsKCxEVDwwMDxUYExMVExMYEQwMDAwMDBEMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAQ0LCw0ODRAODhAUDg4OFBQODg4OFBEMDAwMDBERDAwMDAwMEQwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCACgAKADASIAAhEBAxEB/90ABAAK/8QBPwAAAQUBAQEBAQEAAAAAAAAAAwABAgQFBgcICQoLAQABBQEBAQEBAQAAAAAAAAABAAIDBAUGBwgJCgsQAAEEAQMCBAIFBwYIBQMMMwEAAhEDBCESMQVBUWETInGBMgYUkaGxQiMkFVLBYjM0coLRQwclklPw4fFjczUWorKDJkSTVGRFwqN0NhfSVeJl8rOEw9N14/NGJ5SkhbSVxNTk9KW1xdXl9VZmdoaWprbG1ub2N0dXZ3eHl6e3x9fn9xEAAgIBAgQEAwQFBgcHBgU1AQACEQMhMRIEQVFhcSITBTKBkRShsUIjwVLR8DMkYuFygpJDUxVjczTxJQYWorKDByY1wtJEk1SjF2RFVTZ0ZeLys4TD03Xj80aUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm9ic3R1dnd4eXp7fH/9oADAMBAAIRAxEAPwDypJJJJSkkk7WknRJSycNceBKvYmCbCJC2MfpB0hspKedZi5D/AKLCVYr6RmWcMhdhidJDYkBaX7NqDdW6JKeEHQbh9Jwnwbqit6E385xJ8AuvsppHtZVr4lAPTy+SNPIJKeY/YQ7NPzKdvQQeZC6dmFa3QklGb02x40BHmkp5N/QKwPpEeSo5PS31z6Z3R2XdP6VaBqJHmqtvS3DXaD5JKeCcx7T7hCZdm/p1Lp9SsCPKVk5fTcaXe3YR4JKcJJGuxXVnTUIKSlJJJJKf/9DypJIBHppLjwkpHXU5x4WnhdOdY4Twi4uGDAMfwW1h4wbCSk3T+mMaROvlC6LCwGGJAj4Knh7WROsLYpy2tboNUlNhnSqgJHfsk7prY0EKdWXu5ICtMvrPmkpofsppHAPyTfsqsDUCVrNurIgKFoYeUlOM7p7QdNVIM2+0NiO60Hta0cwqGXcW6Vn5pKYva0NO4hZ95o8vmh3ZOQ5xBMBQbB+kZPgkpFbSewBBWVl4hk6Qtt/EDRUMs6cSkp5nNxi0kwsi6sAros3grDyueElNIpJ3cpklP//R8tbyrmMQ0yeFTYJKuUsJ8vNJTs4VcwRwfFbGP6YgSsDFsc0BrXGPJamPb2OpSU7dTmD/AGKy3IaPo/NZdLnuAnhWWOa0aFJTotu7gwiMynAQCs0XNHPCi7JPYpKdhvUI0LoKM3P3Cd0rnH3uSbnPbpKSnon5W4cz5LPyMnUhZx6i8jlQGZJ1KSm04h3dQJ28FCF7DymNkn2mQkpsMe12h5Cr5TQRprPKi23XlKxwiXd0lONmM50WJlVCSV0GTBcfNZeS0eCSnDewgqEK7dWFVe2ElP8A/9Ly5jw1GZc494CqhTaUlOlReRoNFfoynyA0x8Qsek95iVaquDNSfgkp6CvJ2iXO1RBmDsZ+SwW5c8lGZlToCkp3G5IPdP6/gdVlMv0hFbckpvOucVEa91V9dTbeBzykpslphQM90M5QUTkykpOLI5+aXrwNCqFmS1p1OvghOzAElOkcsBCszDHJWVZma6aoDso6pKdC7I7qjfbKrPyZQXXuSUvY/sq7iCk55JUCZSU//9PyoIjB4oYUg6OElJw/aFE2HuUHcluSU2G2kd0eq4yJKohym18apKdau/hHZcPFZLLvvVhlwhJToeqexS9U8Ss/7T4dkzso/vJKbzryBqUF+WRw5UnZBPeUF9pSUnuynPPOo7oJvf8AvIJeoykpKb3+KibXHuUOUklMi4+KbcUySSlJJJJKf//U8qSSSSUpJJJJSpTgpkklMg4hT3kDlClPKSknqFRL1CUklMt6YuTJJKUkkkkpSSSSSlJJJJKUkkkkp//V8qSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSU//1vKkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklP/9fypJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJT//Q8qSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSUpJJJJSkkkklKSSSSU//2VhNUCBqDQAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzIgNzkuMTU5Mjg0LCAyMDE2LzA0LzE5LTEzOjEzOjQwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJHb29nbGUiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTI0VDE0OjQ1OjU1KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yNVQxMDo1NzoxNSswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wMS0yNVQxMDo1NzoxNSswMTowMCIgeG1wTU06RG9jdW1lbnRJRD0iMjhDQzMwNTA2RDRGODBEQjFEQzIxREM4RDA3NTg1RDIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjcxZjYyNTktNzYzZi05NTRhLTgzMjAtYTQzMTViNjgyODA2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9IjI4Q0MzMDUwNkQ0RjgwREIxREMyMURDOEQwNzU4NUQyIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjY3MWY2MjU5LTc2M2YtOTU0YS04MzIwLWE0MzE1YjY4MjgwNiIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yNVQxMDo1NzoxNSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDxyZGY6QmFnPiA8cmRmOmxpPjI4Q0MzMDUwNkQ0RjgwREIxREMyMURDOEQwNzU4NUQyPC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz4="},function(e,t,n){e.exports=n.p+"version/1611764881753/image/plane_ao.f5524ad.webp"},function(e,t,n){e.exports=n.p+"version/1611764881753/image/us_ariforce_mask_small.1925895.webp"},function(e,t,n){var i={"./ao/ao.fs.glsl":516,"./ao/ao.vs.glsl":517,"./background/background.fs.glsl":518,"./background/background.vs.glsl":519,"./circle/circle.fs.glsl":520,"./circle/circle.vs.glsl":521,"./flat/flat.fs.glsl":522,"./flat/flat.vs.glsl":523,"./glass/glass.fs.glsl":524,"./glass/glass.vs.glsl":525,"./groundsnow/groundsnow.fs.glsl":526,"./groundsnow/groundsnow.vs.glsl":527,"./hotspot/hotspot.fs.glsl":528,"./hotspot/hotspot.vs.glsl":529,"./hotspot_line/hotspot_line.fs.glsl":530,"./hotspot_line/hotspot_line.vs.glsl":531,"./hotspot_text/hotspot_text.fs.glsl":532,"./hotspot_text/hotspot_text.vs.glsl":533,"./hud/hud.fs.glsl":534,"./hud/hud.vs.glsl":535,"./include/common.glsl":536,"./meshMegaTexture/meshMegaTexture.fs.glsl":537,"./meshMegaTexture/meshMegaTexture.vs.glsl":538,"./meshUV/meshUV.fs.glsl":539,"./meshUV/meshUV.vs.glsl":540,"./mountainTexture/mountainTexture.fs.glsl":541,"./mountainTexture/mountainTexture.vs.glsl":542,"./pbr/pbr.fs.glsl":543,"./pbr/pbr.vs.glsl":544,"./people/people.fs.glsl":545,"./people/people.vs.glsl":546,"./sky/sky.fs.glsl":547,"./sky/sky.vs.glsl":548,"./snow/snow.fs.glsl":549,"./snow/snow.vs.glsl":550,"./snowBuffer/snowBuffer.fs.glsl":551,"./snowBuffer/snowBuffer.vs.glsl":552,"./sos/sos.fs.glsl":553,"./sos/sos.vs.glsl":554,"./title/title.fs.glsl":555,"./title/title.vs.glsl":556,"./trek/trek.fs.glsl":557,"./trek/trek.vs.glsl":558};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id=515},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform sampler2D _Texture;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\nvoid main(void) {\n\t  float alpha = (1.-texture2D(_Texture, vUV).r) * .4;\n\n  \tvec3 col = vec3(postScalar(0.));\n\t  col = addNoise(col);\n\n    gl_FragColor = vec4(col * alpha, alpha);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\n\tvPos = pos.xyz;\n\tvNormal = (_Model * vec4( aNormal, 0.0)).xyz;\n\tvUV = aUV0;\n\n\tgl_Position = _ViewProjection * pos;\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\nuniform highp vec3 _CamPos;\nvarying highp vec3 vPos;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tvec3 col = applyFog(vec3(1), 10000., _CamPos, normalize(vPos-_CamPos));\n\n    gl_FragColor = vec4(post(col),1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\n\nuniform mat4 _ViewProjection;\n\nvarying highp vec3 vPos;\n\n\nvoid main(void) {\n\tvec4 pos = vec4( aPos.xyz * vec3(500.,500., -500.), 1.);\n\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform float _Scale;\nuniform float _Fade;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\n\nvoid main(void) {\n\tvec3 col = _UIColor;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n//  float r = .02/_Scale;\n//  float radius = length(vUV-.5)*2.;\n//  float alpha = smoothstep(1., .98, radius) * smoothstep(.98-r, 1.-r, radius) * _Fade;\n\n\tfloat alpha = _Fade - _Fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos));\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\n\n#include include/common.glsl\n\n\nvoid main(void) {\n\tvec3 col = applyLight(vec3(.75,.1,.1), normalize(vNormal));\n\n\tvec3 ref = reflect(normalize(vPos - _CamPos), normalize(vNormal));\n\tfloat spe = pow(clamp(dot(ref,sunDir), 0., 1.),8.) * .25;\n\tcol *= 1. + spe;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n\tcol = applyFog(col, dist, _CamPos, normalize(vPos - _CamPos));\n\n    gl_FragColor = vec4(post(col), 1);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\n\tvPos = pos.xyz;\n\tvNormal = (_Model * vec4( aNormal, 0.0)).xyz;\n\n\tgl_Position = _ViewProjection * pos;\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision highp float;\n#endif\n\n#ifdef TRANSPARENCY\nuniform mediump sampler2D _Transparency;\n#endif\n\nuniform highp vec3 _CamPos;\n\nvarying highp vec3 vWorld;\nvarying vec2 vUV;\nvarying highp float vDist;\n\nvarying vec3 vNormal;\n\n#ifdef SNOW\nvarying highp vec3 vPos;\nuniform mediump sampler2D _SnowDetail;\n#endif\n\n#include include/common.glsl\n\nvec3 ModifiedFresnel(const float cosTheta, const vec3 F0, const float roughness) {\n\treturn F0 + (max(vec3(1.-roughness), F0) - F0) * pow(1.0 - cosTheta, 5.0);\n}\n\nfloat DistributionGGX(const vec3 N,const  vec3 H,const  float roughness) {\n    float a      = roughness*roughness;\n    float a2     = a*a;\n    float NdotH  = max(dot(N, H), 0.0);\n    float NdotH2 = NdotH*NdotH;\n\n    float num   = a2;\n    float denom = (NdotH2 * (a2 - 1.0) + 1.0);\n    denom = denom * denom;\n\n    return num / denom;\n}\n\nfloat GeometrySmith(const float NdotV, const float NdotL, const float roughness) {\n\tfloat r = (roughness + 1.0);\n\tfloat k = (r*r) / 8.0;\n\n\tfloat denom = NdotV * (1.0 - k) + k;\n\tfloat denom2 = NdotL * (1.0 - k) + k;\n\n\treturn 1. / (denom * denom2);\n}\n\nvoid main(void) {\n\tvec3 N = normalize(vNormal);\n\n\tfloat occ = 1.0;\n  float snow = 0.;\n\n#ifdef TRANSPARENCY\n  snow = min(1., 2.*texture2D(_Transparency, vUV).x);\n#endif\n\n  #ifdef SNOW\n\tsnow = texture2D(_SnowDetail, vWorld.xz * 16.).r;\n  #endif\n\n  vec3 albedo = mix(vec3(0.05), vec3(0.5,0.6,0.7) * .6, snow);\n  float roughness = mix(0.2, 0.9, snow);\n  float metallic = mix(1., 0., snow);\n\n\tvec3 V = normalize(_CamPos-vWorld);\n\tvec3 L = _LightDir;\n\tvec3 H = normalize(V+L);\n\tvec3 R = reflect(-V,N);\n\n\tfloat NdotL = max(dot(N, L), 0.0);\n\tfloat NdotV = max(dot(N, V), 0.0);\n\n\tvec3 F0 = vec3(0.04);\n\tF0 = mix(F0, albedo, metallic);\n\n\n\t// cook-torrance brdf\n\tfloat NDF = DistributionGGX(N, H, roughness);\n\tfloat G   = GeometrySmith(NdotV, NdotL, roughness);\n\tvec3 F    = ModifiedFresnel(NdotV, F0, roughness);\n\n\tvec3 kD = vec3(1.0) - F;\n\tkD *= 1.0 - metallic;\n\n\tvec3 numerator    = NDF * G * F;\n//\tconst float denominator = 4.0;\n\tvec3 specular     = numerator * .25; //max(denominator, 0.001);\n\n  float alpha = mix(F.x, 1., snow);\n\n\t// add to outgoing radiance Lo\n\tvec3 col = (kD * albedo) /* * _LightColor*/ * (_LightStrength * NdotL);\n\tcol += getSkyColorIBL(N, 1.5, NdotL) * albedo * kD * _AmbientStrength;\n\n  col = post(col) * alpha;\n\n\tcol += getSkyColorIBL(R, roughness, NdotL) * F * _AmbientStrength;\n  col += specular * (_LightStrength * NdotL);\n\n\tgl_FragColor = vec4(col, alpha + .05);\n}\n"},function(e,t){e.exports="attribute vec4 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nuniform highp vec3 _CamPos;\n\n\nvarying vec3 vWorld;\nvarying vec2 vUV;\nvarying float vDist;\n\nvarying vec3 vNormal;\n\n\n#ifdef SNOW\nvarying vec3 vPos;\n#endif\n\nvoid main(void) {\n  vWorld = (_Model*vec4(aPos.xyz, 1.)).xyz;\n  vUV = aUV0;\n\n  vNormal = (_Model * vec4(aNormal,0)).xyz;\n\n\n#ifdef SNOW\n  vPos = aPos.xyz;\n#endif\n\n  gl_Position = _ViewProjection * vec4(vWorld,1.);\n  vDist = distance(_CamPos, vWorld);\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform float _GroundSnowColor;\nuniform sampler2D _Texture;\n\nvarying vec2 vUV;\nvarying vec3 vPos;\nvarying float vOpacity;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tfloat f = vOpacity;\n\tf *= texture2D(_Texture,vUV).r;\n\n  gl_FragColor = vec4(post(vec3(_GroundSnowColor)), f);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform float _GroundSnowParticleSize;\nuniform float _GroundSnowOpacity;\n\nuniform vec3 _SnowOffset;\n\nuniform vec3 _SnowCenter;\nuniform vec3 _SnowForward;\nuniform vec3 _SnowRight;\nuniform vec3 _SnowUp;\n\nuniform float _ParticleAreaSize;\n\nuniform mat4 _ViewProjection;\n\nuniform float _Particles;\nuniform float _Aspect;\n\nvarying vec2 vUV;\nvarying vec3 vPos;\nvarying float vOpacity;\n\nuniform vec3 _CamPos;\n\nuniform float _Time;\nuniform float _TimeFull;\n\n\n//----------------------------------------------------------------------------------------\n///  3 out, 3 in...\n#define HASHSCALE3 vec3(.1031, .1030, .0973)\nvec3 hash33(vec3 p3) {\n\tp3 = fract(p3 * HASHSCALE3);\n  p3 += dot(p3, p3.yxz+19.19);\n  return fract((p3.xxy + p3.yxx)*p3.zyx);\n}\n\nvoid main(void) {\n\tfloat scale = 1./_ParticleAreaSize;\n\n\tvec3 gridPos = aPos - floor(_SnowOffset);\n\n\tvec3 worldPos = (aPos + fract(_SnowOffset) + hash33(gridPos) - .5 + sin(2.*_TimeFull*hash33(gridPos.zyx)))*(1./scale);\n  worldPos = _SnowCenter + worldPos.x * _SnowForward + worldPos.z * _SnowRight + (.2 * worldPos.y) * _SnowUp;\n\n\tvec4 pos = _ViewProjection * vec4(worldPos, 1.);\n\n\tgl_Position = pos;\n\tgl_Position.xy += (aUV0-.5) *(_GroundSnowParticleSize) * vec2(1., _Aspect);\n\n\tif (pos.w < 0.) {\n\t\tgl_Position = vec4(-1000,-1000,1,1);\n\t}\n\n  vPos = worldPos + gl_Position.xyz;\n  vOpacity = smoothstep(1.,0., distance(worldPos, _SnowCenter) * .707) * _GroundSnowOpacity;\n\tvUV = aUV0;\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision highp float;\n#endif\n\nuniform highp sampler2D _Texture;\n\nuniform vec3 _CamPos;\nuniform float _Scale;\nuniform float _Fade;\nuniform float _Hover;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\n\nvoid main(void) {\n  vec4 data = mix(texture2D(_Texture, vUV), texture2D(_Texture, vUV + vec2(.5, 0.)), _Hover);\n\tvec3 col = data.rgb;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n//  float r = .02/_Scale;\n//  float radius = length(vUV-.5)*2.;\n//  float alpha = smoothstep(1., .98, radius) * smoothstep(.98-r, 1.-r, radius) * _Fade;\n\n\tfloat alpha = clamp(_Fade - _Fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos)), 0. , 1.);\n  alpha = _Fade;\n\n  alpha *= data.a;\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform vec3 _Pos;\nuniform float _Aspect;\nuniform float _Size;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0 * vec2(.5, 1.);\n\n  vec4 pos = vec4(_Pos, 1.0);\n  vPos = pos.xyz;\n\n  gl_Position = _ViewProjection * pos;\n\n  gl_Position.xy += ((aUV0 - .5) * .8 *  _Size) * vec2(1. / _Aspect, 1.) * .1 * gl_Position.w;\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform float _Fade;\n\nvarying vec3 vPos;\n\n#include include/common.glsl\n\nvoid main(void) {\n  vec3 col = _UIColor;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n\tfloat alpha = clamp(_Fade - _Fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos)), 0. , 1.);\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform vec3 _Pos;\nuniform float _Aspect;\nuniform vec2 _BoxSize;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\n\tvec4 pos = vec4( _Pos, 1.0);\n\tvPos = pos.xyz;\n\n\n  vec4 proj = _ViewProjection * pos;\n\n\tif (aPos.x > .5 && proj.w > 0. &&  abs(proj.x/proj.w) <= 1. && abs(proj.y/proj.w) <= 1. ) {\n  \tvec2 p = vec2(.7, .88) - vUV * vec2(1./_Aspect, 1.) * 2. * _BoxSize;\n\n\t  gl_Position = vec4(p,1,1);\n\t} else {\n  \tgl_Position = proj;\n    gl_Position.xy += ( (vUV - .5) * .5 ) * vec2(1., _Aspect) * 5.;\n\t}\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform highp sampler2D _Texture;\n\nuniform vec3 _CamPos;\nuniform float _Scale;\nuniform float _Fade;\nuniform float _TextureIndex;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\n\nvoid main(void) {\n  vec2 uv = vUV;\n  uv.y *= 48./512.;\n  uv.y += (1. - 48./512.) - _TextureIndex * (48./512.);\n\n  float data = texture2D(_Texture, uv, -0.5).r;\n  float glow = texture2D(_Texture, uv + vec2(-0.1/512., 1.5/512.), .5).g;//  + vec2(-0.1/512., 1.5/512.)\n  float shadow = texture2D(_Texture, uv + vec2(-0.1/512., 1.5/512.)).r;//  + vec2(-0.1/512., 1.5/512.)\n\n  vec4 dark = mix(vec4(5./255., 20./255., 50./255., 1.) * (glow * .125), vec4(0, 0, 0, .5), shadow);\n\n  float dist = distance(vPos, _CamPos);\n\n  //  col *= vignette();\n\n  //  float r = .02/_Scale;\n  //  float radius = length(vUV-.5)*2.;\n  //  float alpha = smoothstep(1., .98, radius) * smoothstep(.98-r, 1.-r, radius) * _Fade;\n\n  float alpha = clamp(_Fade - _Fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos)), 0., 1.);\n  alpha = _Fade;\n\n\n  //  alpha = sqrt(alpha);\n\n  vec4 col = mix(dark, vec4(1.), data) * alpha;\n\n  gl_FragColor = col;\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform vec3 _Pos;\nuniform float _Aspect;\nuniform float _Size;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\n  vec4 pos = vec4(_Pos, 1.0);\n  vPos = pos.xyz;\n\n  gl_Position = _ViewProjection * pos;\n\n  gl_Position.xy += (aUV0 - vec2(1.04, .54)) * vec2(1./_Aspect, 48./512.) * (0.72 * _Size * gl_Position.w);\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform sampler2D _SnowBuffer;\n\n#ifdef ENDSCREEN\nuniform sampler2D _EndScreen;\nuniform float _EndScreenPos;\nuniform sampler2D _EndScreenTarget;\nuniform float _EndScreenPosTarget;\nuniform float _EndScreenProgress;\nuniform float _EndScreenFade;\n#else\nuniform sampler2D _MaskTexture;\n#endif\n\nuniform float _MaskFade;\nuniform float _MaskHeadFade;\nuniform float _MaskZoom;\n\nuniform vec2 _Hover;\n\nuniform vec3 _Forward;\nuniform float _FlareStrength;\nuniform mediump float _Aspect;\nuniform float _SnowStrength;\nuniform float _SnowDarkness;\nuniform float _FadeToBlue;\n\nvarying vec2 vUV;\nvarying vec2 vLightPos;\n\n#include include/common.glsl\n\nvec3 lensflare(vec2 uv, vec2 pos) {\n  vec2 uvd = uv*(length(uv));\n  float f = 0.1/(length(uv-pos)*16.0+1.0);\n\n  vec2 uvx = mix(uv, uvd, -0.5);\n  f += max(0.01-pow(length(uvx+0.3*pos), 3.4), .0)*6.0;\n  f += max(0.01-pow(length(uvx-0.3*pos), 1.6), .0)*6.0;\n  uvx = mix(uv, uvd, -0.4);\n  f += max(0.01-pow(length(uvx+0.2*pos), 5.5), .0)*2.0;\n\n  vec3 f3 = vec3(f);\n\n  vec2 p3x = uvd+0.65*pos;\n  f3.x += max(1.0/(1.0+32.0*dot(p3x, p3x)), .0) * 0.3;\n  vec2 p3y = uvd+0.7*pos;\n  f3.y += max(1.0/(1.0+32.0*dot(p3y, p3y)), .0) * 0.3;\n  vec2 p3z = uvd+0.75*pos;\n  f3.z += max(1.0/(1.0+32.0*dot(p3z, p3z)), .0) * 0.3;\n\n  return f3;\n}\n\nconst float _FlareStart = 0.;\n\n#ifdef ENDSCREEN\nvec4 getMaskColor(sampler2D maskTexture, float pos, float zoom) {\n  const float scale = 1.2;\n  vec2 maskUV;\n  if (pos < -.5) {\n    maskUV = vec2(vUV.x * ((.5 * scale) * _Aspect), 1. - vUV.y * scale);\n  } else if (pos > .5) {\n    maskUV = vec2(1. + (vUV.x - 1.) * ((.5 * scale) * _Aspect), 1. - vUV.y * scale);\n  } else {\n    maskUV = vec2(.5 + (vUV.x - .5) * ((.5 * scale) * _Aspect), 1. - vUV.y * scale);\n  }\n\n  if (_Aspect < 1.) {\n    if (abs(pos) < .5) {\n      maskUV = (maskUV-.5) * (1./_Aspect) + .5;\n    } else {\n      maskUV *= .75;\n      maskUV += .125;\n    }\n  }\n  maskUV = (maskUV - .5) * ((1./1.01) * zoom) + .5;\n  maskUV += _Hover * 0.01 * vec2(1., -1./_Aspect);\n  vec4 col =  texture2D(maskTexture, maskUV);\n  vec4 mask = vec4(col.rgb * col.a, col.a);\n  return mask;\n}\n\nvec4 mask(float zoom, float fade, vec4 bgColor, vec4 totalColor) {\n  vec4 mask = mix(\n  getMaskColor(_EndScreen, _EndScreenPos, zoom),\n  getMaskColor(_EndScreenTarget, _EndScreenPosTarget, zoom),\n  _EndScreenProgress);\n\n  vec4 maskColor = mix(bgColor, mask, .5 * mask.a);\n  maskColor *= (1. - .7 * mask.a);\n  totalColor = mix(totalColor, maskColor, fade);\n  return totalColor;\n}\n  #else\nvec4 mask(sampler2D maskTexture, float zoom, float fade, float imageFade, vec4 bgColor, vec4 totalColor) {\n  vec2 maskUV = vec2((vUV.x - .5)*.5*_Aspect + .5, 1. - vUV.y);\n  maskUV = (maskUV - .5) * zoom + .5;\n  vec4 mask = texture2D(maskTexture, maskUV);\n  vec4 maskColor = mix(bgColor, mask, .5 * imageFade * mask.a);\n  maskColor *= (1. - .7 * mask.a * imageFade);\n  totalColor = mix(totalColor, maskColor, fade);\n  return totalColor;\n}\n  #endif\n\nvoid main(void) {\n  float v = 1. - vignette();\n\n  vec3 color = vec3(0.);\n  vec2 uv = vUV - .5;\n  uv.x *= _Aspect;\n\n  float flareStrength = dot(-_Forward, _LightDir);\n  if (flareStrength > _FlareStart) {\n    flareStrength = (flareStrength - _FlareStart) * _FlareStrength;\n    color = vec3(1.4, 1.2, 1.0) * (lensflare(uv, vLightPos) * flareStrength);\n  }\n\n  float snow = texture2D(_SnowBuffer, vUV).r;\n  float snowbright =  pow(max(flareStrength, 0.), 4.);\n\n  v +=  snow * _SnowStrength;\n\n  color += _LightColor * snow * (_SnowStrength + snowbright) * (1. - _SnowDarkness);\n\n  color += vec3(0, .1, .3) * v;\n\n  vec4 totalColor = vec4(color, v);\n  vec4 bgCol = vec4(mix(vec3(203./255., 214./255., 232./255.), vec3(182./255., 199./255., 222./255.), vUV.y), 1.);\n\n  #ifdef ENDSCREEN\n  totalColor = mask(1., _EndScreenFade, bgCol, totalColor);\n  #else\n  if (_MaskFade > 0.) {\n    totalColor = mask(_MaskTexture, _MaskZoom, _MaskFade, _MaskHeadFade, bgCol, totalColor);\n  }\n  if (_FadeToBlue > 0.) {\n    totalColor = mix(totalColor, vec4(15./255., 23./255., 45./255., 1.), _FadeToBlue*.45);\n  }\n    #endif\n\n  totalColor = clamp(totalColor, vec4(0), vec4(1));\n\n  gl_FragColor = totalColor;\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mediump vec3 _LightDir;\nuniform mat4 _Projection;\nuniform mat4 _View;\nuniform mediump float _Aspect;\n\nvarying vec2 vUV;\nvarying vec2 vLightPos;\n\n\nvoid main(void) {\n  vUV = aUV0;\n\tgl_Position = vec4(aPos, 1.0);\n\n\tvec4 pos = _View * vec4(_LightDir, 0.);\n\tpos.w = 1.;\n\tpos = (_Projection * pos);\n\tvLightPos = pos.xy / pos.w;\n\tvLightPos *= .5;\n\tvLightPos.x *= _Aspect;\n}\n"},function(e,t){e.exports="uniform highp float _FogA;\nuniform highp float _FogB;\nuniform highp float _FogC;\nuniform highp float _Time;\nuniform vec2 _Resolution;\n\nuniform float _Saturation;\nuniform float _Exposure;\nuniform float _Vignette;\nuniform float _NoiseStrength;\nuniform float _Contrast;\nuniform float _Gamma;\nuniform float _Black;\nuniform float _White;\n\nconst vec3 _SOSColor = vec3(63./255., 120./255., 200./255.);\nconst vec3 _UIColor = vec3(255./255., 183./255., 2./255.);\nconst vec3 _LightColor = vec3(.95, 0.875, 0.75);\nconst vec3 _SkyColor =  vec3(0.6, 0.65, 0.7);\nconst float _LightStrength = .15;\nconst float _AmbientStrength = 2.;\nuniform mediump vec3 _LightDir;\n\nvec3 getSkyColor(in vec3 rayDir) {\n  float sunAmount = max(dot(rayDir, _LightDir) * (1. - _FogA), 0.0);\n  vec3  fogColor  = mix(_SkyColor, _LightColor, pow(sunAmount, 8.0));\n  return (fogColor * fogColor) * min(1., 1.+.5*rayDir.y);\n}\n\nvec3 getSkyColorPower(in vec3 rayDir, in float power, const float roughness) {\n  float sunAmount = max(dot(rayDir, _LightDir), 0.0);\n  vec3  fogColor  = mix(_SkyColor, _LightColor, pow(sunAmount, power));\n  return (fogColor * fogColor) * (.25 + .75*smoothstep(-roughness, roughness, rayDir.y));\n}\n\nvec3 getSkyColorIBL(const vec3 N, const float roughness, const  float NdotL) {\n  return getSkyColorPower(N, max(0., 4.-roughness*2.), roughness);\n}\n\nvec3 applyLight(vec3 col, vec3 n) {\n  return (col  * getSkyColor(n)) * (.75+.25*dot(n, _LightDir));\n}\n\nfloat fogAmount(in highp float distance, in highp vec3  rayOri, in highp vec3  rayDir) {\n  return clamp((_FogC) * exp(-rayOri.y*_FogB) * (1.0-exp(-distance*rayDir.y*_FogB*2.))/rayDir.y, 0., 1.);\n}\n\nvec3 applyFog(in vec3  rgb,\nin highp float distance,\nin highp vec3  rayOri,\nin highp vec3  rayDir) {\n  const highp float eps = 0.0001;\n  if (abs(rayDir.y) < eps) rayDir.y = eps;// * sign(rayDir.y);\n  return mix(rgb, getSkyColor(rayDir), fogAmount(distance, rayOri, rayDir));\n}\n\nhighp float hash13(highp vec3 p3) {\n  p3  = fract(p3 * 443.8975);\n  p3 += dot(p3, p3.yzx + 19.19);\n  return fract((p3.x + p3.y) * p3.z);\n}\nhighp vec2 hash21(highp float p) {\n  highp vec3 p3 = fract(vec3(p) * vec3(443.897, 441.423, 437.195));\n  p3 += dot(p3, p3.yzx + 19.19);\n  return fract((p3.xx+p3.yz)*p3.zy);\n}\nhighp vec3 hash33(vec3 p3) {\n  p3 = fract(p3 * vec3(443.897, 441.423, 437.195));\n  p3 += dot(p3, p3.yxz+19.19);\n  return fract((p3.xxy + p3.yxx)*p3.zyx);\n}\n\nvec3 addNoise(vec3 col) {\n  #ifdef MOBILE\n  return col;\n  #else\n  vec2 q = gl_FragCoord.xy / _Resolution;\n  float n = 1. - (hash13(vec3(q, mod(_Time, 10.))) - .5) *_NoiseStrength;\n\n  return clamp(col * n, vec3(0.), vec3(1.));\n  #endif\n}\n\nfloat vignette() {\n  vec2 q = gl_FragCoord.xy / _Resolution;\n  float v = mix(1., pow(16.0*q.x*q.y*(1.0-q.x)*(1.0-q.y), 0.2), _Vignette);\n  float b = (.7 + .3 * smoothstep(0., .325, q.y));\n  return (v * b);\n}\n\nvec3 post(vec3 col) {\n  col *= _Exposure;\n\n  col = mix(vec3(dot(col, vec3(.3, .59, .11))), col, _Saturation);\n\n  col = col * (1. / (1.-_Black)) - (_Black / (1.-_Black));\n  col = col * (1. / (1.-_White));\n\n  col = pow(clamp(col, vec3(0), vec3(1)), 1./vec3(_Gamma*.975, _Gamma*1.025, _Gamma*1.1));\n  //  \tcol = pow(clamp(col, vec3(0), vec3(1)), 1./vec3(_Gamma*.975, _Gamma*1.025, _Gamma*1.125));\n  //  col = pow(clamp(col, vec3(0), vec3(1)), 1./vec3(_Gamma, _Gamma*1.05, _Gamma*1.15));\n\n  col = clamp(col, 0.0, 1.0);\n  col = mix(col, col*col*(3.0-2.0*col), _Contrast);\n\n  return clamp(col, vec3(0.), vec3(1.));\n}\n\nfloat postScalar(float col) {\n  col *= _Exposure;\n  col = pow(clamp(col, 0., 1.), 1./_Gamma);\n  return clamp(col, 0., 1.);\n}\n"},function(e,t){e.exports="#extension GL_EXT_shader_texture_lod : enable\n#extension GL_OES_standard_derivatives : enable\n\n#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform mediump sampler2D _MainTexture;\nuniform lowp sampler2D _DetailTexture;\nuniform mediump sampler2D _RedirectTexture;\nuniform lowp sampler2D _Detail;\n\nuniform float _MaxMipLevel;\nuniform float _MegaTexSize;\nuniform float _DetailTexSize;\nuniform float _TileSize;\nuniform float _NumTiles;\nuniform highp vec3 _CamPos;\n\nuniform float _GroundBoost;\n\nvarying highp vec2 vUV;\nvarying vec3 vPos;\nvarying float vDist;\n\n#include include/common.glsl\n\n#if defined(USE_DETAIL_TEXTURE) || !defined(NORMAL_TEXTURE_FALLBACK)\nfloat tex_mip_level(highp vec2 coord, highp vec2 tex_size) {\n   highp vec2 coord_scaled = coord * tex_size;\n\n   highp vec2 dx_scaled = dFdx(coord_scaled);\n   highp vec2 dy_scaled = dFdy(coord_scaled);\n\n   highp vec2 dtex = dx_scaled*dx_scaled + dy_scaled*dy_scaled;\n   highp float min_delta = max(dtex.x,dtex.y);\n   float miplevel = max(0.5 * log2(min_delta), 0.0);\n\n   return miplevel;\n}\n#endif\n\n#ifndef MOBILE\nfloat textureNoTile( sampler2D samp, in vec2 x )\n{\n    float k = texture2D( samp, 0.005*x  ).x; // cheap (cache friendly) lookup\n\n    float index = k*8.0;\n    float i = floor( index );\n    float f = fract( index );\n\n    vec2 offa = hash21(i); //sin(vec2(323.532510,4317.41340)*(i+0.0)); // can replace with any other hash\n    vec2 offb = hash21(-i); //sin(vec2(133.54135340,1237.12340)*(i+1.0)); // can replace with any other hash\n\n    vec2 dx = dFdx(x), dy = dFdy(x);\n\n    float cola = texture2DGradEXT( samp, x + offa, dx, dy ).x;\n    float colb = texture2DGradEXT( samp, x + offb, dx, dy ).x;\n\n    return mix( cola, colb, smoothstep(0.2,0.8,f-0.1*(cola-colb)) );\n}\n#endif\n\nvoid main(void) {\n\thighp float repTilesInDetailTex = _TileSize / _DetailTexSize;\n\thighp vec2 uv = vUV;\n\n\tvec2 uvi = floor( uv * _NumTiles) * (1. / _NumTiles);\n\tfloat col = texture2D(_MainTexture, uv).r;\n\n#ifdef NORMAL_TEXTURE_FALLBACK\n    #ifndef MOBILE\n      #ifdef USE_DETAIL_TEXTURE\n      float mip = tex_mip_level(uv, vec2( _MegaTexSize ) );\n      if (mip < 1.) {\n        col *= 1. + .3 *(2.*textureNoTile(_Detail, vUV*1600.) - 1.) * ( 1. - mip);\n      }\n      #endif\n    #endif\n#else\n    float mip = tex_mip_level(uv, vec2( _MegaTexSize ) );\n    if( mip <= _MaxMipLevel ) {\n\n\n      vec3 redirect = texture2D(_RedirectTexture, uvi).rgb;\n\n      if(redirect.z > 0.) {\n        mediump vec2 uvx =  (uv-uvi) * _NumTiles; // + vec2(1./_TileSize, -1./_TileSize);\n        uvx.y = 1.-uvx.y;\n        vec2 border = abs(uvx-.5);\n        uvx = clamp( uvx, .5/_TileSize, 1.-.5/_TileSize );\n        uvx *= repTilesInDetailTex;\n\n        float fade = clamp( redirect.z * 128., 0., 1.) *  clamp( _MaxMipLevel - mip, 0., 1.);\n\n  #ifdef LOD_EXT\n        mip *= smoothstep( .5,.475,max(border.x, border.y));\n  #else\n        fade *= smoothstep( .5,.45,max(border.x, border.y));\n  #endif\n\n        redirect.xy = floor(redirect.xy * (1./repTilesInDetailTex)) * repTilesInDetailTex;\n\n  #ifdef LOD_EXT\n        float detailCol = texture2DLodEXT(_DetailTexture, uvx + redirect.xy, mip).r;\n  #else\n        vec2 f =  fwidth(uvx + redirect.xy);\n        float detailCol = texture2D(_DetailTexture, uvx + redirect.xy, - max(f.x,f.y) > .1 || smoothstep( .5,.475,\n        max(border.x, border.y)) < .5 ? -100.:0.).r;\n  #endif\n        col = mix( col, detailCol, fade);\n      }\n  //\t\tcol *= 1. + .4 *(2.*texture2D(_Detail, vUV*1600.).x - 1.) * clamp( 1. - 8. * mip, 0., 1.);\n  #ifndef MOBILE\n      #ifdef USE_DETAIL_TEXTURE\n      if (mip < 1.) {\n        col *= 1. + .5 *(2.*textureNoTile(_Detail, vUV*1600.) - 1.) * ( 1. - mip);\n      }\n      #endif\n  #endif\n    }\n#endif\n\n  col = max(0., col * 1.25 - .05);\n  col = pow(col, 1.5);\n  col *= _GroundBoost;\n\n\tvec3 col3 = applyFog(vec3(col), vDist, _CamPos, normalize(vPos - _CamPos));\n\tcol3 = post(col3);\n\tcol3 = addNoise(col3);\n\n  gl_FragColor = vec4(col3, 1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\nuniform highp vec3 _CamPos;\n\nvarying highp vec2 vUV;\nvarying vec3 vPos;\nvarying float vDist;\n\nvoid main(void) {\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n\tvUV = vec2(aPos.x, -aPos.z )/ 50. + .5;\n\tvDist = distance(vPos, _CamPos);\n}\n"},function(e,t){e.exports="#extension GL_EXT_shader_texture_lod : enable\n#extension GL_OES_standard_derivatives : enable\n\n#ifdef GL_ES\n\tprecision highp float;\n#endif\n\nvarying vec2 vUV;\nuniform float _MegaTexSize;\nuniform float _NumTiles;\n\nfloat tex_mip_level(vec2 coord, vec2 tex_size) {\n   vec2 dx_scaled, dy_scaled;\n   vec2 coord_scaled = coord * tex_size;\n\n   dx_scaled = dFdx(coord_scaled);\n   dy_scaled = dFdy(coord_scaled);\n\n   vec2 dtex = dx_scaled*dx_scaled + dy_scaled*dy_scaled;\n   float min_delta = max(dtex.x,dtex.y);\n   float miplevel = max(0.5 * log2(min_delta), 0.0);\n\n   return miplevel;\n}\n\nvoid main(void) {\n\tvec2 uv = vUV;\n\n\tvec2 uvi = floor( uv * _NumTiles) / 256.;\n\n    gl_FragColor = vec4( uvi, tex_mip_level(uv, vec2( _MegaTexSize) ) / 256. ,1);\n}"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec2 vUV;\n\n\nvoid main(void) {\n//\tvec4 pos = _Model * vec4( scalePos(aPos), 1.0);\n\tvec4 pos = vec4( aPos, 1.0);\n\n\tgl_Position = _ViewProjection * _Model * pos;\n\tvUV = vec2(pos.x, -pos.z )/ 50. + .5;\n}\n"},function(e,t){e.exports="#if defined(USE_DETAIL_TEXTURE)\n#extension GL_EXT_shader_texture_lod : enable\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform mediump sampler2D _MainTexture;\nuniform lowp sampler2D _Detail;\nuniform float _GroundBoost;\n\nuniform highp vec3 _CamPos;\nvarying highp vec2 vUV;\nvarying vec3 vPos;\nvarying highp float vDist;\n\n#include include/common.glsl\n\n#if defined(USE_DETAIL_TEXTURE)\nfloat tex_mip_level(highp vec2 coord, highp vec2 tex_size) {\n   highp vec2 coord_scaled = coord * tex_size;\n\n   highp vec2 dx_scaled = dFdx(coord_scaled);\n   highp vec2 dy_scaled = dFdy(coord_scaled);\n\n   highp vec2 dtex = dx_scaled*dx_scaled + dy_scaled*dy_scaled;\n   highp float min_delta = max(dtex.x,dtex.y);\n   float miplevel = max(0.5 * log2(min_delta), 0.0);\n\n   return miplevel;\n}\n\nfloat textureNoTile( sampler2D samp, in vec2 x )\n{\n    float k = texture2D( samp, 0.005*x  ).x; // cheap (cache friendly) lookup\n\n    float index = k*8.0;\n    float i = floor( index );\n    float f = fract( index );\n\n    vec2 offa = hash21(i); //sin(vec2(323.532510,4317.41340)*(i+0.0)); // can replace with any other hash\n    vec2 offb = hash21(-i); //sin(vec2(133.54135340,1237.12340)*(i+1.0)); // can replace with any other hash\n\n    vec2 dx = dFdx(x), dy = dFdy(x);\n\n    float cola = texture2DGradEXT( samp, x + offa, dx, dy ).x;\n    float colb = texture2DGradEXT( samp, x + offb, dx, dy ).x;\n\n    return mix( cola, colb, smoothstep(0.2,0.8,f-0.1*(cola-colb)) );\n}\n#endif\n\nvoid main(void) {\n\thighp vec2 uv = vUV;\n\n\tfloat col = texture2D(_MainTexture, uv).r;\n\n  #ifdef USE_DETAIL_TEXTURE\n  float mip = tex_mip_level(uv, vec2( 16384 ) );\n  if (mip < 1.) {\n    col *= 1. + .3 *(2.*textureNoTile(_Detail, vUV*1600.) - 1.) * ( 1. - mip);\n  }\n  #endif\n\n//  col = max(0., col * 1.25 - .05);\n  col = pow(col, 1.5);\n  col *= _GroundBoost;\n\n\tvec3 col3 = applyFog(vec3(col), vDist, _CamPos, normalize(vPos - _CamPos));\n\tcol3 = post(col3);\n\tcol3 = addNoise(col3);\n\n  gl_FragColor = vec4(col3, 1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\nuniform highp vec3 _CamPos;\n\nvarying highp vec2 vUV;\nvarying vec3 vPos;\nvarying float vDist;\n\nvoid main(void) {\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n\tvUV = vec2(aPos.x, -aPos.z )/ 50. + .5;\n\tvDist = distance(vPos, _CamPos);\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision highp float;\n#endif\n\nuniform highp vec3 _CamPos;\n\nuniform mediump sampler2D _MainTex;\nuniform mediump sampler2D _MetallicGlossMap;\n#ifdef SNOW\nuniform mediump sampler2D _SnowDetail;\n#endif\n\n#ifndef MOBILE\nuniform sampler2D _BumpMap;\n#endif\n\nvarying highp vec3 vWorld;\nvarying vec2 vUV;\nvarying highp float vDist;\n\n#ifdef MOBILE\nvarying vec3 vNormal;\n#else\nvarying mat3 vTBN;\n#endif\n\n#ifdef TRANSPARENT\nuniform float _Alpha;\n#endif\n\n#ifdef SNOW\nvarying vec3 vPos;\n#endif\n\n#include include/common.glsl\n\nvec3 ModifiedFresnel(const float cosTheta, const vec3 F0, const float roughness) {\n\treturn F0 + (max(vec3(1.-roughness), F0) - F0) * pow(1.0 - cosTheta, 5.0);\n}\n\nfloat DistributionGGX(const vec3 N,const  vec3 H,const  float roughness) {\n    float a      = roughness*roughness;\n    float a2     = a*a;\n    float NdotH  = max(dot(N, H), 0.0);\n    float NdotH2 = NdotH*NdotH;\n\n    float num   = a2;\n    float denom = (NdotH2 * (a2 - 1.0) + 1.0);\n    denom = denom * denom;\n\n    return num / denom;\n}\n\nfloat GeometrySmith(const float NdotV, const float NdotL, const float roughness) {\n\tfloat r = (roughness + 1.0);\n\tfloat k = (r*r) / 8.0;\n\n\tfloat denom = NdotV * (1.0 - k) + k;\n\tfloat denom2 = NdotL * (1.0 - k) + k;\n\n\treturn 1. / (denom * denom2);\n}\n\nvoid main(void) {\n\tvec3 color = texture2D(_MainTex, vUV).rgb;\n\tvec3 mge = texture2D(_MetallicGlossMap, vUV).rgb;\n\n\t#ifdef MOBILE\n\tvec3 N = normalize(vNormal);\n\t#else\n\tvec3 normal =  texture2D(_BumpMap, vUV).rgb * 2. - 1.;\n\tvec3 N = normalize(vTBN * normal); //   normalize(vNormal);\n\t#endif\n\n\tvec3 albedo = color.rgb;\n\talbedo *= albedo;\n\n\tfloat metallic  = mge.x; //_Metallic;\n\tfloat roughness = mge.y; //_Roughness;\n\tfloat occ = .2 + .8 * mge.z;\n\n  #ifdef SNOW\n\tfloat snowoffset = texture2D(_SnowDetail, vWorld.xz * 16.).r * 2. - 1.;\n  float snow = .1 * N.x + N.y - (.5*occ) + roughness * .5 - .5 - snowoffset;\n  if (snow > 0.) {\n    snow = min(1., snow * 4.);\n    albedo = mix(albedo, vec3(0.28), snow);\n    roughness = mix(roughness, 0.9, snow);\n    metallic = mix(metallic, 0., snow);\n  }\n  #endif\n\n\tvec3 V = normalize(_CamPos-vWorld);\n\tvec3 L = _LightDir;\n\tvec3 H = normalize(V+L);\n\tvec3 R = reflect(-V,N);\n\n\tfloat NdotL = max(dot(N, L), 0.0);\n\tfloat NdotV = max(dot(N, V), 0.0);\n\n\tvec3 F0 = vec3(0.04);\n\tF0 = mix(F0, albedo, metallic);\n\n\t// cook-torrance brdf\n\tfloat NDF = DistributionGGX(N, H, roughness);\n\tfloat G   = GeometrySmith(NdotV, NdotL, roughness);\n\tvec3 F    = ModifiedFresnel(NdotV, F0, roughness);\n\n\tvec3 kD = vec3(1.0) - F;\n\tkD *= 1.0 - metallic;\n\n\tvec3 numerator    = NDF * G * F;\n//\tconst float denominator = 4.0;\n\tvec3 specular     = numerator * .25; //max(denominator, 0.001);\n\n\t// add to outgoing radiance Lo\n\tvec3 col = (kD * albedo + specular) /* * _LightColor*/ * (_LightStrength * NdotL);\n\n\tcol += getSkyColorIBL(R, roughness, NdotL) * F * _AmbientStrength;\n\tcol += getSkyColorIBL(N, 1.5, NdotL) * albedo * kD * _AmbientStrength;\n\n\tcol *= occ;\n\n\tcol = applyFog(col, vDist, _CamPos, normalize(vWorld - _CamPos));\n\tcol = post(col);\n\n#ifdef TRANSPARENT\n  float alpha = max(0., _Alpha + hash13(vWorld) * .1 - 0.05);\n\tgl_FragColor = vec4(col * alpha, alpha);\n#else\n\tcol = addNoise(col);\n\tgl_FragColor = vec4(col, 1);\n#endif\n}\n"},function(e,t){e.exports="attribute vec4 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nuniform highp vec3 _CamPos;\n\nattribute vec4 aTangent;\n\nvarying vec3 vWorld;\nvarying vec2 vUV;\nvarying float vDist;\n\n#ifdef MOBILE\nvarying vec3 vNormal;\n#else\nvarying mat3 vTBN;\n#endif\n\n\n#ifdef SNOW\nvarying vec3 vPos;\n#endif\n\nvoid main(void) {\n  vWorld = (_Model*vec4(aPos.xyz, 1.)).xyz;\n  vUV = aUV0;\n\n#ifdef MOBILE\n  vNormal = (_Model * vec4(aNormal,0)).xyz;\n#else\n  vec3 B = normalize(cross( aTangent.xyz, aNormal));\n  B *= aTangent.w;\n  vTBN = mat3(aTangent.xyz, B, aNormal);\n  vTBN = mat3(_Model) * vTBN;\n#endif\n\n#ifdef SNOW\n  vPos = aPos.xyz;\n#endif\n\n  gl_Position = _ViewProjection * vec4(vWorld,1.);\n  vDist = distance(_CamPos, vWorld);\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision highp float;\n#endif\n\nuniform vec3 _CamPos;\nuniform float _Scale;\nuniform float _Fade;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\nvarying vec3 vNormal;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n//  float r = .02/_Scale;\n//  float radius = length(vUV-.5)*2.;\n//  float alpha = smoothstep(1., .98, radius) * smoothstep(.98-r, 1.-r, radius) * _Fade;\n\n\n#ifdef MOBILE\n\tvec3 col = _SOSColor;\n#else\n  float fresnell = clamp(1.+dot(normalize(vNormal),normalize(vPos - _CamPos)), 0., 1.);\n\tvec3 col = _SOSColor  * (.75 + .25*fresnell);\n#endif\n\n  float fade = smoothstep(.75, 1., _Fade) * .275;\n\tfloat alpha = fade - fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos));\n\n  gl_FragColor = vec4(col * (alpha * .9), alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\nvarying vec3 vNormal;\n\nvoid main(void) {\n  vUV = aUV0;\n\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\tvPos = pos.xyz;\n\n  vNormal = mat3(_Model) * normalize(aNormal);\n\n\tgl_Position = _ViewProjection * pos;\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform highp sampler2D _Texture;\nuniform highp vec3 _CamPos;\nuniform highp float _CloudScale;\nuniform highp float _CloudContrast;\nuniform highp vec2 _Offset;\n\nvarying highp vec2 vUV;\nvarying highp vec3 vPos;\n\n#include include/common.glsl\n\nvoid main(void) {\n\thighp vec2 uv = vUV * _CloudScale - _Offset;\n\thighp vec2 uvDetail = (uv + .2) * mat2(-0.829,0.559,-0.559,-0.829) * 6.3;\n\n\tfloat bc = texture2D(_Texture, uv).x;\n\tfloat dc = texture2D(_Texture, uvDetail).x;\n\n\tfloat c = bc + (dc-.5) * .2;\n\tvec3 rd = normalize(vPos - _CamPos);\n\n\tvec3 col = getSkyColor(rd) * mix(1., 2. * smoothstep(0.,1.,c), _CloudContrast);\n\n\thighp float dist = distance(vPos, _CamPos);\n\n\tcol = applyFog(col, dist, _CamPos, rd);\n\tcol = post(col);\n\tcol = addNoise(col);\n\n  gl_FragColor = vec4(col,1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform float _RadiusEarth;\nuniform float _CloudHeight;\n\nvarying vec2 vUV;\nvarying vec3 vPos;\n\n\nvoid main(void) {\n\tvec4 pos = vec4( aPos.xyz, 1.);\n\n\tfloat scale = sqrt(_RadiusEarth*_RadiusEarth - (_RadiusEarth-_CloudHeight) * (_RadiusEarth-_CloudHeight));\n\tpos.xz *= scale;\n\tpos.y = _RadiusEarth - _CloudHeight;;\n\tpos.xyz = normalize(pos.xyz) * _RadiusEarth;\n\tpos.y -= _RadiusEarth - _CloudHeight;\n\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n\tvUV = aUV0;\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform float _Color;\n\nvarying vec2 vUV;\nvarying vec3 vPos;\nvarying float vOpacity;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tfloat f = vOpacity;\n\tf *= clamp(1.-2.*dot(vUV, vUV), 0., 1.);\n\tf = max(.01, f);\n\tfloat c = postScalar(_Color);\n  gl_FragColor = vec4(c, c, c ,f);\n//  gl_FragColor = vec4(vUV +.5, 0., 1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform float _ParticleSize;\nuniform float _Opacity;\n\nuniform vec3 _SnowOffset;\nuniform vec3 _CubeOffset;\n\nuniform float _ParticleAreaSize;\n\nuniform vec3 _OldSnowOffset;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _OldViewProjection;\n\nuniform float _Particles;\nuniform float _Aspect;\nuniform vec3 _CamPos;\n\nuniform float _Time;\nuniform float _TimeFull;\nuniform float _OldTimeFull;\n\n\nvarying vec2 vUV;\nvarying vec3 vPos;\nvarying float vOpacity;\n\n\n//----------------------------------------------------------------------------------------\n///  3 out, 3 in...\n#define HASHSCALE3 vec3(.1031, .1030, .0973)\nvec3 hash33(vec3 p3) {\n\tp3 = fract(p3 * HASHSCALE3);\n    p3 += dot(p3, p3.yxz+19.19);\n    return fract((p3.xxy + p3.yxx)*p3.zyx);\n\n}\n\nmat2 rotate2d(float _angle){\n    return mat2(cos(_angle),-sin(_angle),\n                sin(_angle),cos(_angle));\n}\n\nvoid main(void) {\n\tfloat scale = 1./_ParticleAreaSize;\n\n\tvec3 gridPos = aPos.xyz + floor(_CubeOffset*scale) - floor(_SnowOffset);\n\n  vec3 h0 = hash33(gridPos);\n  vec3 h1 = hash33(gridPos.zyx);\n\n\tvec3 worldPos =  (aPos.xyz + floor(_CubeOffset*scale) + fract(_SnowOffset) + h0 - .5 + sin(_TimeFull*h1))*(1./scale);\n\tvec3 oldWorldPos =  (aPos.xyz + floor(_CubeOffset*scale)+ fract(_SnowOffset) + (_OldSnowOffset - _SnowOffset) + h0 - .5 + sin(_OldTimeFull*h1))*(1./scale);\n\n\tvec4 pos = _ViewProjection * vec4(worldPos, 1.);\n\tvec4 oldPos = _OldViewProjection * vec4(oldWorldPos, 1.);\n\n\tfloat vLength = min(.025,distance(pos, oldPos));\n\toldPos = pos + vLength * normalize(oldPos - pos);\n\n\tvec2 posProj = pos.xy/pos.w;\n\tvec2 oldPosProj = oldPos.xy/oldPos.w;\n\n\tvUV = aUV0 - .5;\n  if (oldPosProj.x > posProj.x) {\n    vUV.x = -vUV.x;\n  }\n\n  vUV *= min(1., .75+.25*sin(h0.x * 6.28318530718 + h1.y * _TimeFull * 6.28318530718));\n\n\tgl_Position = vUV.x > 0. ? pos : oldPos;\n\tgl_Position.xy +=vUV *(.003 * _ParticleSize) * vec2(1., _Aspect);\n\n\tfloat vDist = distance(_CamPos, worldPos) * (.5 * scale / _Particles);\n\tfloat motionBlurOpacity = (.1+.9*smoothstep(.025, 0.0, distance(posProj * vec2(1.,1./ _Aspect),oldPosProj * vec2(1.,1./ _Aspect))));\n\n  vOpacity = clamp(smoothstep(1.,.9,vDist) * motionBlurOpacity * 2. * _Opacity, 0., 1.);\n\n\tif (pos.w < 0. || oldPos.w < 0. || vOpacity < 1./255.) {\n\t\tgl_Position = vec4(-1000,-1000,1,1);\n\t}\n\n  vUV = normalize(vUV);\n\n // vUV.x *= 3.; //1./min(1., 2.1+2.*sin(h0.x * 6.28318530718 + h1.y * _TimeFull));\n//  vUV.y = 0.;\n//  vUV = rotate2d( _TimeFull * 6.28318530718) * vUV; // h1.x * 6.28318530718 + (h1.y -.5) *\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec4 _SnowCoordinate;\nuniform float _NewSnow;\n\nuniform sampler2D uTexture;\nuniform sampler2D _SnowTexture;\n\nuniform float _MoveX;\nuniform float _MoveY;\n\nuniform mediump float _Aspect;\n\nvarying vec2 vUV;\n\n#define HASHSCALE1 443.8975\n\nhighp float hash13(highp vec3 p3) {\n\tp3  = fract(p3 * HASHSCALE1);\n\tp3 += dot(p3, p3.yzx + 19.19);\n\treturn fract((p3.x + p3.y) * p3.z);\n}\n\nvoid main(void) {\n    float snow = mix(\n      texture2D(uTexture, vUV).r,\n      texture2D(uTexture, vUV + clamp(\n        vec2(_MoveX, _MoveY) * (-50.*hash13(vec3(vUV, _MoveX)) * (abs(vUV-.5) - .5)\n        ),vec2(-.01),vec2(.01)) ).r, .3);\n\n    if ( _NewSnow > .5) {\n      vec2 d = vUV - _SnowCoordinate.xy;\n      d.x *= _Aspect;\n      float radius = max(_SnowCoordinate.w, _SnowCoordinate.z) + .5;\n      float newsnow = smoothstep(.1 * radius, 0., length(d)) * _SnowCoordinate.w;\n      newsnow *= texture2D(_SnowTexture, vUV * vec2(1., 1. / _Aspect) - _SnowCoordinate.zw).r;\n      snow = sqrt(snow*snow + newsnow*newsnow);\n    }\n\n    snow = clamp(snow - (1./255.), 0., 1.);\n\n  \tgl_FragColor = vec4(snow,snow,snow,1);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec2 aUV0;\n\n//uniform mediump float _Aspect;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform float _Scale;\nuniform float _Fade;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tvec3 col = _SOSColor;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n//  float r = .02/_Scale;\n//  float radius = length(vUV-.5)*2.;\n//  float alpha = smoothstep(1., .98, radius) * smoothstep(.98-r, 1.-r, radius) * _Fade;\n  float fade = _Fade * .25;\n\tfloat alpha = fade - fade * fogAmount(dist, _CamPos, normalize(vPos - _CamPos));\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n}\n\n\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform sampler2D _Texture;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\nvoid main(void) {\n\tfloat alpha = texture2D(_Texture, vUV).r;\n\n\tfloat dist = distance(vPos, _CamPos);\n\tvec3 col = applyFog(vec3(1), dist, _CamPos, normalize(vPos - _CamPos));\n\tcol = post(col);\n\tcol = addNoise(col);\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\n\tvPos = pos.xyz;\n\tvNormal = (_Model * vec4( aNormal, 0.0)).xyz;\n\tvUV = aUV0;\n\n\tgl_Position = _ViewProjection * pos;\n}\n"},function(e,t){e.exports="#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nuniform vec3 _CamPos;\nuniform float _Progress;\nuniform float _Segments;\nuniform float _Fade;\nuniform float _Fill;\n\nvarying highp vec3 vPos;\nvarying vec2 vUV;\n\n#include include/common.glsl\n\n\nvoid main(void) {\n\tvec3 col = _UIColor;\n\n\tfloat dist = distance(vPos, _CamPos);\n\n//  col *= vignette();\n\n  float alpha = smoothstep(.25,.26,abs(fract(vUV.y*_Segments)-.5));\n\n  alpha = mix(alpha, _Fill, step(1.-vUV.y, _Progress)) * _Fade;\n\n//  float circle = length( vec2(vUV.x - .5, (_Progress - 1. + vUV.y) * _Segments * 10.));\n//  circle = smoothstep(.5, .45, circle);\n//\n//  col = mix(col, vec3(1), circle);\n//  alpha = mix(alpha, 1., circle);\n\n\talpha *= 1. - fogAmount(dist, _CamPos, normalize(vPos - _CamPos));\n\n  gl_FragColor = vec4(col * alpha, alpha);\n}\n\n\n"},function(e,t){e.exports="attribute vec3 aPos;\nattribute vec3 aNormal;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\nvarying vec3 vPos;\nvarying vec2 vUV;\n\nvoid main(void) {\n  vUV = aUV0;\n\n\tvec4 pos = _Model * vec4( aPos, 1.0);\n\tvPos = pos.xyz;\n\n\tgl_Position = _ViewProjection * pos;\n}\n\n\n"},,,,,,,,,,,,,,,,,function(e,t,n){var i={"./en-gb.json":[580,0]};function r(e){var t=i[e];return t?n.e(t[1]).then(function(){var e=t[0];return n.t(e,3)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}r.keys=function(){return Object.keys(i)},r.id=575,e.exports=r},,,,function(e,t,n){"use strict";n.r(t);n(348);var i=n(20),r=n(112),a=n.n(r),s=n(245),o=(n(349),n(15));o.a.sensibleDefaults=!1;var l={},u=n(351),h={name:"Icon",props:{name:o.a.string.isRequired},computed:{icon:function(){return u("./".concat(this.name,".svg"))}}},c=n(139),d=n(10);var f=Object(d.a)(h,function(){var e=this.$createElement;return(this._self._c||e)("span",{class:[this.$style.icon],domProps:{innerHTML:this._s(this.icon)}})},[],!1,function(e){this.$style=c.default.locals||c.default},null,null);f.options.__file="Icon.vue";var _={Icon:f.exports},p=n(177),v="production",m="development",g="staging",A="local",y={LOCALE:"locale",API:"api"},E={LOCALE_ENABLED:"locale-enabled",LOCALE_ROUTING_ENABLED:"locale-routing-enabled",STATIC_ROOT:"static-root",PUBLIC_PATH:"public-path",VERSIONED_STATIC_ROOT:"versioned-static-root"},T={DEFAULT_LOCALE:"default-locale",AVAILABLE_LOCALES:"available-locales",PERSIST_QUERY_PARAMS:"persist-query-params"},C={},w=function(e,t){C[e]=t},R=function(e){return C[e]},S="configManager",I=function(){var e=R(S),t=e.getProperty(T.AVAILABLE_LOCALES).map(function(e){return"string"===typeof e?{code:e,urlPrefix:e,translationKey:e}:e}),n={persistent:!1,defaultCode:e.getProperty(T.DEFAULT_LOCALE),languages:t};return{localeEnabled:e.getVariable(E.LOCALE_ENABLED),localeRoutingEnabled:e.getVariable(E.LOCALE_ROUTING_ENABLED),config:n}},b={HOME:"home",WEBGL:"webgl",COMPONENT:"component"},x="/",k="/webgl",M="/component",P=n(22),F=n.n(P),N=n(140),D=n.n(N),O=n(9),L=n(113),U=n.n(L),B=n(13),V=n.n(B),H=n(0),G=n.n(H),z=n(1),W=n.n(z),j=n(3),X=n.n(j),Y=n(2),K=n.n(Y),$=n(4),Q=n.n($),J=n(7),Z=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){this.parentElement=t}},{key:"showUI",value:function(){var e=new J.TimelineMax({paused:!0});e.add(this.getTimeline("soundPlayer"),0),e.play()}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),q=function(e){return 1- --e*e*e*e},ee=n(5);!function(e){var t=e.GreenSockGlobals||e,n=function(e){var n,i=e.split("."),r=t;for(n=0;n<i.length;n++)r[i[n]]=r=r[i[n]]||{};return r}("com.greensock.utils"),i=document,r=i.defaultView?i.defaultView.getComputedStyle:function(){},a=/([A-Z])/g,s=function(e,t,n,i){var s;return(n=n||r(e,null))?s=(e=n.getPropertyValue(t.replace(a,"-$1").toLowerCase()))||n.length?e:n[t]:e.currentStyle&&(s=(n=e.currentStyle)[t]),i?s:parseInt(s,10)||0},o=function(e){return!!(e.length&&e[0]&&(e[0].nodeType&&e[0].style&&!e.nodeType||e[0].length&&e[0][0]))},l=function(e,t){for(var n,i=t.length;--i>-1;)if(n=t[i],e.substr(0,n.length)===n)return n.length},u=/(?:\r|\n|\t\t)/g,h=/(?:\s\s+)/g,c=function(e){return(e.charCodeAt(0)-55296<<10)+(e.charCodeAt(1)-56320)+65536},d=" style='position:relative;display:inline-block;"+(i.all&&!i.addEventListener?"*display:inline;*zoom:1;'":"'"),f=function(e,t){var n=-1!==(e=e||"").indexOf("++"),i=1;return n&&(e=e.split("++").join("")),function(){return"<"+t+d+(e?" class='"+e+(n?i++:"")+"'>":">")}},_=n.SplitText=t.SplitText=function(e,t){if("string"===typeof e&&(e=_.selector(e)),!e)throw"cannot split a null element.";this.elements=o(e)?function(e){var t,n,i,r=[],a=e.length;for(t=0;t<a;t++)if(n=e[t],o(n))for(i=n.length,i=0;i<n.length;i++)r.push(n[i]);else r.push(n);return r}(e):[e],this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=t||{},this.split(t)},p=function e(t,n,i){var r=t.nodeType;if(1===r||9===r||11===r)for(t=t.firstChild;t;t=t.nextSibling)e(t,n,i);else 3!==r&&4!==r||(t.nodeValue=t.nodeValue.split(n).join(i))},v=function(e,t){for(var n=t.length;--n>-1;)e.push(t[n])},m=function(e){var t,n=[],i=e.length;for(t=0;t!==i;n.push(e[t++]));return n},g=function(e,t,n){for(var i;e&&e!==t;){if(i=e._next||e.nextSibling)return i.textContent.charAt(0)===n;e=e.parentNode||e._parent}return!1},A=function e(t){var n,i,r=m(t.childNodes),a=r.length;for(n=0;n<a;n++)(i=r[n])._isSplit?e(i):(n&&3===i.previousSibling.nodeType?i.previousSibling.nodeValue+=3===i.nodeType?i.nodeValue:i.firstChild.nodeValue:3!==i.nodeType&&t.insertBefore(i.firstChild,i),t.removeChild(i))},y=function(e,t,n,a,o,l,u){var h,c,d,f,_,m,y,E,T,C,w,R,S=r(e),I=s(e,"paddingLeft",S),b=-999,x=s(e,"borderBottomWidth",S)+s(e,"borderTopWidth",S),k=s(e,"borderLeftWidth",S)+s(e,"borderRightWidth",S),M=s(e,"paddingTop",S)+s(e,"paddingBottom",S),P=s(e,"paddingLeft",S)+s(e,"paddingRight",S),F=.2*s(e,"fontSize"),N=s(e,"textAlign",S,!0),D=[],O=[],L=[],U=t.wordDelimiter||" ",B=t.span?"span":"div",V=t.type||t.split||"chars,words,lines",H=o&&-1!==V.indexOf("lines")?[]:null,G=-1!==V.indexOf("words"),z=-1!==V.indexOf("chars"),W="absolute"===t.position||!0===t.absolute,j=t.linesClass,X=-1!==(j||"").indexOf("++"),Y=[];for(X&&(j=j.split("++").join("")),d=(c=e.getElementsByTagName("*")).length,_=[],h=0;h<d;h++)_[h]=c[h];if(H||W)for(h=0;h<d;h++)((m=(f=_[h]).parentNode===e)||W||z&&!G)&&(R=f.offsetTop,H&&m&&Math.abs(R-b)>F&&("BR"!==f.nodeName||0===h)&&(y=[],H.push(y),b=R),W&&(f._x=f.offsetLeft,f._y=R,f._w=f.offsetWidth,f._h=f.offsetHeight),H&&((f._isSplit&&m||!z&&m||G&&m||!G&&f.parentNode.parentNode===e&&!f.parentNode._isSplit)&&(y.push(f),f._x-=I,g(f,e,U)&&(f._wordEnd=!0)),"BR"===f.nodeName&&(f.nextSibling&&"BR"===f.nextSibling.nodeName||0===h)&&H.push([])));for(h=0;h<d;h++)m=(f=_[h]).parentNode===e,"BR"!==f.nodeName?(W&&(T=f.style,G||m||(f._x+=f.parentNode._x,f._y+=f.parentNode._y),T.left=f._x+"px",T.top=f._y+"px",T.position="absolute",T.display="block",T.width=f._w+1+"px",T.height=f._h+"px"),!G&&z?f._isSplit?(f._next=f.nextSibling,f.parentNode.appendChild(f)):f.parentNode._isSplit?(f._parent=f.parentNode,!f.previousSibling&&f.firstChild&&(f.firstChild._isFirst=!0),f.nextSibling&&" "===f.nextSibling.textContent&&!f.nextSibling.nextSibling&&Y.push(f.nextSibling),f._next=f.nextSibling&&f.nextSibling._isFirst?null:f.nextSibling,f.parentNode.removeChild(f),_.splice(h--,1),d--):m||(R=!f.nextSibling&&g(f.parentNode,e,U),f.parentNode._parent&&f.parentNode._parent.appendChild(f),R&&f.parentNode.appendChild(i.createTextNode(" ")),t.span&&(f.style.display="inline"),D.push(f)):f.parentNode._isSplit&&!f._isSplit&&""!==f.innerHTML?O.push(f):z&&!f._isSplit&&(t.span&&(f.style.display="inline"),D.push(f))):H||W?(f.parentNode&&f.parentNode.removeChild(f),_.splice(h--,1),d--):G||e.appendChild(f);for(h=Y.length;--h>-1;)Y[h].parentNode.removeChild(Y[h]);if(H){for(W&&(C=i.createElement(B),e.appendChild(C),w=C.offsetWidth+"px",R=C.offsetParent===e?0:e.offsetLeft,e.removeChild(C)),T=e.style.cssText,e.style.cssText="display:none;";e.firstChild;)e.removeChild(e.firstChild);for(E=" "===U&&(!W||!G&&!z),h=0;h<H.length;h++){for(y=H[h],(C=i.createElement(B)).style.cssText="display:block;text-align:"+N+";position:"+(W?"absolute;":"relative;"),j&&(C.className=j+(X?h+1:"")),L.push(C),d=y.length,c=0;c<d;c++)"BR"!==y[c].nodeName&&(f=y[c],C.appendChild(f),E&&f._wordEnd&&C.appendChild(i.createTextNode(" ")),W&&(0===c&&(C.style.top=f._y+"px",C.style.left=I+R+"px"),f.style.top="0px",R&&(f.style.left=f._x-R+"px")));0===d?C.innerHTML="&nbsp;":G||z||(A(C),p(C,String.fromCharCode(160)," ")),W&&(C.style.width=w,C.style.height=f._h+"px"),e.appendChild(C)}e.style.cssText=T}W&&(u>e.clientHeight&&(e.style.height=u-M+"px",e.clientHeight<u&&(e.style.height=u+x+"px")),l>e.clientWidth&&(e.style.width=l-P+"px",e.clientWidth<l&&(e.style.width=l+k+"px"))),v(n,D),v(a,O),v(o,L)},E=function e(t,n,r,a){var o,d,f=m(t.childNodes),_=f.length,v="absolute"===n.position||!0===n.absolute;if(3!==t.nodeType||_>1){for(n.absolute=!1,o=0;o<_;o++)(3!==(d=f[o]).nodeType||/\S+/.test(d.nodeValue))&&(v&&3!==d.nodeType&&"inline"===s(d,"display",null,!0)&&(d.style.display="inline-block",d.style.position="relative"),d._isSplit=!0,e(d,n,r,a));return n.absolute=v,void(t._isSplit=!0)}!function(e,t,n,r){var a,s,o,d,f,_,v,m,g,A,y=t.span?"span":"div",E=-1!==(t.type||t.split||"chars,words,lines").indexOf("chars"),T="absolute"===t.position||!0===t.absolute,C=t.wordDelimiter||" ",w=" "!==C?"":T?"&#173; ":" ",R=t.span?"</span>":"</div>",S=!0,I=t.specialChars?"function"===typeof t.specialChars?t.specialChars:l:null,b=i.createElement("div"),x=e.parentNode;for(x.insertBefore(b,e),b.textContent=e.nodeValue,x.removeChild(e),v=-1!==(a=function e(t){var n=t.nodeType,i="";if(1===n||9===n||11===n){if("string"===typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=e(t)}else if(3===n||4===n)return t.nodeValue;return i}(e=b)).indexOf("<"),!1!==t.reduceWhiteSpace&&(a=a.replace(h," ").replace(u,"")),v&&(a=a.split("<").join("{{LT}}")),f=a.length,s=(" "===a.charAt(0)?w:"")+n(),o=0;o<f;o++)if(_=a.charAt(o),I&&(A=I(a.substr(o),t.specialChars)))_=a.substr(o,A||1),s+=E&&" "!==_?r()+_+"</"+y+">":_,o+=A-1;else if(_===C&&a.charAt(o-1)!==C&&o){for(s+=S?R:"",S=!1;a.charAt(o+1)===C;)s+=w,o++;o===f-1?s+=w:")"!==a.charAt(o+1)&&(s+=w+n(),S=!0)}else"{"===_&&"{{LT}}"===a.substr(o,6)?(s+=E?r()+"{{LT}}</"+y+">":"{{LT}}",o+=5):_.charCodeAt(0)>=55296&&_.charCodeAt(0)<=56319||a.charCodeAt(o+1)>=65024&&a.charCodeAt(o+1)<=65039?(m=c(a.substr(o,2)),g=c(a.substr(o+2,2)),d=m>=127462&&m<=127487&&g>=127462&&g<=127487||g>=127995&&g<=127999?4:2,s+=E&&" "!==_?r()+a.substr(o,d)+"</"+y+">":a.substr(o,d),o+=d-1):s+=E&&" "!==_?r()+_+"</"+y+">":_;e.outerHTML=s+(S?R:""),v&&p(x,"{{LT}}","<")}(t,n,r,a)},T=_.prototype;T.split=function(e){this.isSplit&&this.revert(),this.vars=e=e||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;for(var t,n,i,r=this.elements.length,a=e.span?"span":"div",s=f(e.wordsClass,a),o=f(e.charsClass,a);--r>-1;)i=this.elements[r],this._originals[r]=i.innerHTML,t=i.clientHeight,n=i.clientWidth,E(i,e,s,o),y(i,e,this.chars,this.words,this.lines,n,t);return this.chars.reverse(),this.words.reverse(),this.lines.reverse(),this.isSplit=!0,this},T.revert=function(){if(!this._originals)throw"revert() call wasn't scoped properly.";for(var e=this._originals.length;--e>-1;)this.elements[e].innerHTML=this._originals[e];return this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this},_.selector=e.$||e.jQuery||function(t){var n=e.$||e.jQuery;return n?(_.selector=n,n(t)):"undefined"===typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t)},_.version="0.6.1"}(ee.k);var te=ee.m.SplitText,ne=n(138),ie=n.n(ne),re=/(^\s+|\s+$)/g,ae=/\s+/g,se=function(e,t){for(var n=t.length,i="";--e>-1;)i+=t[Math.random()*n|0];return i},oe=function(e){var t;for(this.chars=ce(e),this.sets=[],this.length=50,t=0;t<20;t++)this.sets[t]=se(80,this.chars);this.grow=function(e){for(t=0;t<20;t++)this.sets[t]+=se(e-this.length,this.chars);this.length=e}},le="[\ue000-\uf8ff]|\ud83c[\udc00-\udfff]|\ud83d[\udc00-\udfff]|[\u2694-\u2697]|\ud83e[\udd10-\udd5d]|[\ud800-\udbff][\udc00-\udfff]",ue=new RegExp(le),he=new RegExp(le+"|.","g"),ce=function(e,t,n){return n&&(e=e.replace(re,"")),""!==t&&t||!ue.test(e)?e.split(t||""):e.match(he)},de="ABCDEFGHIJKLMNOPQRSTUVWXYZ",fe=de.toLowerCase(),_e={upperCase:new oe(de),lowerCase:new oe(fe),upperAndLowerCase:new oe(de+fe)},pe=ee.k._gsDefine.plugin({propName:"scrambleText",version:"0.5.2",API:2,overwriteProps:["scrambleText","text"],init:function(e,t,n,i){if(this._prop="innerHTML"in e?"innerHTML":"textContent"in e?"textContent":0,!this._prop)return!1;"function"===typeof t&&(t=t(i,e)),this._target=e,"object"!==ie()(t)&&(t={text:t});var r,a,s,o,l=t.text||t.value,u=!1!==t.trim;return this._delimiter=r=t.delimiter||"",this._original=ce(function e(t){var n=t.nodeType,i="";if(1===n||9===n||11===n){if("string"===typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=e(t)}else if(3===n||4===n)return t.nodeValue;return i}(e).replace(ae," ").split("&nbsp;").join(""),r,u),"{original}"!==l&&!0!==l&&null!=l||(l=this._original.join(r)),this._text=ce((l||"").replace(ae," "),r,u),this._hasClass=!1,"string"===typeof t.newClass&&(this._newClass=t.newClass,this._hasClass=!0),"string"===typeof t.oldClass&&(this._oldClass=t.oldClass,this._hasClass=!0),o=""===r,this._textHasEmoji=ue.test(this._text.join(r))&&o,this._charsHaveEmoji=!!t.chars&&ue.test(t.chars),this._length=o?this._original.length:this._original.join(r).length,this._lengthDif=(o?this._text.length:this._text.join(r).length)-this._length,this._fillChar=t.fillChar||t.chars&&-1!==t.chars.indexOf(" ")?"&nbsp;":"",this._charSet=s=_e[t.chars||"upperCase"]||new oe(t.chars),this._speed=.016/(t.speed||1),this._prevScrambleTime=0,this._setIndex=20*Math.random()|0,(a=this._length+Math.max(this._lengthDif,0))>s.length&&s.grow(a),this._chars=s.sets[this._setIndex],this._revealDelay=t.revealDelay||0,this._tweenLength=!1!==t.tweenLength,this._tween=n,this._rightToLeft=!!t.rightToLeft,!0},set:function(e){var t,n,i,r,a,s,o,l,u,h=this._text.length,c=this._delimiter,d=this._tween._time,f=d-this._prevScrambleTime;this._revealDelay&&(this._tween.vars.runBackwards&&(d=this._tween._duration-d),e=0===d?0:d<this._revealDelay?1e-6:d===this._tween._duration?1:this._tween._ease.getRatio((d-this._revealDelay)/(this._tween._duration-this._revealDelay))),e<0?e=0:e>1&&(e=1),this._rightToLeft&&(e=1-e),t=e*h+.5|0,e?((f>this._speed||f<-this._speed)&&(this._setIndex=(this._setIndex+(19*Math.random()|0))%20,this._chars=this._charSet.sets[this._setIndex],this._prevScrambleTime+=f),r=this._chars):r=this._original.join(c),this._rightToLeft?1!==e||!this._tween.vars.runBackwards&&"isFromStart"!==this._tween.data?(o=this._text.slice(t).join(c),i=this._charsHaveEmoji?ce(r).slice(0,this._length+(this._tweenLength?1-e*e*e:1)*this._lengthDif-(this._textHasEmoji?ce(o):o).length+.5|0).join(""):r.substr(0,this._length+(this._tweenLength?1-e*e*e:1)*this._lengthDif-(this._textHasEmoji?ce(o):o).length+.5|0),r=o):(i="",r=this._original.join(c)):(i=this._text.slice(0,t).join(c),n=(this._textHasEmoji?ce(i):i).length,r=this._charsHaveEmoji?ce(r).slice(n,this._length+(this._tweenLength?1-(e=1-e)*e*e*e:1)*this._lengthDif+.5|0).join(""):r.substr(n,this._length+(this._tweenLength?1-(e=1-e)*e*e*e:1)*this._lengthDif-n+.5|0)),o=this._hasClass?((a=(l=this._rightToLeft?this._oldClass:this._newClass)&&0!==t)?"<span class='"+l+"'>":"")+i+(a?"</span>":"")+((s=(u=this._rightToLeft?this._newClass:this._oldClass)&&t!==h)?"<span class='"+u+"'>":"")+c+r+(s?"</span>":""):i+c+r,this._target[this._prop]="&nbsp;"===this._fillChar&&-1!==o.indexOf("  ")?o.split("  ").join("&nbsp;&nbsp;"):o}}).prototype;for(pe in pe._newClass=pe._oldClass="",_e)_e[pe.toLowerCase()]=_e[pe],_e[pe.toUpperCase()]=_e[pe];var ve,me=function(e,t){var n=new te(e,{type:"chars,lines",position:"relative"}),i=new J.TimelineMax({onComplete:function(){}}),r=t/n.chars.length,a=0;return n.lines.forEach(function(e,n){var s=r*e.childNodes.length+.3*n;e.childNodes.forEach(function(e,t){i.fromTo(e,.1,{autoAlpha:0},{autoAlpha:1},a+r*t)}),i.fromTo(e,s,{x:200},{x:0,ease:J.Expo.easeOut},a);var o=r*e.childNodes.length;a+=o*(o/t)*.9}),i},ge=function(e,t){var n=Array.from(e.querySelectorAll(".js-char"));0===n.length&&(new te(e,{type:"chars",position:"relative",charsClass:"js-char"}),n=Array.from(e.querySelectorAll(".js-char")));var i=new J.TimelineMax({onComplete:function(){}}),r=t/n.length;return n.forEach(function(e,n){var a=q(r*n/t),s=r*n;i.fromTo(e,2*r,{autoAlpha:0},{autoAlpha:1},s*a*.4)}),i},Ae=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){e.fromTo(t.$refs.skipButton,.7,{autoAlpha:0},{autoAlpha:1})}},{key:"showStep1",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs,n=t.copy1,i=t.border1,r=this.parentController.$refs.tag,a=r.offsetWidth;r.querySelector("span").style.width="".concat(a,"px"),r.style.width="".concat(a,"px"),e.fromTo(r,.75,{width:0,x:50},{width:a,x:0,ease:J.Expo.easeOut},0),e.add(me(n,1),0),e.fromTo(i,1.2,{width:"0%",x:50},{width:"100%",x:0,ease:J.Expo.easeOut,clearProps:"width"},1.5)}},{key:"showStep2",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.copy2,n=this.parentController.$refs.border2,i=n.offsetWidth;e.add(me(t,1.5)),e.fromTo(n,1.2,{width:0,x:.05*i},{width:i,x:0,ease:J.Expo.easeOut,clearProps:"width"},1.5)}},{key:"showStep3",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.copy3,n=this.parentController.$refs.border3,i=n.offsetWidth;e.add(me(t,2)),e.fromTo(n,1.2,{width:0,x:.05*i},{width:i,x:0,ease:J.Expo.easeOut,clearProps:"width"},0)}},{key:"showStep4",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs,n=(t.tag,t.copy1,t.copy2,t.copy3,t.copy4);t.border;e.add(me(n,2))}},{key:"hideStep",value:function(e){(new J.TimelineMax).to(e,.35,{autoAlpha:0})}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),ye=i.a.extend({data:function(){return{active:!1}},created:function(){this.chapterName=void 0,this.progress={value:0}},methods:{routeIn:function(e,t){this.active=!0,this.$el.classList.add("active"),this.chapterName=e.url.substring(1),this.transitionIn(t)},routeOut:function(e,t){var n=this;this.active=!1,this.transitionOut(function(){n.$el.classList.remove("active"),t()})},resize:function(){}}}),Ee=n(11),Te=n.n(Ee);!function(e){e[e.INTRO_0=0]="INTRO_0",e[e.INTRO_1=1]="INTRO_1",e[e.INTRO_2=2]="INTRO_2",e[e.INTRO_3=3]="INTRO_3",e[e.START=4]="START",e[e.DROP_OFF=5]="DROP_OFF",e[e.START_TREK_1=6]="START_TREK_1",e[e.TREK_1_1=7]="TREK_1_1",e[e.TREK_1_2=8]="TREK_1_2",e[e.CRASH_1=9]="CRASH_1",e[e.START_TO_PICK_UP_1=10]="START_TO_PICK_UP_1",e[e.TO_PICK_UP_1=11]="TO_PICK_UP_1",e[e.WAIT_FOR_HELI_1_1=12]="WAIT_FOR_HELI_1_1",e[e.WAIT_FOR_HELI_1_2=13]="WAIT_FOR_HELI_1_2",e[e.START_TREK_2=14]="START_TREK_2",e[e.TREK_2=15]="TREK_2",e[e.CRASH_HELI_1=16]="CRASH_HELI_1",e[e.START_TREK_3=17]="START_TREK_3",e[e.TREK_3=18]="TREK_3",e[e.PICK_UP_2_1=19]="PICK_UP_2_1",e[e.PICK_UP_2_2=20]="PICK_UP_2_2",e[e.PICK_UP_2_3=21]="PICK_UP_2_3",e[e.PICK_UP_2_4=22]="PICK_UP_2_4",e[e.PICK_UP_2_5=23]="PICK_UP_2_5",e[e.WAIT_FOR_HELI_2_1=24]="WAIT_FOR_HELI_2_1",e[e.WAIT_FOR_HELI_2_2=25]="WAIT_FOR_HELI_2_2",e[e.WAIT_FOR_HELI_2_3=26]="WAIT_FOR_HELI_2_3",e[e.END_SEQUENCE_START=27]="END_SEQUENCE_START",e[e.END_SEQUENCE_END=28]="END_SEQUENCE_END",e[e.LENGTH=29]="LENGTH"}(ve||(ve={}));var Ce,we=ve,Re=we,Se=(Ce={},Te()(Ce,we.INTRO_0,{duration:5,narration:""}),Te()(Ce,we.INTRO_1,{duration:6,narration:""}),Te()(Ce,we.INTRO_2,{duration:6,narration:""}),Te()(Ce,we.INTRO_3,{duration:8,narration:""}),Te()(Ce,we.INTRO_3,{duration:8,narration:""}),Te()(Ce,we.START,{duration:20,narration:""}),Te()(Ce,we.DROP_OFF,{duration:4,narration:""}),Te()(Ce,we.START_TREK_1,{duration:8,narration:""}),Te()(Ce,we.TREK_1_1,{duration:12,narration:""}),Te()(Ce,we.TREK_1_2,{duration:12,narration:""}),Te()(Ce,we.CRASH_1,{duration:4,narration:""}),Te()(Ce,we.START_TO_PICK_UP_1,{duration:12,narration:""}),Te()(Ce,we.TO_PICK_UP_1,{duration:12,narration:""}),Te()(Ce,we.WAIT_FOR_HELI_1_1,{duration:8,narration:""}),Te()(Ce,we.WAIT_FOR_HELI_1_2,{duration:16,narration:""}),Te()(Ce,we.START_TREK_2,{duration:6,narration:""}),Te()(Ce,we.TREK_2,{duration:8,narration:""}),Te()(Ce,we.CRASH_HELI_1,{duration:4,narration:""}),Te()(Ce,we.START_TREK_3,{duration:6,narration:""}),Te()(Ce,we.TREK_3,{duration:8,narration:""}),Te()(Ce,we.PICK_UP_2_1,{duration:3,narration:""}),Te()(Ce,we.PICK_UP_2_2,{duration:3,narration:""}),Te()(Ce,we.PICK_UP_2_3,{duration:3,narration:""}),Te()(Ce,we.PICK_UP_2_4,{duration:3,narration:""}),Te()(Ce,we.PICK_UP_2_5,{duration:6,narration:""}),Te()(Ce,we.WAIT_FOR_HELI_2_1,{duration:2.5,narration:""}),Te()(Ce,we.WAIT_FOR_HELI_2_2,{duration:2.5,narration:""}),Te()(Ce,we.WAIT_FOR_HELI_2_3,{duration:2.5,narration:""}),Te()(Ce,we.END_SEQUENCE_START,{duration:10,narration:""}),Te()(Ce,we.END_SEQUENCE_END,{duration:10,narration:""}),Te()(Ce,we.LENGTH,{duration:2,narration:""}),Ce),Ie=n(114),be=n.n(Ie),xe=n(8),ke=n.n(xe),Me=function(){function e(){G()(this,e),this.isDestructed=!1}return W()(e,[{key:"throwAlreadyDestructed",value:function(){console.error("Cannot destruct twice")}},{key:"destruct",value:function(){this.isDestructed=!0,this.destruct=this.throwAlreadyDestructed}}]),e}(),Pe=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return G()(this,t),(n=X()(this,K()(t).call(this))).dataName=null,n.exposed=!1,n.name=e,n._callback=r,n._materials=i||[],n}return Q()(t,e),W()(t,[{key:"expose",value:function(){this.exposed=!0}},{key:"getValue",value:function(){return this._value}},{key:"setUpdateUICallback",value:function(e){this._updateUIcallback=e}},{key:"setChangeCallback",value:function(e){this._callback=e}},{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e!==this._value&&(this._value=e,this.setShaderUniform(e),this._callback&&n&&this._callback(this._value),!t&&this._updateUIcallback&&this._updateUIcallback.call(this,this.getValue()))}},{key:"setFromUI",value:function(e){this.setValue(e,!0)}},{key:"setShaderUniform",value:function(e){console.log("warning: override this")}}]),t}(Me),Fe=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return G()(this,t),X()(this,K()(t).call(this,e,null,n))}return Q()(t,e),W()(t,[{key:"getValue",value:function(){return this._callback}}]),t}(Pe),Ne=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return G()(this,t),(i=X()(this,K()(t).call(this,null!==a?a:e,r,s))).setValue(n),i}return Q()(t,e),W()(t,[{key:"setShaderUniform",value:function(e){for(var t=0;t<this._materials.length;t++)this._materials[t].setFloat(this.name,!0===e?1:0)}}]),t}(Pe),De=n(6),Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;G()(this,e),this.v=De.e.fromValues(t,n,i)}return W()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.z)}},{key:"copy",value:function(e){return De.e.copy(this.v,e.v),this}},{key:"setValues",value:function(e,t,n){return De.e.set(this.v,e,t,n),this}},{key:"length",value:function(){return De.e.length(this.v)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"normalize",value:function(){return De.e.normalize(this.v,this.v),this}},{key:"negate",value:function(){return De.e.negate(this.v,this.v),this}},{key:"multiplyScalar",value:function(e){return De.e.scale(this.v,this.v,e),this}},{key:"multiply",value:function(e){return De.e.multiply(this.v,this.v,e.v),this}},{key:"divide",value:function(e){return De.e.divide(this.v,this.v,e.v),this}},{key:"add",value:function(e){return De.e.add(this.v,this.v,e.v),this}},{key:"subtract",value:function(e){return De.e.subtract(this.v,this.v,e.v),this}},{key:"subtractScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"rotateX",value:function(e,t){return De.e.rotateX(this.v,this.v,e.v,t),this}},{key:"rotateY",value:function(e,t){return De.e.rotateY(this.v,this.v,e.v,t),this}},{key:"transform",value:function(e){return De.e.transformMat4(this.v,this.v,e),this}},{key:"transformMat3",value:function(e){return De.e.transformMat3(this.v,this.v,e),this}},{key:"randomize",value:function(){return this.x=2*Math.random()-1,this.y=2*Math.random()-1,this.z=2*Math.random()-1,this}},{key:"randomize01",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomizeSphere",value:function(){do{this.randomize()}while(this.length()>1);return this}},{key:"smoothstep",value:function(){return this.x=e.smoothstep1(this.x),this.y=e.smoothstep1(this.y),this.z=e.smoothstep1(this.z),this}},{key:"x",get:function(){return this.v[0]},set:function(e){this.v[0]=e}},{key:"y",get:function(){return this.v[1]},set:function(e){this.v[1]=e}},{key:"z",get:function(){return this.v[2]},set:function(e){this.v[2]=e}}],[{key:"smoothstep1",value:function(e){return e*e*(3-2*e)}},{key:"dot",value:function(e,t){return De.e.dot(e.v,t.v)}},{key:"distance",value:function(e,t){return De.e.distance(e.v,t.v)}},{key:"multiplyScalar",value:function(e,t,n){return e.x=t.x*n,e.y=t.y*n,e.z=t.z*n,e}},{key:"cross",value:function(e,t,n){return De.e.cross(e.v,t.v,n.v),e}},{key:"add",value:function(e,t,n){return De.e.add(e.v,t.v,n.v),e}},{key:"subtract",value:function(e,t,n){return De.e.subtract(e.v,t.v,n.v),e}},{key:"lerp",value:function(e,t,n,i){return De.e.lerp(e.v,t.v,n.v,i),e}},{key:"fract",value:function(e,t){return e.x=t.x-Math.floor(t.x),e.y=t.y-Math.floor(t.y),e.x=t.z-Math.floor(t.z),e}},{key:"floor",value:function(e,t){return De.e.floor(e.v,t.v),e}},{key:"bezier",value:function(e,t,n,i,r,a){De.e.bezier(e.v,t.v,n.v,i.v,r.v,a)}}]),e}();Oe.ZERO=new Oe,Oe.RIGHT=new Oe(1,0,0),Oe.UP=new Oe(0,1,0),Oe.FORWARD=new Oe(0,0,1),Oe.ONE=new Oe(1,1,1);var Le=Oe,Ue=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0;G()(this,t),(i=X()(this,K()(t).call(this,null!==a?a:e,r,s)))._uniforms=[],i._color=new Le;for(var o=0;o<i._materials.length;o++)i._uniforms[o]=i._materials[o].addVector3Uniform(e,i._color);return i.setValue([255*n.x,255*n.y,255*n.z]),i}return Q()(t,e),W()(t,[{key:"getValueVector3",value:function(){return this._color}},{key:"convertColorToArray",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:e}},{key:"setValue",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e instanceof Le?this._color.copy(e):(e=this.convertColorToArray(e),this._color.setValues(e[0]/255,e[1]/255,e[2]/255)),ke()(K()(t.prototype),"setValue",this).call(this,[255*this._color.x,255*this._color.y,255*this._color.z],n)}},{key:"setShaderUniform",value:function(e){for(var t=0;t<this._uniforms.length;t++)this._uniforms[t].set(this._color)}}]),t}(Pe),Be=function(){function e(){G()(this,e)}return W()(e,null,[{key:"cacheIsPathRequested",value:function(t){return e._clientCache[t]}},{key:"cacheRegisterRequested",value:function(t,n){e._clientCache[t]=n}},{key:"cacheRegisterCallback",value:function(t,n){e._clientCacheCallbacks[t]||(e._clientCacheCallbacks[t]=[]),e._clientCacheCallbacks[t].push(n)}},{key:"cacheRequestDone",value:function(t,n){var i=e._clientCacheCallbacks[t];if(i)for(var r=0;r<i.length;r++)i[r](n);e._clientCacheCallbacks[t]=null,e._clientCache[t]=!1}},{key:"cacheRequestError",value:function(t){var n=e._clientCacheCallbacks[t];if(n)for(var i=0;i<n.length;i++)n[i](null);e._clientCacheCallbacks[t]=null,e._clientCache[t]=!1}},{key:"loadText",value:function(t,n){if(e.cacheRegisterCallback(t,n),!e.cacheIsPathRequested(t)){var i=new XMLHttpRequest;e.cacheRegisterRequested(t,i),i.onreadystatechange=function(n){4===i.readyState&&(200===i.status?e.cacheRequestDone(t,i.responseText):e.cacheRequestError(t))},i.open("GET",t,!0),i.send()}}},{key:"loadArrayBuffer",value:function(t,n){if(e.cacheRegisterCallback(t,n),!e.cacheIsPathRequested(t)){var i=new XMLHttpRequest;e.cacheRegisterRequested(t,i),i.open("GET",t,!0),i.responseType="arraybuffer",i.send(),i.onreadystatechange=function(n){4===i.readyState&&e.cacheRequestDone(t,i.response)}}}},{key:"loadImage",value:function(t,n){if(e.cacheRegisterCallback(t,n),e.cacheIsPathRequested(t))return e.cacheIsPathRequested(t);var i=new Image;return e.cacheRegisterRequested(t,i),i.crossOrigin="Anonymous",i.onload=function(){e.cacheRequestDone(t,i)},i.onerror=function(){console.log("TextureLoader: could not load image",t),e.cacheRequestDone(t,i)},i.src=t,i}},{key:"loadMultipleImages",value:function(t,n){for(var i=this,r=t.length,a=[],s=function(e){return function(t){r--,a[e]=t,0===r&&n.call(i,a)}},o=0;o<t.length;++o)e.loadImage(t[o],s(o))}},{key:"loadSingleFromRequireContext",value:function(e,t){return new Promise(function(n,i){var r;try{r=e("./".concat(t.replace(/^\.\//,"")))}catch(a){i(a)}"function"===typeof r?r(n):n(r)})}},{key:"loadFromRequireContext",value:function(t,n,i){Promise.all(n.map(function(n){return e.loadSingleFromRequireContext(t,n)})).then(function(e){return i(e)})}},{key:"loadMultipleTexts",value:function(t,n){for(var i=this,r=t.length,a=[],s=function(e){return function(t){r--,a[e]=t,0===r&&n.apply(i,a)}},o=0;o<t.length;++o)e.loadText(t[o],s(o))}},{key:"posMod",value:function(e,t){return(e%t+t)%t}},{key:"fract",value:function(e){return e-Math.floor(e)}},{key:"lerp",value:function(e,t,n){return(1-n)*e+n*t}},{key:"clamp01",value:function(e){return e<0?0:e>1?1:e}},{key:"gain01",value:function(e,t){return e>.5?1-.5*Math.pow(2-2*e,t):.5*Math.pow(2*e,t)}},{key:"smootherStep01",value:function(e){return e*e*e*(e*(6*e-15)+10)}},{key:"smoothStep01",value:function(t){return(t=e.clamp(t,0,1))*t*(3-2*t)}},{key:"invSmoothStep01",value:function(e){return e+(e-e*e*(3-2*e))}},{key:"smoothStep",value:function(t,n,i){return(i=e.clamp((i-t)/(n-t),0,1))*i*(3-2*i)}},{key:"step",value:function(t,n,i){return e.clamp01((i-t)/(n-t))}},{key:"nearestPowerOfTwo",value:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))}},{key:"clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}},{key:"degToRad",value:function(e){return e*(Math.PI/180)}},{key:"radToDeg",value:function(e){return e*(180/Math.PI)}},{key:"latLongToCartesian",value:function(e,t,n,i){var r=this.degToRad(t),a=this.degToRad(n)+Math.PI;return e.z=i*Math.cos(r)*Math.cos(a),e.x=i*Math.cos(r)*Math.sin(a),e.y=i*Math.sin(r),e}}]),e}();Be._clientCache={},Be._clientCacheCallbacks={};var Ve=Be,He=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return G()(this,t),(e=X()(this,K()(t).call(this)))._finished=!1,e._easeInOut=!1,e._isUpdating=!1,e._update=function(){return e.update()},e.value=n,e}return Q()(t,e),W()(t,[{key:"to",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.goal=e,this.progress=0,this.startValue=this.value,this._duration=1e3*t,this._t0=+new Date,this._finished=!1,this._completeCallback=i,this._animateCallback=n,this._easeInOut=r,this._isUpdating||this.update()}},{key:"fromTo",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.value=e,this.to(t,n,i,r,a)}},{key:"stop",value:function(){this._finished=!0,this._completeCallback=null,this._animateCallback=null}},{key:"update",value:function(){if(void 0===this._t0||void 0===this._duration||void 0===this.startValue||void 0===this.goal)throw new Error("cannot update: Tween not started. Call Tween.to or Tween.fromTo first");if(this._isUpdating=!1,!this.isDestructed&&!this._finished)if(this.progress=(+new Date-this._t0)/this._duration,this.progress>1&&(this.progress=1),this.easedProgress=this.progress,this._easeInOut&&(this.easedProgress=Ve.smoothStep01(this.easedProgress)),this.value=Ve.lerp(this.startValue,this.goal,this.easedProgress),this._animateCallback&&this._animateCallback.call(this,this.value),this.progress>=1){if(this._finished=!0,this._completeCallback){var e=this._completeCallback;this._completeCallback=null,e.call(this)}}else this._isUpdating=!0,window.requestAnimationFrame(this._update)}}]),t}(Me),Ge=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;G()(this,t),(i=X()(this,K()(t).call(this,null!==o?o:e,s,l)))._floatUniforms=[];for(var u=0;u<i._materials.length;u++)i._floatUniforms[u]=i._materials[u].addFloatUniform(e,n);return i.min=r,i.max=a,i.max<n&&(i.max=2*n),i.min>n&&(i.min=n-1),i.setValue(n),i}return Q()(t,e),W()(t,[{key:"setValue",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Ve.clamp(e,this.min,this.max),ke()(K()(t.prototype),"setValue",this).call(this,e,n)}},{key:"setShaderUniform",value:function(e){for(var t=0;t<this._floatUniforms.length;t++)this._floatUniforms[t].set(e)}},{key:"to",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._tween||(this._tween=new He),i?this._tween.fromTo(this.getValue(),e,t,function(e){return n.setValue(e)},function(){return i()}):this._tween.fromTo(this.getValue(),e,t,function(e){return n.setValue(e)})}},{key:"destruct",value:function(){if(this._floatUniforms){for(var e=0;e<this._floatUniforms.length;e++)this._floatUniforms[e].destruct();this._floatUniforms=[]}this._tween&&(this._tween.destruct(),delete this._tween),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Pe),ze=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;G()(this,t),(i=X()(this,K()(t).call(this,null!==o?o:e,s,l)))._floatUniforms=[];for(var u=0;u<i._materials.length;u++)i._floatUniforms[u]=i._materials[u].addFloatUniform(e,n);return i.min=r,i.max=a,i.max<n&&(i.max=2*n),i.min>n&&(i.min=n-1),i.setValue(n),i}return Q()(t,e),W()(t,[{key:"setShaderUniform",value:function(e){for(var t=0;t<this._floatUniforms.length;t++)this._floatUniforms[t].set(e)}}]),t}(Pe),We=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).call(this))).params=[],e.children=[],e}return Q()(t,e),W()(t,[{key:"addGroup",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new t;return r.init(e,n,i),this.children.push(r),r}},{key:"removeGroup",value:function(e){var t=null,n=!0,i=!1,r=void 0;try{for(var a,s=this.children[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(console.log("checking",o.name,e),o.name===e){t=o;break}}}catch(l){i=!0,r=l}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}t&&this.children.splice(this.children.indexOf(t),1)}},{key:"removeAllGroups",value:function(){this.children=[]}},{key:"pushGroup",value:function(e){this.children.push(e)}},{key:"init",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._id=t._id++,this.name=e,this.collapsed=i,this.materials=n?[].concat(n):[]}},{key:"addParamFloat",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new Ge(e,t,n,i,[],null,r);return this.params.push(a),a}},{key:"addShaderParamFloat",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var s=new Ge(e,t,n,i,this.materials,r,a);return this.params.push(s),s}},{key:"addParamInt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new ze(e,t,n,i,null,null,r);return this.params.push(a),a}},{key:"addShaderParamInt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var s=new ze(e,t,n,i,this.materials,r,a);return this.params.push(s),s}},{key:"addParamBool",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new Ne(e,t,null,null,n);return this.params.push(i),i}},{key:"addShaderParamBool",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var r=new Ne(e,t,this.materials,n,i);return this.params.push(r),r}},{key:"addParamColor",value:function(e,t,n){var i=new Ue(e,t,[],null,n);return this.params.push(i),i}},{key:"addShaderParamColor",value:function(e,t,n,i){this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var r=new Ue(e,t,this.materials,n,i);return this.params.push(r),r}},{key:"addButton",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new Fe(e,t);return this.params.push(n),n}},{key:"destruct",value:function(){if(this.params)for(var e=0;e<this.params.length;e++)this.params[e].isDestructed||this.params[e].destruct();if(this.children)for(var n=0;n<this.children.length;n++)this.children[n].isDestructed||this.children[n].destruct(),this.children[n].destruct();ke()(K()(t.prototype),"destruct",this).call(this)}}],[{key:"exposeParam",value:function(e){e.expose()}}]),t}(Me);We._id=0;var je=We,Xe=n(14),Ye=n.n(Xe),Ke=n(246),$e=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return G()(this,t),(e=X()(this,K()(t).call(this)))._params={},e.folderIndex=-2,n&&n.add(Ye()(Ye()(e))),e._jsonExportEnabled=i,e._params=r,e}return Q()(t,e),W()(t,[{key:"load",value:function(e){e.call(this)}},{key:"init",value:function(e){this._rootGroup=e;var t={};this._gui=new Ke.a(this._params),this.readGroup(e,t,this._gui),this._jsonExportEnabled&&this._gui.remember(t),this.setVisible(!0)}},{key:"getDatGUI",value:function(){return this._gui}},{key:"setPreset",value:function(e){if(!this._gui)throw new Error("Cannot set preset: DatGui not initialized");this.folderIndex=-2,this.setPresetRecurse(this._gui.__folders.controls,e.remembered.Default)}},{key:"setPresetRecurse",value:function(e,t){this.folderIndex++;var n=t[this.folderIndex];if("undefined"!==typeof n){var i=!0,r=!1,a=void 0;try{for(var s,o=e.__controllers[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=s.value,u=n[l.property];"undefined"!==typeof u&&l.setValue(u)}}catch(_){r=!0,a=_}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}}for(var h=Object.keys(e.__folders),c=0;c<h.length;c++){var d=h[c],f=e.__folders[d];this.setPresetRecurse(f,t)}}},{key:"readGroup",value:function(e,t,n){if(!e.name)throw new Error("group name not initialized");if(!this._gui)throw new Error("cannot read group: DatGui not initialized");var i=n.addFolder(this.uniqueName(n.__folders,e.name));e.collapsed||i.open();var r=!0,a=!1,s=void 0;try{for(var o,l=e.params[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;u.dataName=this.uniqueName(t,u.name);var h=u.dataName;void 0==t[h]?t[h]=u.getValue():console.log("property "+h+" already exists on param object",t);var c=void 0;if(u instanceof Ge){var d=u;c=i.add(t,h,d.min,d.max)}if(u instanceof ze){var f=u;c=i.add(t,h,f.min,f.max).step(1)}if(u instanceof Ne&&(c=i.add(t,h)),u instanceof Fe&&(c=i.add(t,h)),u instanceof Ue&&(c=i.addColor(t,h)),!(u instanceof Fe)){if(void 0===c)throw new TypeError("Unknown type of parameter");this.addHandlers(c,t,u)}}}catch(E){a=!0,s=E}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}var _=!0,p=!1,v=void 0;try{for(var m,g=e.children[Symbol.iterator]();!(_=(m=g.next()).done);_=!0){var A=m.value,y={};this._jsonExportEnabled&&this._gui.remember(y),this.readGroup(A,y,i)}}catch(E){p=!0,v=E}finally{try{_||null==g.return||g.return()}finally{if(p)throw v}}}},{key:"uniqueName",value:function(e,t){return t in e?this.uniqueName(e,"U_"+t):t}},{key:"addHandlers",value:function(e,t,n){n.setUpdateUICallback(function(e){t[n.dataName]=e}),e.listen(),e.onChange(function(e){t[n.dataName]=e,n.setFromUI(e)}),e.onFinishChange=function(e){return n.setFromUI(e)}}},{key:"setVisible",value:function(e){if(!this._gui)throw new Error("cannot set visible: DatGui not initialized");this._visible=e,this._gui.domElement.parentElement&&(this._gui.domElement.parentElement.style.zIndex=(e?999:0).toString(),this._gui.domElement.parentElement.style.visibility=(e?"visible":"hidden").toString())}},{key:"destruct",value:function(){this._gui&&(this._gui.domElement.parentElement&&this._gui.domElement.parentElement.removeChild(this._gui.domElement),delete this._gui),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),Qe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;G()(this,e),this.v=De.d.fromValues(t,n)}return W()(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"copy",value:function(e){return De.d.copy(this.v,e.v),this}},{key:"setValues",value:function(e,t){return De.d.set(this.v,e,t),this}},{key:"length",value:function(){return De.d.length(this.v)}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"normalize",value:function(){return De.d.normalize(this.v,this.v),this}},{key:"negate",value:function(){return De.d.negate(this.v,this.v),this}},{key:"multiplyScalar",value:function(e){return De.d.scale(this.v,this.v,e),this}},{key:"multiply",value:function(e){return De.d.multiply(this.v,this.v,e.v),this}},{key:"add",value:function(e){return De.d.add(this.v,this.v,e.v),this}},{key:"subtract",value:function(e){return De.d.subtract(this.v,this.v,e.v),this}},{key:"subtractScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"rotate",value:function(e,t){var n=Math.sin(t),i=Math.cos(t);this.x-=e.x,this.y-=e.y;var r=this.x*i-this.y*n,a=this.x*n+this.y*i;return this.x=r+e.x,this.y=a+e.y,this}},{key:"x",get:function(){return this.v[0]},set:function(e){this.v[0]=e}},{key:"y",get:function(){return this.v[1]},set:function(e){this.v[1]=e}}],[{key:"dot",value:function(e,t){return De.d.dot(e.v,t.v)}},{key:"distance",value:function(e,t){return De.d.distance(e.v,t.v)}},{key:"multiplyScalar",value:function(e,t,n){return e.x=t.x*n,e.y=t.y*n,e}},{key:"cross",value:function(e,t,n){return De.d.cross(e.v,t.v,n.v),e}},{key:"add",value:function(e,t,n){return De.d.add(e.v,t.v,n.v),e}},{key:"subtract",value:function(e,t,n){return De.d.subtract(e.v,t.v,n.v),e}},{key:"lerp",value:function(e,t,n,i){return De.d.lerp(e.v,t.v,n.v,i),e}},{key:"fract",value:function(t,n){return e.subtract(n,e.floor(t,n),t),t}},{key:"floor",value:function(e,t){return e.x=Math.floor(t.x),e.y=Math.floor(t.y),e}}]),e}();Qe.ZERO=new Qe(0,0);var Je=Qe,Ze=function(e){function t(e){var n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return G()(this,t),(n=X()(this,K()(t).call(this)))._pixelRatio=1,n._needsResize=!1,n._resizeInterval=5,n._resizeWait=0,n._canvasParent=e,n._autoResize=i,e||(n._autoResize=!1),n._manualResizeUpdate=!1,n.canvas=n.prepareCanvas(e),window.devicePixelRatio?n._pixelRatio=window.devicePixelRatio:n._pixelRatio=1,n._autoResize,n}return Q()(t,e),W()(t,[{key:"getCanvas",value:function(){return this.canvas}},{key:"prepareCanvas",value:function(e){var t=document.createElement("canvas");return t.setAttribute("id","canvas"),t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex="1",this._canvasParent&&(t.style.width=this._canvasParent.offsetWidth+"px",t.style.height=this._canvasParent.offsetHeight+"px"),e&&e.appendChild(t),this._autoResize&&(this._resizeHandler=this.handleResize.bind(this),window.addEventListener("resize",this._resizeHandler)),t}},{key:"setSize",value:function(e,t){this._goalWidth==e&&this._goalHeight==t||this._autoResize&&(this._resizeHandler&&window.removeEventListener("resize",this._resizeHandler),this._autoResize=!1),this._goalWidth=e,this._goalHeight=t,this.delayedResize()}},{key:"setMaxResolution",value:function(e){this._maxResolution=(new Je).copy(e),this.delayedResize()}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.delayedResize()}},{key:"setAutoResize",value:function(e){this._autoResize=e,this._resizeHandler&&(this._autoResize?(window.addEventListener("resize",this._resizeHandler),this.handleResize()):window.removeEventListener("resize",this._resizeHandler))}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"getParentHeight",value:function(){return null===this._canvasParent?null:this._canvasParent.offsetHeight}},{key:"getAspectRatio",value:function(){return this.canvas.width/this.canvas.height}},{key:"handleResize",value:function(){var e=this;if(this._canvasParent){var t=this._canvasParent.offsetWidth,n=this._canvasParent.offsetHeight;(this._goalWidth!==t||this._goalHeight!==n||this._needsResize)&&(this._goalWidth=t,this._goalHeight=n,this._manualResizeUpdate||(clearTimeout(this._resizeTimeOut),this._resizeTimeOut=setTimeout(function(){return e.delayedResize()},100)))}}},{key:"updateResize",value:function(){this._manualResizeUpdate=!0,this.handleResize(),this.delayedResize()}},{key:"manualResize",value:function(){if(this._manualResizeUpdate=!0,this._canvasParent){var e=this._canvasParent.offsetWidth,t=this._canvasParent.offsetHeight;(this._goalWidth!==e||this._goalHeight!==t||this._needsResize)&&(this._goalWidth=e,this._goalHeight=t,this.delayedResize())}}},{key:"delayedResize",value:function(){this.isDestructed||(this._needsResize=!1,this.canvas.width=this._goalWidth*this._pixelRatio,this.canvas.height=this._goalHeight*this._pixelRatio,this.canvas.style.width=this._canvasParent.offsetWidth+"px",this.canvas.style.height=this._canvasParent.offsetHeight+"px",this._goalWidth=this._canvasParent.offsetWidth,this._goalHeight=this._canvasParent.offsetHeight)}},{key:"forceResize",value:function(){if(!this._canvasParent)throw new ReferenceError("canvas has no parent");if(this._resizeWait--,this._resizeWait<=0){this._resizeWait=this._resizeInterval;var e=this._canvasParent.offsetWidth,t=this._canvasParent.offsetHeight;if(this.canvas.width!=e*this._pixelRatio||this.canvas.height!=t*this._pixelRatio){this.canvas.width=e*this._pixelRatio,this.canvas.height=t*this._pixelRatio;var n=document.createEvent("Event");n.initEvent("resize",!1,!0),this.canvas.dispatchEvent(n)}this.canvas.style.width==e+"px"&&this.canvas.style.height==t+"px"||(this.canvas.style.width=e+"px",this.canvas.style.height=t+"px")}}},{key:"destruct",value:function(){this._resizeHandler&&window.removeEventListener("resize",this._resizeHandler),this.canvas.width=1,this.canvas.height=1,this._canvasParent&&this._canvasParent.removeChild(this.canvas),ke()(K()(t.prototype),"destruct",this).call(this)}},{key:"canvasParent",get:function(){return this._canvasParent}}]),t}(Me),qe=function(){function e(){G()(this,e)}return W()(e,null,[{key:"log",value:function(){if(e.ENABLED){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];console.log(n)}}},{key:"error",value:function(){if(e.ENABLED){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];console.error(n)}}},{key:"getScreenLogDiv",value:function(){return e._screenLogDiv||(e._screenLogDiv=e.createDebugDiv()),e._screenLogDiv}},{key:"logToScreen",value:function(t){e.ENABLED&&(e._screenLogDiv||(e._screenLogDiv=e.createDebugDiv()),e._screenLogDiv.innerHTML=t)}},{key:"logAppendToScreen",value:function(t){e.ENABLED&&(e._screenLogDiv||(e._screenLogDiv=e.createDebugDiv()),e._screenLogDiv.innerHTML+=t)}},{key:"logArray",value:function(t){if(e.ENABLED){for(var n=t.length,i="",r=0;r<n;r++)i+=t[r],i+=",";i=i.substring(0,i.length-1),console.log(i)}}},{key:"log2dArray",value:function(t){if(e.ENABLED){for(var n=t.length,i="",r=0;r<n;r++)for(var a=0;a<t[r].length;a++)i+=t[r][a],i+=",";i=i.substring(0,i.length-1),console.log(i)}}},{key:"createDebugDiv",value:function(){var e=document.createElement("div");return document.body.appendChild(e),e.style.position="absolute",e.style.left="160px",e.style.top="0px",e.style.color="#fff",e.style.backgroundColor="#000",e.style.display="block",e.style.width="158px",e.style.height="94px",e.style.padding="1px",e.style.font="10px Helvetica,Arial,sans-serif",e.style.lineHeight="14px",e.style.zIndex="1000",e}}]),e}();qe.ENABLED=!0;var et=qe,tt=function(){function e(){G()(this,e),this.averageFps=0,this._manualUpdate=!1,e._instance&&alert("do not create additional instances of the time class"),this.fps=60,this.deltaTime=1/this.fps,this.time=0,this.update()}return W()(e,[{key:"updateManual",value:function(){this._manualUpdate=!0,this.updateDeltaTime()}},{key:"update",value:function(){var e=this;this._manualUpdate||(this.updateDeltaTime(),window.requestAnimationFrame(function(t){return e.update()}))}},{key:"updateDeltaTime",value:function(){var e=performance.now();this.deltaTime=.001*e-this.time,this.deltaTime>.05&&(this.deltaTime=.05),this.time=.001*e,this.fps=1/this.deltaTime,this.averageFps>0?this.averageFps=Ve.lerp(this.fps,this.averageFps,.95):this.averageFps=1/60}},{key:"testPerformance",value:function(e){console.time("timer0"),e.call(this),console.timeEnd("timer0")}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),nt=function e(t){G()(this,e),this.MAX_VERTEX_ATTRIBS=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.MAX_VARYING_VECTORS=t.getParameter(t.MAX_VARYING_VECTORS),this.MAX_VERTEX_UNIFORM_VECTORS=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.MAX_FRAGMENT_UNIFORM_VECTORS=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.MAX_TEXTURE_IMAGE_UNITS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE),this.MAX_CUBE_MAP_TEXTURE_SIZE=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.MAX_VIEWPORT_DIMS=t.getParameter(t.MAX_VIEWPORT_DIMS),this.MAX_RENDERBUFFER_SIZE=t.getParameter(t.MAX_RENDERBUFFER_SIZE),this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);var n=t.getExtension("WEBGL_debug_renderer_info");for(var i in this.UNMASKED_RENDERER=n&&t.getParameter(n.UNMASKED_RENDERER_WEBGL),this.UNMASKED_VENDOR=n&&t.getParameter(n.UNMASKED_VENDOR_WEBGL),this)this.hasOwnProperty(i)&&et.log(i,this[i])},it=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;G()(this,e),this.v=De.f.fromValues(t,n,i,r)}return W()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return De.f.set(this.v,e.x,e.y,e.z,e.w),this}},{key:"setValues",value:function(e,t,n,i){return De.f.set(this.v,e,t,n,i),this}},{key:"dot",value:function(e){return De.f.dot(this.v,e.v)}},{key:"transform",value:function(e){return De.f.transformMat4(this.v,this.v,e),this}},{key:"x",get:function(){return this.v[0]},set:function(e){this.v[0]=e}},{key:"y",get:function(){return this.v[1]},set:function(e){this.v[1]=e}},{key:"z",get:function(){return this.v[2]},set:function(e){this.v[2]=e}},{key:"w",get:function(){return this.v[3]},set:function(e){this.v[3]=e}}],[{key:"dot",value:function(e,t){return De.f.dot(e.v,t.v)}},{key:"transform",value:function(e,t){return De.f.transformMat4(e.v,e.v,t),e}}]),e}();it.ZERO=new it;var rt=it,at=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return G()(this,t),X()(this,K()(t).call(this,e,n,i,r))}return Q()(t,e),W()(t,[{key:"r",get:function(){return this.v[0]},set:function(e){this.v[0]=e}},{key:"g",get:function(){return this.v[1]},set:function(e){this.v[1]=e}},{key:"b",get:function(){return this.v[2]},set:function(e){this.v[2]=e}},{key:"a",get:function(){return this.v[3]},set:function(e){this.v[3]=e}}]),W()(t,[{key:"isEqualTo",value:function(e){return this.r==e.r&&this.g==e.g&&this.b==e.b&&this.a==e.a}},{key:"clampCeil",value:function(e){this.r>e&&(this.r=e),this.g>e&&(this.g=e),this.b>e&&(this.b=e),this.a>e&&(this.a=e)}},{key:"toRGBString",value:function(){return"rgb("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+")"}},{key:"getHex",value:function(){return"#"+t.componentToHex(this.r)+t.componentToHex(this.g)+t.componentToHex(this.b)}},{key:"setRGBA255",value:function(e){this.r=e[0]/255,this.g=e[1]/255,this.b=e[2]/255,this.a=e[3],console.log("setRGBA255: ",e,this.r,this.g,this.b,this.a)}},{key:"getRGBA255",value:function(){return[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b),this.a]}},{key:"setFromHex",value:function(e){e=e.replace(/[^0-9A-F]/gi,"");var t=parseInt(e,16);this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this.a=1}},{key:"setFromHSV",value:function(e,t,n){var i=0,r=0,a=0,s=Math.floor(6*e),o=6*e-s,l=n*(1-t),u=n*(1-o*t),h=n*(1-(1-o)*t);switch(s%6){case 0:i=n,r=h,a=l;break;case 1:i=u,r=n,a=l;break;case 2:i=l,r=n,a=h;break;case 3:i=l,r=u,a=n;break;case 4:i=h,r=l,a=n;break;case 5:i=n,r=l,a=u}this.r=i,this.g=r,this.b=a}},{key:"getRgbaString",value:function(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}}],[{key:"componentToHex",value:function(e){var t=(e*=255).toString(16);return 1===t.length?"0"+t:t}},{key:"fromHex",value:function(e){var n=new t;return n.setFromHex(e),n}},{key:"fromRGB255",value:function(e){var n=new t;return n.setRGBA255(e),n}},{key:"getRandom",value:function(){return new t(Math.random(),Math.random(),Math.random())}},{key:"colorFromString",value:function(e){var n=[],i=[];i[0]=e.substr(0,Math.floor(e.length/3)),i[1]=e.substr(Math.floor(e.length/3),Math.floor(2*e.length/3)),i[2]=e.substr(Math.floor(2*e.length/3),e.length);for(var r=0;r<i.length;r++)for(var a=0;a<i[r].length;a++)r in n||(n[r]=0),n[r]+=i[r].charCodeAt(a);return new t(n[0]/128%1,n[1]/128%1,n[2]/128%1,1)}},{key:"fromHSV",value:function(e,n,i){var r=new t;return r.setFromHSV(e,n,i),r}}]),t}(rt),st=function e(){G()(this,e)};st.ACTIVE_ATTRIBUTES=35721,st.ACTIVE_ATTRIBUTE_MAX_LENGTH=35722,st.ACTIVE_TEXTURE=34016,st.ACTIVE_UNIFORMS=35718,st.ACTIVE_UNIFORM_MAX_LENGTH=35719,st.ALIASED_LINE_WIDTH_RANGE=33902,st.ALIASED_POINT_SIZE_RANGE=33901,st.ALPHA=6406,st.ALPHA_BITS=3413,st.ALWAYS=519,st.ARRAY_BUFFER=34962,st.ARRAY_BUFFER_BINDING=34964,st.ATTACHED_SHADERS=35717,st.BACK=1029,st.BLEND=3042,st.BLEND_COLOR=32773,st.BLEND_DST_ALPHA=32970,st.BLEND_DST_RGB=32968,st.BLEND_EQUATION=32777,st.BLEND_EQUATION_ALPHA=34877,st.BLEND_EQUATION_RGB=32777,st.BLEND_SRC_ALPHA=32971,st.BLEND_SRC_RGB=32969,st.BLUE_BITS=3412,st.BOOL=35670,st.BOOL_VEC2=35671,st.BOOL_VEC3=35672,st.BOOL_VEC4=35673,st.BROWSER_DEFAULT_WEBGL=37444,st.BUFFER_SIZE=34660,st.BUFFER_USAGE=34661,st.BYTE=5120,st.CCW=2305,st.CLAMP_TO_EDGE=33071,st.COLOR_ATTACHMENT0=36064,st.COLOR_BUFFER_BIT=16384,st.COLOR_CLEAR_VALUE=3106,st.COLOR_WRITEMASK=3107,st.COMPILE_STATUS=35713,st.COMPRESSED_TEXTURE_FORMATS=34467,st.CONSTANT_ALPHA=32771,st.CONSTANT_COLOR=32769,st.CONTEXT_LOST_WEBGL=37442,st.CULL_FACE=2884,st.CULL_FACE_MODE=2885,st.CURRENT_PROGRAM=35725,st.CURRENT_VERTEX_ATTRIB=34342,st.CW=2304,st.DECR=7683,st.DECR_WRAP=34056,st.DELETE_STATUS=35712,st.DEPTH_ATTACHMENT=36096,st.DEPTH_BITS=3414,st.DEPTH_BUFFER_BIT=256,st.DEPTH_CLEAR_VALUE=2931,st.DEPTH_COMPONENT=6402,st.DEPTH_COMPONENT16=33189,st.DEPTH_FUNC=2932,st.DEPTH_RANGE=2928,st.DEPTH_STENCIL=34041,st.DEPTH_STENCIL_ATTACHMENT=33306,st.DEPTH_TEST=2929,st.DEPTH_WRITEMASK=2930,st.DITHER=3024,st.DONT_CARE=4352,st.DST_ALPHA=772,st.DST_COLOR=774,st.DYNAMIC_DRAW=35048,st.ELEMENT_ARRAY_BUFFER=34963,st.ELEMENT_ARRAY_BUFFER_BINDING=34965,st.EQUAL=514,st.FASTEST=4353,st.FLOAT=5126,st.FLOAT_MAT2=35674,st.FLOAT_MAT3=35675,st.FLOAT_MAT4=35676,st.FLOAT_VEC2=35664,st.FLOAT_VEC3=35665,st.FLOAT_VEC4=35666,st.FRAGMENT_SHADER=35632,st.FRAMEBUFFER=36160,st.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,st.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,st.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,st.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,st.FRAMEBUFFER_BINDING=36006,st.FRAMEBUFFER_COMPLETE=36053,st.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,st.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,st.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,st.FRAMEBUFFER_UNSUPPORTED=36061,st.FRONT=1028,st.FRONT_AND_BACK=1032,st.FRONT_FACE=2886,st.FUNC_ADD=32774,st.FUNC_REVERSE_SUBTRACT=32779,st.FUNC_SUBTRACT=32778,st.GENERATE_MIPMAP_HINT=33170,st.GEQUAL=518,st.GREATER=516,st.GREEN_BITS=3411,st.HIGH_FLOAT=36338,st.HIGH_INT=36341,st.INCR=7682,st.INCR_WRAP=34055,st.INFO_LOG_LENGTH=35716,st.INT=5124,st.INT_VEC2=35667,st.INT_VEC3=35668,st.INT_VEC4=35669,st.INVALID_ENUM=1280,st.INVALID_FRAMEBUFFER_OPERATION=1286,st.INVALID_OPERATION=1282,st.INVALID_VALUE=1281,st.INVERT=5386,st.KEEP=7680,st.LEQUAL=515,st.LESS=513,st.LINEAR=9729,st.LINEAR_MIPMAP_LINEAR=9987,st.LINEAR_MIPMAP_NEAREST=9985,st.LINES=1,st.LINE_LOOP=2,st.LINE_STRIP=3,st.LINE_WIDTH=2849,st.LINK_STATUS=35714,st.LOW_FLOAT=36336,st.LOW_INT=36339,st.LUMINANCE=6409,st.LUMINANCE_ALPHA=6410,st.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,st.MAX_CUBE_MAP_TEXTURE_SIZE=34076,st.MAX_FRAGMENT_UNIFORM_VECTORS=36349,st.MAX_RENDERBUFFER_SIZE=34024,st.MAX_TEXTURE_IMAGE_UNITS=34930,st.MAX_TEXTURE_SIZE=3379,st.MAX_VARYING_VECTORS=36348,st.MAX_VERTEX_ATTRIBS=34921,st.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,st.MAX_VERTEX_UNIFORM_VECTORS=36347,st.MAX_VIEWPORT_DIMS=3386,st.MEDIUM_FLOAT=36337,st.MEDIUM_INT=36340,st.MIRRORED_REPEAT=33648,st.NEAREST=9728,st.NEAREST_MIPMAP_LINEAR=9986,st.NEAREST_MIPMAP_NEAREST=9984,st.NEVER=512,st.NICEST=4354,st.NONE=0,st.NOTEQUAL=517,st.NO_ERROR=0,st.NUM_COMPRESSED_TEXTURE_FORMATS=34466,st.ONE=1,st.ONE_MINUS_CONSTANT_ALPHA=32772,st.ONE_MINUS_CONSTANT_COLOR=32770,st.ONE_MINUS_DST_ALPHA=773,st.ONE_MINUS_DST_COLOR=775,st.ONE_MINUS_SRC_ALPHA=771,st.ONE_MINUS_SRC_COLOR=769,st.OUT_OF_MEMORY=1285,st.PACK_ALIGNMENT=3333,st.POINTS=0,st.POLYGON_OFFSET_FACTOR=32824,st.POLYGON_OFFSET_FILL=32823,st.POLYGON_OFFSET_UNITS=10752,st.RED_BITS=3410,st.RENDERBUFFER=36161,st.RENDERBUFFER_ALPHA_SIZE=36179,st.RENDERBUFFER_BINDING=36007,st.RENDERBUFFER_BLUE_SIZE=36178,st.RENDERBUFFER_DEPTH_SIZE=36180,st.RENDERBUFFER_GREEN_SIZE=36177,st.RENDERBUFFER_HEIGHT=36163,st.RENDERBUFFER_INTERNAL_FORMAT=36164,st.RENDERBUFFER_RED_SIZE=36176,st.RENDERBUFFER_STENCIL_SIZE=36181,st.RENDERBUFFER_WIDTH=36162,st.RENDERER=7937,st.REPEAT=10497,st.REPLACE=7681,st.RGB=6407,st.RGB5_A1=32855,st.RGB565=36194,st.RGBA=6408,st.RGBA4=32854,st.SAMPLER_2D=35678,st.SAMPLER_CUBE=35680,st.SAMPLES=32937,st.SAMPLE_ALPHA_TO_COVERAGE=32926,st.SAMPLE_BUFFERS=32936,st.SAMPLE_COVERAGE=32928,st.SAMPLE_COVERAGE_INVERT=32939,st.SAMPLE_COVERAGE_VALUE=32938,st.SCISSOR_BOX=3088,st.SCISSOR_TEST=3089,st.SHADER_COMPILER=36346,st.SHADER_SOURCE_LENGTH=35720,st.SHADER_TYPE=35663,st.SHADING_LANGUAGE_VERSION=35724,st.SHORT=5122,st.SRC_ALPHA=770,st.SRC_ALPHA_SATURATE=776,st.SRC_COLOR=768,st.STATIC_DRAW=35044,st.STENCIL_ATTACHMENT=36128,st.STENCIL_BACK_FAIL=34817,st.STENCIL_BACK_FUNC=34816,st.STENCIL_BACK_PASS_DEPTH_FAIL=34818,st.STENCIL_BACK_PASS_DEPTH_PASS=34819,st.STENCIL_BACK_REF=36003,st.STENCIL_BACK_VALUE_MASK=36004,st.STENCIL_BACK_WRITEMASK=36005,st.STENCIL_BITS=3415,st.STENCIL_BUFFER_BIT=1024,st.STENCIL_CLEAR_VALUE=2961,st.STENCIL_FAIL=2964,st.STENCIL_FUNC=2962,st.STENCIL_INDEX=6401,st.STENCIL_INDEX8=36168,st.STENCIL_PASS_DEPTH_FAIL=2965,st.STENCIL_PASS_DEPTH_PASS=2966,st.STENCIL_REF=2967,st.STENCIL_TEST=2960,st.STENCIL_VALUE_MASK=2963,st.STENCIL_WRITEMASK=2968,st.STREAM_DRAW=35040,st.SUBPIXEL_BITS=3408,st.TEXTURE=5890,st.TEXTURE0=33984,st.TEXTURE1=33985,st.TEXTURE2=33986,st.TEXTURE3=33987,st.TEXTURE4=33988,st.TEXTURE5=33989,st.TEXTURE6=33990,st.TEXTURE7=33991,st.TEXTURE8=33992,st.TEXTURE9=33993,st.TEXTURE10=33994,st.TEXTURE11=33995,st.TEXTURE12=33996,st.TEXTURE13=33997,st.TEXTURE14=33998,st.TEXTURE15=33999,st.TEXTURE16=34e3,st.TEXTURE17=34001,st.TEXTURE18=34002,st.TEXTURE19=34003,st.TEXTURE20=34004,st.TEXTURE21=34005,st.TEXTURE22=34006,st.TEXTURE23=34007,st.TEXTURE24=34008,st.TEXTURE25=34009,st.TEXTURE26=34010,st.TEXTURE27=34011,st.TEXTURE28=34012,st.TEXTURE29=34013,st.TEXTURE30=34014,st.TEXTURE31=34015,st.TEXTURE_2D=3553,st.TEXTURE_BINDING_2D=32873,st.TEXTURE_BINDING_CUBE_MAP=34068,st.TEXTURE_CUBE_MAP=34067,st.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,st.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,st.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,st.TEXTURE_CUBE_MAP_POSITIVE_X=34069,st.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,st.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,st.TEXTURE_MAG_FILTER=10240,st.TEXTURE_MIN_FILTER=10241,st.TEXTURE_WRAP_S=10242,st.TEXTURE_WRAP_T=10243,st.TRIANGLES=4,st.TRIANGLE_FAN=6,st.TRIANGLE_STRIP=5,st.UNPACK_ALIGNMENT=3317,st.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,st.UNPACK_FLIP_Y_WEBGL=37440,st.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,st.UNSIGNED_BYTE=5121,st.UNSIGNED_INT=5125,st.UNSIGNED_SHORT=5123,st.UNSIGNED_SHORT_4_4_4_4=32819,st.UNSIGNED_SHORT_5_5_5_1=32820,st.UNSIGNED_SHORT_5_6_5=33635,st.VALIDATE_STATUS=35715,st.VENDOR=7936,st.VERSION=7938,st.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,st.VERTEX_ATTRIB_ARRAY_ENABLED=34338,st.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,st.VERTEX_ATTRIB_ARRAY_POINTER=34373,st.VERTEX_ATTRIB_ARRAY_SIZE=34339,st.VERTEX_ATTRIB_ARRAY_STRIDE=34340,st.VERTEX_ATTRIB_ARRAY_TYPE=34341,st.VERTEX_SHADER=35633,st.VIEWPORT=2978,st.ZERO=0;var ot=st,lt=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(G()(this,t),(i=X()(this,K()(t).call(this)))._loc=e.shader.uniformLocations[n],i._loc||et.log("FloatUniform: uniform does not exist on shader: ",e.name,n),!e.shader.program)throw new ReferenceError("Cannot construct FloatUniform from material: material shader is not yet initialized.");return i._renderer=e.renderer,i._program=e.shader.program,i.set(r),i}return Q()(t,e),W()(t,[{key:"set",value:function(e){e!=this._value&&(this._value=e,this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform1f(this._loc,this._value))}},{key:"getValue",value:function(){return this._value}},{key:"destruct",value:function(){ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),ut=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Je;if(G()(this,e),this._value=i,this._loc=t.shader.uniformLocations[n],this._loc||et.log("FloatUniform: uniform does not exist on shader: ",n),!t.shader.program)throw new ReferenceError("Cannot construct Vector2Uniform from material: material shader is not yet initialized.");this._renderer=t.renderer,this._program=t.shader.program}return W()(e,[{key:"set",value:function(e){e.x==this._value.x&&e.y==this._value.y||(this._value=e,this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform2fv(this._loc,this._value.v))}},{key:"getValue",value:function(){return this._value}}]),e}(),ht=function(){function e(t,n){arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Le;if(G()(this,e),this._value=new Le,this._loc=t.shader.uniformLocations[n],this._loc||et.log("FloatUniform: uniform does not exist on shader: ",n),!t.shader.program)throw new ReferenceError("Cannot construct Vector3Uniform from material: material shader is not yet initialized.");this._renderer=t.renderer,this._program=t.shader.program}return W()(e,[{key:"set",value:function(e){e.x==this._value.x&&e.y==this._value.y&&e.z==this._value.z||(this._value.copy(e),this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform3fv(this._loc,this._value.v))}},{key:"getValue",value:function(){return this._value}}]),e}(),ct=function(e){function t(e,n,i){var r;return G()(this,t),(r=X()(this,K()(t).call(this)))._shaderDefines=[],r.drawType=ot.TRIANGLES,r.depthTest=!0,r.depthWrite=!0,r.blend=!1,r.culling=ot.BACK,r.blendFuncSeparate=!1,r.renderer=e,r.name=n,r.shader=i,r.id=t.staticId++,r.setDefaultBlending(),r}return Q()(t,e),W()(t,[{key:"setActive",value:function(){if(void 0===this.shader.program||void 0===this.shader.textureUniforms)throw new Error("Trying to activate material but the associated shader is not yet initialized");this.renderer.renderState.setProgram(this.shader.program);for(var e=0;e<this.shader.textureUniforms.length;e++)this.shader.textureUniforms[e].bind();if(this.renderer.renderState.material!=this&&(this.renderer.renderState.material=this,this.renderer.renderState.setDepthTest(this.depthTest),this.renderer.renderState.setDepthMask(this.depthWrite),this.depthFunc&&this.renderer.renderState.setDepthFunc(this.depthFunc),this.renderer.renderState.setCulling(this.culling),this.renderer.renderState.setBlendEnabled(this.blend),this.blend))if(this.renderer.renderState.setBlendEquation(this.blendEquation),this.blendFuncSeparate){if(void 0===this.sourceBlendRGB||void 0===this.destinationBlendRGB||void 0===this.sourceBlendAlpha||void 0===this.destinationBlendAlpha)throw new ReferenceError("expected blend properties to be set");this.renderer.renderState.setBlendFuncSeparate(this.sourceBlendRGB,this.destinationBlendRGB,this.sourceBlendAlpha,this.destinationBlendAlpha)}else this.renderer.renderState.setBlendFunc(this.sourceBlend,this.destinationBlend)}},{key:"setDefaultBlending",value:function(){this.depthTest=!0,this.depthWrite=!0,this.blend=!1,this.blendEquation=ot.FUNC_ADD,this.sourceBlend=ot.ZERO,this.destinationBlend=ot.ONE}},{key:"setAlphaBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=ot.FUNC_ADD,this.setBlendUnified(ot.SRC_ALPHA,ot.ONE_MINUS_SRC_ALPHA)}},{key:"setPreMultipliedAlphaBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=ot.FUNC_ADD,this.setBlendUnified(ot.ONE,ot.ONE_MINUS_SRC_ALPHA)}},{key:"setMaxBlending",value:function(){this.depthWrite=!1,this.depthTest=!1,this.blend=!0,this.blendEquation=32776,this.sourceBlend=ot.ONE,this.destinationBlend=ot.ONE,this.setBlendUnified(ot.ONE,ot.ONE)}},{key:"setAdditiveBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=ot.FUNC_ADD,this.setBlendUnified(ot.ONE,ot.ONE)}},{key:"setMultiplyBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=ot.FUNC_ADD,this.setBlendUnified(ot.ZERO,ot.SRC_COLOR)}},{key:"setSubtractiveBlending",value:function(){this.depthWrite=!1,this.depthTest=!1,this.blend=!0,this.blendEquation=ot.FUNC_SUBTRACT,this.setBlendUnified(ot.ONE,ot.ONE_MINUS_SRC_ALPHA)}},{key:"setBlendUnified",value:function(e,t){this.blendFuncSeparate=!1,this.sourceBlend=e,this.destinationBlend=t}},{key:"setBlendSeparate",value:function(e,t,n,i){this.blendFuncSeparate=!0,this.sourceBlendRGB=e,this.sourceBlendAlpha=n,this.destinationBlendRGB=t,this.destinationBlendAlpha=i}},{key:"setCullingBackFace",value:function(){this.culling=ot.BACK}},{key:"setCullingFrontFace",value:function(){this.culling=ot.FRONT}},{key:"setCullingDisabled",value:function(){this.culling=ot.NONE}},{key:"setDrawTypePoints",value:function(){this.drawType=ot.POINTS}},{key:"setDrawTypeLines",value:function(){this.drawType=ot.LINES}},{key:"setDrawTypeLineStrip",value:function(){this.drawType=ot.LINE_STRIP}},{key:"setDrawTypeTriangles",value:function(){this.drawType=ot.TRIANGLES}},{key:"setDrawTypeTriangleFan",value:function(){this.drawType=ot.TRIANGLE_FAN}},{key:"setDrawTypeTriangleStrip",value:function(){this.drawType=ot.TRIANGLE_STRIP}},{key:"setFloat",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1f(n,t))}},{key:"setInt",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1i(n,t))}},{key:"setFloats",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.getLoc(e);a&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4f(a,t,n,i,r))}},{key:"setShaderVector",value:function(e,t){var n=this.renderer.context,i=this.getLoc(e);if(i)switch(this.renderer.renderState.setProgram(this.shader.program),t.length){case 1:n.uniform1f(i,t[0]);break;case 2:n.uniform2f(i,t[0],t[1]);break;case 3:n.uniform3f(i,t[0],t[1],t[2]);break;case 4:n.uniform4f(i,t[0],t[1],t[2],t[3])}}},{key:"setMatrix",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,t))}},{key:"setMatrix3x3",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix3fv(n,!1,t))}},{key:"setMatrix2x2",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix2fv(n,!1,t))}},{key:"setMatrixArray",value:function(e,t){for(var n=0;n<t.length;n++){var i=e+"["+n+"]";this.setMatrix(i,t[n])}}},{key:"setMatrixArray2",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,t))}},{key:"setMatrixFloatArray",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,t))}},{key:"setTexture",value:function(e,t){if(!this.shader)throw new ReferenceError("Material has no Shader");var n=this.shader.getTextureUniformByName(e);n&&n.set(t)}},{key:"setFloat32Array",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1fv(n,t))}},{key:"setInt32Array",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1iv(n,t))}},{key:"setColor",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4f(n,t.r,t.g,t.b,t.a))}},{key:"setVector3",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform3fv(n,t.v))}},{key:"setVector3Array",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform3fv(n,t))}},{key:"setVector2",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform2fv(n,t.v))}},{key:"setVector2Array",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform2fv(n,t))}},{key:"setVector4",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4fv(n,t.v))}},{key:"setVector4Array",value:function(e,t){var n=this.getLoc(e);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4fv(n,t))}},{key:"getLoc",value:function(e){var t=this.shader.uniformLocations[e];if(!1!==t&&!t){if(!this.shader)throw new ReferenceError("Material has no Shader");if(!this.shader.program)throw new ReferenceError("Material shader has not yet been initialized");if(this.renderer.renderState.setProgram(this.shader.program),t=this.renderer.context.getUniformLocation(this.shader.program,e))return this.shader.uniformLocations[e]=t,t;this.shader.uniformLocations[e]=!1,et.log("uniform not present in shader: ",this.name,e)}return t}},{key:"hasUniform",value:function(e){if(!this.shader)throw new ReferenceError("Material has no Shader");return!!this.shader.uniformLocations[e]}},{key:"addFloatUniform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new lt(this,e,t)}},{key:"addVector2Uniform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Je;return new ut(this,e,t)}},{key:"addVector3Uniform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Le;return new ht(this,e,t)}},{key:"addShaderDefines",value:function(){for(var e=0;e<arguments.length;e++)-1===this._shaderDefines.indexOf(e<0||arguments.length<=e?void 0:arguments[e])&&this._shaderDefines.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"getShaderDefines",value:function(){return this._shaderDefines}},{key:"clearShaderDefines",value:function(){this._shaderDefines=[]}},{key:"destruct",value:function(){this.isDestructed||this.shader.destruct(),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me);ct.staticId=0;var dt=ct,ft=function e(t,n,i){G()(this,e),this.name=t,this.stride=n,this.loc=i},_t=function(){function e(t,n,i,r){if(G()(this,e),this.name=n,this._samplerIndex=r,!t.program)throw new ReferenceError("Cannot construct TextureUniform from shader: shader is not yet initialized.");t.renderer.renderState.setProgram(t.program),t.renderer.context.uniform1i(i,r)}return W()(e,[{key:"set",value:function(e){this._texture=e}},{key:"bind",value:function(){this._texture&&this._texture.bindToSlot(this._samplerIndex)}}]),e}(),pt=function e(){G()(this,e)};pt.READ_BUFFER=3074,pt.UNPACK_ROW_LENGTH=3314,pt.UNPACK_SKIP_ROWS=3315,pt.UNPACK_SKIP_PIXELS=3316,pt.PACK_ROW_LENGTH=3330,pt.PACK_SKIP_ROWS=3331,pt.PACK_SKIP_PIXELS=3332,pt.COLOR=6144,pt.DEPTH=6145,pt.STENCIL=6146,pt.RED=6403,pt.RGB8=32849,pt.RGBA8=32856,pt.RGB10_A2=32857,pt.TEXTURE_BINDING_3D=32874,pt.UNPACK_SKIP_IMAGES=32877,pt.UNPACK_IMAGE_HEIGHT=32878,pt.TEXTURE_3D=32879,pt.TEXTURE_WRAP_R=32882,pt.MAX_3D_TEXTURE_SIZE=32883,pt.UNSIGNED_INT_2_10_10_10_REV=33640,pt.MAX_ELEMENTS_VERTICES=33e3,pt.MAX_ELEMENTS_INDICES=33001,pt.TEXTURE_MIN_LOD=33082,pt.TEXTURE_MAX_LOD=33083,pt.TEXTURE_BASE_LEVEL=33084,pt.TEXTURE_MAX_LEVEL=33085,pt.MIN=32775,pt.MAX=32776,pt.DEPTH_COMPONENT24=33190,pt.MAX_TEXTURE_LOD_BIAS=34045,pt.TEXTURE_COMPARE_MODE=34892,pt.TEXTURE_COMPARE_FUNC=34893,pt.CURRENT_QUERY=34917,pt.QUERY_RESULT=34918,pt.QUERY_RESULT_AVAILABLE=34919,pt.STREAM_READ=35041,pt.STREAM_COPY=35042,pt.STATIC_READ=35045,pt.STATIC_COPY=35046,pt.DYNAMIC_READ=35049,pt.DYNAMIC_COPY=35050,pt.MAX_DRAW_BUFFERS=34852,pt.DRAW_BUFFER0=34853,pt.DRAW_BUFFER1=34854,pt.DRAW_BUFFER2=34855,pt.DRAW_BUFFER3=34856,pt.DRAW_BUFFER4=34857,pt.DRAW_BUFFER5=34858,pt.DRAW_BUFFER6=34859,pt.DRAW_BUFFER7=34860,pt.DRAW_BUFFER8=34861,pt.DRAW_BUFFER9=34862,pt.DRAW_BUFFER10=34863,pt.DRAW_BUFFER11=34864,pt.DRAW_BUFFER12=34865,pt.DRAW_BUFFER13=34866,pt.DRAW_BUFFER14=34867,pt.DRAW_BUFFER15=34868,pt.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657,pt.MAX_VERTEX_UNIFORM_COMPONENTS=35658,pt.SAMPLER_3D=35679,pt.SAMPLER_2D_SHADOW=35682,pt.FRAGMENT_SHADER_DERIVATIVE_HINT=35723,pt.PIXEL_PACK_BUFFER=35051,pt.PIXEL_UNPACK_BUFFER=35052,pt.PIXEL_PACK_BUFFER_BINDING=35053,pt.PIXEL_UNPACK_BUFFER_BINDING=35055,pt.FLOAT_MAT2x3=35685,pt.FLOAT_MAT2x4=35686,pt.FLOAT_MAT3x2=35687,pt.FLOAT_MAT3x4=35688,pt.FLOAT_MAT4x2=35689,pt.FLOAT_MAT4x3=35690,pt.SRGB=35904,pt.SRGB8=35905,pt.SRGB8_ALPHA8=35907,pt.COMPARE_REF_TO_TEXTURE=34894,pt.RGBA32F=34836,pt.RGB32F=34837,pt.RGBA16F=34842,pt.RGB16F=34843,pt.VERTEX_ATTRIB_ARRAY_INTEGER=35069,pt.MAX_ARRAY_TEXTURE_LAYERS=35071,pt.MIN_PROGRAM_TEXEL_OFFSET=35076,pt.MAX_PROGRAM_TEXEL_OFFSET=35077,pt.MAX_VARYING_COMPONENTS=35659,pt.TEXTURE_2D_ARRAY=35866,pt.TEXTURE_BINDING_2D_ARRAY=35869,pt.R11F_G11F_B10F=35898,pt.UNSIGNED_INT_10F_11F_11F_REV=35899,pt.RGB9_E5=35901,pt.UNSIGNED_INT_5_9_9_9_REV=35902,pt.TRANSFORM_FEEDBACK_BUFFER_MODE=35967,pt.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968,pt.TRANSFORM_FEEDBACK_VARYINGS=35971,pt.TRANSFORM_FEEDBACK_BUFFER_START=35972,pt.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973,pt.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976,pt.RASTERIZER_DISCARD=35977,pt.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978,pt.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979,pt.INTERLEAVED_ATTRIBS=35980,pt.SEPARATE_ATTRIBS=35981,pt.TRANSFORM_FEEDBACK_BUFFER=35982,pt.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983,pt.RGBA32UI=36208,pt.RGB32UI=36209,pt.RGBA16UI=36214,pt.RGB16UI=36215,pt.RGBA8UI=36220,pt.RGB8UI=36221,pt.RGBA32I=36226,pt.RGB32I=36227,pt.RGBA16I=36232,pt.RGB16I=36233,pt.RGBA8I=36238,pt.RGB8I=36239,pt.RED_INTEGER=36244,pt.RGB_INTEGER=36248,pt.RGBA_INTEGER=36249,pt.SAMPLER_2D_ARRAY=36289,pt.SAMPLER_2D_ARRAY_SHADOW=36292,pt.SAMPLER_CUBE_SHADOW=36293,pt.UNSIGNED_INT_VEC2=36294,pt.UNSIGNED_INT_VEC3=36295,pt.UNSIGNED_INT_VEC4=36296,pt.INT_SAMPLER_2D=36298,pt.INT_SAMPLER_3D=36299,pt.INT_SAMPLER_CUBE=36300,pt.INT_SAMPLER_2D_ARRAY=36303,pt.UNSIGNED_INT_SAMPLER_2D=36306,pt.UNSIGNED_INT_SAMPLER_3D=36307,pt.UNSIGNED_INT_SAMPLER_CUBE=36308,pt.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311,pt.DEPTH_COMPONENT32F=36012,pt.DEPTH32F_STENCIL8=36013,pt.FLOAT_32_UNSIGNED_INT_24_8_REV=36269,pt.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296,pt.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297,pt.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298,pt.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299,pt.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300,pt.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301,pt.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302,pt.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303,pt.FRAMEBUFFER_DEFAULT=33304,pt.DEPTH_STENCIL_ATTACHMENT=33306,pt.DEPTH_STENCIL=34041,pt.UNSIGNED_INT_24_8=34042,pt.DEPTH24_STENCIL8=35056,pt.UNSIGNED_NORMALIZED=35863,pt.DRAW_FRAMEBUFFER_BINDING=36006,pt.READ_FRAMEBUFFER=36008,pt.DRAW_FRAMEBUFFER=36009,pt.READ_FRAMEBUFFER_BINDING=36010,pt.RENDERBUFFER_SAMPLES=36011,pt.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052,pt.MAX_COLOR_ATTACHMENTS=36063,pt.COLOR_ATTACHMENT1=36065,pt.COLOR_ATTACHMENT2=36066,pt.COLOR_ATTACHMENT3=36067,pt.COLOR_ATTACHMENT4=36068,pt.COLOR_ATTACHMENT5=36069,pt.COLOR_ATTACHMENT6=36070,pt.COLOR_ATTACHMENT7=36071,pt.COLOR_ATTACHMENT8=36072,pt.COLOR_ATTACHMENT9=36073,pt.COLOR_ATTACHMENT10=36074,pt.COLOR_ATTACHMENT11=36075,pt.COLOR_ATTACHMENT12=36076,pt.COLOR_ATTACHMENT13=36077,pt.COLOR_ATTACHMENT14=36078,pt.COLOR_ATTACHMENT15=36079,pt.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182,pt.MAX_SAMPLES=36183,pt.HALF_FLOAT=5131,pt.RG=33319,pt.RG_INTEGER=33320,pt.R8=33321,pt.RG8=33323,pt.R16F=33325,pt.R32F=33326,pt.RG16F=33327,pt.RG32F=33328,pt.R8I=33329,pt.R8UI=33330,pt.R16I=33331,pt.R16UI=33332,pt.R32I=33333,pt.R32UI=33334,pt.RG8I=33335,pt.RG8UI=33336,pt.RG16I=33337,pt.RG16UI=33338,pt.RG32I=33339,pt.RG32UI=33340,pt.VERTEX_ARRAY_BINDING=34229,pt.R8_SNORM=36756,pt.RG8_SNORM=36757,pt.RGB8_SNORM=36758,pt.RGBA8_SNORM=36759,pt.SIGNED_NORMALIZED=36764,pt.COPY_READ_BUFFER=36662,pt.COPY_WRITE_BUFFER=36663,pt.COPY_READ_BUFFER_BINDING=36662,pt.COPY_WRITE_BUFFER_BINDING=36663,pt.UNIFORM_BUFFER=35345,pt.UNIFORM_BUFFER_BINDING=35368,pt.UNIFORM_BUFFER_START=35369,pt.UNIFORM_BUFFER_SIZE=35370,pt.MAX_VERTEX_UNIFORM_BLOCKS=35371,pt.MAX_FRAGMENT_UNIFORM_BLOCKS=35373,pt.MAX_COMBINED_UNIFORM_BLOCKS=35374,pt.MAX_UNIFORM_BUFFER_BINDINGS=35375,pt.MAX_UNIFORM_BLOCK_SIZE=35376,pt.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377,pt.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379,pt.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380,pt.ACTIVE_UNIFORM_BLOCKS=35382,pt.UNIFORM_TYPE=35383,pt.UNIFORM_SIZE=35384,pt.UNIFORM_BLOCK_INDEX=35386,pt.UNIFORM_OFFSET=35387,pt.UNIFORM_ARRAY_STRIDE=35388,pt.UNIFORM_MATRIX_STRIDE=35389,pt.UNIFORM_IS_ROW_MAJOR=35390,pt.UNIFORM_BLOCK_BINDING=35391,pt.UNIFORM_BLOCK_DATA_SIZE=35392,pt.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394,pt.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395,pt.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396,pt.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398,pt.INVALID_INDEX=4294967295,pt.MAX_VERTEX_OUTPUT_COMPONENTS=37154,pt.MAX_FRAGMENT_INPUT_COMPONENTS=37157,pt.MAX_SERVER_WAIT_TIMEOUT=37137,pt.OBJECT_TYPE=37138,pt.SYNC_CONDITION=37139,pt.SYNC_STATUS=37140,pt.SYNC_FLAGS=37141,pt.SYNC_FENCE=37142,pt.SYNC_GPU_COMMANDS_COMPLETE=37143,pt.UNSIGNALED=37144,pt.SIGNALED=37145,pt.ALREADY_SIGNALED=37146,pt.TIMEOUT_EXPIRED=37147,pt.CONDITION_SATISFIED=37148,pt.WAIT_FAILED=37149,pt.SYNC_FLUSH_COMMANDS_BIT=1,pt.VERTEX_ATTRIB_ARRAY_DIVISOR=35070,pt.ANY_SAMPLES_PASSED=35887,pt.ANY_SAMPLES_PASSED_CONSERVATIVE=36202,pt.SAMPLER_BINDING=35097,pt.RGB10_A2UI=36975,pt.INT_2_10_10_10_REV=36255,pt.TRANSFORM_FEEDBACK=36386,pt.TRANSFORM_FEEDBACK_PAUSED=36387,pt.TRANSFORM_FEEDBACK_ACTIVE=36388,pt.TRANSFORM_FEEDBACK_BINDING=36389,pt.TEXTURE_IMMUTABLE_FORMAT=37167,pt.MAX_ELEMENT_INDEX=36203,pt.TEXTURE_IMMUTABLE_LEVELS=33503;var vt=pt,mt=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return G()(this,t),(n=X()(this,K()(t).call(this))).uniformLocations={},n.id=t.staticId,t.staticId++,n.renderer=e,n.shaderDefines=i,n}return Q()(t,e),W()(t,[{key:"load",value:function(e,t,n){var i=this;Promise.all([t.loadAssetByName("".concat(e,".vs.glsl")),t.loadAssetByName("".concat(e,".fs.glsl"))]).then(function(r){i.loadIncludes(r,t,function(t){i.init(e,t[0],t[1],n)})})}},{key:"loadIncludes",value:function(e,t,n){for(var i=this,r=/^#include\s+(\S+)/,a=[],s=0;s<e.length;s++)for(var o=e[s].split("\n"),l=0;l<o.length;l++){var u=o[l];u=u.trim();var h;null!==(h=r.exec(u))&&a.push([h[1],h])}if(a.length){for(var c=[],d=0;d<a.length;d++)c[d]=a[d][0];Promise.all(c.map(function(e){return t.loadAssetByPath(e)})).then(function(r){for(var s=0;s<e.length;s++)for(var o=0;o<a.length;o++)e[s]=e[s].replace(a[o][1][0],"\n\n///// Start "+c[o]+"\n\n"+r[o]+"\n\n///// End "+c[o]+"\n\n");i.loadIncludes(e,t,n)})}else n.call(this,e)}},{key:"init",value:function(e,n,i,r){if(this.name=e,this.shaderDefines&&this.shaderDefines.length>0){for(var a="",s=0;s<this.shaderDefines.length;s++)a+="#define "+this.shaderDefines[s]+"\n";et.log("adding defines: ",this.name,a),n=a+n,i=a+i}n=t.stripUniformDuplicates(n),i=t.stripUniformDuplicates(i),n=this.renderer.preprocessShaderString(n),i=this.renderer.preprocessShaderString(i);var o=this.renderer.context,l=this.compileShader(o,n,o.VERTEX_SHADER),u=this.compileShader(o,i,o.FRAGMENT_SHADER);this.program=this.LinkProgram(o,l,u),this.getUniforms(o,this.program),this.getAttributes(o,this.program),r&&r.call(this)}},{key:"compileShader",value:function(e,t,n){var i=e.createShader(n);if(e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))return i;var r=e.getShaderInfoLog(i);if(r){et.error("compileShader: error: "+this.name,(n===ot.VERTEX_SHADER?"vs":"fs")+" \n"+r),console.log("%c compileShader: "+this.name+(n===ot.VERTEX_SHADER?" vs":" fs"),"background: #fff0f0; color: red"),console.log(r);for(var a=/ERROR: (\d+):(\d+):/,s=r.split("\n"),o=[],l=0;l<s.length;l++){var u,h=s[l];null!==(u=a.exec(h))&&(o[parseInt(u[2],10)-1]=h)}s=t.split("\n");var c=[];c[0]="";for(var d=0;d<s.length;d++)c[0]+="%c"+s[d]+"\n",c[d+1]=o[d]?"background: #fff0f0; color: red":"background: white; color: black",o[d]&&(c[0]+=" --\x3e "+o[d]+"\n");console.log.apply(console,c),console.log("%c compileShader: "+this.name+(n===ot.VERTEX_SHADER?" vs":" fs"),"background: #fff0f0; color: red")}throw new Error("unable to compile shader")}},{key:"LinkProgram",value:function(e,t,n){var i=e.createProgram();if(e.attachShader(i,t),e.attachShader(i,n),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;throw console.log("LinkProgram",this.name),new Error("Program link error:\n"+e.getProgramInfoLog(i))}},{key:"getUniforms",value:function(e,t){var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);this.textureUniforms=[],this.uniformLocations={};for(var i=0,r=0;r<n;r++){var a=e.getActiveUniform(t,r);if(!this.program)throw new Error("Shader not yet initialized");var s=e.getUniformLocation(this.program,a.name);this.uniformLocations[a.name]=s,a.type!==ot.SAMPLER_2D&&a.type!==ot.SAMPLER_CUBE&&a.type!==vt.SAMPLER_3D||(this.textureUniforms.push(new _t(this,a.name,s,i)),i++)}}},{key:"getAttributes",value:function(e,n){var i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);if(this.attributes=[],!this.program)throw new Error("Shader not yet initialized");for(var r=0;r<i;r++){var a=e.getActiveAttrib(n,r),s=e.getAttribLocation(this.program,a.name),o=t.getStride(a.type);this.attributes.push(new ft(a.name,o,s))}}},{key:"getAttributeByName",value:function(e){if(this.attributes)for(var t=0;t<this.attributes.length;t++)if(this.attributes[t].name===e)return this.attributes[t];return null}},{key:"getTextureUniformByName",value:function(e){if(this.textureUniforms)for(var t=0;t<this.textureUniforms.length;t++)if(this.textureUniforms[t].name===e)return this.textureUniforms[t];return null}},{key:"destruct",value:function(){ke()(K()(t.prototype),"destruct",this).call(this)}}],[{key:"stripUniformDuplicates",value:function(e){for(var t="",n={},i=/^uniform\s+(\S*)\s+(\S*);/,r=e.split("\n"),a=0;a<r.length;a++){var s=r[a];s=s.trim();var o;if(null!==(o=i.exec(s))){var l=o[2];n[l]&&(s="// "+s),n[l]=!0}t+=s+"\n"}return t}},{key:"getStride",value:function(e){switch(e){case ot.FLOAT:return 1;case ot.FLOAT_VEC2:return 2;case ot.FLOAT_VEC3:return 3;case ot.FLOAT_VEC4:return 4;default:return et.error("attribute type not handled: "+e),-1}}}]),t}(Me);mt.staticId=0;var gt=mt,At=function(e){function t(e,n,i){var r;return G()(this,t),(r=X()(this,K()(t).call(this,e,i,new gt(e)))).shaderIndex=e.shaderIndex,n.add(Ye()(Ye()(r))),r}return Q()(t,e),W()(t,[{key:"load",value:function(e){var t=this;this.shader.shaderDefines=this.getShaderDefines(),this.shader.load(this.name,this.shaderIndex,function(){e.call(t)})}}]),t}(dt),yt=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this)))._depthMask=!0,n._depthTest=!0,n._depthFunc=-1,n._culling=-1,n._cullingEnabled=!0,n._blendEquation=-1,n._blendEnabled=!0,n._sourceBlend=-1,n._destinationBlend=-1,n._renderer=e,n.setBlendEnabled(!n._blendEnabled),n.setCullingEnabled(!n._cullingEnabled),n.setDepthMask(!n._depthMask),n.setDepthTest(!n._depthTest),n.enabledAttribArrays=[],n._textureSlots=[],n}return Q()(t,e),W()(t,[{key:"bindTextureToSlot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._textureSlots[t]!=e&&(this._renderer.context.activeTexture(ot.TEXTURE0+t),this._renderer.context.bindTexture(ot.TEXTURE_2D,e),this._textureSlots[t]=e)}},{key:"bindTexture3DToSlot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._textureSlots[t]!=e&&(this._renderer.context.activeTexture(ot.TEXTURE0+t),this._renderer.context.bindTexture(vt.TEXTURE_3D,e),this._textureSlots[t]=e)}},{key:"bindCubeTextureToSlot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._textureSlots[t]!=e&&(this._renderer.context.activeTexture(ot.TEXTURE0+t),this._renderer.context.bindTexture(ot.TEXTURE_CUBE_MAP,e),this._textureSlots[t]=e)}},{key:"setProgram",value:function(e){return e!=this._program&&(this._program=e,this._renderer.context.useProgram(this._program),!0)}},{key:"setDepthMask",value:function(e){e!=this._depthMask&&(this._renderer.context.depthMask(e),this._depthMask=e)}},{key:"getDepthMask",value:function(){return this._depthMask}},{key:"setDepthTest",value:function(e){e!=this._depthTest&&(e?this._renderer.context.enable(ot.DEPTH_TEST):this._renderer.context.disable(ot.DEPTH_TEST),this._depthTest=e)}},{key:"setDepthFunc",value:function(e){e!=this._depthFunc&&(e?this._renderer.context.depthFunc(e):this._renderer.context.depthFunc(this._renderer.context.LESS),this._depthFunc=e)}},{key:"setCullingEnabled",value:function(e){e!=this._cullingEnabled&&(e?this._renderer.context.enable(ot.CULL_FACE):this._renderer.context.disable(ot.CULL_FACE),this._cullingEnabled=e)}},{key:"setCulling",value:function(e){e!=this._culling&&(e==ot.NONE?this.setCullingEnabled(!1):(this.setCullingEnabled(!0),this._renderer.context.cullFace(e)),this._culling=e)}},{key:"setBlendEquation",value:function(e){e!=this._blendEquation&&(this._renderer.context.blendEquation(e),this._blendEquation=e)}},{key:"setBlendEnabled",value:function(e){e!=this._blendEnabled&&(e?this._renderer.context.enable(ot.BLEND):this._renderer.context.disable(ot.BLEND),this._blendEnabled=e)}},{key:"setBlendFunc",value:function(e,t){e==this._sourceBlend&&t==this._destinationBlend||(this._renderer.context.blendFunc(e,t),this._sourceBlend=e,this._destinationBlend=t)}},{key:"setBlendFuncSeparate",value:function(e,t,n,i){this._renderer.context.blendFuncSeparate(e,t,n,i),this._sourceBlend=-1}}]),t}(Me),Et=function(){function e(){G()(this,e),this.maxAnisotropy=0}return W()(e,[{key:"enableExtensions",value:function(t){this.color_buffer_float=e.enableExtension(t,"WEBGL_color_buffer_float")||e.enableExtension(t,"EXT_color_buffer_float"),this.color_buffer_half_float=e.enableExtension(t,"EXT_color_buffer_half_float"),this.texture_float=e.enableExtension(t,"OES_texture_float"),this.texture_float_linear=e.enableExtension(t,"OES_texture_float_linear"),this.texture_half_float=e.enableExtension(t,"OES_texture_half_float"),this.texture_half_float_linear=e.enableExtension(t,"OES_texture_half_float_linear"),this.shader_texture_lod=e.enableExtension(t,"EXT_shader_texture_lod"),this.standard_derivatives=e.enableExtension(t,"OES_standard_derivatives"),this.blend_minmax=e.enableExtension(t,"EXT_blend_minmax"),this.seamless_cube_map=e.enableExtension(t,"OES_seamless_cube_map"),this.vertex_array_object=e.enableExtension(t,"OES_vertex_array_object"),this.filter_anisotropic=e.enableExtension(t,"texture_filter_anisotropic"),this.filter_anisotropic||(this.filter_anisotropic=e.enableExtension(t,"MOZ_EXT_texture_filter_anisotropic")),this.filter_anisotropic||(this.filter_anisotropic=e.enableExtension(t,"WEBKIT_EXT_texture_filter_anisotropic")),this.filter_anisotropic&&(this.maxAnisotropy=t.getParameter(this.filter_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT),et.log("MAX_TEXTURE_MAX_ANISOTROPY_EXT: ",this.maxAnisotropy)),this.frag_depth=e.enableExtension(t,"EXT_frag_depth"),this.depth_texture=e.enableExtension(t,"WEBGL_depth_texture"),this.element_index_uint=e.enableExtension(t,"OES_element_index_uint"),this.enableTextureCompression(t)}},{key:"enableTextureCompression",value:function(t){var n=e.enableExtension(t,"WEBKIT_WEBGL_compressed_texture_s3tc");if(n){var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS);if(i.length>0)for(var r in i)i[r]===n.COMPRESSED_RGB_S3TC_DXT1_EXT&&et.log("support found for texture compression: RGB_S3TC_DXT1"),i[r]===n.COMPRESSED_RGBA_S3TC_DXT1_EXT&&et.log("support found for texture compression: RGBA_S3TC_DXT1"),i[r]===n.COMPRESSED_RGBA_S3TC_DXT3_EXT&&et.log("support found for texture compression: RGBA_S3TC_DXT3"),i[r]===n.COMPRESSED_RGBA_S3TC_DXT5_EXT&&et.log("support found for texture compression: RGBA_S3TC_DXT5");else et.log("no support found for texture compression ")}}},{key:"getMinMaxSupported",value:function(){return null!==this.blend_minmax}}],[{key:"enableExtension",value:function(e,t){var n=e.getExtension(t);return n?et.log("enabled extension "+t):et.log("extension "+t+" is not supported"),n}}]),e}(),Tt=function(){function e(){G()(this,e),this.webpackContexts=[],this.assetNameMap={},this.assetPathMap={}}return W()(e,[{key:"loadAssetByPath",value:function(e){var t=this.getAssetByPath(e);return Ve.loadSingleFromRequireContext(t.webpackContext,t.path)}},{key:"getAssetByPath",value:function(e){var t="./".concat(e.replace(/^\.\//,""));if("undefined"===typeof this.assetPathMap[t])throw new ReferenceError("Could not find asset with path ".concat(e,". Available paths: \n").concat(Object.keys(this.assetPathMap).join("\n")));return{webpackContext:this.webpackContexts[this.assetPathMap[t]],path:t}}},{key:"loadAssetByName",value:function(e){var t=this.getAssetByName(e);return Ve.loadSingleFromRequireContext(t.webpackContext,t.path)}},{key:"getAssetByName",value:function(e){if("undefined"===typeof this.assetNameMap[e])throw new ReferenceError('Could not find asset with name "'.concat(e,'". Available assets: \n').concat(Object.keys(this.assetNameMap.vs).join(", ")));return{webpackContext:this.webpackContexts[this.assetNameMap[e].contextIndex],path:this.assetNameMap[e].path}}},{key:"addContext",value:function(e){var t=this;if(!(this.webpackContexts.indexOf(e)>=0)){var n=this.webpackContexts.length;this.webpackContexts.push(e),e.keys().forEach(function(e){var i=e.match(/([^\\\/]+)$/);if(i){if(t.assetNameMap[i[1]]){var r=t.webpackContexts[t.assetNameMap[i[1]].contextIndex].resolve(t.assetNameMap[i[1]].path);console.warn('WARNING: found asset "'.concat(e,'" but another asset with the name "').concat(i[1],'" was already found at "').concat(r,'"'))}t.assetNameMap[i[1]]={contextIndex:n,path:e}}t.assetPathMap[e]=n})}}}]),e}(),Ct=function(e){function t(e,n,i,r,a,s){var o;return G()(this,t),(o=X()(this,K()(t).call(this))).data=null,o.vertexCount=-1,o._renderer=e,o.stride=r,o.name=n,o.storeData=a,o.vertexCount=i.length/r,s?(o.buffer=o._renderer.context.createBuffer(),o.setData(i,a)):o.data=i,o}return Q()(t,e),W()(t,[{key:"setData",value:function(e,t){if(t||!this.buffer?this.data=e:this.data=null,0===e.length)throw"VertexAttribute: no data: probably a mesh file could not be loaded";if(this.buffer){var n=this._renderer.context;n.bindBuffer(ot.ARRAY_BUFFER,this.buffer),n.bufferData(ot.ARRAY_BUFFER,e.byteLength,ot.STATIC_DRAW),n.bufferSubData(ot.ARRAY_BUFFER,0,e)}}},{key:"getBufferLength",value:function(){if(this.data)return this.data.length;if(!this.buffer)throw new ReferenceError("Cannot get buffer length: no buffer set on VertextAttribute");var e=this._renderer.context;return e.bindBuffer(ot.ARRAY_BUFFER,this.buffer),e.getBufferParameter(ot.ARRAY_BUFFER,ot.BUFFER_SIZE)/4}},{key:"destruct",value:function(){var e=this._renderer.context;this.buffer&&e.deleteBuffer(this.buffer),this.data=null,ke()(K()(t.prototype),"destruct",this).call(this)}}],[{key:"serialize",value:function(e){return null===e.data?(console.error("Trying to serialize vertex attribute "+e.name+" without saved data"),{}):{name:e.name,data:e.data,stride:e.stride,storeData:e.storeData}}},{key:"deserialize",value:function(e){return{name:e.name,data:e.data,stride:e.stride,storeData:e.storeData}}}]),t}(Me),wt=function e(t,n){G()(this,e),this.name=t,this.stride=n};wt.POSITION=new wt("aPos",3),wt.TEXCOORD0=new wt("aUV0",2),wt.TEXCOORD1=new wt("aUV1",2),wt.NORMAL=new wt("aNormal",3),wt.COLOR0=new wt("aColor0",3),wt.COLOR1=new wt("aColor1",3),wt.TANGENT=new wt("aTangent",4);var Rt=wt,St=function(e){function t(e){var n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return G()(this,t),(n=X()(this,K()(t).call(this)))._vertexCount=0,n._isInterleavedBufferDirty=!0,n._attributeNames={},n.renderer=e,n.attributes=[],n._vertexCount=0,n.id=t.id++,n.interleaved=i,n.isDynamic=r,n}return Q()(t,e),W()(t,[{key:"setJSONData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.animatorId=e.animatorId,this.isDynamic=e.isDynamic||!1,e.indices&&e.indices.length>0&&(e.use32BitIndices?this.setIndices32(new Uint32Array(e.indices)):this.setIndices(new Uint16Array(e.indices)));for(var n=0;n<e.attributes.length;n++){var i=e.attributes[n];this.setAttribute(i.name,i.stride,new Float32Array(i.data),t)}}},{key:"clone",value:function(){for(var e=new t(this.renderer,this.interleaved,this.isDynamic),n=0;n<this.attributes.length;n++)e.attributes.push(this.attributes[n]);return e._vertexCount=this._vertexCount,e}},{key:"interleaveData",value:function(){if(this._isInterleavedBufferDirty&&this.interleaved){this.interleavedStrideSum=0;for(var e=0;e<this.attributes.length;e++)this.interleavedStrideSum+=this.attributes[e].stride;for(var t=new Float32Array(this.interleavedStrideSum*this._vertexCount),n=0,i=0;i<this._vertexCount;i++)for(var r=0;r<this.attributes.length;r++)for(var a=this.attributes[r],s=0;s<a.stride;s++)t[n++]=a.data[i*a.stride+s];for(var o=0;o<this.attributes.length;o++)this.attributes[o].storeData||(this.attributes[o].data=null);this.interleavedBuffer=this.renderer.context.createBuffer();var l=this.renderer.context;l.bindBuffer(ot.ARRAY_BUFFER,this.interleavedBuffer),l.bufferData(ot.ARRAY_BUFFER,t,l.STATIC_DRAW),this._isInterleavedBufferDirty=!1,et.log("Mesh: finalize",this.attributes.length)}}},{key:"isInterleaved",value:function(){return this.interleaved}},{key:"hasIndices",value:function(){return!!this.indices}},{key:"setAttribute",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.setData(n,e,t,i)}},{key:"setPositions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt.POSITION;this.setData(e,n.name,n.stride,t)}},{key:"getPositions",value:function(){return this.getData(Rt.POSITION.name)}},{key:"setNormals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt.NORMAL;this.setData(e,n.name,n.stride,t)}},{key:"getNormals",value:function(){return this.getData(Rt.NORMAL.name)}},{key:"setColors",value:function(e){var t=Rt.COLOR0;this.setData(e,t.name,t.stride)}},{key:"getColors",value:function(){return this.getData(Rt.COLOR0.name)}},{key:"setColors1",value:function(e){var t=Rt.COLOR1;this.setData(e,t.name,t.stride)}},{key:"getColors1",value:function(){return this.getData(Rt.COLOR1.name)}},{key:"setUV0",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt.TEXCOORD0;this.setData(e,n.name,n.stride,t)}},{key:"getUV0",value:function(){return this.getData(Rt.TEXCOORD0.name)}},{key:"setUV1",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt.TEXCOORD1;this.setData(e,n.name,n.stride,t)}},{key:"getUV1",value:function(){return this.getData(Rt.TEXCOORD1.name)}},{key:"setTangents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt.TANGENT;this.setData(e,n.name,n.stride,t)}},{key:"getTangents",value:function(){return this.getData(Rt.TANGENT.name)}},{key:"setData",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._attributeNames={};var r=this.getAttributeIndex(t),a=e.length/n;r<0?this.attributes.push(new Ct(this.renderer,t,e,n,i,!this.interleaved)):this.attributes[r].vertexCount==a?this.attributes[r].setData(e,i):(this.attributes[r].destruct(),this.attributes[r]=new Ct(this.renderer,t,e,n,i,!this.interleaved)),this._vertexCount=a,this.interleaved&&(this._isInterleavedBufferDirty=!0)}},{key:"deleteAttribute",value:function(e){var t=this.getAttributeIndex(e);t>=0&&this.attributes.splice(t,1),this._isInterleavedBufferDirty=!0,this._attributeNames={}}},{key:"hasAttribute",value:function(e){var t=this._attributeNames[e];if(!0===t||!1===t)return t;var n=this.getAttributeIndex(e);return this._attributeNames[e]=n>=0,this._attributeNames[e]}},{key:"getAttribute",value:function(e){var t=this.getAttributeIndex(e);return t>=0?this.attributes[t]:null}},{key:"getAttributeIndex",value:function(e){for(var t=0;t<this.attributes.length;t++)if(this.attributes[t].name===e)return t;return-1}},{key:"getData",value:function(e){var t=this.getAttribute(e);return t&&t.data?t.data:(et.log("Mesh: getData",e,"no data"),null)}},{key:"setIndices",value:function(e){if(!(e instanceof Uint16Array))throw"Indices need to be of type Uint16Array";this.indexType=ot.UNSIGNED_SHORT,this.indices=e;var t=this.renderer.context;this.indexBuffer||(this.indexBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)}},{key:"setIndices32",value:function(e){if(!(e instanceof Uint32Array))throw"Indices need to be of type Uint32Array";if(this.renderer.extensionManager.element_index_uint){this.indexType=ot.UNSIGNED_INT,this.indices=e;var t=this.renderer.context;this.indexBuffer||(this.indexBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)}else et.log("mesh: setIndices32: extension not supported: element_index_uint: using 16 bits indices"),this.setIndices(new Uint16Array(e))}},{key:"getNumVertices",value:function(){return this._vertexCount}},{key:"isSkinned",value:function(){return this.hasAttribute("aSkinIndex")}},{key:"destruct",value:function(){if(!this.isDestructed){this.renderer.destructVAO(this);var e=this.renderer.context;if(this.interleavedBuffer&&e.deleteBuffer(this.interleavedBuffer),this.indexBuffer&&e.deleteBuffer(this.indexBuffer),this.attributes)for(var n=0;n<this.attributes.length;n++)this.attributes[n].destruct();ke()(K()(t.prototype),"destruct",this).call(this)}}}]),t}(Me);St.id=0;var It=St,bt=function e(){G()(this,e),this.down=!1,this.downThisFrame=!1,this.downByTouch=!1,this.clickCanceled=!1,this.downTime=0},xt=function(e){function t(e){var n;G()(this,t),(n=X()(this,K()(t).call(this)))._mousePos=new Je,n._previousMousePos=new Je,n._mouseVelocity=new Je,n._normalized=new Je,n._screen=new Je,n._wheelCallbacks=[],n._mouseClickCallbacks=[],n._mouseDownCallbacks=[],n._buttons=[],n._manualUpdate=!1,n._resetSpeed=!1,n._preventDefault=!1,n._touchStartListener=function(e){n._preventDefault&&e.preventDefault(),n._resetSpeed=!0,n.mouseDown(0),n._buttons[0].downByTouch=!0,n.setMousePosition(e.targetTouches[0]);for(var t=0;t<n._mouseDownCallbacks.length;t++)n._mouseDownCallbacks[t].call(Ye()(Ye()(n)))},n._touchMoveListener=function(e){n.setMousePosition(e.targetTouches[0])},n._endListener=function(){for(var e=0;e<n._buttons.length;e++)n._buttons[e].down=!1,n._buttons[e].downThisFrame=!1,n._buttons[e].downByTouch=!1},n._mouseDownListener=function(e){n._preventDefault&&e.preventDefault(),n.mouseDown(e.which-1),n.setMousePosition(e);for(var t=0;t<n._mouseDownCallbacks.length;t++)n._mouseDownCallbacks[t].call(Ye()(Ye()(n)))},n._mouseMoveListener=function(e){n.setMousePosition(e);for(var t=0;t<3;t++)n._buttons[t].downTime>.25&&(n._buttons[t].clickCanceled=!0)},n._mouseWheelListener=function(e){for(var t=0;t<n._wheelCallbacks.length;t++)n._wheelCallbacks[t].call(Ye()(Ye()(n)),Math.sign(e.wheelDelta))},n._upListener=function(){if(n._resetSpeed=!0,!n._buttons[0].clickCanceled)for(var e=0;e<n._mouseClickCallbacks.length;e++)n._mouseClickCallbacks[e].call(Ye()(Ye()(n)));for(var t=0;t<n._buttons.length;t++)n._buttons[t].down=!1,n._buttons[t].downThisFrame=!1,n._buttons[t].downByTouch=!1},n._canvas=e;for(var i=0;i<3;i++)n._buttons.push(new bt);return n._canvas.addEventListener("touchstart",n._touchStartListener,!1),n._canvas.addEventListener("touchmove",n._touchMoveListener,!1),n._canvas.addEventListener("touchend",n._upListener,!1),n._canvas.addEventListener("touchcancel",n._endListener,!1),n._canvas.addEventListener("mousedown",n._mouseDownListener,!1),document.body.addEventListener("mousemove",n._mouseMoveListener,!1),n._canvas.addEventListener("mouseup",n._upListener,!1),n._canvas.addEventListener("mousecancel",n._endListener,!1),n._canvas.addEventListener("mouseout",n._endListener,!1),n._canvas.addEventListener("mousewheel",n._mouseWheelListener,!1),n.updateLoop(),n}return Q()(t,e),W()(t,[{key:"setPreventDefault",value:function(e){this._preventDefault=e}},{key:"mouseDown",value:function(e){this._resetSpeed=!0,this._buttons[e].down=!0,this._buttons[e].downThisFrame=!0,this._buttons[e].clickCanceled=!1,this._buttons[e].downByTouch=!1,this._buttons[e].downTime=0}},{key:"addWheelEvent",value:function(e){this._wheelCallbacks.push(e)}},{key:"addMouseClickEvent",value:function(e){this._mouseClickCallbacks.push(e)}},{key:"addMouseDownEvent",value:function(e){this._mouseDownCallbacks.push(e)}},{key:"setMousePosition",value:function(e){this._mousePos.x=e.pageX,this._mousePos.y=e.pageY}},{key:"getPixelPos",value:function(){return this._mousePos}},{key:"getNormalizedPos",value:function(){return this._normalized}},{key:"getScreenPos",value:function(){return this._screen}},{key:"getNormalizedVelocity",value:function(){return this._mouseVelocity}},{key:"getButton",value:function(e){return this._buttons[e]}},{key:"getMouseDown",value:function(){return this._buttons[0].down}},{key:"getMouseDownThisFrame",value:function(){return this._buttons[0].downThisFrame}},{key:"getMouseDownRight",value:function(){return this._buttons[2].down}},{key:"getMouseDownThisFrameRight",value:function(){return this._buttons[2].downThisFrame}},{key:"updateManual",value:function(){this._manualUpdate=!0,this.update()}},{key:"updateLoop",value:function(){var e=this;this.isDestructed||this._manualUpdate||(this.update(),window.requestAnimationFrame(function(){return e.updateLoop()}))}},{key:"update",value:function(){this._normalized.x=this._mousePos.x/this._canvas.clientWidth,this._normalized.y=this._mousePos.y/this._canvas.clientHeight,this._screen.x=2*this._normalized.x-1,this._screen.y=-(2*this._normalized.y-1),this._resetSpeed?(this._resetSpeed=!1,this._mouseVelocity.setValues(0,0)):(this._mouseVelocity.x=this._normalized.x-this._previousMousePos.x,this._mouseVelocity.y=this._normalized.y-this._previousMousePos.y),this._previousMousePos.copy(this._normalized);for(var e=0;e<3;e++){var t=this._buttons[e];t.downTime>0&&(t.downThisFrame=!1),this._buttons[e].down&&(t.downTime+=tt.getInstance().deltaTime)}}},{key:"cancelClick",value:function(){for(var e=0;e<this._buttons.length;e++)this._buttons[e].clickCanceled=!0}},{key:"destruct",value:function(){this._canvas&&(this._canvas.removeEventListener("touchstart",this._touchStartListener,!1),this._canvas.removeEventListener("touchmove",this._touchMoveListener,!1),this._canvas.removeEventListener("touchend",this._upListener,!1),this._canvas.removeEventListener("touchcancel",this._endListener,!1),this._canvas.removeEventListener("mousedown",this._mouseDownListener,!1),document.body.removeEventListener("mousemove",this._mouseMoveListener,!1),this._canvas.removeEventListener("mouseend",this._endListener,!1),this._canvas.removeEventListener("mousecancel",this._endListener,!1),this._canvas.removeEventListener("mouseout",this._endListener,!1),this._canvas.removeEventListener("mousewheel",this._mouseWheelListener,!1),this._canvas.removeEventListener("mouseup",this._upListener,!1)),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),kt=n(452),Mt=function(e){function t(e,n,i,r,a){var s,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];!(arguments.length>6&&void 0!==arguments[6])||arguments[6],arguments.length>7&&void 0!==arguments[7]&&arguments[7],arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(G()(this,t),(s=X()(this,K()(t).call(this))).textureCount=0,s.isWebgl2=!1,s._renderWidth=1,s._renderHeight=1,s._renderSize=new Je,s.id=t._id++,null===r?s.shaderIndex=new Tt:"function"===typeof r?(s.shaderIndex=new Tt,s.shaderIndex.addContext(r)):s.shaderIndex=r,s.shaderIndex.addContext(kt),s._canvas=n,s._canvas.addEventListener("resize",function(){return s.handleCanvasResize()}),i===t.webgl2ContextName?s.isWebgl2=!0:o||s.getAlphaIsCorrect()||(o=!0),s.context=s.getCanvas().getContext(i,{alpha:!1,stencil:!1,preserveDrawingBuffer:!1,antialias:a,powerPreference:"high-performance"}),!s.context)throw new Error("could not get a 3d context: aborting");return s.maxParams=new nt(s.context),s.renderState=new yt(Ye()(Ye()(s))),t.staticExtensionManager=s.extensionManager=new Et,s.extensionManager.enableExtensions(s.context),s._copyTextureMaterial=new At(Ye()(Ye()(s)),e,"default"),s._copyTextureMaterial.depthTest=!1,s._copyTextureMaterial.depthWrite=!1,s._clearColor=new at(.5,.5,.5,1),s._blitMesh=s.createTriangle(),s}return Q()(t,e),W()(t,[{key:"getAlphaIsCorrect",value:function(){var e=document.createElement("canvas");e.width=1,e.height=1;var t=e.getContext("experimental-webgl",{alpha:!1,preserveDrawingBuffer:!1});t.clearColor(1,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);var n=document.createElement("canvas").getContext("2d");n.drawImage(e,0,0);var i=255===n.getImageData(0,0,1,1).data[3];return i||et.log("alpha bug detected"),i}},{key:"init",value:function(){et.log("renderer: textureCount",this.textureCount),this.unSetRenderTexture(),this.handleCanvasResize()}},{key:"getRenderContext",value:function(){throw new ReferenceError("GetRenderContext(): no implementation defined, no context available.")}},{key:"preprocessShaderString",value:function(e){return e}},{key:"draw",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"startBatch",value:function(e,t){}},{key:"drawElements",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"endBatch",value:function(){}},{key:"createTriangle",value:function(){var e=new It(this),t=new Float32Array([-1,-1,0,-1,3,0,3,-1,0]);e.setPositions(t);var n=new Float32Array([0,0,0,2,2,0]);e.setUV0(n);var i=new Uint16Array([0,2,1]);return e.setIndices(i),e}},{key:"createQuad",value:function(){var e=new It(this),t=new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0]);e.setPositions(t);var n=new Float32Array([0,0,0,1,1,1,1,0]);e.setUV0(n);var i=new Uint16Array([0,2,1,2,0,3]);return e.setIndices(i),e}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getMouseListener",value:function(){return this._mouseListener||(this._mouseListener=new xt(document.body)),this._mouseListener}},{key:"getRenderWidth",value:function(){return this._renderWidth}},{key:"getRenderHeight",value:function(){return this._renderHeight}},{key:"getRenderSize",value:function(){return this._renderSize}},{key:"handleCanvasResize",value:function(){this.setRenderSize(this.getCanvas().width,this.getCanvas().height)}},{key:"enablePointsprites",value:function(){this.context.enable(34370)}},{key:"blit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=n||this._copyTextureMaterial;t&&this.setRenderTexture(t),e&&r.setTexture("uTexture",e),i&&this.clear(),this.draw(this._blitMesh,r),t&&this.unSetRenderTexture()}},{key:"setRenderTexture",value:function(e){e.scaleToCanvas&&e.setTextureSize(Math.round(this.getCanvas().width*e.sizeMultiplier),Math.round(this.getCanvas().height*e.sizeMultiplier)),e.setAsTarget(),this.setRenderSize(e.width,e.height)}},{key:"unSetRenderTexture",value:function(){var e=this.context;e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),this.setRenderSize(this.getCanvas().width,this.getCanvas().height)}},{key:"clearWithColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.context.clearColor(e,t,n,i),this.clear(),this.context.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)}},{key:"clearRenderTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.setRenderTexture(e),this.clearWithColor(t,n,i,r),this.unSetRenderTexture()}},{key:"getAspect",value:function(){return this._renderWidth/this._renderHeight}},{key:"clearDepth",value:function(){this.renderState.setDepthMask(!0),this.context.clear(ot.DEPTH_BUFFER_BIT)}},{key:"setClearColor",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._clearColor.setValues(e,t,n,i),this.context.clearColor(e,t,n,i)}},{key:"getClearColor",value:function(){return this._clearColor}},{key:"clear",value:function(){this.context.depthMask(!0),this.context.clear(ot.COLOR_BUFFER_BIT|ot.DEPTH_BUFFER_BIT),this.context.depthMask(this.renderState.getDepthMask())}},{key:"setRenderSize",value:function(e,t){this._renderWidth===e&&this._renderHeight===t||(this._renderWidth=e,this._renderHeight=t,this._renderSize.x=e,this._renderSize.y=t,this.context.viewport(0,0,this._renderWidth,this._renderHeight))}},{key:"setScissor",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e=Ve.clamp01(e),t=Ve.clamp01(t);var a=(n=Ve.clamp01(n))-e,s=(i=Ve.clamp01(i))-t,o=this._renderWidth,l=this._renderHeight;this.context.enable(ot.SCISSOR_TEST),this.context.scissor(e*o,t*l,a*o,s*l),r&&this.context.viewport(e*o,t*l,a*o,s*l)}},{key:"setScissorPixels",value:function(e,t,n,i){this.context.enable(ot.SCISSOR_TEST),this.context.scissor(e,t,n-e,i-t)}},{key:"unSetScissor",value:function(){this.context.disable(ot.SCISSOR_TEST)}},{key:"setViewPort",value:function(e,t,n,i){this._renderWidth=n,this._renderHeight=i,this.context.viewport(e,t,this._renderWidth,this._renderHeight)}},{key:"unsetViewPort",value:function(){this.context.viewport(0,0,this._canvas.width,this._canvas.height)}},{key:"setChannelMask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.context.colorMask(e,t,n,i)}},{key:"clearChannelMask",value:function(){this.context.colorMask(!0,!0,!0,!0)}},{key:"setStencilEnabled",value:function(e){e?this.context.enable(ot.STENCIL_TEST):this.context.disable(ot.STENCIL_TEST)}},{key:"startDrawToStencil",value:function(){var e=this.context;this.setStencilEnabled(!0),e.stencilFunc(ot.ALWAYS,1,255),e.stencilOp(ot.KEEP,ot.KEEP,ot.REPLACE),e.stencilMask(255)}},{key:"setStencilFuncEqual",value:function(e){this.context.stencilFunc(e?ot.EQUAL:ot.NOTEQUAL,1,255)}},{key:"destructVAO",value:function(e){}},{key:"destruct",value:function(){if(!this.isDestructed){et.log("Renderer: destruct");for(var e=this.context,n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),i=0;i<n;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null);e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.useProgram(null);var r=e.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._blitMesh&&this._blitMesh.destruct(),this._copyTextureMaterial&&this._copyTextureMaterial.destruct(),this._canvas.removeEventListener("resize",this.handleCanvasResize),this._mouseListener&&this._mouseListener.destruct(),ke()(K()(t.prototype),"destruct",this).call(this)}}}]),t}(Me);Mt._id=0,Mt.webgl2ContextName="webgl2",Mt.webgl1ContextName="experimental-webgl";var Pt=Mt,Ft=function(e){function t(e,n,i,r){var a,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return G()(this,t),(a=X()(this,K()(t).call(this,e,n,Pt.webgl1ContextName,i,r,s,o,l,u)))._vertexArrayObjects={},a}return Q()(t,e),W()(t,[{key:"init",value:function(){ke()(K()(t.prototype),"init",this).call(this)}},{key:"getRenderContext",value:function(){return this.context}},{key:"preprocessShaderString",value:function(e){return"#define WEBGL1\n"+e}},{key:"setDefaultUniforms",value:function(e){if(void 0===this._renderWidth||void 0===this._renderHeight)throw new Error("Cannot set default uniforms: render size not set");var t=this._renderWidth,n=this._renderHeight;e.setFloats("_ScreenParams",1/t,1/n,t/n,n/t),e.setFloat("_Time",tt.getInstance().time)}},{key:"initVAO",value:function(e,t){var n=this.extensionManager.vertex_array_object,i=n.createVertexArrayOES();return n.bindVertexArrayOES(i),this.setStates(e,t),n.bindVertexArrayOES(null),i}},{key:"setStates",value:function(e,t){var n=this.context;if(e.isInterleaved()){e.interleaveData(),n.bindBuffer(n.ARRAY_BUFFER,e.interleavedBuffer);for(var i=0,r=0;r<e.attributes.length;r++){var a=e.attributes[r],s=t.shader.getAttributeByName(a.name);s&&(n.enableVertexAttribArray(s.loc),n.vertexAttribPointer(s.loc,s.stride,n.FLOAT,!1,4*e.interleavedStrideSum,i)),i+=4*a.stride}}else for(var o=0;o<e.attributes.length;o++){var l=e.attributes[o],u=t.shader.getAttributeByName(l.name);if(u){if(void 0===l.buffer)throw new ReferenceError("Expected buffer to be defined on VertexAttribute when setting states.");n.bindBuffer(n.ARRAY_BUFFER,l.buffer),n.enableVertexAttribArray(u.loc),n.vertexAttribPointer(u.loc,u.stride,n.FLOAT,!1,4*u.stride,0)}}e.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer)}},{key:"destructVAO",value:function(e){var t=this.extensionManager.vertex_array_object;if(t){var n=this._vertexArrayObjects[e.id];for(var i in n){var r=n[i];t.deleteVertexArrayOES(r)}this._vertexArrayObjects[e.id]=[]}}},{key:"getVAO",value:function(e,t){var n,i=this._vertexArrayObjects[e.id];return i?(n=i[t.id])||(n=this.initVAO(e,t),i[t.id]=n):(i={},n=this.initVAO(e,t),i[t.id]=n,this._vertexArrayObjects[e.id]=i),n}},{key:"bindVAO",value:function(e){var t=this.extensionManager.vertex_array_object;e!=this._currentVAO&&(t.bindVertexArrayOES(e),this._currentVAO=e)}},{key:"drawVAO",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;n.setActive(),this.bindVAO(e),this.drawElements(t,n,i,r)}},{key:"draw",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(t.setActive(),!this.extensionManager.vertex_array_object||e.isDynamic)this.setStates(e,t),this.drawElements(e,t,n,i);else{var r=this.getVAO(e,t);this.bindVAO(r),this.drawElements(e,t,n,i)}}},{key:"startBatch",value:function(e,t){t.setActive(),this.extensionManager.vertex_array_object?this.extensionManager.vertex_array_object.bindVertexArrayOES(this.getVAO(e,t)):this.setStates(e,t)}},{key:"drawElements",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(e.indices){if(void 0===e.indexType)throw new ReferenceError("expected mesh.indexType to be set on a mesh with indices");i>0?this.context.drawElements(t.drawType,Math.min(i,e.indices.length),e.indexType,n*(e.indexType==ot.UNSIGNED_SHORT?2:4)):this.context.drawElements(t.drawType,e.indices.length,e.indexType,0)}else{var r=e.getNumVertices()-n;i>0?this.context.drawArrays(t.drawType,n,Math.min(r,i)):this.context.drawArrays(t.drawType,n,r)}}},{key:"endBatch",value:function(){this.extensionManager.vertex_array_object&&this.extensionManager.vertex_array_object.bindVertexArrayOES(null)}},{key:"destruct",value:function(){if(!this.isDestructed){et.log("RendererWebGL1: destruct");var e=this.extensionManager.vertex_array_object;if(e&&this._vertexArrayObjects)for(var n=0;n<this._vertexArrayObjects.length;n++)e.deleteVertexArrayOES(this._vertexArrayObjects[n]);ke()(K()(t.prototype),"destruct",this).call(this)}}}]),t}(Pt),Nt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;G()(this,e),this.q=De.c.create(),De.c.set(this.q,t,n,i,r)}return W()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return De.c.set(this.q,e.x,e.y,e.z,e.w),this}},{key:"setValues",value:function(e,t,n,i){return De.c.set(this.q,e,t,n,i),this}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"}},{key:"dot",value:function(e){return De.c.dot(this.q,e.q)}},{key:"identity",value:function(){return De.c.identity(this.q),this}},{key:"multiply",value:function(e){return De.c.multiply(this.q,this.q,e.q),this}},{key:"invert",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=this.w,this}},{key:"rotateX",value:function(e){return De.c.rotateX(this.q,this.q,e),this}},{key:"rotateY",value:function(e){return De.c.rotateY(this.q,this.q,e),this}},{key:"rotateZ",value:function(e){return De.c.rotateZ(this.q,this.q,e),this}},{key:"setAxisAngleRadians",value:function(e,t){return De.c.setAxisAngle(this.q,e.v,t),this}},{key:"rotateAxisAngleRadians",value:function(t,n){return De.c.setAxisAngle(e._tempQuat,t.v,n),De.c.multiply(this.q,e._tempQuat,this.q),this}},{key:"x",get:function(){return this.q[0]},set:function(e){this.q[0]=e}},{key:"y",get:function(){return this.q[1]},set:function(e){this.q[1]=e}},{key:"z",get:function(){return this.q[2]},set:function(e){this.q[2]=e}},{key:"w",get:function(){return this.q[3]},set:function(e){this.q[3]=e}}],[{key:"dot",value:function(e,t){return De.c.dot(e.q,t.q)}},{key:"multiply",value:function(e,t,n){return De.c.multiply(e.q,t.q,n.q),e}},{key:"invert",value:function(e,t){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=-t.w,e}},{key:"lerp",value:function(e,t,n,i){return De.c.lerp(e.q,t.q,n.q,i),e}},{key:"slerp",value:function(e,t,n,i){return De.c.slerp(e.q,t.q,n.q,i),e}},{key:"closestSlerp",value:function(t,n,i,r){return n.dot(i)<0?(e.invert(this.tInvB,i),e.slerp(t,n,this.tInvB,r)):e.slerp(t,n,i,r),t}},{key:"fromMat3",value:function(e,t){return De.c.fromMat3(e.q,t),e}},{key:"lookAt",value:function(t,n,i,r){e._tempForward.copy(n),e._tempForward.subtract(i),e._tempForward.normalize(),Le.cross(e._tempRight,r,e._tempForward),e._tempRight.normalize(),Le.cross(e._tempUp,e._tempForward,e._tempRight),e._tempUp.normalize();var a=De.a.fromValues(e._tempRight.x,e._tempRight.y,e._tempRight.z,e._tempUp.x,e._tempUp.y,e._tempUp.z,e._tempForward.x,e._tempForward.y,e._tempForward.z);return e.fromMat3(t,a),t}},{key:"CreateFromAxisAngle",value:function(e,t,n){var i=.5*n,r=Math.sin(i);e.setValues(t.x*r,t.y*r,t.z*r,Math.cos(i))}}]),e}();Nt.IDENTITY=new Nt,Nt._tempQuat=De.c.create(),Nt.tInvB=new Nt,Nt._tempForward=new Le,Nt._tempRight=new Le,Nt._tempUp=new Le;var Dt=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).call(this))).autoUpdate=!0,e._rotation=new Nt,e._pos=new Le,e._scale=new Le(1,1,1),e._parent=null,e._matrix=De.b.create(),e._localMatrix=De.b.create(),e._changeCallback=[],e._children=[],e._tempMat4=De.b.create(),e._tempMat3=De.a.create(),e._tempV3a=new Le,e._dirty=!0,e._signalDirtyDown=!1,e}return Q()(t,e),W()(t,[{key:"identity",value:function(){this._pos.setValues(0,0,0),this._rotation.identity(),this._scale.setValues(1,1,1)}},{key:"setParent",value:function(e){this._parent!==e&&(this._parent&&this._parent.removeChild(this),this._parent=e,e&&e.addChild(this),this.setDirty())}},{key:"getParent",value:function(){return this._parent}},{key:"addChild",value:function(e){this._children.indexOf(e)<0&&(this._children.push(e),e.setParent(this))}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);t>-1&&(this._children.splice(t,1),e.setParent(null))}},{key:"getChildren",value:function(){return this._children}},{key:"addChangeCallBack",value:function(e){this._changeCallback.push(e)}},{key:"setDirty",value:function(){this._dirty||(this._dirty=!0,this.signalDirtyDown())}},{key:"setParentDirty",value:function(){this.signalDirtyDown()}},{key:"signalDirtyDown",value:function(){if(!this._signalDirtyDown){this._signalDirtyDown=!0;for(var e=this._changeCallback.length-1;e>=0;e--)this._changeCallback[e].call(this);for(var t=this._children.length-1;t>=0;t--)this._children[t].setParentDirty()}}},{key:"clone",value:function(){var e=new t;return e.setScale(this._scale),e.setRotation(this._rotation),e.setPosition(this._pos),e}},{key:"updateMatrix",value:function(){(this._dirty||this._signalDirtyDown)&&(this.autoUpdate&&(this._dirty&&De.b.fromRotationTranslationScale(this._localMatrix,this._rotation.q,this._pos.v,this._scale.v),this._parent?De.b.multiply(this._matrix,this._parent.getWorldMatrix(),this._localMatrix):this._dirty&&De.b.copy(this._matrix,this._localMatrix)),this._dirty=!1,this._signalDirtyDown=!1)}},{key:"lookAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.UP;this.setPosition(e),this.lookAtFromCurrentPos(t,n)}},{key:"lookAtFromCurrentPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Le.UP;Nt.lookAt(this._rotation,this._pos,e,t),this.setDirty()}},{key:"setPositionRotationScale",value:function(e,t,n){this._pos.copy(e),this._rotation.copy(t),this._scale.copy(n),this.setDirty()}},{key:"getWorldMatrix",value:function(){return this.updateMatrix(),this._matrix}},{key:"getLocalMatrix",value:function(){return this.updateMatrix(),this._localMatrix}},{key:"getPosition",value:function(){return this._pos}},{key:"setPosition",value:function(e){this._pos.copy(e),this.setDirty()}},{key:"setPositionValues",value:function(e,t,n){this._pos.setValues(e,t,n),this.setDirty()}},{key:"getWorldPosition",value:function(){this.updateMatrix();var e=this._tempV3a;return e.copy(Le.ZERO),e.transform(this._matrix),e}},{key:"getScale",value:function(){return this._scale}},{key:"setScale",value:function(e){this._scale.copy(e),this.setDirty()}},{key:"setScaleScalar",value:function(e){this._scale.setValues(e,e,e),this.setDirty()}},{key:"setScaleValues",value:function(e,t,n){this._scale.setValues(e,t,n),this.setDirty()}},{key:"translateX",value:function(e){this._pos.x+=e,this.setDirty()}},{key:"translateY",value:function(e){this._pos.y+=e,this.setDirty()}},{key:"translateZ",value:function(e){this._pos.z+=e,this.setDirty()}},{key:"translate",value:function(e){this._pos.add(e),this.setDirty()}},{key:"translateValues",value:function(e,t,n){this._pos.x+=e,this._pos.y+=t,this._pos.z+=n,this.setDirty()}},{key:"getRotation",value:function(){return this._rotation}},{key:"setRotation",value:function(e){this._rotation.copy(e),this.setDirty()}},{key:"getRotationMatrix",value:function(){return De.b.fromQuat(this._tempMat4,this._rotation.q),this._tempMat4}},{key:"getRotationMatrixMat3",value:function(){return De.a.fromQuat(this._tempMat3,this._rotation.q),this._tempMat3}},{key:"getWorldRotationMatrixMat3",value:function(){var e=this.getRotationMatrixMat3();return this._parent&&De.a.multiply(e,this._parent.getWorldRotationMatrixMat3(),e),e}},{key:"setRotationFromMatrix",value:function(e){Nt.fromMat3(this._rotation,e),this.setDirty()}},{key:"rotateRadiansValues",value:function(e,t,n){return this._rotation.rotateY(t),this._rotation.rotateX(e),this._rotation.rotateZ(n),this.setDirty(),this._rotation}},{key:"rotateRadians",value:function(e){return this.rotateRadiansValues(e.x,e.y,e.z)}},{key:"rotateDegreesValues",value:function(e,n,i){return this.rotateRadiansValues(e*t._degToRad,n*t._degToRad,i*t._degToRad)}},{key:"rotateDegrees",value:function(e){return this.rotateDegreesValues(e.x,e.y,e.z)}},{key:"rotateAxisAngleRadians",value:function(e,t){return this._rotation.rotateAxisAngleRadians(e,t),this.setDirty(),this._rotation}},{key:"rotateDegreesY",value:function(e){this._rotation.rotateY(e*t._degToRad),this.setDirty()}},{key:"rotateRadiansX",value:function(e){this._rotation.rotateX(e),this.setDirty()}},{key:"rotateRadiansY",value:function(e){this._rotation.rotateY(e),this.setDirty()}},{key:"rotateRadiansZ",value:function(e){this._rotation.rotateZ(e),this.setDirty()}},{key:"setEulerDegreesValues",value:function(e,t,n){this._rotation.identity(),this.rotateDegreesValues(e,t,n)}},{key:"setEulerDegrees",value:function(e){this.setEulerDegreesValues(e.x,e.y,e.z)}},{key:"setEulerDegreesXY",value:function(e){this.setEulerDegreesValues(e.x,e.y,0)}},{key:"setEulerRadians",value:function(e){this._rotation.identity(),this.rotateRadiansValues(e.x,e.y,e.z)}},{key:"setRadiansX",value:function(e){this._rotation.identity(),this.rotateRadiansX(e)}},{key:"setRadiansY",value:function(e){this._rotation.identity(),this.rotateRadiansY(e)}},{key:"setRadiansZ",value:function(e){this._rotation.identity(),this.rotateRadiansZ(e)}},{key:"getEulerDegrees",value:function(){De.a.fromQuat(this._tempMat3,this._rotation.q);var e=t.getEulerRadiansYXZ(this._tempMat3);return e.x*=t._radToDeg,e.y*=t._radToDeg,e.z*=t._radToDeg,e}},{key:"getForward",value:function(){var e=this.getRotationMatrixMat3();return this._tempV3a.setValues(e[6],e[7],e[8]),this._tempV3a}},{key:"getWorldForward",value:function(){var e=this.getWorldRotationMatrixMat3();return this._tempV3a.setValues(e[6],e[7],e[8]),this._tempV3a}},{key:"getRight",value:function(){var e=this.getRotationMatrixMat3();return this._tempV3a.setValues(e[0],e[1],e[2]),this._tempV3a}},{key:"getUp",value:function(){var e=this.getRotationMatrixMat3();return this._tempV3a.setValues(e[3],e[4],e[5]),this._tempV3a}},{key:"setDirection",value:function(e,n){var i=this._tempV3a;Le.cross(i,n,e),i.normalize();var r=t._tempV3aS;Le.cross(r,e,i),r.normalize(),De.a.set(this._tempMat3,i.x,i.y,i.z,r.x,r.y,r.z,e.x,e.y,e.z),this.setRotationFromMatrix(this._tempMat3)}},{key:"getDirection",value:function(){var e=this._tempV3a;return e.copy(Le.FORWARD),e.transformMat3(this.getWorldRotationMatrixMat3()),e}},{key:"destruct",value:function(){ke()(K()(t.prototype),"destruct",this).call(this)}}],[{key:"getEulerRadiansYXZ",value:function(e){var n,i,r;return e[7]<-1+this.singularityRange?(n=Math.PI/2,i=Math.atan2(e[3],e[0]),r=0):e[7]>1-this.singularityRange?(n=-Math.PI/2,i=-Math.atan2(e[3],e[0]),r=0):(n=Math.asin(-e[7]),i=Math.atan2(e[6],e[8]),r=Math.atan2(e[1],e[4])),t._tempV3aS.setValues(n,i,r),t._tempV3aS}}]),t}(Me);Dt._degToRad=Math.PI/180,Dt._radToDeg=180/Math.PI,Dt._tempV3aS=new Le,Dt.singularityRange=1e-4;var Ot,Lt=Dt,Ut=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).apply(this,arguments))).transform=new Lt,e._worldViewProjection=De.b.create(),e}return Q()(t,e),W()(t,[{key:"draw",value:function(e,t){if(!this.material)throw new ReferenceError("cannot draw Model: material not defined");if(!this.mesh)throw new ReferenceError("cannot draw Model: mesh not defined");var n=t||this.material;if(!n)throw new ReferenceError("cannot draw Model: material not defined");n.hasUniform("_ModelViewProjection")&&(De.b.multiply(this._worldViewProjection,e.getViewProjection(),this.transform.getWorldMatrix()),n.setMatrix("_ModelViewProjection",this._worldViewProjection)),n.hasUniform("_Model")&&n.setMatrix("_Model",this.transform.getWorldMatrix()),n.setMatrix("_ViewProjection",e.getViewProjection()),this.mesh.renderer.draw(this.mesh,n)}},{key:"clone",value:function(){var e=new t;return e.mesh=this.mesh,e.material=this.material,e}}]),t}(Me),Bt=function(){function e(t,n,i){G()(this,e),this.loaded=!1,this.exportName=i||"default",this.importPromise=n,t.add(this)}return W()(e,[{key:"load",value:function(e){var t=this;this.importPromise.then(function(n){t.data_=n[t.exportName],t.loaded=!0,e.call(t)})}},{key:"data",get:function(){if(void 0===this.data_)throw new Error("data is being read from ImportLoader but it has not finished loading");return this.data_}}]),e}(),Vt=function(){function e(t,n,i,r){G()(this,e),this.type=Ot.NotSet,this.stride=-1,this._lowestAnimTime=999999,this._highestAnimTime=0,this.latestLowTime=-1,this.latestHighTime=-1,this.latestLowFrame=0,this.name=t,this.transformId=n,this.times=i,this.values=r;for(var a=0;a<i.length;++a)i[a]<this._lowestAnimTime?this._lowestAnimTime=i[a]:i[a]>this._highestAnimTime&&(this._highestAnimTime=i[a])}return W()(e,[{key:"applyTransform",value:function(e,t,n){console.error("applyTransform: this method should always be overloaded")}},{key:"getInterpolatedFrameValue",value:function(e,t){if(0!==this.times.length)if(1!==this.times.length)if(0!==t){var n=this.getFramePositions(t);if(void 0===this.tLowFrameValue||void 0===this.tHighFrameValue)throw new ReferenceError("expected tLowFrameValue and tHighFrame value to be defined");this.getFrameValue(this.tLowFrameValue,n.lowFrame),this.getFrameValue(this.tHighFrameValue,n.highFrame),this.interpolateValue(e,this.tLowFrameValue,this.tHighFrameValue,n.ratio)}else this.getFrameValue(e,0);else this.getFrameValue(e,0)}},{key:"interpolateValue",value:function(e,t,n,i){console.error("interpolateValue: this method should always be overloaded")}},{key:"getFrameValue",value:function(e,t){e instanceof Le?(e.x=this.values[3*t],e.y=this.values[3*t+1],e.z=this.values[3*t+2]):e instanceof Nt?(e.x=this.values[4*t],e.y=this.values[4*t+1],e.z=this.values[4*t+2],e.w=this.values[4*t+3]):e instanceof Float32Array&&(e[0]=this.values[t])}},{key:"scaleFrameTimesTo",value:function(e){for(var t=this.times[this.times.length-1],n=0;n<this.times.length;n++)this.times[n]*=e/t}},{key:"getTimes",value:function(){return this.times}},{key:"getFramePositions",value:function(e){var t,n;if(e<=this._lowestAnimTime)n=t=0;else if(e>=this._highestAnimTime)n=t=this.times.length-1;else if(e>this.latestLowTime&&e<this.latestHighTime)t=this.latestLowFrame%this.times.length,n=(this.latestLowFrame+1)%this.times.length;else for(var i=0;i<this.times.length;i++){t=(this.latestLowFrame+i)%this.times.length,n=(this.latestLowFrame+i+1)%this.times.length;var r=this.times[t],a=this.times[n];if(e>r&&e<a)break}if("undefined"===typeof t)throw new ReferenceError("expected lowFrameNumber to be defined. Length of KeyframeTrack.times is possibly 0");if("undefined"===typeof n)throw new ReferenceError("expected highFrameNumber to be defined. Length of KeyframeTrack.times is possibly 0");this.latestLowTime=this.times[t],this.latestHighTime=this.times[n],this.latestLowFrame=t;var s=0;return this.latestHighTime-this.latestLowTime!==0&&(s=(e-this.latestLowTime)/(this.latestHighTime-this.latestLowTime)),{lowFrame:t,highFrame:n,ratio:s}}}],[{key:"Float32ToArray",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}},{key:"serialize",value:function(t){return{name:t.name,transformId:t.transformId,times:e.Float32ToArray(t.times),values:e.Float32ToArray(t.values),type:e.getStringFromType(t.type)}}},{key:"deserialize",value:function(t){var n=t.name,i=t.transformId,r=t.times,a=t.values,s=e.getTypeFromString(t.type);switch(s){case Ot.Position:return new Ht(n,i,r,a);case Ot.Rotation:return new Gt(n,i,r,a);case Ot.Scale:return new zt(n,i,r,a);default:throw new Error("Unknown keyframe track type "+s)}}},{key:"getStringFromType",value:function(e){switch(e){case Ot.Position:return"Position";case Ot.Rotation:return"Rotation";case Ot.Scale:return"Scale";default:return"NotSet"}}},{key:"getTypeFromString",value:function(e){switch(e){case"Position":return Ot.Position;case"Rotation":return Ot.Rotation;case"Scale":return Ot.Scale;default:return Ot.NotSet}}}]),e}(),Ht=function(e){function t(e,n,i,r){var a;return G()(this,t),(a=X()(this,K()(t).call(this,e,n,i,r))).type=Ot.Position,a.stride=3,a.tCurrentValue=new Le,a.tLowFrameValue=new Le,a.tHighFrameValue=new Le,a}return Q()(t,e),W()(t,[{key:"applyTransform",value:function(e,t,n){this.getInterpolatedFrameValue(this.tCurrentValue,n),De.b.translate(e,e,this.tCurrentValue.v)}},{key:"interpolateValue",value:function(e,t,n,i){Le.lerp(e,t,n,i)}}]),t}(Vt),Gt=function(e){function t(e,n,i,r){var a;return G()(this,t),(a=X()(this,K()(t).call(this,e,n,i,r))).type=Ot.Rotation,a.stride=4,a.tCurrentValue=new Nt,a.tRotationTransform=De.b.create(),a.tLowFrameValue=new Nt,a.tHighFrameValue=new Nt,a}return Q()(t,e),W()(t,[{key:"applyTransform",value:function(e,t,n){this.getInterpolatedFrameValue(this.tCurrentValue,n),this.tCurrentValue.multiply(t),De.b.fromQuat(this.tRotationTransform,this.tCurrentValue.q),De.b.multiply(e,e,this.tRotationTransform)}},{key:"interpolateValue",value:function(e,t,n,i){Nt.slerp(e,t,n,i)}}]),t}(Vt),zt=function(e){function t(e,n,i,r){var a;return G()(this,t),(a=X()(this,K()(t).call(this,e,n,i,r))).type=Ot.Scale,a.stride=3,a.tCurrentValue=new Le,a.tLowFrameValue=new Le,a.tHighFrameValue=new Le,a}return Q()(t,e),W()(t,[{key:"applyTransform",value:function(e,t,n){this.getInterpolatedFrameValue(this.tCurrentValue,n),De.b.scale(e,e,this.tCurrentValue.v)}},{key:"interpolateValue",value:function(e,t,n,i){Le.lerp(e,t,n,i)}}]),t}(Vt);!function(e){e[e.Position=0]="Position",e[e.Rotation=1]="Rotation",e[e.Scale=2]="Scale",e[e.NotSet=3]="NotSet"}(Ot||(Ot={}));var Wt=Vt,jt=function(){function e(t,n,i){G()(this,e),this.duration=0,this.name="not set",this.animStartTime=0,this.animTimeOffset=0,this.prevAnimationSpeed=-1e3,this.duration=n,this.name=t,this.tracks=i}return W()(e,[{key:"jumpToTime",value:function(e,t){this.animTimeOffset=e,this.animStartTime=t}},{key:"getLoopingAnimationTime",value:function(e,t){var n=this;0===this.animStartTime&&(this.animStartTime=e);var i=function(e,t){return(n.animTimeOffset+(e-n.animStartTime)*t)%n.duration};return t!==this.prevAnimationSpeed&&(this.animTimeOffset=i(e,this.prevAnimationSpeed),this.animStartTime=e,this.prevAnimationSpeed=t),i(e,t)}}],[{key:"serialize",value:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var a,s=e.tracks[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t.push(Wt.serialize(o))}}catch(l){i=!0,r=l}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return{name:e.name,duration:e.duration,tracks:t}}},{key:"deserialize",value:function(t){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t.tracks[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=s.value;n.push(Wt.deserialize(l))}}catch(u){r=!0,a=u}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}return new e(t.name,t.duration,n)}}]),e}(),Xt=function(e){function t(e){var n;G()(this,t),(n=X()(this,K()(t).call(this))).renderer=e,n.renderer.textureCount++;var i=n.renderer.context;return n.textureGL=i.createTexture(),n}return Q()(t,e),W()(t,[{key:"bindToSlot",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"setTextureSize",value:function(e,t,n){}},{key:"destruct",value:function(){if(!this.isDestructed){var e=this.renderer.context;this.textureGL&&e.deleteTexture(this.textureGL)}ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),Yt=function(e){function t(e,n,i,r){var a,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return G()(this,t),(a=X()(this,K()(t).call(this,e,n,"webgl2",i,r,s,o,l)))._vertexArrayObjects={},a._vertexArrayObjects={},a}return Q()(t,e),W()(t,[{key:"init",value:function(){ke()(K()(t.prototype),"init",this).call(this)}},{key:"getRenderContext",value:function(){return this.context}},{key:"preprocessShaderString",value:function(e){var t=e.indexOf("#version"),n="";return t>-1&&(n=e.substr(t,e.indexOf("\n",t)-t)),e=n+"\n#define WEBGL2\n"+(e=e.replace(n,""))}},{key:"getVAO",value:function(e,t){var n=null,i=this._vertexArrayObjects[e.id];return i?(n=i[t.id])||(n=this.initVAO(e,t),i[t.id]=n):(i=[],n=this.initVAO(e,t),i[t.id]=n,this._vertexArrayObjects[e.id]=i),n}},{key:"initVAO",value:function(e,t){var n=this.getRenderContext(),i=n.createVertexArray();n.bindVertexArray(i);var r=0;e.isInterleaved()&&(e.interleaveData(),this.context.bindBuffer(this.context.ARRAY_BUFFER,e.interleavedBuffer));for(var a=0;a<e.attributes.length;a++){var s=e.attributes[a],o=t.shader.getAttributeByName(s.name);if(o){if(s.stride!==o.stride){et.log("Renderer: initVAO: strides don't match: ",s.stride,o.stride);continue}if(e.isInterleaved())n.enableVertexAttribArray(o.loc),n.vertexAttribPointer(o.loc,o.stride,n.FLOAT,!1,4*e.interleavedStrideSum,r);else{if(void 0===s.buffer)throw new ReferenceError("Expected buffer to be defined on VertexAttribute on non-interleaved mesh.");n.bindBuffer(n.ARRAY_BUFFER,s.buffer),n.enableVertexAttribArray(o.loc),n.vertexAttribPointer(o.loc,o.stride,n.FLOAT,!1,4*o.stride,0)}}e.interleaved&&(r+=4*s.stride)}return e.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer),i}},{key:"draw",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;t.setActive();var r=this.getVAO(e,t);this.context.bindVertexArray(r),this.drawElements(e,t,n,i)}},{key:"startBatch",value:function(e,t){t.setActive();var n=this.getVAO(e,t);this.getRenderContext().bindVertexArray(n)}},{key:"drawElements",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(e.hasIndices())this.context.drawElements(t.drawType,e.indices.length,e.indexType,0);else{var r=e.getNumVertices()-n;i>0?this.context.drawArrays(t.drawType,n,Math.min(r,i)):this.context.drawArrays(t.drawType,n,r)}}},{key:"drawInstanced",value:function(e,t,n,i){t.setActive();var r=this._vertexArrayObjects&&void 0!==this._vertexArrayObjects[e.id]&&void 0!==this._vertexArrayObjects[e.id][t.id],a=this.getVAO(e,t),s=this.getRenderContext();if(s.bindVertexArray(a),!r)for(var o=0;o<i.attributes.length;++o){var l=i.attributes[o];s.bindBuffer(s.ARRAY_BUFFER,l.buffer),s.enableVertexAttribArray(l.index),s.vertexAttribPointer(l.index,l.nrComponents,s.FLOAT,!1,l.bufferStride,l.bufferOffset),s.vertexAttribDivisor(l.index,1)}e.hasIndices()?s.drawElementsInstanced(t.drawType,e.indices.length,e.indexType,0,n):s.drawArraysInstanced(t.drawType,0,e.getNumVertices(),n)}},{key:"destruct",value:function(){if(!this.isDestructed){if(et.log("RendererWebGL2: destruct"),this._vertexArrayObjects)for(var e in this._vertexArrayObjects)for(var n=0;n<this._vertexArrayObjects[e].length;++n)this.getRenderContext().deleteVertexArray(this._vertexArrayObjects[e][n]);ke()(K()(t.prototype),"destruct",this).call(this)}}}]),t}(Pt),Kt=function(){function e(){G()(this,e)}return W()(e,null,[{key:"checkFloatCompatibility",value:function(t,n){if(!t.extensionManager.texture_float)if(t.extensionManager.texture_half_float){if(n===e.RGB_FLOAT)return e.RGB_HALF_FLOAT;if(n===e.RGBA_FLOAT)return e.RGBA_HALF_FLOAT}else console.log("Texture: setFormatType: not supported: ",n);return n}},{key:"checkHalfFloatCompatibility",value:function(t,n){if(!t.extensionManager.texture_half_float)if(t.extensionManager.texture_float){if(n===e.RGB_HALF_FLOAT)return e.RGB_FLOAT;if(n===e.RGBA_HALF_FLOAT)return e.RGBA_FLOAT}else console.log("Texture: setFormatType: not supported: ",n);return n}},{key:"validateFormatType",value:function(t,n){switch(n){case e.RGB_FLOAT:n=this.checkFloatCompatibility(t,n);case e.RGBA_FLOAT:n=this.checkFloatCompatibility(t,n);case e.RGBA_HALF_FLOAT:n=this.checkHalfFloatCompatibility(t,n);case e.RGB_HALF_FLOAT:n=this.checkHalfFloatCompatibility(t,n)}return n}},{key:"getFormat",value:function(t,n){switch(n){case e.RGBA_UNSIGNED_BYTE:return ot.RGBA;case e.RGB_UNSIGNED_BYTE:case e.RGB_FLOAT:return ot.RGB;case e.RGBA_FLOAT:case e.RGBA_HALF_FLOAT:return ot.RGBA;case e.RGB_HALF_FLOAT:return ot.RGB;case e.LUMINANCE_UNSIGNED_BYTE:return ot.LUMINANCE;case e.LUMINANCE_FLOAT:return t instanceof Yt?vt.RED:ot.LUMINANCE;case e.DEPTH_UINTSHORT:case e.DEPTH_FLOAT:return ot.DEPTH_COMPONENT;default:return et.error("can not yet get format for formatType: ",n),-1}}},{key:"getType",value:function(t,n){switch(n){case e.RGBA_UNSIGNED_BYTE:case e.RGB_UNSIGNED_BYTE:return ot.UNSIGNED_BYTE;case e.RGBA_FLOAT:case e.RGB_FLOAT:return ot.FLOAT;case e.RGBA_HALF_FLOAT:case e.RGB_HALF_FLOAT:return e.getHalfFloatType(t);case e.LUMINANCE_UNSIGNED_BYTE:return ot.UNSIGNED_BYTE;case e.LUMINANCE_FLOAT:return ot.FLOAT;case e.DEPTH_UINTSHORT:return ot.UNSIGNED_SHORT;case e.DEPTH_FLOAT:return ot.FLOAT;default:return et.error("can not yet get type for formatType: ",n),-1}}},{key:"getHalfFloatType",value:function(e){var t=e.extensionManager.texture_half_float;return t?t.HALF_FLOAT_OES:-1}},{key:"getInternalFormat",value:function(t){switch(t){case e.RGBA_UNSIGNED_BYTE:return vt.RGBA8;case e.RGB_UNSIGNED_BYTE:return vt.RGB8;case e.RGBA_FLOAT:return vt.RGBA32F;case e.RGB_FLOAT:return vt.RGB32F;case e.RGBA_HALF_FLOAT:return vt.RGBA16F;case e.RGB_HALF_FLOAT:return vt.RGB16F;case e.LUMINANCE_UNSIGNED_BYTE:return vt.R8;case e.LUMINANCE_FLOAT:return vt.R32F;case e.DEPTH_UINTSHORT:return vt.DEPTH_COMPONENT24;case e.DEPTH_FLOAT:return vt.DEPTH_COMPONENT32F;default:return et.error("can not yet get type for formatType: ",t),-1}}}]),e}();Kt.ALPHA_UNSIGNED_BYTE="ALPHA UNSIGNED_BYTE",Kt.ALPHA_FLOAT="ALPHA FLOAT",Kt.RGBA_UNSIGNED_BYTE="RGBA UNSIGNED_BYTE",Kt.RGBA_FLOAT="RGBA FLOAT",Kt.RGBA_HALF_FLOAT="RGBA HALF_FLOAT",Kt.RGB_HALF_FLOAT="RGB HALF_FLOAT",Kt.RGB_UNSIGNED_BYTE="RGB UNSIGNED_BYTE",Kt.RGB_FLOAT="RGB_FLOAT",Kt.LUMINANCE_UNSIGNED_BYTE="LUMINANCE UNSIGNED_BYTE",Kt.LUMINANCE_FLOAT="LUMINANCE FLOAT",Kt.DEPTH_UINTSHORT="DEPTH_UINTSHORT",Kt.DEPTH_FLOAT="DEPTH_FLOAT";var $t=n(17),Qt=n.n($t),Jt=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kt.RGBA_UNSIGNED_BYTE,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(G()(this,t),(n=X()(this,K()(t).call(this,e))).name="unnamed",n.width=-1,n.height=-1,n.internalFormat=-1,n.filterLinearEnabled=!0,n.useMips=!1,n._mipsCreated=!1,n.wrapModeClamp=!0,e instanceof Ft)n.formatType=Kt.validateFormatType(e,i);else{if(!(e instanceof Yt))throw new Error("Could not determine type of renderer");n.formatType=i,n.internalFormat=Kt.getInternalFormat(i)}return n._format=Kt.getFormat(n.renderer,n.formatType),n._type=Kt.getType(n.renderer,n.formatType),n.useMips=r,a?n.setFilteringLinear():n.setFilteringNearest(),n.setWrapModeClamp(s),n}return Q()(t,e),W()(t,[{key:"bindToSlot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.renderer.renderState.bindTextureToSlot(this.textureGL,e)}},{key:"bind",value:function(){this.renderer.context.activeTexture(ot.TEXTURE0+this.renderer.maxParams.MAX_TEXTURE_IMAGE_UNITS-1),this.renderer.context.bindTexture(ot.TEXTURE_2D,this.textureGL)}},{key:"setTextureSize",value:function(e,t){if(e!==this.width||t!==this.height){if(this.width=e,this.height=t,this.bind(),this.renderer instanceof Ft){var n=this.renderer.context;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0),n.texImage2D(ot.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,null)}else if(this.renderer instanceof Yt){var i=this.renderer.context;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,0),i.texImage2D(ot.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null)}et.log("expensive operation: setTextureSize: ",e,t,"format: ",this.format)}}},{key:"setFilteringLinear",value:function(){this.setFiltering(!0)}},{key:"setFilteringNearest",value:function(){this.setFiltering(!1)}},{key:"setFiltering",value:function(e){this.filterLinearEnabled=e;var t,n=this.renderer.context;this.bind(),t=this._mipsCreated?e?ot.LINEAR_MIPMAP_LINEAR:ot.NEAREST_MIPMAP_LINEAR:e?ot.LINEAR:ot.NEAREST,n.texParameteri(ot.TEXTURE_2D,ot.TEXTURE_MAG_FILTER,e?ot.LINEAR:ot.NEAREST),n.texParameteri(ot.TEXTURE_2D,ot.TEXTURE_MIN_FILTER,t)}},{key:"setFilterAnisotropic",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;if(this.setFilteringLinear(),this.renderer.extensionManager.filter_anisotropic){var t=this.renderer.context;e=Math.min(this.renderer.extensionManager.maxAnisotropy,e),t.texParameterf(t.TEXTURE_2D,this.renderer.extensionManager.filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e)}}},{key:"setWrapModeClamp",value:function(e){this.wrapModeClamp=e;var t=this.renderer.context;this.bind();var n=e?ot.CLAMP_TO_EDGE:ot.REPEAT;t.texParameteri(ot.TEXTURE_2D,ot.TEXTURE_WRAP_S,n),t.texParameteri(ot.TEXTURE_2D,ot.TEXTURE_WRAP_T,n)}},{key:"setWrapModeClampHorizontal",value:function(e){this.setWrapModeClampForDirection(e,ot.TEXTURE_WRAP_S)}},{key:"setWrapModeClampVertical",value:function(e){this.setWrapModeClampForDirection(e,ot.TEXTURE_WRAP_T)}},{key:"setWrapModeClampForDirection",value:function(e,t){var n=this.renderer.context;this.bind();var i=e?ot.CLAMP_TO_EDGE:ot.REPEAT;n.texParameteri(ot.TEXTURE_2D,t,i)}},{key:"generateMips",value:function(){if(t.isPOT(this.width,this.height)){var e=this.renderer.context;this.bind(),e.generateMipmap(e.TEXTURE_2D),this.useMips=!0,this._mipsCreated=!0,this.filterLinearEnabled?this.setFilteringLinear():this.setFilteringNearest()}else et.error("can't generate mips: npot: ",this.width,this.height)}},{key:"disableMips",value:function(){this.useMips=!1,this._mipsCreated=!1,this.filterLinearEnabled?this.setFilteringLinear():this.setFilteringNearest()}},{key:"setData",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.renderer.context;if(this.bind(),r.pixelStorei(ot.UNPACK_ALIGNMENT,1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,i?1:0),r.pixelStorei(ot.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot.NONE),this.renderer instanceof Ft)r.texImage2D(ot.TEXTURE_2D,0,this.format,t,n,0,this.format,this.type,e);else if(this.renderer instanceof Yt){this.renderer.context.texImage2D(ot.TEXTURE_2D,0,this.internalFormat,t,n,0,this.format,this.type,e)}this.width=t,this.height=n}},{key:"getData",value:function(e){var n,i=this.renderer.context;switch(e||(e=t.getFramebuffer(this.renderer)),i.bindFramebuffer(ot.FRAMEBUFFER,e),i.framebufferTexture2D(ot.FRAMEBUFFER,ot.COLOR_ATTACHMENT0,ot.TEXTURE_2D,this.textureGL,0),this.formatType){case Kt.RGBA_FLOAT:n=new Float32Array(this.width*this.height*4);break;case Kt.RGB_FLOAT:n=new Float32Array(this.width*this.height*3);break;case Kt.RGBA_UNSIGNED_BYTE:n=new Uint8Array(this.width*this.height*4);break;case Kt.RGB_UNSIGNED_BYTE:n=new Uint8Array(this.width*this.height*3);break;case Kt.LUMINANCE_UNSIGNED_BYTE:n=new Uint8Array(this.width*this.height);break;default:throw new Error("can not yet get data for format type: "+this.formatType)}return i.readPixels(0,0,this.width,this.height,this.format,this.type,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}},{key:"getPixel",value:function(e,n){var i=this.renderer.context,r=t.getFramebuffer(this.renderer);i.bindFramebuffer(ot.FRAMEBUFFER,r),i.framebufferTexture2D(ot.FRAMEBUFFER,ot.COLOR_ATTACHMENT0,ot.TEXTURE_2D,this.textureGL,0);var a=new Uint8Array(4);return i.readPixels(e,n,1,1,ot.RGBA,ot.UNSIGNED_BYTE,a),i.bindFramebuffer(i.FRAMEBUFFER,null),a}},{key:"getAspect",value:function(){return this.width/this.height}},{key:"setImage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.image=e;if(!this.isDestructed){var n=this.renderer.context;this.bind(),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t?1:0),Qt.a.msedge||n.pixelStorei(ot.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot.NONE),n.pixelStorei(ot.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),n.texImage2D(ot.TEXTURE_2D,0,this.format,this.format,this.type,e),e instanceof HTMLVideoElement?(this.width=e.videoWidth,this.height=e.videoHeight):(this.width=e.width,this.height=e.height),0===(this.width&this.width-1)&&0===(this.height&this.height-1)?this.useMips&&this.generateMips():(this.wrapModeClamp||console.error("Trying to wrap non-power of two texture. These can only be clamped!"),this.setWrapModeClamp(!0)),t&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,0)}}},{key:"getImage",value:function(){return this.image}},{key:"destruct",value:function(){t._framebuffers[this.renderer.id]&&(this.renderer.context.deleteFramebuffer(t._framebuffers[this.renderer.id]),t._framebuffers[this.renderer.id]=null);ke()(K()(t.prototype),"destruct",this).call(this)}},{key:"format",get:function(){return this._format}},{key:"type",get:function(){return this._type}}],[{key:"isPOT",value:function(e,t){return 0===(e&e-1)&&0===(t&t-1)}},{key:"getFramebuffer",value:function(e){if(!t._framebuffers[e.id]){var n=e.context;t._framebuffers[e.id]=n.createFramebuffer()}return t._framebuffers[e.id]}}]),t}(Xt);Jt._framebuffers={};var Zt=Jt,qt=function(){function e(){G()(this,e),this.position=new Le,this.rotation=new Nt,this.scale=new Le(1,1,1),this.inverseBindpose=De.b.create(),this.bindTransform=new Lt,this.bindPosition=new Le,this.bindRotation=new Nt,this.bindScale=new Le(1,1,1)}return W()(e,[{key:"identity",value:function(){this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.identity(),this.scale.x=1,this.scale.y=1,this.scale.z=1}}]),e}(),en=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];G()(this,e),this.bones=[],this.transforms=[],this._useTexture=!0,this.tPosition=new Le,this.tRotation=new Nt,this.tScale=new Le(1,1,1),this.boneTransformMap={},this.transformMap={},this.bonesMap={},this.tempMat4=De.b.create(),this.rootInverseMat4=De.b.create(),null===i&&(i=n),this._renderer=t,this._useTexture=r,this.bones=n,this.transforms=i;var a=!0,s=!1,o=void 0;try{for(var l,u=i[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var h=l.value;if(void 0===h.id)throw new ReferenceError("expected transform to have an id");this.transformMap[h.id]=h}}catch(w){s=!0,o=w}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}var c=!0,d=!1,f=void 0;try{for(var _,p=n[Symbol.iterator]();!(c=(_=p.next()).done);c=!0){var v=_.value;this.bonesMap[v.id]=v}}catch(w){d=!0,f=w}finally{try{c||null==p.return||p.return()}finally{if(d)throw f}}this.initBoneStorageData(n.length),this.updateBoneStorageData(n),this.bones[0]&&this.bones[0].getParent()&&(this.rootTransform=this.bones[0].getParent()),this.rootTransform?De.b.invert(this.rootInverseMat4,this.rootTransform.getWorldMatrix()):De.b.identity(this.rootInverseMat4);var m=!0,g=!1,A=void 0;try{for(var y,E=n[Symbol.iterator]();!(m=(y=E.next()).done);m=!0){var T=y.value,C=this.getCachedBoneTransform(T.id);De.b.copy(this.tempMat4,T.getWorldMatrix()),De.b.multiply(this.tempMat4,this.rootInverseMat4,this.tempMat4),De.b.invert(C.inverseBindpose,this.tempMat4)}}catch(w){g=!0,A=w}finally{try{m||null==E.return||E.return()}finally{if(g)throw A}}}return W()(e,[{key:"setRootTransform",value:function(e){this.rootTransform=e}},{key:"initBoneStorageData",value:function(e){if(this._useTexture){var t=Math.sqrt(4*e);t=this.nextPowerOfTwo(Math.ceil(t)),t=Math.max(t,4),this.boneMatrices=new Float32Array(t*t*4),this.boneTexture=new Zt(this._renderer,Kt.RGBA_FLOAT,!1,!1,!0),this.boneTexture.setData(this.boneMatrices,t,t)}else this.boneMatrices=new Float32Array(16*e)}},{key:"updateBoneStorageData",value:function(e){if(0!==e.length){this.rootTransform?De.b.invert(this.rootInverseMat4,this.rootTransform.getWorldMatrix()):De.b.identity(this.rootInverseMat4);var t=0,n=!0,i=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(void 0===o.id)throw new ReferenceError("expected all transforms to have an id");De.b.multiply(this.tempMat4,o.getWorldMatrix(),this.getCachedBoneTransform(o.id).inverseBindpose),De.b.multiply(this.tempMat4,this.rootInverseMat4,this.tempMat4);for(var l=16*t,u=l;u<l+16;u++)this.boneMatrices[u]=this.tempMat4[u-l];t++}}catch(c){i=!0,r=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}if(this._useTexture){var h=this.boneTexture;h.setData(this.boneMatrices,h.width,h.height)}}}},{key:"applyAnimations",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[],i=e.length-1;i>=0;i--){var r=e[i];if(n.push(r),r.weight>=1)break}n.reverse();for(var a=0;a<n.length;a++){var s=n[a],o=s.weight,l=s.clip,u=s.time;if(o>0){var h=!0,c=!1,d=void 0;try{for(var f,_=l.tracks[Symbol.iterator]();!(h=(f=_.next()).done);h=!0){var p=f.value,v=this.getCachedBoneTransform(p.transformId),m=this.transformMap[p.transformId];if(void 0===m.id)throw new ReferenceError("expected transform to have an id");if(!t||t.indexOf(m.id)>=0)if(o<1)switch(p.type){case Ot.Position:p.getInterpolatedFrameValue(this.tPosition,u),Le.lerp(v.position,v.position,this.tPosition,o),m.setPosition(v.position);break;case Ot.Rotation:p.getInterpolatedFrameValue(this.tRotation,u),Nt.slerp(v.rotation,v.rotation,this.tRotation,o),m.setRotation(v.rotation);break;case Ot.Scale:p.getInterpolatedFrameValue(this.tScale,u),Le.lerp(v.scale,v.scale,this.tScale,o),m.setScale(v.scale)}else switch(p.type){case Ot.Position:p.getInterpolatedFrameValue(v.position,u),m.setPosition(v.position);break;case Ot.Rotation:p.getInterpolatedFrameValue(v.rotation,u),m.setRotation(v.rotation);break;case Ot.Scale:p.getInterpolatedFrameValue(v.scale,u),m.setScale(v.scale)}}}catch(g){c=!0,d=g}finally{try{h||null==_.return||_.return()}finally{if(c)throw d}}}}this.updateBoneStorageData(this.bones)}},{key:"getCachedBoneTransform",value:function(e){var t=this.boneTransformMap[e];if(t)return t;var n=this.transformMap[e];return(t=new qt).position.copy(n.getPosition()),t.scale.copy(n.getScale()),t.rotation.copy(n.getRotation()),t.bindPosition.copy(n.getPosition()),t.bindScale.copy(n.getScale()),t.bindRotation.copy(n.getRotation()),t.bindTransform.setPositionRotationScale(n.getPosition(),n.getRotation(),n.getScale()),this.boneTransformMap[e]=t,t}},{key:"setTransform",value:function(e,t){e.setPositionRotationScale(t.position,t.rotation,t.scale)}},{key:"nextPowerOfTwo",value:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}}]),e}(),tn=function(){function e(t,n,i){var r=this;G()(this,e),this._useTextureToStoreBones=!1,this._models=[],this._transforms={},this._meshes={},this._boneAnimators={},this._animations={},this._currentAnimationIndex={},this._currentAnimationTime={},this._rootTransform=new Lt,this._renderer=t,i&&(this._jsonLoader=new Bt(n,i),n.setCallbackForPreloadable(this._jsonLoader,function(){r.parseJson()}))}return W()(e,[{key:"filter",value:function(t){var n,i=new e(this._renderer,void 0,!1);for(var r in this._transforms)if(this._transforms[r].name===t){n=this._transforms[r];break}if(n){var a={},s=[],o={};a[""+n.id]=n;var l=[n];do{var u=l.pop().getChildren();for(var h in u){var c=u[h];l.push(c),a[""+c.id]=c}}while(l.length>0);for(var d in this._models){var f=this._models[d];a[""+f.transform.id]&&(s.push(f),o[""+f.mesh.id]=f.mesh)}i.setData(n,a,s,o)}return i}},{key:"setData",value:function(e,t,n,i){this._rootTransform=e,this._transforms=t,this._models=n,this._meshes=i}},{key:"getRootTransform",value:function(){return this._rootTransform}},{key:"getTransforms",value:function(){return this._transforms}},{key:"getModels",value:function(){return this._models}},{key:"parseJson",value:function(){var e=this._jsonLoader.data;if(!e)throw new Error("Cannot parse json: json data not loaded");for(var t=[],n=0;n<e.transforms.length;n++){var i=e.transforms[n],r=new Lt;r.setPositionRotationScale(new Le(i.position[0],i.position[1],i.position[2]),new Nt(i.rotation[0],i.rotation[1],i.rotation[2],i.rotation[3]),new Le(i.scale[0],i.scale[1],i.scale[2])),r.name=i.name,r.id=i.id,this._transforms[i.parentId]?r.setParent(this._transforms[i.parentId]):this._rootTransform=r,this._transforms[i.id]=r,t.push(r)}for(n=0;n<e.animations.length;n++){for(var a=e.animations[n],s=[],o=0;o<a.clips.length;o++)s.push(jt.deserialize(a.clips[o]));var l=[];for(o=0;o<a.bones.length;o++)l.push(this._transforms[a.bones[o].transformId]);this._boneAnimators[a.id]=new en(this._renderer,l,t,this._useTextureToStoreBones),this._animations[a.id]=s,this._currentAnimationIndex[a.id]=0,this._currentAnimationTime[a.id]=0}for(n=0;n<e.objects.length;n++){var u=e.objects[n],h=new Ut;null!=this._transforms[u.transformId]&&(h.transform=this._transforms[u.transformId]);var c=u.instanceId;if(this._meshes[c])h.mesh=this._meshes[c];else{h.mesh=new It(this._renderer),h.mesh.animatorId=u.animatorId,u.indices.length>0&&h.mesh.setIndices(new Uint16Array(u.indices));for(o=0;o<u.attributes.length;o++){var d=u.attributes[o];h.mesh.setAttribute(d.name,d.stride,new Float32Array(d.data))}this._meshes[c]=h.mesh}this._models.push(h)}}}]),e}(),nn=function(e){function t(e,n,i,r){var a;return G()(this,t),(a=X()(this,K()(t).call(this,e,n,i)))._megaTexture=r,a}return Q()(t,e),W()(t,[{key:"init",value:function(){}},{key:"setMaterialUniforms",value:function(e,t){e.setMatrix("_ViewProjection",t.getViewProjection())}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t||this._megaTexture.getMaterial();this.setMaterialUniforms(n,e);for(var i=0;i<this._models.length;i++){var r=this._models[i].mesh;n.setMatrix("_Model",this._models[i].transform.getWorldMatrix()),this._renderer.draw(r,n)}}}]),t}(tn),rn=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return G()(this,t),n=X()(this,K()(t).call(this,e)),i?n.positionsOnly(r):n.createWithNormalsAndUV(r),n}return Q()(t,e),W()(t,[{key:"positionsOnly",value:function(e){var t=new Float32Array([1,1,1,-1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1]);this.setPositions(t,e);var n=new Uint16Array([0,3,2,0,1,3,5,6,7,5,4,6,1,7,3,1,5,7,4,2,6,4,0,2,0,5,1,0,4,5,6,3,7,6,2,3]);this.setIndices(n)}},{key:"createWithNormalsAndUV",value:function(e){var t=new Float32Array([-1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,1,-1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,1,1,1,1,-1,1]);this.setPositions(t,e);for(var n=new Float32Array(48),i=0,r=0;r<6;r++)n[i++]=0,n[i++]=0,n[i++]=1,n[i++]=0,n[i++]=1,n[i++]=1,n[i++]=0,n[i++]=1;this.setUV0(n,e);for(var a=new Float32Array(72),s=0,o=0;o<4;o++)a[s++]=-1,a[s++]=0,a[s++]=0;for(var l=0;l<4;l++)a[s++]=1,a[s++]=0,a[s++]=0;for(var u=0;u<4;u++)a[s++]=0,a[s++]=-1,a[s++]=0;for(var h=0;h<4;h++)a[s++]=0,a[s++]=1,a[s++]=0;for(var c=0;c<4;c++)a[s++]=0,a[s++]=0,a[s++]=-1;for(var d=0;d<4;d++)a[s++]=0,a[s++]=0,a[s++]=1;this.setNormals(a,e);for(var f=new Uint16Array(36),_=0,p=0;p<6;p++){var v=4*p;f[_++]=v+0,f[_++]=v+2,f[_++]=v+1,f[_++]=v+2,f[_++]=v+0,f[_++]=v+3}this.setIndices(f)}}]),t}(It),an=function(){function e(){G()(this,e)}return W()(e,null,[{key:"toVector3Array",value:function(e){for(var t=e.length/3,n=[],i=0,r=0;r<t;r++)n.push(new Le(e[i++],e[i++],e[i++]));return n}},{key:"toFloat32Array",value:function(e){for(var t=e.length,n=new Float32Array(3*t),i=0,r=0;r<t;r++)n[i++]=e[r].x,n[i++]=e[r].y,n[i++]=e[r].z;return n}},{key:"toFloat32ArrayVec4",value:function(e){for(var t=e.length,n=new Float32Array(4*t),i=0,r=0;r<t;r++)n[i++]=e[r].x,n[i++]=e[r].y,n[i++]=e[r].z,n[i++]=e[r].w;return n}},{key:"toFloat32ArrayVec2",value:function(e){for(var t=e.length,n=new Float32Array(2*t),i=0,r=0;r<t;r++)n[i++]=e[r].x,n[i++]=e[r].y;return n}},{key:"toVector2Array",value:function(e){for(var t=e.length/2,n=[],i=0,r=0;r<t;r++)n.push(new Je(e[i++],e[i++]));return n}},{key:"getLocalDimensions",value:function(e){var t=new Le(0,0,0),n=e.getData("aPos");if(!n)throw new ReferenceError("Could not get local dimensions: mesh data not found");for(var i=0;i<3*e.getNumVertices();i+=3)Math.abs(n[i])>t.x&&(t.x=Math.abs(n[i])),Math.abs(n[i+1])>t.y&&(t.y=Math.abs(n[i+1])),Math.abs(n[i+2])>t.z&&(t.z=Math.abs(n[i+2]));return t}},{key:"makeIndexed",value:function(t){et.log("makeIndexed ",t.attributes);for(var n=t.getNumVertices(),i=0,r=0;r<t.attributes.length;r++)i+=t.attributes[r].stride;var a=0,s=t.getNumVertices(),o=new Float32Array(i*s),l=[],u=new Float32Array(i);for(r=0;r<s;r++){for(var h=0,c=0;c<t.attributes.length;c++)for(var d=t.attributes[c],f=0;f<d.stride;f++)u[h++]=d.data[r*d.stride+f];var _=e.getIndexOfSubBuffer(o,u,a/i);if(_>=0)l[r]=_;else{l[r]=a/i;for(f=0;f<i;f++)o[a++]=u[f]}}(s=a/i)<Math.pow(2,16)?t.setIndices(new Uint16Array(l)):t.setIndices32(new Uint32Array(l)),o=new Float32Array(o.buffer,0,a);var p=[];for(a=0,r=0;r<t.attributes.length;r++)p[r]=new Float32Array(s*t.attributes[r].stride);for(r=0;r<s;r++)for(c=0;c<t.attributes.length;c++){var v=t.attributes[c].stride;for(f=0;f<v;f++)p[c][r*v+f]=o[a++]}for(r=0;r<t.attributes.length;r++)t.setAttribute(t.attributes[r].name,t.attributes[r].stride,p[r],!0);et.log("generated indices, reduced amount of vertices from "+n+" to "+s)}},{key:"getIndexOfSubBuffer",value:function(e,t,n){for(var i=t.length,r=0;r<n;r++){for(var a=!0,s=0;s<i;s++)t[s]!=e[i*r+s]&&(a=!1,s=1e3);if(a)return r}return-1}},{key:"addTangents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.getUV0(),i=e.getNormals(),r=e.getPositions(),a=e.indices;if(null==n)return!1;if(null==r)return!1;if(null==a)return!1;if(null==i)return!1;var s=r.length/3,o=new Float32Array(4*s),l=new Float32Array(3*s),u=new Float32Array(3*s),h=new Float32Array(3),c=new Float32Array(3);function d(e,t,i){if(null!=r&&null!=n){var a=r[3*t]-r[3*e],s=r[3*i]-r[3*e],o=r[3*t+1]-r[3*e+1],d=r[3*i+1]-r[3*e+1],f=r[3*t+2]-r[3*e+2],_=r[3*i+2]-r[3*e+2],p=n[2*t]-n[2*e],v=n[2*i]-n[2*e],m=n[2*t+1]-n[2*e+1],g=n[2*i+1]-n[2*e+1],A=1/(p*g-v*m);!isNaN(A)&&A&&isFinite(A)||(0,A=1),h[0]=(g*a-m*s)*A,h[1]=(g*o-m*d)*A,h[2]=(g*f-m*_)*A,c[0]=(p*s-v*a)*A,c[1]=(p*d-v*o)*A,c[2]=(p*_-v*f)*A;for(var y=0;y<3;++y)l[3*e+y]+=h[y],l[3*t+y]+=h[y],l[3*i+y]+=h[y],u[3*e+y]+=c[y],u[3*t+y]+=c[y],u[3*i+y]+=c[y]}}for(var f=a.length,_=0;_<f;_+=3)d(a[_],a[_+1],a[_+2]);var p,v,m=new Le,g=new Le,A=new Le,y=new Le,E=new Le,T=new Le;function C(e){if(null!=i){A.setValues(i[3*e],i[3*e+1],i[3*e+2]),y.copy(A),E.setValues(l[3*e],l[3*e+1],l[3*e+2]),m.copy(E),isNaN(m.x)&&(0,m.setValues(1,0,0));var t=Le.dot(A,E);A.multiplyScalar(t),Le.subtract(m,m,A);var n=m.length();0==n?(m.setValues(1,0,0),0):m.multiplyScalar(1/n),isNaN(m.x)&&(m.setValues(1,0,0),0),Le.cross(g,y,E),T.setValues(u[3*e],u[3*e+1],u[3*e+2]),v=Le.dot(g,T),p=v<0?1:-1,o[4*e]=m.x,o[4*e+1]=m.y,o[4*e+2]=m.z,o[4*e+3]=p}}for(var w=0;w<f;w+=3)C(a[w+0]),C(a[w+1]),C(a[w+2]);return e.setAttribute(Rt.TANGENT.name,Rt.TANGENT.stride,o,t),!0}},{key:"generateNormals",value:function(t){var n=t.getPositions();if(!n)throw new ReferenceError("MeshUtils.generateNormals: failed getting positions data on "+t.name);var i=e.toVector3Array(n),r=e.toVector3Array(new Float32Array(n.length)),a=t.indices;if(!a)throw new ReferenceError("Cannot generate normals: expected indices to be defined on mesh");for(var s=r.length,o=a.length/3,l=0;l<o;l++){var u=a[3*l+0],h=a[3*l+1],c=a[3*l+2],d=i[u],f=i[h],_=i[c],p=Le.cross(new Le,f.clone().subtract(d).normalize(),_.clone().subtract(d).normalize()).normalize();r[u].add(p),r[h].add(p),r[c].add(p)}for(l=0;l<s;l++)r[l].normalize();t.setNormals(e.toFloat32Array(r))}},{key:"getElementCenter",value:function(e){var t=e.getPositions(),n=e.getNumVertices(),i=new Le;if(null===t)throw new ReferenceError("Cannot get element center: positions not defined on mesh");for(var r=0;r<n;r++)i.x+=t[3*r],i.y+=t[3*r+1],i.z+=t[3*r+2];return i.multiplyScalar(1/n),i}},{key:"getBoundingBox",value:function(e,t){var n=e.getPositions(),i=e.getNumVertices(),r=new Le(0,0,0);if(null===n)throw new ReferenceError("Cannot get element center: positions not defined on mesh");for(var a=0;a<i;a++)r.x=Math.max(r.x,Math.abs(n[3*a]-t.x)),r.y=Math.max(r.x,Math.abs(n[3*a+1]-t.y)),r.z=Math.max(r.x,Math.abs(n[3*a+2]-t.z));return r}},{key:"getMergedMesh",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new It(e[0].renderer),i=[],r=!!e[0].indices,a=[],s=e[0],o=0;o<s.attributes.length;o++)i[o]=[];for(var l=[],u=0,h=0;h<e.length;h++){s=e[h];for(var c=0;c<s.attributes.length;c++)for(var d=s.attributes[c].data,f=d.length,_=0;_<f;_++)i[c].push(d[_]);if(r){for(var p=s.indices.length,v=0;v<p;v++)a.push(s.indices[v]+u);u+=s.getNumVertices()}if(t)for(var m=s.getNumVertices(),g=0;g<m;g++)l.push(h)}t&&n.setAttribute("aIndex",1,new Float32Array(l)),s=e[0];for(var A=0;A<s.attributes.length;A++)n.setAttribute(s.attributes[A].name,s.attributes[A].stride,new Float32Array(i[A]));return r&&n.setIndices(new Uint16Array(a)),et.log("getMergedMesh: vertexCount",n.getNumVertices()),n}},{key:"getMergedTransformedMesh",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new It(t[0].renderer),a=[],s=t.length,o=e.getMergedIndices(t);o&&r.setIndices(o),r.setAttribute("aIndex",1,e.getIdList(t,i));for(var l=t[0],u=[],h=0,c=0;c<s;c++)h+=t[c].getNumVertices();for(var d=0;d<l.attributes.length;d++)u[d]=0,a[d]=new Float32Array(h*l.attributes[d].stride);for(var f=De.e.create(),_=0,p=t[0].attributes.length,v=0;v<s;v++){l=t[v];for(var m=n[v].getLocalMatrix(),g=0;g<p;g++){var A=l.attributes[g].data;if(l.attributes[g].name==Rt.POSITION.name){for(var y=A.length/3,E=0;E<y;E++)f[0]=A[3*E+0],f[1]=A[3*E+1],f[2]=A[3*E+2],De.e.transformMat4(f,f,m),a[g][_++]=f[0],a[g][_++]=f[1],a[g][_++]=f[2];u[g]+=A.length}else a[g].set(A,u[g]);u[g]+=A.length}}l=t[0];for(var T=0;T<p;T++)r.setAttribute(l.attributes[T].name,l.attributes[T].stride,a[T]),et.log("merged mesh attribute",l.attributes[T].name,a[T].length/l.attributes[T].stride,a[T]);return r}},{key:"getMergedTransformedIdentical",value:function(t,n){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n.length,a=new It(t.renderer),s=[],o=De.e.create(),l=0;l<t.attributes.length;l++){var u=t.attributes[l].data,h=0,c=u.length;if(s[l]=new Float32Array(u.length*r),t.attributes[l].name==Rt.POSITION.name)for(var d=0;d<r;d++)for(var f=n[d].getLocalMatrix(),_=0;_<c/3;_++)o[0]=u[3*_+0],o[1]=u[3*_+1],o[2]=u[3*_+2],De.e.transformMat4(o,o,f),s[l][h++]=o[0],s[l][h++]=o[1],s[l][h++]=o[2];else for(var p=0;p<r;p++)for(var v=0;v<c;v++)s[l][h++]=u[v];a.setAttribute(t.attributes[l].name,t.attributes[l].stride,s[l])}var m=e.getMergedIndicesIdentical(t,r);return m&&a.setIndices(m),a.setAttribute("aIndex",1,e.getIdListIdentical(t,r,i)),a}},{key:"getMergedIndices",value:function(e){if(e[0].indices){for(var t=e.length,n=0,i=0;i<t;i++){if(void 0===e[i].indices)throw new ReferenceError("Cannot get merged indices: xpected indices to be defined on none or all meshes");n+=e[i].indices.length}for(var r=new Uint16Array(n),a=0,s=0,o=0;o<t;o++){for(var l=e[o].indices.length,u=0;u<l;u++)r[a++]=e[o].indices[u]+s;s+=e[o].getNumVertices()}return r}return null}},{key:"getMergedIndicesIdentical",value:function(e,t){if(e.indices){for(var n=e.indices.length,i=new Uint16Array(e.indices.length*t),r=0,a=0,s=0;s<t;s++){for(var o=0;o<n;o++)i[r++]=e.indices[o]+a;a+=e.getNumVertices()}return i}return null}},{key:"getIdList",value:function(t,n){for(var i=e.getTotalVertexCount(t),r=new Float32Array(i),a=0,s=0,o=t.length,l=0;l<o;l++){var u=t[l].getNumVertices();s=n?Math.random():l;for(var h=0;h<u;h++)r[a++]=s}return r}},{key:"getIdListIdentical",value:function(e,t,n){for(var i=e.getNumVertices(),r=new Float32Array(i*t),a=0,s=0,o=0;o<t;o++){s=n?Math.random():o;for(var l=0;l<i;l++)r[a++]=s}return r}},{key:"getTotalVertexCount",value:function(e){for(var t=0,n=e.length,i=0;i<n;i++)t+=e[i].getNumVertices();return t}},{key:"addBaryCentricCoords",value:function(t){var n=t.indices;if(n){for(var i=0;i<t.attributes.length;i++){var r=t.attributes[i],a=e.getNonIndexed(r.data,n,r.stride);t.setAttribute(r.name,r.stride,a)}delete t.indices}for(var s=t.getNumVertices()/3,o=new Float32Array(9*s),l=0,u=0;u<s;u++)o[l++]=1,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=1,o[l++]=0,o[l++]=0,o[l++]=0,o[l++]=1;t.setAttribute("aBarycentric",3,o)}},{key:"getNonIndexed",value:function(e,t,n){for(var i=t.length,r=new Float32Array(i*n),a=0,s=0;s<i;s++)for(var o=t[s],l=0;l<n;l++)r[a++]=e[o*n+l];return r}}]),e}(),sn=function(e){function t(e,n,i){var r,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return G()(this,t),a=X()(this,K()(t).call(this,e,n,i)),Qt.a.mobile&&a.addShaderDefines("MOBILE"),(r=a).addShaderDefines.apply(r,F()(s)),o||console.error("Use AirforceMaterialLoader.loadMaterial: ",i),a}return Q()(t,e),W()(t,null,[{key:"loadMaterial",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=i+r.join();if(t._cachedMaterials[a])return t._cachedMaterials[a];var s=new t(e,n,i,r,!0);return t._cachedMaterials[a]=s,s}}]),t}(At);sn._cachedMaterials={};var on=function(){function e(t,n){G()(this,e),this._cubeOffset=new Le,this._oldViewProjection=De.b.create(),this._speed=new Le(.05,-.002,.006),this._offset=new Le,this._tmpVar=new Le,this._renderer=t,this._mesh=this.createMesh(t,e.PARTICLES_SQRT3),this._material=sn.loadMaterial(t,n,"snow"),this._material.setCullingDisabled(),this._material.setAlphaBlending(),this._material.depthTest=!1}return W()(e,[{key:"createMesh",value:function(e,t){for(var n=new It(e),i=[],r=[],a=[],s=0,o=0;o<t;o++)for(var l=0;l<t;l++)for(var u=0;u<t;u++){var h=new Le(o-t/2,l-t/2,u-t/2);r.push(h),a.push(new Je(0,0)),r.push(h),a.push(new Je(1,0)),r.push(h),a.push(new Je(1,1)),r.push(h),a.push(new Je(0,1)),i.push(s+0),i.push(s+1),i.push(s+2),i.push(s+0),i.push(s+2),i.push(s+3),s+=4}return n.setPositions(an.toFloat32Array(r)),n.setUV0(an.toFloat32ArrayVec2(a)),n.setIndices(new Uint16Array(i)),n}},{key:"init",value:function(e){var t=this,n=e.addGroup("Snow",this.getMaterial());this._opacityParam=n.addParamFloat("_Opacity",.2),n.addShaderParamFloat("_Color",.85),n.addShaderParamFloat("_ParticleSize",.6),this._areaSize=.004;var i=n.addParamFloat("_SnowWindDirection",4,0,2*Math.PI),r=n.addParamFloat("_SnowWindSpeed",1,0,10),a=function(e,n){t._speed.setValues(n*Math.sin(e),-1,n*Math.cos(e)),t._speed.multiplyScalar(t._areaSize)};return i.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),r.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),a(i.getValue(),r.getValue()),n}},{key:"getMaterial",value:function(){return this._material}},{key:"draw",value:function(t){this._material.setVector3("_OldSnowOffset",this._offset),this._material.setMatrix("_OldViewProjection",this._oldViewProjection),this._material.setFloat("_ParticleAreaSize",this._areaSize),this._tmpVar.copy(this._speed),this._tmpVar.multiplyScalar(tt.getInstance().deltaTime/this._areaSize),this._offset.add(this._tmpVar),this._offset.setValues(this._offset.x%1e3,this._offset.y%1e3,this._offset.z%1e3),this._cubeOffset.copy(t.getWorldForward()),this._cubeOffset.multiplyScalar(-.5*e.PARTICLES_SQRT3*this._areaSize),this._cubeOffset.add(t.getWorldPosition()),this._material.setVector3("_CubeOffset",this._cubeOffset),this._material.setVector3("_SnowOffset",this._offset),this._material.setFloat("_Particles",e.PARTICLES_SQRT3),this._material.setFloat("_OldTimeFull",this._time),this._material.setFloat("_TimeFull",tt.getInstance().time%1e3);t.getAveragedSpeed();var n=this._opacityParam.getValue();this._material.setFloat("_Opacity",n),De.b.copy(this._oldViewProjection,t.getViewProjection()),this._time=tt.getInstance().time%1e3,n>1/255&&(t.setSnowNearFar(),this._material.setMatrix("_ViewProjection",t.getViewProjection()),this._renderer.draw(this._mesh,this._material),t.setDefaultNearFar())}}]),e}();on.PARTICLES_SQRT3=25;var ln=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return G()(this,t),(n=X()(this,K()(t).call(this,e))).createPlane(i,r,a,s),n}return Q()(t,e),W()(t,[{key:"createPlane",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=(e+1)*(t+1),a=new Float32Array(3*r),s=new Float32Array(2*r),o=new Float32Array(3*r),l=0,u=0,h=0,c=0;c<t+1;c++)for(var d=0;d<e+1;d++)a[l++]=d/e*2-1,n?(a[l++]=0,a[l++]=c/t*2-1):(a[l++]=c/t*2-1,a[l++]=0),s[u++]=d/e,s[u++]=c/t,n?(o[h++]=0,o[h++]=1,o[h++]=0):(o[h++]=0,o[h++]=0,o[h++]=1);this.setPositions(a,i),this.setUV0(s,i),this.setNormals(o,i);var f=new Uint16Array(3*(e*t*2)),_=e+1;l=0;for(c=0;c<t;c++)for(d=0;d<e;d++)f[l++]=c*_+d,f[l++]=(c+1)*_+d,f[l++]=c*_+d+1,f[l++]=(c+1)*_+d,f[l++]=(c+1)*_+d+1,f[l++]=c*_+d+1;this.setIndices(f)}}]),t}(It),un=function(e){function t(e,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Kt.RGBA_UNSIGNED_BYTE;return G()(this,t),(r=X()(this,K()(t).call(this,e,u,a,s,o)))._flipY=!0,r.loaded=!1,r._flipY=l,r._url=i,n.add(Ye()(Ye()(r))),r}return Q()(t,e),W()(t,[{key:"load",value:function(e){var t=this;Ve.loadImage(this._url,function(n){t.setImage(n,t._flipY),t.loaded=!0,e.call(t)})}}]),t}(Zt),hn=n(455),cn=n(476),dn=n(492),fn=function(){function e(){G()(this,e)}return W()(e,null,[{key:"detectWebpSupport",value:function(t){if(!e._webSupportCheckDone){e._webSupportCheckDone=!0;try{e.WEBP_SUPPORT=0==document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(n){e.WEBP_SUPPORT=!1}}return t(),e.WEBP_SUPPORT}},{key:"getImgUrl",value:function(t){return t.indexOf(".jpg")>0?e.WEBP_SUPPORT?dn(t.replace(".jpg",".webp")):cn(t):e.WEBP_SUPPORT?dn(t.replace(".png",".webp")):hn(t)}}]),e}();fn.WEBP_SUPPORT=!1,fn._webSupportCheckDone=!1;var _n=function(){function e(t,n){G()(this,e),this._speed=new Je(.05,.006),this._offset=new Je,this._tmpVar=new Je,this._renderer=t,this._sky=new ln(this._renderer,16,16,!0),this._skyMaterial=sn.loadMaterial(this._renderer,n,"sky"),this._skyMaterial.setCullingDisabled(),this._skyTexture=new un(this._renderer,n,fn.getImgUrl("./clouds.jpg"),!0,!0,!1,!1)}return W()(e,[{key:"init",value:function(e){var t=this;this._skyMaterial.setTexture("_Texture",this._skyTexture);var n=e.addGroup("Sky",this.getMaterial());n.addShaderParamFloat("_RadiusEarth",6371),n.addShaderParamFloat("_CloudHeight",30),n.addShaderParamFloat("_CloudScale",3.3),n.addShaderParamFloat("_CloudContrast",.4);var i=n.addParamFloat("_CloudWindDirection",4,0,2*Math.PI),r=n.addParamFloat("_CloudWindSpeed",1,0,10),a=function(e,n){t._speed.setValues(n*Math.sin(e),n*Math.cos(e)),t._speed.multiplyScalar(.01)};return i.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),r.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),a(i.getValue(),r.getValue()),n}},{key:"getMaterial",value:function(){return this._skyMaterial}},{key:"draw",value:function(e){this._tmpVar.copy(this._speed),this._tmpVar.multiplyScalar(.5*tt.getInstance().deltaTime),this._offset.add(this._tmpVar),this._offset.setValues(this._offset.x%10,this._offset.y%10),this._skyMaterial.setVector2("_Offset",this._offset),this._skyMaterial.setMatrix("_ViewProjection",e.getViewProjection()),this._renderer.draw(this._sky,this._skyMaterial)}}]),e}(),pn=function(e){function t(e,n,i,r){var a,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return G()(this,t),(a=X()(this,K()(t).call(this)))._params=[],a._presets=[],a._blendTime=1,a._blendDuration=1,a._fileName=r,a._loadedPresets=i,a._showUI=s,a}return Q()(t,e),W()(t,[{key:"init",value:function(e,t){this._params=t,this.setPresets(this._loadedPresets)}},{key:"setPresets",value:function(e){this._presets=e,this.refreshUI()}},{key:"refreshUI",value:function(){var e=this;this._showUI&&(this._datGui&&this._datGui.destruct(),this._datGui=new $e(null));var t=new je;t.init("Presets"),t.addButton("Export",function(){return e.exportPresets()}),t.addButton("Create Preset",function(){return e.createPreset()}),t.addButton("Update Preset",function(){return e.updatePreset()}),t.addButton("Delete Preset",function(){return e.deletePreset()}),t.addButton("Blend To Random Preset",function(){return e.blendToRandomPreset()});var n=0,i=!0,r=!1,a=void 0;try{for(var s,o=function(){var i=s.value;t.addButton("preset_"+n++,function(){return e.applyPreset(i)})},l=this._presets[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)o()}catch(u){r=!0,a=u}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}this._showUI&&this._datGui.init(t)}},{key:"updatePreset",value:function(){this._activePreset?this.savePreset(this._activePreset):console.log("updatePreset: no active preset")}},{key:"deletePreset",value:function(){if(this._activePreset){var e=this._presets.indexOf(this._activePreset);e>-1&&this._presets.splice(e,1),this.refreshUI()}else console.log("deletePreset: no active preset")}},{key:"createPreset",value:function(){var e={params:[]};this.savePreset(e),this._presets.push(e),this.refreshUI()}},{key:"serialize",value:function(e){var t={};if(t.name=e.name,e instanceof Ue){var n=e.getValueVector3();t.value=[n.x,n.y,n.z],console.log("serialize: color",t.value)}else console.log("serialize: param",e),t.value=e.getValue();return t}},{key:"deSerialize",value:function(e){if(Array.isArray(e.value)){var t=new Le(e.value[0],e.value[1],e.value[2]);return console.log("deSerialize: color",t,e.value),t}return e.value}},{key:"applyPreset",value:function(e){if(console.log("applyPreset",e),e.params){var t=!0,n=!1,i=void 0;try{for(var r,a=this._params[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value,o=!0,l=!1,u=void 0;try{for(var h,c=e.params[Symbol.iterator]();!(o=(h=c.next()).done);o=!0){var d=h.value;s.name==d.name&&s.setValue(this.deSerialize(d))}}catch(f){l=!0,u=f}finally{try{o||null==c.return||c.return()}finally{if(l)throw u}}}}catch(f){n=!0,i=f}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}}this._activePreset=e}},{key:"blendToRandomPreset",value:function(){if(this._presets.length>1){var e=this._activePreset;do{var t=Math.floor(this._presets.length*Math.random());e=this._presets[t]}while(e==this._activePreset);this.blendToPreset(e,2)}}},{key:"blendToPreset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;console.log("blendToPreset",e),this._blendTime=0,this._blendDuration=t,this._activePreset||(this._activePreset={},this._activePreset.params=[],this.savePreset(this._activePreset)),this._endPreset=e}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"isArray",value:function(e){return e.constructor===Array}},{key:"lerp",value:function(e,t,n){var i=!0,r=!1,a=void 0;try{for(var s,o=this._params[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=s.value,u=void 0,h=void 0;if(e&&e.params){var c=!0,d=!1,f=void 0;try{for(var _,p=e.params[Symbol.iterator]();!(c=(_=p.next()).done);c=!0){var v=_.value;if(l.name==v.name){u=this.deSerialize(v);break}}}catch(C){d=!0,f=C}finally{try{c||null==p.return||p.return()}finally{if(d)throw f}}}if(t&&t.params){var m=!0,g=!1,A=void 0;try{for(var y,E=t.params[Symbol.iterator]();!(m=(y=E.next()).done);m=!0){var T=y.value;if(l.name==T.name){h=this.deSerialize(T);break}}}catch(C){g=!0,A=C}finally{try{m||null==E.return||E.return()}finally{if(g)throw A}}}null!=u&&null!=h&&this.isNumber(u)&&l.setValue(Ve.lerp(u,h,n))}}catch(C){r=!0,a=C}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._blendTime<1){this._blendTime+=tt.getInstance().deltaTime/this._blendDuration,this._blendTime=Ve.clamp01(this._blendTime);var t=Ve.smoothStep01(this._blendTime);this.lerp(this._activePreset,this._endPreset,t),1==this._blendTime&&(this._activePreset=this._endPreset,console.log("blend complete",this._activePreset))}else e&&Math.random()<tt.getInstance().deltaTime/4&&this.blendToRandomPreset()}},{key:"savePreset",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,a=this._params[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value,o=!1;if(e.params){var l=!0,u=!1,h=void 0;try{for(var c,d=e.params[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;s.name==f.name&&(f.value=this.serialize(s).value,o=!0)}}catch(_){u=!0,h=_}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}o||e.params.push(this.serialize(s))}}}catch(_){n=!0,i=_}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}console.log("savePreset",e)}},{key:"exportPresets",value:function(){console.log("exportPresets",this._presets);var e=JSON.stringify(this._presets),t=document.createElement("a"),n=new Blob([e],{type:"text/plain"});t.href=URL.createObjectURL(n),t.download=this._fileName,t.click()}},{key:"destruct",value:function(){ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),vn=function(){function e(t,n){G()(this,e),this._renderer=t,this._material=n}return W()(e,[{key:"setScene",value:function(e){this._jsonScene=e}},{key:"getJsonScene",value:function(){return this._jsonScene}},{key:"getMaterials",value:function(){return[this._material]}},{key:"getMaterial",value:function(){return this._material}},{key:"setMaterial",value:function(e){this._material=e}},{key:"draw",value:function(e,t){var n=this._material;n.setMatrix("_ViewProjection",e.getViewProjection());for(var i=this.getJsonScene().getModels(),r=0;r<i.length;r++){var a=i[r].mesh;n.setMatrix("_Model",i[r].transform.getWorldMatrix()),this._renderer.draw(a,n)}}}]),e}(),mn=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).apply(this,arguments)))._visible=!1,e._fade=0,e}return Q()(t,e),W()(t,[{key:"update",value:function(e){this._visible=e,this._fade=Ve.clamp01(this._fade+(this._visible?1/60:-2/60))}},{key:"init",value:function(){this.getMaterial().setPreMultipliedAlphaBlending(),this.getMaterial().setCullingDisabled(),this.getMaterial().depthWrite=!1}},{key:"draw",value:function(e,n){this._fade>0&&(this.getMaterial().setFloat("_Fade",this._fade),ke()(K()(t.prototype),"draw",this).call(this,e,n))}},{key:"getFade",value:function(){return this._fade}}]),t}(vn),gn=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"initTrek",value:function(e,n,i){this._segments=e,this._start=n,this._end=i,ke()(K()(t.prototype),"init",this).call(this)}},{key:"drawTrek",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this._fade>0&&(this.getMaterial().setFloat("_Fill",r),this.getMaterial().setFloat("_Progress",Ve.clamp01((n+e-this._start)/(this._end-this._start)*1.15-.05)),this.getMaterial().setFloat("_Segments",this._segments),this.getMaterial().setCullingBackFace(),ke()(K()(t.prototype),"draw",this).call(this,i,0))}}]),t}(mn),An=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"initCircle",value:function(e){this._scale=e,ke()(K()(t.prototype),"init",this).call(this)}},{key:"drawCircle",value:function(e,n,i){this._fade>0&&(this.getMaterial().setFloat("_Scale",this._scale),ke()(K()(t.prototype),"draw",this).call(this,i,0))}}]),t}(mn),yn=function(){function e(t,n){G()(this,e),this._speed=new Le(.05,-.002,.006),this._offset=new Le,this._tmpVar=new Le,this._renderer=t,this._mesh=this.createMesh(t,e.PARTICLES_SQRT2),this._material=sn.loadMaterial(t,n,"groundsnow"),this._material.setCullingDisabled(),this._material.setAlphaBlending(),this._texture=new un(t,n,fn.getImgUrl("./particle.jpg"),!0,!0)}return W()(e,[{key:"createMesh",value:function(e,t){for(var n=new It(e),i=[],r=[],a=[],s=0,o=0;o<t;o++)for(var l=0;l<t;l++){var u=new Le(o-t/2,0,l-t/2);r.push(u),a.push(new Je(0,0)),r.push(u),a.push(new Je(1,0)),r.push(u),a.push(new Je(1,1)),r.push(u),a.push(new Je(0,1)),i.push(s+0),i.push(s+1),i.push(s+2),i.push(s+0),i.push(s+2),i.push(s+3),s+=4}return n.setPositions(an.toFloat32Array(r)),n.setUV0(an.toFloat32ArrayVec2(a)),n.setIndices(new Uint16Array(i)),n}},{key:"init",value:function(e){var t=this,n=e.addGroup("GroundSnow",this.getMaterial());this._opacityParam=n.addParamFloat("_GroundSnowOpacity",.1),n.addShaderParamFloat("_GroundSnowColor",.62),n.addShaderParamFloat("_GroundSnowParticleSize",.5),this._areaSize=.025;var i=n.addParamFloat("_GroundSnowWindDirection",4,0,2*Math.PI),r=n.addParamFloat("_GroundSnowWindSpeed",1,0,10),a=function(e,n){t._speed.setValues(n*Math.sin(e),0,n*Math.cos(e)),t._speed.multiplyScalar(t._areaSize)};return i.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),r.setChangeCallback(function(){return a(i.getValue(),r.getValue())}),a(i.getValue(),r.getValue()),n}},{key:"getMaterial",value:function(){return this._material}},{key:"draw",value:function(t,n,i){var r=this._opacityParam.getValue()*i;r>=1/255&&(this._material.setFloat("_ParticleAreaSize",this._areaSize),this._tmpVar.copy(this._speed),this._tmpVar.multiplyScalar(6*tt.getInstance().deltaTime/this._areaSize),this._offset.add(this._tmpVar),this._offset.setValues(this._offset.x%1e3,0,this._offset.z%1e3),this._material.setVector3("_SnowCenter",n.getWorldPosition()),this._material.setVector3("_SnowForward",n.getForward()),this._material.setVector3("_SnowRight",n.getRight()),this._material.setVector3("_SnowUp",n.getUp()),this._material.setVector3("_SnowOffset",this._offset),this._material.setFloat("_Particles",e.PARTICLES_SQRT2),this._material.setFloat("_TimeFull",tt.getInstance().time%1e3),this._material.setFloat("_GroundSnowOpacity",r),this._material.setTexture("_Texture",this._texture),this._material.setMatrix("_ViewProjection",t.getViewProjection()),this._renderer.draw(this._mesh,this._material))}}]),e}();yn.PARTICLES_SQRT2=100;var En=function(e){function t(e,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string";return G()(this,t),(r=X()(this,K()(t).call(this,e,i)))._albedo=new un(e,n,fn.getImgUrl("./"+a+"_basecolor.jpg"),!0,!0),r._metallic=new un(e,n,fn.getImgUrl("./"+a+"_metallic_roughness.jpg"),!0,!0),Qt.a.mobile||(r._normal=new un(e,n,fn.getImgUrl("./"+a+"_normal.jpg"),!0,!0)),r}return Q()(t,e),W()(t,[{key:"draw",value:function(e,n){this.getMaterial().setTexture("_MainTex",this._albedo),this.getMaterial().setTexture("_MetallicGlossMap",this._metallic),Qt.a.mobile||this.getMaterial().setTexture("_BumpMap",this._normal),ke()(K()(t.prototype),"draw",this).call(this,e,n)}}]),t}(vn),Tn=function(e){function t(e,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return G()(this,t),(r=X()(this,K()(t).call(this,e,n,i,a)))._snow=!1,r._snow=s,Qt.a.mobile&&(t.MOTION_BLUR_FRAMES=1),1!=t.MOTION_BLUR_FRAMES&&(r._mmaterial=sn.loadMaterial(e,n,"pbr",["TRANSPARENT"]),r._mmaterial.setPreMultipliedAlphaBlending(),r._mmaterial.depthTest=!0,r._mmaterial.depthWrite=!1),r._glassMaterial=sn.loadMaterial(e,n,"glass",i.getShaderDefines()),r._glassMaterial.setPreMultipliedAlphaBlending(),r._glassMaterial.depthTest=!0,r._glassMaterial.depthWrite=!1,r._snow&&(r._snowTexture=new un(e,n,fn.getImgUrl("./detail.png"),!0,!0,!1)),r}return Q()(t,e),W()(t,[{key:"setScene",value:function(e){ke()(K()(t.prototype),"setScene",this).call(this,e);var n=e.getTransforms();for(var i in n)"locator_propellor_big"==n[i].name&&(this._bigpropTransform=n[i]),"locator_propellor_small"==n[i].name&&(this._smallpropTransform=n[i])}},{key:"getMaterials",value:function(){return this._mmaterial?[this._material,this._mmaterial,this._glassMaterial]:[this._material,this._glassMaterial]}},{key:"draw",value:function(e,n){this._snow&&(this._material.setTexture("_SnowDetail",this._snowTexture),this._glassMaterial.setTexture("_SnowDetail",this._snowTexture));var i=this.getMaterial();i.setMatrix("_ViewProjection",e.getViewProjection()),i.setTexture("_MainTex",this._albedo),i.setTexture("_MetallicGlossMap",this._metallic),Qt.a.mobile||i.setTexture("_BumpMap",this._normal);for(var r=this.getJsonScene().getModels(),a=0;a<r.length;a++){var s=r[a].transform.name;if("glass"!=s&&"propellor_big"!=s&&"propellor_small"!=s){var o=r[a].mesh;i.setMatrix("_Model",r[a].transform.getWorldMatrix()),this._renderer.draw(o,i)}}if(1==t.MOTION_BLUR_FRAMES){for(var l=0;l<r.length;l++)if("propellor_big"==r[l].transform.name||"propellor_small"==r[l].transform.name){var u=r[l].mesh;this._bigpropTransform.setRadiansY(20*n),this._smallpropTransform.setRadiansX(15*n),i.setMatrix("_Model",r[l].transform.getWorldMatrix()),this._renderer.draw(u,i)}}else{var h=this._mmaterial;h.setMatrix("_ViewProjection",e.getViewProjection()),h.setTexture("_MainTex",this._albedo),h.setTexture("_MetallicGlossMap",this._metallic),Qt.a.mobile||h.setTexture("_BumpMap",this._normal),h.setFloat("_Alpha",1/t.MOTION_BLUR_FRAMES);for(var c=0;c<r.length;c++)if("propellor_big"==r[c].transform.name||"propellor_small"==r[c].transform.name)for(var d=0;d<t.MOTION_BLUR_FRAMES;d++){var f=r[c].mesh;this._bigpropTransform.setRadiansY(20*(n+d*t.MOTION_BLUR_DT/t.MOTION_BLUR_FRAMES)),this._smallpropTransform.setRadiansX(15*(n+d*t.MOTION_BLUR_DT/t.MOTION_BLUR_FRAMES)),h.setMatrix("_Model",r[c].transform.getWorldMatrix()),this._renderer.draw(f,h)}}var _=this._glassMaterial;_.setMatrix("_ViewProjection",e.getViewProjection());for(var p=0;p<r.length;p++)if("glass"==r[p].transform.name){var v=r[p].mesh;_.setMatrix("_Model",r[p].transform.getWorldMatrix()),this._renderer.draw(v,_)}}}]),t}(En);Tn.MOTION_BLUR_FRAMES=16,Tn.MOTION_BLUR_DT=.01;var Cn,wn=function(e){function t(e,n,i){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string";return G()(this,t),(r=X()(this,K()(t).call(this,e,n,i,a)))._glassMaterial=sn.loadMaterial(e,n,"glass",["TRANSPARENCY"]),r._glassMaterial.setPreMultipliedAlphaBlending(),r._glassMaterial.depthTest=!0,r._glassMaterial.depthWrite=!1,r._transparencyTexture=new un(e,n,fn.getImgUrl("./airplane/windows_transparency.jpg"),!0,!0),r}return Q()(t,e),W()(t,[{key:"getMaterials",value:function(){return[this._material,this._glassMaterial]}},{key:"draw",value:function(e,t){var n=this.getMaterial();n.setMatrix("_ViewProjection",e.getViewProjection()),n.setTexture("_MainTex",this._albedo),n.setTexture("_MetallicGlossMap",this._metallic),Qt.a.mobile||n.setTexture("_BumpMap",this._normal);for(var i=this.getJsonScene().getModels(),r=0;r<i.length;r++)if("plane"==i[r].transform.name||"plane_end"==i[r].transform.name){var a=i[r].mesh;n.setMatrix("_Model",i[r].transform.getWorldMatrix()),this._renderer.draw(a,n)}var s=this._glassMaterial;s.setMatrix("_ViewProjection",e.getViewProjection()),s.setTexture("_Transparency",this._transparencyTexture);for(var o=0;o<i.length;o++)if("Airplane_Glass"==i[o].transform.name){var l=i[o].mesh;s.setMatrix("_Model",i[o].transform.getWorldMatrix()),this._renderer.draw(l,s)}}}]),t}(En);!function(e){e.HOTSPOT_01="HOTSPOT_2_PERSON_ROPE_TEAMS",e.HOTSPOT_02="HOTSPOT_ADVICE_ON_ICE",e.HOTSPOT_03="HOTSPOT_WET_AND_FROZEN",e.HOTSPOT_04="HOTSPOT_A_BREAK_FROM_THE_STORM",e.HOTSPOT_05="HOTSPOT_WHAT_IS_IN_A_RUCK",e.HOTSPOT_06="HOTSPOT_TURNING_SNOW_INTO_WATER",e.HOTSPOT_07="HOTSPOT_KEY_TO_SURVIVAL",e.HOTSPOT_08="HOTSPOT_MISSION_SUPPORT",e.HOTSPOT_09="HOTSPOT_THE_EMOTIONAL_TOLL"}(Cn||(Cn={}));var Rn=Cn,Sn=function(e){function t(e,n,i,r){var a;switch(G()(this,t),(a=X()(this,K()(t).call(this,e,i)))._num=0,a._minChapter=we.START_TREK_1,a._maxChapter=we.END_SEQUENCE_END,a._hoverActive=!1,a._hover=0,a._id=r,a._name=Rn[r],a._num=parseInt(r.substr(-2))-1,t._mesh||(t._mesh=new ln(a._renderer,1,1),t._texture=new un(e,n,fn.getImgUrl("./hotspot.png"),!0,!0),t._textureText=new un(e,n,fn.getImgUrl("./hotspot_text.png"),!0,!0,!1),t._textureText.setFilterAnisotropic(16),t._materialText=sn.loadMaterial(e,n,"hotspot_text"),t._materialText.setPreMultipliedAlphaBlending(),t._materialText.setCullingDisabled(),t._materialText.depthWrite=!1,t._materialText.depthTest=!1),a.getName()){case Rn.HOTSPOT_01:case Rn.HOTSPOT_02:case Rn.HOTSPOT_03:case Rn.HOTSPOT_04:a._minChapter=we.START_TREK_1,a._maxChapter=we.TREK_1_2;break;case Rn.HOTSPOT_05:case Rn.HOTSPOT_06:a._minChapter=we.TO_PICK_UP_1,a._maxChapter=we.TO_PICK_UP_1;break;case Rn.HOTSPOT_07:a._minChapter=we.START_TREK_2,a._maxChapter=we.TREK_2;break;case Rn.HOTSPOT_08:case Rn.HOTSPOT_09:a._minChapter=we.START_TREK_3,a._maxChapter=we.TREK_3}return a}return Q()(t,e),W()(t,[{key:"getMaterials",value:function(){return[t._materialText].concat(F()(ke()(K()(t.prototype),"getMaterials",this).call(this)))}},{key:"setHover",value:function(e){this._hoverActive=e}},{key:"getName",value:function(){return this._name}},{key:"getId",value:function(){return this._id}},{key:"isVisible",value:function(e,t){return t>=this._minChapter&&t<=this._maxChapter&&Le.distance(e.getWorldPosition(),this._transform.getWorldPosition())<12}},{key:"initHotspot",value:function(e){this._transform=e;var n=Qt.a.mobile?1.25:1;this._material.setFloat("_Size",n),t._materialText.setFloat("_Size",n),ke()(K()(t.prototype),"init",this).call(this)}},{key:"getTransform",value:function(){return this._transform}},{key:"drawHotspot",value:function(e,n,i){if(this._hover=Ve.clamp01(this._hover+(this._hoverActive?.1:-.1)),this._fade>0){var r=t._mesh,a=this._material;a.setMatrix("_ViewProjection",i.getViewProjection()),a.setVector3("_Pos",this._transform.getWorldPosition()),a.setFloat("_Fade",this._fade),a.setFloat("_Aspect",this._renderer.getAspect()),a.setFloat("_Hover",this._hover),a.setTexture("_Texture",t._texture),this._renderer.draw(r,a);var s=t._materialText;s.setMatrix("_ViewProjection",i.getViewProjection()),s.setVector3("_Pos",this._transform.getWorldPosition()),s.setFloat("_Fade",this._fade),s.setFloat("_Aspect",this._renderer.getAspect()),s.setFloat("_TextureIndex",this._num),s.setTexture("_Texture",t._textureText),this._renderer.draw(r,s)}}}]),t}(mn),In=function(){function e(){G()(this,e),this.ro=new Le,this.rd=new Le,this._oc=new Le}return W()(e,[{key:"setVectors",value:function(e,t){this.ro.copy(e),this.rd.copy(t)}},{key:"intersectTriangle",value:function(t,n,i,r){r.z=-1;var a=e._tempV30,s=e._tempV31;Le.subtract(a,n,t),Le.subtract(s,i,t);var o=e._tempV32;Le.cross(o,this.rd,s);var l=Le.dot(a,o);if(!(l<1e-4)){var u=1/l,h=e._tempV33;Le.subtract(h,this.ro,t);var c=Le.dot(h,o)*u;if(!(c<0||c>1)){var d=e._tempV32;Le.cross(d,h,a);var f=Le.dot(this.rd,d)*u;if(!(f<0||c+f>1)){var _=Le.dot(s,d)*u;r.setValues(c,f,_)}}}}},{key:"intersectCube",value:function(e,t){var n=new rt(this.rd.x,this.rd.y,this.rd.z,0);rt.transform(n,t);var i=new Le(n.x,n.y,n.z),r=new rt(this.ro.x,this.ro.y,this.ro.z,1);rt.transform(r,t);var a=new Le(r.x,r.y,r.z),s=new Le(1,1,1).divide(i),o=s.clone().multiply(a),l=new Le(Math.abs(s.x),Math.abs(s.y),Math.abs(s.z)).multiply(e),u=o.clone().multiplyScalar(-1).subtract(l),h=o.clone().multiplyScalar(-1).add(l),c=Math.max(Math.max(u.x,u.y),u.z),d=Math.min(Math.min(h.x,h.y),h.z);return!(c>d||d<0)}},{key:"intersectSphere",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._oc.copy(this.ro),this._oc.subtract(e);var i=Le.dot(this._oc,this.rd),r=i*i-(Le.dot(this._oc,this._oc)-t*t);if(r<0)return!1;var a=-i-Math.sqrt(r);return!(a<0)&&(n&&(n.copy(this.rd),n.multiplyScalar(a),n.add(this.ro)),!0)}},{key:"intersectPlane",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=-(Le.dot(e,this.ro)+t)/Le.dot(e,this.rd);return i>0&&(n&&(n.copy(this.rd),n.multiplyScalar(i),n.add(this.ro)),!0)}},{key:"intersectPlane2",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e._tempV30;Le.subtract(r,t,this.ro);var a=Le.dot(n,r)/Le.dot(n,this.rd);return a>0&&(i&&(i.copy(this.rd),i.multiplyScalar(a),i.add(this.ro)),!0)}},{key:"setFromCamera",value:function(t,n){this.ro.copy(t.view.getPosition()),De.b.invert(e._tempMat4,t.projection.getMatrix()),e._tempVec4.setValues(n.x,n.y,1,1),e._tempVec4.transform(e._tempMat4),e._tempVec4.z=-1,e._tempVec4.w=0,De.b.invert(e._tempMat4,t.view.getMatrix()),e._tempVec4.transform(e._tempMat4),this.rd.x=e._tempVec4.x,this.rd.y=e._tempVec4.y,this.rd.z=e._tempVec4.z,this.rd.normalize()}},{key:"getClosestPointOnRayToPoint",value:function(t,n){var i=this.ro,r=e._tempV30;r.copy(i),r.add(this.rd);var a=e._tempV31;Le.subtract(a,n,i);var s=e._tempV31;Le.subtract(s,r,i);var o=s.x*s.x+s.y*s.y,l=(a.x*s.x+a.y*s.y)/o;Le.multiplyScalar(t,s,l),t.add(i)}}]),e}();In._tempMat4=De.b.create(),In._tempVec4=new rt,In._tempV30=new Le,In._tempV31=new Le,In._tempV32=new Le,In._tempV33=new Le;var bn=In,xn=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"initSOS",value:function(){ke()(K()(t.prototype),"init",this).call(this)}},{key:"drawSOS",value:function(e,n,i){var r=e==we.INTRO_2?Ve.smoothStep01(2*n-.5):1;this._fade=Math.min(r,this._fade),this._fade>0&&(this._material.depthTest=!1,ke()(K()(t.prototype),"draw",this).call(this,i,0))}}]),t}(mn),kn=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"initSOS",value:function(){ke()(K()(t.prototype),"init",this).call(this)}},{key:"drawPeopleDepth",value:function(e,n,i){this._fade>.75&&(this._material.depthFunc=ot.LEQUAL,this._material.depthTest=!0,this._renderer.setChannelMask(),ke()(K()(t.prototype),"draw",this).call(this,i,0),this._renderer.clearChannelMask())}},{key:"drawPeople",value:function(e,n,i){this._fade>.75&&(this._material.depthFunc=ot.EQUAL,this._material.depthTest=!0,ke()(K()(t.prototype),"draw",this).call(this,i,0))}}]),t}(mn),Mn=n(18),Pn=n(33),Fn=n.n(Pn),Nn=function(e){function t(e,n,i,r,a){var s;return G()(this,t),(s=X()(this,K()(t).call(this,e,i,r,a))).data=n,s}return Q()(t,e),W()(t,[{key:"clone",value:function(){return new t(this.type,this.data,this.bubbles,this.cancelable)}}]),t}(Fn.a);Nn.CLICK=Mn.EVENT_TYPE_PLACEHOLDER,Object(Mn.generateEventTypes)({WebGLElementEvent:Nn});var Dn=Nn,On=function(){function e(t,n,i){for(var r in G()(this,e),this._materials=[],this._hotspots=[],this._ray=new bn,this._renderer=t,this._sceneData=new tn(t,n,i),this._helicopter=new Tn(t,n,sn.loadMaterial(t,n,"pbr"),"helicopter/pave_hawk"),this._helicopterWreck=new Tn(t,n,sn.loadMaterial(t,n,"pbr",["SNOW"]),"helicopter/pave_hawk",!0),this._helicopterAO=new vn(t,sn.loadMaterial(t,n,"ao")),this._airplane=new wn(t,n,sn.loadMaterial(t,n,"pbr"),"airplane/plane"),this._airplaneAO=new vn(t,sn.loadMaterial(t,n,"ao")),this._airplaneEnd=new wn(t,n,sn.loadMaterial(t,n,"pbr"),"airplane/plane"),this._airplaneEndAO=new vn(t,sn.loadMaterial(t,n,"ao")),this._trek_1=new gn(t,sn.loadMaterial(t,n,"trek")),this._trek_2=new gn(t,sn.loadMaterial(t,n,"trek")),this._trek_3=new gn(t,sn.loadMaterial(t,n,"trek")),this._to_pick_up=new gn(t,sn.loadMaterial(t,n,"trek")),this._trek_1_start=new An(t,sn.loadMaterial(t,n,"circle")),this._plane_circle=new An(t,sn.loadMaterial(t,n,"circle")),this._crash_heli_circle=new An(t,sn.loadMaterial(t,n,"circle")),this._pick_up_2_circle=new An(t,sn.loadMaterial(t,n,"circle")),this._sos_sign=new xn(t,sn.loadMaterial(t,n,"sos")),this._crash_heli_people=new kn(t,sn.loadMaterial(t,n,"people")),this._pick_up_1_people=new kn(t,sn.loadMaterial(t,n,"people")),this._pick_up_2_people_a=new kn(t,sn.loadMaterial(t,n,"people")),this._pick_up_2_people_b=new kn(t,sn.loadMaterial(t,n,"people")),this._plane_wreck_people=new kn(t,sn.loadMaterial(t,n,"people")),this._planeAOTexture=new un(t,n,fn.getImgUrl("./plane_ao.png"),!0,!0,!0),this._helicopterAOTexture=new un(t,n,fn.getImgUrl("./Heli_Meinte_Shadow.png"),!0,!0,!0),Rn)this._hotspots.push(new Sn(t,n,sn.loadMaterial(t,n,"hotspot"),r));this._groundSnow=new yn(t,n)}return W()(e,[{key:"init",value:function(e,t,n){var i=this;this._helicopter.setScene(this._sceneData.filter("helipcopter_anchor")),this._helicopterWreck.setScene(this._sceneData.filter("helipcopter_wreck")),this._helicopterAO.setScene(this._sceneData.filter("Heli_Meinte_Shadow")),this._airplane.setScene(this._sceneData.filter("plane")),this._airplaneAO.setScene(this._sceneData.filter("ShadowPlane")),this._trek_1.setScene(this._sceneData.filter("trek_1")),this._trek_2.setScene(this._sceneData.filter("trek_2")),this._trek_3.setScene(this._sceneData.filter("trek_3")),this._to_pick_up.setScene(this._sceneData.filter("to_pick_up")),this._sos_sign.setScene(this._sceneData.filter("sos")),this._airplaneEnd.setScene(this._sceneData.filter("plane_end")),this._airplaneEndAO.setScene(this._sceneData.filter("ShadowPlaneEnd")),this._crash_heli_people.setScene(this._sceneData.filter("helicopter_wreck_people")),this._pick_up_1_people.setScene(this._sceneData.filter("pick_up_1_people")),this._pick_up_2_people_a.setScene(this._sceneData.filter("pick_up_2_people_a")),this._pick_up_2_people_b.setScene(this._sceneData.filter("pick_up_2_people_b")),this._plane_wreck_people.setScene(this._sceneData.filter("plane_wreck_people")),this._trek_1_start.setScene(this._sceneData.filter("trek_1_start_mesh")),this._plane_circle.setScene(this._sceneData.filter("plane_circle_mesh")),this._crash_heli_circle.setScene(this._sceneData.filter("crash_heli_circle_mesh")),this._pick_up_2_circle.setScene(this._sceneData.filter("pick_up_2_circle_mesh")),this._hotspots.forEach(function(e){e.initHotspot(i._sceneData.filter(e.getName()).getRootTransform())}),this.addMaterials(this._helicopter.getMaterials()),this.addMaterials(this._helicopterWreck.getMaterials()),this.addMaterials(this._airplane.getMaterials()),this.addMaterials(this._airplaneAO.getMaterials()),this.addMaterials(this._helicopterAO.getMaterials()),this.addMaterials(this._trek_1.getMaterials()),this.addMaterials(this._trek_2.getMaterials()),this.addMaterials(this._trek_3.getMaterials()),this.addMaterials(this._to_pick_up.getMaterials()),this.addMaterials(this._trek_1_start.getMaterials()),this.addMaterials(this._plane_circle.getMaterials()),this.addMaterials(this._crash_heli_circle.getMaterials()),this.addMaterials(this._pick_up_2_circle.getMaterials()),this._hotspots.forEach(function(e){i.addMaterials(e.getMaterials()),e.getMaterial().depthTest=!1}),this.addMaterials(this._sos_sign.getMaterials()),this.addMaterials(this._pick_up_1_people.getMaterials()),this._airplaneAO.getMaterial().setPreMultipliedAlphaBlending(),this._airplaneAO.getMaterial().setCullingDisabled(),this._airplaneAO.getMaterial().depthWrite=!1,this._airplaneAO.getMaterial().depthTest=!1,this._helicopterAO.getMaterial().setPreMultipliedAlphaBlending(),this._helicopterAO.getMaterial().setCullingDisabled(),this._helicopterAO.getMaterial().depthWrite=!1,this._helicopterAO.getMaterial().depthTest=!1,this._sos_sign.getMaterial().setPreMultipliedAlphaBlending(),this._sos_sign.getMaterial().setCullingBackFace(),this._sos_sign.getMaterial().depthWrite=!1,this._sos_sign.getMaterial().depthTest=!1,this._pick_up_1_people.getMaterial().setPreMultipliedAlphaBlending(),this._pick_up_1_people.getMaterial().setCullingBackFace(),this._pick_up_1_people.getMaterial().depthWrite=!0,this._pick_up_1_people.getMaterial().depthTest=!0,this._trek_1.initTrek(210,we.TREK_1_1,we.CRASH_1),this._trek_2.initTrek(100,we.TREK_2,we.CRASH_HELI_1),this._trek_3.initTrek(200,we.TREK_3,we.PICK_UP_2_1),this._to_pick_up.initTrek(40,we.TO_PICK_UP_1,we.WAIT_FOR_HELI_1_1),this._trek_1_start.initCircle(.2),this._plane_circle.initCircle(.2),this._crash_heli_circle.initCircle(.2),this._pick_up_2_circle.initCircle(.2),this._sos_sign.initSOS();var r=this._groundSnow.init(e);return this._materials.push(this._groundSnow.getMaterial()),this._renderer.getMouseListener().addMouseClickEvent(function(){i._ray.setFromCamera(t.getCameraUsed(),i._renderer.getMouseListener().getScreenPos()),i._hotspots.forEach(function(e){var r=Le.distance(e.getTransform().getWorldPosition(),t.getWorldPosition());if(e.getFade()>0&&i._ray.intersectSphere(e.getTransform().getWorldPosition(),.03*r)){var a=new Dn(Dn.CLICK,{name:e.getName(),id:e.getId()});n.dispatchEvent(a)}})}),r}},{key:"isElementVisible",value:function(e){return!1}},{key:"getMaterials",value:function(){return this._materials}},{key:"getRootTransform",value:function(){return this._sceneData.getRootTransform()}},{key:"getTransforms",value:function(){return this._sceneData.getTransforms()}},{key:"addMaterials",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._materials.indexOf(n)<0&&this._materials.push(n)}}},{key:"update",value:function(e,t,n,i){var r=this;this._to_pick_up.update(e>=we.TO_PICK_UP_1&&e<we.WAIT_FOR_HELI_1_1),this._trek_1.update(e>=we.START_TREK_1&&e<we.CRASH_1),this._trek_2.update(e>=we.START_TREK_2&&e<we.CRASH_HELI_1),this._trek_3.update(e>=we.START_TREK_3&&e<we.PICK_UP_2_1),this._sos_sign.update(e>we.INTRO_1&&e<we.START),this._plane_wreck_people.update(e>=we.TREK_3&&e<we.WAIT_FOR_HELI_2_3),this._pick_up_1_people.update(e>=we.TO_PICK_UP_1&&e<we.TREK_2),this._pick_up_2_people_a.update(e>=we.WAIT_FOR_HELI_2_3&&e<we.END_SEQUENCE_START),this._pick_up_2_people_b.update(!1);var a=Ve.smoothStep(0,.05,t)*Ve.smoothStep(1,.95,t);e==we.TREK_2?a*=.3:e==we.TREK_3?a*=.7:e==we.TO_PICK_UP_1?a*=.1:a=0,n.setShakeAmount(a),this._trek_1_start.update(e>=we.DROP_OFF&&e<=we.TREK_1_1),this._plane_circle.update(e>=we.TREK_1_2&&e<we.CRASH_1),this._crash_heli_circle.update(e>=we.TREK_2&&e<we.CRASH_HELI_1),this._pick_up_2_circle.update(e>=we.WAIT_FOR_HELI_2_3&&e<we.END_SEQUENCE_START),this._hotspots.forEach(function(t){t.update(t.isVisible(n,e)&&!i)}),this._ray.setFromCamera(n.getCameraUsed(),this._renderer.getMouseListener().getScreenPos());var s=!1;i||this._hotspots.forEach(function(e){var t=Le.distance(e.getTransform().getWorldPosition(),n.getWorldPosition());e.getFade()>0&&r._ray.intersectSphere(e.getTransform().getWorldPosition(),.03*t)?(s=!0,e.setHover(!0)):e.setHover(!1)}),document.body.style.cursor=s?"pointer":"default"}},{key:"drawHotspots",value:function(e,t,n,i){this._hotspots.forEach(function(i){i.drawHotspot(e,t,n)})}},{key:"draw",value:function(e,t,n,i){if(this._trek_1.drawTrek(e,t,n),this._trek_2.drawTrek(e,t,n),this._trek_3.drawTrek(e,t,n),this._to_pick_up.drawTrek(e,t,n),this._trek_1_start.drawCircle(e,t,n),this._plane_circle.drawCircle(e,t,n),this._crash_heli_circle.drawCircle(e,t,n),this._pick_up_2_circle.drawCircle(e,t,n),this._sos_sign.drawSOS(e,t,n),(e>we.INTRO_3&&e<we.TREK_1_1||e>we.WAIT_FOR_HELI_1_1&&e<we.START_TREK_2||e>=we.PICK_UP_2_5)&&this._helicopter.draw(n,i),e>we.START_TREK_2&&e<=we.TREK_3&&(this._helicopterAO.getMaterial().setTexture("_Texture",this._helicopterAOTexture),this._helicopterAO.draw(n,i),this._helicopterWreck.draw(n,i)),(e>=we.TREK_1_2&&e<=we.TO_PICK_UP_1||e<=we.INTRO_3)&&(this._airplaneAO.getMaterial().setTexture("_Texture",this._planeAOTexture),this._airplaneAO.draw(n,i),this._airplane.draw(n,i)),e>=we.TREK_3&&e<=we.WAIT_FOR_HELI_2_2&&(this._airplaneEndAO.getMaterial().setTexture("_Texture",this._planeAOTexture),this._airplaneEndAO.draw(n,i),this._airplaneEnd.draw(n,i)),this._plane_wreck_people.drawPeopleDepth(e,t,n),this._pick_up_1_people.drawPeopleDepth(e,t,n),this._pick_up_2_people_a.drawPeopleDepth(e,t,n),this._pick_up_2_people_b.drawPeopleDepth(e,t,n),this._plane_wreck_people.drawPeople(e,t,n),this._pick_up_1_people.drawPeople(e,t,n),this._pick_up_2_people_a.drawPeople(e,t,n),this._pick_up_2_people_b.drawPeople(e,t,n),e>=we.START&&e<=we.TREK_1_1){var r=e==we.DROP_OFF?t:e==we.TREK_1_1?1-t:1;this._groundSnow.draw(n,this._trek_1_start.getJsonScene().getRootTransform(),r)}if(e>=we.TREK_3){var a=e==we.TREK_3?t:e==we.END_SEQUENCE_END?1-t:1;this._groundSnow.draw(n,this._pick_up_2_circle.getJsonScene().getRootTransform(),a)}if(e>=we.CRASH_1&&e<=we.TO_PICK_UP_1){var s=e==we.CRASH_1?t:e==we.TO_PICK_UP_1?1-t:1;this._groundSnow.draw(n,this._plane_circle.getJsonScene().getRootTransform(),s)}}}]),e}(),Ln=function(){function e(t,n,i){var r=this;G()(this,e),this._transforms={},this._p=new Le,this._p0=new Le,this._p1=new Le,this._q=new Nt,this._q0=new Nt,this._q1=new Nt,this._renderer=t,this._jsonLoader=new Bt(n,i),n.setCallbackForPreloadable(this._jsonLoader,function(){r.parseJson()})}return W()(e,[{key:"getCameraTransform",value:function(){return this._cameraTransform}},{key:"setTransforms",value:function(e){for(var t in this._transforms=e,e)"Camera"==e[t].name&&(this._cameraTransform=e[t])}},{key:"parseJson",value:function(){var e=this._jsonLoader.data;this._fps=e.fps,this._tracks=e.tracks,this._intervals=e.intervals}},{key:"getNumIntervals",value:function(){return this._intervals}},{key:"animate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e==we.INTRO_3&&(t=t<.75?0:1,n=!1);for(var i=Ve.clamp(Math.floor(t*this._fps),0,this._fps)+this._fps*e,r=Ve.clamp(Math.ceil(t*this._fps),0,this._fps)+this._fps*e,a=t*this._fps%1,s=0;s<this._tracks.length;s++){var o=this._tracks[s],l=this._transforms[o.transformId];l&&(this._p0.setValues(o.positions[3*i+0],o.positions[3*i+1],o.positions[3*i+2]),this._p1.setValues(o.positions[3*r+0],o.positions[3*r+1],o.positions[3*r+2]),Le.lerp(this._p,this._p0,this._p1,a),n&&Le.lerp(this._p,this._p,l.getPosition(),.9),l.setPosition(this._p),this._q0.setValues(o.rotations[4*i+0],o.rotations[4*i+1],o.rotations[4*i+2],o.rotations[4*i+3]),this._q1.setValues(o.rotations[4*r+0],o.rotations[4*r+1],o.rotations[4*r+2],o.rotations[4*r+3]),Nt.closestSlerp(this._q,this._q0,this._q1,a),n&&Nt.closestSlerp(this._q,this._q,l.getRotation(),.9),l.setRotation(this._q))}}}]),e}(),Un=function(){function e(){G()(this,e)}return W()(e,[{key:"setTransforms",value:function(e){for(var t in e)"helicopter"==e[t].name&&(this._heliTransform=e[t])}},{key:"update",value:function(e){this._heliTransform.setEulerDegreesValues(3*Math.sin(.8*e),1.3*Math.sin(2.8*e),2.4*Math.sin(1*e)),this._heliTransform.setPositionValues(.02*Math.sin(1.7*e),.01*Math.cos(1.5*e),.01*Math.sin(1.6*e))}}]),e}(),Bn=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return G()(this,t),(n=X()(this,K()(t).call(this))).dirty=!0,n._projectionMatrix=De.b.create(),n.frustumHeight=1,n._fov=i,n._nearPlane=r,n._farPlane=a,n._aspect=1,n._changeCallback=e,n}return Q()(t,e),W()(t,[{key:"getMatrix",value:function(){return this.updateProjection(),this._projectionMatrix}},{key:"updateProjection",value:function(){this.dirty&&(De.b.perspective(this._projectionMatrix,this._fov*t._degToRad,this._aspect,this._nearPlane,this._farPlane),this.dirty=!1,this.frustumHeight=2*Math.tan(this._fov*t._degToRad*.5))}},{key:"setAspect",value:function(e){e!==this._aspect&&(this._aspect=e,this.setDirty())}},{key:"getAspect",value:function(){return this._aspect}},{key:"setFarPlane",value:function(e){e!==this._farPlane&&(this._farPlane=e,this.setDirty())}},{key:"getFarPlane",value:function(){return this._farPlane}},{key:"setNearPlane",value:function(e){e!==this._nearPlane&&(this._nearPlane=e,this.setDirty())}},{key:"getNearPlane",value:function(){return this._nearPlane}},{key:"setFOV",value:function(e){e!==this._fov&&(this._fov=e,this.frustumHeight=2*Math.tan(this._fov*t._degToRad*.5),this.setDirty())}},{key:"getFOV",value:function(){return this._fov}},{key:"getFrustumCornerRef",value:function(e){var t=.5*this.frustumHeight,n=t*this._aspect;e.setValues(n,t,1)}},{key:"getFrustumCorner",value:function(){var e=new Le;return this.getFrustumCornerRef(e),e}},{key:"getFrustumHeightAtDistance",value:function(e){return 2*e*Math.tan(.5*this._fov*t._degToRad)}},{key:"getDistanceAtFrustumHeight",value:function(e){return.5*e/Math.tan(.5*this._fov*t._degToRad)}},{key:"getFOVAtDistanceAndHeight",value:function(e,n){return 2*Math.atan(.5*n/e)*t._radToDeg}},{key:"destruct",value:function(){ke()(K()(t.prototype),"destruct",this).call(this)}},{key:"setDirty",value:function(){this.dirty=!0,this._changeCallback.call(this)}}]),t}(Me);Bn._degToRad=Math.PI/180,Bn._radToDeg=180/Math.PI;var Vn=Bn,Hn=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this))).dirty=!0,n._viewMatrix=De.b.create(),n.transform=new Lt,n.transform.addChangeCallBack(function(){return n.setDirty()}),n._changeCallback=e,n}return Q()(t,e),W()(t,[{key:"getPosition",value:function(){return this.transform.getWorldPosition()}},{key:"setDirty",value:function(){this.dirty=!0,this._changeCallback.call(this)}},{key:"getMatrix",value:function(){return this.updateMatrix(),this._viewMatrix}},{key:"updateMatrix",value:function(){this.dirty&&(De.b.invert(this._viewMatrix,this.transform.getWorldMatrix()),this.dirty=!1)}},{key:"destruct",value:function(){this.transform&&this.transform.destruct(),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),Gn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return G()(this,t),(e=X()(this,K()(t).call(this))).dirty=!0,e._viewProjection=De.b.create(),e.tScreenPos=new rt,e.tViewProjInv=De.b.create(),e.projection=new Vn(function(){return e.setDirty()},n,i,r),e.view=new Hn(function(){return e.setDirty()}),e}return Q()(t,e),W()(t,[{key:"setDirty",value:function(){this.dirty=!0}},{key:"getPosition",value:function(){return this.view.getPosition()}},{key:"lookAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.UP;this.view.transform.lookAt(e,t,n)}},{key:"setPosition",value:function(e){this.view.transform.setPosition(e)}},{key:"getViewProjection",value:function(){return this.updateViewProjection(),this._viewProjection}},{key:"getProjectionMatrix",value:function(){return this.projection.getMatrix()}},{key:"getViewMatrix",value:function(){return this.view.getMatrix()}},{key:"getProjection",value:function(){return this.projection}},{key:"updateViewProjection",value:function(){this.dirty&&(De.b.multiply(this._viewProjection,this.projection.getMatrix(),this.view.getMatrix()),this.dirty=!1)}},{key:"getScreenPos",value:function(e,t){this.tScreenPos.x=t.x,this.tScreenPos.y=t.y,this.tScreenPos.z=t.z,this.tScreenPos.w=1,this.tScreenPos.transform(this.getViewProjection()),this.tScreenPos.x/=this.tScreenPos.w,this.tScreenPos.y/=this.tScreenPos.w,this.tScreenPos.x=.5*this.tScreenPos.x+.5,this.tScreenPos.y=-.5*this.tScreenPos.y+.5,e.x=this.tScreenPos.x,e.y=this.tScreenPos.y,e.z=this.tScreenPos.z}},{key:"getWorldPos",value:function(e,t){De.b.invert(this.tViewProjInv,this.getViewProjection());var n=2*t.x-1,i=-2*t.y+1;e.x=n,e.y=i,e.z=0,e.transform(this.tViewProjInv)}},{key:"destruct",value:function(){this.projection&&this.projection.destruct(),this.view&&this.view.destruct(),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),zn=function e(){G()(this,e)};zn.BACKSPACE=8,zn.TAB=9,zn.ENTER=13,zn.SHIFT=16,zn.CTRL=17,zn.ALT=18,zn.PAUSE=19,zn.CAPS_LOCK=20,zn.ESCAPE=27,zn.SPACE=32,zn.PAGE_UP=33,zn.PAGE_DOWN=34,zn.END=35,zn.HOME=36,zn.LEFT_ARROW=37,zn.UP_ARROW=38,zn.RIGHT_ARROW=39,zn.DOWN_ARROW=40,zn.INSERT=45,zn.DELETE=46,zn.KEY_0=48,zn.KEY_1=49,zn.KEY_2=50,zn.KEY_3=51,zn.KEY_4=52,zn.KEY_5=53,zn.KEY_6=54,zn.KEY_7=55,zn.KEY_8=56,zn.KEY_9=57,zn.KEY_A=65,zn.KEY_B=66,zn.KEY_C=67,zn.KEY_D=68,zn.KEY_E=69,zn.KEY_F=70,zn.KEY_G=71,zn.KEY_H=72,zn.KEY_I=73,zn.KEY_J=74,zn.KEY_K=75,zn.KEY_L=76,zn.KEY_M=77,zn.KEY_N=78,zn.KEY_O=79,zn.KEY_P=80,zn.KEY_Q=81,zn.KEY_R=82,zn.KEY_S=83,zn.KEY_T=84,zn.KEY_U=85,zn.KEY_V=86,zn.KEY_W=87,zn.KEY_X=88,zn.KEY_Y=89,zn.KEY_Z=90,zn.LEFT_META=91,zn.RIGHT_META=92,zn.SELECT=93,zn.NUMPAD_0=96,zn.NUMPAD_1=97,zn.NUMPAD_2=98,zn.NUMPAD_3=99,zn.NUMPAD_4=100,zn.NUMPAD_5=101,zn.NUMPAD_6=102,zn.NUMPAD_7=103,zn.NUMPAD_8=104,zn.NUMPAD_9=105,zn.MULTIPLY=106,zn.ADD=107,zn.SUBTRACT=109,zn.DECIMAL=110,zn.DIVIDE=111,zn.F1=112,zn.F2=113,zn.F3=114,zn.F4=115,zn.F5=116,zn.F6=117,zn.F7=118,zn.F8=119,zn.F9=120,zn.F10=121,zn.F11=122,zn.F12=123,zn.NUM_LOCK=144,zn.SCROLL_LOCK=145,zn.SEMICOLON=186,zn.EQUALS=187,zn.COMMA=188,zn.DASH=189,zn.PERIOD=190,zn.FORWARD_SLASH=191,zn.GRAVE_ACCENT=192,zn.OPEN_BRACKET=219,zn.BACK_SLASH=220,zn.CLOSE_BRACKET=221,zn.SINGLE_QUOTE=222;var Wn=zn,jn=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;G()(this,e),e._instance&&console.log("!-use getInstance!"),this._keyState=[],this._keyHitCallbacks=[],n.addEventListener("keydown",function(e){var n=e.keyCode||e.which;if(t._keyState[n]=!0,t._keyHitCallbacks[n])for(var i=0;i<t._keyHitCallbacks[n].length;i++)t._keyHitCallbacks[n][i].call(t)},!0),n.addEventListener("keyup",function(e){t._keyState[e.keyCode||e.which]=!1},!0)}return W()(e,[{key:"getCharDown",value:function(e){return this._keyState[e.charCodeAt(0)]}},{key:"getKeyCodeDown",value:function(e){return this._keyState[e]}},{key:"addKeyHitEvent",value:function(e,t){this._keyHitCallbacks[e]||(this._keyHitCallbacks[e]=[]),this._keyHitCallbacks[e].push(t)}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),Xn=function(e){function t(e,n){var i;return G()(this,t),(i=X()(this,K()(t).call(this)))._mouseDown=!1,i._eulerDegreesSpeed=new Je,i._rotating=!1,i._rotatingLerp=0,i._rotatingLerpPrev=0,i._renderer=e,i._mouseListener=e.getMouseListener(),i}return Q()(t,e),W()(t,[{key:"update",value:function(e){var n=this._mouseDown;this._mouseDown=this._mouseListener.getMouseDown();var i=e.projection.getFOV(),r=.5/Math.tan(i*(1.570796326795/180)),a=114.5915590261571*Math.atan2(.5*this._renderer.getAspect(),r),s=this.getMouseSpeed();s.length()>t.MOUSE_MOVEMENT_CANCEL_TRIGGER&&this._mouseListener.cancelClick(),this._mouseDown&&n?(this._eulerDegreesSpeed.setValues(s.y*i,s.x*a),this._rotating=this._eulerDegreesSpeed.length()>0,this._rotatingLerp=this._rotating?.5:0,this._rotatingLerpPrev=this._rotatingLerp,this.rotateBy(this._eulerDegreesSpeed),this._eulerDegreesSpeed.setValues(Math.min(t.MAX_ROTATE_SPEED,Math.abs(this._eulerDegreesSpeed.x))*Math.sign(this._eulerDegreesSpeed.x),Math.min(t.MAX_ROTATE_SPEED,Math.abs(this._eulerDegreesSpeed.y))*Math.sign(this._eulerDegreesSpeed.y))):(this._rotatingLerp=Ve.clamp01(this._rotatingLerp-tt.getInstance().deltaTime),this._rotating=this._rotatingLerp>0,this._rotating&&(this._eulerDegreesSpeed.multiplyScalar(1-(this._rotatingLerpPrev-this._rotatingLerp)/this._rotatingLerpPrev),this.rotateBy(this._eulerDegreesSpeed)),this._rotatingLerpPrev=this._rotatingLerp)}},{key:"resetSpeed",value:function(){this._mouseDown=!1,this._eulerDegreesSpeed.setValues(0,0)}},{key:"rotateBy",value:function(e){this._eulerDegreesXY.add(e),this._eulerDegreesXY.x=Ve.clamp(this._eulerDegreesXY.x,-80,80),this._transform.setEulerDegreesXY(this._eulerDegreesXY)}},{key:"isRotating",value:function(){return this._rotating}},{key:"getMouseSpeed",value:function(){return this._mouseListener.getMouseDown()?this._mouseListener.getNormalizedVelocity():Je.ZERO}}]),t}(function(){function e(){G()(this,e),this._eulerDegreesXY=new Je,this._transform=new Lt}return W()(e,[{key:"update",value:function(e){}},{key:"setEulerDegreesXY",value:function(e){this._eulerDegreesXY.copy(e),this._transform.setEulerDegreesXY(e)}},{key:"setRotation",value:function(e){this._transform.setRotation(e);var t=this._transform.getEulerDegrees();this._eulerDegreesXY.setValues(t.x,t.y)}},{key:"getRotation",value:function(){return this._transform.getRotation()}},{key:"eulerDegreesXY",get:function(){return this._eulerDegreesXY}}]),e}());Xn.MOUSE_MOVEMENT_CANCEL_TRIGGER=.0025,Xn.MAX_ROTATE_SPEED=10;var Yn=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return G()(this,t),(n=X()(this,K()(t).call(this,i,r,a)))._translateSpeed=new Le,n._right=new Le,n._translateSpeedModifier=10,n._dampingModifier=1,n._renderer=e,n._invertMouse=s,n._keyListener=jn.getInstance(),n._mouseListener=e.getMouseListener(),n._rotationController=new Xn(e,s),n}return Q()(t,e),W()(t,[{key:"setEulerDegreesXY",value:function(e){this._rotationController.setEulerDegreesXY(e)}},{key:"lookAt",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.UP;ke()(K()(t.prototype),"lookAt",this).call(this,e,n,i),this._rotationController.setRotation(this.view.transform.getRotation())}},{key:"resetSpeed",value:function(){this._translateSpeed.setValues(0,0,0),this._rotationController.resetSpeed()}},{key:"forward",value:function(e){var t=this.view.transform.getForward();t.multiplyScalar(this._translateSpeedModifier*e*tt.getInstance().deltaTime),this._translateSpeed.add(t)}},{key:"sideWays",value:function(e){this._right.copy(this.view.transform.getRight()),this._right.multiplyScalar(-this._translateSpeedModifier*e*tt.getInstance().deltaTime),this._translateSpeed.add(this._right)}},{key:"rotateBy",value:function(e){this._rotationController.rotateBy(e),this.view.transform.setRotation(this._rotationController.getRotation())}},{key:"update",value:function(){this._keyListener.getKeyCodeDown(Wn.LEFT_ARROW)&&this.sideWays(1),this._keyListener.getKeyCodeDown(Wn.RIGHT_ARROW)&&this.sideWays(-1),this._keyListener.getKeyCodeDown(Wn.UP_ARROW)&&this.forward(-1),this._keyListener.getKeyCodeDown(Wn.DOWN_ARROW)&&this.forward(1),this._keyListener.getKeyCodeDown(Wn.KEY_A)&&this.sideWays(1),this._keyListener.getKeyCodeDown(Wn.KEY_D)&&this.sideWays(-1),this._keyListener.getKeyCodeDown(Wn.KEY_W)&&this.forward(-1),this._keyListener.getKeyCodeDown(Wn.KEY_S)&&this.forward(1),this.view.transform.translate(this._translateSpeed),this._translateSpeed.multiplyScalar(Math.pow(.95,this._dampingModifier)),this._rotationController.update(this),this.view.transform.setRotation(this._rotationController.getRotation())}},{key:"getMouseDown",value:function(){return this._mouseListener.getMouseDown()}},{key:"getMouseSpeed",value:function(){return this._mouseListener.getMouseDown()?this._mouseListener.getNormalizedVelocity():Je.ZERO}},{key:"setTranslateSpeed",value:function(e){this._translateSpeedModifier=e}},{key:"getTranslateSpeed",value:function(){return this._translateSpeedModifier}},{key:"setDamping",value:function(e){this._dampingModifier=e}}]),t}(Gn),Kn=function(){function e(){G()(this,e)}return W()(e,null,[{key:"sineNoise1",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.612,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=0,r=1,a=1,s=0;s<n;s++)i+=Math.sin(e*a)*r,a/=t,r*=t;return i}},{key:"sineNoise3",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.612,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;e.setValues(0,0,0);for(var r=1,a=1,s=0;s<i;s++)e.x+=Math.sin(t*a)*r,e.y+=Math.sin(t*a+12345.678)*r,e.z+=Math.sin(t*a+87654.321)*r,a/=n,r*=n;return e}},{key:"sineNoise33",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.612,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;t.setValues(0,0,0);for(var a=1,s=1,o=0;o<r;o++)t.x+=Math.sin(n.y*s)*a,t.y+=Math.sin(n.z*s)*a,t.z+=Math.sin(n.x*s)*a,De.e.transformMat3(n.v,n.v,e._rotationMatrix),s/=i,a*=i;return t}},{key:"getFloatNoiseVolumeData",value:function(t,n){var i=1/t,r=0,a=new Float32Array(t*t*t*4),s=new Le;e.RandomizeSeeds();for(var o=0;o<t;o++){s.z=o*i*n;for(var l=0;l<t;l++){s.y=l*i*n;for(var u=0;u<t;u++){s.x=u*i*n;var h=e.noise3(s);a[r++]=h.x,a[r++]=h.y,a[r++]=h.z,a[r++]=0}}}return a}},{key:"getFloatNoiseVolumeDataAs2D",value:function(t,n,i,r){var a=1/i,s=0,o=new Float32Array(i*i*i*4),l=new Le;e.RandomizeSeeds();for(var u,h=t/i,c=new Le,d=1,f=[],_=0;_<8;_++)f.push((new Le).randomize());for(var p=0;p<n;p++)for(var v=0;v<t;v++){l.x=v%i,l.y=p%i,l.z=Math.floor(p*a)*h+Math.floor(v*a),l.multiplyScalar(a*r),c.setValues(0,0,0),d=1;for(_=0;_<8;_++)l.add(f[_]),(u=e.noise3(l)).multiplyScalar(d),c.add(u),d*=.5678,l.multiplyScalar(1.8);o[s++]=c.x,o[s++]=c.y,o[s++]=c.z,o[s++]=0}return o}},{key:"getUintNoiseVolumeData",value:function(t,n){for(var i=e.getFloatNoiseVolumeData(t,n),r=i.length,a=new Uint8Array(r),s=0;s<r;s++){var o=255*(.5*i[s]+.5);a[s]=Math.floor(o)}return a}},{key:"getUintNoiseVolumeDataAs2D",value:function(t,n,i,r){for(var a=e.getFloatNoiseVolumeDataAs2D(t,n,i,r),s=a.length,o=new Uint8Array(s),l=0;l<s;l++){var u=255*(.5*a[l]+.5);o[l]=Math.floor(u)}return o}},{key:"RandomizeSeeds",value:function(){e._hashDotX.randomize01(),e._hashDotX.multiplyScalar(100),e._hashDotY.randomize01(),e._hashDotY.multiplyScalar(100),e._hashDotZ.randomize01(),e._hashDotZ.multiplyScalar(100),e._noiseSeedX=1e4*Math.random(),e._noiseSeedY=1e4*Math.random(),e._noiseSeedZ=1e4*Math.random()}},{key:"getUint8Data",value:function(){return null}},{key:"lerp1",value:function(e,t,n){return(1-n)*e+n*t}},{key:"smoothstep1",value:function(e){return e*e*(3-2*e)}},{key:"fract1",value:function(e){return e-Math.floor(e)}},{key:"hash",value:function(t){return e.fract1(Math.sin(Le.dot(t,e._hashDot))*e._noiseSeed)}},{key:"noise1",value:function(t){var n=e._tempV30;Le.floor(n,t);var i=e._tempV31;Le.fract(i,t),i.smoothstep();var r=e.lerp1(this.hash(n),this.hash(Le.add(this._tempV3,n,this.p100)),i.x),a=e.lerp1(this.hash(Le.add(this._tempV32,n,this.p010)),this.hash(Le.add(this._tempV33,n,this.p110)),i.x),s=e.lerp1(r,a,i.y),o=e.lerp1(this.hash(Le.add(this._tempV32,n,this.p001)),this.hash(Le.add(this._tempV33,n,this.p101)),i.x),l=e.lerp1(this.hash(Le.add(this._tempV32,n,this.p011)),this.hash(Le.add(this._tempV33,n,this.p111)),i.x),u=e.lerp1(o,l,i.y);return e.lerp1(s,u,i.z)-.5}},{key:"perlin1",value:function(t){var n=this._tempV35;n.copy(t);var i=.5*e.noise1(n);return De.e.transformMat3(n.v,n.v,e.mat3),n.multiplyScalar(2.01),i+=.25*e.noise1(n),De.e.transformMat3(n.v,n.v,e.mat3),n.multiplyScalar(2.02),i+=.125*e.noise1(n),De.e.transformMat3(n.v,n.v,e.mat3),n.multiplyScalar(2.03),i+=.0625*e.noise1(n),De.e.transformMat3(n.v,n.v,e.mat3),n.multiplyScalar(2.04),i}},{key:"perlin3D",value:function(e,t,n){for(var i=function(e){return e*e*e*(e*(6*e-15)+10)},r=function(e,t,n){return t+e*(n-t)},a=function(e,t,n,i){var r=15&e,a=r<8?t:n,s=r<4?n:12==r||14==r?t:i;return(0===(1&r)?a:-a)+(0===(2&r)?s:-s)},s=new Array(512),o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],l=0;l<256;l++)s[256+l]=s[l]=o[l];var u=255&Math.floor(e),h=255&Math.floor(t),c=255&Math.floor(n);e-=Math.floor(e),t-=Math.floor(t),n-=Math.floor(n);var d=i(e),f=i(t),_=i(n),p=s[u]+h,v=s[p]+c,m=s[p+1]+c,g=s[u+1]+h,A=s[g]+c,y=s[g+1]+c;return(1+r(_,r(f,r(d,a(s[v],e,t,n),a(s[A],e-1,t,n)),r(d,a(s[m],e,t-1,n),a(s[y],e-1,t-1,n))),r(f,r(d,a(s[v+1],e,t,n-1),a(s[A+1],e-1,t,n-1)),r(d,a(s[m+1],e,t-1,n-1),a(s[y+1],e-1,t-1,n-1)))))/2}},{key:"noise3Ref",value:function(t,n){e._noiseSeed=e._noiseSeedX,e._hashDot.copy(e._hashDotX),n.x=e.noise1(t),e._noiseSeed=e._noiseSeedY,e._hashDot.copy(e._hashDotY),n.y=e.noise1(t),e._noiseSeed=e._noiseSeedZ,e._hashDot.copy(e._hashDotZ),n.z=e.noise1(t)}},{key:"noise3",value:function(e){var t=new Le;return this.noise3Ref(e,t),t}},{key:"curlNoise3",value:function(t,n){var i=e._tempV34;i.copy(n),i.x+=.01;var r=this.perlin1(i);i.copy(n),i.x-=.01;var a=this.perlin1(i);i.copy(n),i.y+=.01;var s=this.perlin1(i);i.copy(n),i.y-=.01;var o=this.perlin1(i);i.copy(n),i.z+=.01;var l=this.perlin1(i);i.copy(n),i.z-=.01;var u=r-a,h=s-o,c=l-this.perlin1(i);return t.x=h-c,t.y=c-u,t.z=u-h,t.multiplyScalar(50),t}}]),e}();Kn._tempV30=new Le,Kn._tempV31=new Le,Kn._tempV32=new Le,Kn._tempV33=new Le,Kn._tempV34=new Le,Kn._tempV35=new Le,Kn._hashDot=new Le(12.9898,39.1215,78.233),Kn._hashDotX=new Le(12.9898,39.1215,78.233),Kn._hashDotY=new Le(36.8704,19.6392,83.123),Kn._hashDotZ=new Le(58.927,17.456,38.347),Kn._noiseSeed=43758.5453,Kn._noiseSeedX=43758.5453,Kn._noiseSeedY=87345.5453,Kn._noiseSeedZ=19045.5453,Kn.p100=new Le(1,0,0),Kn.p010=new Le(0,1,0),Kn.p110=new Le(1,1,0),Kn.p001=new Le(0,0,1),Kn.p101=new Le(1,0,1),Kn.p011=new Le(0,1,1),Kn.p111=new Le(1,1,1),Kn._tempV3=new Le,Kn._rotationMatrix=De.a.fromValues(0,.8,.6,-.8,.36,-.48,-.6,-.48,.64),Kn.mat3=De.a.fromValues(0,.8,.6,-.8,.36,-.48,-.6,-.48,.64);var $n=Kn,Qn=function(){function e(t){G()(this,e),this._animated=!1,this._transform=new Lt,this._panTransform=new Lt,this._averagedSpeed=0,this._previousWorldPosition=new Le,this._hoverVec2=new Je(0,0),this._tmpVec3_0=new Le,this._tmpVec3_1=new Le,this._tmpVec2_0=new Je(0,0),this._shake=0,this._renderer=t,this._cameraController=new Yn(t,e.FOV,e.NEAR,e.FAR,!1),this._cameraController.lookAt(Le.ZERO,Le.FORWARD),this._cameraController.setTranslateSpeed(.05),this._cameraController.setDamping(5.5),this._animatedCamera=new Gn(e.FOV,e.NEAR,e.FAR),this._panTransform.setParent(this._transform),this._animatedCamera.view.transform.setParent(this._panTransform),this._animatedCamera.view.transform.setEulerDegreesValues(0,180,0)}return W()(e,[{key:"copyAnimatedPosToDebugCamera",value:function(){this._tmpVec3_0.copy(this._transform.getParent().getPosition()),this._tmpVec3_1.copy(this._transform.getParent().getForward()),this._tmpVec3_1.add(this._tmpVec3_0),this._cameraController.lookAt(this._tmpVec3_0,this._tmpVec3_1),this._cameraController.resetSpeed()}},{key:"update",value:function(t){this._renderer.getMouseListener().updateManual(),t!==this._animated&&(this._animated=t,this.copyAnimatedPosToDebugCamera());var n=t?this._animatedCamera:this._cameraController,i=this._renderer.getAspect();if(n.projection.setAspect(i),this.setFOV(i>1?e.FOV:e.FOV_PORTRAIT),t){var r=this._renderer.getMouseListener().getScreenPos();Je.lerp(this._hoverVec2,this._hoverVec2,r,.015),this._tmpVec2_0.copy(this._hoverVec2),this._shake>0&&(this._tmpVec2_0.x+=.1*($n.sineNoise1(2.5*tt.getInstance().time*1.41421356237,.777)-.5)*this._shake,this._tmpVec2_0.y+=.1*($n.sineNoise1(2.5*-tt.getInstance().time*3.14159265359,.788)-.5)*this._shake);var a=.02+.005*this._shake;this._tmpVec3_0.multiplyScalar(this._tmpVec2_0.y*-a),this._tmpVec3_1.copy(Le.RIGHT),this._tmpVec3_1.multiplyScalar(this._tmpVec2_0.x*a*this._renderer.getAspect()),this._tmpVec3_0.add(this._tmpVec3_1),this._panTransform.setPosition(this._tmpVec3_0);this._panTransform.setEulerDegreesValues(-1.5*this._tmpVec2_0.y,-1.5*this._tmpVec2_0.x*this._renderer.getAspect(),0)}else this._cameraController.update();var s=Math.min(25,1e3*Le.distance(this._previousWorldPosition,this.getWorldPosition()));this._averagedSpeed=Ve.lerp(this._averagedSpeed,s*tt.getInstance().deltaTime,.05),this._previousWorldPosition.copy(this.getWorldPosition())}},{key:"setShakeAmount",value:function(e){this._shake=e}},{key:"getTransform",value:function(){return this._transform}},{key:"getLogTransform",value:function(){return this._cameraController.view.transform}},{key:"init",value:function(e){var t=this,n=e.addGroup("Camera"),i=n.addParamFloat("_Fov",this.getFOV(),50,120);i.setChangeCallback(function(){t.setFOV(i.getValue())});var r=n.addParamFloat("_Speed",this.getTranslateSpeed(),0,10);return r.setChangeCallback(function(){t.setTranslateSpeed(r.getValue())}),n}},{key:"getHover",value:function(){return this._hoverVec2}},{key:"getViewProjection",value:function(){return this._animated?this._animatedCamera.getViewProjection():this._cameraController.getViewProjection()}},{key:"getProjectionMatrix",value:function(){return this._animated?this._animatedCamera.getProjectionMatrix():this._cameraController.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this._animated?this._animatedCamera.getViewMatrix():this._cameraController.getViewMatrix()}},{key:"getProjection",value:function(){return this._animated?this._animatedCamera.getProjection():this._cameraController.getProjection()}},{key:"getWorldForward",value:function(){return this._animated?this._animatedCamera.view.transform.getWorldForward():this._cameraController.view.transform.getWorldForward()}},{key:"getWorldUp",value:function(){return this._animated?this._animatedCamera.view.transform.getUp():this._cameraController.view.transform.getUp()}},{key:"getWorldRight",value:function(){return this._animated?this._animatedCamera.view.transform.getRight():this._cameraController.view.transform.getRight()}},{key:"getWorldPosition",value:function(){return this._animated?this._animatedCamera.view.transform.getWorldPosition():this._cameraController.view.transform.getWorldPosition()}},{key:"getTranslateSpeed",value:function(){return this._cameraController.getTranslateSpeed()}},{key:"setTranslateSpeed",value:function(e){this._cameraController.setTranslateSpeed(e)}},{key:"getFOV",value:function(){return this._cameraController.projection.getFOV()}},{key:"setFOV",value:function(e){this._cameraController.projection.setFOV(e),this._animatedCamera.projection.setFOV(e)}},{key:"getAveragedSpeed",value:function(){return this._averagedSpeed}},{key:"setDirty",value:function(){this._cameraController.setDirty(),this._animatedCamera.setDirty()}},{key:"setSnowNearFar",value:function(){this._cameraController.projection.setNearPlane(e.SNOW_NEAR),this._cameraController.projection.setFarPlane(e.SNOW_FAR),this._animatedCamera.projection.setNearPlane(e.SNOW_NEAR),this._animatedCamera.projection.setFarPlane(e.SNOW_FAR)}},{key:"setDefaultNearFar",value:function(){this._cameraController.projection.setNearPlane(e.NEAR),this._cameraController.projection.setFarPlane(e.FAR),this._animatedCamera.projection.setNearPlane(e.NEAR),this._animatedCamera.projection.setFarPlane(e.FAR)}},{key:"getCameraUsed",value:function(){return this._animated?this._animatedCamera:this._cameraController}}]),e}();Qn.FOV=60,Qn.FOV_PORTRAIT=70,Qn.NEAR=.1,Qn.FAR=1e4,Qn.SNOW_NEAR=1e-4,Qn.SNOW_FAR=100;var Jn=function(){function e(t,i){var r,a=this;G()(this,e),this._presets={},this._presetManager=i;var s=0;this._jsonLoader=new Bt(t,n.e(3).then(n.t.bind(null,584,3))),t.setCallbackForPreloadable(this._jsonLoader,function(){for(var e=a._jsonLoader.data,t=0;t<we.LENGTH;t++){var n=we[t];e[n]&&(r=e[n][0],s=t);var i={startPreset:r,startChapter:s,endPreset:r,endChapter:s};a._presets[t]=i}for(var o=we.LENGTH-1;o>=0;o--){a._presets[o].endPreset=r,a._presets[o].endChapter=s;var l=we[o];e[l]&&(r=e[l][0],s=o)}})}return W()(e,[{key:"setProgress",value:function(e,t){e==we.INTRO_3&&(t=t<.75?0:1);var n=this._presets[e],i=n.endChapter==n.startChapter?1:(e-n.startChapter+t)/(n.endChapter-n.startChapter);this._presetManager.lerp(n.startPreset,n.endPreset,Ve.smoothStep01(i))}}]),e}(),Zn=function(e){function t(e,n,i){var r;G()(this,t),(r=X()(this,K()(t).call(this,e,n,i)))._material=sn.loadMaterial(e,n,"mountainTexture"),e.extensionManager.shader_texture_lod&&r._material.addShaderDefines("LOD_EXT"),i&&r._material.addShaderDefines("USE_DETAIL_TEXTURE");return r._mainTexture=new un(e,n,fn.getImgUrl("./mountain_2k.jpg"),!0,!0),r}return Q()(t,e),W()(t,[{key:"init",value:function(){var e=this;ke()(K()(t.prototype),"init",this).call(this),this._material.setTexture("_MainTexture",this._mainTexture);var n=Qt.a.mobile?"./mountain_4k.jpg":"./mountain_8k.jpg";Ve.loadImage(fn.getImgUrl(n),function(t){e._mainTexture.setImage(t),e._material.setTexture("_MainTexture",e._mainTexture)})}}]),t}(function(){function e(t,n,i){G()(this,e),this._useDetailTexture=i,this._renderer=t,i&&(this._detailTexture=new un(this._renderer,n,fn.getImgUrl("./detail.png"),!0,!0,!1,!1))}return W()(e,[{key:"init",value:function(){this._useDetailTexture&&this._material.setTexture("_Detail",this._detailTexture)}},{key:"update",value:function(e,t){}},{key:"getMaterial",value:function(){return this._material}},{key:"getUVMaterial",value:function(){return this._material}}]),e}()),qn=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kt.DEPTH_UINTSHORT;return G()(this,t),(n=X()(this,K()(t).call(this,e,a,!1,!1,!0))).setTextureSize(i,r),n}return Q()(t,e),t}(Zt),ei=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kt.RGBA_UNSIGNED_BYTE,s=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5]),o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];G()(this,t),(n=X()(this,K()(t).call(this,e,a,!1,s,o))).renderBuffer=null,n.colorFramebuffer=null,n.scaleToCanvas=!1,n.sizeMultiplier=1,n.frameBufferComplete=!1,n.aaSamples=4,n.setTextureSize(i,r);var h=n.renderer.context;return n.frameBuffer=h.createFramebuffer(),h.bindFramebuffer(h.FRAMEBUFFER,n.frameBuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,n.textureGL,0),n.frameBufferComplete=n.testBuffer(),l?n.createDepthBuffer(i,r):u&&n.createStencilBuffer(i,r),n}return Q()(t,e),W()(t,[{key:"addMultisampleRenderBuffer",value:function(){if(this.renderer instanceof Yt){var e=this.renderer.context;this.colorFramebuffer=e.createFramebuffer(),this.renderBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,this.aaSamples,this.internalFormat,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,this.renderBuffer),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,this.colorFramebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.textureGL,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}}},{key:"resolveMultisampleBuffer",value:function(){if(this.renderer instanceof Yt&&this.renderBuffer){var e=this.renderer.context;e.bindFramebuffer(e.READ_FRAMEBUFFER,this.frameBuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this.colorFramebuffer),e.clearBufferfv(e.COLOR,0,[0,0,0,1]),e.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,e.COLOR_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}}},{key:"testBuffer",value:function(){var e=this.renderer.context;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer);var t=e.checkFramebufferStatus(e.FRAMEBUFFER);switch(t){case e.FRAMEBUFFER_COMPLETE:return!0;case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT",this.formatType),!1;case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",this.formatType),!1;case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS",this.formatType),!1;case e.FRAMEBUFFER_UNSUPPORTED:return console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED",this.formatType),!1;default:return console.log("Incomplete framebuffer: "+t,this.formatType),!1}}},{key:"setTexture3DSlice",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.renderer.context;i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer),i.framebufferTextureLayer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,e.textureGL,n,t)}},{key:"addDepthTexture",value:function(){this.renderer.extensionManager.depth_texture?this.setDepthTexture(new qn(this.renderer,this.width,this.height)):console.log("addDepthTexture: extension not supported")}},{key:"setDepthTexture",value:function(e){e.setTextureSize(this.width,this.height),this.depthTexture=e;var t=this.renderer.context;t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.depthTexture.textureGL,0)}},{key:"createDepthBuffer",value:function(e,t){var n=this.renderer.context;this.depthBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer)}},{key:"createDepthStencilBuffer",value:function(e,t){var n=this.renderer.context;this.depthBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer)}},{key:"createStencilBuffer",value:function(e,t){var n=this.renderer.context;this.stencilBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.stencilBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.STENCIL_INDEX8,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.STENCIL_ATTACHMENT,n.RENDERBUFFER,this.stencilBuffer)}},{key:"setAsTarget",value:function(){var e=this.renderer.context;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),this.depthBuffer?this.renderer.renderState.setDepthMask(!0):this.depthTexture?this.renderer.renderState.setDepthMask(!0):this.renderer.renderState.setDepthMask(!1)}},{key:"setTextureSize",value:function(e,n){if(e!==this.width||n!==this.height){if(this.depthBuffer){var i=this.renderer.context;i.bindRenderbuffer(i.RENDERBUFFER,this.depthBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,n),i.bindRenderbuffer(ot.RENDERBUFFER,null)}if(this.stencilBuffer){var r=this.renderer.context;r.bindRenderbuffer(r.RENDERBUFFER,this.stencilBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.STENCIL_INDEX8,e,n),r.bindRenderbuffer(ot.RENDERBUFFER,null)}if(this.renderBuffer){var a=this.renderer.context;a.bindRenderbuffer(a.RENDERBUFFER,this.renderBuffer),a.renderbufferStorageMultisample(a.RENDERBUFFER,this.aaSamples,this.internalFormat,e,n),a.bindRenderbuffer(ot.RENDERBUFFER,null)}this.depthTexture&&this.depthTexture.setTextureSize(e,n),ke()(K()(t.prototype),"setTextureSize",this).call(this,e,n)}}},{key:"getData",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ke()(K()(t.prototype),"getData",this).call(this,this.frameBuffer)}},{key:"getDataRef",value:function(e){var t=this.renderer.context;t.bindFramebuffer(ot.FRAMEBUFFER,this.frameBuffer),t.readPixels(0,0,this.width,this.height,this.format,this.type,e),t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"getPixelU8",value:function(e,t){var n=this.renderer.context;n.bindFramebuffer(ot.FRAMEBUFFER,this.frameBuffer);var i=new Uint8Array(4);return n.readPixels(e,t,1,1,ot.RGBA,ot.UNSIGNED_BYTE,i),n.bindFramebuffer(n.FRAMEBUFFER,null),i}},{key:"getPixel",value:function(e,t){var n,i=this.renderer.context;switch(i.bindFramebuffer(ot.FRAMEBUFFER,this.frameBuffer),this.formatType){case Kt.RGBA_FLOAT:n=new Float32Array(4);break;case Kt.RGBA_UNSIGNED_BYTE:n=new Uint8Array(4);break;case Kt.LUMINANCE_UNSIGNED_BYTE:n=new Uint8Array(1);break;case Kt.LUMINANCE_FLOAT:n=new Float32Array(1);break;default:throw new Error("Can not yet get data for format type: "+this.formatType)}return i.readPixels(e,t,1,1,this.format,this.type,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}},{key:"destruct",value:function(){var e=this.renderer.context;this.frameBuffer&&(e.deleteFramebuffer(this.frameBuffer),delete this.frameBuffer),this.colorFramebuffer&&(e.deleteFramebuffer(this.colorFramebuffer),this.colorFramebuffer=null),this.depthBuffer&&(e.deleteRenderbuffer(this.depthBuffer),delete this.depthBuffer),this.stencilBuffer&&(e.deleteRenderbuffer(this.stencilBuffer),delete this.stencilBuffer),this.renderBuffer&&(e.deleteRenderbuffer(this.renderBuffer),this.renderBuffer=null),this.depthTexture&&(this.depthTexture.destruct(),delete this.depthTexture),ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Zt),ti=function(){function e(t,n){G()(this,e),this._endTexture=[],this._newSnowTime=0,this._frame=0,this._lastUpdate=0,this._lastCameraPosition=new Le,this._tmpVec4=new rt,this._tmpVec3=new Le,this._maskHeadFade=0,this._maskFade=0,this._maskZoom=1,this._currentEndScreen=void 0,this._targetEndScreen=void 0,this._endScreenProgress=0,this._endScreenDuration=1,this._hotspotOpenFade=0,this._renderer=t,this._material=sn.loadMaterial(t,n,"hud"),this._material.setPreMultipliedAlphaBlending(),this._material.depthTest=!1,this._endscreenMaterial=sn.loadMaterial(t,n,"hud",["ENDSCREEN"]),this._endscreenMaterial.setPreMultipliedAlphaBlending(),this._endscreenMaterial.depthTest=!1,this._snowBufferMaterial=sn.loadMaterial(t,n,"snowBuffer"),this._snowBuffer0=new ei(t,512,256,Kt.RGBA_UNSIGNED_BYTE,!1,!0,!1),this._snowBuffer1=new ei(t,512,256,Kt.RGBA_UNSIGNED_BYTE,!1,!0,!1),this._cloudTexture=new un(this._renderer,n,fn.getImgUrl("./clouds.jpg"),!0,!0,!1,!1),this._maskTexture=new un(this._renderer,n,fn.getImgUrl("./us_ariforce_mask_small.png"),!0,!0,!0,!1),this._endTexture[0]=new un(this._renderer,n,fn.getImgUrl("./endscreen/outro_1.png"),!0,!0,!0,!1),this._endTexture[1]=new un(this._renderer,n,fn.getImgUrl("./endscreen/outro_2.png"),!0,!0,!0,!1),this._endTexture[2]=new un(this._renderer,n,fn.getImgUrl("./endscreen/outro_3.png"),!0,!0,!0,!1)}return W()(e,[{key:"init",value:function(e){var t=e.addGroup("Hud",[this._material,this._endscreenMaterial]);return t.addShaderParamFloat("_FlareStrength",.5,0,1),this._snowFrequency=t.addParamFloat("_SnowFrequency",2,0,10),t.addShaderParamFloat("_SnowStrength",.5,0,2),t.addShaderParamFloat("_SnowDarkness",0,0,1),t}},{key:"setEndScreenMat",value:function(e){var t=this._endscreenMaterial;t.setTexture("_EndScreen",this._endTexture[e]),t.setFloat("_EndScreenPos",e===ii.END_SCREEN_1?-1:e===ii.END_SCREEN_2?1:0)}},{key:"setEndScreenTargetMat",value:function(e){var t=this._endscreenMaterial;t.setTexture("_EndScreenTarget",this._endTexture[e]),t.setFloat("_EndScreenPosTarget",e===ii.END_SCREEN_1?-1:e===ii.END_SCREEN_2?1:0)}},{key:"showEndScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==this._targetEndScreen&&(this.setEndScreenMat(this._targetEndScreen),void 0===e&&this.setEndScreenTargetMat(this._targetEndScreen)),void 0!==e&&(this.setEndScreenTargetMat(e),void 0===this._targetEndScreen&&this.setEndScreenMat(e)),this._currentEndScreen=this._targetEndScreen,this._targetEndScreen=e,this._endScreenProgress=0,this._endScreenDuration=Math.max(.1,t)}},{key:"getMaterials",value:function(){return[this._material,this._endscreenMaterial]}},{key:"update",value:function(e,t,n,i,r){this._maskFade=e===we.INTRO_3?Ve.clamp01(4*t-2):e===we.START?Ve.clamp01(1-4*t):0,this._maskZoom=e===we.START?Ve.clamp01(1-4*t):1,this._maskHeadFade=e===we.INTRO_3?Ve.clamp01(4*t-3):1;var a=tt.getInstance().deltaTime;if(this._endScreenProgress=Ve.clamp01(this._endScreenProgress+a/this._endScreenDuration),this._hotspotOpenFade=Ve.clamp01(this._hotspotOpenFade+(r?2*a:-2*a)),!(i-this._lastUpdate<.05)){this._tmpVec3.copy(n.getWorldPosition()),this._tmpVec3.subtract(this._lastCameraPosition),this._lastCameraPosition.copy(n.getWorldPosition()),this._lastUpdate=i,this._frame++;var s=1+100*this._tmpVec3.length();i>this._newSnowTime?(this._newSnowTime=i+(.5*Math.random()+.5)/(this._snowFrequency.getValue()*s),this._tmpVec4.setValues(Math.random(),Math.random(),Math.random(),Math.random()),this._snowBufferMaterial.setFloat("_NewSnow",1),this._snowBufferMaterial.setVector4("_SnowCoordinate",this._tmpVec4)):this._snowBufferMaterial.setFloat("_NewSnow",0),this._snowBufferMaterial.setFloat("_Aspect",this._renderer.getAspect()),this._snowBufferMaterial.setFloat("_MoveX",-1*Le.dot(n.getWorldRight(),this._tmpVec3)),this._snowBufferMaterial.setFloat("_MoveY",-1*Le.dot(n.getWorldUp(),this._tmpVec3)),this._snowBufferMaterial.setTexture("_SnowTexture",this._cloudTexture),this._renderer.blit(this.ping(),this.pong(),this._snowBufferMaterial)}}},{key:"ping",value:function(){return 0===(1&this._frame)?this._snowBuffer0:this._snowBuffer1}},{key:"pong",value:function(){return 0===(1&this._frame)?this._snowBuffer1:this._snowBuffer0}},{key:"draw",value:function(e,t){var n=1;void 0===this._targetEndScreen&&(n*=1-this._endScreenProgress),void 0===this._currentEndScreen&&(n*=this._endScreenProgress);var i=n>0&&t===we.END_SEQUENCE_END,r=i?this._endscreenMaterial:this._material;i||(this._endScreenProgress=1),r.setVector3("_Forward",e.getWorldForward()),r.setFloat("_Aspect",this._renderer.getAspect()),r.setMatrix("_View",e.getViewMatrix()),r.setMatrix("_Projection",e.getProjectionMatrix()),r.setTexture("_SnowBuffer",this.pong()),r.setFloat("_FadeToBlue",this._hotspotOpenFade),i?(r.setVector2("_Hover",e.getHover()),r.setFloat("_EndScreenProgress",this._endScreenProgress),r.setFloat("_EndScreenFade",n)):(r.setFloat("_MaskHeadFade",this._maskHeadFade),r.setFloat("_MaskFade",this._maskFade),r.setFloat("_MaskZoom",this._maskZoom*this._maskZoom),r.setTexture("_MaskTexture",this._maskTexture)),this._renderer.blit(null,null,r)}}]),e}(),ni=function(){function e(t,i,r,a){G()(this,e),this._materials=[],this._rootTransform=new Lt,this._chapter=0,this._progress=0,this._transformMap={},this._tempVec0=new Le,this._tempVec1=new Le,this._paused=!1,this._initCallback=null,this._initWarmupFrames=5,this._requestId=0,this._initialized=!1,this._instantJump=!0,this._hotspotOpen=!1,fn.detectWebpSupport(function(){}),e.DEBUG_MODE=a,et.ENABLED=e.DEBUG_MODE,(Qt.a.mobile||Qt.a.tablet)&&(e.USE_DETAIL_TEXTURE=!1),this._app=r,this._canvasManager=new Ze(t,!0),this._canvasManager.setPixelRatio(1),this._renderer=new Ft(i,this._canvasManager.getCanvas(),n(515),!0),this._renderer.extensionManager.shader_texture_lod||(e.USE_DETAIL_TEXTURE=!1,e.USE_NORMAL_TEXTURE_FALLBACK=!0),this._camera=new Qn(this._renderer),this._sky=new _n(this._renderer,i),this._snow=new on(this._renderer,i),this._hud=new ti(this._renderer,i),this._megaTexture=new Zn(this._renderer,i,e.USE_DETAIL_TEXTURE),this._mountainMesh=new nn(this._renderer,i,n.e(2).then(n.t.bind(null,581,3)),this._megaTexture),this._cube=new rn(this._renderer),this._backgroundMaterial=sn.loadMaterial(this._renderer,i,"background"),this._scene=new On(this._renderer,i,n.e(1).then(n.t.bind(null,582,3))),this._timeline=new Ln(this._renderer,i,n.e(4).then(n.t.bind(null,583,3))),this._transformAnimator=new Un,this._presetManager=new pn(this._renderer,i,[],"presets.txt",e.DEBUG_MODE),this._presetsTimeLine=new Jn(i,this._presetManager),this._rootTransform.setScaleScalar(.1),e.DEBUG_MODE&&(this._datGui=new $e(i))}return W()(e,[{key:"init",value:function(t){var n=this;if(this._initCallback=t,!this._initialized){this._initialized=!0;var i=new je;i.init("controls",this._sky.getMaterial());var r=i.addGroup("General");this._playAnimation=r.addParamBool("_PlayAnimation",e.PLAY_ANIMATION);var a=this._scene.init(i,this._camera,this._app).params;this._materials=[this._sky.getMaterial()].concat(F()(this._hud.getMaterials()),[this._backgroundMaterial,this._megaTexture.getMaterial(),this._snow.getMaterial()],F()(this._scene.getMaterials()));var s=i.addGroup("PostProcess",this._materials);s.addShaderParamFloat("_GroundBoost",1,0,4),this._exposure=s.addShaderParamFloat("_Exposure",1,0,2),s.addShaderParamFloat("_NoiseStrength",.1,0,1),s.addShaderParamFloat("_Saturation",1),s.addShaderParamFloat("_Black",.001,-.5,.5),s.addShaderParamFloat("_White",.001,-.5,.5),s.addShaderParamFloat("_Gamma",2),s.addShaderParamFloat("_Contrast",.4,0,1),s.addShaderParamFloat("_Vignette",.7);var o=i.addGroup("Global",this._materials);this._fogA=o.addShaderParamFloat("_FogA",.04,1e-5,.5),this._fogB=o.addShaderParamFloat("_FogB",.09,1e-5,.5),s.addButton("NO_ENDSCREEN",function(){n.showEndScreen(void 0)}),s.addButton("ENDSCREEN_1",function(){n.showEndScreen(ii.END_SCREEN_1)}),s.addButton("ENDSCREEN_2",function(){n.showEndScreen(ii.END_SCREEN_2)}),s.addButton("ENDSCREEN_3",function(){n.showEndScreen(ii.END_SCREEN_3)}),this._camera.init(i),a=(a=(a=a.concat(this._hud.init(i).params)).concat(s.params)).concat(o.params),this._renderer.init(),this._renderer.setClearColor(0,0,0,1),this._mountainMesh.init(),this._megaTexture.init(),a=(a=a.concat(this._sky.init(i).params)).concat(this._snow.init(i).params),this._rootTransform.addChild(this._mountainMesh.getRootTransform()),this._rootTransform.addChild(this._scene.getRootTransform()),this._rootTransform.addChild(this._camera.getLogTransform()),this._presetManager.init(i,a),this._timeline.setTransforms(this._scene.getTransforms()),this._camera.getTransform().setParent(this._timeline.getCameraTransform()),this._transformAnimator.setTransforms(this._scene.getTransforms()),this._datGui&&(this._datGui.init(i),this.createTimelineIndex()),this.setProgress(0,0),this._timeline.animate(this._chapter,this._progress,!1),this._presetsTimeLine.setProgress(this._chapter,this._progress),this._camera.copyAnimatedPosToDebugCamera();var l=this._scene.getTransforms();for(var u in l)this._transformMap[l[u].name]=l[u];this._canvasManager.forceResize(),this.update(!0)}}},{key:"createTimelineIndex",value:function(){var e=this,t=new je;t.init("Timeline");for(var n=function(n){t.addButton(we[n],function(){e.setProgress(n,0),e._timeline.animate(e._chapter,e._progress,!1),e._presetsTimeLine.setProgress(e._chapter,e._progress),e._camera.copyAnimatedPosToDebugCamera()})},i=0;i<we.LENGTH;i++)n(i);(new $e).init(t)}},{key:"setUniforms",value:function(e,t){this._tempVec0.setValues(.3,.1+.1*this._exposure.getValue(),.3).normalize();for(var n=0;n<t.length;n++){var i=t[n];i.setVector3("_CamPos",e.getWorldPosition()),i.setVector2("_Resolution",this._renderer.getRenderSize()),i.setFloat("_Time",tt.getInstance().time%1e3),i.setFloat("_Aspect",this._renderer.getAspect()),i.setFloat("_FogC",this._fogA.getValue()/this._fogB.getValue()),i.setVector3("_LightDir",this._tempVec0)}}},{key:"setHotspotOpen",value:function(e){this._hotspotOpen=e}},{key:"setProgress",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._progress=Ve.clamp01(t),this._chapter=e,this._instantJump=this._instantJump||n}},{key:"showEndScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._hud.showEndScreen(e,t)}},{key:"play",value:function(){this._paused=!1}},{key:"pause",value:function(){this._paused=!0}},{key:"update",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._requestId&&window.cancelAnimationFrame(this._requestId),this._requestId=window.requestAnimationFrame(function(){return t.update()}),this._paused&&!n||(et.logToScreen(this._chapter+": "+we[this._chapter]+"<br>"+this._progress.toFixed(2)),this._canvasManager.forceResize(),this._renderer.clearDepth(),this._initWarmupFrames--,0===this._initWarmupFrames&&(this._initCallback&&this._initCallback(),this._initCallback=null),this._chapter!==we.DROP_OFF&&this._chapter!==we.CRASH_1&&this._chapter!==we.PICK_UP_2_1&&this._chapter!==we.END_SEQUENCE_START||this.setHotspotOpen(this._progress<=.025),this._chapter===we.WAIT_FOR_HELI_2_3&&this.setHotspotOpen(this._progress>=.975),e.DEBUG_MODE?(this._camera.update(this._playAnimation.getValue()),this._playAnimation.getValue()?(this._progress+=.2*tt.getInstance().deltaTime,this._progress>1&&(this._progress=0,this._chapter++),this._chapter>=this._timeline.getNumIntervals()&&(this._chapter=this._timeline.getNumIntervals()-1,this._progress=1),this._timeline.animate(Math.max(0,this._chapter),this._chapter<0?0:this._progress),this._camera.setDirty(),this._presetsTimeLine.setProgress(Math.max(0,this._chapter),this._chapter<0?0:this._progress)):this._presetManager.update(!1)):(this._camera.update(!0),this._timeline.animate(this._chapter,this._progress,!this._instantJump),this._instantJump=!1,this._camera.setDirty(),this._presetsTimeLine.setProgress(this._chapter,this._progress),this._presetManager.update(!1)),this._transformAnimator.update(tt.getInstance().time),this._megaTexture.update(this._camera,function(e){t._mountainMesh.draw(t._camera,t._megaTexture.getUVMaterial())}),this.setUniforms(this._camera,this._materials),this._sky.draw(this._camera),this._mountainMesh.draw(this._camera),this._scene.update(this._chapter,this._progress,this._camera,this._hotspotOpen),this._scene.draw(this._chapter,this._progress,this._camera,tt.getInstance().time),this._backgroundMaterial.setMatrix("_ViewProjection",this._camera.getViewProjection()),this._renderer.draw(this._cube,this._backgroundMaterial),this._snow.draw(this._camera),this._hud.update(this._chapter,this._progress,this._camera,tt.getInstance().time,this._hotspotOpen),this._hud.draw(this._camera,this._chapter),this._scene.drawHotspots(this._chapter,this._progress,this._camera,tt.getInstance().time))}}]),e}();ni.USE_DETAIL_TEXTURE=!0,ni.USE_NORMAL_TEXTURE_FALLBACK=!0,ni.DEBUG_MODE=!1,ni.PLAY_ANIMATION=!1;var ii,ri=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).call(this)))._loadsRequested=[],e._loadsCompleted=0,e._progress=0,e._isLoading=!1,e._callbackPerPreloadable=[],e._locked=!1,e}return Q()(t,e),W()(t,[{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._loadsRequested.push(e)-1;return this._callbackPerPreloadable.push(t),this.isLoading()&&this.startLoader(n),e}},{key:"load",value:function(e,t){this._callback=e,this._progressCallBack=t,this.loadAll()}},{key:"lock",value:function(){this._locked=!0}},{key:"unlock",value:function(){this._locked&&(this._locked=!1,this.loadAll())}},{key:"isLoading",value:function(){return this._isLoading}},{key:"loadAll",value:function(){if(!this._locked){if(this._isLoading=!0,0===this._loadsRequested.length)return void this.loadDoneCallback();for(var e=0;e<this._loadsRequested.length;e++)this.startLoader(e)}}},{key:"setCallbackForPreloadable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._callbackPerPreloadable[this.getIndexOfPreloadable(e)]=t}},{key:"getIndexOfPreloadable",value:function(e){return this._loadsRequested.indexOf(e)}},{key:"startLoader",value:function(e){var t=this;this._loadsRequested[e].load(function(){var n=t._callbackPerPreloadable[e];n&&n(),t.loadDoneCallback()})}},{key:"loadDoneCallback",value:function(){this._loadsCompleted++,this._progress+=(1-this._progress)/(1+this._loadsRequested.length-this._loadsCompleted),this._progressCallBack&&(this._loadsRequested.length?this._progressCallBack.call(this,this._progress):this._progressCallBack.call(this,1)),this._loadsCompleted>=this._loadsRequested.length&&(this._isLoading=!1,this._callback&&(this._callback.call(this),this._callback=null))}},{key:"destruct",value:function(){this._callback=null,ke()(K()(t.prototype),"destruct",this).call(this)}}]),t}(Me),ai=n(49),si=n.n(ai);!function(e){e[e.END_SCREEN_1=0]="END_SCREEN_1",e[e.END_SCREEN_2=1]="END_SCREEN_2",e[e.END_SCREEN_3=2]="END_SCREEN_3"}(ii||(ii={}));var oi=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).apply(this,arguments)))._isInitialized=!1,e}return Q()(t,e),W()(t,[{key:"setup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new ri;return this._app||(this._app=new ni(e,n,this,t)),n}},{key:"init",value:function(e){this._app&&!this._isInitialized&&(this._app.init(e),this._isInitialized=!0)}},{key:"play",value:function(){this._app&&this._app.play()}},{key:"pause",value:function(){this._app&&this._app.pause()}},{key:"showEndScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._app&&this._isInitialized&&this._app.showEndScreen(e,t)}},{key:"setProgress",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._app&&this._isInitialized&&this._app.setProgress(e,t,n)}},{key:"setHotspotOpen",value:function(e){this._app&&this._isInitialized&&this._app.setHotspotOpen(e)}},{key:"preloader",get:function(){return this._webGLPreloader}}]),t}(si.a),li=null,ui=function(){return li||(li=new oi),li},hi=n(27),ci=n.n(hi),di=function(e){function t(e,n,i,r,a){var s;return G()(this,t),(s=X()(this,K()(t).call(this,e,i,r,a))).data=n,s}return Q()(t,e),W()(t,[{key:"clone",value:function(){return new t(this.type,this.data,this.bubbles,this.cancelable)}}]),t}(Fn.a);di.START=Mn.EVENT_TYPE_PLACEHOLDER,di.END=Mn.EVENT_TYPE_PLACEHOLDER,Object(Mn.generateEventTypes)({WebGLEvent:di});var fi=di,_i=function(){function e(t){G()(this,e),this.timelines=[],this.animations=[],this.eventDispatcher=new ci.a,this.$webGLApplication=ui()}return W()(e,[{key:"setProgress",value:function(e,t){this.$webGLApplication.setProgress(e,t)}},{key:"at",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!1;this.eventDispatcher.addEventListener(e,function(e){Math.round(100*e.data.progress)!==100*n||i||(i=!0,t())})}},{key:"playAnimation",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r={value:0},a=new Promise(function(i){n.activeAnimation=J.TweenMax.to(r,n.timelines[e].duration,{value:t,onUpdate:function(){n.timelines[e].timeline.progress(r.value)},ease:J.Linear.easeNone,onComplete:i})});return i?a:this.activeAnimation}},{key:"animateProgress",value:function(e,t,n){var i=this,r={value:0};return J.TweenMax.to(r,n,{value:t,onStart:function(){i.eventDispatcher.dispatchEvent(new fi(e,{progress:0}))},onUpdate:function(){i.eventDispatcher.dispatchEvent(new fi(e,{progress:r.value})),i.setProgress(e,r.value)},ease:J.Linear.easeNone})}},{key:"setupAnimations",value:function(){var e=this;this.animations.forEach(function(t){var n=t.from,i=Object.assign({},t);for(i.duration=0,i.timeline=new J.TimelineMax({paused:!0});n<=t.to;)i.duration+=Se[n].duration,i.timeline.add(e.animateProgress(Re[Re[n]],1,Se[n].duration)),n+=1;e.timelines.push(i),e.setProgress(e.animations[0].from,0)})}}]),e}();be()(_i);var pi=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.INTRO_0,to:Re.INTRO_3}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){return this.start()}},{key:"start",value:function(){return this.playAnimation(0,1)}}]),t}(_i),vi=function e(t){G()(this,e),this.story=t};be()(vi);var mi=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(we.INTRO_1,function(){var t=new J.TimelineMax;t.add(e.showStep1),t.add(e.showStep2,5),t.add(e.showStep3,10),t.add(e.showStep4,15)}),n}return Q()(t,e),t}(vi),gi=n(26),Ai=function(){function e(t){G()(this,e),this.fadeInDuration=2,this.volume=1,this.volumeProp={value:0},this.options=t,this.options&&this.options.volume&&(this.volume=this.options.volume),this.configManager=R(S),this.$versionRoot=this.configManager.getVariable(E.VERSIONED_STATIC_ROOT)}return W()(e,[{key:"play",value:function(e,t,n){n&&n.volume&&(this.volume=n.volume),n&&n.fadeIn&&(this.fadeInDuration=n.fadeIn),e&&(this.sound&&this.sound.stop(),this.sound=new gi.Howl(Object.assign({src:["".concat(this.$versionRoot).concat(e)],volume:0},this.options,n))),this.sound&&(this.sound.on("end",t),this.sound.play(),this.setVolume(this.volume,n))}},{key:"setVolume",value:function(e,t){var n=this;this.sound&&(J.TweenMax.killTweensOf(this.volumeProp),this.volumeProp.value=this.sound.volume(),J.TweenMax.to(this.volumeProp,t&&t.duration?t.duration:1,{value:e,onUpdate:function(){n.sound.volume(n.volumeProp.value)},onComplete:t&&t.cb?t.cb:void 0}))}},{key:"pause",value:function(e){var t=this,n=e.fadeDuration,i=void 0===n?1:n;this.paused=!0,this.sound&&this.setVolume(0,{duration:i,cb:function(){t.sound.pause()}})}},{key:"mute",value:function(){this.sound&&this.setVolume(0)}},{key:"unmute",value:function(){this.sound&&this.setVolume(this.volume)}}]),e}(),yi=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this))).filtered=!1,n.sound=new Ai(e),n}return Q()(t,e),W()(t,[{key:"play",value:function(e,t){var n=this,i=!0;return t&&t.filtered&&(i=t.filtered),new Promise(function(r){n.sound.play(e,r,Object.assign({},t)),n.filtered&&i&&n.filter()})}},{key:"pause",value:function(e){this.sound.pause(e)}},{key:"mute",value:function(){this.sound.mute()}},{key:"unmute",value:function(){this.sound.unmute()}},{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this.filtered=!0,this.oldVolume=this.sound.volume,this.sound.paused||this.sound.setVolume(this.sound.volume*e)}},{key:"unfilter",value:function(){this.filtered=!1,this.sound.paused||this.sound.setVolume(this.oldVolume)}}]),t}(ci.a),Ei="sound/music/airforce_intro_music_.mp3",Ti=[Ei],Ci=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),t}(yi),wi={name:"Intro",components:{IntroEvents:mi},extends:ye,beforeDestroy:function(){this.animation&&this.animation.activeAnimation&&(this.animation.activeAnimation.pause(),this.animation.activeAnimation.kill())},methods:{transitionIn:function(e){this.transitionController=new Ae(this),this.animation=new pi(this),this.events=new mi(this),this.transitionController.transitionIn(!0),this.canScroll=!0,this.$audio.music.play(Ei),this.animation.playStep1().then(function(){V.a.go("/landing")}),e()},skipIntro:function(){this.animation&&this.animation.activeAnimation&&(this.animation.activeAnimation.pause(),this.animation.activeAnimation.kill()),this.$webGLApplication.setProgress(we.START,0,!0),V.a.go("/landing")},showStep1:function(){this.$refs.step1.classList.add(this.$style.show),this.transitionController.showStep1()},showStep2:function(){this.transitionController.hideStep(this.$refs.step1),this.$refs.step2.classList.add(this.$style.show),this.transitionController.showStep2()},showStep3:function(){this.transitionController.hideStep(this.$refs.step2),this.$refs.step3.classList.add(this.$style.show),this.transitionController.showStep3()},showStep4:function(){this.transitionController.hideStep(this.$refs.step3),this.$refs.step4.classList.add(this.$style.show),this.transitionController.showStep4()},transitionOut:function(e){e()},resize:function(){}}},Ri=n(141);var Si=Object(d.a)(wi,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["chapter",e.$style.intro]},[n("div",{ref:"step1",class:[e.$style.step,e.$style.step1]},[n("div",{class:e.$style.step1Copy},[n("small",{ref:"tag",staticClass:"tag"},[n("span",[e._v("\n          August 2010\n        ")])]),e._v(" "),n("h3",{ref:"copy1",class:e.$style.copy},[e._v("a civilian plane carrying"),n("br"),e._v("five people")]),e._v(" "),n("span",{ref:"border1",class:e.$style.border})])]),e._v(" "),n("div",{ref:"step2",class:[e.$style.step,e.$style.step2]},[n("h5",{ref:"copy2",class:e.$style.copy},[e._v("crashed at 8,500ft in"),n("br"),e._v("the Chugach Mountains"),n("br"),e._v("of Alaska.\n    ")]),e._v(" "),n("span",{ref:"border2",class:e.$style.border})]),e._v(" "),n("div",{ref:"step3",class:[e.$style.step,e.$style.step3]},[n("span",{ref:"border3",class:e.$style.border}),e._v(" "),n("h5",{ref:"copy3",class:e.$style.copy},[e._v("It was up to an air force"),n("br"),e._v("special warfare team"),n("br"),e._v("to save them\n    ")])]),e._v(" "),n("div",{ref:"step4",class:[e.$style.step,e.$style.step4]},[n("p",{ref:"copy4",class:["h3",e.$style.copy]},[e._v("None of them could have imagined how their mission would unfold.\n    ")])]),e._v(" "),n("a",{ref:"skipButton",class:[e.$style.skipButton,"copy-2 alt"],on:{click:e.skipIntro}},[e._v("\n    Skip\n    "),n("Icon",{class:[e.$style.icon],attrs:{name:"fast-forward"}})],1)])},[],!1,function(e){this.$style=Ri.default.locals||Ri.default},null,null);Si.options.__file="Intro.vue";var Ii=Si.exports,bi=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){var i=t.$refs.lineDesktop,r=t.$refs.title,a=t.$refs.label,s=t.$refs.labelSquare,o=t.$refs.copy2;e.fromTo(i,.35,{y:"-400%",transformOrigin:"bottom left"},{y:"-100%",ease:J.Power3.easeInOut},0),e.fromTo(i,.75,{scaleY:3,transformOrigin:"bottom left"},{scaleY:1,ease:J.Power4.easeOut},.3),e.fromTo(s,.5,{autoAlpha:0},{autoAlpha:1},.5),e.add(ge(a,.75),.6),e.add(function(e,t){var n=new te(e,{type:"chars",position:"relative"}),i=t/2,r=new J.TimelineMax;return n.chars.forEach(function(e){var t=i+Math.random()*i,n=1.1*Math.random();r.fromTo(e,t,{scale:2},{scale:1,ease:J.Expo.easeOut},n),r.fromTo(e,t,{autoAlpha:0},{autoAlpha:1},n)}),r}(r,4)),e.add(ge(o,1.3),2.5),e.add(this.getTimeline("cta"),3)}},{key:"setupTransitionOutTimeline",value:function(e,t,n){e.to(t.$el,1,{scale:1.35,autoAlpha:0},.3)}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),xi=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.START,to:Re.START}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){return this.start()}},{key:"start",value:function(){return this.playAnimation(0,1)}}]),t}(_i),ki=function(e){function t(e,n,i,r,a){var s;return G()(this,t),(s=X()(this,K()(t).call(this,e,i,r,a))).data=n,s}return Q()(t,e),W()(t,[{key:"clone",value:function(){return new t(this.type,this.data,this.bubbles,this.cancelable)}}]),t}(Fn.a);ki.NARRATION_START=Mn.EVENT_TYPE_PLACEHOLDER,ki.NARRATION_END=Mn.EVENT_TYPE_PLACEHOLDER,Object(Mn.generateEventTypes)({Audiovent:ki});var Mi=ki,Pi="sound/vo/clean/airforce_main_script_01-01_clean.mp3",Fi="sound/vo/clean/airforce_main_script_03-02_clean.mp3",Ni="sound/vo/clean/airforce_main_script_05-01_clean.mp3",Di="sound/vo/clean/airforce_main_script_06-01_clean.mp3",Oi="sound/hotspots/clean/airforce_hotspot_fuselage_clean.mp3",Li=[Pi,"sound/vo/clean/airforce_main_script_02-01_clean.mp3",Fi,"sound/vo/clean/airforce_main_script_04-01_clean.mp3",Ni,Oi],Ui=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"play",value:function(e){var n=this;return this.dispatchEvent(new Mi(Mi.NARRATION_START)),ke()(K()(t.prototype),"play",this).call(this,e).then(function(){n.dispatchEvent(new Mi(Mi.NARRATION_END))})}}]),t}(yi),Bi="sound/sfx/airforce_heli1_dropoff_loop.mp3",Vi="sound/sfx/airforce_heli2_flyover.mp3",Hi="sound/sfx/airforce_heli2_crash.mp3",Gi="sound/sfx/airforce_heli3_pickup_loop.mp3",zi=[],Wi=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),t}(yi),ji=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(we.START,function(){n.story.$audio.sfx.play(Bi,{loop:!0,volume:.25,fadeIn:4})}),n.story.animation.at(we.START,function(){n.story.$narration.play({name:"Lt Col Jesse Peterson",sound:Pi,subtitles:[{subtitle:"We initially got the call, and zipped out there to see<br>what the problem was, and unfortunately, the weather was<br>too treacherous to land.",at:0},{subtitle:"So we ended up trying to drop supplies to the victims,<br>and those were immediately swallowed up by the storm",at:9.5},{subtitle:"and they disappeared into the crevasses below.",at:16.5},{subtitle:"So we knew right then that we were going to have to go<br>beneath the weather and make our way up to the survivors.",at:19.5},{subtitle:"",at:26}]})}),n}return Q()(t,e),t}(vi),Xi=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupMouseEnterTimeline",value:function(){this.mouseEnterTimeline=new J.TimelineMax({paused:!1});var e=this.parentController.$refs,t=e.hoverBackground,n=e.hoverLabel;this.mouseEnterTimeline.fromTo(t,.01,{autoAlpha:0},{autoAlpha:1},0),this.mouseEnterTimeline.fromTo(t,1,{scaleY:0},{scaleY:1,ease:J.Expo.easeOut},0),this.mouseEnterTimeline.fromTo(n,.01,{autoAlpha:0},{autoAlpha:1},.2),this.mouseEnterTimeline.fromTo(n,1,{xPercent:50},{xPercent:0,ease:J.Expo.easeOut},.2),this.mouseEnterTimeline.add(ge(n,.6),.2),this.mouseEnterTimeline.paused(!0)}},{key:"onMouseEnter",value:function(){this.mouseLeaveTweens&&this.mouseLeaveTweens.forEach(function(e){e.pause(),e.kill()}),this.mouseEnterTimeline.restart()}},{key:"onMouseLeave",value:function(){var e=this.parentController.$refs,t=e.hoverBackground,n=e.hoverLabel;this.mouseLeaveTweens=[],this.mouseEnterTimeline.pause(),this.mouseLeaveTweens.push(J.TweenLite.to(t,.5,{scaleY:0,ease:J.Power2.easeIn})),this.mouseLeaveTweens.push(J.TweenLite.to(n,.5,{autoAlpha:0,ease:J.Linear.easeNone}))}},{key:"setupTransitionInTimeline",value:function(e,t,n){this.setupMouseEnterTimeline();var i=t.$refs.background,r=t.$refs.label;e.fromTo(t.$el,.01,{autoAlpha:0},{autoAlpha:1},0),e.fromTo(i,.01,{autoAlpha:0},{autoAlpha:1},0),e.fromTo(i,1,{scaleY:0},{scaleY:1,ease:J.Expo.easeOut},0),e.fromTo(r,1,{xPercent:50},{xPercent:0,ease:J.Expo.easeOut},.2),e.add(ge(r,.6),.2)}},{key:"setupTransitionOutTimeline",value:function(e,t,n){var i=t.$el,r=t.$refs,a=r.background,s=r.hoverBackground,o=r.hoverLabel,l=r.label;e.to([s,a],.8,{scaleY:0,ease:J.Expo.easeOut},0),e.to([o,l],.5,{autoAlpha:0,ease:J.Linear.easeNone},0),e.to(i,.01,{autoAlpha:0})}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Yi={name:"CTAButton",extends:O.AbstractTransitionComponent,props:{label:o.a.string.isRequired,link:o.a.string.isRequired,theme:o.a.string,click:o.a.func,target:o.a.string.def("_parent")},methods:{handleAllComponentsReady:function(){this.transitionController=new Xi(this),this.isReady()},onClick:function(e){this.click&&(e.preventDefault(),this.click(e))},mouseOver:function(){this.transitionController.onMouseEnter()},onMouseLeave:function(){this.transitionController.onMouseLeave()}}},Ki=n(142);var $i=Object(d.a)(Yi,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{class:[e.$style.ctaButton,"secondary"===e.theme?e.$style.secondary:""],attrs:{href:e.link,target:e.target},on:{mouseenter:e.mouseOver,mouseleave:e.onMouseLeave,click:e.onClick}},[n("div",{ref:"background",class:e.$style.background}),e._v(" "),n("div",{class:e.$style.labelWrapper},[n("p",{ref:"label"},[e._v(e._s(e.label))])]),e._v(" "),n("div",{ref:"hoverState",class:[e.$style.hoverState]},[n("span",{ref:"hoverBackground",class:[e.$style.background,"abs-fill"]}),e._v(" "),n("p",{ref:"hoverLabel",class:[e.$style.hoverLabel]},[e._v(e._s(e.label))])])])},[],!1,function(e){this.$style=Ki.default.locals||Ki.default},null,null);$i.options.__file="CTAButton.vue";var Qi=$i.exports,Ji=Qi,Zi={name:"Landing",components:{CTAButton:Ji},extends:ye,methods:{transitionIn:function(e){this.transitionController=new bi(this),this.animation=new xi(this),this.events=new ji(this),this.transitionController.transitionIn(!0),this.canScroll=!0,e()},onStart:function(e){e.preventDefault(),this.transitionController.transitionOut(!0),this.$refs.cta.transitionOut(),this.animation.playStep1().then(function(){V.a.go("/rescue")})},transitionOut:function(e){e()},resize:function(){}}},qi=n(143);var er=Object(d.a)(Zi,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["chapter",e.$style.landing]},[n("div",{class:e.$style.content},[n("span",{ref:"lineDesktop",class:e.$style.lineDesktop}),e._v(" "),n("p",{ref:"labelSquare",class:["copy-3",e.$style.label]},[n("span",{ref:"label"},[e._v("\n        U.S. Air force Presents\n      ")])]),e._v(" "),n("h1",{ref:"title",class:e.$style.title},[e._v("\n      Into the Storm\n    ")]),e._v(" "),n("p",{ref:"copy2",class:[e.$style.text,"copy-2"]},[e._v("\n      five civilians. one team."),n("br"),e._v("and a battle against the odds.\n    ")]),e._v(" "),n("CTAButton",{ref:"cta",class:e.$style.cta,attrs:{click:e.onStart,label:"Start the mission",link:"",theme:"secondary"}})],1)])},[],!1,function(e){this.$style=qi.default.locals||qi.default},null,null);er.options.__file="Landing.vue";var tr=er.exports,nr=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.DROP_OFF,to:Re.DROP_OFF},{from:Re.START_TREK_1,to:Re.START_TREK_1}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(e){return this.webglTween=new J.TimelineMax({paused:!0,onComplete:e}),this.webglTween.add(this.playAnimation(0,1,!1)),this.webglTween}},{key:"playStep2",value:function(){return this.startTrek1().then(function(){V.a.go("/trek-to-survivors")})}},{key:"startTrek1",value:function(){return this.playAnimation(1,1)}}]),t}(_i),ir=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(Re.START_TREK_1,function(){n.story.$audio.sfx.pause({fadeDuration:3})},.22),n}return Q()(t,e),t}(vi),rr=i.a.extend({created:function(){this.chapterName=void 0,this.progress={value:0}},methods:{show:function(){this.transitionController.show()},hide:function(){this.transitionController.hide()},reset:function(){},onInteract:function(){},resize:function(){}}}),ar=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"hide",value:function(){this.parentController.$el.style.display="none"}},{key:"show",value:function(){this.parentController.$refs.box;(new J.TimelineMax).add(this.getTimeline("box"))}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),sr=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){this.timelineShow=new J.TimelineMax({paused:!0});var i=this.parentController.$refs,r=i.top,a=i.right,s=i.bottom,o=i.left,l=i.leftLabel,u=i.rightLabel,h=i.tutorialTop,c=i.tutorialRight,d=i.tutorialBottom,f=i.tutorialLeft,_=i.tutorialBackground,p=i.tutorialIcon,v=i.tutorialLabel;this.timelineShow.fromTo(r,.35,{scaleX:0},{scaleX:1,transformOrigin:"top left"}),this.timelineShow.fromTo(a,.35,{scaleY:0},{scaleY:1,transformOrigin:"top left"}),this.timelineShow.fromTo(s,.35,{scaleX:0},{scaleX:1,transformOrigin:"top right"}),this.timelineShow.fromTo(o,.5,{scaleY:0},{scaleY:1,transformOrigin:"bottom left"}),this.timelineShow.add(ge(l,.3),1.5),this.timelineShow.add(ge(u,.3),1.5),this.timelineShow.fromTo(h,.15,{scaleX:0},{scaleX:1,transformOrigin:"top left"},0),this.timelineShow.fromTo(c,.15,{scaleY:0},{scaleY:1,transformOrigin:"top left"},.15),this.timelineShow.fromTo(d,.15,{scaleX:0},{scaleX:1,transformOrigin:"top right"},.3),this.timelineShow.fromTo(f,.15,{scaleY:0},{scaleY:1,transformOrigin:"bottom left"},.45),this.timelineShow.fromTo(_,.3,{autoAlpha:0},{autoAlpha:1},.55),this.timelineShow.fromTo(p,.5,{autoAlpha:0},{autoAlpha:1},.8),this.timelineShow.fromTo(v,.5,{autoAlpha:0},{autoAlpha:1},.8)}},{key:"show",value:function(){this.timelineShow.play()}},{key:"hide",value:function(){(new J.TimelineMax).to(this.parentController.$el,1,{autoAlpha:0})}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),or={name:"InteractionBox",extends:O.AbstractTransitionComponent,props:{leftLabel:o.a.string,rightLabel:o.a.string,tutorialLabel:o.a.string,tutorialIcon:o.a.string},watch:{rightLabel:function(e){this.$refs.rightLabel.innerText=e},leftLabel:function(e){this.$refs.leftLabel.innerText=e}},mounted:function(){this.transitionController=new sr(this)},methods:{show:function(){var e=this;setTimeout(function(){e.transitionController.show()},500)},hide:function(){this.transitionController.hide()}}},lr=n(144);var ur=Object(d.a)(or,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.interactionBox]},[n("div",{class:e.$style.borders},[n("span",{ref:"top",class:e.$style.top}),e._v(" "),n("span",{ref:"right",class:e.$style.right}),e._v(" "),n("span",{ref:"bottom",class:e.$style.bottom}),e._v(" "),n("span",{ref:"left",class:e.$style.left})]),e._v(" "),n("p",{ref:"leftLabel",class:["copy-3","alt",e.$style.leftLabel]},[e._v(e._s(e.leftLabel))]),e._v(" "),n("p",{ref:"rightLabel",class:["copy-3","alt",e.$style.rightLabel]},[e._v(e._s(e.rightLabel))]),e._v(" "),n("div",{class:e.$style.tutorial},[n("div",{class:e.$style.borders},[n("span",{ref:"tutorialTop",class:e.$style.top}),e._v(" "),n("span",{ref:"tutorialRight",class:e.$style.right}),e._v(" "),n("span",{ref:"tutorialBottom",class:e.$style.bottom}),e._v(" "),n("span",{ref:"tutorialLeft",class:e.$style.left})]),e._v(" "),n("div",{ref:"tutorialBackground",class:e.$style.tutorialBackground}),e._v(" "),n("div",{ref:"tutorialIcon",class:[e.$style.tutorialIcon]},[n("Icon",{class:e.$style.icon,attrs:{name:e.tutorialIcon}})],1),e._v(" "),n("p",{ref:"tutorialLabel",class:["copy-2","alt",e.$style.tutorialLabel]},[e._v("\n      "+e._s(e.tutorialLabel)+"\n    ")])])])},[],!1,function(e){this.$style=lr.default.locals||lr.default},null,null);ur.options.__file="InteractionBox.vue";var hr=ur.exports,cr=n(34),dr=n.n(cr),fr=n(145),_r=n.n(fr),pr=function(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof"DocumentTouch")||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))},vr=pr()?"touchmove":"mousemove",mr=pr()?"touchstart":"mousedown",gr=pr()?"touchend":"mouseup",Ar=function(e){if(!pr())return e.pageX;var t=e;return t.changedTouches[t.changedTouches.length-1].clientX},yr=function(e){if(!pr())return e.pageY;var t=e;return t.changedTouches[t.changedTouches.length-1].clientY},Er=function(e){var t,n,i=dr()({},e),r=_r.a.deg2rad(i.maxAngle),a={radius:i.radius||100,x:0,y:0,startAngle:0,endAngle:0,deltaAngle:0},s=0,o=!1,l=!0,u={start:0,end:0};return{setupCanvas:function(e){n=(t=e).getContext("2d"),this.resize(),180===i.maxAngle&&(t.style.transform="translateX(-50%) translateY(-65%)")},draw:function(){n.clearRect(0,0,t.width,t.height),n.lineWidth=2,n.strokeStyle="rgba(255,255,255,0.9)",n.beginPath(),n.setLineDash([10,10]),n.arc(a.radius+10,a.radius+10,a.radius,0,r),n.stroke(),n.lineWidth=4,n.strokeStyle="#ffb702",n.setLineDash([]),n.beginPath(),n.arc(a.radius+10,a.radius+10,a.radius,a.startAngle,a.endAngle),n.stroke();var e=Math.cos(a.endAngle)*a.radius+a.radius+4+5,i=Math.sin(a.endAngle)*a.radius+a.radius+4+5;n.beginPath(),n.arc(e,i,4,0,2*Math.PI),n.fillStyle="#ffb702",n.fill(),n.lineWidth=1,n.strokeStyle="rgba(254,184,8,0.9)",n.arc(e,i,8,0,2*Math.PI),n.stroke()},mouseDown:function(e){var t=e.x,n=e.y;l&&(a.x=window.innerWidth/2,a.y=window.innerHeight/2,o=!0,u.start=Math.atan2(a.y-n,a.x-t))},mouseUp:function(){o=!1,a.deltaAngle=a.endAngle},mouseMove:function(e){var t=e.x,n=e.y;if(!o)return!1;J.TweenMax.killTweensOf(a);var r=parseFloat(Math.atan2(a.y-n,a.x-t)),h=(a.deltaAngle+r-u.start)%(2*Math.PI),c=Math.ceil(_r.a.rad2deg(h));if(c<0&&(c+=360),Math.abs(s-c)>25)return a.endAngle=.01,0;0===s&&0===c?a.endAngle=a.startAngle+.01:(s=c,a.endAngle=h);var d=c/i.maxAngle;return d>.98&&(o=!1,l=!1,d=1),d},show:function(){this.reset();var e=new J.TimelineMax;e.to(t,1,{autoAlpha:1}),e.to(a,1,{endAngle:Math.PI/5,ease:J.Power4.easeOut}),e.to(a,1,{endAngle:0,ease:J.Power4.easeOut}),l=!0},hide:function(){J.TweenMax.to(t,1,{autoAlpha:0}),t.style.display="none",this.reset(),o=!1,l=!1},reset:function(){s=0,a.startAngle=0,a.endAngle=0,a.deltaAngle=0},resize:function(){t.setAttribute("width",2*a.radius+20),t.setAttribute("height",2*a.radius+20)}}},Tr=function(e){var t,n,i=dr()({},e,{speed:1}),r=i.direction||"topBottom",a=i.size||100,s={size:.6*i.parent.offsetHeight,x:0,y:0,start:0,end:"topBottom"===r?0:a,delta:0},o={start:0,end:0},l=!1;return{setupCanvas:function(e){t=e,this.resize(),n=t.getContext("2d")},draw:function(){n.strokeStyle="rgba(255,255,255,0.9)",n.lineWidth=2,n.clearRect(0,0,t.width,t.height),n.beginPath(),n.setLineDash([10,10]),n.moveTo(40,20),n.lineTo(40,s.size+20),n.stroke(),n.strokeStyle="#ffb702",n.beginPath(),n.setLineDash([]);var e=s.end+4;"topBottom"===r?(n.moveTo(40,20),n.lineTo(40,s.end+20)):(e=s.end-4,n.moveTo(40,s.size+20),n.lineTo(40,s.end+20)),n.stroke(),n.beginPath(),n.arc(40,e+20,4,0,2*Math.PI),n.fillStyle="#ffb702",n.fill(),n.lineWidth=1,n.strokeStyle="rgba(254,184,8,0.9)",n.arc(40,e+20,8,0,2*Math.PI),n.stroke()},mouseDown:function(e){var t=e.y;o.start=t,l=!0},mouseUp:function(){s.delta=s.end,l=!1},mouseMove:function(e){var t=e.y;if(!l)return!1;J.TweenMax.killTweensOf(s),s.end=s.delta+(t-o.start)*i.speed,s.end=Math.max(Math.min(s.end,s.size),0);var n=s.end;return"topBottom"!==r&&(n=s.size-s.end),n/s.size},show:function(){var e=.1*s.size,n=0;"topBottom"!==r&&(e=.9*s.size,n=s.size);var i=new J.TimelineMax;i.to(t,1,{autoAlpha:1}),i.to(s,1,{end:e,ease:J.Power4.easeOut}),i.to(s,1,{end:n,ease:J.Power4.easeOut})},hide:function(){l=!1,J.TweenMax.to(t,1,{autoAlpha:0})},resize:function(){s.size=.6*i.parent.offsetHeight,s.end="topBottom"===r?0:s.size,t.setAttribute("width",80),t.setAttribute("height",s.size+40),s.y=t.getBoundingClientRect().top}}},Cr=function(e){var t,n,i=dr()({},e,{speed:1}),r=i.size||100,a={size:.6*i.parent.offsetHeight,x:0,y:0,start:0,end:r,delta:0},s={start:0,end:0},o=!1;return{setupCanvas:function(e){t=e,this.resize(),n=t.getContext("2d")},draw:function(){n.strokeStyle="rgba(255,255,255,0.9)",n.lineWidth=2,n.clearRect(0,0,t.width,t.height),n.beginPath(),n.setLineDash([10,10]),n.moveTo(40,20),n.lineTo(40,a.size+20),n.stroke(),n.strokeStyle="#ffb702",n.beginPath(),n.setLineDash([]);var e=a.size-a.end;n.moveTo(40,a.size+20),n.lineTo(40,e+20),n.stroke(),n.beginPath(),n.arc(40,e+20-4,4,0,2*Math.PI),n.fillStyle="#ffb702",n.fill(),n.lineWidth=1,n.strokeStyle="rgba(254,184,8,0.9)",n.arc(40,e+20-4,8,0,2*Math.PI),n.stroke()},mouseDown:function(e){var t=e.y;s.start=t,o=!0},mouseUp:function(){a.delta=a.end,o=!1},mouseMove:function(e){var t=e.y;return!!o&&(J.TweenMax.killTweensOf(a),a.size=.6*i.parent.offsetHeight,a.end=a.delta-(t-s.start)*i.speed,a.end=Math.max(Math.min(a.end,a.size),0),a.end/a.size)},show:function(){a.size=.6*i.parent.offsetHeight,a.end=0;var e=.1*a.size,n=new J.TimelineMax;n.to(t,1,{autoAlpha:1}),n.to(a,1,{end:e,ease:J.Power4.easeOut}),n.to(a,1,{end:0,ease:J.Power4.easeOut})},hide:function(){o=!1,J.TweenMax.to(t,1,{autoAlpha:0})},resize:function(){a.size=.6*i.parent.offsetHeight,t.setAttribute("width",80),t.setAttribute("height",a.size+40),a.y=t.getBoundingClientRect().top}}},wr=function(e,t,n){var i,r,a=!0,s={value:0},o=function(e){if(!a){var i={x:Ar(e),y:yr(e)};s.value=t.mouseMove(i),n&&s.value&&n(s.value)}},l=function(e){if(!a){var n={x:Ar(e),y:yr(e)};t.mouseUp(n),document.body.removeEventListener(vr,o)}},u=function(e){if(!a){var n={x:Ar(e),y:yr(e)};t.mouseDown(n),document.body.addEventListener(vr,o)}},h=function(){t&&t.resize()};return e.addEventListener(mr,u),document.body.addEventListener(gr,l),window.addEventListener("resize",h),(i=document.createElement("canvas")).style.position="absolute",i.style.opacity="0",i.style.visibility="hidden",i.style.left="50%",i.style.top="50%",i.style.transform="translateX(-50%) translateY(-50%)",e.appendChild(i),t.setupCanvas(i),function e(){r=window.requestAnimationFrame(e),a||t.draw()}(),{dispose:function(){e.removeEventListener(mr,u),document.body.removeEventListener(gr,l),window.removeEventListener("resize",h),window.cancelAnimationFrame(r)},show:function(){a=!1,t.show(),t.resize()},hide:function(){a=!0,t.hide()},resize:function(){t.resize()},reset:function(){t.reset()}}},Rr={name:"DragDownInteraction",components:{InteractionBox:hr},extends:rr,mounted:function(){var e=this;this.transitionController=new ar(this),setTimeout(function(){e.interaction=wr(e.$el,Tr({parent:e.$refs.interaction.$el}),e.onUpdate)},0)},beforeDestroy:function(){this.interaction&&this.interaction.dispose()},methods:{onUpdate:function(e){this.$emit("interact",e)},hide:function(){this.interaction.hide(),this.$refs.interaction.hide()},show:function(){this.interaction.show(),this.$refs.interaction.show()}}},Sr=n(146);var Ir=Object(d.a)(Rr,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.dragDownInteraction]},[t("InteractionBox",{ref:"interaction",attrs:{"left-label":"Day 1","right-label":"00:00 HRS","tutorial-label":"Deploy the team","tutorial-icon":"drag-down"},on:{interact:this.onInteract}})],1)},[],!1,function(e){this.$style=Sr.default.locals||Sr.default},null,null);Ir.options.__file="DragDownInteraction.vue";var br={name:"Rescue",components:{DrawDownInteraction:Ir.exports},extends:ye,methods:{transitionIn:function(e){var t=this;this.animation=new nr(this),this.events=new ir(this),this.$refs.interaction.show(),this.webglTween=this.animation.playStep1(function(){setTimeout(function(){t.animation.playStep2()},2e3)}),e()},transitionOut:function(e){e()},resize:function(){},onInteract:function(e){this.webglTween.progress(e),e>=1&&this.$refs.interaction.hide()}}},xr=n(147);var kr=Object(d.a)(br,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.rescue]},[t("DrawDownInteraction",{ref:"interaction",class:this.$style.interaction,on:{interact:this.onInteract}})],1)},[],!1,function(e){this.$style=xr.default.locals||xr.default},null,null);kr.options.__file="Rescue.vue";var Mr,Pr,Fr,Nr=kr.exports,Dr=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Or=n(115),Lr=n.n(Or),Ur=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){var i=t.$refs,r=i.label,a=i.icon;e.fromTo(r,.5,{autoAlpha:0},{autoAlpha:1,ease:J.Expo.easeOut},0).fromTo(r,.75,{y:-20},{y:0,ease:J.Circ.easeOut},0).fromTo(a,.5,{autoAlpha:0},{autoAlpha:1,ease:J.Expo.easeOut},.1).fromTo(a,.75,{scale:1.1,y:20},{scale:1,y:0,ease:J.Expo.easeOut},.1)}},{key:"setupTransitionOutTimeline",value:function(e,t,n){e.to(t.$el,.35,{autoAlpha:0})}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Br={state:{deviceState:null,applicationLoaded:!1,scrollEnabled:!0,mission:{time:"00:00:00",totalTime:"48:00:00"}},getters:(Mr={},Te()(Mr,"totalTime",function(e){return e.mission.totalTime}),Te()(Mr,"getScrollEnabled",function(e){return e.scrollEnabled}),Mr),mutations:(Pr={},Te()(Pr,"setDeviceState",function(e,t){e.deviceState=t}),Te()(Pr,"setAppLoaded",function(e,t){e.deviceState=t}),Te()(Pr,"setScrollEnabled",function(e,t){e.scrollEnabled=t}),Pr),actions:(Fr={},Te()(Fr,"setDeviceState",function(e,t){(0,e.commit)("setDeviceState",t)}),Te()(Fr,"setAppLoaded",function(e,t){(0,e.commit)("setAppLoaded",t)}),Fr)},Vr={name:"Scroller",props:{label:o.a.string.isRequired,onScroll:o.a.func.isRequired,scrollHeight:o.a.number},computed:{icon:function(){return pr()?"".concat(this.$versionRoot,"image/scroller/swipe.png"):"".concat(this.$versionRoot,"image/scroller/mouse.png")},scrollEnabled:function(){return this.$store.getters.getScrollEnabled}},watch:{scrollEnabled:function(e){this.enableScroll=e}},created:function(){this.enableScroll=this.scrollEnabled,this.scrollingSpeed=1,this.scroll=this.scroll.bind(this),this.targetY=0,this.active=!1},beforeDestroy:function(){this.scroller.on(this.onScroll),this.scroller.destroy()},mounted:function(){this.transitionController=new Ur(this),this.scroller=new Lr.a({keyStep:20,touchMultiplier:pr()?-7:7}),this.scroller.on(this.scroll)},methods:{scroll:function(e){this.active&&this.enableScroll&&(this.targetY+=e.deltaY*this.scrollingSpeed,this.scrollHeight&&(this.targetY=Math.max(-1*this.scrollHeight,this.targetY),this.targetY=Math.min(0,this.targetY)),this.onScroll(Math.abs(this.targetY)/this.scrollHeight))},scrollTo:function(e,t){var n=this;J.TweenMax.to(this,.5,{targetY:-this.scrollHeight*e,onComplete:t,onUpdate:function(){n.onScroll(Math.abs(n.targetY)/n.scrollHeight)}})},transitionIn:function(){this.active=!0,this.transitionController.transitionIn(!0)},transitionOut:function(){this.transitionController.transitionOut()},destroy:function(){this.active=!1},isWindows:function(){return navigator.platform.indexOf("Win")>-1},resize:function(){window.innerWidth<1024?this.scrollingSpeed=6:Qt.a.firefox?this.scrollingSpeed=3:this.isWindows()?this.scrollingSpeed=3:this.scrollingSpeed=1}}},Hr=n(148);var Gr=Object(d.a)(Vr,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.scroller]},[t("span",{ref:"icon",class:this.$style.icon,style:"background: url("+this.icon+") no-repeat top left"}),this._v(" "),t("p",{ref:"label",class:["copy-2","alt"],domProps:{innerHTML:this._s(this.label)}})])},[],!1,function(e){this.$style=Hr.default.locals||Hr.default},null,null);Gr.options.__file="Scroller.vue";var zr=Gr.exports,Wr=zr,jr=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.TREK_1_1,to:Re.TREK_1_2}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"start",value:function(e){return this.webglTween=new J.TimelineMax({paused:!0,onUpdate:e,onComplete:function(){V.a.go("/first-pickup")}}),this.webglTween.add(this.playAnimation(0,1,!1)),this.webglTween}}]),t}(_i),Xr=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(we.TREK_1_1,function(){n.story.$narration.play({name:"CMSgt Alan Lankford",sound:Fi,subtitles:[{subtitle:"The temperature continued to drop.<br>It drops about three degrees per a thousand feet,<br>and the wind created a total white out.",at:0},{subtitle:"It was 60, 70 mile an hour winds, it was a wet snow,<br>and visibility was just heinous.",at:6},{subtitle:"Most of the time, we couldn't even see each other.",at:12.5},{subtitle:"There were times that I would maybe only see half the rope,<br>or it felt like that I could barely see beyond the tips of my skis.",at:15.5},{subtitle:"So navigating around the crevasses was challenging.",at:22},{subtitle:"",at:25}]})}),n}return Q()(t,e),t}(vi),Yr={name:"TrekToSurvivors",components:{Scroller:Wr},extends:ye,beforeDestroy:function(){window.cancelAnimationFrame(this.rAF)},mounted:function(){this.snap=!1,this.transitionController=new Dr(this)},methods:{transitionIn:function(e){this.transitionController.transitionIn(),this.$refs.scroller.transitionIn(),this.animation=new jr(this),this.events=new Xr(this),this.animationTween=this.animation.start(),e(),this.onProgress()},onProgress:function(){this.rAF=window.requestAnimationFrame(this.onProgress.bind(this))},transitionOut:function(e){this.$refs.scroller.destroy(),e()},onScroll:function(e){e>.1&&this.$refs.scroller.transitionOut(),this.active&&(e>.98&&!this.snap?(this.snap=!0,this.animationTween.resume()):this.snap||this.animationTween.progress(e))},resize:function(e){this.$refs.scroller.resize(e)}}},Kr=n(149);var $r=Object(d.a)(Yr,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.trekToSurvivors]},[t("Scroller",{ref:"scroller",class:this.$style.scroller,attrs:{"on-scroll":this.onScroll,"scroll-height":4e4,label:"Scroll<br><strong>to advance</strong>"}})],1)},[],!1,function(e){this.$style=Kr.default.locals||Kr.default},null,null);$r.options.__file="TrekToSurvivors.vue";var Qr=$r.exports,Jr=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Zr=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.CRASH_HELI_1,to:Re.START_TREK_3}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){return this.playAnimation(0,1).then(function(){V.a.go("/last-pickup")})}}]),t}(_i),qr={name:"HelicopterCrash",extends:ye,data:function(){return{sliderHeight:.7*window.innerHeight}},mounted:function(){this.transitionController=new Jr(this)},methods:{transitionIn:function(e){this.animation=new Zr(this),this.animation.playStep1(),this.transitionController.transitionIn(),e()},transitionOut:function(e){e()},resize:function(){}}},ea=n(150);var ta=Object(d.a)(qr,function(){var e=this.$createElement;return(this._self._c||e)("div",{class:["chapter",this.$style.helicopterCrash]})},[],!1,function(e){this.$style=ea.default.locals||ea.default},null,null);ta.options.__file="HelicopterCrash.vue";var na=ta.exports,ia=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.PICK_UP_2_5,to:Re.WAIT_FOR_HELI_2_3},{from:Re.END_SEQUENCE_START,to:Re.END_SEQUENCE_START},{from:Re.END_SEQUENCE_END,to:Re.END_SEQUENCE_END}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){return this.playAnimation(0,1)}},{key:"playStep2",value:function(e){return this.webglTween=new J.TimelineMax({paused:!0,onComplete:e}),this.webglTween.add(this.playAnimation(1,1,!1)),this.webglTween}},{key:"playStep3",value:function(){return this.playAnimation(2,1)}}]),t}(_i),ra=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"hide",value:function(){this.parentController.$el.style.display="none"}},{key:"show",value:function(){this.parentController.$el.style.display="block"}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),aa={name:"DragUpInteraction",components:{InteractionBox:hr},extends:rr,mounted:function(){this.transitionController=new ra(this),this.interaction=wr(this.$el,Cr({parent:this.$refs.interaction.$el}),this.onUpdate)},methods:{onUpdate:function(e){this.$emit("interact",e)},hide:function(){this.interaction.hide(),this.$refs.interaction.hide()},show:function(){this.interaction.show(),this.$refs.interaction.show()}}},sa=n(151);var oa=Object(d.a)(aa,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.dragUpInteraction]},[t("InteractionBox",{ref:"interaction",attrs:{"left-label":"Day 4","right-label":"70:00 HRS","tutorial-label":"Extract the team","tutorial-icon":"drag-down"},on:{interact:this.onInteract}})],1)},[],!1,function(e){this.$style=sa.default.locals||sa.default},null,null);oa.options.__file="DragUpInteraction.vue";var la=oa.exports,ua=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(Re.PICK_UP_2_5,function(){n.story.$narration.play({name:"Lt Col Jesse Peterson",sound:Di,subtitles:[{subtitle:"That evening, the first of our Air Force rescue helicopters<br>made its way to the crash site",at:0},{subtitle:"and we were able to get the mother and two children<br>off the glacier on that first trip",at:5.5},{subtitle:"and the rest of us stayed the night until the rest<br>of the Air Force helicopters were able to get up there<br>and get the rest of us off of the glacier.",at:11},{subtitle:"",at:18}]})}),n.story.animation.at(Re.PICK_UP_2_5,function(){n.story.$audio.sfx.play(Gi,{duration:5,loop:!0})},.8),n.story.animation.at(Re.END_SEQUENCE_START,function(){n.story.$audio.sfx.pause({fadeDuration:7})},.3),n}return Q()(t,e),t}(vi),ha={name:"AirliftOut",components:{DragUpInteraction:la},extends:ye,methods:{transitionIn:function(e){this.interacting=!1,this.animation=new ia(this),this.events=new ua(this),this.animation.playStep1().then(this.pause),this.webglTween=this.animation.playStep2(this.onPickup),e()},transitionOut:function(e){e()},onInteract:function(e){var t=.35*e;e<1&&this.interacting?this.webglTween.progress(t):(this.$refs.interaction.hide(),this.interacting=!1,this.webglTween.resume())},onPickup:function(){this.$audio.music.play("sound/music/airforce_outro_b_music_.mp3"),this.$refs.interaction.hide(),this.animation.playStep3().then(function(){V.a.go("/conclusion")})},pause:function(){this.$refs.interaction.show(),this.interacting=!0}}},ca=n(152);var da=Object(d.a)(ha,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.airliftOut]},[t("DragUpInteraction",{ref:"interaction",class:this.$style.pressHoldButton,attrs:{active:this.active},on:{interact:this.onInteract}})],1)},[],!1,function(e){this.$style=ca.default.locals||ca.default},null,null);da.options.__file="AirliftOut.vue";var fa=da.exports,_a=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.CRASH_1,to:Re.START_TO_PICK_UP_1},{from:Re.TO_PICK_UP_1,to:Re.WAIT_FOR_HELI_1_1},{from:Re.WAIT_FOR_HELI_1_2,to:Re.START_TREK_2}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(e){return this.webglTween=new J.TimelineMax({paused:!0,onComplete:e}),this.webglTween.add(this.playAnimation(0,1,!1)),this.webglTween}},{key:"playEnd",value:function(){return this.tween3=new J.TimelineMax({paused:!0,onComplete:function(){V.a.go("/trek-to-helicopter")}}),this.tween3.add(this.playAnimation(2,1,!1)),this.tween3}},{key:"start",value:function(e){var t=this;return this.tween2=new J.TimelineMax({paused:!0,onUpdate:e,onComplete:function(){t.tween3.play()}}),this.tween2.add(this.playAnimation(1,1,!1)),this.tween2}}]),t}(_i),pa=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).story.animation.at(we.CRASH_1,function(){n.story.$narration.play({name:"Lt Col Jesse Peterson",sound:Oi,subtitles:[{subtitle:"We weren't sure if the fuselage was still intact<br>so we in our minds we kind of pictured the worst",at:0},{subtitle:"that they were freezing in the plane, not having the right clothes to survive the inclement weather.",at:5.5},{subtitle:"Thankfully, the fuselage was still intact so they had used their body heat to stay relatively warm in the crashed airplane. ",at:10.6},{subtitle:"",at:19}]})},0),n.story.animation.at(we.WAIT_FOR_HELI_1_2,function(){n.story.$audio.sfx.play(Vi,{filtered:!1,volume:1})},.5),n.story.animation.at(we.START_TREK_2,function(){n.story.$audio.sfx.play(Hi,{filtered:!1,volume:1})},.19),n.story.animation.at(we.WAIT_FOR_HELI_1_2,function(){n.story.$narration.play({name:"MSgt Christopher Uriarte",sound:Ni,subtitles:[{subtitle:"The following morning came around.<br>A flight of Army UH60s was in the area. ",at:0},{subtitle:"We didn't get visual of that flight until they were<br>about 100 meters above us. ",at:5},{subtitle:"And I put my head down for what seems like a split second,<br>and then I heard a loud sounded like a whoomph on the glacier. ",at:10},{subtitle:"I lifted my head up and the helicopter went<br>from being a helicopter to wreckage.",at:17.5},{subtitle:"Thankfully, none of them were seriously hurt.",at:23.5},{subtitle:"But now instead of five survivors to care for,<br>we had eight plus the four of us, and no more supplies<br>except what the crew had on board. ",at:25.7},{subtitle:"",at:33}]})}),n}return Q()(t,e),t}(vi),va=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"show",value:function(){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"hide",value:function(){this.parentController.$el.style.display="none"}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),ma={name:"HalfTurnInteraction",components:{InteractionBox:hr},extends:rr,mounted:function(){this.transitionController=new va(this),this.interaction=wr(this.$el,Er({radius:.25*this.$refs.interaction.$el.offsetHeight,maxAngle:180}),this.onUpdate)},methods:{onUpdate:function(e){this.$emit("interact",e)},hide:function(){this.interaction.hide(),this.$refs.interaction.hide()},show:function(){this.interaction.show(),this.$refs.interaction.show()}}},ga=n(153);var Aa=Object(d.a)(ma,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.halfTurnInteraction]},[t("InteractionBox",{ref:"interaction",attrs:{"left-label":"Day 2","right-label":"15:00 HRS","tutorial-label":"Assess the situation","tutorial-icon":"half-turn"}})],1)},[],!1,function(e){this.$style=ga.default.locals||ga.default},null,null);Aa.options.__file="HalfTurnInteraction.vue";var ya={name:"FirstPickup",components:{HalfTurnInteraction:Aa.exports,Scroller:zr},extends:ye,data:function(){return{sliderHeight:.7*window.innerHeight}},methods:{transitionIn:function(e){this.animation=new _a(this),this.events=new pa(this),this.$refs.interaction.show(),this.tween=this.animation.playStep1(this.pause),this.tween2=this.animation.start(),this.tween3=this.animation.playEnd(),e()},transitionOut:function(e){e()},onInteract:function(e){this.tween.progress(e)},pause:function(){this.$refs.interaction.hide(),this.$refs.scroller.transitionIn()},onScroll:function(e){e>.1&&this.$refs.scroller.transitionOut(),this.active&&(e>.9&&!this.snap?(this.snap=!0,this.tween2.resume()):this.snap||this.tween2.progress(e))},resize:function(e){this.$refs.interaction.resize(e)}}},Ea=n(154);var Ta=Object(d.a)(ya,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.firstPickup]},[t("HalfTurnInteraction",{ref:"interaction",class:this.$style.dragSlider,attrs:{height:this.sliderHeight},on:{interact:this.onInteract}}),this._v(" "),t("Scroller",{ref:"scroller",class:this.$style.scroller,attrs:{"on-scroll":this.onScroll,"scroll-height":4e4,label:"Scroll<br><strong>to advance</strong>"}})],1)},[],!1,function(e){this.$style=Ea.default.locals||Ea.default},null,null);Ta.options.__file="FirstPickup.vue";var Ca=Ta.exports,wa=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Ra=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.TREK_2,to:Re.TREK_2}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){var e=new J.TimelineMax({paused:!0,onComplete:function(){V.a.go("/helicopter-crash")}});return e.add(this.playAnimation(0,1,!1)),e}}]),t}(_i),Sa={name:"TrekToHelicopter",components:{Scroller:Wr},extends:ye,mounted:function(){this.transitionController=new wa(this)},methods:{transitionIn:function(e){this.snap=!1,this.animation=new Ra(this),this.webglTween=this.animation.playStep1(),this.transitionController.transitionIn(),this.$refs.scroller.transitionIn(),e()},transitionOut:function(e){e()},onScroll:function(e){e>.1&&this.$refs.scroller.transitionOut(),this.active&&(e>.88&&!this.snap?(this.snap=!0,this.webglTween.resume()):this.snap||this.webglTween.progress(e))},resize:function(e){this.$refs.scroller.resize(e)}}},Ia=n(155);var ba=Object(d.a)(Sa,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.trekToHelicopter]},[t("Scroller",{ref:"scroller",class:this.$style.scroller,attrs:{"on-scroll":this.onScroll,"scroll-height":7e4,label:"Scroll<br><strong>to advance</strong>"}})],1)},[],!1,function(e){this.$style=Ia.default.locals||Ia.default},null,null);ba.options.__file="TrekToHelicopter.vue";var xa=ba.exports,ka=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Ma=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.TREK_3,to:Re.TREK_3}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(){var e=new J.TimelineMax({paused:!0,onComplete:function(){V.a.go("/waiting")}});return e.add(this.playAnimation(0,1,!1)),e}}]),t}(_i),Pa={name:"LastPickup",components:{Scroller:Wr},extends:ye,mounted:function(){this.snap=!1,this.transitionController=new ka(this)},methods:{transitionIn:function(e){this.animation=new Ma(this),this.webglAnimation=this.animation.playStep1(),this.transitionController.transitionIn(),this.$refs.scroller.transitionIn(),e()},transitionOut:function(e){e()},onScroll:function(e){e>.03&&this.$refs.scroller.transitionOut(),this.active&&(e>.9&&!this.snap?(this.snap=!0,this.webglAnimation.resume()):this.snap||this.webglAnimation.progress(e))},resize:function(e){this.$refs.scroller.resize(e)}}},Fa=n(156);var Na=Object(d.a)(Pa,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.lastPickup]},[t("Scroller",{ref:"scroller",class:this.$style.scroller,attrs:{"on-scroll":this.onScroll,"scroll-height":2e4,label:"Scroll<br><strong>to advance</strong>"}})],1)},[],!1,function(e){this.$style=Fa.default.locals||Fa.default},null,null);Na.options.__file="LastPickup.vue";var Da=Na.exports,Oa=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this,e))).animations=[{from:Re.PICK_UP_2_1,to:Re.PICK_UP_2_4}],n.setupAnimations(),n}return Q()(t,e),W()(t,[{key:"playStep1",value:function(e){return this.webglTween1=new J.TimelineMax({paused:!0,onComplete:e}),this.webglTween1.add(this.playAnimation(0,1,!1)),this.webglTween1}}]),t}(_i),La=function(e){function t(e){return G()(this,t),X()(this,K()(t).call(this,e))}return Q()(t,e),t}(vi),Ua=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"hide",value:function(){this.parentController.$el.style.display="none"}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Ba={name:"FullCircleInteraction",components:{InteractionBox:hr},extends:rr,data:function(){return{time:39,leftLabel:"Day 3"}},mounted:function(){this.transitionController=new Ua(this),this.interaction=wr(this.$el,Er({radius:.25*this.$refs.box.$el.offsetHeight,maxAngle:360}),this.onUpdate)},methods:{hideGesture:function(){this.interaction.hide()},showGesture:function(){this.interaction.show()},onUpdate:function(e){var t=31*e;this.time=Math.round(39+t),this.time>=64?this.leftLabel="Day 4":this.leftLabel="Day 3",this.$emit("interact",e)},hide:function(){this.interaction.hide(),this.$refs.box.hide()},show:function(){this.interaction.show(),this.$refs.box.show()}}},Va=n(157);var Ha=Object(d.a)(Ba,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.fullCircleInteraction]},[t("InteractionBox",{ref:"box",attrs:{"right-label":this.time+":00 HRS","left-label":this.leftLabel,"tutorial-label":"Wait for rescue","tutorial-icon":"full-circle"}})],1)},[],!1,function(e){this.$style=Va.default.locals||Va.default},null,null);Ha.options.__file="FullCircleInteraction.vue";var Ga={name:"Waiting",components:{FullCircleInteraction:Ha.exports},extends:ye,methods:{transitionIn:function(e){this.animation=new Oa(this),this.events=new La(this),this.$refs.interaction.show(),this.tween=this.animation.playStep1(this.onComplete),e()},onComplete:function(){this.$refs.interaction.hide(),V.a.go("/airlift-out")},onInteract:function(e){this.tween.progress(e)},transitionOut:function(e){e()},resize:function(e){this.$refs.pressHoldButton.resize(e)}}},za=n(158);var Wa=Object(d.a)(Ga,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:["chapter",this.$style.waiting]},[t("FullCircleInteraction",{ref:"interaction",class:this.$style.interaction,on:{interact:this.onInteract}})],1)},[],!1,function(e){this.$style=za.default.locals||za.default},null,null);Wa.options.__file="Waiting.vue";var ja=Wa.exports,Xa=n(159),Ya=n.n(Xa),Ka=n(247),$a=n.n(Ka),Qa=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"showStep1",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.step1Text;e.add(me(t,1),0)}},{key:"showStep2",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.step2Text;e.add(me(t,1),.75)}},{key:"showStep3",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.step3Text;e.add(me(t,1),.75)}},{key:"showStep4",value:function(){var e=new J.TimelineMax,t=this.parentController.$refs.step4Text;e.add(me(t,1),.75)}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Ja={name:"Conclusion",extends:ye,created:function(){this.imagesLoaded=!1,this.activeStep=void 0},mounted:function(){this.steps=[this.$refs.step1,this.$refs.step2,this.$refs.step3,this.$refs.step4],this.paging=$a()(this.steps),this.paging.on("change",this.onChange),this.transitionController=new Qa(this),this.imgs=this.$el.querySelectorAll("img")},methods:{onChange:function(e,t){var n=this;if(this.activeStep)J.TweenMax.to(this.activeStep,.5,{autoAlpha:0,onComplete:function(){var i=Ya()(e,1);n.activeStep=i[0],J.TweenMax.to(n.activeStep,.5,{autoAlpha:1}),n.playAnimation(t)}});else{var i=Ya()(e,1);this.activeStep=i[0],this.transitionController.showStep1()}},playAnimation:function(e){switch(e.toString()){case"0":this.transitionController.showStep1();break;case"1":this.$webGLApplication.showEndScreen(ii.END_SCREEN_1),this.transitionController.showStep2();break;case"2":this.$webGLApplication.showEndScreen(ii.END_SCREEN_2),this.transitionController.showStep3();break;case"3":this.$webGLApplication.showEndScreen(ii.END_SCREEN_3),this.transitionController.showStep4()}},transitionIn:function(e){this.paging.go(0),setTimeout(this.paging.next,4e3),setTimeout(this.paging.next,9e3),setTimeout(this.paging.next,14e3),setTimeout(function(){V.a.go("/end")},19e3),e()},transitionOut:function(e){this.$webGLApplication.showEndScreen(),e()},resize:function(){this.imgs.forEach(function(e){e.style.width="".concat(window.innerWidth,"px"),e.style.height="".concat(window.innerHeight,"px")})}}},Za=n(160);var qa=Object(d.a)(Ja,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["chapter",e.$style.conclusion]},[n("div",{ref:"step1",class:[e.$style.step,e.$style.step1]},[n("p",{ref:"step1Text",staticClass:"h4"},[e._v("\n      The crash survivors and rescue team returned home safely\n    ")])]),e._v(" "),n("div",{ref:"step2",class:[e.$style.step,e.$style.step2]},[n("div",{class:e.$style.content},[n("p",{ref:"step2Text",class:["copy-1",e.$style.copy]},[e._v("\n        For their actions,"),n("br"),e._v("the Special Warfare team"),n("br"),e._v("was awarded meritorious"),n("br"),e._v("service medals.\n      ")])])]),e._v(" "),n("div",{ref:"step3",class:[e.$style.step,e.$style.step3]},[n("div",{class:e.$style.content},[n("p",{ref:"step3Text",class:["copy-1",e.$style.copy]},[e._v("Today, all four Airmen"),n("br"),e._v("continue to serve in"),n("br"),e._v("the U.S. Air Force.")])])]),e._v(" "),n("div",{ref:"step4",class:[e.$style.step,e.$style.step4]},[n("div",{class:e.$style.content},[n("p",{ref:"step4Text",class:["copy-1",e.$style.copy]},[e._v("When duty calls, they\u2019re ready to put their lives"),n("br"),e._v("on the line to save others.")])])])])},[],!1,function(e){this.$style=Za.default.locals||Za.default},null,null);qa.options.__file="Conclusion.vue";var es=qa.exports,ts=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){var i=t.$refs,r=i.title,a=i.subtitle,s=i.scrollBar,o=i.knob,l=t.$refs.thumbnails;e.add(me(r,1),0),e.add(me(a,1),.5),e.add(this.getTimeline("cta"),.6),e.add(this.getTimeline("restart"),.7);for(var u=0;u<l.length;u+=1){var h=l[u];e.fromTo(h,.75,{autoAlpha:0,y:50},{autoAlpha:1,y:0,ease:J.Expo.easeOut},.8+.1*u)}e.fromTo(s,.65,{scaleX:0,transformOrigin:"top right"},{scaleX:1,ease:J.Expo.easeOut,transformOrigin:"top right"},"-=0.5"),e.fromTo(o,1,{scaleX:0,transformOrigin:"top left"},{scaleX:1,ease:J.Expo.easeOut,transformOrigin:"top left"},"-=0.2")}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),ns={name:"EndScreen",components:{CTAButton:Ji},extends:ye,data:function(){return{podcasts:[{background:"image/end/not-on-my-watch.jpg",label:"",title:"Not on my watch",url:"https://www.airforce.com/silver-star-stories/not-on-my-watch"},{background:"image/end/informing-the-fight.jpg",label:"",title:"Informing the fight",url:"https://www.airforce.com/silver-star-stories/informing-the-fight"},{background:"image/end/the-high-ground-will-be-ours.jpg",label:"",title:"The High Ground Will Be Ours",url:"https://www.airforce.com/silver-star-stories/the-high-ground-will-be-ours"},{background:"image/end/the-sword-and-the-shield.jpg",label:"",title:"The Sword and the Shield",url:"https://www.airforce.com/silver-star-stories/the-sword-and-the-shield"}]}},methods:{transitionIn:function(e){this.scrollbar=function(e,t){var n=0,i=0,r=0,a={value:0,original:0},s=e.parentNode,o=e.getBoundingClientRect().width,l=(s.offsetWidth-Math.abs(s.offsetWidth-o))/s.offsetWidth;t.style.width="".concat(100*l,"%");var u=function(n){var i=r-n;i>0&&(i=0);var l=o-s.offsetWidth;i<-l&&(i=-l),a.original=i,J.TweenMax.to(a,.25,{value:i,onUpdate:function(){e.style.transform="translateX(".concat(a.value,"px)"),t.style.transform="translateX(".concat(-a.value,"px)")}})},h=function(e){i=Ar(e),u(n-i)};return s.addEventListener(mr,function(e){n=Ar(e),document.body.addEventListener(vr,h)}),document.body.addEventListener(gr,function(){r=a.original,i=0,n=0,document.body.removeEventListener(vr,h)}),new Lr.a({useTouch:!1,useKeyboard:!1,mouseMultiplier:.1,firefoxMultiplier:45}).on(function(e){u(-e.deltaY),r=a.original}),{resize:function(){o=e.getBoundingClientRect().width,l=(s.offsetWidth-Math.abs(s.offsetWidth-o))/s.offsetWidth,t.style.width="".concat(100*l,"%")},dispose:function(){}}}(this.$refs.wrapper,this.$refs.knob),this.resize(),this.transitionController=new ts(this),this.transitionController.transitionIn(!0),e()},onRestart:function(){window.location.reload(!0)},resize:function(){var e=this.$refs.wrapper.getBoundingClientRect();this.$refs.scroller.style.height="".concat(e.height*(this.$deviceStateTracker.currentState<this.DeviceState.SMALL?1.3:1.5),"px"),this.scrollbar&&this.scrollbar.resize()}}},is=n(161);var rs=Object(d.a)(ns,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["chapter",e.$style.endScreen]},[n("div",{ref:"scroller",class:e.$style.scroller},[n("div",{ref:"scrollBar",class:e.$style.knob},[n("span",{ref:"knob"})]),e._v(" "),n("div",{ref:"wrapper",class:e.$style.wrapper},[n("div",{class:e.$style.info},[n("h1",{ref:"title"},[e._v("Join"),n("br"),e._v("the team")]),e._v(" "),n("div",{class:e.$style.buttons},[n("CTAButton",{ref:"cta",class:e.$style.cta,attrs:{target:"_blank",label:"Apply Now",link:"https://www.airforce.com/apply-now",theme:"secondary"}}),e._v(" "),n("CTAButton",{ref:"restart",class:e.$style.cta,attrs:{click:e.onRestart,link:"",label:"Restart"}})],1)]),e._v(" "),n("div",{class:e.$style.list},[n("p",{ref:"subtitle",class:["h5",e.$style.subtitle]},[e._v("OTHER SILVER STAR STORIES")]),e._v(" "),n("div",{class:e.$style.cards},e._l(e.podcasts,function(t,i){return n("div",{key:i,ref:"thumbnails",refInFor:!0,class:e.$style.storyCard,style:"background-image: url("+e.$versionRoot+t.background+")"},[n("div",{class:e.$style.gradient}),e._v(" "),n("a",{attrs:{href:t.url,target:"_blank"}},[n("div",{class:[e.$style.innerContent,"abs-fill"]},[n("p",{staticClass:"small"},[e._v("\n                  "+e._s(t.label)+"\n                ")]),e._v(" "),n("div",{class:e.$style.thumbInfo},[n("div",{class:e.$style.hover}),e._v(" "),n("div",{class:e.$style.contentInfo},[n("p",{class:[e.$style.title,"small"]},[e._v("\n                      "+e._s(t.title)+"\n                    ")]),e._v(" "),n("div",{class:e.$style.btPlay},[n("Icon",{class:e.$style.iconPlay,attrs:{name:"play"}})],1)])])])])])}))])])])])},[],!1,function(e){this.$style=is.default.locals||is.default},null,null);rs.options.__file="EndScreen.vue";var as={name:"ChapterNavigation",components:{Intro:Ii,Landing:tr,Rescue:Nr,TrekToSurvivors:Qr,HelicopterCrash:na,AirliftOut:fa,FirstPickup:Ca,TrekToHelicopter:xa,LastPickup:Da,Waiting:ja,Conclusion:es,EndScreen:rs.exports},created:function(){V.a.flow("destroy+run")},mounted:function(){V()("/intro",this.$refs.intro.routeIn,this.$refs.intro.routeOut),V()("/landing",this.$refs.landing.routeIn,this.$refs.landing.routeOut),V()("/rescue",this.$refs.rescue.routeIn,this.$refs.rescue.routeOut),V()("/trek-to-survivors",this.$refs.trekToSurvivors.routeIn,this.$refs.trekToSurvivors.routeOut),V()("/first-pickup",this.$refs.firstPickup.routeIn,this.$refs.firstPickup.routeOut),V()("/trek-to-helicopter",this.$refs.trekToHelicopter.routeIn,this.$refs.trekToHelicopter.routeOut),V()("/helicopter-crash",this.$refs.helicopterCrash.routeIn,this.$refs.helicopterCrash.routeOut),V()("/last-pickup",this.$refs.lastPickup.routeIn,this.$refs.lastPickup.routeOut),V()("/waiting",this.$refs.waiting.routeIn,this.$refs.waiting.routeOut),V()("/airlift-out",this.$refs.airliftOut.routeIn,this.$refs.airliftOut.routeOut),V()("/conclusion",this.$refs.conclusion.routeIn,this.$refs.conclusion.routeOut),V()("/end",this.$refs.endScreen.routeIn,this.$refs.endScreen.routeOut)},methods:{resize:function(e){this.$refs.landing.resize(e),this.$refs.rescue.resize(e),this.$refs.trekToSurvivors.resize(e),this.$refs.firstPickup.resize(e),this.$refs.trekToHelicopter.resize(e),this.$refs.helicopterCrash.resize(e),this.$refs.lastPickup.resize(e),this.$refs.airliftOut.resize(e),this.$refs.conclusion.resize(e),this.$refs.endScreen.resize(e)}}},ss=n(162);var os=Object(d.a)(as,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.chapterNavigation]},[n("Intro",{ref:"intro"}),e._v(" "),n("Landing",{ref:"landing"}),e._v(" "),n("Rescue",{ref:"rescue"}),e._v(" "),n("TrekToSurvivors",{ref:"trekToSurvivors"}),e._v(" "),n("HelicopterCrash",{ref:"helicopterCrash"}),e._v(" "),n("AirliftOut",{ref:"airliftOut"}),e._v(" "),n("FirstPickup",{ref:"firstPickup"}),e._v(" "),n("TrekToHelicopter",{ref:"trekToHelicopter"}),e._v(" "),n("LastPickup",{ref:"lastPickup"}),e._v(" "),n("Waiting",{ref:"waiting"}),e._v(" "),n("Conclusion",{ref:"conclusion"}),e._v(" "),n("EndScreen",{ref:"endScreen"})],1)},[],!1,function(e){this.$style=ss.default.locals||ss.default},null,null);os.options.__file="ChapterNavigation.vue";var ls=os.exports,us=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){e.fromTo(t.$el,.75,{autoAlpha:0},{autoAlpha:1,ease:J.Expo.easeOut})}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),hs=function(e){function t(e,n,i,r,a){var s;return G()(this,t),(s=X()(this,K()(t).call(this,e,i,r,a))).data=n,s}return Q()(t,e),W()(t,[{key:"clone",value:function(){return new t(this.type,this.data,this.bubbles,this.cancelable)}}]),t}(Fn.a);hs.UPDATE=Mn.EVENT_TYPE_PLACEHOLDER,hs.END=Mn.EVENT_TYPE_PLACEHOLDER,Object(Mn.generateEventTypes)({SubtitlesEvent:hs});var cs=hs,ds={name:"Subtitle",props:{forceHide:o.a.bool.def(!1)},data:function(){return{text:"",name:""}},mounted:function(){this.$narration.subtitle.addEventListener(cs.UPDATE,this.onUpdate)},methods:{onUpdate:function(){this.text=this.$narration.subtitle.text.text,this.name=this.$narration.subtitle.text.name}}},fs=n(163);var _s=Object(d.a)(ds,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.subtitle]},[n("h2",{directives:[{name:"show",rawName:"v-show",value:!e.forceHide,expression:"!forceHide"}],domProps:{innerHTML:e._s(e.text)}}),e._v(" "),e.text.length>0&&!e.forceHide?n("span",{class:e.$style.line}):e._e(),e._v(" "),e.text.length>0&&!e.forceHide?n("div",{class:e.$style.name},[n("span"),e._v(" "),n("p",{staticClass:"small"},[e._v("\n      "+e._s(e.name)+"\n    ")])]):e._e()])},[],!1,function(e){this.$style=fs.default.locals||fs.default},null,null);_s.options.__file="Subtitle.vue";var ps=_s.exports,vs=function(e){function t(e,n,i,r,a){var s;return G()(this,t),(s=X()(this,K()(t).call(this,e,i,r,a))).data=n,s}return Q()(t,e),W()(t,[{key:"clone",value:function(){return new t(this.type,this.data,this.bubbles,this.cancelable)}}]),t}(Fn.a);vs.START=Mn.EVENT_TYPE_PLACEHOLDER,vs.END=Mn.EVENT_TYPE_PLACEHOLDER,Object(Mn.generateEventTypes)({NarrationEvent:vs});var ms=vs,gs={name:"Narration",components:{Subtitle:ps},extends:O.AbstractTransitionComponent,props:{forceHide:o.a.bool.def(!1)},data:function(){return{visible:!1}},methods:{handleAllComponentsReady:function(){this.transitionController=new us(this),this.$narration.addEventListener(ms.START,this.onStart.bind(this)),this.$narration.addEventListener(ms.END,this.onEnd),this.isReady()},onStart:function(){this.visible=!0},onEnd:function(){this.visible=!1}}},As=n(164);var ys=Object(d.a)(gs,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.narration]},[t("Subtitle",{ref:"subtitle",class:this.$style.subtitle,attrs:{"force-hide":this.forceHide}})],1)},[],!1,function(e){this.$style=As.default.locals||As.default},null,null);ys.options.__file="Narration.vue";var Es=ys.exports,Ts=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Cs={name:"RotateDevice",extends:O.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Ts(this),this.isReady()}}},ws=n(165);var Rs=Object(d.a)(Cs,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.rotateDevice]},[t("div",{class:this.$style.content},[t("span",{class:this.$style.icon}),this._v(" "),t("h2",[this._v("Please, rotate your device")])])])},[],!1,function(e){this.$style=ws.default.locals||ws.default},null,null);Rs.options.__file="RotateDevice.vue";var Ss=Rs.exports,Is=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"hideBackground",value:function(e){var t=this.parentElement.$refs.background;new J.TimelineMax({onComplete:e}).to(t,2,{autoAlpha:0,ease:J.Linear.easeNone})}},{key:"hideContent",value:function(){var e=this.parentController.$refs.content;J.TweenMax.to(e,.5,{autoAlpha:0}),this.parentController.$refs.cta.transitionOut()}},{key:"showButton",value:function(){this.parentController.$refs.cta.transitionIn()}},{key:"setupTransitionInTimeline",value:function(e,t,n){this.parentElement=t;var i=t.$refs,r=(i.background,i.progressCircle),a=i.title,s=i.description;e.fromTo(r,1,{autoAlpha:0},{autoAlpha:1,ease:J.Expo.easeOut},1).add(me(a,2),1).add(ge(s,2),2)}},{key:"setupTransitionOutTimeline",value:function(e,t,n){var i=t.$refs.progressCircle;e.to(i,1,{autoAlpha:0,ease:J.Expo.easeInOut})}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),bs={name:"PreloaderScreen",components:{CTAButton:Qi},extends:O.AbstractTransitionComponent,props:{progress:o.a.number.isRequired},data:function(){return{radius:20}},computed:{formattedProgress:function(){return this.progress<10?"0".concat(this.progress):"".concat(this.progress)},circleCircumference:function(){return 2*this.radius*Math.PI},circleProgress:function(){return Math.round(this.circleCircumference-this.progress/100*this.circleCircumference)}},methods:{handleAllComponentsReady:function(){this.transitionController=new Is(this),this.isReady()},onClick:function(){this.$el.classList.add(this.$style.disabled),this.transitionController.hideContent(),this.$emit("interact")},showButton:function(){this.transitionController.showButton()},show:function(e){var t=this,n=new Image;n.onload=function(){t.transitionController.transitionIn(!0),setTimeout(e,1500)},n.src="".concat(this.$versionRoot,"image/background.jpg")},hide:function(){this.transitionController.transitionOut()},hideBackground:function(){var e=this;return new Promise(function(t){e.transitionController.hideBackground(t)})}}},xs=n(166);var ks=Object(d.a)(bs,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.preloaderScreen]},[n("div",{ref:"background",class:e.$style.background,style:"background-image: url("+e.$versionRoot+"image/background.jpg)"}),e._v(" "),n("Icon",{class:e.$style.logo,attrs:{name:"logo"}}),e._v(" "),n("div",{ref:"content",class:[e.$style.content,"abs-center"]},[n("h3",{ref:"title",class:[e.$style.title,"h3"]},[e._v("This experience"),n("br"),e._v(" is better with sound")]),e._v(" "),n("p",{ref:"description",class:[e.$style.description,"copy-2"]},[e._v("Adjust the volume of your speakers"),n("br"),e._v(" or headphones accordingly")]),e._v(" "),n("CTAButton",{ref:"cta",class:e.$style.cta,attrs:{click:e.onClick,label:"OK",link:"",theme:"secondary"}})],1),e._v(" "),n("div",{ref:"progressCircle",class:[e.$style.circlePreloader,e.formattedProgress>=100?e.$style.hidePreloader:""]},[n("svg",{class:e.$style.progressRing,attrs:{height:"120",width:"120"}},[n("circle",{attrs:{cx:e.radius+6,cy:e.radius+6,r:e.radius,fill:"transparent",stroke:"#bcc9dd","stroke-width":"3"}}),e._v(" "),n("circle",{class:e.$style.progressRingCircle,attrs:{cx:e.radius+6,cy:e.radius+6,r:e.radius,"stroke-dasharray":e.circleCircumference+" "+e.circleCircumference,"stroke-dashoffset":e.circleProgress,fill:"transparent",stroke:"#466383","stroke-width":"4"}})]),e._v(" "),n("p",{ref:"progress",class:["copy-3",e.$style.progressLabel]},[e._v(e._s(e.formattedProgress))])])],1)},[],!1,function(e){this.$style=xs.default.locals||xs.default},null,null);ks.options.__file="PreloaderScreen.vue";var Ms=ks.exports,Ps={name:"StoryProgress"},Fs=n(167);var Ns=Object(d.a)(Ps,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.storyProgress]},[t("span",{class:this.$style.progress})])},[],!1,function(e){this.$style=Fs.default.locals||Fs.default},null,null);Ns.options.__file="StoryProgress.vue";var Ds=Ns.exports,Os=[{name:"landing",at:"00:00:00",position:.09}],Ls=[],Us=function(e){function t(){return G()(this,t),X()(this,K()(t).call(this,{loop:!0}))}return Q()(t,e),W()(t,[{key:"play",value:function(){return ke()(K()(t.prototype),"play",this).call(this,"sound/sfx/airforce_ambient.mp3")}}]),t}(yi),Bs=F()(Li).concat(F()(Ti),F()(Ls),F()(zi)),Vs=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){var i=t.$refs,r=i.mediaTop,a=i.mediaRight,s=i.mediaBottom,o=i.mediaLeft,l=i.textRight,u=i.textBottom,h=i.textLeft,c=i.description,d=i.labelClose,f=i.closeLine,_=i.speaker,p=i.image,v=this.parentController,m=t.$refs.closeButton;e.fromTo(t.$el,.15,{autoAlpha:0},{autoAlpha:1}),e.fromTo(r,.15,{scaleX:0},{scaleX:1,transformOrigin:"top left"}),e.fromTo(a,.15,{scaleY:0},{scaleY:1,transformOrigin:"top left"}),e.fromTo(s,.3,{scaleX:0},{scaleX:1,transformOrigin:"top right"}),e.fromTo(o,1,{scaleY:0},{scaleY:1,ease:J.Power3.easeOut,transformOrigin:"bottom left"}),e.fromTo(l,.15,{scaleY:0},{scaleY:1,transformOrigin:"top left"},.3),e.fromTo(u,.3,{scaleX:0},{scaleX:1,transformOrigin:"top right"},.45),e.fromTo(h,1,{scaleY:0},{scaleY:1,ease:J.Power3.easeOut,transformOrigin:"bottom left"},.75),e.fromTo(c,.1,{autoAlpha:0},{autoAlpha:1},.5),e.fromTo(_,1,{autoAlpha:0},{autoAlpha:1},1),e.addCallback(v.animateText,.5),e.addCallback(v.animateSound,.5),e.fromTo(p,1,{autoAlpha:0},{autoAlpha:1},1),e.fromTo(f,.3,{scaleY:0},{scaleY:1,ease:J.Power3.easeInOut,transformOrigin:"top left"}),e.fromTo(d,.75,{autoAlpha:0},{autoAlpha:1,ease:J.Power3.easeOut,transformOrigin:"top left"},"-=0.2"),e.fromTo(m.$el,.75,{autoAlpha:0},{autoAlpha:1,ease:J.Power3.easeOut,transformOrigin:"top left"},"-=0.5")}},{key:"setupTransitionOutTimeline",value:function(e,t,n){e.to(t.$el,.1,{autoAlpha:0,ease:J.Linear.easeNone})}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Hs=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Gs={name:"HotspotButton",extends:O.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Hs(this),this.isReady()}}},zs=n(168);var Ws=Object(d.a)(Gs,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.hotspotButton]},[t("button",[t("Icon",{class:this.$style.icon,attrs:{name:"close"}})],1)])},[],!1,function(e){this.$style=zs.default.locals||zs.default},null,null);Ws.options.__file="HotspotButton.vue";var js=Ws.exports,Xs=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Ys=n(248),Ks=n.n(Ys),$s={name:"WaveForm",props:{data:o.a.any,progress:o.a.number},beforeDestroy:function(){window.cancelAnimationFrame(this.rAF)},methods:{init:function(){this.upperPoints=[],this.downPoints=[],this.points=[],this.waveform=Ks.a.create(this.data),this.$refs.canvas.setAttribute("width",this.$el.offsetWidth),this.$refs.canvas.setAttribute("height",this.$el.offsetHeight),this.$refs.canvasProgress.setAttribute("width",this.$el.offsetWidth),this.$refs.canvasProgress.setAttribute("height",this.$el.offsetHeight),this.width=this.$el.offsetWidth,this.height=this.$el.offsetHeight,this.buildPoints(),this.draw()},buildPoints:function(){for(var e=this.waveform.channel(0),t=0;t<this.waveform.length;t+=1){var n=e.max_sample(t);this.upperPoints.push({x:t+.5,y:this.height/2,yFinal:this.scaleY(n,this.$refs.canvas.height)+.5})}for(var i=0;i<this.waveform.length;i+=1){var r=e.min_sample(i);this.downPoints.push({x:i+.5,y:this.height/2,yFinal:this.scaleY(r,this.$refs.canvas.height)+.5})}},scaleY:function(e,t){return t-(e+128)*t/256},draw:function(){if(this.rAF=window.requestAnimationFrame(this.draw),this.visible){var e=this.$refs.canvas.getContext("2d"),t=this.$refs.canvasProgress.getContext("2d");e.clearRect(0,0,this.width,this.height),t.clearRect(0,0,this.width,this.height),e.strokeStyle="rgba(72, 100, 132, 0.4)",this.drawBackground(e),this.drawProgress(t),this.drawLine(t)}},drawLine:function(e){e.strokeStyle="#fdb805",e.lineWidth=1,e.beginPath();var t=this.width*this.progress;e.moveTo(t,0),e.lineTo(t,this.height),e.stroke(),e.closePath()},drawBackground:function(e){e.beginPath();for(var t=0;t<this.upperPoints.length;t+=1)e.moveTo(this.downPoints[t].x,this.height/2),e.lineTo(this.upperPoints[t].x,this.upperPoints[t].y);e.stroke(),e.closePath(),e.beginPath();for(var n=0;n<this.downPoints.length;n+=1)e.moveTo(this.downPoints[n].x,this.height/2),e.lineTo(this.downPoints[n].x,this.downPoints[n].y);e.stroke(),e.closePath()},drawProgress:function(e){e.strokeStyle="rgba(72, 100, 132, 1)",this.drawBackground(e),e.globalCompositeOperation="destination-in",e.beginPath(),e.fillRect(0,0,this.width*this.progress,this.height),e.closePath(),e.globalCompositeOperation="source-over"},clear:function(){window.cancelAnimationFrame(this.rAF),this.visible=!1;var e=this.$refs.canvas.getContext("2d"),t=this.$refs.canvasProgress.getContext("2d");e.clearRect(0,0,this.width,this.height),t.clearRect(0,0,this.width,this.height)},transitionIn:function(){var e=this;return new Promise(function(t){e.init(),e.visible=!0;for(var n=0;n<e.upperPoints.length;n+=1)J.TweenLite.to(e.upperPoints[n],1,{y:e.upperPoints[n].yFinal,ease:J.Expo.easeOut,onComplete:t,delay:.001*n});for(var i=0;i<e.downPoints.length;i+=1)J.TweenLite.to(e.downPoints[i],1,{y:e.downPoints[i].yFinal,ease:J.Expo.easeOut,delay:.001*i})})}}},Qs=n(169);var Js=Object(d.a)($s,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.waveForm]},[t("canvas",{ref:"canvas"}),this._v(" "),t("canvas",{ref:"canvasProgress"})])},[],!1,function(e){this.$style=Qs.default.locals||Qs.default},null,null);Js.options.__file="WaveForm.vue";var Zs={name:"SoundPlayer",components:{WaveForm:Js.exports},extends:O.AbstractTransitionComponent,data:function(){return{wavedata:null,progress:0}},beforeDestroy:function(){this.$el.removeEventListener(mr,this.onSeekSound)},methods:{handleAllComponentsReady:function(){this.transitionController=new Xs(this),this.playing=!1,this.$el.addEventListener(mr,this.onSeekSound),this.isReady()},loadAssets:function(e){var t=this;window.fetch("".concat(this.$versionRoot).concat(this.wavefile)).then(function(e){return e.json()}).then(function(n){t.wavedata=n,e()})},play:function(){this.playing=!0,this.sound.play()},pause:function(){this.playing=!1,this.sound.pause()},toggle:function(){this.playing?this.playing&&this.pause():this.play()},onSeekSound:function(e){if(this.sound){var t=this.$el.parentNode.getBoundingClientRect(),n=t.width,i=function(e,t){if(!pr())return e.clientX-t.left;var n=e;return n.touches[n.touches.length-1].clientX-t.left}(e,t)/n,r=this.sound.duration()*i;!this.sound.playing()&&this.playing&&this.sound.play(),this.sound.seek(r)}},transitionIn:function(e){var t=this;this.soundFile=e,this.wavefile=e.replace(/\.mp3/,".json"),this.sound=new gi.Howl({src:["".concat(this.$versionRoot).concat(this.soundFile)],volume:1,autoplay:!1}),this.loadAssets(function(){t.showWaveTimeout&&clearTimeout(t.showWaveTimeout),t.showWaveTimeout=setTimeout(function(){t.$refs.waveform.transitionIn().then(function(){t.play()}),t.loop()},100)})},transitionOut:function(){this.$refs.waveform.clear(),this.sound&&(this.pause(),this.sound.unload()),this.progress=0,this.showWaveTimeout&&clearTimeout(this.showWaveTimeout)},loop:function(){this.rAF=window.requestAnimationFrame(this.loop),this.sound.playing()&&(this.progress=this.sound.seek()/this.sound.duration())}}},qs=n(170);var eo=Object(d.a)(Zs,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.soundPlayer]},[t("div",{class:this.$style.button},[t("WaveForm",{ref:"waveform",attrs:{progress:this.progress,data:this.wavedata}})],1)])},[],!1,function(e){this.$style=qs.default.locals||qs.default},null,null);eo.options.__file="SoundPlayer.vue";var to={name:"Hotspot",components:{HotspotButton:js,SoundPlayer:eo.exports},extends:O.AbstractTransitionComponent,data:function(){return{label:""}},methods:{handleAllComponentsReady:function(){this.transitionController=new Vs(this),this.isReady()},show:function(e){var t=this,n=e.sound,i=e.label,r=e.speaker,a=e.onClose,s=e.image;this.$webGLApplication.setHotspotOpen(!0),this.sound=n,this.speaker=r,this.$store.commit("setScrollEnabled",!1),this.label=i,this.image=i,this.$refs.description.innerText=i,this.$refs.speaker.innerText=r,this.$refs.image.src="".concat(this.$versionRoot).concat(s),this.$el.classList.add(this.$style.show),setTimeout(function(){t.addClickOutsideEvent(),t.transitionIn()}),this.callback=a},addClickOutsideEvent:function(){document.body.removeEventListener("click",this.clickOutside),document.body.addEventListener("click",this.clickOutside)},clickOutside:function(e){this.$el.contains(e.target)||this.hide()},animateText:function(){!function(e,t){var n=Array.from(e.querySelectorAll(".js-word"));0===n.length&&(new te(e,{type:"words",position:"relative",wordsClass:"js-word"}),n=Array.from(e.querySelectorAll(".js-word")));var i=new J.TimelineMax({onComplete:function(){}}),r=t/n.length;n.forEach(function(e,n){var a=q(r*n/t),s=r*n;i.fromTo(e,2*r,{autoAlpha:0},{autoAlpha:1},s*a*.4)})}(this.$refs.description,2)},animateSound:function(){this.$refs.soundPlayer.transitionIn(this.sound)},hide:function(){this.$webGLApplication.setHotspotOpen(!1),document.body.removeEventListener("click",this.clickOutside),this.$store.commit("setScrollEnabled",!0),this.$el.classList.remove(this.$style.show),this.$refs.soundPlayer.transitionOut(),this.transitionOut(),this.callback&&(this.callback(),this.callback=null)}}},no=n(171);var io=Object(d.a)(to,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.hotspot]},[n("div",{class:e.$style.box},[n("div",{class:e.$style.border},[n("span",{ref:"textRight",class:e.$style.right}),e._v(" "),n("span",{ref:"textBottom",class:e.$style.bottom}),e._v(" "),n("span",{ref:"textLeft",class:e.$style.left})]),e._v(" "),n("div",{class:e.$style.media},[n("span",{ref:"mediaTop",class:e.$style.top}),e._v(" "),n("span",{ref:"mediaRight",class:e.$style.right}),e._v(" "),n("span",{ref:"mediaBottom",class:e.$style.bottom}),e._v(" "),n("span",{ref:"mediaLeft",class:e.$style.left}),e._v(" "),n("img",{ref:"image",class:e.$style.image}),e._v(" "),n("SoundPlayer",{ref:"soundPlayer"})],1),e._v(" "),n("p",{ref:"description",class:["copy-2",e.$style.label]}),e._v(" "),n("p",{ref:"speaker",class:["copy-3","alt",e.$style.speaker]})]),e._v(" "),n("div",{class:e.$style.closeWrapper},[n("div",{class:e.$style.close,on:{click:e.hide}},[n("p",{ref:"labelClose",class:["copy-2",e.$style.labelClose]},[e._v("\n        Close\n        "),n("span",{class:e.$style.underline})]),e._v(" "),n("div",{class:e.$style.closeButtonWrapper},[n("span",{ref:"closeLine",class:e.$style.line}),e._v(" "),n("HotspotButton",{ref:"closeButton",class:e.$style.closeButton})],1)])])])},[],!1,function(e){this.$style=no.default.locals||no.default},null,null);io.options.__file="Hotspot.vue";var ro=io.exports,ao=[{id:Rn.HOTSPOT_01,speaker:"Lt Col Jesse Peterson",label:"A safety procedure for when traveling over ice to help prevent a team member from falling into a crevasse.",sound:"sound/hotspots/clean/airforce_hotspot_rope_team_clean.mp3",image:"image/hotspots/hotspot_2.jpg"},{id:Rn.HOTSPOT_02,speaker:"Lt Col Jesse Peterson",label:"When trekking across patches of ice, it\u2019s important to know how to avoid deep crevasses that aren\u2019t clearly visible. ",sound:"sound/hotspots/clean/airforce_hotspot_advice_clean.mp3",image:"image/hotspots/hotspot_6.jpg"},{id:Rn.HOTSPOT_03,speaker:"Lt Col Jesse Peterson",label:"In addition to the rain and snow, the rescue team also had to endure the freezing temperatures that turned their sweat into ice.",sound:"sound/hotspots/clean/airforce_hotspot_wet_and_frozen_clean.mp3",image:"image/hotspots/hotspot_1.jpg"},{id:Rn.HOTSPOT_04,speaker:"MSgt Christopher Uriarte",label:"Several hours into their journey up the glacier, the rescue team was forced to hunker down and gather their strength for a final push.",sound:"sound/hotspots/clean/airforce_hotspot_break_from_the_storm_clean.mp3",image:"image/hotspots/hotspot_3.jpg"},{id:Rn.HOTSPOT_05,speaker:"CMSgt Alan Lankford",label:"Find out what the Special Warfare Operators packed in their rucks that helped them battle the elements and reach the crash site.",sound:"sound/hotspots/clean/airforce_hotspot_whats_in_a_ruk_clean.mp3",image:"image/hotspots/hotspot_5.jpg"},{id:Rn.HOTSPOT_06,speaker:"CMSgt Alan Lankford",label:"Water is the key to survival, but there\u2019s more to it than just melting snow.",sound:"sound/hotspots/clean/airforce_hotspot_snow_to_water_clean.mp3",image:"image/hotspots/hotspot_8.jpg"},{id:Rn.HOTSPOT_07,speaker:"Lt Col Jesse Peterson",label:"Even more important than physical strength was the mental strength required to reach the crash site and rescue the survivors.",sound:"sound/hotspots/clean/airforce_hotspot_key_to_survival_clean.mp3",image:"image/hotspots/hotspot_7.jpg"},{id:Rn.HOTSPOT_08,speaker:"MSgt Christopher Uriarte",label:"Four Air Force Special Warfare Operators climbed the glacier, but it took hundreds of others working together to pull off the mission.",sound:"sound/hotspots/clean/airforce_hotspot_teamwork_clean.mp3",image:"image/hotspots/hotspot_9.jpg"},{id:Rn.HOTSPOT_09,speaker:"CMSgt Alan Lankford",label:"Beyond the physical and mental toll, the emotional impact on the rescue team was just as real.",sound:"sound/hotspots/clean/airforce_hotspot_emotional_toll_clean.mp3",image:"image/hotspots/hotspot_10.jpg"}],so=n(172),oo=n.n(so),lo=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),uo={name:"MuteButton",extends:O.AbstractTransitionComponent,props:{muted:o.a.bool.def(!1)},watch:{muted:function(e){e?(J.TweenLite.to(this.$refs.animation,1,{scaleY:0,ease:J.Expo.easeOut}),this.onAnimation.pause()):(J.TweenLite.to(this.$refs.animation,1,{scaleY:1,ease:J.Expo.easeOut,clearProps:"all"}),this.onAnimation.play())}},beforeDestroy:function(){this.onAnimation&&this.onAnimation.destroy(),this.static&&this.static.destroy()},mounted:function(){this.onAnimation=oo.a.loadAnimation({container:this.$refs.animation,renderer:"svg",loop:!0,autoplay:!0,path:"".concat(this.$versionRoot,"body-movin/audio_on.json"),rendererSettings:{progressiveLoad:!0}}),this.static=oo.a.loadAnimation({container:this.$refs.static,renderer:"svg",loop:!1,autoplay:!1,path:"".concat(this.$versionRoot,"body-movin/audio_off.json"),rendererSettings:{progressiveLoad:!0}})},methods:{handleAllComponentsReady:function(){this.transitionController=new lo(this),this.isReady()}}},ho=n(173);var co=Object(d.a)(uo,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:[e.$style.muteButton],on:{click:function(t){e.$emit("click")}}},[n("div",{ref:"animation",class:[e.$style.animation,"abs-fill"]}),e._v(" "),n("div",{ref:"static",class:[e.$style.static,"abs-fill"]})])},[],!1,function(e){this.$style=ho.default.locals||ho.default},null,null);co.options.__file="MuteButton.vue";var fo={name:"MainPage",components:{ChapterNavigation:ls,Narration:Es,PreloaderScreen:Ms,RotateDevice:Ss,Subtitle:ps,StoryProgress:Ds,Hotspot:ro,MuteButton:co.exports},extends:O.AbstractPageTransitionComponent,data:function(){return{chapters:Os,progress:0,hotspotIsOpen:!1,muted:!1}},mounted:function(){i.a.prototype.$hotspot=this.$refs.hotspot,this.load()},methods:{handleAllComponentsReady:function(){this.transitionController=new Z(this),this.resizeScale=1920*window.innerWidth,this.initialized=!1,this.isReady(),this.events(),this.resize()},events:function(){this.$refs.preloaderScreen.show(),this.$deviceStateTracker.addEventListener(L.DeviceStateEvent.STATE_UPDATE,this.deviceStateChange),window.addEventListener("resize",this.resize),this.$webGLApplication.addEventListener(Dn.CLICK,this.handleHotspotClick.bind(this))},handleHotspotClick:function(e){var t=this,n=ao.find(function(t){return t.id===e.data.name});n&&!this.hotspotIsOpen&&(this.hotspotIsOpen=!0,this.$audio.vo.filter(.1),this.$hotspot.show({label:n.label,sound:n.sound,speaker:n.speaker,image:n.image,onClose:function(){t.hotspotIsOpen=!1,t.$audio.vo.unfilter()}}))},onInteract:function(){var e=this;this.$refs.preloaderScreen.hide(),this.$refs.preloaderScreen.hideBackground().then(function(){e.transitionController.showUI(),V.a.go("/intro")}),this.$audio.ambient.play()},toggleSound:function(){this.$audio.muted?this.$audio.unmuteAll():this.$audio.muteAll(),this.muted=this.$audio.muted},load:function(){var e=this;this.loadAssets(),this.$webGLApplication.setup(this.$refs.webGL,!1).load(function(){},function(t){e.progress=Math.round(100*t),1===t&&(e.initialized||(e.$webGLApplication.init(function(){e.$refs.preloaderScreen.showButton()}),e.$webGLApplication.play(),e.initialized=!0))})},loadAssets:function(){var e=this,t=new D.a,n=F()(Bs).map(function(t){return"".concat(e.$versionRoot).concat(t)});return t.loadTasks([new N.LoadVideoTask({assets:n})]).then(function(){})},deviceStateChange:function(e){e.data.state===this.DeviceState.SMALL_HEIGHT?this.resizeScale=window.innerHeight/320:this.resizeScale=window.innerHeight/1080},resize:function(){this.deviceStateChange({data:{state:this.$deviceStateTracker.currentState}});var e={state:this.$deviceStateTracker.currentState,scale:this.resizeScale,DeviceState:this.DeviceState};this.$refs.chapters.resize(e)}}},_o=n(174);var po=Object(d.a)(fo,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.mainPage]},[n("div",{ref:"webGL",class:"webGL"}),e._v(" "),n("div",{class:e.$style.header},[n("Icon",{class:e.$style.logo,attrs:{name:"logo"},on:{click:e.toggleSound}}),e._v(" "),n("div",{class:e.$style.menu},[n("a",{class:[e.$style.btConnect,"copy-2 alt"],attrs:{href:"https://www.airforce.com/#connect ",target:"_blank"}},[e._v("Connect")]),e._v(" "),n("a",{class:[e.$style.btConnect,"copy-2 alt"],attrs:{href:"https://www.airforce.com/apply-now",target:"_blank"}},[e._v("Apply Now")]),e._v(" "),n("MuteButton",{ref:"muteButton",class:e.$style.sound,attrs:{muted:e.muted},on:{click:e.toggleSound}})],1)],1),e._v(" "),n("Hotspot",{ref:"hotspot"}),e._v(" "),n("PreloaderScreen",{ref:"preloaderScreen",class:e.$style.preloaderScreen,attrs:{progress:e.progress},on:{interact:e.onInteract}}),e._v(" "),n("Narration",{ref:"soundPlayer",class:e.$style.soundPlayer,attrs:{"force-hide":e.hotspotIsOpen}}),e._v(" "),n("ChapterNavigation",{ref:"chapters"}),e._v(" "),n("StoryProgress",{ref:"storyProgress",class:e.$style.storyProgress}),e._v(" "),n("RotateDevice",{ref:"rotateDevice",class:e.$style.rotateDevice})],1)},[],!1,function(e){this.$style=_o.default.locals||_o.default},null,null);po.options.__file="MainPage.vue";var vo=po.exports,mo=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),go={name:"WebGLPage",extends:O.AbstractPageTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new mo(this),this.isReady(),this.load()},load:function(){var e=this;this.$webGLApplication.setup(this.$refs.webGL,!0).load(function(){e.$webGLApplication.init()},function(){})}}},Ao=n(175);var yo=Object(d.a)(go,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:[this.$style.webGLPage]},[t("div",{ref:"webGL",class:"webGL"})])},[],!1,function(e){this.$style=Ao.default.locals||Ao.default},null,null);yo.options.__file="WebGLPage.vue";var Eo=yo.exports,To=function(e){function t(){return G()(this,t),X()(this,K()(t).apply(this,arguments))}return Q()(t,e),W()(t,[{key:"setupTransitionInTimeline",value:function(e,t,n){}},{key:"setupTransitionOutTimeline",value:function(e,t,n){}},{key:"setupLoopingAnimationTimeline",value:function(e,t,n){}}]),t}(O.AbstractTransitionController),Co={name:"ComponentPage",extends:O.AbstractPageTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new To(this),this.isReady()}}},wo=n(176);var Ro=Object(d.a)(Co,function(){var e=this.$createElement;return(this._self._c||e)("div",{class:[this.$style.componentPage]})},[],!1,function(e){this.$style=wo.default.locals||wo.default},null,null);Ro.options.__file="ComponentPage.vue";var So=Ro.exports,Io=[{path:x,component:vo,name:b.HOME},{path:k,component:Eo,name:b.WEBGL},{path:M,component:So,name:b.COMPONENT}];i.a.use(p.a);var bo=null,xo=function(){if(!bo){var e=I(),t=R(S),n=e.localeEnabled&&e.localeRoutingEnabled?Object(r.routeParser)(Io,t.getProperty(T.DEFAULT_LOCALE)):Io.concat({path:"*",redirect:"/"});(bo=new p.a({mode:"history",routes:n,base:t.getVariable(E.PUBLIC_PATH)})).beforeEach(function(e,n,i){var r=t.getProperty(T.PERSIST_QUERY_PARAMS),a=!1,s=Object.assign({},e.query);r&&r.length>0&&r.forEach(function(e){"undefined"!==typeof n.query[e]&&"undefined"===typeof s[e]&&(s[e]=n.query[e],a=!0)}),a?i({path:e.path,query:s}):i()})}return bo},ko=n(178),Mo=("".concat("app","/").concat("setDeviceState"),"".concat("app","/").concat("totalTime"),{app:Br});i.a.use(ko.a);var Po,Fo,No,Do,Oo=null,Lo=function(){return Oo||(Oo=new ko.a.Store({modules:Mo,strict:!1})),Oo},Uo=n(66),Bo=n.n(Uo),Vo={install:function(e,t){Object.keys(t).forEach(function(n){e.prototype[n]?console.error("Skipping ".concat(n,". ").concat(n," already exists on the Vue prototype")):Object.defineProperty(e.prototype,n,{get:function(){return t[n]}})})}},Ho=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=dr()({},n,t);return e.replace(/:(\w+)/g,function(e,t){return"undefined"!==typeof i[t]?i[t]||"":e}).replace(/\/:(\w+\?+)/g,function(){return""}).replace(/\?/g,function(){return""}).replace(/:(\w+)/g,function(e,t){throw new Error('Param "'.concat(t,'" is missing in params'),i)})},Go={ID:"id",SLUG:"slug"},zo=[],Wo={isLoaded:function(e){return zo.includes(e)},setLoadCallback:function(e){Po=e},getTranslation:function(e){var t=e.translationKey,i=e.code;return n(575)("./".concat(t,".json")).then(function(e){return zo.push(i),Po&&setTimeout(function(){Po(i)}),e})}},jo=n(57),Xo=function(e){function t(e){var n;return G()(this,t),(n=X()(this,K()(t).call(this))).chunks=[],n.currentText="",n.name="",n.subtitles=e.subtitles,n.name=e.name,n.changeChunk=n.changeChunk.bind(Ye()(Ye()(n))),n.onComplete=n.onComplete.bind(Ye()(Ye()(n))),n.timeline=new J.TimelineMax({paused:!0,onComplete:n.onComplete}),n.buildChunks(),n}return Q()(t,e),W()(t,[{key:"play",value:function(){this.timeline.play()}},{key:"onComplete",value:function(){this.dispatchEvent(new cs(cs.END))}},{key:"destroy",value:function(){this.timeline.kill(),this.timeline.clear(!0),this.dispatchEvent(new cs(cs.END))}},{key:"changeChunk",value:function(e){var t=this;return function(){t.currentText=t.chunks[e],t.dispatchEvent(new cs(cs.UPDATE))}}},{key:"buildChunks",value:function(){for(var e=0;e<this.subtitles.length;e+=1)this.chunks.push(this.subtitles[e].subtitle),this.timeline.call(this.changeChunk(e),[],this,this.subtitles[e].at)}},{key:"subtitle",get:function(){return{text:this.currentText,name:this.name}}}]),t}(ci.a),Yo=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).call(this))).onUpdate=e.onUpdate.bind(Ye()(Ye()(e))),e.onEnd=e.onEnd.bind(Ye()(Ye()(e))),e}return Q()(t,e),W()(t,[{key:"onUpdate",value:function(){this.dispatchEvent(new cs(cs.UPDATE))}},{key:"onEnd",value:function(){this.dispatchEvent(new cs(cs.END))}},{key:"play",value:function(e){this.current&&(this.current.removeEventListener(cs.END,this.onUpdate),this.current.removeEventListener(cs.UPDATE,this.onUpdate),this.current.destroy()),this.current=new Xo(e),this.current.addEventListener(cs.UPDATE,this.onUpdate),this.current.addEventListener(cs.END,this.onEnd),this.current.play()}},{key:"text",get:function(){return this.current.subtitle}}]),t}(ci.a),Ko=(F()(Li).concat(F()(Ti),F()(Ls),F()(zi)),function(){function e(){G()(this,e),this.vo=new Ui,this.music=new Ci,this.ambient=new Us,this.sfx=new Wi,this.events()}return W()(e,[{key:"handleVisibilityChange",value:function(){document.hidden?gi.Howler.mute(!0):this.muted||gi.Howler.mute(!1)}},{key:"muteAll",value:function(){this.muted=!0,gi.Howler.mute(!0)}},{key:"unmuteAll",value:function(){this.muted=!1,gi.Howler.mute(!1)}},{key:"events",value:function(){var e=this;document.addEventListener("visibilitychange",this.handleVisibilityChange,!1),this.vo.addEventListener(Mi.NARRATION_START,function(){e.ambient.filter(),e.music.filter(),e.sfx.filter()}),this.vo.addEventListener(Mi.NARRATION_END,function(){e.ambient.unfilter(),e.music.unfilter(),e.sfx.unfilter()})}}]),e}()),$o=null,Qo=function(){return $o||($o=new Ko),$o},Jo=function(e){function t(){var e;return G()(this,t),(e=X()(this,K()(t).call(this))).subtitles=new Yo,e.audio=Qo(),e.onEnd=e.onEnd.bind(Ye()(Ye()(e))),e.subtitles.addEventListener(cs.END,e.onEnd),e}return Q()(t,e),W()(t,[{key:"onEnd",value:function(){this.dispatchEvent(new ms(ms.END))}},{key:"play",value:function(e){this.subtitles.play(e),this.audio.vo.play(e.sound),this.dispatchEvent(new ms(ms.START))}},{key:"subtitle",get:function(){return this.subtitles}}]),t}(si.a),Zo=null,qo=function(){return Zo||(Zo=new Jo),Zo},el=function(e){!function(){var e=R(S);i.a.use(Vo,{$config:e,$gateway:R("gateway"),$http:Bo.a,$versionRoot:e.getVariable(E.VERSIONED_STATIC_ROOT),$staticRoot:e.getVariable(E.STATIC_ROOT),URLNames:y,PropertyNames:T,VariableNames:E,RouteNames:b,Params:Go,createPath:Ho,$deviceStateTracker:R("deviceStateTracker"),DeviceState:jo.a,$webGLApplication:ui(),$narration:qo(),$audio:Qo()})}();var t=R(S);return Promise.all([t.getVariable(E.LOCALE_ENABLED)?function(e){return new Promise(function(t){Wo.isLoaded(e.getters.currentLanguage.code)?t():Wo.setLoadCallback(function(n){n===e.getters.currentLanguage.code&&t()})})}(e):Promise.resolve(),Promise.resolve()])},tl=n(249),nl=n.n(tl),il={environments:(Fo={},Te()(Fo,v,{variables:{},urls:{}}),Te()(Fo,g,{extends:v,variables:{},urls:{}}),Te()(Fo,m,{extends:g,variables:{},urls:{}}),Te()(Fo,A,{extends:m,variables:{},urls:{}}),Fo),variables:(No={},Te()(No,E.LOCALE_ENABLED,!1),Te()(No,E.LOCALE_ROUTING_ENABLED,!1),Te()(No,E.VERSIONED_STATIC_ROOT,(window.webpackPublicPath||"/intothestorm/")+"version/1611764881753/static/"),Te()(No,E.STATIC_ROOT,(window.webpackPublicPath||"/intothestorm/")+""),Te()(No,E.PUBLIC_PATH,window.webpackPublicPath||"/intothestorm/"),No),urls:Te()({},y.API,"".concat("/intothestorm/","api/")),properties:(Do={},Te()(Do,T.DEFAULT_LOCALE,"en-gb"),Te()(Do,T.AVAILABLE_LOCALES,["en-gb","en-us"]),Te()(Do,T.PERSIST_QUERY_PARAMS,[]),Do)},rl=v;switch(document.location.host.split(":").shift()){case"localhost":rl=A;break;default:rl=v}var al={config:il,environment:rl},sl=function(){var e=new nl.a;e.init(al.config,al.environment);var t=Uo.create({baseURL:e.getURL(y.API),headers:{Accept:"application/json"},responseType:"json"});t.interceptors.response.use(function(e){return function(e){return e&&e.data&&"undefined"!==typeof e.data.data?dr()({},e,e.data):e}(e)},function(e){throw function(e){if(e&&e.response&&e.response.data&&e.response.data.error){var t=dr()({config:e.config},e.response,e.response.data);return delete t.data,t}return e}(e)});var n=Object.keys(jo.b).reduce(function(e,t){return e[t]=jo.b[t].replace(/'/g,""),e},{});w("deviceStateTracker",new U.a({mediaQueries:n,deviceState:jo.a,showStateIndicator:!1})),w(S,e),w("gateway",t)},ol={name:"App",components:{CTAButton:Ji},computed:{ifInternetExplorer:function(){var e=window.navigator.userAgent;return e.indexOf("MSIE")>0||e.indexOf("Trident/")>0}},mounted:function(){this.$refs.cta&&this.$refs.cta.transitionIn()}},ll=n(179);var ul=Object(d.a)(ol,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.app]},[e.ifInternetExplorer?n("div",{class:e.$style.noIeMessage},[n("main",[e._m(0),e._v(" "),n("CTAButton",{ref:"cta",class:e.$style.cta,attrs:{label:"Back to Airforce.com",link:"https://airforce.com",theme:"primary"}})],1)]):[n("div",{ref:"webGL",class:e.$style.webGL}),e._v(" "),n("router-view")]],2)},[function(){var e=this.$createElement,t=this._self._c||e;return t("h5",[this._v("Into the Storm uses advanced web graphics optimized for Google Chrome and performs best when viewed using that browser."),t("br"),this._v("\n        These functions are not supported by Internet Explorer.")])}],!1,function(e){this.$style=ll.default.locals||ll.default},null,null);ul.options.__file="App.vue";var hl=ul.exports,cl={};Object.keys(cl).forEach(function(e){return i.a.filter(e,cl[e])}),Object.keys(l).forEach(function(e){return i.a.directive(e,l[e])}),Object.keys(_).forEach(function(e){return i.a.component(e,_[e])}),sl(),window.webpackPublicPath&&(n.p=window.webpackPublicPath);var dl=xo(),fl=Lo(),_l=I();_l.localeEnabled&&(i.a.use(a.a,{store:fl,router:_l.localeRoutingEnabled?dl:null,config:_l.config,proxy:Wo}),i.a.initI18nManager()),Object(s.sync)(fl,dl);var pl=new i.a({router:dl,store:fl,render:function(e){return e(hl)}});el(fl).then(function(){document.addEventListener("touchmove",function(e){1!==e.scale&&e.preventDefault()},!1),pl.$mount("#app")})}]));