(()=>{var t={98234:function(t,e,i){"undefined"!=typeof navigator&&(t.exports=function(){"use strict";var t="http://www.w3.org/2000/svg",n="",r=!1,s=-999999,a=function(t){r=!!t},o=function(){return r},l=function(t){n=t},h=function(){return n};function c(t){return document.createElement(t)}function u(t,e){var i,n,r=t.length;for(i=0;i<r;i+=1)for(var s in n=t[i].prototype)Object.prototype.hasOwnProperty.call(n,s)&&(e.prototype[s]=n[s])}function d(t){function e(){}return e.prototype=t,e}var p=function(){function t(t){this.audios=[],this.audioFactory=t,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(t){this.audios.push(t)},pause:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].pause()},resume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].resume()},setRate:function(t){var e,i=this.audios.length;for(e=0;e<i;e+=1)this.audios[e].setRate(t)},createAudio:function(t){return this.audioFactory?this.audioFactory(t):window.Howl?new window.Howl({src:[t]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(t){this.audioFactory=t},setVolume:function(t){this._volume=t,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),f=function(){function t(t,e){var i,n=0,r=[];switch(t){case"int16":case"uint8c":i=1;break;default:i=1.1}for(n=0;n<e;n+=1)r.push(i);return r}function e(e,i){return"float32"===e?new Float32Array(i):"int16"===e?new Int16Array(i):"uint8c"===e?new Uint8ClampedArray(i):t(e,i)}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?e:t}();function m(t){return Array.apply(null,{length:t})}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}var _=!0,v=null,y=null,x="",S=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),M=Math.pow,b=Math.sqrt,T=Math.floor,w=(Math.max,Math.min),E={};(function(){var t,e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],i=e.length;for(t=0;t<i;t+=1)E[e[t]]=Math[e[t]]})(),E.random=Math.random,E.abs=function(t){if("object"===g(t)&&t.length){var e,i=m(t.length),n=t.length;for(e=0;e<n;e+=1)i[e]=Math.abs(t[e]);return i}return Math.abs(t)};var A=150,C=Math.PI/180,P=.5519;function L(t){}function R(t,e,i,n){this.type=t,this.currentTime=e,this.totalTime=i,this.direction=n<0?-1:1}function D(t,e){this.type=t,this.direction=e<0?-1:1}function I(t,e,i,n){this.type=t,this.currentLoop=i,this.totalLoops=e,this.direction=n<0?-1:1}function U(t,e,i){this.type=t,this.firstFrame=e,this.totalFrames=i}function N(t,e){this.type=t,this.target=e}function O(t,e){this.type="renderFrameError",this.nativeError=t,this.currentTime=e}function k(t){this.type="configError",this.nativeError=t}var F,z=(F=0,function(){return x+"__lottie_element_"+(F+=1)});function B(t,e,i){var n,r,s,a,o,l,h,c;switch(l=i*(1-e),h=i*(1-(o=6*t-(a=Math.floor(6*t)))*e),c=i*(1-(1-o)*e),a%6){case 0:n=i,r=c,s=l;break;case 1:n=h,r=i,s=l;break;case 2:n=l,r=i,s=c;break;case 3:n=l,r=h,s=i;break;case 4:n=c,r=l,s=i;break;case 5:n=i,r=l,s=h}return[n,r,s]}function V(t,e,i){var n,r=Math.max(t,e,i),s=Math.min(t,e,i),a=r-s,o=0===r?0:a/r,l=r/255;switch(r){case s:n=0;break;case t:n=e-i+a*(e<i?6:0),n/=6*a;break;case e:n=i-t+2*a,n/=6*a;break;case i:n=t-e+4*a,n/=6*a}return[n,o,l]}function H(t,e){var i=V(255*t[0],255*t[1],255*t[2]);return i[1]+=e,i[1]>1?i[1]=1:i[1]<=0&&(i[1]=0),B(i[0],i[1],i[2])}function G(t,e){var i=V(255*t[0],255*t[1],255*t[2]);return i[2]+=e,i[2]>1?i[2]=1:i[2]<0&&(i[2]=0),B(i[0],i[1],i[2])}function W(t,e){var i=V(255*t[0],255*t[1],255*t[2]);return i[0]+=e/360,i[0]>1?i[0]-=1:i[0]<0&&(i[0]+=1),B(i[0],i[1],i[2])}!function(){var t,e,i=[];for(t=0;t<256;t+=1)e=t.toString(16),i[t]=1===e.length?"0"+e:e}();var X=function(t){_=!!t},q=function(){return _},Y=function(t){v=t},j=function(){return v},Z=function(){return y},K=function(t){A=t},J=function(){return A},$=function(t){x=t};function Q(e){return document.createElementNS(t,e)}function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}var et=function(){var t,e,i=1,n=[],r={onmessage:function(){},postMessage:function(e){t({data:e})}},s={postMessage:function(t){r.onmessage({data:t})}};function a(e){if(window.Worker&&window.Blob&&o()){var i=new Blob(["var _workerSelf = self; self.onmessage = ",e.toString()],{type:"text/javascript"}),n=URL.createObjectURL(i);return new Worker(n)}return t=e,r}function l(){e||(e=a((function(t){function e(){function t(e,i){var a,o,l,h,c,u,d=e.length;for(o=0;o<d;o+=1)if("ks"in(a=e[o])&&!a.completed){if(a.completed=!0,a.hasMask){var p=a.masksProperties;for(h=p.length,l=0;l<h;l+=1)if(p[l].pt.k.i)s(p[l].pt.k);else for(u=p[l].pt.k.length,c=0;c<u;c+=1)p[l].pt.k[c].s&&s(p[l].pt.k[c].s[0]),p[l].pt.k[c].e&&s(p[l].pt.k[c].e[0])}0===a.ty?(a.layers=n(a.refId,i),t(a.layers,i)):4===a.ty?r(a.shapes):5===a.ty&&f(a)}}function e(e,i){if(e){var r=0,s=e.length;for(r=0;r<s;r+=1)1===e[r].t&&(e[r].data.layers=n(e[r].data.refId,i),t(e[r].data.layers,i))}}function i(t,e){for(var i=0,n=e.length;i<n;){if(e[i].id===t)return e[i];i+=1}return null}function n(t,e){var n=i(t,e);return n?n.layers.__used?JSON.parse(JSON.stringify(n.layers)):(n.layers.__used=!0,n.layers):null}function r(t){var e,i,n;for(e=t.length-1;e>=0;e-=1)if("sh"===t[e].ty)if(t[e].ks.k.i)s(t[e].ks.k);else for(n=t[e].ks.k.length,i=0;i<n;i+=1)t[e].ks.k[i].s&&s(t[e].ks.k[i].s[0]),t[e].ks.k[i].e&&s(t[e].ks.k[i].e[0]);else"gr"===t[e].ty&&r(t[e].it)}function s(t){var e,i=t.i.length;for(e=0;e<i;e+=1)t.i[e][0]+=t.v[e][0],t.i[e][1]+=t.v[e][1],t.o[e][0]+=t.v[e][0],t.o[e][1]+=t.v[e][1]}function a(t,e){var i=e?e.split("."):[100,100,100];return t[0]>i[0]||!(i[0]>t[0])&&(t[1]>i[1]||!(i[1]>t[1])&&(t[2]>i[2]||!(i[2]>t[2])&&null))}var o,l=function(){var t=[4,4,14];function e(t){var e=t.t.d;t.t.d={k:[{s:e,t:0}]}}function i(t){var i,n=t.length;for(i=0;i<n;i+=1)5===t[i].ty&&e(t[i])}return function(e){if(a(t,e.v)&&(i(e.layers),e.assets)){var n,r=e.assets.length;for(n=0;n<r;n+=1)e.assets[n].layers&&i(e.assets[n].layers)}}}(),h=(o=[4,7,99],function(t){if(t.chars&&!a(o,t.v)){var e,i=t.chars.length;for(e=0;e<i;e+=1){var n=t.chars[e];n.data&&n.data.shapes&&(r(n.data.shapes),n.data.ip=0,n.data.op=99999,n.data.st=0,n.data.sr=1,n.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},t.chars[e].t||(n.data.shapes.push({ty:"no"}),n.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}),c=function(){var t=[5,7,15];function e(t){var e=t.t.p;"number"==typeof e.a&&(e.a={a:0,k:e.a}),"number"==typeof e.p&&(e.p={a:0,k:e.p}),"number"==typeof e.r&&(e.r={a:0,k:e.r})}function i(t){var i,n=t.length;for(i=0;i<n;i+=1)5===t[i].ty&&e(t[i])}return function(e){if(a(t,e.v)&&(i(e.layers),e.assets)){var n,r=e.assets.length;for(n=0;n<r;n+=1)e.assets[n].layers&&i(e.assets[n].layers)}}}(),u=function(){var t=[4,1,9];function e(t){var i,n,r,s=t.length;for(i=0;i<s;i+=1)if("gr"===t[i].ty)e(t[i].it);else if("fl"===t[i].ty||"st"===t[i].ty)if(t[i].c.k&&t[i].c.k[0].i)for(r=t[i].c.k.length,n=0;n<r;n+=1)t[i].c.k[n].s&&(t[i].c.k[n].s[0]/=255,t[i].c.k[n].s[1]/=255,t[i].c.k[n].s[2]/=255,t[i].c.k[n].s[3]/=255),t[i].c.k[n].e&&(t[i].c.k[n].e[0]/=255,t[i].c.k[n].e[1]/=255,t[i].c.k[n].e[2]/=255,t[i].c.k[n].e[3]/=255);else t[i].c.k[0]/=255,t[i].c.k[1]/=255,t[i].c.k[2]/=255,t[i].c.k[3]/=255}function i(t){var i,n=t.length;for(i=0;i<n;i+=1)4===t[i].ty&&e(t[i].shapes)}return function(e){if(a(t,e.v)&&(i(e.layers),e.assets)){var n,r=e.assets.length;for(n=0;n<r;n+=1)e.assets[n].layers&&i(e.assets[n].layers)}}}(),d=function(){var t=[4,4,18];function e(t){var i,n,r;for(i=t.length-1;i>=0;i-=1)if("sh"===t[i].ty)if(t[i].ks.k.i)t[i].ks.k.c=t[i].closed;else for(r=t[i].ks.k.length,n=0;n<r;n+=1)t[i].ks.k[n].s&&(t[i].ks.k[n].s[0].c=t[i].closed),t[i].ks.k[n].e&&(t[i].ks.k[n].e[0].c=t[i].closed);else"gr"===t[i].ty&&e(t[i].it)}function i(t){var i,n,r,s,a,o,l=t.length;for(n=0;n<l;n+=1){if((i=t[n]).hasMask){var h=i.masksProperties;for(s=h.length,r=0;r<s;r+=1)if(h[r].pt.k.i)h[r].pt.k.c=h[r].cl;else for(o=h[r].pt.k.length,a=0;a<o;a+=1)h[r].pt.k[a].s&&(h[r].pt.k[a].s[0].c=h[r].cl),h[r].pt.k[a].e&&(h[r].pt.k[a].e[0].c=h[r].cl)}4===i.ty&&e(i.shapes)}}return function(e){if(a(t,e.v)&&(i(e.layers),e.assets)){var n,r=e.assets.length;for(n=0;n<r;n+=1)e.assets[n].layers&&i(e.assets[n].layers)}}}();function p(i){i.__complete||(u(i),l(i),h(i),c(i),d(i),t(i.layers,i.assets),e(i.chars,i.assets),i.__complete=!0)}function f(t){0===t.t.a.length&&t.t.p}var m={};return m.completeData=p,m.checkColors=u,m.checkChars=h,m.checkPathProperties=c,m.checkShapes=d,m.completeLayers=t,m}if(s.dataManager||(s.dataManager=e()),s.assetLoader||(s.assetLoader=function(){function t(t){var e=t.getResponseHeader("content-type");return e&&"json"===t.responseType&&-1!==e.indexOf("json")||t.response&&"object"===tt(t.response)?t.response:t.response&&"string"==typeof t.response?JSON.parse(t.response):t.responseText?JSON.parse(t.responseText):null}function e(e,i,n,r){var s,a=new XMLHttpRequest;try{a.responseType="json"}catch(t){}a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)s=t(a),n(s);else try{s=t(a),n(s)}catch(t){r&&r(t)}};try{a.open(["G","E","T"].join(""),e,!0)}catch(t){a.open(["G","E","T"].join(""),i+"/"+e,!0)}a.send()}return{load:e}}()),"loadAnimation"===t.data.type)s.assetLoader.load(t.data.path,t.data.fullPath,(function(e){s.dataManager.completeData(e),s.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){s.postMessage({id:t.data.id,status:"error"})}));else if("complete"===t.data.type){var i=t.data.animation;s.dataManager.completeData(i),s.postMessage({id:t.data.id,payload:i,status:"success"})}else"loadData"===t.data.type&&s.assetLoader.load(t.data.path,t.data.fullPath,(function(e){s.postMessage({id:t.data.id,payload:e,status:"success"})}),(function(){s.postMessage({id:t.data.id,status:"error"})}))})),e.onmessage=function(t){var e=t.data,i=e.id,r=n[i];n[i]=null,"success"===e.status?r.onComplete(e.payload):r.onError&&r.onError()})}function h(t,e){var r="processId_"+(i+=1);return n[r]={onComplete:t,onError:e},r}function c(t,i,n){l();var r=h(i,n);e.postMessage({type:"loadAnimation",path:t,fullPath:window.location.origin+window.location.pathname,id:r})}function u(t,i,n){l();var r=h(i,n);e.postMessage({type:"loadData",path:t,fullPath:window.location.origin+window.location.pathname,id:r})}function d(t,i,n){l();var r=h(i,n);e.postMessage({type:"complete",animation:t,id:r})}return{loadAnimation:c,loadData:u,completeAnimation:d}}(),it=function(){var t=function(){var t=c("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),t}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function i(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(t,e,i){var n="";if(t.e)n=t.p;else if(e){var r=t.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),n=e+r}else n=i,n+=t.u?t.u:"",n+=t.p;return n}function r(t){var e=0,i=setInterval(function(){(t.getBBox().width||e>500)&&(this._imageLoaded(),clearInterval(i)),e+=1}.bind(this),50)}function s(e){var i=n(e,this.assetsPath,this.path),r=Q("image");S?this.testImageLoaded(r):r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){s.img=t,this._imageLoaded()}.bind(this),!1),r.setAttributeNS("http://www.w3.org/1999/xlink","href",i),this._elementHelper.append?this._elementHelper.append(r):this._elementHelper.appendChild(r);var s={img:r,assetData:e};return s}function a(e){var i=n(e,this.assetsPath,this.path),r=c("img");r.crossOrigin="anonymous",r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){s.img=t,this._imageLoaded()}.bind(this),!1),r.src=i;var s={img:r,assetData:e};return s}function o(t){var e={assetData:t},i=n(t,this.assetsPath,this.path);return et.loadData(i,function(t){e.img=t,this._footageLoaded()}.bind(this),function(){e.img={},this._footageLoaded()}.bind(this)),e}function l(t,e){var i;this.imagesLoadedCb=e;var n=t.length;for(i=0;i<n;i+=1)t[i].layers||(t[i].t&&"seq"!==t[i].t?3===t[i].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(t[i]))):(this.totalImages+=1,this.images.push(this._createImageData(t[i]))))}function h(t){this.path=t||""}function u(t){this.assetsPath=t||""}function d(t){for(var e=0,i=this.images.length;e<i;){if(this.images[e].assetData===t)return this.images[e].img;e+=1}return null}function p(){this.imagesLoadedCb=null,this.images.length=0}function f(){return this.totalImages===this.loadedAssets}function m(){return this.totalFootages===this.loadedFootagesCount}function g(t,e){"svg"===t?(this._elementHelper=e,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function _(){this._imageLoaded=e.bind(this),this._footageLoaded=i.bind(this),this.testImageLoaded=r.bind(this),this.createFootageData=o.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return _.prototype={loadAssets:l,setAssetsPath:u,setPath:h,loadedImages:f,loadedFootages:m,destroy:p,getAsset:d,createImgData:a,createImageData:s,imageLoaded:e,footageLoaded:i,setCacheType:g},_}();function nt(){}nt.prototype={triggerEvent:function(t,e){if(this._cbs[t])for(var i=this._cbs[t],n=0;n<i.length;n+=1)i[n](e)},addEventListener:function(t,e){return this._cbs[t]||(this._cbs[t]=[]),this._cbs[t].push(e),function(){this.removeEventListener(t,e)}.bind(this)},removeEventListener:function(t,e){if(e){if(this._cbs[t]){for(var i=0,n=this._cbs[t].length;i<n;)this._cbs[t][i]===e&&(this._cbs[t].splice(i,1),i-=1,n-=1),i+=1;this._cbs[t].length||(this._cbs[t]=null)}}else this._cbs[t]=null}};var rt=function(){function t(t){for(var e,i=t.split("\r\n"),n={},r=0,s=0;s<i.length;s+=1)2===(e=i[s].split(":")).length&&(n[e[0]]=e[1].trim(),r+=1);if(0===r)throw new Error;return n}return function(e){for(var i=[],n=0;n<e.length;n+=1){var r=e[n],s={time:r.tm,duration:r.dr};try{s.payload=JSON.parse(e[n].cm)}catch(i){try{s.payload=t(e[n].cm)}catch(t){s.payload={name:e[n].cm}}}i.push(s)}return i}}(),st=function(){function t(t){this.compositions.push(t)}return function(){function e(t){for(var e=0,i=this.compositions.length;e<i;){if(this.compositions[e].data&&this.compositions[e].data.nm===t)return this.compositions[e].prepareFrame&&this.compositions[e].data.xt&&this.compositions[e].prepareFrame(this.currentFrame),this.compositions[e].compInterface;e+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),at={},ot=function(t,e){at[t]=e};function lt(t){return at[t]}function ht(){if(at.canvas)return"canvas";for(var t in at)if(at[t])return t;return""}function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}var ut=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=z(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=q(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=st(),this.imagePreloader=new it,this.audioController=p(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new R("drawnFrame",0,0,0),this.expressionsPlugin=j()};u([nt],ut),ut.prototype.setParams=function(t){(t.wrapper||t.container)&&(this.wrapper=t.wrapper||t.container);var e="svg";t.animType?e=t.animType:t.renderer&&(e=t.renderer);var i=lt(e);this.renderer=new i(this,t.rendererSettings),this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,""===t.loop||null===t.loop||void 0===t.loop||!0===t.loop?this.loop=!0:!1===t.loop?this.loop=!1:this.loop=parseInt(t.loop,10),this.autoplay=!("autoplay"in t)||t.autoplay,this.name=t.name?t.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(t,"autoloadSegments")||t.autoloadSegments,this.assetsPath=t.assetsPath,this.initialSegment=t.initialSegment,t.audioFactory&&this.audioController.setAudioFactory(t.audioFactory),t.animationData?this.setupAnimation(t.animationData):t.path&&(-1!==t.path.lastIndexOf("\\")?this.path=t.path.substr(0,t.path.lastIndexOf("\\")+1):this.path=t.path.substr(0,t.path.lastIndexOf("/")+1),this.fileName=t.path.substr(t.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),et.loadAnimation(t.path,this.configAnimation,this.onSetupError))},ut.prototype.onSetupError=function(){this.trigger("data_failed")},ut.prototype.setupAnimation=function(t){et.completeAnimation(t,this.configAnimation)},ut.prototype.setData=function(t,e){e&&"object"!==ct(e)&&(e=JSON.parse(e));var i={wrapper:t,animationData:e},n=t.attributes;i.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",i.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:ht()||"canvas";var r=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";"false"===r?i.loop=!1:"true"===r?i.loop=!0:""!==r&&(i.loop=parseInt(r,10));var s=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:!n.getNamedItem("bm-autoplay")||n.getNamedItem("bm-autoplay").value;i.autoplay="false"!==s,i.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"","false"===(n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"")&&(i.prerender=!1),i.path?this.setParams(i):this.trigger("destroy")},ut.prototype.includeLayers=function(t){t.op>this.animationData.op&&(this.animationData.op=t.op,this.totalFrames=Math.floor(t.op-this.animationData.ip));var e,i,n=this.animationData.layers,r=n.length,s=t.layers,a=s.length;for(i=0;i<a;i+=1)for(e=0;e<r;){if(n[e].id===s[i].id){n[e]=s[i];break}e+=1}if((t.chars||t.fonts)&&(this.renderer.globalData.fontManager.addChars(t.chars),this.renderer.globalData.fontManager.addFonts(t.fonts,this.renderer.globalData.defs)),t.assets)for(r=t.assets.length,e=0;e<r;e+=1)this.animationData.assets.push(t.assets[e]);this.animationData.__complete=!1,et.completeAnimation(this.animationData,this.onSegmentComplete)},ut.prototype.onSegmentComplete=function(t){this.animationData=t;var e=j();e&&e.initExpressions(this),this.loadNextSegment()},ut.prototype.loadNextSegment=function(){var t=this.animationData.segments;if(!t||0===t.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var e=t.shift();this.timeCompleted=e.time*this.frameRate;var i=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,et.loadData(i,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},ut.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},ut.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},ut.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},ut.prototype.configAnimation=function(t){if(this.renderer)try{this.animationData=t,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(t),t.assets||(t.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(t.assets),this.markers=rt(t.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},ut.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},ut.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var t=j();t&&t.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},ut.prototype.resize=function(t,e){var i="number"==typeof t?t:void 0,n="number"==typeof e?e:void 0;this.renderer.updateContainerSize(i,n)},ut.prototype.setSubframe=function(t){this.isSubframeEnabled=!!t},ut.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},ut.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(t){this.triggerRenderFrameError(t)}},ut.prototype.play=function(t){t&&this.name!==t||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},ut.prototype.pause=function(t){t&&this.name!==t||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},ut.prototype.togglePause=function(t){t&&this.name!==t||(!0===this.isPaused?this.play():this.pause())},ut.prototype.stop=function(t){t&&this.name!==t||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},ut.prototype.getMarkerData=function(t){for(var e,i=0;i<this.markers.length;i+=1)if((e=this.markers[i]).payload&&e.payload.name===t)return e;return null},ut.prototype.goToAndStop=function(t,e,i){if(!i||this.name===i){var n=Number(t);if(isNaN(n)){var r=this.getMarkerData(t);r&&this.goToAndStop(r.time,!0)}else e?this.setCurrentRawFrameValue(t):this.setCurrentRawFrameValue(t*this.frameModifier);this.pause()}},ut.prototype.goToAndPlay=function(t,e,i){if(!i||this.name===i){var n=Number(t);if(isNaN(n)){var r=this.getMarkerData(t);r&&(r.duration?this.playSegments([r.time,r.time+r.duration],!0):this.goToAndStop(r.time,!0))}else this.goToAndStop(n,e,i);this.play()}},ut.prototype.advanceTime=function(t){if(!0!==this.isPaused&&!1!==this.isLoaded){var e=this.currentRawFrame+t*this.frameModifier,i=!1;e>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(i=!0,e=this.totalFrames-1):e<0?this.checkSegments(e%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(i=!0,e=0):(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(e),i&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},ut.prototype.adjustSegment=function(t,e){this.playCount=0,t[1]<t[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=t[0]-t[1],this.timeCompleted=this.totalFrames,this.firstFrame=t[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):t[1]>t[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=t[1]-t[0],this.timeCompleted=this.totalFrames,this.firstFrame=t[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},ut.prototype.setSegment=function(t,e){var i=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<t?i=t:this.currentRawFrame+this.firstFrame>e&&(i=e-t)),this.firstFrame=t,this.totalFrames=e-t,this.timeCompleted=this.totalFrames,-1!==i&&this.goToAndStop(i,!0)},ut.prototype.playSegments=function(t,e){if(e&&(this.segments.length=0),"object"===ct(t[0])){var i,n=t.length;for(i=0;i<n;i+=1)this.segments.push(t[i])}else this.segments.push(t);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},ut.prototype.resetSegments=function(t){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),t&&this.checkSegments(0)},ut.prototype.checkSegments=function(t){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),t),!0)},ut.prototype.destroy=function(t){t&&this.name!==t||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},ut.prototype.setCurrentRawFrameValue=function(t){this.currentRawFrame=t,this.gotoFrame()},ut.prototype.setSpeed=function(t){this.playSpeed=t,this.updaFrameModifier()},ut.prototype.setDirection=function(t){this.playDirection=t<0?-1:1,this.updaFrameModifier()},ut.prototype.setLoop=function(t){this.loop=t},ut.prototype.setVolume=function(t,e){e&&this.name!==e||this.audioController.setVolume(t)},ut.prototype.getVolume=function(){return this.audioController.getVolume()},ut.prototype.mute=function(t){t&&this.name!==t||this.audioController.mute()},ut.prototype.unmute=function(t){t&&this.name!==t||this.audioController.unmute()},ut.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},ut.prototype.getPath=function(){return this.path},ut.prototype.getAssetsPath=function(t){var e="";if(t.e)e=t.p;else if(this.assetsPath){var i=t.p;-1!==i.indexOf("images/")&&(i=i.split("/")[1]),e=this.assetsPath+i}else e=this.path,e+=t.u?t.u:"",e+=t.p;return e},ut.prototype.getAssetData=function(t){for(var e=0,i=this.assets.length;e<i;){if(t===this.assets[e].id)return this.assets[e];e+=1}return null},ut.prototype.hide=function(){this.renderer.hide()},ut.prototype.show=function(){this.renderer.show()},ut.prototype.getDuration=function(t){return t?this.totalFrames:this.totalFrames/this.frameRate},ut.prototype.updateDocumentData=function(t,e,i){try{this.renderer.getElementByPath(t).updateDocumentData(e,i)}catch(t){}},ut.prototype.trigger=function(t){if(this._cbs&&this._cbs[t])switch(t){case"enterFrame":this.triggerEvent(t,new R(t,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(t,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(t,new I(t,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(t,new D(t,this.frameMult));break;case"segmentStart":this.triggerEvent(t,new U(t,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(t,new N(t,this));break;default:this.triggerEvent(t)}"enterFrame"===t&&this.onEnterFrame&&this.onEnterFrame.call(this,new R(t,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===t&&this.onLoopComplete&&this.onLoopComplete.call(this,new I(t,this.loop,this.playCount,this.frameMult)),"complete"===t&&this.onComplete&&this.onComplete.call(this,new D(t,this.frameMult)),"segmentStart"===t&&this.onSegmentStart&&this.onSegmentStart.call(this,new U(t,this.firstFrame,this.totalFrames)),"destroy"===t&&this.onDestroy&&this.onDestroy.call(this,new N(t,this))},ut.prototype.triggerRenderFrameError=function(t){var e=new O(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},ut.prototype.triggerConfigError=function(t){var e=new k(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var dt=function(){var t={},e=[],i=0,n=0,r=0,s=!0,a=!1;function o(t){for(var i=0,r=t.target;i<n;)e[i].animation===r&&(e.splice(i,1),i-=1,n-=1,r.isPaused||d()),i+=1}function l(t,i){if(!t)return null;for(var r=0;r<n;){if(e[r].elem===t&&null!==e[r].elem)return e[r].animation;r+=1}var s=new ut;return p(s,t),s.setData(t,i),s}function h(){var t,i=e.length,n=[];for(t=0;t<i;t+=1)n.push(e[t].animation);return n}function u(){r+=1,A()}function d(){r-=1}function p(t,i){t.addEventListener("destroy",o),t.addEventListener("_active",u),t.addEventListener("_idle",d),e.push({elem:i,animation:t}),n+=1}function f(t){var e=new ut;return p(e,null),e.setParams(t),e}function m(t,i){var r;for(r=0;r<n;r+=1)e[r].animation.setSpeed(t,i)}function g(t,i){var r;for(r=0;r<n;r+=1)e[r].animation.setDirection(t,i)}function _(t){var i;for(i=0;i<n;i+=1)e[i].animation.play(t)}function v(t){var o,l=t-i;for(o=0;o<n;o+=1)e[o].animation.advanceTime(l);i=t,r&&!a?window.requestAnimationFrame(v):s=!0}function y(t){i=t,window.requestAnimationFrame(v)}function x(t){var i;for(i=0;i<n;i+=1)e[i].animation.pause(t)}function S(t,i,r){var s;for(s=0;s<n;s+=1)e[s].animation.goToAndStop(t,i,r)}function M(t){var i;for(i=0;i<n;i+=1)e[i].animation.stop(t)}function b(t){var i;for(i=0;i<n;i+=1)e[i].animation.togglePause(t)}function T(t){var i;for(i=n-1;i>=0;i-=1)e[i].animation.destroy(t)}function w(t,e,i){var n,r=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),s=r.length;for(n=0;n<s;n+=1)i&&r[n].setAttribute("data-bm-type",i),l(r[n],t);if(e&&0===s){i||(i="svg");var a=document.getElementsByTagName("body")[0];a.innerText="";var o=c("div");o.style.width="100%",o.style.height="100%",o.setAttribute("data-bm-type",i),a.appendChild(o),l(o,t)}}function E(){var t;for(t=0;t<n;t+=1)e[t].animation.resize()}function A(){!a&&r&&s&&(window.requestAnimationFrame(y),s=!1)}function C(){a=!0}function P(){a=!1,A()}function L(t,i){var r;for(r=0;r<n;r+=1)e[r].animation.setVolume(t,i)}function R(t){var i;for(i=0;i<n;i+=1)e[i].animation.mute(t)}function D(t){var i;for(i=0;i<n;i+=1)e[i].animation.unmute(t)}return t.registerAnimation=l,t.loadAnimation=f,t.setSpeed=m,t.setDirection=g,t.play=_,t.pause=x,t.stop=M,t.togglePause=b,t.searchAnimations=w,t.resize=E,t.goToAndStop=S,t.destroy=T,t.freeze=C,t.unfreeze=P,t.setVolume=L,t.mute=R,t.unmute=D,t.getRegisteredAnimations=h,t}(),pt=function(){var t={};t.getBezierEasing=i;var e={};function i(t,i,n,r,s){var a=s||("bez_"+t+"_"+i+"_"+n+"_"+r).replace(/\./g,"p");if(e[a])return e[a];var o=new _([t,i,n,r]);return e[a]=o,o}var n=4,r=.001,s=1e-7,a=10,o=11,l=1/(o-1),h="function"==typeof Float32Array;function c(t,e){return 1-3*e+3*t}function u(t,e){return 3*e-6*t}function d(t){return 3*t}function p(t,e,i){return((c(e,i)*t+u(e,i))*t+d(e))*t}function f(t,e,i){return 3*c(e,i)*t*t+2*u(e,i)*t+d(e)}function m(t,e,i,n,r){var o,l,h=0;do{(o=p(l=e+(i-e)/2,n,r)-t)>0?i=l:e=l}while(Math.abs(o)>s&&++h<a);return l}function g(t,e,i,r){for(var s=0;s<n;++s){var a=f(e,i,r);if(0===a)return e;e-=(p(e,i,r)-t)/a}return e}function _(t){this._p=t,this._mSampleValues=h?new Float32Array(o):new Array(o),this._precomputed=!1,this.get=this.get.bind(this)}return _.prototype={get:function(t){var e=this._p[0],i=this._p[1],n=this._p[2],r=this._p[3];return this._precomputed||this._precompute(),e===i&&n===r?t:0===t?0:1===t?1:p(this._getTForX(t),i,r)},_precompute:function(){var t=this._p[0],e=this._p[1],i=this._p[2],n=this._p[3];this._precomputed=!0,t===e&&i===n||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],i=0;i<o;++i)this._mSampleValues[i]=p(i*l,t,e)},_getTForX:function(t){for(var e=this._p[0],i=this._p[2],n=this._mSampleValues,s=0,a=1,h=o-1;a!==h&&n[a]<=t;++a)s+=l;var c=s+(t-n[--a])/(n[a+1]-n[a])*l,u=f(c,e,i);return u>=r?g(t,c,e,i):0===u?c:m(t,s,s+l,e,i)}},t}(),ft=function(){function t(t){return t.concat(m(t.length))}return{double:t}}(),mt=function(t,e,i){var n=0,r=t,s=m(r);function a(){return n?s[n-=1]:e()}function o(t){n===r&&(s=ft.double(s),r*=2),i&&i(t),s[n]=t,n+=1}return{newElement:a,release:o}},gt=function(){function t(){return{addedLength:0,percents:f("float32",J()),lengths:f("float32",J())}}return mt(8,t)}(),_t=function(){function t(){return{lengths:[],totalLength:0}}function e(t){var e,i=t.lengths.length;for(e=0;e<i;e+=1)gt.release(t.lengths[e]);t.lengths.length=0}return mt(8,t,e)}();function vt(){var t=Math;function e(t,e,i,n,r,s){var a=t*n+e*r+i*s-r*n-s*t-i*e;return a>-.001&&a<.001}function i(i,n,r,s,a,o,l,h,c){if(0===r&&0===o&&0===c)return e(i,n,s,a,l,h);var u,d=t.sqrt(t.pow(s-i,2)+t.pow(a-n,2)+t.pow(o-r,2)),p=t.sqrt(t.pow(l-i,2)+t.pow(h-n,2)+t.pow(c-r,2)),f=t.sqrt(t.pow(l-s,2)+t.pow(h-a,2)+t.pow(c-o,2));return(u=d>p?d>f?d-p-f:f-p-d:f>p?f-p-d:p-d-f)>-1e-4&&u<1e-4}var n=function(t,e,i,n){var r,s,a,o,l,h,c=J(),u=0,d=[],p=[],f=gt.newElement();for(a=i.length,r=0;r<c;r+=1){for(l=r/(c-1),h=0,s=0;s<a;s+=1)o=M(1-l,3)*t[s]+3*M(1-l,2)*l*i[s]+3*(1-l)*M(l,2)*n[s]+M(l,3)*e[s],d[s]=o,null!==p[s]&&(h+=M(d[s]-p[s],2)),p[s]=d[s];h&&(u+=h=b(h)),f.percents[r]=l,f.lengths[r]=u}return f.addedLength=u,f};function r(t){var e,i=_t.newElement(),r=t.c,s=t.v,a=t.o,o=t.i,l=t._length,h=i.lengths,c=0;for(e=0;e<l-1;e+=1)h[e]=n(s[e],s[e+1],a[e],o[e+1]),c+=h[e].addedLength;return r&&l&&(h[e]=n(s[e],s[0],a[e],o[0]),c+=h[e].addedLength),i.totalLength=c,i}function s(t){this.segmentLength=0,this.points=new Array(t)}function a(t,e){this.partialLength=t,this.point=e}var o,l=(o={},function(t,i,n,r){var l=(t[0]+"_"+t[1]+"_"+i[0]+"_"+i[1]+"_"+n[0]+"_"+n[1]+"_"+r[0]+"_"+r[1]).replace(/\./g,"p");if(!o[l]){var h,c,u,d,p,f,g,_=J(),v=0,y=null;2===t.length&&(t[0]!==i[0]||t[1]!==i[1])&&e(t[0],t[1],i[0],i[1],t[0]+n[0],t[1]+n[1])&&e(t[0],t[1],i[0],i[1],i[0]+r[0],i[1]+r[1])&&(_=2);var x=new s(_);for(u=n.length,h=0;h<_;h+=1){for(g=m(u),p=h/(_-1),f=0,c=0;c<u;c+=1)d=M(1-p,3)*t[c]+3*M(1-p,2)*p*(t[c]+n[c])+3*(1-p)*M(p,2)*(i[c]+r[c])+M(p,3)*i[c],g[c]=d,null!==y&&(f+=M(g[c]-y[c],2));v+=f=b(f),x.points[h]=new a(f,g),y=g}x.segmentLength=v,o[l]=x}return o[l]});function h(t,e){var i=e.percents,n=e.lengths,r=i.length,s=T((r-1)*t),a=t*e.addedLength,o=0;if(s===r-1||0===s||a===n[s])return i[s];for(var l=n[s]>a?-1:1,h=!0;h;)if(n[s]<=a&&n[s+1]>a?(o=(a-n[s])/(n[s+1]-n[s]),h=!1):s+=l,s<0||s>=r-1){if(s===r-1)return i[s];h=!1}return i[s]+(i[s+1]-i[s])*o}function c(e,i,n,r,s,a){var o=h(s,a),l=1-o;return[t.round(1e3*(l*l*l*e[0]+(o*l*l+l*o*l+l*l*o)*n[0]+(o*o*l+l*o*o+o*l*o)*r[0]+o*o*o*i[0]))/1e3,t.round(1e3*(l*l*l*e[1]+(o*l*l+l*o*l+l*l*o)*n[1]+(o*o*l+l*o*o+o*l*o)*r[1]+o*o*o*i[1]))/1e3]}var u=f("float32",8);function d(e,i,n,r,s,a,o){s<0?s=0:s>1&&(s=1);var l,c=h(s,o),d=h(a=a>1?1:a,o),p=e.length,f=1-c,m=1-d,g=f*f*f,_=c*f*f*3,v=c*c*f*3,y=c*c*c,x=f*f*m,S=c*f*m+f*c*m+f*f*d,M=c*c*m+f*c*d+c*f*d,b=c*c*d,T=f*m*m,w=c*m*m+f*d*m+f*m*d,E=c*d*m+f*d*d+c*m*d,A=c*d*d,C=m*m*m,P=d*m*m+m*d*m+m*m*d,L=d*d*m+m*d*d+d*m*d,R=d*d*d;for(l=0;l<p;l+=1)u[4*l]=t.round(1e3*(g*e[l]+_*n[l]+v*r[l]+y*i[l]))/1e3,u[4*l+1]=t.round(1e3*(x*e[l]+S*n[l]+M*r[l]+b*i[l]))/1e3,u[4*l+2]=t.round(1e3*(T*e[l]+w*n[l]+E*r[l]+A*i[l]))/1e3,u[4*l+3]=t.round(1e3*(C*e[l]+P*n[l]+L*r[l]+R*i[l]))/1e3;return u}return{getSegmentsLength:r,getNewSegment:d,getPointInSegment:c,buildBezierData:l,pointOnLine2D:e,pointOnLine3D:i}}var yt=vt(),xt=s,St=Math.abs;function Mt(t,e){var i,n=this.offsetTime;"multidimensional"===this.propType&&(i=f("float32",this.pv.length));for(var r,s,a,o,l,h,c,u,d,p=e.lastIndex,m=p,g=this.keyframes.length-1,_=!0;_;){if(r=this.keyframes[m],s=this.keyframes[m+1],m===g-1&&t>=s.t-n){r.h&&(r=s),p=0;break}if(s.t-n>t){p=m;break}m<g-1?m+=1:(p=0,_=!1)}a=this.keyframesMetadata[m]||{};var v,y=s.t-n,x=r.t-n;if(r.to){a.bezierData||(a.bezierData=yt.buildBezierData(r.s,s.s||r.e,r.to,r.ti));var S=a.bezierData;if(t>=y||t<x){var M=t>=y?S.points.length-1:0;for(l=S.points[M].point.length,o=0;o<l;o+=1)i[o]=S.points[M].point[o]}else{a.__fnct?d=a.__fnct:(d=pt.getBezierEasing(r.o.x,r.o.y,r.i.x,r.i.y,r.n).get,a.__fnct=d),h=d((t-x)/(y-x));var b,T=S.segmentLength*h,w=e.lastFrame<t&&e._lastKeyframeIndex===m?e._lastAddedLength:0;for(u=e.lastFrame<t&&e._lastKeyframeIndex===m?e._lastPoint:0,_=!0,c=S.points.length;_;){if(w+=S.points[u].partialLength,0===T||0===h||u===S.points.length-1){for(l=S.points[u].point.length,o=0;o<l;o+=1)i[o]=S.points[u].point[o];break}if(T>=w&&T<w+S.points[u+1].partialLength){for(b=(T-w)/S.points[u+1].partialLength,l=S.points[u].point.length,o=0;o<l;o+=1)i[o]=S.points[u].point[o]+(S.points[u+1].point[o]-S.points[u].point[o])*b;break}u<c-1?u+=1:_=!1}e._lastPoint=u,e._lastAddedLength=w-S.points[u].partialLength,e._lastKeyframeIndex=m}}else{var E,A,C,P,L;if(g=r.s.length,v=s.s||r.e,this.sh&&1!==r.h)t>=y?(i[0]=v[0],i[1]=v[1],i[2]=v[2]):t<=x?(i[0]=r.s[0],i[1]=r.s[1],i[2]=r.s[2]):Tt(i,bt(wt(r.s),wt(v),(t-x)/(y-x)));else for(m=0;m<g;m+=1)1!==r.h&&(t>=y?h=1:t<x?h=0:(r.o.x.constructor===Array?(a.__fnct||(a.__fnct=[]),a.__fnct[m]?d=a.__fnct[m]:(E=void 0===r.o.x[m]?r.o.x[0]:r.o.x[m],A=void 0===r.o.y[m]?r.o.y[0]:r.o.y[m],C=void 0===r.i.x[m]?r.i.x[0]:r.i.x[m],P=void 0===r.i.y[m]?r.i.y[0]:r.i.y[m],d=pt.getBezierEasing(E,A,C,P).get,a.__fnct[m]=d)):a.__fnct?d=a.__fnct:(E=r.o.x,A=r.o.y,C=r.i.x,P=r.i.y,d=pt.getBezierEasing(E,A,C,P).get,r.keyframeMetadata=d),h=d((t-x)/(y-x)))),v=s.s||r.e,L=1===r.h?r.s[m]:r.s[m]+(v[m]-r.s[m])*h,"multidimensional"===this.propType?i[m]=L:i=L}return e.lastIndex=p,i}function bt(t,e,i){var n,r,s,a,o,l=[],h=t[0],c=t[1],u=t[2],d=t[3],p=e[0],f=e[1],m=e[2],g=e[3];return(r=h*p+c*f+u*m+d*g)<0&&(r=-r,p=-p,f=-f,m=-m,g=-g),1-r>1e-6?(n=Math.acos(r),s=Math.sin(n),a=Math.sin((1-i)*n)/s,o=Math.sin(i*n)/s):(a=1-i,o=i),l[0]=a*h+o*p,l[1]=a*c+o*f,l[2]=a*u+o*m,l[3]=a*d+o*g,l}function Tt(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=Math.atan2(2*n*s-2*i*r,1-2*n*n-2*r*r),o=Math.asin(2*i*n+2*r*s),l=Math.atan2(2*i*s-2*n*r,1-2*i*i-2*r*r);t[0]=a/C,t[1]=o/C,t[2]=l/C}function wt(t){var e=t[0]*C,i=t[1]*C,n=t[2]*C,r=Math.cos(e/2),s=Math.cos(i/2),a=Math.cos(n/2),o=Math.sin(e/2),l=Math.sin(i/2),h=Math.sin(n/2);return[o*l*a+r*s*h,o*s*a+r*l*h,r*l*a-o*s*h,r*s*a-o*l*h]}function Et(){var t=this.comp.renderedFrame-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(t===this._caching.lastFrame||this._caching.lastFrame!==xt&&(this._caching.lastFrame>=i&&t>=i||this._caching.lastFrame<e&&t<e))){this._caching.lastFrame>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var n=this.interpolateValue(t,this._caching);this.pv=n}return this._caching.lastFrame=t,this.pv}function At(t){var e;if("unidimensional"===this.propType)e=t*this.mult,St(this.v-e)>1e-5&&(this.v=e,this._mdf=!0);else for(var i=0,n=this.v.length;i<n;)e=t[i]*this.mult,St(this.v[i]-e)>1e-5&&(this.v[i]=e,this._mdf=!0),i+=1}function Ct(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t;this.lock=!0,this._mdf=this._isFirstFrame;var e=this.effectsSequence.length,i=this.kf?this.pv:this.data.k;for(t=0;t<e;t+=1)i=this.effectsSequence[t](i);this.setVValue(i),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function Pt(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function Lt(t,e,i,n){this.propType="unidimensional",this.mult=i||1,this.data=e,this.v=i?e.k*i:e.k,this.pv=e.k,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=Ct,this.setVValue=At,this.addEffect=Pt}function Rt(t,e,i,n){var r;this.propType="multidimensional",this.mult=i||1,this.data=e,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.frameId=-1;var s=e.k.length;for(this.v=f("float32",s),this.pv=f("float32",s),this.vel=f("float32",s),r=0;r<s;r+=1)this.v[r]=e.k[r]*this.mult,this.pv[r]=e.k[r];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=Ct,this.setVValue=At,this.addEffect=Pt}function Dt(t,e,i,n){this.propType="unidimensional",this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.frameId=-1,this._caching={lastFrame:xt,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=e,this.mult=i||1,this.elem=t,this.container=n,this.comp=t.comp,this.v=xt,this.pv=xt,this._isFirstFrame=!0,this.getValue=Ct,this.setVValue=At,this.interpolateValue=Mt,this.effectsSequence=[Et.bind(this)],this.addEffect=Pt}function It(t,e,i,n){var r;this.propType="multidimensional";var s,a,o,l,h=e.k.length;for(r=0;r<h-1;r+=1)e.k[r].to&&e.k[r].s&&e.k[r+1]&&e.k[r+1].s&&(s=e.k[r].s,a=e.k[r+1].s,o=e.k[r].to,l=e.k[r].ti,(2===s.length&&(s[0]!==a[0]||s[1]!==a[1])&&yt.pointOnLine2D(s[0],s[1],a[0],a[1],s[0]+o[0],s[1]+o[1])&&yt.pointOnLine2D(s[0],s[1],a[0],a[1],a[0]+l[0],a[1]+l[1])||3===s.length&&(s[0]!==a[0]||s[1]!==a[1]||s[2]!==a[2])&&yt.pointOnLine3D(s[0],s[1],s[2],a[0],a[1],a[2],s[0]+o[0],s[1]+o[1],s[2]+o[2])&&yt.pointOnLine3D(s[0],s[1],s[2],a[0],a[1],a[2],a[0]+l[0],a[1]+l[1],a[2]+l[2]))&&(e.k[r].to=null,e.k[r].ti=null),s[0]===a[0]&&s[1]===a[1]&&0===o[0]&&0===o[1]&&0===l[0]&&0===l[1]&&(2===s.length||s[2]===a[2]&&0===o[2]&&0===l[2])&&(e.k[r].to=null,e.k[r].ti=null));this.effectsSequence=[Et.bind(this)],this.data=e,this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=i||1,this.elem=t,this.container=n,this.comp=t.comp,this.getValue=Ct,this.setVValue=At,this.interpolateValue=Mt,this.frameId=-1;var c=e.k[0].s.length;for(this.v=f("float32",c),this.pv=f("float32",c),r=0;r<c;r+=1)this.v[r]=xt,this.pv[r]=xt;this._caching={lastFrame:xt,lastIndex:0,value:f("float32",c)},this.addEffect=Pt}var Ut=function(){function t(t,e,i,n,r){var s;if(e.sid&&(e=t.globalData.slotManager.getProp(e)),e.k.length)if("number"==typeof e.k[0])s=new Rt(t,e,n,r);else switch(i){case 0:s=new Dt(t,e,n,r);break;case 1:s=new It(t,e,n,r)}else s=new Lt(t,e,n,r);return s.effectsSequence.length&&r.addDynamicProperty(s),s}return{getProp:t}}();function Nt(){}Nt.prototype={addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&(this.dynamicProperties.push(t),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var t;this._mdf=!1;var e=this.dynamicProperties.length;for(t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(t){this.container=t,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var Ot=function(){function t(){return f("float32",2)}return mt(8,t)}();function kt(){this.c=!1,this._length=0,this._maxLength=8,this.v=m(this._maxLength),this.o=m(this._maxLength),this.i=m(this._maxLength)}kt.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var i=0;i<e;)this.v[i]=Ot.newElement(),this.o[i]=Ot.newElement(),this.i[i]=Ot.newElement(),i+=1},kt.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},kt.prototype.doubleArrayLength=function(){this.v=this.v.concat(m(this._maxLength)),this.i=this.i.concat(m(this._maxLength)),this.o=this.o.concat(m(this._maxLength)),this._maxLength*=2},kt.prototype.setXYAt=function(t,e,i,n,r){var s;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),i){case"v":s=this.v;break;case"i":s=this.i;break;case"o":s=this.o;break;default:s=[]}(!s[n]||s[n]&&!r)&&(s[n]=Ot.newElement()),s[n][0]=t,s[n][1]=e},kt.prototype.setTripleAt=function(t,e,i,n,r,s,a,o){this.setXYAt(t,e,"v",a,o),this.setXYAt(i,n,"o",a,o),this.setXYAt(r,s,"i",a,o)},kt.prototype.reverse=function(){var t=new kt;t.setPathData(this.c,this._length);var e=this.v,i=this.o,n=this.i,r=0;this.c&&(t.setTripleAt(e[0][0],e[0][1],n[0][0],n[0][1],i[0][0],i[0][1],0,!1),r=1);var s,a=this._length-1,o=this._length;for(s=r;s<o;s+=1)t.setTripleAt(e[a][0],e[a][1],n[a][0],n[a][1],i[a][0],i[a][1],s,!1),a-=1;return t},kt.prototype.length=function(){return this._length};var Ft=function(){function t(){return new kt}function e(t){var e,i=t._length;for(e=0;e<i;e+=1)Ot.release(t.v[e]),Ot.release(t.i[e]),Ot.release(t.o[e]),t.v[e]=null,t.i[e]=null,t.o[e]=null;t._length=0,t.c=!1}function i(t){var e,i=n.newElement(),r=void 0===t._length?t.v.length:t._length;for(i.setLength(r),i.c=t.c,e=0;e<r;e+=1)i.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return i}var n=mt(4,t,e);return n.clone=i,n}();function zt(){this._length=0,this._maxLength=4,this.shapes=m(this._maxLength)}zt.prototype.addShape=function(t){this._length===this._maxLength&&(this.shapes=this.shapes.concat(m(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=t,this._length+=1},zt.prototype.releaseShapes=function(){var t;for(t=0;t<this._length;t+=1)Ft.release(this.shapes[t]);this._length=0};var Bt=function(){var t={newShapeCollection:r,release:s},e=0,i=4,n=m(i);function r(){return e?n[e-=1]:new zt}function s(t){var r,s=t._length;for(r=0;r<s;r+=1)Ft.release(t.shapes[r]);t._length=0,e===i&&(n=ft.double(n),i*=2),n[e]=t,e+=1}return t}(),Vt=function(){var t=-999999;function e(t,e,i){var n,r,s,a,o,l,h,c,u,d=i.lastIndex,p=this.keyframes;if(t<p[0].t-this.offsetTime)n=p[0].s[0],s=!0,d=0;else if(t>=p[p.length-1].t-this.offsetTime)n=p[p.length-1].s?p[p.length-1].s[0]:p[p.length-2].e[0],s=!0;else{for(var f,m,g,_=d,v=p.length-1,y=!0;y&&(f=p[_],!((m=p[_+1]).t-this.offsetTime>t));)_<v-1?_+=1:y=!1;if(g=this.keyframesMetadata[_]||{},d=_,!(s=1===f.h)){if(t>=m.t-this.offsetTime)c=1;else if(t<f.t-this.offsetTime)c=0;else{var x;g.__fnct?x=g.__fnct:(x=pt.getBezierEasing(f.o.x,f.o.y,f.i.x,f.i.y).get,g.__fnct=x),c=x((t-(f.t-this.offsetTime))/(m.t-this.offsetTime-(f.t-this.offsetTime)))}r=m.s?m.s[0]:f.e[0]}n=f.s[0]}for(l=e._length,h=n.i[0].length,i.lastIndex=d,a=0;a<l;a+=1)for(o=0;o<h;o+=1)u=s?n.i[a][o]:n.i[a][o]+(r.i[a][o]-n.i[a][o])*c,e.i[a][o]=u,u=s?n.o[a][o]:n.o[a][o]+(r.o[a][o]-n.o[a][o])*c,e.o[a][o]=u,u=s?n.v[a][o]:n.v[a][o]+(r.v[a][o]-n.v[a][o])*c,e.v[a][o]=u}function i(){var e=this.comp.renderedFrame-this.offsetTime,i=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime,r=this._caching.lastFrame;return r!==t&&(r<i&&e<i||r>n&&e>n)||(this._caching.lastIndex=r<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}function n(){this.paths=this.localShapeCollection}function r(t,e){if(t._length!==e._length||t.c!==e.c)return!1;var i,n=t._length;for(i=0;i<n;i+=1)if(t.v[i][0]!==e.v[i][0]||t.v[i][1]!==e.v[i][1]||t.o[i][0]!==e.o[i][0]||t.o[i][1]!==e.o[i][1]||t.i[i][0]!==e.i[i][0]||t.i[i][1]!==e.i[i][1])return!1;return!0}function s(t){r(this.v,t)||(this.v=Ft.clone(t),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function a(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t,e;this.lock=!0,this._mdf=!1,t=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var i=this.effectsSequence.length;for(e=0;e<i;e+=1)t=this.effectsSequence[e](t);this.setVValue(t),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function o(t,e,i){this.propType="shape",this.comp=t.comp,this.container=t,this.elem=t,this.data=e,this.k=!1,this.kf=!1,this._mdf=!1;var r=3===i?e.pt.k:e.ks.k;this.v=Ft.clone(r),this.pv=Ft.clone(this.v),this.localShapeCollection=Bt.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=n,this.effectsSequence=[]}function l(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function h(e,r,s){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=3===s?r.pt.k:r.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var a=this.keyframes[0].s[0].i.length;this.v=Ft.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,a),this.pv=Ft.clone(this.v),this.localShapeCollection=Bt.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=t,this.reset=n,this._caching={lastFrame:t,lastIndex:0},this.effectsSequence=[i.bind(this)]}o.prototype.interpolateShape=e,o.prototype.getValue=a,o.prototype.setVValue=s,o.prototype.addEffect=l,h.prototype.getValue=a,h.prototype.interpolateShape=e,h.prototype.setVValue=s,h.prototype.addEffect=l;var c=function(){var t=P;function e(t,e){this.v=Ft.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=Bt.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=e.d,this.elem=t,this.comp=t.comp,this.frameId=-1,this.initDynamicPropertyContainer(t),this.p=Ut.getProp(t,e.p,1,0,this),this.s=Ut.getProp(t,e.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],i=this.p.v[1],n=this.s.v[0]/2,r=this.s.v[1]/2,s=3!==this.d,a=this.v;a.v[0][0]=e,a.v[0][1]=i-r,a.v[1][0]=s?e+n:e-n,a.v[1][1]=i,a.v[2][0]=e,a.v[2][1]=i+r,a.v[3][0]=s?e-n:e+n,a.v[3][1]=i,a.i[0][0]=s?e-n*t:e+n*t,a.i[0][1]=i-r,a.i[1][0]=s?e+n:e-n,a.i[1][1]=i-r*t,a.i[2][0]=s?e+n*t:e-n*t,a.i[2][1]=i+r,a.i[3][0]=s?e-n:e+n,a.i[3][1]=i+r*t,a.o[0][0]=s?e+n*t:e-n*t,a.o[0][1]=i-r,a.o[1][0]=s?e+n:e-n,a.o[1][1]=i+r*t,a.o[2][0]=s?e-n*t:e+n*t,a.o[2][1]=i+r,a.o[3][0]=s?e-n:e+n,a.o[3][1]=i-r*t}},u([Nt],e),e}(),d=function(){function t(t,e){this.v=Ft.newElement(),this.v.setPathData(!0,0),this.elem=t,this.comp=t.comp,this.data=e,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),1===e.sy?(this.ir=Ut.getProp(t,e.ir,0,0,this),this.is=Ut.getProp(t,e.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=Ut.getProp(t,e.pt,0,0,this),this.p=Ut.getProp(t,e.p,1,0,this),this.r=Ut.getProp(t,e.r,0,C,this),this.or=Ut.getProp(t,e.or,0,0,this),this.os=Ut.getProp(t,e.os,0,.01,this),this.localShapeCollection=Bt.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return t.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var t,e,i,n,r=2*Math.floor(this.pt.v),s=2*Math.PI/r,a=!0,o=this.or.v,l=this.ir.v,h=this.os.v,c=this.is.v,u=2*Math.PI*o/(2*r),d=2*Math.PI*l/(2*r),p=-Math.PI/2;p+=this.r.v;var f=3===this.data.d?-1:1;for(this.v._length=0,t=0;t<r;t+=1){i=a?h:c,n=a?u:d;var m=(e=a?o:l)*Math.cos(p),g=e*Math.sin(p),_=0===m&&0===g?0:g/Math.sqrt(m*m+g*g),v=0===m&&0===g?0:-m/Math.sqrt(m*m+g*g);m+=+this.p.v[0],g+=+this.p.v[1],this.v.setTripleAt(m,g,m-_*n*i*f,g-v*n*i*f,m+_*n*i*f,g+v*n*i*f,t,!0),a=!a,p+=s*f}},convertPolygonToPath:function(){var t,e=Math.floor(this.pt.v),i=2*Math.PI/e,n=this.or.v,r=this.os.v,s=2*Math.PI*n/(4*e),a=.5*-Math.PI,o=3===this.data.d?-1:1;for(a+=this.r.v,this.v._length=0,t=0;t<e;t+=1){var l=n*Math.cos(a),h=n*Math.sin(a),c=0===l&&0===h?0:h/Math.sqrt(l*l+h*h),u=0===l&&0===h?0:-l/Math.sqrt(l*l+h*h);l+=+this.p.v[0],h+=+this.p.v[1],this.v.setTripleAt(l,h,l-c*s*r*o,h-u*s*r*o,l+c*s*r*o,h+u*s*r*o,t,!0),a+=i*o}this.paths.length=0,this.paths[0]=this.v}},u([Nt],t),t}(),p=function(){function t(t,e){this.v=Ft.newElement(),this.v.c=!0,this.localShapeCollection=Bt.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=t,this.comp=t.comp,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),this.p=Ut.getProp(t,e.p,1,0,this),this.s=Ut.getProp(t,e.s,1,0,this),this.r=Ut.getProp(t,e.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return t.prototype={convertRectToPath:function(){var t=this.p.v[0],e=this.p.v[1],i=this.s.v[0]/2,n=this.s.v[1]/2,r=w(i,n,this.r.v),s=r*(1-P);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(t+i,e-n+r,t+i,e-n+r,t+i,e-n+s,0,!0),this.v.setTripleAt(t+i,e+n-r,t+i,e+n-s,t+i,e+n-r,1,!0),0!==r?(this.v.setTripleAt(t+i-r,e+n,t+i-r,e+n,t+i-s,e+n,2,!0),this.v.setTripleAt(t-i+r,e+n,t-i+s,e+n,t-i+r,e+n,3,!0),this.v.setTripleAt(t-i,e+n-r,t-i,e+n-r,t-i,e+n-s,4,!0),this.v.setTripleAt(t-i,e-n+r,t-i,e-n+s,t-i,e-n+r,5,!0),this.v.setTripleAt(t-i+r,e-n,t-i+r,e-n,t-i+s,e-n,6,!0),this.v.setTripleAt(t+i-r,e-n,t+i-s,e-n,t+i-r,e-n,7,!0)):(this.v.setTripleAt(t-i,e+n,t-i+s,e+n,t-i,e+n,2),this.v.setTripleAt(t-i,e-n,t-i,e-n+s,t-i,e-n,3))):(this.v.setTripleAt(t+i,e-n+r,t+i,e-n+s,t+i,e-n+r,0,!0),0!==r?(this.v.setTripleAt(t+i-r,e-n,t+i-r,e-n,t+i-s,e-n,1,!0),this.v.setTripleAt(t-i+r,e-n,t-i+s,e-n,t-i+r,e-n,2,!0),this.v.setTripleAt(t-i,e-n+r,t-i,e-n+r,t-i,e-n+s,3,!0),this.v.setTripleAt(t-i,e+n-r,t-i,e+n-s,t-i,e+n-r,4,!0),this.v.setTripleAt(t-i+r,e+n,t-i+r,e+n,t-i+s,e+n,5,!0),this.v.setTripleAt(t+i-r,e+n,t+i-s,e+n,t+i-r,e+n,6,!0),this.v.setTripleAt(t+i,e+n-r,t+i,e+n-r,t+i,e+n-s,7,!0)):(this.v.setTripleAt(t-i,e-n,t-i+s,e-n,t-i,e-n,1,!0),this.v.setTripleAt(t-i,e+n,t-i,e+n-s,t-i,e+n,2,!0),this.v.setTripleAt(t+i,e+n,t+i-s,e+n,t+i,e+n,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:n},u([Nt],t),t}();function f(t,e,i){var n;return 3===i||4===i?n=(3===i?e.pt:e.ks).k.length?new h(t,e,i):new o(t,e,i):5===i?n=new p(t,e):6===i?n=new c(t,e):7===i&&(n=new d(t,e)),n.k&&t.addDynamicProperty(n),n}function m(){return o}function g(){return h}var _={};return _.getShapeProp=f,_.getConstructorFunction=m,_.getKeyframedConstructorFunction=g,_}(),Ht=function(){var t=Math.cos,e=Math.sin,i=Math.tan,n=Math.round;function r(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function s(i){if(0===i)return this;var n=t(i),r=e(i);return this._t(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1)}function a(i){if(0===i)return this;var n=t(i),r=e(i);return this._t(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1)}function o(i){if(0===i)return this;var n=t(i),r=e(i);return this._t(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1)}function l(i){if(0===i)return this;var n=t(i),r=e(i);return this._t(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1)}function h(t,e){return this._t(1,e,t,1,0,0)}function c(t,e){return this.shear(i(t),i(e))}function u(n,r){var s=t(r),a=e(r);return this._t(s,a,0,0,-a,s,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,i(n),1,0,0,0,0,1,0,0,0,0,1)._t(s,-a,0,0,a,s,0,0,0,0,1,0,0,0,0,1)}function d(t,e,i){return i||0===i||(i=1),1===t&&1===e&&1===i?this:this._t(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1)}function p(t,e,i,n,r,s,a,o,l,h,c,u,d,p,f,m){return this.props[0]=t,this.props[1]=e,this.props[2]=i,this.props[3]=n,this.props[4]=r,this.props[5]=s,this.props[6]=a,this.props[7]=o,this.props[8]=l,this.props[9]=h,this.props[10]=c,this.props[11]=u,this.props[12]=d,this.props[13]=p,this.props[14]=f,this.props[15]=m,this}function m(t,e,i){return i=i||0,0!==t||0!==e||0!==i?this._t(1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1):this}function g(t,e,i,n,r,s,a,o,l,h,c,u,d,p,f,m){var g=this.props;if(1===t&&0===e&&0===i&&0===n&&0===r&&1===s&&0===a&&0===o&&0===l&&0===h&&1===c&&0===u)return g[12]=g[12]*t+g[15]*d,g[13]=g[13]*s+g[15]*p,g[14]=g[14]*c+g[15]*f,g[15]*=m,this._identityCalculated=!1,this;var _=g[0],v=g[1],y=g[2],x=g[3],S=g[4],M=g[5],b=g[6],T=g[7],w=g[8],E=g[9],A=g[10],C=g[11],P=g[12],L=g[13],R=g[14],D=g[15];return g[0]=_*t+v*r+y*l+x*d,g[1]=_*e+v*s+y*h+x*p,g[2]=_*i+v*a+y*c+x*f,g[3]=_*n+v*o+y*u+x*m,g[4]=S*t+M*r+b*l+T*d,g[5]=S*e+M*s+b*h+T*p,g[6]=S*i+M*a+b*c+T*f,g[7]=S*n+M*o+b*u+T*m,g[8]=w*t+E*r+A*l+C*d,g[9]=w*e+E*s+A*h+C*p,g[10]=w*i+E*a+A*c+C*f,g[11]=w*n+E*o+A*u+C*m,g[12]=P*t+L*r+R*l+D*d,g[13]=P*e+L*s+R*h+D*p,g[14]=P*i+L*a+R*c+D*f,g[15]=P*n+L*o+R*u+D*m,this._identityCalculated=!1,this}function _(t){var e=t.props;return this.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function v(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function y(t){for(var e=0;e<16;){if(t.props[e]!==this.props[e])return!1;e+=1}return!0}function x(t){var e;for(e=0;e<16;e+=1)t.props[e]=this.props[e];return t}function S(t){var e;for(e=0;e<16;e+=1)this.props[e]=t[e]}function M(t,e,i){return{x:t*this.props[0]+e*this.props[4]+i*this.props[8]+this.props[12],y:t*this.props[1]+e*this.props[5]+i*this.props[9]+this.props[13],z:t*this.props[2]+e*this.props[6]+i*this.props[10]+this.props[14]}}function b(t,e,i){return t*this.props[0]+e*this.props[4]+i*this.props[8]+this.props[12]}function T(t,e,i){return t*this.props[1]+e*this.props[5]+i*this.props[9]+this.props[13]}function w(t,e,i){return t*this.props[2]+e*this.props[6]+i*this.props[10]+this.props[14]}function E(){var t=this.props[0]*this.props[5]-this.props[1]*this.props[4],e=this.props[5]/t,i=-this.props[1]/t,n=-this.props[4]/t,r=this.props[0]/t,s=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/t,a=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/t,o=new Ht;return o.props[0]=e,o.props[1]=i,o.props[4]=n,o.props[5]=r,o.props[12]=s,o.props[13]=a,o}function A(t){return this.getInverseMatrix().applyToPointArray(t[0],t[1],t[2]||0)}function C(t){var e,i=t.length,n=[];for(e=0;e<i;e+=1)n[e]=A(t[e]);return n}function P(t,e,i){var n=f("float32",6);if(this.isIdentity())n[0]=t[0],n[1]=t[1],n[2]=e[0],n[3]=e[1],n[4]=i[0],n[5]=i[1];else{var r=this.props[0],s=this.props[1],a=this.props[4],o=this.props[5],l=this.props[12],h=this.props[13];n[0]=t[0]*r+t[1]*a+l,n[1]=t[0]*s+t[1]*o+h,n[2]=e[0]*r+e[1]*a+l,n[3]=e[0]*s+e[1]*o+h,n[4]=i[0]*r+i[1]*a+l,n[5]=i[0]*s+i[1]*o+h}return n}function L(t,e,i){return this.isIdentity()?[t,e,i]:[t*this.props[0]+e*this.props[4]+i*this.props[8]+this.props[12],t*this.props[1]+e*this.props[5]+i*this.props[9]+this.props[13],t*this.props[2]+e*this.props[6]+i*this.props[10]+this.props[14]]}function R(t,e){if(this.isIdentity())return t+","+e;var i=this.props;return Math.round(100*(t*i[0]+e*i[4]+i[12]))/100+","+Math.round(100*(t*i[1]+e*i[5]+i[13]))/100}function D(){for(var t=0,e=this.props,i="matrix3d(",r=1e4;t<16;)i+=n(e[t]*r)/r,i+=15===t?")":",",t+=1;return i}function I(t){var e=1e4;return t<1e-6&&t>0||t>-1e-6&&t<0?n(t*e)/e:t}function U(){var t=this.props;return"matrix("+I(t[0])+","+I(t[1])+","+I(t[4])+","+I(t[5])+","+I(t[12])+","+I(t[13])+")"}return function(){this.reset=r,this.rotate=s,this.rotateX=a,this.rotateY=o,this.rotateZ=l,this.skew=c,this.skewFromAxis=u,this.shear=h,this.scale=d,this.setTransform=p,this.translate=m,this.transform=g,this.multiply=_,this.applyToPoint=M,this.applyToX=b,this.applyToY=T,this.applyToZ=w,this.applyToPointArray=L,this.applyToTriplePoints=P,this.applyToPointStringified=R,this.toCSS=D,this.to2dCSS=U,this.clone=x,this.cloneFromProps=S,this.equals=y,this.inversePoints=C,this.inversePoint=A,this.getInverseMatrix=E,this._t=this.transform,this.isIdentity=v,this._identity=!0,this._identityCalculated=!1,this.props=f("float32",16),this.reset()}}();function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}var Wt={},Xt="__[STANDALONE]__",qt="__[ANIMATIONDATA]__",Yt="";function jt(t){l(t)}function Zt(){!0===Xt?dt.searchAnimations(qt,Xt,Yt):dt.searchAnimations()}function Kt(t){X(t)}function Jt(t){$(t)}function $t(t){return!0===Xt&&(t.animationData=JSON.parse(qt)),dt.loadAnimation(t)}function Qt(t){if("string"==typeof t)switch(t){case"high":K(200);break;default:case"medium":K(50);break;case"low":K(10)}else!isNaN(t)&&t>1&&K(t);J()>=50?L(!1):L(!0)}function te(){return"undefined"!=typeof navigator}function ee(t,e){"expressions"===t&&Y(e)}function ie(t){switch(t){case"propertyFactory":return Ut;case"shapePropertyFactory":return Vt;case"matrix":return Ht;default:return null}}function ne(){"complete"===document.readyState&&(clearInterval(le),Zt())}function re(t){for(var e=se.split("&"),i=0;i<e.length;i+=1){var n=e[i].split("=");if(decodeURIComponent(n[0])==t)return decodeURIComponent(n[1])}return null}Wt.play=dt.play,Wt.pause=dt.pause,Wt.setLocationHref=jt,Wt.togglePause=dt.togglePause,Wt.setSpeed=dt.setSpeed,Wt.setDirection=dt.setDirection,Wt.stop=dt.stop,Wt.searchAnimations=Zt,Wt.registerAnimation=dt.registerAnimation,Wt.loadAnimation=$t,Wt.setSubframeRendering=Kt,Wt.resize=dt.resize,Wt.goToAndStop=dt.goToAndStop,Wt.destroy=dt.destroy,Wt.setQuality=Qt,Wt.inBrowser=te,Wt.installPlugin=ee,Wt.freeze=dt.freeze,Wt.unfreeze=dt.unfreeze,Wt.setVolume=dt.setVolume,Wt.mute=dt.mute,Wt.unmute=dt.unmute,Wt.getRegisteredAnimations=dt.getRegisteredAnimations,Wt.useWebWorker=a,Wt.setIDPrefix=Jt,Wt.__getFactory=ie,Wt.version="5.12.2";var se="";if(Xt){var ae=document.getElementsByTagName("script"),oe=ae[ae.length-1]||{src:""};se=oe.src?oe.src.replace(/^[^\?]+\??/,""):"",Yt=re("renderer")}var le=setInterval(ne,100);try{"object"!==Gt(e)&&i.amdO}catch(t){}var he=function(){var t={},e={};function i(t,i){e[t]||(e[t]=i)}function n(t,i,n){return new e[t](i,n)}return t.registerModifier=i,t.getModifier=n,t}();function ce(){}function ue(){}function de(){}ce.prototype.initModifierProperties=function(){},ce.prototype.addShapeToModifier=function(){},ce.prototype.addShape=function(t){if(!this.closed){t.sh.container.addDynamicProperty(t.sh);var e={shape:t.sh,data:t,localShapeCollection:Bt.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&t.setAsAnimated()}},ce.prototype.init=function(t,e){this.shapes=[],this.elem=t,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e),this.frameId=s,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ce.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},u([Nt],ce),u([ce],ue),ue.prototype.initModifierProperties=function(t,e){this.s=Ut.getProp(t,e.s,0,.01,this),this.e=Ut.getProp(t,e.e,0,.01,this),this.o=Ut.getProp(t,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},ue.prototype.addShapeToModifier=function(t){t.pathsData=[]},ue.prototype.calculateShapeEdges=function(t,e,i,n,r){var s=[];e<=1?s.push({s:t,e}):t>=1?s.push({s:t-1,e:e-1}):(s.push({s:t,e:1}),s.push({s:0,e:e-1}));var a,o,l=[],h=s.length;for(a=0;a<h;a+=1){var c,u;(o=s[a]).e*r<n||o.s*r>n+i||(c=o.s*r<=n?0:(o.s*r-n)/i,u=o.e*r>=n+i?1:(o.e*r-n)/i,l.push([c,u]))}return l.length||l.push([0,0]),l},ue.prototype.releasePathsData=function(t){var e,i=t.length;for(e=0;e<i;e+=1)_t.release(t[e]);return t.length=0,t},ue.prototype.processShapes=function(t){var e,i,n,r;if(this._mdf||t){var s=this.o.v%360/360;if(s<0&&(s+=1),(e=this.s.v>1?1+s:this.s.v<0?0+s:this.s.v+s)>(i=this.e.v>1?1+s:this.e.v<0?0+s:this.e.v+s)){var a=e;e=i,i=a}e=1e-4*Math.round(1e4*e),i=1e-4*Math.round(1e4*i),this.sValue=e,this.eValue=i}else e=this.sValue,i=this.eValue;var o,l,h,c,u,d=this.shapes.length,p=0;if(i===e)for(r=0;r<d;r+=1)this.shapes[r].localShapeCollection.releaseShapes(),this.shapes[r].shape._mdf=!0,this.shapes[r].shape.paths=this.shapes[r].localShapeCollection,this._mdf&&(this.shapes[r].pathsData.length=0);else if(1===i&&0===e||0===i&&1===e){if(this._mdf)for(r=0;r<d;r+=1)this.shapes[r].pathsData.length=0,this.shapes[r].shape._mdf=!0}else{var f,m,g=[];for(r=0;r<d;r+=1)if((f=this.shapes[r]).shape._mdf||this._mdf||t||2===this.m){if(l=(n=f.shape.paths)._length,u=0,!f.shape._mdf&&f.pathsData.length)u=f.totalShapeLength;else{for(h=this.releasePathsData(f.pathsData),o=0;o<l;o+=1)c=yt.getSegmentsLength(n.shapes[o]),h.push(c),u+=c.totalLength;f.totalShapeLength=u,f.pathsData=h}p+=u,f.shape._mdf=!0}else f.shape.paths=f.localShapeCollection;var _,v=e,y=i,x=0;for(r=d-1;r>=0;r-=1)if((f=this.shapes[r]).shape._mdf){for((m=f.localShapeCollection).releaseShapes(),2===this.m&&d>1?(_=this.calculateShapeEdges(e,i,f.totalShapeLength,x,p),x+=f.totalShapeLength):_=[[v,y]],l=_.length,o=0;o<l;o+=1){v=_[o][0],y=_[o][1],g.length=0,y<=1?g.push({s:f.totalShapeLength*v,e:f.totalShapeLength*y}):v>=1?g.push({s:f.totalShapeLength*(v-1),e:f.totalShapeLength*(y-1)}):(g.push({s:f.totalShapeLength*v,e:f.totalShapeLength}),g.push({s:0,e:f.totalShapeLength*(y-1)}));var S=this.addShapes(f,g[0]);if(g[0].s!==g[0].e){if(g.length>1)if(f.shape.paths.shapes[f.shape.paths._length-1].c){var M=S.pop();this.addPaths(S,m),S=this.addShapes(f,g[1],M)}else this.addPaths(S,m),S=this.addShapes(f,g[1]);this.addPaths(S,m)}}f.shape.paths=m}}},ue.prototype.addPaths=function(t,e){var i,n=t.length;for(i=0;i<n;i+=1)e.addShape(t[i])},ue.prototype.addSegment=function(t,e,i,n,r,s,a){r.setXYAt(e[0],e[1],"o",s),r.setXYAt(i[0],i[1],"i",s+1),a&&r.setXYAt(t[0],t[1],"v",s),r.setXYAt(n[0],n[1],"v",s+1)},ue.prototype.addSegmentFromArray=function(t,e,i,n){e.setXYAt(t[1],t[5],"o",i),e.setXYAt(t[2],t[6],"i",i+1),n&&e.setXYAt(t[0],t[4],"v",i),e.setXYAt(t[3],t[7],"v",i+1)},ue.prototype.addShapes=function(t,e,i){var n,r,s,a,o,l,h,c,u=t.pathsData,d=t.shape.paths.shapes,p=t.shape.paths._length,f=0,m=[],g=!0;for(i?(o=i._length,c=i._length):(i=Ft.newElement(),o=0,c=0),m.push(i),n=0;n<p;n+=1){for(l=u[n].lengths,i.c=d[n].c,s=d[n].c?l.length:l.length+1,r=1;r<s;r+=1)if(f+(a=l[r-1]).addedLength<e.s)f+=a.addedLength,i.c=!1;else{if(f>e.e){i.c=!1;break}e.s<=f&&e.e>=f+a.addedLength?(this.addSegment(d[n].v[r-1],d[n].o[r-1],d[n].i[r],d[n].v[r],i,o,g),g=!1):(h=yt.getNewSegment(d[n].v[r-1],d[n].v[r],d[n].o[r-1],d[n].i[r],(e.s-f)/a.addedLength,(e.e-f)/a.addedLength,l[r-1]),this.addSegmentFromArray(h,i,o,g),g=!1,i.c=!1),f+=a.addedLength,o+=1}if(d[n].c&&l.length){if(a=l[r-1],f<=e.e){var _=l[r-1].addedLength;e.s<=f&&e.e>=f+_?(this.addSegment(d[n].v[r-1],d[n].o[r-1],d[n].i[0],d[n].v[0],i,o,g),g=!1):(h=yt.getNewSegment(d[n].v[r-1],d[n].v[0],d[n].o[r-1],d[n].i[0],(e.s-f)/_,(e.e-f)/_,l[r-1]),this.addSegmentFromArray(h,i,o,g),g=!1,i.c=!1)}else i.c=!1;f+=a.addedLength,o+=1}if(i._length&&(i.setXYAt(i.v[c][0],i.v[c][1],"i",c),i.setXYAt(i.v[i._length-1][0],i.v[i._length-1][1],"o",i._length-1)),f>e.e)break;n<p-1&&(i=Ft.newElement(),g=!0,m.push(i),o=0)}return m},u([ce],de),de.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=Ut.getProp(t,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},de.prototype.processPath=function(t,e){var i=e/100,n=[0,0],r=t._length,s=0;for(s=0;s<r;s+=1)n[0]+=t.v[s][0],n[1]+=t.v[s][1];n[0]/=r,n[1]/=r;var a,o,l,h,c,u,d=Ft.newElement();for(d.c=t.c,s=0;s<r;s+=1)a=t.v[s][0]+(n[0]-t.v[s][0])*i,o=t.v[s][1]+(n[1]-t.v[s][1])*i,l=t.o[s][0]+(n[0]-t.o[s][0])*-i,h=t.o[s][1]+(n[1]-t.o[s][1])*-i,c=t.i[s][0]+(n[0]-t.i[s][0])*-i,u=t.i[s][1]+(n[1]-t.i[s][1])*-i,d.setTripleAt(a,o,l,h,c,u,s);return d},de.prototype.processShapes=function(t){var e,i,n,r,s,a,o=this.shapes.length,l=this.amount.v;if(0!==l)for(i=0;i<o;i+=1){if(a=(s=this.shapes[i]).localShapeCollection,s.shape._mdf||this._mdf||t)for(a.releaseShapes(),s.shape._mdf=!0,e=s.shape.paths.shapes,r=s.shape.paths._length,n=0;n<r;n+=1)a.addShape(this.processPath(e[n],l));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var pe=function(){var t=[0,0];function e(t){var e=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||e,this.a&&t.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&t.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&t.skewFromAxis(-this.sk.v,this.sa.v),this.r?t.rotate(-this.r.v):t.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?t.translate(this.px.v,this.py.v,-this.pz.v):t.translate(this.px.v,this.py.v,0):t.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function i(e){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||e){var i;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var n,r;if(i=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(n=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/i,0),r=this.p.getValueAtTime(this.p.keyframes[0].t/i,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(n=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/i,0),r=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/i,0)):(n=this.p.pv,r=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/i,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){n=[],r=[];var s=this.px,a=this.py;s._caching.lastFrame+s.offsetTime<=s.keyframes[0].t?(n[0]=s.getValueAtTime((s.keyframes[0].t+.01)/i,0),n[1]=a.getValueAtTime((a.keyframes[0].t+.01)/i,0),r[0]=s.getValueAtTime(s.keyframes[0].t/i,0),r[1]=a.getValueAtTime(a.keyframes[0].t/i,0)):s._caching.lastFrame+s.offsetTime>=s.keyframes[s.keyframes.length-1].t?(n[0]=s.getValueAtTime(s.keyframes[s.keyframes.length-1].t/i,0),n[1]=a.getValueAtTime(a.keyframes[a.keyframes.length-1].t/i,0),r[0]=s.getValueAtTime((s.keyframes[s.keyframes.length-1].t-.01)/i,0),r[1]=a.getValueAtTime((a.keyframes[a.keyframes.length-1].t-.01)/i,0)):(n=[s.pv,a.pv],r[0]=s.getValueAtTime((s._caching.lastFrame+s.offsetTime-.01)/i,s.offsetTime),r[1]=a.getValueAtTime((a._caching.lastFrame+a.offsetTime-.01)/i,a.offsetTime))}else n=r=t;this.v.rotate(-Math.atan2(n[1]-r[1],n[0]-r[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function n(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}}function r(){}function s(t){this._addDynamicProperty(t),this.elem.addDynamicProperty(t),this._isDirty=!0}function a(t,e,i){if(this.elem=t,this.frameId=-1,this.propType="transform",this.data=e,this.v=new Ht,this.pre=new Ht,this.appliedTransformations=0,this.initDynamicPropertyContainer(i||t),e.p&&e.p.s?(this.px=Ut.getProp(t,e.p.x,0,0,this),this.py=Ut.getProp(t,e.p.y,0,0,this),e.p.z&&(this.pz=Ut.getProp(t,e.p.z,0,0,this))):this.p=Ut.getProp(t,e.p||{k:[0,0,0]},1,0,this),e.rx){if(this.rx=Ut.getProp(t,e.rx,0,C,this),this.ry=Ut.getProp(t,e.ry,0,C,this),this.rz=Ut.getProp(t,e.rz,0,C,this),e.or.k[0].ti){var n,r=e.or.k.length;for(n=0;n<r;n+=1)e.or.k[n].to=null,e.or.k[n].ti=null}this.or=Ut.getProp(t,e.or,1,C,this),this.or.sh=!0}else this.r=Ut.getProp(t,e.r||{k:0},0,C,this);e.sk&&(this.sk=Ut.getProp(t,e.sk,0,C,this),this.sa=Ut.getProp(t,e.sa,0,C,this)),this.a=Ut.getProp(t,e.a||{k:[0,0,0]},1,0,this),this.s=Ut.getProp(t,e.s||{k:[100,100,100]},1,.01,this),e.o?this.o=Ut.getProp(t,e.o,0,.01,t):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}function o(t,e,i){return new a(t,e,i)}return a.prototype={applyToMatrix:e,getValue:i,precalculateMatrix:n,autoOrient:r},u([Nt],a),a.prototype.addDynamicProperty=s,a.prototype._addDynamicProperty=Nt.prototype.addDynamicProperty,{getTransformProperty:o}}();function fe(){}function me(){}function ge(t,e){return 1e5*Math.abs(t-e)<=Math.min(Math.abs(t),Math.abs(e))}function _e(t){return Math.abs(t)<=1e-5}function ve(t,e,i){return t*(1-i)+e*i}function ye(t,e,i){return[ve(t[0],e[0],i),ve(t[1],e[1],i)]}function xe(t,e,i){if(0===t)return[];var n=e*e-4*t*i;if(n<0)return[];var r=-e/(2*t);if(0===n)return[r];var s=Math.sqrt(n)/(2*t);return[r-s,r+s]}function Se(t,e,i,n){return[3*e-t-3*i+n,3*t-6*e+3*i,-3*t+3*e,t]}function Me(t){return new be(t,t,t,t,!1)}function be(t,e,i,n,r){r&&Ie(t,e)&&(e=ye(t,n,1/3)),r&&Ie(i,n)&&(i=ye(t,n,2/3));var s=Se(t[0],e[0],i[0],n[0]),a=Se(t[1],e[1],i[1],n[1]);this.a=[s[0],a[0]],this.b=[s[1],a[1]],this.c=[s[2],a[2]],this.d=[s[3],a[3]],this.points=[t,e,i,n]}function Te(t,e){var i=t.points[0][e],n=t.points[t.points.length-1][e];if(i>n){var r=n;n=i,i=r}for(var s=xe(3*t.a[e],2*t.b[e],t.c[e]),a=0;a<s.length;a+=1)if(s[a]>0&&s[a]<1){var o=t.point(s[a])[e];o<i?i=o:o>n&&(n=o)}return{min:i,max:n}}function we(t,e,i){var n=t.boundingBox();return{cx:n.cx,cy:n.cy,width:n.width,height:n.height,bez:t,t:(e+i)/2,t1:e,t2:i}}function Ee(t){var e=t.bez.split(.5);return[we(e[0],t.t1,t.t),we(e[1],t.t,t.t2)]}function Ae(t,e){return 2*Math.abs(t.cx-e.cx)<t.width+e.width&&2*Math.abs(t.cy-e.cy)<t.height+e.height}function Ce(t,e,i,n,r,s){if(Ae(t,e))if(i>=s||t.width<=n&&t.height<=n&&e.width<=n&&e.height<=n)r.push([t.t,e.t]);else{var a=Ee(t),o=Ee(e);Ce(a[0],o[0],i+1,n,r,s),Ce(a[0],o[1],i+1,n,r,s),Ce(a[1],o[0],i+1,n,r,s),Ce(a[1],o[1],i+1,n,r,s)}}function Pe(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Le(t,e,i,n){var r=[t[0],t[1],1],s=[e[0],e[1],1],a=[i[0],i[1],1],o=[n[0],n[1],1],l=Pe(Pe(r,s),Pe(a,o));return _e(l[2])?null:[l[0]/l[2],l[1]/l[2]]}function Re(t,e,i){return[t[0]+Math.cos(e)*i,t[1]-Math.sin(e)*i]}function De(t,e){return Math.hypot(t[0]-e[0],t[1]-e[1])}function Ie(t,e){return ge(t[0],e[0])&&ge(t[1],e[1])}function Ue(){}function Ne(t,e,i,n,r,s,a){var o=i-Math.PI/2,l=i+Math.PI/2,h=e[0]+Math.cos(i)*n*r,c=e[1]-Math.sin(i)*n*r;t.setTripleAt(h,c,h+Math.cos(o)*s,c-Math.sin(o)*s,h+Math.cos(l)*a,c-Math.sin(l)*a,t.length())}function Oe(t,e){var i=[e[0]-t[0],e[1]-t[1]],n=.5*-Math.PI;return[Math.cos(n)*i[0]-Math.sin(n)*i[1],Math.sin(n)*i[0]+Math.cos(n)*i[1]]}function ke(t,e){var i=0===e?t.length()-1:e-1,n=(e+1)%t.length(),r=Oe(t.v[i],t.v[n]);return Math.atan2(0,1)-Math.atan2(r[1],r[0])}function Fe(t,e,i,n,r,s,a){var o=ke(e,i),l=e.v[i%e._length],h=e.v[0===i?e._length-1:i-1],c=e.v[(i+1)%e._length],u=2===s?Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)):0,d=2===s?Math.sqrt(Math.pow(l[0]-c[0],2)+Math.pow(l[1]-c[1],2)):0;Ne(t,e.v[i%e._length],o,a,n,d/(2*(r+1)),u/(2*(r+1)),s)}function ze(t,e,i,n,r,s){for(var a=0;a<n;a+=1){var o=(a+1)/(n+1),l=2===r?Math.sqrt(Math.pow(e.points[3][0]-e.points[0][0],2)+Math.pow(e.points[3][1]-e.points[0][1],2)):0,h=e.normalAngle(o);Ne(t,e.point(o),h,s,i,l/(2*(n+1)),l/(2*(n+1)),r),s=-s}return s}function Be(t,e,i){var n=Math.atan2(e[0]-t[0],e[1]-t[1]);return[Re(t,n,i),Re(e,n,i)]}function Ve(t,e){var i,n,r,s,a,o,l;i=(l=Be(t.points[0],t.points[1],e))[0],n=l[1],r=(l=Be(t.points[1],t.points[2],e))[0],s=l[1],a=(l=Be(t.points[2],t.points[3],e))[0],o=l[1];var h=Le(i,n,r,s);null===h&&(h=n);var c=Le(a,o,r,s);return null===c&&(c=a),new be(i,h,c,o)}function He(t,e,i,n,r){var s=e.points[3],a=i.points[0];if(3===n)return s;if(Ie(s,a))return s;if(2===n){var o=-e.tangentAngle(1),l=-i.tangentAngle(0)+Math.PI,h=Le(s,Re(s,o+Math.PI/2,100),a,Re(a,o+Math.PI/2,100)),c=h?De(h,s):De(s,a)/2,u=Re(s,o,2*c*P);return t.setXYAt(u[0],u[1],"o",t.length()-1),u=Re(a,l,2*c*P),t.setTripleAt(a[0],a[1],a[0],a[1],u[0],u[1],t.length()),a}var d=Le(Ie(s,e.points[2])?e.points[0]:e.points[2],s,a,Ie(a,i.points[1])?i.points[3]:i.points[1]);return d&&De(d,s)<r?(t.setTripleAt(d[0],d[1],d[0],d[1],d[0],d[1],t.length()),d):s}function Ge(t,e){var i=t.intersections(e);return i.length&&ge(i[0][0],1)&&i.shift(),i.length?i[0]:null}function We(t,e){var i=t.slice(),n=e.slice(),r=Ge(t[t.length-1],e[0]);return r&&(i[t.length-1]=t[t.length-1].split(r[0])[0],n[0]=e[0].split(r[1])[1]),t.length>1&&e.length>1&&(r=Ge(t[0],e[e.length-1]))?[[t[0].split(r[0])[0]],[e[e.length-1].split(r[1])[1]]]:[i,n]}function Xe(t){for(var e,i=1;i<t.length;i+=1)e=We(t[i-1],t[i]),t[i-1]=e[0],t[i]=e[1];return t.length>1&&(e=We(t[t.length-1],t[0]),t[t.length-1]=e[0],t[0]=e[1]),t}function qe(t,e){var i,n,r,s,a=t.inflectionPoints();if(0===a.length)return[Ve(t,e)];if(1===a.length||ge(a[1],1))return i=(r=t.split(a[0]))[0],n=r[1],[Ve(i,e),Ve(n,e)];i=(r=t.split(a[0]))[0];var o=(a[1]-a[0])/(1-a[0]);return s=(r=r[1].split(o))[0],n=r[1],[Ve(i,e),Ve(s,e),Ve(n,e)]}function Ye(){}function je(t){for(var e=t.fStyle?t.fStyle.split(" "):[],i="normal",n="normal",r=e.length,s=0;s<r;s+=1)switch(e[s].toLowerCase()){case"italic":n="italic";break;case"bold":i="700";break;case"black":i="900";break;case"medium":i="500";break;case"regular":case"normal":i="400";break;case"light":case"thin":i="200"}return{style:n,weight:t.fWeight||i}}u([ce],fe),fe.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.c=Ut.getProp(t,e.c,0,null,this),this.o=Ut.getProp(t,e.o,0,null,this),this.tr=pe.getTransformProperty(t,e.tr,this),this.so=Ut.getProp(t,e.tr.so,0,.01,this),this.eo=Ut.getProp(t,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Ht,this.rMatrix=new Ht,this.sMatrix=new Ht,this.tMatrix=new Ht,this.matrix=new Ht},fe.prototype.applyTransforms=function(t,e,i,n,r,s){var a=s?-1:1,o=n.s.v[0]+(1-n.s.v[0])*(1-r),l=n.s.v[1]+(1-n.s.v[1])*(1-r);t.translate(n.p.v[0]*a*r,n.p.v[1]*a*r,n.p.v[2]),e.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),e.rotate(-n.r.v*a*r),e.translate(n.a.v[0],n.a.v[1],n.a.v[2]),i.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),i.scale(s?1/o:o,s?1/l:l),i.translate(n.a.v[0],n.a.v[1],n.a.v[2])},fe.prototype.init=function(t,e,i,n){for(this.elem=t,this.arr=e,this.pos=i,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e[i]);i>0;)i-=1,this._elements.unshift(e[i]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},fe.prototype.resetElements=function(t){var e,i=t.length;for(e=0;e<i;e+=1)t[e]._processed=!1,"gr"===t[e].ty&&this.resetElements(t[e].it)},fe.prototype.cloneElements=function(t){var e=JSON.parse(JSON.stringify(t));return this.resetElements(e),e},fe.prototype.changeGroupRender=function(t,e){var i,n=t.length;for(i=0;i<n;i+=1)t[i]._render=e,"gr"===t[i].ty&&this.changeGroupRender(t[i].it,e)},fe.prototype.processShapes=function(t){var e,i,n,r,s,a=!1;if(this._mdf||t){var o,l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var h={it:this.cloneElements(this._elements),ty:"gr"};h.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,h),this._groups.splice(0,0,h),this._currentCopies+=1}this.elem.reloadShapes(),a=!0}for(s=0,n=0;n<=this._groups.length-1;n+=1){if(o=s<l,this._groups[n]._render=o,this.changeGroupRender(this._groups[n].it,o),!o){var c=this.elemsData[n].it,u=c[c.length-1];0!==u.transform.op.v?(u.transform.op._mdf=!0,u.transform.op.v=0):u.transform.op._mdf=!1}s+=1}this._currentCopies=l;var d=this.o.v,p=d%1,f=d>0?Math.floor(d):Math.ceil(d),m=this.pMatrix.props,g=this.rMatrix.props,_=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var v,y,x=0;if(d>0){for(;x<f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),x+=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,p,!1),x+=p)}else if(d<0){for(;x>f;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),x-=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-p,!0),x-=p)}for(n=1===this.data.m?0:this._currentCopies-1,r=1===this.data.m?1:-1,s=this._currentCopies;s;){if(y=(i=(e=this.elemsData[n].it)[e.length-1].transform.mProps.v.props).length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(n/(this._currentCopies-1)),0!==x){for((0!==n&&1===r||n!==this._currentCopies-1&&-1===r)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(_[0],_[1],_[2],_[3],_[4],_[5],_[6],_[7],_[8],_[9],_[10],_[11],_[12],_[13],_[14],_[15]),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),v=0;v<y;v+=1)i[v]=this.matrix.props[v];this.matrix.reset()}else for(this.matrix.reset(),v=0;v<y;v+=1)i[v]=this.matrix.props[v];x+=1,s-=1,n+=r}}else for(s=this._currentCopies,n=0,r=1;s;)i=(e=this.elemsData[n].it)[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,s-=1,n+=r;return a},fe.prototype.addShape=function(){},u([ce],me),me.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.rd=Ut.getProp(t,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},me.prototype.processPath=function(t,e){var i,n=Ft.newElement();n.c=t.c;var r,s,a,o,l,h,c,u,d,p,f,m,g=t._length,_=0;for(i=0;i<g;i+=1)r=t.v[i],a=t.o[i],s=t.i[i],r[0]===a[0]&&r[1]===a[1]&&r[0]===s[0]&&r[1]===s[1]?0!==i&&i!==g-1||t.c?(o=0===i?t.v[g-1]:t.v[i-1],h=(l=Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)))?Math.min(l/2,e)/l:0,c=f=r[0]+(o[0]-r[0])*h,u=m=r[1]-(r[1]-o[1])*h,d=c-(c-r[0])*P,p=u-(u-r[1])*P,n.setTripleAt(c,u,d,p,f,m,_),_+=1,o=i===g-1?t.v[0]:t.v[i+1],h=(l=Math.sqrt(Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)))?Math.min(l/2,e)/l:0,c=d=r[0]+(o[0]-r[0])*h,u=p=r[1]+(o[1]-r[1])*h,f=c-(c-r[0])*P,m=u-(u-r[1])*P,n.setTripleAt(c,u,d,p,f,m,_),_+=1):(n.setTripleAt(r[0],r[1],a[0],a[1],s[0],s[1],_),_+=1):(n.setTripleAt(t.v[i][0],t.v[i][1],t.o[i][0],t.o[i][1],t.i[i][0],t.i[i][1],_),_+=1);return n},me.prototype.processShapes=function(t){var e,i,n,r,s,a,o=this.shapes.length,l=this.rd.v;if(0!==l)for(i=0;i<o;i+=1){if(a=(s=this.shapes[i]).localShapeCollection,s.shape._mdf||this._mdf||t)for(a.releaseShapes(),s.shape._mdf=!0,e=s.shape.paths.shapes,r=s.shape.paths._length,n=0;n<r;n+=1)a.addShape(this.processPath(e[n],l));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},be.prototype.point=function(t){return[((this.a[0]*t+this.b[0])*t+this.c[0])*t+this.d[0],((this.a[1]*t+this.b[1])*t+this.c[1])*t+this.d[1]]},be.prototype.derivative=function(t){return[(3*t*this.a[0]+2*this.b[0])*t+this.c[0],(3*t*this.a[1]+2*this.b[1])*t+this.c[1]]},be.prototype.tangentAngle=function(t){var e=this.derivative(t);return Math.atan2(e[1],e[0])},be.prototype.normalAngle=function(t){var e=this.derivative(t);return Math.atan2(e[0],e[1])},be.prototype.inflectionPoints=function(){var t=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(_e(t))return[];var e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/t,i=e*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/t;if(i<0)return[];var n=Math.sqrt(i);return _e(n)?n>0&&n<1?[e]:[]:[e-n,e+n].filter((function(t){return t>0&&t<1}))},be.prototype.split=function(t){if(t<=0)return[Me(this.points[0]),this];if(t>=1)return[this,Me(this.points[this.points.length-1])];var e=ye(this.points[0],this.points[1],t),i=ye(this.points[1],this.points[2],t),n=ye(this.points[2],this.points[3],t),r=ye(e,i,t),s=ye(i,n,t),a=ye(r,s,t);return[new be(this.points[0],e,r,a,!0),new be(a,s,n,this.points[3],!0)]},be.prototype.bounds=function(){return{x:Te(this,0),y:Te(this,1)}},be.prototype.boundingBox=function(){var t=this.bounds();return{left:t.x.min,right:t.x.max,top:t.y.min,bottom:t.y.max,width:t.x.max-t.x.min,height:t.y.max-t.y.min,cx:(t.x.max+t.x.min)/2,cy:(t.y.max+t.y.min)/2}},be.prototype.intersections=function(t,e,i){void 0===e&&(e=2),void 0===i&&(i=7);var n=[];return Ce(we(this,0,1),we(t,0,1),0,e,n,i),n},be.shapeSegment=function(t,e){var i=(e+1)%t.length();return new be(t.v[e],t.o[e],t.i[i],t.v[i],!0)},be.shapeSegmentInverted=function(t,e){var i=(e+1)%t.length();return new be(t.v[i],t.i[i],t.o[e],t.v[e],!0)},u([ce],Ue),Ue.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amplitude=Ut.getProp(t,e.s,0,null,this),this.frequency=Ut.getProp(t,e.r,0,null,this),this.pointsType=Ut.getProp(t,e.pt,0,null,this),this._isAnimated=0!==this.amplitude.effectsSequence.length||0!==this.frequency.effectsSequence.length||0!==this.pointsType.effectsSequence.length},Ue.prototype.processPath=function(t,e,i,n){var r=t._length,s=Ft.newElement();if(s.c=t.c,t.c||(r-=1),0===r)return s;var a=-1,o=be.shapeSegment(t,0);Fe(s,t,0,e,i,n,a);for(var l=0;l<r;l+=1)a=ze(s,o,e,i,n,-a),o=l!==r-1||t.c?be.shapeSegment(t,(l+1)%r):null,Fe(s,t,l+1,e,i,n,a);return s},Ue.prototype.processShapes=function(t){var e,i,n,r,s,a,o=this.shapes.length,l=this.amplitude.v,h=Math.max(0,Math.round(this.frequency.v)),c=this.pointsType.v;if(0!==l)for(i=0;i<o;i+=1){if(a=(s=this.shapes[i]).localShapeCollection,s.shape._mdf||this._mdf||t)for(a.releaseShapes(),s.shape._mdf=!0,e=s.shape.paths.shapes,r=s.shape.paths._length,n=0;n<r;n+=1)a.addShape(this.processPath(e[n],l,h,c));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},u([ce],Ye),Ye.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=Ut.getProp(t,e.a,0,null,this),this.miterLimit=Ut.getProp(t,e.ml,0,null,this),this.lineJoin=e.lj,this._isAnimated=0!==this.amount.effectsSequence.length},Ye.prototype.processPath=function(t,e,i,n){var r=Ft.newElement();r.c=t.c;var s,a,o,l=t.length();t.c||(l-=1);var h=[];for(s=0;s<l;s+=1)o=be.shapeSegment(t,s),h.push(qe(o,e));if(!t.c)for(s=l-1;s>=0;s-=1)o=be.shapeSegmentInverted(t,s),h.push(qe(o,e));h=Xe(h);var c=null,u=null;for(s=0;s<h.length;s+=1){var d=h[s];for(u&&(c=He(r,u,d[0],i,n)),u=d[d.length-1],a=0;a<d.length;a+=1)o=d[a],c&&Ie(o.points[0],c)?r.setXYAt(o.points[1][0],o.points[1][1],"o",r.length()-1):r.setTripleAt(o.points[0][0],o.points[0][1],o.points[1][0],o.points[1][1],o.points[0][0],o.points[0][1],r.length()),r.setTripleAt(o.points[3][0],o.points[3][1],o.points[3][0],o.points[3][1],o.points[2][0],o.points[2][1],r.length()),c=o.points[3]}return h.length&&He(r,u,h[0][0],i,n),r},Ye.prototype.processShapes=function(t){var e,i,n,r,s,a,o=this.shapes.length,l=this.amount.v,h=this.miterLimit.v,c=this.lineJoin;if(0!==l)for(i=0;i<o;i+=1){if(a=(s=this.shapes[i]).localShapeCollection,s.shape._mdf||this._mdf||t)for(a.releaseShapes(),s.shape._mdf=!0,e=s.shape.paths.shapes,r=s.shape.paths._length,n=0;n<r;n+=1)a.addShape(this.processPath(e[n],l,c,h));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var Ze=function(){var t=5e3,e={w:0,size:0,shapes:[],data:{shapes:[]}},i=[];i=i.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var n=127988,r=917631,s=917601,a=917626,o=65039,l=8205,h=127462,u=127487,d=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function p(t){var e,i=t.split(","),n=i.length,r=[];for(e=0;e<n;e+=1)"sans-serif"!==i[e]&&"monospace"!==i[e]&&r.push(i[e]);return r.join(",")}function f(t,e){var i=c("span");i.setAttribute("aria-hidden",!0),i.style.fontFamily=e;var n=c("span");n.innerText="giItT1WQy@!-/#",i.style.position="absolute",i.style.left="-10000px",i.style.top="-10000px",i.style.fontSize="300px",i.style.fontVariant="normal",i.style.fontStyle="normal",i.style.fontWeight="normal",i.style.letterSpacing="0",i.appendChild(n),document.body.appendChild(i);var r=n.offsetWidth;return n.style.fontFamily=p(t)+", "+e,{node:n,w:r,parent:i}}function m(){var e,i,n,r=this.fonts.length,s=r;for(e=0;e<r;e+=1)this.fonts[e].loaded?s-=1:"n"===this.fonts[e].fOrigin||0===this.fonts[e].origin?this.fonts[e].loaded=!0:(i=this.fonts[e].monoCase.node,n=this.fonts[e].monoCase.w,i.offsetWidth!==n?(s-=1,this.fonts[e].loaded=!0):(i=this.fonts[e].sansCase.node,n=this.fonts[e].sansCase.w,i.offsetWidth!==n&&(s-=1,this.fonts[e].loaded=!0)),this.fonts[e].loaded&&(this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));0!==s&&Date.now()-this.initTime<t?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function g(t,e){var i,n=document.body&&e?"svg":"canvas",r=je(t);if("svg"===n){var s=Q("text");s.style.fontSize="100px",s.setAttribute("font-family",t.fFamily),s.setAttribute("font-style",r.style),s.setAttribute("font-weight",r.weight),s.textContent="1",t.fClass?(s.style.fontFamily="inherit",s.setAttribute("class",t.fClass)):s.style.fontFamily=t.fFamily,e.appendChild(s),i=s}else{var a=new OffscreenCanvas(500,500).getContext("2d");a.font=r.style+" "+r.weight+" 100px "+t.fFamily,i=a}function o(t){return"svg"===n?(i.textContent=t,i.getComputedTextLength()):i.measureText(t).width}return{measureText:o}}function _(t,e){if(t){if(this.chars)return this.isLoaded=!0,void(this.fonts=t.list);if(!document.body)return this.isLoaded=!0,t.list.forEach((function(t){t.helper=g(t),t.cache={}})),void(this.fonts=t.list);var i,n=t.list,r=n.length,s=r;for(i=0;i<r;i+=1){var a,o,l=!0;if(n[i].loaded=!1,n[i].monoCase=f(n[i].fFamily,"monospace"),n[i].sansCase=f(n[i].fFamily,"sans-serif"),n[i].fPath){if("p"===n[i].fOrigin||3===n[i].origin){if((a=document.querySelectorAll('style[f-forigin="p"][f-family="'+n[i].fFamily+'"], style[f-origin="3"][f-family="'+n[i].fFamily+'"]')).length>0&&(l=!1),l){var h=c("style");h.setAttribute("f-forigin",n[i].fOrigin),h.setAttribute("f-origin",n[i].origin),h.setAttribute("f-family",n[i].fFamily),h.type="text/css",h.innerText="@font-face {font-family: "+n[i].fFamily+"; font-style: normal; src: url('"+n[i].fPath+"');}",e.appendChild(h)}}else if("g"===n[i].fOrigin||1===n[i].origin){for(a=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),o=0;o<a.length;o+=1)-1!==a[o].href.indexOf(n[i].fPath)&&(l=!1);if(l){var u=c("link");u.setAttribute("f-forigin",n[i].fOrigin),u.setAttribute("f-origin",n[i].origin),u.type="text/css",u.rel="stylesheet",u.href=n[i].fPath,document.body.appendChild(u)}}else if("t"===n[i].fOrigin||2===n[i].origin){for(a=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),o=0;o<a.length;o+=1)n[i].fPath===a[o].src&&(l=!1);if(l){var d=c("link");d.setAttribute("f-forigin",n[i].fOrigin),d.setAttribute("f-origin",n[i].origin),d.setAttribute("rel","stylesheet"),d.setAttribute("href",n[i].fPath),e.appendChild(d)}}}else n[i].loaded=!0,s-=1;n[i].helper=g(n[i],e),n[i].cache={},this.fonts.push(n[i])}0===s?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0}function v(t){if(t){var e;this.chars||(this.chars=[]);var i,n,r=t.length,s=this.chars.length;for(e=0;e<r;e+=1){for(i=0,n=!1;i<s;)this.chars[i].style===t[e].style&&this.chars[i].fFamily===t[e].fFamily&&this.chars[i].ch===t[e].ch&&(n=!0),i+=1;n||(this.chars.push(t[e]),s+=1)}}}function y(t,i,n){for(var r=0,s=this.chars.length;r<s;){if(this.chars[r].ch===t&&this.chars[r].style===i&&this.chars[r].fFamily===n)return this.chars[r];r+=1}return("string"==typeof t&&13!==t.charCodeAt(0)||!t)&&console&&console.warn&&!this._warned&&(this._warned=!0),e}function x(t,e,i){var n=this.getFontByName(e),r=t;if(!n.cache[r]){var s=n.helper;if(" "===t){var a=s.measureText("|"+t+"|"),o=s.measureText("||");n.cache[r]=(a-o)/100}else n.cache[r]=s.measureText(t)/100}return n.cache[r]*i}function S(t){for(var e=0,i=this.fonts.length;e<i;){if(this.fonts[e].fName===t)return this.fonts[e];e+=1}return this.fonts[0]}function M(t){var e=0,i=t.charCodeAt(0);if(i>=55296&&i<=56319){var n=t.charCodeAt(1);n>=56320&&n<=57343&&(e=1024*(i-55296)+n-56320+65536)}return e}function b(t,e){var i=t.toString(16)+e.toString(16);return-1!==d.indexOf(i)}function T(t){return t===l}function w(t){return t===o}function E(t){var e=M(t);return e>=h&&e<=u}function A(t){return E(t.substr(0,2))&&E(t.substr(2,2))}function C(t){return-1!==i.indexOf(t)}function P(t,e){var i=M(t.substr(e,2));if(i!==n)return!1;var o=0;for(e+=2;o<5;){if((i=M(t.substr(e,2)))<s||i>a)return!1;o+=1,e+=2}return M(t.substr(e,2))===r}function L(){this.isLoaded=!0}var R=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};R.isModifier=b,R.isZeroWidthJoiner=T,R.isFlagEmoji=A,R.isRegionalCode=E,R.isCombinedCharacter=C,R.isRegionalFlag=P,R.isVariationSelector=w,R.BLACK_FLAG_CODE_POINT=n;var D={addChars:v,addFonts:_,getCharData:y,getFontByName:S,measureText:x,checkLoadedFonts:m,setIsLoaded:L};return R.prototype=D,R}();function Ke(t){this.animationData=t}function Je(t){return new Ke(t)}function $e(){}Ke.prototype.getProp=function(t){return this.animationData.slots&&this.animationData.slots[t.sid]?Object.assign(t,this.animationData.slots[t.sid].p):t},$e.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(t){-1===this.renderableComponents.indexOf(t)&&this.renderableComponents.push(t)},removeRenderableComponent:function(t){-1!==this.renderableComponents.indexOf(t)&&this.renderableComponents.splice(this.renderableComponents.indexOf(t),1)},prepareRenderableFrame:function(t){this.checkLayerLimits(t)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(t){this.data.ip-this.data.st<=t&&this.data.op-this.data.st>t?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var t,e=this.renderableComponents.length;for(t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var Qe,ti=(Qe={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(t){return Qe[t]||""});function ei(t,e,i){this.p=Ut.getProp(e,t.v,0,0,i)}function ii(t,e,i){this.p=Ut.getProp(e,t.v,0,0,i)}function ni(t,e,i){this.p=Ut.getProp(e,t.v,1,0,i)}function ri(t,e,i){this.p=Ut.getProp(e,t.v,1,0,i)}function si(t,e,i){this.p=Ut.getProp(e,t.v,0,0,i)}function ai(t,e,i){this.p=Ut.getProp(e,t.v,0,0,i)}function oi(t,e,i){this.p=Ut.getProp(e,t.v,0,0,i)}function li(){this.p={}}function hi(t,e){var i,n=t.ef||[];this.effectElements=[];var r,s=n.length;for(i=0;i<s;i+=1)r=new ci(n[i],e),this.effectElements.push(r)}function ci(t,e){this.init(t,e)}function ui(){}function di(){}function pi(t,e,i){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(t,e,i)}function fi(t,e,i){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.initBaseData(t,e,i),this._isPlaying=!1,this._canPlay=!1;var n=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(n),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=t.tm?Ut.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0},this.lv=Ut.getProp(this,t.au&&t.au.lv?t.au.lv:{k:[100]},1,.01,this)}function mi(){}u([Nt],ci),ci.prototype.getValue=ci.prototype.iterateDynamicProperties,ci.prototype.init=function(t,e){var i;this.data=t,this.effectElements=[],this.initDynamicPropertyContainer(e);var n,r=this.data.ef.length,s=this.data.ef;for(i=0;i<r;i+=1){switch(n=null,s[i].ty){case 0:n=new ei(s[i],e,this);break;case 1:n=new ii(s[i],e,this);break;case 2:n=new ni(s[i],e,this);break;case 3:n=new ri(s[i],e,this);break;case 4:case 7:n=new oi(s[i],e,this);break;case 10:n=new si(s[i],e,this);break;case 11:n=new ai(s[i],e,this);break;case 5:n=new hi(s[i],e,this);break;default:n=new li(s[i],e,this)}n&&this.effectElements.push(n)}},ui.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var t=0,e=this.data.masksProperties.length;t<e;){if("n"!==this.data.masksProperties[t].mode&&!1!==this.data.masksProperties[t].cl)return!0;t+=1}return!1},initExpressions:function(){var t=Z();if(t){var e=t("layer"),i=t("effects"),n=t("shape"),r=t("text"),s=t("comp");this.layerInterface=e(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var a=i.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(a),0===this.data.ty||this.data.xt?this.compInterface=s(this):4===this.data.ty?(this.layerInterface.shapeInterface=n(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=r(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var t=ti(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=t},initBaseData:function(t,e,i){this.globalData=e,this.comp=i,this.data=t,this.layerId=z(),this.data.sr||(this.data.sr=1),this.effectsManager=new hi(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},di.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(t,e){var i,n=this.dynamicProperties.length;for(i=0;i<n;i+=1)(e||this._isParent&&"transform"===this.dynamicProperties[i].propType)&&(this.dynamicProperties[i].getValue(),this.dynamicProperties[i]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&this.dynamicProperties.push(t)}},pi.prototype.prepareFrame=function(){},u([$e,ui,di],pi),pi.prototype.getBaseElement=function(){return null},pi.prototype.renderFrame=function(){},pi.prototype.destroy=function(){},pi.prototype.initExpressions=function(){var t=Z();if(t){var e=t("footage");this.layerInterface=e(this)}},pi.prototype.getFootageData=function(){return this.footageData},fi.prototype.prepareFrame=function(t){if(this.prepareRenderableFrame(t,!0),this.prepareProperties(t,!0),this.tm._placeholder)this._currentTime=t/this.data.sr;else{var e=this.tm.v;this._currentTime=e}this._volume=this.lv.v[0];var i=this._volume*this._volumeMultiplier;this._previousVolume!==i&&(this._previousVolume=i,this.audio.volume(i))},u([$e,ui,di],fi),fi.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},fi.prototype.show=function(){},fi.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},fi.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},fi.prototype.resume=function(){this._canPlay=!0},fi.prototype.setRate=function(t){this.audio.rate(t)},fi.prototype.volume=function(t){this._volumeMultiplier=t,this._previousVolume=t*this._volume,this.audio.volume(this._previousVolume)},fi.prototype.getBaseElement=function(){return null},fi.prototype.destroy=function(){},fi.prototype.sourceRectAtTime=function(){},fi.prototype.initExpressions=function(){},mi.prototype.checkLayers=function(t){var e,i,n=this.layers.length;for(this.completeLayers=!0,e=n-1;e>=0;e-=1)this.elements[e]||(i=this.layers[e]).ip-i.st<=t-this.layers[e].st&&i.op-i.st>t-this.layers[e].st&&this.buildItem(e),this.completeLayers=!!this.elements[e]&&this.completeLayers;this.checkPendingElements()},mi.prototype.createItem=function(t){switch(t.ty){case 2:return this.createImage(t);case 0:return this.createComp(t);case 1:return this.createSolid(t);case 3:default:return this.createNull(t);case 4:return this.createShape(t);case 5:return this.createText(t);case 6:return this.createAudio(t);case 13:return this.createCamera(t);case 15:return this.createFootage(t)}},mi.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},mi.prototype.createAudio=function(t){return new fi(t,this.globalData,this)},mi.prototype.createFootage=function(t){return new pi(t,this.globalData,this)},mi.prototype.buildAllItems=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},mi.prototype.includeLayers=function(t){var e;this.completeLayers=!1;var i,n=t.length,r=this.layers.length;for(e=0;e<n;e+=1)for(i=0;i<r;){if(this.layers[i].id===t[e].id){this.layers[i]=t[e];break}i+=1}},mi.prototype.setProjectInterface=function(t){this.globalData.projectInterface=t},mi.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},mi.prototype.buildElementParenting=function(t,e,i){for(var n=this.elements,r=this.layers,s=0,a=r.length;s<a;)r[s].ind==e&&(n[s]&&!0!==n[s]?(i.push(n[s]),n[s].setAsParent(),void 0!==r[s].parent?this.buildElementParenting(t,r[s].parent,i):t.setHierarchy(i)):(this.buildItem(s),this.addPendingElement(t))),s+=1},mi.prototype.addPendingElement=function(t){this.pendingElements.push(t)},mi.prototype.searchExtraCompositions=function(t){var e,i=t.length;for(e=0;e<i;e+=1)if(t[e].xt){var n=this.createComp(t[e]);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},mi.prototype.getElementById=function(t){var e,i=this.elements.length;for(e=0;e<i;e+=1)if(this.elements[e].data.ind===t)return this.elements[e];return null},mi.prototype.getElementByPath=function(t){var e,i=t.shift();if("number"==typeof i)e=this.elements[i];else{var n,r=this.elements.length;for(n=0;n<r;n+=1)if(this.elements[n].data.nm===i){e=this.elements[n];break}}return 0===t.length?e:e.getElementByPath(t)},mi.prototype.setupGlobalData=function(t,e){this.globalData.fontManager=new Ze,this.globalData.slotManager=Je(t),this.globalData.fontManager.addChars(t.chars),this.globalData.fontManager.addFonts(t.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=t.fr,this.globalData.nm=t.nm,this.globalData.compSize={w:t.w,h:t.h}};var gi={TRANSFORM_EFFECT:"transformEFfect"};function _i(){}function vi(t,e,i){this.data=t,this.element=e,this.globalData=i,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var n,r,s=this.globalData.defs,a=this.masksProperties?this.masksProperties.length:0;this.viewData=m(a),this.solidPath="";var o,l,c,u,d,p,f=this.masksProperties,g=0,_=[],v=z(),y="clipPath",x="clip-path";for(n=0;n<a;n+=1)if(("a"!==f[n].mode&&"n"!==f[n].mode||f[n].inv||100!==f[n].o.k||f[n].o.x)&&(y="mask",x="mask"),"s"!==f[n].mode&&"i"!==f[n].mode||0!==g?c=null:((c=Q("rect")).setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),_.push(c)),r=Q("path"),"n"===f[n].mode)this.viewData[n]={op:Ut.getProp(this.element,f[n].o,0,.01,this.element),prop:Vt.getShapeProp(this.element,f[n],3),elem:r,lastPath:""},s.appendChild(r);else{var S;if(g+=1,r.setAttribute("fill","s"===f[n].mode?"#000000":"#ffffff"),r.setAttribute("clip-rule","nonzero"),0!==f[n].x.k?(y="mask",x="mask",p=Ut.getProp(this.element,f[n].x,0,null,this.element),S=z(),(u=Q("filter")).setAttribute("id",S),(d=Q("feMorphology")).setAttribute("operator","erode"),d.setAttribute("in","SourceGraphic"),d.setAttribute("radius","0"),u.appendChild(d),s.appendChild(u),r.setAttribute("stroke","s"===f[n].mode?"#000000":"#ffffff")):(d=null,p=null),this.storedData[n]={elem:r,x:p,expan:d,lastPath:"",lastOperator:"",filterId:S,lastRadius:0},"i"===f[n].mode){l=_.length;var M=Q("g");for(o=0;o<l;o+=1)M.appendChild(_[o]);var b=Q("mask");b.setAttribute("mask-type","alpha"),b.setAttribute("id",v+"_"+g),b.appendChild(r),s.appendChild(b),M.setAttribute("mask","url("+h()+"#"+v+"_"+g+")"),_.length=0,_.push(M)}else _.push(r);f[n].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[n]={elem:r,lastPath:"",op:Ut.getProp(this.element,f[n].o,0,.01,this.element),prop:Vt.getShapeProp(this.element,f[n],3),invRect:c},this.viewData[n].prop.k||this.drawPath(f[n],this.viewData[n].prop.v,this.viewData[n])}for(this.maskElement=Q(y),a=_.length,n=0;n<a;n+=1)this.maskElement.appendChild(_[n]);g>0&&(this.maskElement.setAttribute("id",v),this.element.maskedElement.setAttribute(x,"url("+h()+"#"+v+")"),s.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}_i.prototype={initTransform:function(){var t=new Ht;this.finalTransform={mProp:this.data.ks?pe.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:t,localMat:t,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var t,e=this.finalTransform.mat,i=0,n=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;i<n;){if(this.hierarchy[i].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}i+=1}if(this.finalTransform._matMdf)for(t=this.finalTransform.mProp.v.props,e.cloneFromProps(t),i=0;i<n;i+=1)e.multiply(this.hierarchy[i].finalTransform.mProp.v)}this.finalTransform._matMdf&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var t=0,e=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;t<e;)this.localTransforms[t]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[t]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),t+=1;if(this.finalTransform._localMatMdf){var i=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(i),t=1;t<e;t+=1){var n=this.localTransforms[t].matrix;i.multiply(n)}i.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var r=this.finalTransform.localOpacity;for(t=0;t<e;t+=1)r*=.01*this.localTransforms[t].opacity;this.finalTransform.localOpacity=r}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var t=this.renderableEffectsManager.getEffects(gi.TRANSFORM_EFFECT);if(t.length){this.localTransforms=[],this.finalTransform.localMat=new Ht;var e=0,i=t.length;for(e=0;e<i;e+=1)this.localTransforms.push(t[e])}}},globalToLocal:function(t){var e=[];e.push(this.finalTransform);for(var i,n=!0,r=this.comp;n;)r.finalTransform?(r.data.hasMask&&e.splice(0,0,r.finalTransform),r=r.comp):n=!1;var s,a=e.length;for(i=0;i<a;i+=1)s=e[i].mat.applyToPointArray(0,0,0),t=[t[0]-s[0],t[1]-s[1],0];return t},mHelper:new Ht},vi.prototype.getMaskProperty=function(t){return this.viewData[t].prop},vi.prototype.renderFrame=function(t){var e,i=this.element.finalTransform.mat,n=this.masksProperties.length;for(e=0;e<n;e+=1)if((this.viewData[e].prop._mdf||t)&&this.drawPath(this.masksProperties[e],this.viewData[e].prop.v,this.viewData[e]),(this.viewData[e].op._mdf||t)&&this.viewData[e].elem.setAttribute("fill-opacity",this.viewData[e].op.v),"n"!==this.masksProperties[e].mode&&(this.viewData[e].invRect&&(this.element.finalTransform.mProp._mdf||t)&&this.viewData[e].invRect.setAttribute("transform",i.getInverseMatrix().to2dCSS()),this.storedData[e].x&&(this.storedData[e].x._mdf||t))){var r=this.storedData[e].expan;this.storedData[e].x.v<0?("erode"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="erode",this.storedData[e].elem.setAttribute("filter","url("+h()+"#"+this.storedData[e].filterId+")")),r.setAttribute("radius",-this.storedData[e].x.v)):("dilate"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="dilate",this.storedData[e].elem.setAttribute("filter",null)),this.storedData[e].elem.setAttribute("stroke-width",2*this.storedData[e].x.v))}},vi.prototype.getMaskelement=function(){return this.maskElement},vi.prototype.createLayerSolidPath=function(){var t="M0,0 ";return t+=" h"+this.globalData.compSize.w,t+=" v"+this.globalData.compSize.h,t+=" h-"+this.globalData.compSize.w,t+=" v-"+this.globalData.compSize.h+" "},vi.prototype.drawPath=function(t,e,i){var n,r,s=" M"+e.v[0][0]+","+e.v[0][1];for(r=e._length,n=1;n<r;n+=1)s+=" C"+e.o[n-1][0]+","+e.o[n-1][1]+" "+e.i[n][0]+","+e.i[n][1]+" "+e.v[n][0]+","+e.v[n][1];if(e.c&&r>1&&(s+=" C"+e.o[n-1][0]+","+e.o[n-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),i.lastPath!==s){var a="";i.elem&&(e.c&&(a=t.inv?this.solidPath+s:s),i.elem.setAttribute("d",a)),i.lastPath=s}},vi.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var yi,xi=function(){var t={};function e(t,e){var i=Q("filter");return i.setAttribute("id",t),!0!==e&&(i.setAttribute("filterUnits","objectBoundingBox"),i.setAttribute("x","0%"),i.setAttribute("y","0%"),i.setAttribute("width","100%"),i.setAttribute("height","100%")),i}function i(){var t=Q("feColorMatrix");return t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),t}return t.createFilter=e,t.createAlphaToLuminanceFilter=i,t}(),Si=(yi={maskType:!0,svgLumaHidden:!0,offscreenCanvas:"undefined"!=typeof OffscreenCanvas},(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(yi.maskType=!1),/firefox/i.test(navigator.userAgent)&&(yi.svgLumaHidden=!1),yi),Mi={},bi="filter_result_";function Ti(t){var e,i,n="SourceGraphic",r=t.data.ef?t.data.ef.length:0,s=z(),a=xi.createFilter(s,!0),o=0;for(this.filters=[],e=0;e<r;e+=1){i=null;var l=t.data.ef[e].ty;Mi[l]&&(i=new(0,Mi[l].effect)(a,t.effectsManager.effectElements[e],t,bi+o,n),n=bi+o,Mi[l].countsAsEffect&&(o+=1)),i&&this.filters.push(i)}o&&(t.globalData.defs.appendChild(a),t.layerElement.setAttribute("filter","url("+h()+"#"+s+")")),this.filters.length&&t.addRenderableComponent(this)}function wi(){}function Ei(){}function Ai(){}function Ci(t,e,i){this.assetData=e.getAssetData(t.refId),this.assetData&&this.assetData.sid&&(this.assetData=e.slotManager.getProp(this.assetData)),this.initElement(t,e,i),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function Pi(t,e){this.elem=t,this.pos=e}function Li(){}Ti.prototype.renderFrame=function(t){var e,i=this.filters.length;for(e=0;e<i;e+=1)this.filters[e].renderFrame(t)},Ti.prototype.getEffects=function(t){var e,i=this.filters.length,n=[];for(e=0;e<i;e+=1)this.filters[e].type===t&&n.push(this.filters[e]);return n},wi.prototype={initRendererElement:function(){this.layerElement=Q("g")},createContainerElements:function(){this.matteElement=Q("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var t=null;if(this.data.td){this.matteMasks={};var e=Q("g");e.setAttribute("id",this.layerId),e.appendChild(this.layerElement),t=e,this.globalData.defs.appendChild(e)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),t=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var i=Q("clipPath"),n=Q("path");n.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var r=z();if(i.setAttribute("id",r),i.appendChild(n),this.globalData.defs.appendChild(i),this.checkMasks()){var s=Q("g");s.setAttribute("clip-path","url("+h()+"#"+r+")"),s.appendChild(this.layerElement),this.transformedElement=s,t?t.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+h()+"#"+r+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new vi(this.data,this,this.globalData),this.renderableEffectsManager=new Ti(this),this.searchEffectTransforms()},getMatte:function(t){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[t]){var e,i,n,r,s=this.layerId+"_"+t;if(1===t||3===t){var a=Q("mask");a.setAttribute("id",s),a.setAttribute("mask-type",3===t?"luminance":"alpha"),(n=Q("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),a.appendChild(n),this.globalData.defs.appendChild(a),Si.maskType||1!==t||(a.setAttribute("mask-type","luminance"),e=z(),i=xi.createFilter(e),this.globalData.defs.appendChild(i),i.appendChild(xi.createAlphaToLuminanceFilter()),(r=Q("g")).appendChild(n),a.appendChild(r),r.setAttribute("filter","url("+h()+"#"+e+")"))}else if(2===t){var o=Q("mask");o.setAttribute("id",s),o.setAttribute("mask-type","alpha");var l=Q("g");o.appendChild(l),e=z(),i=xi.createFilter(e);var c=Q("feComponentTransfer");c.setAttribute("in","SourceGraphic"),i.appendChild(c);var u=Q("feFuncA");u.setAttribute("type","table"),u.setAttribute("tableValues","1.0 0.0"),c.appendChild(u),this.globalData.defs.appendChild(i);var d=Q("rect");d.setAttribute("width",this.comp.data.w),d.setAttribute("height",this.comp.data.h),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("fill","#ffffff"),d.setAttribute("opacity","0"),l.setAttribute("filter","url("+h()+"#"+e+")"),l.appendChild(d),(n=Q("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(n),Si.maskType||(o.setAttribute("mask-type","luminance"),i.appendChild(xi.createAlphaToLuminanceFilter()),r=Q("g"),l.appendChild(d),r.appendChild(this.layerElement),l.appendChild(r)),this.globalData.defs.appendChild(o)}this.matteMasks[t]=s}return this.matteMasks[t]},setMatte:function(t){this.matteElement&&this.matteElement.setAttribute("mask","url("+h()+"#"+t+")")}},Ei.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(t){this.hierarchy=t},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},u([$e,d({initElement:function(t,e,i){this.initFrame(),this.initBaseData(t,e,i),this.initTransform(t,e,i),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],Ai),u([ui,_i,wi,Ei,di,Ai],Ci),Ci.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData);this.innerElem=Q("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.innerElem)},Ci.prototype.sourceRectAtTime=function(){return this.sourceRect},Li.prototype={addShapeToModifiers:function(t){var e,i=this.shapeModifiers.length;for(e=0;e<i;e+=1)this.shapeModifiers[e].addShape(t)},isShapeInAnimatedModifiers:function(t){for(var e=0,i=this.shapeModifiers.length;e<i;)if(this.shapeModifiers[e].isAnimatedWithShape(t))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var t,e=this.shapes.length;for(t=0;t<e;t+=1)this.shapes[t].sh.reset();for(t=(e=this.shapeModifiers.length)-1;t>=0&&!this.shapeModifiers[t].processShapes(this._isFirstFrame);t-=1);}},searchProcessedElement:function(t){for(var e=this.processedElements,i=0,n=e.length;i<n;){if(e[i].elem===t)return e[i].pos;i+=1}return 0},addProcessedElement:function(t,e){for(var i=this.processedElements,n=i.length;n;)if(i[n-=1].elem===t)return void(i[n].pos=e);i.push(new Pi(t,e))},prepareFrame:function(t){this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)}};var Ri={1:"butt",2:"round",3:"square"},Di={1:"miter",2:"round",3:"bevel"};function Ii(t,e,i){this.caches=[],this.styles=[],this.transformers=t,this.lStr="",this.sh=i,this.lvl=e,this._isAnimated=!!i.k;for(var n=0,r=t.length;n<r;){if(t[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}function Ui(t,e){this.data=t,this.type=t.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=!0===t.hd,this.pElem=Q("path"),this.msElem=null}function Ni(t,e,i,n){var r;this.elem=t,this.frameId=-1,this.dataProps=m(e.length),this.renderer=i,this.k=!1,this.dashStr="",this.dashArray=f("float32",e.length?e.length-1:0),this.dashoffset=f("float32",1),this.initDynamicPropertyContainer(n);var s,a=e.length||0;for(r=0;r<a;r+=1)s=Ut.getProp(t,e[r].v,0,0,this),this.k=s.k||this.k,this.dataProps[r]={n:e[r].n,p:s};this.k||this.getValue(!0),this._isAnimated=this.k}function Oi(t,e,i){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=Ut.getProp(t,e.o,0,.01,this),this.w=Ut.getProp(t,e.w,0,null,this),this.d=new Ni(t,e.d||{},"svg",this),this.c=Ut.getProp(t,e.c,1,255,this),this.style=i,this._isAnimated=!!this._isAnimated}function ki(t,e,i){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=Ut.getProp(t,e.o,0,.01,this),this.c=Ut.getProp(t,e.c,1,255,this),this.style=i}function Fi(t,e,i){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.style=i}function zi(t,e,i){this.data=e,this.c=f("uint8c",4*e.p);var n=e.k.k[0].s?e.k.k[0].s.length-4*e.p:e.k.k.length-4*e.p;this.o=f("float32",n),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=n,this.initDynamicPropertyContainer(i),this.prop=Ut.getProp(t,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function Bi(t,e,i){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.initGradientData(t,e,i)}function Vi(t,e,i){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.w=Ut.getProp(t,e.w,0,null,this),this.d=new Ni(t,e.d||{},"svg",this),this.initGradientData(t,e,i),this._isAnimated=!!this._isAnimated}function Hi(){this.it=[],this.prevViewData=[],this.gr=Q("g")}function Gi(t,e,i){this.transform={mProps:t,op:e,container:i},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}Ii.prototype.setAsAnimated=function(){this._isAnimated=!0},Ui.prototype.reset=function(){this.d="",this._mdf=!1},Ni.prototype.getValue=function(t){if((this.elem.globalData.frameId!==this.frameId||t)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||t,this._mdf)){var e=0,i=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),e=0;e<i;e+=1)"o"!==this.dataProps[e].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},u([Nt],Ni),u([Nt],Oi),u([Nt],ki),u([Nt],Fi),zi.prototype.comparePoints=function(t,e){for(var i=0,n=this.o.length/2;i<n;){if(Math.abs(t[4*i]-t[4*e+2*i])>.01)return!1;i+=1}return!0},zi.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var t=0,e=this.data.k.k.length;t<e;){if(!this.comparePoints(this.data.k.k[t].s,this.data.p))return!1;t+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},zi.prototype.getValue=function(t){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||t){var e,i,n,r=4*this.data.p;for(e=0;e<r;e+=1)i=e%4==0?100:255,n=Math.round(this.prop.v[e]*i),this.c[e]!==n&&(this.c[e]=n,this._cmdf=!t);if(this.o.length)for(r=this.prop.v.length,e=4*this.data.p;e<r;e+=1)i=e%2==0?100:1,n=e%2==0?Math.round(100*this.prop.v[e]):this.prop.v[e],this.o[e-4*this.data.p]!==n&&(this.o[e-4*this.data.p]=n,this._omdf=!t);this._mdf=!t}},u([Nt],zi),Bi.prototype.initGradientData=function(t,e,i){this.o=Ut.getProp(t,e.o,0,.01,this),this.s=Ut.getProp(t,e.s,1,null,this),this.e=Ut.getProp(t,e.e,1,null,this),this.h=Ut.getProp(t,e.h||{k:0},0,.01,this),this.a=Ut.getProp(t,e.a||{k:0},0,C,this),this.g=new zi(t,e.g,this),this.style=i,this.stops=[],this.setGradientData(i.pElem,e),this.setGradientOpacity(e,i),this._isAnimated=!!this._isAnimated},Bi.prototype.setGradientData=function(t,e){var i=z(),n=Q(1===e.t?"linearGradient":"radialGradient");n.setAttribute("id",i),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");var r,s,a,o=[];for(a=4*e.g.p,s=0;s<a;s+=4)r=Q("stop"),n.appendChild(r),o.push(r);t.setAttribute("gf"===e.ty?"fill":"stroke","url("+h()+"#"+i+")"),this.gf=n,this.cst=o},Bi.prototype.setGradientOpacity=function(t,e){if(this.g._hasOpacity&&!this.g._collapsable){var i,n,r,s=Q("mask"),a=Q("path");s.appendChild(a);var o=z(),l=z();s.setAttribute("id",l);var c=Q(1===t.t?"linearGradient":"radialGradient");c.setAttribute("id",o),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),r=t.g.k.k[0].s?t.g.k.k[0].s.length:t.g.k.k.length;var u=this.stops;for(n=4*t.g.p;n<r;n+=2)(i=Q("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(i),u.push(i);a.setAttribute("gf"===t.ty?"fill":"stroke","url("+h()+"#"+o+")"),"gs"===t.ty&&(a.setAttribute("stroke-linecap",Ri[t.lc||2]),a.setAttribute("stroke-linejoin",Di[t.lj||2]),1===t.lj&&a.setAttribute("stroke-miterlimit",t.ml)),this.of=c,this.ms=s,this.ost=u,this.maskId=l,e.msElem=a}},u([Nt],Bi),u([Bi,Nt],Vi);var Wi=function(t,e,i,n){if(0===e)return"";var r,s=t.o,a=t.i,o=t.v,l=" M"+n.applyToPointStringified(o[0][0],o[0][1]);for(r=1;r<e;r+=1)l+=" C"+n.applyToPointStringified(s[r-1][0],s[r-1][1])+" "+n.applyToPointStringified(a[r][0],a[r][1])+" "+n.applyToPointStringified(o[r][0],o[r][1]);return i&&e&&(l+=" C"+n.applyToPointStringified(s[r-1][0],s[r-1][1])+" "+n.applyToPointStringified(a[0][0],a[0][1])+" "+n.applyToPointStringified(o[0][0],o[0][1]),l+="z"),l},Xi=function(){var t=new Ht,e=new Ht;function i(t){switch(t.ty){case"fl":return a;case"gf":return l;case"gs":return o;case"st":return h;case"sh":case"el":case"rc":case"sr":return s;case"tr":return n;case"no":return r;default:return null}}function n(t,e,i){(i||e.transform.op._mdf)&&e.transform.container.setAttribute("opacity",e.transform.op.v),(i||e.transform.mProps._mdf)&&e.transform.container.setAttribute("transform",e.transform.mProps.v.to2dCSS())}function r(){}function s(i,n,r){var s,a,o,l,h,c,u,d,p,f,m=n.styles.length,g=n.lvl;for(c=0;c<m;c+=1){if(l=n.sh._mdf||r,n.styles[c].lvl<g){for(d=e.reset(),p=g-n.styles[c].lvl,f=n.transformers.length-1;!l&&p>0;)l=n.transformers[f].mProps._mdf||l,p-=1,f-=1;if(l)for(p=g-n.styles[c].lvl,f=n.transformers.length-1;p>0;)d.multiply(n.transformers[f].mProps.v),p-=1,f-=1}else d=t;if(a=(u=n.sh.paths)._length,l){for(o="",s=0;s<a;s+=1)(h=u.shapes[s])&&h._length&&(o+=Wi(h,h._length,h.c,d));n.caches[c]=o}else o=n.caches[c];n.styles[c].d+=!0===i.hd?"":o,n.styles[c]._mdf=l||n.styles[c]._mdf}}function a(t,e,i){var n=e.style;(e.c._mdf||i)&&n.pElem.setAttribute("fill","rgb("+T(e.c.v[0])+","+T(e.c.v[1])+","+T(e.c.v[2])+")"),(e.o._mdf||i)&&n.pElem.setAttribute("fill-opacity",e.o.v)}function o(t,e,i){l(t,e,i),h(t,e,i)}function l(t,e,i){var n,r,s,a,o,l=e.gf,h=e.g._hasOpacity,c=e.s.v,u=e.e.v;if(e.o._mdf||i){var d="gf"===t.ty?"fill-opacity":"stroke-opacity";e.style.pElem.setAttribute(d,e.o.v)}if(e.s._mdf||i){var p=1===t.t?"x1":"cx",f="x1"===p?"y1":"cy";l.setAttribute(p,c[0]),l.setAttribute(f,c[1]),h&&!e.g._collapsable&&(e.of.setAttribute(p,c[0]),e.of.setAttribute(f,c[1]))}if(e.g._cmdf||i){n=e.cst;var m=e.g.c;for(s=n.length,r=0;r<s;r+=1)(a=n[r]).setAttribute("offset",m[4*r]+"%"),a.setAttribute("stop-color","rgb("+m[4*r+1]+","+m[4*r+2]+","+m[4*r+3]+")")}if(h&&(e.g._omdf||i)){var g=e.g.o;for(s=(n=e.g._collapsable?e.cst:e.ost).length,r=0;r<s;r+=1)a=n[r],e.g._collapsable||a.setAttribute("offset",g[2*r]+"%"),a.setAttribute("stop-opacity",g[2*r+1])}if(1===t.t)(e.e._mdf||i)&&(l.setAttribute("x2",u[0]),l.setAttribute("y2",u[1]),h&&!e.g._collapsable&&(e.of.setAttribute("x2",u[0]),e.of.setAttribute("y2",u[1])));else if((e.s._mdf||e.e._mdf||i)&&(o=Math.sqrt(Math.pow(c[0]-u[0],2)+Math.pow(c[1]-u[1],2)),l.setAttribute("r",o),h&&!e.g._collapsable&&e.of.setAttribute("r",o)),e.e._mdf||e.h._mdf||e.a._mdf||i){o||(o=Math.sqrt(Math.pow(c[0]-u[0],2)+Math.pow(c[1]-u[1],2)));var _=Math.atan2(u[1]-c[1],u[0]-c[0]),v=e.h.v;v>=1?v=.99:v<=-1&&(v=-.99);var y=o*v,x=Math.cos(_+e.a.v)*y+c[0],S=Math.sin(_+e.a.v)*y+c[1];l.setAttribute("fx",x),l.setAttribute("fy",S),h&&!e.g._collapsable&&(e.of.setAttribute("fx",x),e.of.setAttribute("fy",S))}}function h(t,e,i){var n=e.style,r=e.d;r&&(r._mdf||i)&&r.dashStr&&(n.pElem.setAttribute("stroke-dasharray",r.dashStr),n.pElem.setAttribute("stroke-dashoffset",r.dashoffset[0])),e.c&&(e.c._mdf||i)&&n.pElem.setAttribute("stroke","rgb("+T(e.c.v[0])+","+T(e.c.v[1])+","+T(e.c.v[2])+")"),(e.o._mdf||i)&&n.pElem.setAttribute("stroke-opacity",e.o.v),(e.w._mdf||i)&&(n.pElem.setAttribute("stroke-width",e.w.v),n.msElem&&n.msElem.setAttribute("stroke-width",e.w.v))}return{createRenderFunction:i}}();function qi(t,e,i){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(t,e,i),this.prevViewData=[]}function Yi(t,e,i,n,r,s){this.o=t,this.sw=e,this.sc=i,this.fc=n,this.m=r,this.p=s,this._mdf={o:!0,sw:!!e,sc:!!i,fc:!!n,m:!0,p:!0}}function ji(t,e){this._frameId=s,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,e.d&&e.d.sid&&(e.d=t.globalData.slotManager.getProp(e.d)),this.data=e,this.elem=t,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}u([ui,_i,wi,Li,Ei,di,Ai],qi),qi.prototype.initSecondaryElement=function(){},qi.prototype.identityMatrix=new Ht,qi.prototype.buildExpressionInterface=function(){},qi.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},qi.prototype.filterUniqueShapes=function(){var t,e,i,n,r=this.shapes.length,s=this.stylesList.length,a=[],o=!1;for(i=0;i<s;i+=1){for(n=this.stylesList[i],o=!1,a.length=0,t=0;t<r;t+=1)-1!==(e=this.shapes[t]).styles.indexOf(n)&&(a.push(e),o=e._isAnimated||o);a.length>1&&o&&this.setShapesAsAnimated(a)}},qi.prototype.setShapesAsAnimated=function(t){var e,i=t.length;for(e=0;e<i;e+=1)t[e].setAsAnimated()},qi.prototype.createStyleElement=function(t,e){var i,n=new Ui(t,e),r=n.pElem;return"st"===t.ty?i=new Oi(this,t,n):"fl"===t.ty?i=new ki(this,t,n):"gf"===t.ty||"gs"===t.ty?(i=new("gf"===t.ty?Bi:Vi)(this,t,n),this.globalData.defs.appendChild(i.gf),i.maskId&&(this.globalData.defs.appendChild(i.ms),this.globalData.defs.appendChild(i.of),r.setAttribute("mask","url("+h()+"#"+i.maskId+")"))):"no"===t.ty&&(i=new Fi(this,t,n)),"st"!==t.ty&&"gs"!==t.ty||(r.setAttribute("stroke-linecap",Ri[t.lc||2]),r.setAttribute("stroke-linejoin",Di[t.lj||2]),r.setAttribute("fill-opacity","0"),1===t.lj&&r.setAttribute("stroke-miterlimit",t.ml)),2===t.r&&r.setAttribute("fill-rule","evenodd"),t.ln&&r.setAttribute("id",t.ln),t.cl&&r.setAttribute("class",t.cl),t.bm&&(r.style["mix-blend-mode"]=ti(t.bm)),this.stylesList.push(n),this.addToAnimatedContents(t,i),i},qi.prototype.createGroupElement=function(t){var e=new Hi;return t.ln&&e.gr.setAttribute("id",t.ln),t.cl&&e.gr.setAttribute("class",t.cl),t.bm&&(e.gr.style["mix-blend-mode"]=ti(t.bm)),e},qi.prototype.createTransformElement=function(t,e){var i=pe.getTransformProperty(this,t,this),n=new Gi(i,i.o,e);return this.addToAnimatedContents(t,n),n},qi.prototype.createShapeElement=function(t,e,i){var n=4;"rc"===t.ty?n=5:"el"===t.ty?n=6:"sr"===t.ty&&(n=7);var r=new Ii(e,i,Vt.getShapeProp(this,t,n,this));return this.shapes.push(r),this.addShapeToModifiers(r),this.addToAnimatedContents(t,r),r},qi.prototype.addToAnimatedContents=function(t,e){for(var i=0,n=this.animatedContents.length;i<n;){if(this.animatedContents[i].element===e)return;i+=1}this.animatedContents.push({fn:Xi.createRenderFunction(t),element:e,data:t})},qi.prototype.setElementStyles=function(t){var e,i=t.styles,n=this.stylesList.length;for(e=0;e<n;e+=1)this.stylesList[e].closed||i.push(this.stylesList[e])},qi.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},qi.prototype.searchShapes=function(t,e,i,n,r,s,a){var o,l,h,c,u,d,p=[].concat(s),f=t.length-1,m=[],g=[];for(o=f;o>=0;o-=1){if((d=this.searchProcessedElement(t[o]))?e[o]=i[d-1]:t[o]._render=a,"fl"===t[o].ty||"st"===t[o].ty||"gf"===t[o].ty||"gs"===t[o].ty||"no"===t[o].ty)d?e[o].style.closed=!1:e[o]=this.createStyleElement(t[o],r),t[o]._render&&e[o].style.pElem.parentNode!==n&&n.appendChild(e[o].style.pElem),m.push(e[o].style);else if("gr"===t[o].ty){if(d)for(h=e[o].it.length,l=0;l<h;l+=1)e[o].prevViewData[l]=e[o].it[l];else e[o]=this.createGroupElement(t[o]);this.searchShapes(t[o].it,e[o].it,e[o].prevViewData,e[o].gr,r+1,p,a),t[o]._render&&e[o].gr.parentNode!==n&&n.appendChild(e[o].gr)}else"tr"===t[o].ty?(d||(e[o]=this.createTransformElement(t[o],n)),c=e[o].transform,p.push(c)):"sh"===t[o].ty||"rc"===t[o].ty||"el"===t[o].ty||"sr"===t[o].ty?(d||(e[o]=this.createShapeElement(t[o],p,r)),this.setElementStyles(e[o])):"tm"===t[o].ty||"rd"===t[o].ty||"ms"===t[o].ty||"pb"===t[o].ty||"zz"===t[o].ty||"op"===t[o].ty?(d?(u=e[o]).closed=!1:((u=he.getModifier(t[o].ty)).init(this,t[o]),e[o]=u,this.shapeModifiers.push(u)),g.push(u)):"rp"===t[o].ty&&(d?(u=e[o]).closed=!0:(u=he.getModifier(t[o].ty),e[o]=u,u.init(this,t,o,e),this.shapeModifiers.push(u),a=!1),g.push(u));this.addProcessedElement(t[o],o+1)}for(f=m.length,o=0;o<f;o+=1)m[o].closed=!0;for(f=g.length,o=0;o<f;o+=1)g[o].closed=!0},qi.prototype.renderInnerContent=function(){var t;this.renderModifiers();var e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},qi.prototype.renderShape=function(){var t,e,i=this.animatedContents.length;for(t=0;t<i;t+=1)e=this.animatedContents[t],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},qi.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},Yi.prototype.update=function(t,e,i,n,r,s){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var a=!1;return this.o!==t&&(this.o=t,this._mdf.o=!0,a=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,a=!0),this.sc!==i&&(this.sc=i,this._mdf.sc=!0,a=!0),this.fc!==n&&(this.fc=n,this._mdf.fc=!0,a=!0),this.m!==r&&(this.m=r,this._mdf.m=!0,a=!0),!s.length||this.p[0]===s[0]&&this.p[1]===s[1]&&this.p[4]===s[4]&&this.p[5]===s[5]&&this.p[12]===s[12]&&this.p[13]===s[13]||(this.p=s,this._mdf.p=!0,a=!0),a},ji.prototype.defaultBoxWidth=[0,0],ji.prototype.copyData=function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ji.prototype.setCurrentData=function(t){t.__complete||this.completeTextData(t),this.currentData=t,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},ji.prototype.searchProperty=function(){return this.searchKeyframes()},ji.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},ji.prototype.addEffect=function(t){this.effectsSequence.push(t),this.elem.addDynamicProperty(this)},ji.prototype.getValue=function(t){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||t){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,i=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var n;this.lock=!0,this._mdf=!1;var r=this.effectsSequence.length,s=t||this.data.d.k[this.keysIndex].s;for(n=0;n<r;n+=1)s=i!==this.keysIndex?this.effectsSequence[n](s,s.t):this.effectsSequence[n](this.currentData,s.t);e!==s&&this.setCurrentData(s),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},ji.prototype.getKeyframeValue=function(){for(var t=this.data.d.k,e=this.elem.comp.renderedFrame,i=0,n=t.length;i<=n-1&&!(i===n-1||t[i+1].t>e);)i+=1;return this.keysIndex!==i&&(this.keysIndex=i),this.data.d.k[this.keysIndex].s},ji.prototype.buildFinalText=function(t){for(var e,i,n=[],r=0,s=t.length,a=!1,o=!1,l="";r<s;)a=o,o=!1,e=t.charCodeAt(r),l=t.charAt(r),Ze.isCombinedCharacter(e)?a=!0:e>=55296&&e<=56319?Ze.isRegionalFlag(t,r)?l=t.substr(r,14):(i=t.charCodeAt(r+1))>=56320&&i<=57343&&(Ze.isModifier(e,i)?(l=t.substr(r,2),a=!0):l=Ze.isFlagEmoji(t.substr(r,4))?t.substr(r,4):t.substr(r,2)):e>56319?(i=t.charCodeAt(r+1),Ze.isVariationSelector(e)&&(a=!0)):Ze.isZeroWidthJoiner(e)&&(a=!0,o=!0),a?(n[n.length-1]+=l,a=!1):n.push(l),r+=l.length;return n},ji.prototype.completeTextData=function(t){t.__complete=!0;var e,i,n,r,s,a,o,l=this.elem.globalData.fontManager,h=this.data,c=[],u=0,d=h.m.g,p=0,f=0,m=0,g=[],_=0,v=0,y=l.getFontByName(t.f),x=0,S=je(y);t.fWeight=S.weight,t.fStyle=S.style,t.finalSize=t.s,t.finalText=this.buildFinalText(t.t),i=t.finalText.length,t.finalLineHeight=t.lh;var M,b=t.tr/1e3*t.finalSize;if(t.sz)for(var T,w,E=!0,A=t.sz[0],C=t.sz[1];E;){T=0,_=0,i=(w=this.buildFinalText(t.t)).length,b=t.tr/1e3*t.finalSize;var P=-1;for(e=0;e<i;e+=1)M=w[e].charCodeAt(0),n=!1," "===w[e]?P=e:13!==M&&3!==M||(_=0,n=!0,T+=t.finalLineHeight||1.2*t.finalSize),l.chars?(o=l.getCharData(w[e],y.fStyle,y.fFamily),x=n?0:o.w*t.finalSize/100):x=l.measureText(w[e],t.f,t.finalSize),_+x>A&&" "!==w[e]?(-1===P?i+=1:e=P,T+=t.finalLineHeight||1.2*t.finalSize,w.splice(e,P===e?1:0,"\r"),P=-1,_=0):(_+=x,_+=b);T+=y.ascent*t.finalSize/100,this.canResize&&t.finalSize>this.minimumFontSize&&C<T?(t.finalSize-=1,t.finalLineHeight=t.finalSize*t.lh/t.s):(t.finalText=w,i=t.finalText.length,E=!1)}_=-b,x=0;var L,R=0;for(e=0;e<i;e+=1)if(n=!1,13===(M=(L=t.finalText[e]).charCodeAt(0))||3===M?(R=0,g.push(_),v=_>v?_:v,_=-2*b,r="",n=!0,m+=1):r=L,l.chars?(o=l.getCharData(L,y.fStyle,l.getFontByName(t.f).fFamily),x=n?0:o.w*t.finalSize/100):x=l.measureText(r,t.f,t.finalSize)," "===L?R+=x+b:(_+=x+b+R,R=0),c.push({l:x,an:x,add:p,n,anIndexes:[],val:r,line:m,animatorJustifyOffset:0}),2==d){if(p+=x,""===r||" "===r||e===i-1){for(""!==r&&" "!==r||(p-=x);f<=e;)c[f].an=p,c[f].ind=u,c[f].extra=x,f+=1;u+=1,p=0}}else if(3==d){if(p+=x,""===r||e===i-1){for(""===r&&(p-=x);f<=e;)c[f].an=p,c[f].ind=u,c[f].extra=x,f+=1;p=0,u+=1}}else c[u].ind=u,c[u].extra=0,u+=1;if(t.l=c,v=_>v?_:v,g.push(_),t.sz)t.boxWidth=t.sz[0],t.justifyOffset=0;else switch(t.boxWidth=v,t.j){case 1:t.justifyOffset=-t.boxWidth;break;case 2:t.justifyOffset=-t.boxWidth/2;break;default:t.justifyOffset=0}t.lineWidths=g;var D,I,U,N,O=h.a;a=O.length;var k=[];for(s=0;s<a;s+=1){for((D=O[s]).a.sc&&(t.strokeColorAnim=!0),D.a.sw&&(t.strokeWidthAnim=!0),(D.a.fc||D.a.fh||D.a.fs||D.a.fb)&&(t.fillColorAnim=!0),N=0,U=D.s.b,e=0;e<i;e+=1)(I=c[e]).anIndexes[s]=N,(1==U&&""!==I.val||2==U&&""!==I.val&&" "!==I.val||3==U&&(I.n||" "==I.val||e==i-1)||4==U&&(I.n||e==i-1))&&(1===D.s.rn&&k.push(N),N+=1);h.a[s].s.totalChars=N;var F,z=-1;if(1===D.s.rn)for(e=0;e<i;e+=1)z!=(I=c[e]).anIndexes[s]&&(z=I.anIndexes[s],F=k.splice(Math.floor(Math.random()*k.length),1)[0]),I.anIndexes[s]=F}t.yOffset=t.finalLineHeight||1.2*t.finalSize,t.ls=t.ls||0,t.ascent=y.ascent*t.finalSize/100},ji.prototype.updateDocumentData=function(t,e){e=void 0===e?this.keysIndex:e;var i=this.copyData({},this.data.d.k[e].s);i=this.copyData(i,t),this.data.d.k[e].s=i,this.recalculate(e),this.setCurrentData(i),this.elem.addDynamicProperty(this)},ji.prototype.recalculate=function(t){var e=this.data.d.k[t].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},ji.prototype.canResizeFont=function(t){this.canResize=t,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},ji.prototype.setMinimumFontSize=function(t){this.minimumFontSize=Math.floor(t)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var Zi=function(){var t=Math.max,e=Math.min,i=Math.floor;function n(t,e){this._currentTextLength=-1,this.k=!1,this.data=e,this.elem=t,this.comp=t.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(t),this.s=Ut.getProp(t,e.s||{k:0},0,0,this),this.e="e"in e?Ut.getProp(t,e.e,0,0,this):{v:100},this.o=Ut.getProp(t,e.o||{k:0},0,0,this),this.xe=Ut.getProp(t,e.xe||{k:0},0,0,this),this.ne=Ut.getProp(t,e.ne||{k:0},0,0,this),this.sm=Ut.getProp(t,e.sm||{k:100},0,0,this),this.a=Ut.getProp(t,e.a,0,.01,this),this.dynamicProperties.length||this.getValue()}function r(t,e,i){return new n(t,e,i)}return n.prototype={getMult:function(n){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var r=0,s=0,a=1,o=1;this.ne.v>0?r=this.ne.v/100:s=-this.ne.v/100,this.xe.v>0?a=1-this.xe.v/100:o=1+this.xe.v/100;var l=pt.getBezierEasing(r,s,a,o).get,h=0,c=this.finalS,u=this.finalE,d=this.data.sh;if(2===d)h=l(h=u===c?n>=u?1:0:t(0,e(.5/(u-c)+(n-c)/(u-c),1)));else if(3===d)h=l(h=u===c?n>=u?0:1:1-t(0,e(.5/(u-c)+(n-c)/(u-c),1)));else if(4===d)u===c?h=0:(h=t(0,e(.5/(u-c)+(n-c)/(u-c),1)))<.5?h*=2:h=1-2*(h-.5),h=l(h);else if(5===d){if(u===c)h=0;else{var p=u-c,f=-p/2+(n=e(t(0,n+.5-c),u-c)),m=p/2;h=Math.sqrt(1-f*f/(m*m))}h=l(h)}else 6===d?(u===c?h=0:(n=e(t(0,n+.5-c),u-c),h=(1+Math.cos(Math.PI+2*Math.PI*n/(u-c)))/2),h=l(h)):(n>=i(c)&&(h=t(0,e(n-c<0?e(u,1)-(c-n):u-n,1))),h=l(h));if(100!==this.sm.v){var g=.01*this.sm.v;0===g&&(g=1e-8);var _=.5-.5*g;h<_?h=0:(h=(h-_)/g)>1&&(h=1)}return h*this.a.v},getValue:function(t){this.iterateDynamicProperties(),this._mdf=t||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,t&&2===this.data.r&&(this.e.v=this._currentTextLength);var e=2===this.data.r?1:100/this.data.totalChars,i=this.o.v/e,n=this.s.v/e+i,r=this.e.v/e+i;if(n>r){var s=n;n=r,r=s}this.finalS=n,this.finalE=r}},u([Nt],n),{getTextSelectorProp:r}}();function Ki(t,e,i){var n={propType:!1},r=Ut.getProp,s=e.a;this.a={r:s.r?r(t,s.r,0,C,i):n,rx:s.rx?r(t,s.rx,0,C,i):n,ry:s.ry?r(t,s.ry,0,C,i):n,sk:s.sk?r(t,s.sk,0,C,i):n,sa:s.sa?r(t,s.sa,0,C,i):n,s:s.s?r(t,s.s,1,.01,i):n,a:s.a?r(t,s.a,1,0,i):n,o:s.o?r(t,s.o,0,.01,i):n,p:s.p?r(t,s.p,1,0,i):n,sw:s.sw?r(t,s.sw,0,0,i):n,sc:s.sc?r(t,s.sc,1,0,i):n,fc:s.fc?r(t,s.fc,1,0,i):n,fh:s.fh?r(t,s.fh,0,0,i):n,fs:s.fs?r(t,s.fs,0,.01,i):n,fb:s.fb?r(t,s.fb,0,.01,i):n,t:s.t?r(t,s.t,0,0,i):n},this.s=Zi.getTextSelectorProp(t,e.s,i),this.s.t=e.s.t}function Ji(t,e,i){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=t,this._renderType=e,this._elem=i,this._animatorsData=m(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(i)}function $i(){}Ji.prototype.searchProperties=function(){var t,e,i=this._textData.a.length,n=Ut.getProp;for(t=0;t<i;t+=1)e=this._textData.a[t],this._animatorsData[t]=new Ki(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:n(this._elem,this._textData.p.a,0,0,this),f:n(this._elem,this._textData.p.f,0,0,this),l:n(this._elem,this._textData.p.l,0,0,this),r:n(this._elem,this._textData.p.r,0,0,this),p:n(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=n(this._elem,this._textData.m.a,1,0,this)},Ji.prototype.getMeasures=function(t,e){if(this.lettersChangedFlag=e,this._mdf||this._isFirstFrame||e||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var i,n,r,s,a,o,l,h,c,u,d,p,f,m,g,_,v,y,x,S=this._moreOptions.alignment.v,M=this._animatorsData,b=this._textData,T=this.mHelper,w=this._renderType,E=this.renderedLetters.length,A=t.l;if(this._hasMaskedPath){if(x=this._pathData.m,!this._pathData.n||this._pathData._mdf){var C,P=x.v;for(this._pathData.r.v&&(P=P.reverse()),a={tLength:0,segments:[]},s=P._length-1,_=0,r=0;r<s;r+=1)C=yt.buildBezierData(P.v[r],P.v[r+1],[P.o[r][0]-P.v[r][0],P.o[r][1]-P.v[r][1]],[P.i[r+1][0]-P.v[r+1][0],P.i[r+1][1]-P.v[r+1][1]]),a.tLength+=C.segmentLength,a.segments.push(C),_+=C.segmentLength;r=s,x.v.c&&(C=yt.buildBezierData(P.v[r],P.v[0],[P.o[r][0]-P.v[r][0],P.o[r][1]-P.v[r][1]],[P.i[0][0]-P.v[0][0],P.i[0][1]-P.v[0][1]]),a.tLength+=C.segmentLength,a.segments.push(C),_+=C.segmentLength),this._pathData.pi=a}if(a=this._pathData.pi,o=this._pathData.f.v,d=0,u=1,h=0,c=!0,m=a.segments,o<0&&x.v.c)for(a.tLength<Math.abs(o)&&(o=-Math.abs(o)%a.tLength),u=(f=m[d=m.length-1].points).length-1;o<0;)o+=f[u].partialLength,(u-=1)<0&&(u=(f=m[d-=1].points).length-1);p=(f=m[d].points)[u-1],g=(l=f[u]).partialLength}s=A.length,i=0,n=0;var L,R,D,I,U,N=1.2*t.finalSize*.714,O=!0;D=M.length;var k,F,z,B,V,X,q,Y,j,Z,K,J,$=-1,Q=o,tt=d,et=u,it=-1,nt="",rt=this.defaultPropsArray;if(2===t.j||1===t.j){var st=0,at=0,ot=2===t.j?-.5:-1,lt=0,ht=!0;for(r=0;r<s;r+=1)if(A[r].n){for(st&&(st+=at);lt<r;)A[lt].animatorJustifyOffset=st,lt+=1;st=0,ht=!0}else{for(R=0;R<D;R+=1)(L=M[R].a).t.propType&&(ht&&2===t.j&&(at+=L.t.v*ot),(U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars)).length?st+=L.t.v*U[0]*ot:st+=L.t.v*U*ot);ht=!1}for(st&&(st+=at);lt<r;)A[lt].animatorJustifyOffset=st,lt+=1}for(r=0;r<s;r+=1){if(T.reset(),B=1,A[r].n)i=0,n+=t.yOffset,n+=O?1:0,o=Q,O=!1,this._hasMaskedPath&&(u=et,p=(f=m[d=tt].points)[u-1],g=(l=f[u]).partialLength,h=0),nt="",K="",j="",J="",rt=this.defaultPropsArray;else{if(this._hasMaskedPath){if(it!==A[r].line){switch(t.j){case 1:o+=_-t.lineWidths[A[r].line];break;case 2:o+=(_-t.lineWidths[A[r].line])/2}it=A[r].line}$!==A[r].ind&&(A[$]&&(o+=A[$].extra),o+=A[r].an/2,$=A[r].ind),o+=S[0]*A[r].an*.005;var ct=0;for(R=0;R<D;R+=1)(L=M[R].a).p.propType&&((U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars)).length?ct+=L.p.v[0]*U[0]:ct+=L.p.v[0]*U),L.a.propType&&((U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars)).length?ct+=L.a.v[0]*U[0]:ct+=L.a.v[0]*U);for(c=!0,this._pathData.a.v&&(o=.5*A[0].an+(_-this._pathData.f.v-.5*A[0].an-.5*A[A.length-1].an)*$/(s-1),o+=this._pathData.f.v);c;)h+g>=o+ct||!f?(v=(o+ct-h)/l.partialLength,F=p.point[0]+(l.point[0]-p.point[0])*v,z=p.point[1]+(l.point[1]-p.point[1])*v,T.translate(-S[0]*A[r].an*.005,-S[1]*N*.01),c=!1):f&&(h+=l.partialLength,(u+=1)>=f.length&&(u=0,m[d+=1]?f=m[d].points:x.v.c?(u=0,f=m[d=0].points):(h-=l.partialLength,f=null)),f&&(p=l,g=(l=f[u]).partialLength));k=A[r].an/2-A[r].add,T.translate(-k,0,0)}else k=A[r].an/2-A[r].add,T.translate(-k,0,0),T.translate(-S[0]*A[r].an*.005,-S[1]*N*.01,0);for(R=0;R<D;R+=1)(L=M[R].a).t.propType&&(U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars),0===i&&0===t.j||(this._hasMaskedPath?U.length?o+=L.t.v*U[0]:o+=L.t.v*U:U.length?i+=L.t.v*U[0]:i+=L.t.v*U));for(t.strokeWidthAnim&&(X=t.sw||0),t.strokeColorAnim&&(V=t.sc?[t.sc[0],t.sc[1],t.sc[2]]:[0,0,0]),t.fillColorAnim&&t.fc&&(q=[t.fc[0],t.fc[1],t.fc[2]]),R=0;R<D;R+=1)(L=M[R].a).a.propType&&((U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars)).length?T.translate(-L.a.v[0]*U[0],-L.a.v[1]*U[1],L.a.v[2]*U[2]):T.translate(-L.a.v[0]*U,-L.a.v[1]*U,L.a.v[2]*U));for(R=0;R<D;R+=1)(L=M[R].a).s.propType&&((U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars)).length?T.scale(1+(L.s.v[0]-1)*U[0],1+(L.s.v[1]-1)*U[1],1):T.scale(1+(L.s.v[0]-1)*U,1+(L.s.v[1]-1)*U,1));for(R=0;R<D;R+=1){if(L=M[R].a,U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars),L.sk.propType&&(U.length?T.skewFromAxis(-L.sk.v*U[0],L.sa.v*U[1]):T.skewFromAxis(-L.sk.v*U,L.sa.v*U)),L.r.propType&&(U.length?T.rotateZ(-L.r.v*U[2]):T.rotateZ(-L.r.v*U)),L.ry.propType&&(U.length?T.rotateY(L.ry.v*U[1]):T.rotateY(L.ry.v*U)),L.rx.propType&&(U.length?T.rotateX(L.rx.v*U[0]):T.rotateX(L.rx.v*U)),L.o.propType&&(U.length?B+=(L.o.v*U[0]-B)*U[0]:B+=(L.o.v*U-B)*U),t.strokeWidthAnim&&L.sw.propType&&(U.length?X+=L.sw.v*U[0]:X+=L.sw.v*U),t.strokeColorAnim&&L.sc.propType)for(Y=0;Y<3;Y+=1)U.length?V[Y]+=(L.sc.v[Y]-V[Y])*U[0]:V[Y]+=(L.sc.v[Y]-V[Y])*U;if(t.fillColorAnim&&t.fc){if(L.fc.propType)for(Y=0;Y<3;Y+=1)U.length?q[Y]+=(L.fc.v[Y]-q[Y])*U[0]:q[Y]+=(L.fc.v[Y]-q[Y])*U;L.fh.propType&&(q=U.length?W(q,L.fh.v*U[0]):W(q,L.fh.v*U)),L.fs.propType&&(q=U.length?H(q,L.fs.v*U[0]):H(q,L.fs.v*U)),L.fb.propType&&(q=U.length?G(q,L.fb.v*U[0]):G(q,L.fb.v*U))}}for(R=0;R<D;R+=1)(L=M[R].a).p.propType&&(U=M[R].s.getMult(A[r].anIndexes[R],b.a[R].s.totalChars),this._hasMaskedPath?U.length?T.translate(0,L.p.v[1]*U[0],-L.p.v[2]*U[1]):T.translate(0,L.p.v[1]*U,-L.p.v[2]*U):U.length?T.translate(L.p.v[0]*U[0],L.p.v[1]*U[1],-L.p.v[2]*U[2]):T.translate(L.p.v[0]*U,L.p.v[1]*U,-L.p.v[2]*U));if(t.strokeWidthAnim&&(j=X<0?0:X),t.strokeColorAnim&&(Z="rgb("+Math.round(255*V[0])+","+Math.round(255*V[1])+","+Math.round(255*V[2])+")"),t.fillColorAnim&&t.fc&&(K="rgb("+Math.round(255*q[0])+","+Math.round(255*q[1])+","+Math.round(255*q[2])+")"),this._hasMaskedPath){if(T.translate(0,-t.ls),T.translate(0,S[1]*N*.01+n,0),this._pathData.p.v){y=(l.point[1]-p.point[1])/(l.point[0]-p.point[0]);var ut=180*Math.atan(y)/Math.PI;l.point[0]<p.point[0]&&(ut+=180),T.rotate(-ut*Math.PI/180)}T.translate(F,z,0),o-=S[0]*A[r].an*.005,A[r+1]&&$!==A[r+1].ind&&(o+=A[r].an/2,o+=.001*t.tr*t.finalSize)}else{switch(T.translate(i,n,0),t.ps&&T.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:T.translate(A[r].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[A[r].line]),0,0);break;case 2:T.translate(A[r].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[A[r].line])/2,0,0)}T.translate(0,-t.ls),T.translate(k,0,0),T.translate(S[0]*A[r].an*.005,S[1]*N*.01,0),i+=A[r].l+.001*t.tr*t.finalSize}"html"===w?nt=T.toCSS():"svg"===w?nt=T.to2dCSS():rt=[T.props[0],T.props[1],T.props[2],T.props[3],T.props[4],T.props[5],T.props[6],T.props[7],T.props[8],T.props[9],T.props[10],T.props[11],T.props[12],T.props[13],T.props[14],T.props[15]],J=B}E<=r?(I=new Yi(J,j,Z,K,nt,rt),this.renderedLetters.push(I),E+=1,this.lettersChangedFlag=!0):(I=this.renderedLetters[r],this.lettersChangedFlag=I.update(J,j,Z,K,nt,rt)||this.lettersChangedFlag)}}},Ji.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},Ji.prototype.mHelper=new Ht,Ji.prototype.defaultPropsArray=[],u([Nt],Ji),$i.prototype.initElement=function(t,e,i){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(t,e,i),this.textProperty=new ji(this,t.t,this.dynamicProperties),this.textAnimator=new Ji(t.t,this.renderType,this),this.initTransform(t,e,i),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},$i.prototype.prepareFrame=function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)},$i.prototype.createPathShape=function(t,e){var i,n,r=e.length,s="";for(i=0;i<r;i+=1)"sh"===e[i].ty&&(n=e[i].ks.k,s+=Wi(n,n.i.length,!0,t));return s},$i.prototype.updateDocumentData=function(t,e){this.textProperty.updateDocumentData(t,e)},$i.prototype.canResizeFont=function(t){this.textProperty.canResizeFont(t)},$i.prototype.setMinimumFontSize=function(t){this.textProperty.setMinimumFontSize(t)},$i.prototype.applyTextPropertiesToMatrix=function(t,e,i,n,r){switch(t.ps&&e.translate(t.ps[0],t.ps[1]+t.ascent,0),e.translate(0,-t.ls,0),t.j){case 1:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[i]),0,0);break;case 2:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[i])/2,0,0)}e.translate(n,r,0)},$i.prototype.buildColor=function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},$i.prototype.emptyProp=new Yi,$i.prototype.destroy=function(){},$i.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var Qi={shapes:[]};function tn(t,e,i){this.textSpans=[],this.renderType="svg",this.initElement(t,e,i)}function en(t,e,i){this.initElement(t,e,i)}function nn(t,e,i){this.initFrame(),this.initBaseData(t,e,i),this.initFrame(),this.initTransform(t,e,i),this.initHierarchy()}function rn(){}function sn(){}function an(t,e,i){this.layers=t.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?m(this.layers.length):[],this.initElement(t,e,i),this.tm=t.tm?Ut.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function on(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.svgElement=Q("svg");var i="";if(e&&e.title){var n=Q("title"),r=z();n.setAttribute("id",r),n.textContent=e.title,this.svgElement.appendChild(n),i+=r}if(e&&e.description){var s=Q("desc"),a=z();s.setAttribute("id",a),s.textContent=e.description,this.svgElement.appendChild(s),i+=" "+a}i&&this.svgElement.setAttribute("aria-labelledby",i);var o=Q("defs");this.svgElement.appendChild(o);var l=Q("g");this.svgElement.appendChild(l),this.layerElement=l,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&!1===e.hideOnTransparent),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"},width:e&&e.width,height:e&&e.height,runExpressions:!e||void 0===e.runExpressions||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:o,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}return u([ui,_i,wi,Ei,di,Ai,$i],tn),tn.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=Q("text"))},tn.prototype.buildTextContents=function(t){for(var e=0,i=t.length,n=[],r="";e<i;)t[e]===String.fromCharCode(13)||t[e]===String.fromCharCode(3)?(n.push(r),r=""):r+=t[e],e+=1;return n.push(r),n},tn.prototype.buildShapeData=function(t,e){if(t.shapes&&t.shapes.length){var i=t.shapes[0];if(i.it){var n=i.it[i.it.length-1];n.s&&(n.s.k[0]=e,n.s.k[1]=e)}}return t},tn.prototype.buildNewText=function(){var t,e;this.addDynamicProperty(this);var i=this.textProperty.currentData;this.renderedLetters=m(i?i.l.length:0),i.fc?this.layerElement.setAttribute("fill",this.buildColor(i.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),i.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(i.sc)),this.layerElement.setAttribute("stroke-width",i.sw)),this.layerElement.setAttribute("font-size",i.finalSize);var n=this.globalData.fontManager.getFontByName(i.f);if(n.fClass)this.layerElement.setAttribute("class",n.fClass);else{this.layerElement.setAttribute("font-family",n.fFamily);var r=i.fWeight,s=i.fStyle;this.layerElement.setAttribute("font-style",s),this.layerElement.setAttribute("font-weight",r)}this.layerElement.setAttribute("aria-label",i.t);var a,o=i.l||[],l=!!this.globalData.fontManager.chars;e=o.length;var h=this.mHelper,c="",u=this.data.singleShape,d=0,p=0,f=!0,g=.001*i.tr*i.finalSize;if(!u||l||i.sz){var _,v=this.textSpans.length;for(t=0;t<e;t+=1){if(this.textSpans[t]||(this.textSpans[t]={span:null,childSpan:null,glyph:null}),!l||!u||0===t){if(a=v>t?this.textSpans[t].span:Q(l?"g":"text"),v<=t){if(a.setAttribute("stroke-linecap","butt"),a.setAttribute("stroke-linejoin","round"),a.setAttribute("stroke-miterlimit","4"),this.textSpans[t].span=a,l){var y=Q("g");a.appendChild(y),this.textSpans[t].childSpan=y}this.textSpans[t].span=a,this.layerElement.appendChild(a)}a.style.display="inherit"}if(h.reset(),u&&(o[t].n&&(d=-g,p+=i.yOffset,p+=f?1:0,f=!1),this.applyTextPropertiesToMatrix(i,h,o[t].line,d,p),d+=o[t].l||0,d+=g),l){var x;if(1===(_=this.globalData.fontManager.getCharData(i.finalText[t],n.fStyle,this.globalData.fontManager.getFontByName(i.f).fFamily)).t)x=new an(_.data,this.globalData,this);else{var S=Qi;_.data&&_.data.shapes&&(S=this.buildShapeData(_.data,i.finalSize)),x=new qi(S,this.globalData,this)}if(this.textSpans[t].glyph){var M=this.textSpans[t].glyph;this.textSpans[t].childSpan.removeChild(M.layerElement),M.destroy()}this.textSpans[t].glyph=x,x._debug=!0,x.prepareFrame(0),x.renderFrame(),this.textSpans[t].childSpan.appendChild(x.layerElement),1===_.t&&this.textSpans[t].childSpan.setAttribute("transform","scale("+i.finalSize/100+","+i.finalSize/100+")")}else u&&a.setAttribute("transform","translate("+h.props[12]+","+h.props[13]+")"),a.textContent=o[t].val,a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}u&&a&&a.setAttribute("d",c)}else{var b=this.textContainer,T="start";switch(i.j){case 1:T="end";break;case 2:T="middle";break;default:T="start"}b.setAttribute("text-anchor",T),b.setAttribute("letter-spacing",g);var w=this.buildTextContents(i.finalText);for(e=w.length,p=i.ps?i.ps[1]+i.ascent:0,t=0;t<e;t+=1)(a=this.textSpans[t].span||Q("tspan")).textContent=w[t],a.setAttribute("x",0),a.setAttribute("y",p),a.style.display="inherit",b.appendChild(a),this.textSpans[t]||(this.textSpans[t]={span:null,glyph:null}),this.textSpans[t].span=a,p+=i.finalLineHeight;this.layerElement.appendChild(b)}for(;t<this.textSpans.length;)this.textSpans[t].span.style.display="none",t+=1;this._sizeChanged=!0},tn.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},tn.prototype.getValue=function(){var t,e,i=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,t=0;t<i;t+=1)(e=this.textSpans[t].glyph)&&(e.prepareFrame(this.comp.renderedFrame-this.data.st),e._mdf&&(this._mdf=!0))},tn.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var t,e;this._sizeChanged=!0;var i,n,r,s=this.textAnimator.renderedLetters,a=this.textProperty.currentData.l;for(e=a.length,t=0;t<e;t+=1)a[t].n||(i=s[t],n=this.textSpans[t].span,(r=this.textSpans[t].glyph)&&r.renderFrame(),i._mdf.m&&n.setAttribute("transform",i.m),i._mdf.o&&n.setAttribute("opacity",i.o),i._mdf.sw&&n.setAttribute("stroke-width",i.sw),i._mdf.sc&&n.setAttribute("stroke",i.sc),i._mdf.fc&&n.setAttribute("fill",i.fc))}},u([Ci],en),en.prototype.createContent=function(){var t=Q("rect");t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.layerElement.appendChild(t)},nn.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},nn.prototype.renderFrame=function(){},nn.prototype.getBaseElement=function(){return null},nn.prototype.destroy=function(){},nn.prototype.sourceRectAtTime=function(){},nn.prototype.hide=function(){},u([ui,_i,Ei,di],nn),u([mi],rn),rn.prototype.createNull=function(t){return new nn(t,this.globalData,this)},rn.prototype.createShape=function(t){return new qi(t,this.globalData,this)},rn.prototype.createText=function(t){return new tn(t,this.globalData,this)},rn.prototype.createImage=function(t){return new Ci(t,this.globalData,this)},rn.prototype.createSolid=function(t){return new en(t,this.globalData,this)},rn.prototype.configAnimation=function(t){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+t.w+" "+t.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",t.w),this.svgElement.setAttribute("height",t.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(t,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=t;var i=Q("clipPath"),n=Q("rect");n.setAttribute("width",t.w),n.setAttribute("height",t.h),n.setAttribute("x",0),n.setAttribute("y",0);var r=z();i.setAttribute("id",r),i.appendChild(n),this.layerElement.setAttribute("clip-path","url("+h()+"#"+r+")"),e.appendChild(i),this.layers=t.layers,this.elements=m(t.layers.length)},rn.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},rn.prototype.updateContainerSize=function(){},rn.prototype.findIndexByInd=function(t){var e=0,i=this.layers.length;for(e=0;e<i;e+=1)if(this.layers[e].ind===t)return e;return-1},rn.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){e[t]=!0;var i=this.createItem(this.layers[t]);if(e[t]=i,j()&&(0===this.layers[t].ty&&this.globalData.projectInterface.registerComposition(i),i.initExpressions()),this.appendElementInPos(i,t),this.layers[t].tt){var n="tp"in this.layers[t]?this.findIndexByInd(this.layers[t].tp):t-1;if(-1===n)return;if(this.elements[n]&&!0!==this.elements[n]){var r=e[n].getMatte(this.layers[t].tt);i.setMatte(r)}else this.buildItem(n),this.addPendingElement(i)}}},rn.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();if(t.checkParenting(),t.data.tt)for(var e=0,i=this.elements.length;e<i;){if(this.elements[e]===t){var n="tp"in t.data?this.findIndexByInd(t.data.tp):e-1,r=this.elements[n].getMatte(this.layers[e].tt);t.setMatte(r);break}e+=1}}},rn.prototype.renderFrame=function(t){if(this.renderedFrame!==t&&!this.destroyed){var e;null===t?t=this.renderedFrame:this.renderedFrame=t,this.globalData.frameNum=t,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=t,this.globalData._mdf=!1;var i=this.layers.length;for(this.completeLayers||this.checkLayers(t),e=i-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(t-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<i;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},rn.prototype.appendElementInPos=function(t,e){var i=t.getBaseElement();if(i){for(var n,r=0;r<e;)this.elements[r]&&!0!==this.elements[r]&&this.elements[r].getBaseElement()&&(n=this.elements[r].getBaseElement()),r+=1;n?this.layerElement.insertBefore(i,n):this.layerElement.appendChild(i)}},rn.prototype.hide=function(){this.layerElement.style.display="none"},rn.prototype.show=function(){this.layerElement.style.display="block"},u([ui,_i,Ei,di,Ai],sn),sn.prototype.initElement=function(t,e,i){this.initFrame(),this.initBaseData(t,e,i),this.initTransform(t,e,i),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&e.progressiveLoad||this.buildAllItems(),this.hide()},sn.prototype.prepareFrame=function(t){if(this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=t/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var i,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),i=n-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&(this.elements[i].prepareFrame(this.renderedFrame-this.layers[i].st),this.elements[i]._mdf&&(this._mdf=!0))}},sn.prototype.renderInnerContent=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},sn.prototype.setElements=function(t){this.elements=t},sn.prototype.getElements=function(){return this.elements},sn.prototype.destroyElements=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},sn.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},u([rn,sn,wi],an),an.prototype.createComp=function(t){return new an(t,this.globalData,this)},u([rn],on),on.prototype.createComp=function(t){return new an(t,this.globalData,this)},ot("svg",on),he.registerModifier("tm",ue),he.registerModifier("pb",de),he.registerModifier("rp",fe),he.registerModifier("rd",me),he.registerModifier("zz",Ue),he.registerModifier("op",Ye),Wt}())}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.amdO={},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";class t{static getScrollbarWidthIfPresent(){return window.innerWidth-document.documentElement.clientWidth}static getScrollBarWidth(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var i=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return i==n&&(n=e.clientWidth),document.body.removeChild(e),i-n}constructor(){window.addEventListener("resize",this.calculateScrollbarWidth,!1),document.addEventListener("DOMContentLoaded",this.calculateScrollbarWidth,!1),window.addEventListener("load",this.calculateScrollbarWidth),this.calculateScrollbarWidth()}calculateScrollbarWidth(){document.documentElement.style.setProperty("--scrollbar-width",t.getScrollBarWidth()+"px")}}function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}
/*!
 * GSAP 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var r,s,a,o,l,h,c,u,d,p,f,m,g,_,v,y={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},x={duration:.5,overwrite:!1,delay:0},S=1e8,M=1e-8,b=2*Math.PI,T=b/4,w=0,E=Math.sqrt,A=Math.cos,C=Math.sin,P=function(t){return"string"==typeof t},L=function(t){return"function"==typeof t},R=function(t){return"number"==typeof t},D=function(t){return void 0===t},I=function(t){return"object"==typeof t},U=function(t){return!1!==t},N=function(){return"undefined"!=typeof window},O=function(t){return L(t)||P(t)},k="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},F=Array.isArray,z=/(?:-?\.?\d|\.)+/gi,B=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,V=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,H=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,G=/[+-]=-?[.\d]+/,W=/[^,'"\[\]\s]+/gi,X=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,q={},Y={},j=function(t){return(Y=Mt(t,q))&&bi},Z=function(t,e){return!e&&void 0},K=function(t,e){return t&&(q[t]=e)&&Y&&(Y[t]=e)||q},J=function(){return 0},$={suppressEvents:!0,isStart:!0,kill:!1},Q={suppressEvents:!0,kill:!1},tt={suppressEvents:!0},et={},it=[],nt={},rt={},st={},at=30,ot=[],lt="",ht=function(t){var e,i,n=t[0];if(I(n)||L(n)||(t=[t]),!(e=(n._gsap||{}).harness)){for(i=ot.length;i--&&!ot[i].targetTest(n););e=ot[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new ke(t[i],e)))||t.splice(i,1);return t},ct=function(t){return t._gsap||ht(te(t))[0]._gsap},ut=function(t,e,i){return(i=t[e])&&L(i)?t[e]():D(i)&&t.getAttribute&&t.getAttribute(e)||i},dt=function(t,e){return(t=t.split(",")).forEach(e)||t},pt=function(t){return Math.round(1e5*t)/1e5||0},ft=function(t){return Math.round(1e7*t)/1e7||0},mt=function(t,e){var i=e.charAt(0),n=parseFloat(e.substr(2));return t=parseFloat(t),"+"===i?t+n:"-"===i?t-n:"*"===i?t*n:t/n},gt=function(t,e){for(var i=e.length,n=0;t.indexOf(e[n])<0&&++n<i;);return n<i},_t=function(){var t,e,i=it.length,n=it.slice(0);for(nt={},it.length=0,t=0;t<i;t++)(e=n[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},vt=function(t,e,i,n){it.length&&!s&&_t(),t.render(e,i,n||s&&e<0&&(t._initted||t._startAt)),it.length&&!s&&_t()},yt=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(W).length<2?e:P(t)?t.trim():t},xt=function(t){return t},St=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},Mt=function(t,e){for(var i in e)t[i]=e[i];return t},bt=function t(e,i){for(var n in i)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=I(i[n])?t(e[n]||(e[n]={}),i[n]):i[n]);return e},Tt=function(t,e){var i,n={};for(i in t)i in e||(n[i]=t[i]);return n},wt=function(t){var e,i=t.parent||o,n=t.keyframes?(e=F(t.keyframes),function(t,i){for(var n in i)n in t||"duration"===n&&e||"ease"===n||(t[n]=i[n])}):St;if(U(t.inherit))for(;i;)n(t,i.vars.defaults),i=i.parent||i._dp;return t},Et=function(t,e,i,n,r){void 0===i&&(i="_first"),void 0===n&&(n="_last");var s,a=t[n];if(r)for(s=e[r];a&&a[r]>s;)a=a._prev;return a?(e._next=a._next,a._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[n]=e,e._prev=a,e.parent=e._dp=t,e},At=function(t,e,i,n){void 0===i&&(i="_first"),void 0===n&&(n="_last");var r=e._prev,s=e._next;r?r._next=s:t[i]===e&&(t[i]=s),s?s._prev=r:t[n]===e&&(t[n]=r),e._next=e._prev=e.parent=null},Ct=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Pt=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},Lt=function(t,e,i,n){return t._startAt&&(s?t._startAt.revert(Q):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,n))},Rt=function t(e){return!e||e._ts&&t(e.parent)},Dt=function(t){return t._repeat?It(t._tTime,t=t.duration()+t._rDelay)*t:0},It=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},Ut=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Nt=function(t){return t._end=ft(t._start+(t._tDur/Math.abs(t._ts||t._rts||M)||0))},Ot=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=ft(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Nt(t),i._dirty||Pt(i,t)),t},kt=function(t,e){var i;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(i=Ut(t.rawTime(),e),(!e._dur||Zt(0,e.totalDuration(),i)-e._tTime>M)&&e.render(i,!0)),Pt(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-1e-8}},Ft=function(t,e,i,n){return e.parent&&Ct(e),e._start=ft((R(i)?i:i||t!==o?qt(t,i,e):t._time)+e._delay),e._end=ft(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Et(t,e,"_first","_last",t._sort?"_start":0),Ht(e)||(t._recent=e),n||kt(t,e),t._ts<0&&Ot(t,t._tTime),t},zt=function(t,e){return q.ScrollTrigger?q.ScrollTrigger.create(e,t):void 0},Bt=function(t,e,i,n,r){return Xe(t,e,r),t._initted?!i&&t._pt&&!s&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&d!==Te.frame?(it.push(t),t._lazy=[r,n],1):void 0:1},Vt=function t(e){var i=e.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||t(i))},Ht=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},Gt=function(t,e,i,n){var r=t._repeat,s=ft(e)||0,a=t._tTime/t._tDur;return a&&!n&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:ft(s*(r+1)+t._rDelay*r):s,a>0&&!n&&Ot(t,t._tTime=t._tDur*a),t.parent&&Nt(t),i||Pt(t.parent,t),t},Wt=function(t){return t instanceof ze?Pt(t):Gt(t,t._dur)},Xt={_start:0,endTime:J,totalDuration:J},qt=function t(e,i,n){var r,s,a,o=e.labels,l=e._recent||Xt,h=e.duration()>=S?l.endTime(!1):e._dur;return P(i)&&(isNaN(i)||i in o)?(s=i.charAt(0),a="%"===i.substr(-1),r=i.indexOf("="),"<"===s||">"===s?(r>=0&&(i=i.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(i.substr(1))||0)*(a?(r<0?l:n).totalDuration()/100:1)):r<0?(i in o||(o[i]=h),o[i]):(s=parseFloat(i.charAt(r-1)+i.substr(r+1)),a&&n&&(s=s/100*(F(n)?n[0]:n).totalDuration()),r>1?t(e,i.substr(0,r-1),n)+s:h+s)):null==i?h:+i},Yt=function(t,e,i){var n,r,s=R(e[1]),a=(s?2:1)+(t<2?0:1),o=e[a];if(s&&(o.duration=e[1]),o.parent=i,t){for(n=o,r=i;r&&!("immediateRender"in n);)n=r.vars.defaults||{},r=U(r.vars.inherit)&&r.parent;o.immediateRender=U(n.immediateRender),t<2?o.runBackwards=1:o.startAt=e[a-1]}return new Ke(e[0],o,e[a+1])},jt=function(t,e){return t||0===t?e(t):e},Zt=function(t,e,i){return i<t?t:i>e?e:i},Kt=function(t,e){return P(t)&&(e=X.exec(t))?e[1]:""},Jt=[].slice,$t=function(t,e){return t&&I(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&I(t[0]))&&!t.nodeType&&t!==l},Qt=function(t,e,i){return void 0===i&&(i=[]),t.forEach((function(t){var n;return P(t)&&!e||$t(t,1)?(n=i).push.apply(n,te(t)):i.push(t)}))||i},te=function(t,e,i){return a&&!e&&a.selector?a.selector(t):!P(t)||i||!h&&we()?F(t)?Qt(t,i):$t(t)?Jt.call(t,0):t?[t]:[]:Jt.call((e||c).querySelectorAll(t),0)},ee=function(t){return t=te(t)[0]||Z()||{},function(e){var i=t.current||t.nativeElement||t;return te(e,i.querySelectorAll?i:i===t?Z()||c.createElement("div"):t)}},ie=function(t){return t.sort((function(){return.5-Math.random()}))},ne=function(t){if(L(t))return t;var e=I(t)?t:{each:t},i=De(e.ease),n=e.from||0,r=parseFloat(e.base)||0,s={},a=n>0&&n<1,o=isNaN(n)||a,l=e.axis,h=n,c=n;return P(n)?h=c={center:.5,edges:.5,end:1}[n]||0:!a&&o&&(h=n[0],c=n[1]),function(t,a,u){var d,p,f,m,g,_,v,y,x,M=(u||e).length,b=s[M];if(!b){if(!(x="auto"===e.grid?0:(e.grid||[1,S])[1])){for(v=-S;v<(v=u[x++].getBoundingClientRect().left)&&x<M;);x--}for(b=s[M]=[],d=o?Math.min(x,M)*h-.5:n%x,p=x===S?0:o?M*c/x-.5:n/x|0,v=0,y=S,_=0;_<M;_++)f=_%x-d,m=p-(_/x|0),b[_]=g=l?Math.abs("y"===l?m:f):E(f*f+m*m),g>v&&(v=g),g<y&&(y=g);"random"===n&&ie(b),b.max=v-y,b.min=y,b.v=M=(parseFloat(e.amount)||parseFloat(e.each)*(x>M?M-1:l?"y"===l?M/x:x:Math.max(x,M/x))||0)*("edges"===n?-1:1),b.b=M<0?r-M:r,b.u=Kt(e.amount||e.each)||0,i=i&&M<0?Le(i):i}return M=(b[t]-b.min)/b.max||0,ft(b.b+(i?i(M):M)*b.v)+b.u}},re=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var n=ft(Math.round(parseFloat(i)/t)*t*e);return(n-n%1)/e+(R(i)?0:Kt(i))}},se=function(t,e){var i,n,r=F(t);return!r&&I(t)&&(i=r=t.radius||S,t.values?(t=te(t.values),(n=!R(t[0]))&&(i*=i)):t=re(t.increment)),jt(e,r?L(t)?function(e){return n=t(e),Math.abs(n-e)<=i?n:e}:function(e){for(var r,s,a=parseFloat(n?e.x:e),o=parseFloat(n?e.y:0),l=S,h=0,c=t.length;c--;)(r=n?(r=t[c].x-a)*r+(s=t[c].y-o)*s:Math.abs(t[c]-a))<l&&(l=r,h=c);return h=!i||l<=i?t[h]:e,n||h===e||R(e)?h:h+Kt(e)}:re(t))},ae=function(t,e,i,n){return jt(F(t)?!e:!0===i?!!(i=0):!n,(function(){return F(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+.99*i))/i)*i*n)/n}))},oe=function(t,e,i){return jt(i,(function(i){return t[~~e(i)]}))},le=function(t){for(var e,i,n,r,s=0,a="";~(e=t.indexOf("random(",s));)n=t.indexOf(")",e),r="["===t.charAt(e+7),i=t.substr(e+7,n-e-7).match(r?W:z),a+=t.substr(s,e-s)+ae(r?i:+i[0],r?0:+i[1],+i[2]||1e-5),s=n+1;return a+t.substr(s,t.length-s)},he=function(t,e,i,n,r){var s=e-t,a=n-i;return jt(r,(function(e){return i+((e-t)/s*a||0)}))},ce=function(t,e,i){var n,r,s,a=t.labels,o=S;for(n in a)(r=a[n]-e)<0==!!i&&r&&o>(r=Math.abs(r))&&(s=n,o=r);return s},ue=function(t,e,i){var n,r,s,o=t.vars,l=o[e],h=a,c=t._ctx;if(l)return n=o[e+"Params"],r=o.callbackScope||t,i&&it.length&&_t(),c&&(a=c),s=n?l.apply(r,n):l.call(r),a=h,s},de=function(t){return Ct(t),t.scrollTrigger&&t.scrollTrigger.kill(!!s),t.progress()<1&&ue(t,"onInterrupt"),t},pe=[],fe=function(t){if(N()&&t){var e=(t=!t.name&&t.default||t).name,i=L(t),n=e&&!i&&t.init?function(){this._props=[]}:t,r={init:J,render:si,add:Ge,kill:oi,modifier:ai,rawVars:0},s={targetTest:0,get:0,getSetter:ei,aliases:{},register:0};if(we(),t!==n){if(rt[e])return;St(n,St(Tt(t,r),s)),Mt(n.prototype,Mt(r,Tt(t,s))),rt[n.prop=e]=n,t.targetTest&&(ot.push(n),et[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}K(e,n),t.register&&t.register(bi,n,ci)}else t&&pe.push(t)},me=255,ge={aqua:[0,me,me],lime:[0,me,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,me],navy:[0,0,128],white:[me,me,me],olive:[128,128,0],yellow:[me,me,0],orange:[me,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[me,0,0],pink:[me,192,203],cyan:[0,me,me],transparent:[me,me,me,0]},_e=function(t,e,i){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(i-e)*t*6:t<.5?i:3*t<2?e+(i-e)*(2/3-t)*6:e)*me+.5|0},ve=function(t,e,i){var n,r,s,a,o,l,h,c,u,d,p=t?R(t)?[t>>16,t>>8&me,t&me]:0:ge.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),ge[t])p=ge[t];else if("#"===t.charAt(0)){if(t.length<6&&(n=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+n+n+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&me,p&me,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&me,t&me]}else if("hsl"===t.substr(0,3))if(p=d=t.match(z),e){if(~t.indexOf("="))return p=t.match(B),i&&p.length<4&&(p[3]=1),p}else a=+p[0]%360/360,o=+p[1]/100,n=2*(l=+p[2]/100)-(r=l<=.5?l*(o+1):l+o-l*o),p.length>3&&(p[3]*=1),p[0]=_e(a+1/3,n,r),p[1]=_e(a,n,r),p[2]=_e(a-1/3,n,r);else p=t.match(z)||ge.transparent;p=p.map(Number)}return e&&!d&&(n=p[0]/me,r=p[1]/me,s=p[2]/me,l=((h=Math.max(n,r,s))+(c=Math.min(n,r,s)))/2,h===c?a=o=0:(u=h-c,o=l>.5?u/(2-h-c):u/(h+c),a=h===n?(r-s)/u+(r<s?6:0):h===r?(s-n)/u+2:(n-r)/u+4,a*=60),p[0]=~~(a+.5),p[1]=~~(100*o+.5),p[2]=~~(100*l+.5)),i&&p.length<4&&(p[3]=1),p},ye=function(t){var e=[],i=[],n=-1;return t.split(Se).forEach((function(t){var r=t.match(V)||[];e.push.apply(e,r),i.push(n+=r.length+1)})),e.c=i,e},xe=function(t,e,i){var n,r,s,a,o="",l=(t+o).match(Se),h=e?"hsla(":"rgba(",c=0;if(!l)return t;if(l=l.map((function(t){return(t=ve(t,e,1))&&h+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),i&&(s=ye(t),(n=i.c).join(o)!==s.c.join(o)))for(a=(r=t.replace(Se,"1").split(V)).length-1;c<a;c++)o+=r[c]+(~n.indexOf(c)?l.shift()||h+"0,0,0,0)":(s.length?s:l.length?l:i).shift());if(!r)for(a=(r=t.split(Se)).length-1;c<a;c++)o+=r[c]+l[c];return o+r[a]},Se=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in ge)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Me=/hsl[a]?\(/,be=function(t){var e,i=t.join(" ");if(Se.lastIndex=0,Se.test(i))return e=Me.test(i),t[1]=xe(t[1],e),t[0]=xe(t[0],e,ye(t[1])),!0},Te=function(){var t,e,i,n,r,s,a=Date.now,o=500,d=33,p=a(),m=p,g=1e3/240,_=g,v=[],y=function i(l){var h,c,u,f,y=a()-m,x=!0===l;if(y>o&&(p+=y-d),((h=(u=(m+=y)-p)-_)>0||x)&&(f=++n.frame,r=u-1e3*n.time,n.time=u/=1e3,_+=h+(h>=g?4:g-h),c=1),x||(t=e(i)),c)for(s=0;s<v.length;s++)v[s](u,r,f,l)};return n={time:0,frame:0,tick:function(){y(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){u&&(!h&&N()&&(l=h=window,c=l.document||{},q.gsap=bi,(l.gsapVersions||(l.gsapVersions=[])).push(bi.version),j(Y||l.GreenSockGlobals||!l.gsap&&l||{}),i=l.requestAnimationFrame,pe.forEach(fe)),t&&n.sleep(),e=i||function(t){return setTimeout(t,_-1e3*n.time+1|0)},f=1,y(2))},sleep:function(){(i?l.cancelAnimationFrame:clearTimeout)(t),f=0,e=J},lagSmoothing:function(t,e){o=t||1/0,d=Math.min(e||33,o)},fps:function(t){g=1e3/(t||240),_=1e3*n.time+g},add:function(t,e,i){var r=e?function(e,i,s,a){t(e,i,s,a),n.remove(r)}:t;return n.remove(t),v[i?"unshift":"push"](r),we(),r},remove:function(t,e){~(e=v.indexOf(t))&&v.splice(e,1)&&s>=e&&s--},_listeners:v}}(),we=function(){return!f&&Te.wake()},Ee={},Ae=/^[\d.\-M][\d.\-,\s]/,Ce=/["']/g,Pe=function(t){for(var e,i,n,r={},s=t.substr(1,t.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)i=s[o],e=o!==l-1?i.lastIndexOf(","):i.length,n=i.substr(0,e),r[a]=isNaN(n)?n.replace(Ce,"").trim():+n,a=i.substr(e+1).trim();return r},Le=function(t){return function(e){return 1-t(1-e)}},Re=function t(e,i){for(var n,r=e._first;r;)r instanceof ze?t(r,i):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===i||(r.timeline?t(r.timeline,i):(n=r._ease,r._ease=r._yEase,r._yEase=n,r._yoyo=i)),r=r._next},De=function(t,e){return t&&(L(t)?t:Ee[t]||function(t){var e,i,n,r,s=(t+"").split("("),a=Ee[s[0]];return a&&s.length>1&&a.config?a.config.apply(null,~t.indexOf("{")?[Pe(s[1])]:(e=t,i=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",i),e.substring(i,~r&&r<n?e.indexOf(")",n+1):n)).split(",").map(yt)):Ee._CE&&Ae.test(t)?Ee._CE("",t):a}(t))||e},Ie=function(t,e,i,n){void 0===i&&(i=function(t){return 1-e(1-t)}),void 0===n&&(n=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:i,easeInOut:n};return dt(t,(function(t){for(var e in Ee[t]=q[t]=s,Ee[r=t.toLowerCase()]=i,s)Ee[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Ee[t+"."+e]=s[e]})),s},Ue=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Ne=function t(e,i,n){var r=i>=1?i:1,s=(n||(e?.3:.45))/(i<1?i:1),a=s/b*(Math.asin(1/r)||0),o=function(t){return 1===t?1:r*Math.pow(2,-10*t)*C((t-a)*s)+1},l="out"===e?o:"in"===e?function(t){return 1-o(1-t)}:Ue(o);return s=b/s,l.config=function(i,n){return t(e,i,n)},l},Oe=function t(e,i){void 0===i&&(i=1.70158);var n=function(t){return t?--t*t*((i+1)*t+i)+1:0},r="out"===e?n:"in"===e?function(t){return 1-n(1-t)}:Ue(n);return r.config=function(i){return t(e,i)},r};dt("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var i=e<5?e+1:e;Ie(t+",Power"+(i-1),e?function(t){return Math.pow(t,i)}:function(t){return t},(function(t){return 1-Math.pow(1-t,i)}),(function(t){return t<.5?Math.pow(2*t,i)/2:1-Math.pow(2*(1-t),i)/2}))})),Ee.Linear.easeNone=Ee.none=Ee.Linear.easeIn,Ie("Elastic",Ne("in"),Ne("out"),Ne()),m=7.5625,_=1/(g=2.75),Ie("Bounce",(function(t){return 1-v(1-t)}),v=function(t){return t<_?m*t*t:t<.7272727272727273?m*Math.pow(t-1.5/g,2)+.75:t<.9090909090909092?m*(t-=2.25/g)*t+.9375:m*Math.pow(t-2.625/g,2)+.984375}),Ie("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),Ie("Circ",(function(t){return-(E(1-t*t)-1)})),Ie("Sine",(function(t){return 1===t?1:1-A(t*T)})),Ie("Back",Oe("in"),Oe("out"),Oe()),Ee.SteppedEase=Ee.steps=q.SteppedEase={config:function(t,e){void 0===t&&(t=1);var i=1/t,n=t+(e?0:1),r=e?1:0;return function(t){return((n*Zt(0,.99999999,t)|0)+r)*i}}},x.ease=Ee["quad.out"],dt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return lt+=t+","+t+"Params,"}));var ke=function(t,e){this.id=w++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:ut,this.set=e?e.getSetter:ei},Fe=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Gt(this,+t.duration,1,1),this.data=t.data,a&&(this._ctx=a,a.data.push(this)),f||Te.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,Gt(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(we(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Ot(this,t),!i._dp||i.parent||kt(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Ft(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===M||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),vt(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Dt(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Dt(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*i,e):this._repeat?It(this._tTime,i)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?Ut(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Zt(-Math.abs(this._delay),this._tDur,e),!0),Nt(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(we(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==M&&(this._tTime-=M)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Ft(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(U(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ut(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=tt);var e=s;return s=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),s=e,this},e.globalTime=function(t){for(var e=this,i=arguments.length?t:e.rawTime();e;)i=e._start+i/(e._ts||1),e=e._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(t):i},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,Wt(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,Wt(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(qt(this,t),U(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,U(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,i=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=i&&t<this.endTime(!0)-M))},e.eventCallback=function(t,e,i){var n=this.vars;return arguments.length>1?(e?(n[t]=e,i&&(n[t+"Params"]=i),"onUpdate"===t&&(this._onUpdate=e)):delete n[t],this):n[t]},e.then=function(t){var e=this;return new Promise((function(i){var n=L(t)?t:xt,r=function(){var t=e.then;e.then=null,L(n)&&(n=n(e))&&(n.then||n===e)&&(e.then=t),i(n),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){de(this)},t}();St(Fe.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var ze=function(t){function i(i,n){var r;return void 0===i&&(i={}),(r=t.call(this,i)||this).labels={},r.smoothChildTiming=!!i.smoothChildTiming,r.autoRemoveChildren=!!i.autoRemoveChildren,r._sort=U(i.sortChildren),o&&Ft(i.parent||o,e(r),n),i.reversed&&r.reverse(),i.paused&&r.paused(!0),i.scrollTrigger&&zt(e(r),i.scrollTrigger),r}n(i,t);var r=i.prototype;return r.to=function(t,e,i){return Yt(0,arguments,this),this},r.from=function(t,e,i){return Yt(1,arguments,this),this},r.fromTo=function(t,e,i,n){return Yt(2,arguments,this),this},r.set=function(t,e,i){return e.duration=0,e.parent=this,wt(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ke(t,e,qt(this,i),1),this},r.call=function(t,e,i){return Ft(this,Ke.delayedCall(0,t,e),i)},r.staggerTo=function(t,e,i,n,r,s,a){return i.duration=e,i.stagger=i.stagger||n,i.onComplete=s,i.onCompleteParams=a,i.parent=this,new Ke(t,i,qt(this,r)),this},r.staggerFrom=function(t,e,i,n,r,s,a){return i.runBackwards=1,wt(i).immediateRender=U(i.immediateRender),this.staggerTo(t,e,i,n,r,s,a)},r.staggerFromTo=function(t,e,i,n,r,s,a,o){return n.startAt=i,wt(n).immediateRender=U(n.immediateRender),this.staggerTo(t,e,n,r,s,a,o)},r.render=function(t,e,i){var n,r,a,l,h,c,u,d,p,f,m,g,_=this._time,v=this._dirty?this.totalDuration():this._tDur,y=this._dur,x=t<=0?0:ft(t),S=this._zTime<0!=t<0&&(this._initted||!y);if(this!==o&&x>v&&t>=0&&(x=v),x!==this._tTime||i||S){if(_!==this._time&&y&&(x+=this._time-_,t+=this._time-_),n=x,p=this._start,c=!(d=this._ts),S&&(y||(_=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(m=this._yoyo,h=y+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*h+t,e,i);if(n=ft(x%h),x===v?(l=this._repeat,n=y):((l=~~(x/h))&&l===x/h&&(n=y,l--),n>y&&(n=y)),f=It(this._tTime,h),!_&&this._tTime&&f!==l&&this._tTime-f*h-this._dur<=0&&(f=l),m&&1&l&&(n=y-n,g=1),l!==f&&!this._lock){var b=m&&1&f,T=b===(m&&1&l);if(l<f&&(b=!b),_=b?0:x%y?y:x,this._lock=1,this.render(_||(g?0:ft(l*h)),e,!y)._lock=0,this._tTime=x,!e&&this.parent&&ue(this,"onRepeat"),this.vars.repeatRefresh&&!g&&(this.invalidate()._lock=1),_&&_!==this._time||c!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,v=this._tDur,T&&(this._lock=2,_=b?y:-1e-4,this.render(_,!0),this.vars.repeatRefresh&&!g&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;Re(this,g)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(t,e,i){var n;if(i>e)for(n=t._first;n&&n._start<=i;){if("isPause"===n.data&&n._start>e)return n;n=n._next}else for(n=t._last;n&&n._start>=i;){if("isPause"===n.data&&n._start<e)return n;n=n._prev}}(this,ft(_),ft(n)),u&&(x-=n-(n=u._start))),this._tTime=x,this._time=n,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,_=0),!_&&n&&!e&&!l&&(ue(this,"onStart"),this._tTime!==x))return this;if(n>=_&&t>=0)for(r=this._first;r;){if(a=r._next,(r._act||n>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,i);if(r.render(r._ts>0?(n-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(n-r._start)*r._ts,e,i),n!==this._time||!this._ts&&!c){u=0,a&&(x+=this._zTime=-1e-8);break}}r=a}else{r=this._last;for(var w=t<0?t:n;r;){if(a=r._prev,(r._act||w<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,i);if(r.render(r._ts>0?(w-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(w-r._start)*r._ts,e,i||s&&(r._initted||r._startAt)),n!==this._time||!this._ts&&!c){u=0,a&&(x+=this._zTime=w?-1e-8:M);break}}r=a}}if(u&&!e&&(this.pause(),u.render(n>=_?0:-1e-8)._zTime=n>=_?1:-1,this._ts))return this._start=p,Nt(this),this.render(t,e,i);this._onUpdate&&!e&&ue(this,"onUpdate",!0),(x===v&&this._tTime>=this.totalDuration()||!x&&_)&&(p!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((t||!y)&&(x===v&&this._ts>0||!x&&this._ts<0)&&Ct(this,1),e||t<0&&!_||!x&&!_&&v||(ue(this,x===v&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(x<v&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(t,e){var i=this;if(R(e)||(e=qt(this,e,t)),!(t instanceof Fe)){if(F(t))return t.forEach((function(t){return i.add(t,e)})),this;if(P(t))return this.addLabel(t,e);if(!L(t))return this;t=Ke.delayedCall(0,t)}return this!==t?Ft(this,t,e):this},r.getChildren=function(t,e,i,n){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=-S);for(var r=[],s=this._first;s;)s._start>=n&&(s instanceof Ke?e&&r.push(s):(i&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,i)))),s=s._next;return r},r.getById=function(t){for(var e=this.getChildren(1,1,1),i=e.length;i--;)if(e[i].vars.id===t)return e[i]},r.remove=function(t){return P(t)?this.removeLabel(t):L(t)?this.killTweensOf(t):(At(this,t),t===this._recent&&(this._recent=this._last),Pt(this))},r.totalTime=function(e,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ft(Te.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,i),this._forcing=0,this):this._tTime},r.addLabel=function(t,e){return this.labels[t]=qt(this,e),this},r.removeLabel=function(t){return delete this.labels[t],this},r.addPause=function(t,e,i){var n=Ke.delayedCall(0,e||J,i);return n.data="isPause",this._hasPause=1,Ft(this,n,qt(this,t))},r.removePause=function(t){var e=this._first;for(t=qt(this,t);e;)e._start===t&&"isPause"===e.data&&Ct(e),e=e._next},r.killTweensOf=function(t,e,i){for(var n=this.getTweensOf(t,i),r=n.length;r--;)Be!==n[r]&&n[r].kill(t,e);return this},r.getTweensOf=function(t,e){for(var i,n=[],r=te(t),s=this._first,a=R(e);s;)s instanceof Ke?gt(s._targets,r)&&(a?(!Be||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&n.push(s):(i=s.getTweensOf(r,e)).length&&n.push.apply(n,i),s=s._next;return n},r.tweenTo=function(t,e){e=e||{};var i,n=this,r=qt(n,t),s=e,a=s.startAt,o=s.onStart,l=s.onStartParams,h=s.immediateRender,c=Ke.to(n,St({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(a&&"time"in a?a.time:n._time))/n.timeScale())||M,onStart:function(){if(n.pause(),!i){var t=e.duration||Math.abs((r-(a&&"time"in a?a.time:n._time))/n.timeScale());c._dur!==t&&Gt(c,t,0,1).render(c._time,!0,!0),i=1}o&&o.apply(c,l||[])}},e));return h?c.render(0):c},r.tweenFromTo=function(t,e,i){return this.tweenTo(e,St({startAt:{time:qt(this,t)}},i))},r.recent=function(){return this._recent},r.nextLabel=function(t){return void 0===t&&(t=this._time),ce(this,qt(this,t))},r.previousLabel=function(t){return void 0===t&&(t=this._time),ce(this,qt(this,t),1)},r.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+M)},r.shiftChildren=function(t,e,i){void 0===i&&(i=0);for(var n,r=this._first,s=this.labels;r;)r._start>=i&&(r._start+=t,r._end+=t),r=r._next;if(e)for(n in s)s[n]>=i&&(s[n]+=t);return Pt(this)},r.invalidate=function(e){var i=this._first;for(this._lock=0;i;)i.invalidate(e),i=i._next;return t.prototype.invalidate.call(this,e)},r.clear=function(t){void 0===t&&(t=!0);for(var e,i=this._first;i;)e=i._next,this.remove(i),i=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Pt(this)},r.totalDuration=function(t){var e,i,n,r=0,s=this,a=s._last,l=S;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(n=s.parent;a;)e=a._prev,a._dirty&&a.totalDuration(),(i=a._start)>l&&s._sort&&a._ts&&!s._lock?(s._lock=1,Ft(s,a,i-a._delay,1)._lock=0):l=i,i<0&&a._ts&&(r-=i,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=i/s._ts,s._time-=i,s._tTime-=i),s.shiftChildren(-i,!1,-Infinity),l=0),a._end>r&&a._ts&&(r=a._end),a=e;Gt(s,s===o&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},i.updateRoot=function(t){if(o._ts&&(vt(o,Ut(t,o)),d=Te.frame),Te.frame>=at){at+=y.autoSleep||120;var e=o._first;if((!e||!e._ts)&&y.autoSleep&&Te._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Te.sleep()}}},i}(Fe);St(ze.prototype,{_lock:0,_hasPause:0,_forcing:0});var Be,Ve,He=function(t,e,i,n,r,s,a){var o,l,h,c,u,d,p,f,m=new ci(this._pt,t,e,0,1,ri,null,r),g=0,_=0;for(m.b=i,m.e=n,i+="",(p=~(n+="").indexOf("random("))&&(n=le(n)),s&&(s(f=[i,n],t,e),i=f[0],n=f[1]),l=i.match(H)||[];o=H.exec(n);)c=o[0],u=n.substring(g,o.index),h?h=(h+1)%5:"rgba("===u.substr(-5)&&(h=1),c!==l[_++]&&(d=parseFloat(l[_-1])||0,m._pt={_next:m._pt,p:u||1===_?u:",",s:d,c:"="===c.charAt(1)?mt(d,c)-d:parseFloat(c)-d,m:h&&h<4?Math.round:0},g=H.lastIndex);return m.c=g<n.length?n.substring(g,n.length):"",m.fp=a,(G.test(n)||p)&&(m.e=0),this._pt=m,m},Ge=function(t,e,i,n,r,s,a,o,l,h){L(n)&&(n=n(r||0,t,s));var c,u=t[e],d="get"!==i?i:L(u)?l?t[e.indexOf("set")||!L(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,p=L(u)?l?Qe:$e:Je;if(P(n)&&(~n.indexOf("random(")&&(n=le(n)),"="===n.charAt(1)&&((c=mt(d,n)+(Kt(d)||0))||0===c)&&(n=c)),!h||d!==n||Ve)return isNaN(d*n)||""===n?He.call(this,t,e,d,n,p,o||y.stringFilter,l):(c=new ci(this._pt,t,e,+d||0,n-(d||0),"boolean"==typeof u?ni:ii,0,p),l&&(c.fp=l),a&&c.modifier(a,this,t),this._pt=c)},We=function(t,e,i,n,r,s){var a,o,l,h;if(rt[t]&&!1!==(a=new rt[t]).init(r,a.rawVars?e[t]:function(t,e,i,n,r){if(L(t)&&(t=Ye(t,r,e,i,n)),!I(t)||t.style&&t.nodeType||F(t)||k(t))return P(t)?Ye(t,r,e,i,n):t;var s,a={};for(s in t)a[s]=Ye(t[s],r,e,i,n);return a}(e[t],n,r,s,i),i,n,s)&&(i._pt=o=new ci(i._pt,r,t,0,1,a.render,a,0,a.priority),i!==p))for(l=i._ptLookup[i._targets.indexOf(r)],h=a._props.length;h--;)l[a._props[h]]=o;return a},Xe=function t(e,i,n){var a,l,h,c,u,d,p,f,m,g,_,v,y,b=e.vars,T=b.ease,w=b.startAt,E=b.immediateRender,A=b.lazy,C=b.onUpdate,P=b.onUpdateParams,L=b.callbackScope,R=b.runBackwards,D=b.yoyoEase,I=b.keyframes,N=b.autoRevert,O=e._dur,k=e._startAt,F=e._targets,z=e.parent,B=z&&"nested"===z.data?z.vars.targets:F,V="auto"===e._overwrite&&!r,H=e.timeline;if(H&&(!I||!T)&&(T="none"),e._ease=De(T,x.ease),e._yEase=D?Le(De(!0===D?T:D,x.ease)):0,D&&e._yoyo&&!e._repeat&&(D=e._yEase,e._yEase=e._ease,e._ease=D),e._from=!H&&!!b.runBackwards,!H||I&&!b.stagger){if(v=(f=F[0]?ct(F[0]).harness:0)&&b[f.prop],a=Tt(b,et),k&&(k._zTime<0&&k.progress(1),i<0&&R&&E&&!N?k.render(-1,!0):k.revert(R&&O?Q:$),k._lazy=0),w){if(Ct(e._startAt=Ke.set(F,St({data:"isStart",overwrite:!1,parent:z,immediateRender:!0,lazy:!k&&U(A),startAt:null,delay:0,onUpdate:C,onUpdateParams:P,callbackScope:L,stagger:0},w))),e._startAt._dp=0,e._startAt._sat=e,i<0&&(s||!E&&!N)&&e._startAt.revert(Q),E&&O&&i<=0&&n<=0)return void(i&&(e._zTime=i))}else if(R&&O&&!k)if(i&&(E=!1),h=St({overwrite:!1,data:"isFromStart",lazy:E&&!k&&U(A),immediateRender:E,stagger:0,parent:z},a),v&&(h[f.prop]=v),Ct(e._startAt=Ke.set(F,h)),e._startAt._dp=0,e._startAt._sat=e,i<0&&(s?e._startAt.revert(Q):e._startAt.render(-1,!0)),e._zTime=i,E){if(!i)return}else t(e._startAt,M,M);for(e._pt=e._ptCache=0,A=O&&U(A)||A&&!O,l=0;l<F.length;l++){if(p=(u=F[l])._gsap||ht(F)[l]._gsap,e._ptLookup[l]=g={},nt[p.id]&&it.length&&_t(),_=B===F?l:B.indexOf(u),f&&!1!==(m=new f).init(u,v||a,e,_,B)&&(e._pt=c=new ci(e._pt,u,m.name,0,1,m.render,m,0,m.priority),m._props.forEach((function(t){g[t]=c})),m.priority&&(d=1)),!f||v)for(h in a)rt[h]&&(m=We(h,a,e,_,u,B))?m.priority&&(d=1):g[h]=c=Ge.call(e,u,h,"get",a[h],_,B,0,b.stringFilter);e._op&&e._op[l]&&e.kill(u,e._op[l]),V&&e._pt&&(Be=e,o.killTweensOf(u,g,e.globalTime(i)),y=!e.parent,Be=0),e._pt&&A&&(nt[p.id]=1)}d&&hi(e),e._onInit&&e._onInit(e)}e._onUpdate=C,e._initted=(!e._op||e._pt)&&!y,I&&i<=0&&H.render(S,!0,!0)},qe=function(t,e,i,n){var r,s,a=e.ease||n||"power1.inOut";if(F(e))s=i[t]||(i[t]=[]),e.forEach((function(t,i){return s.push({t:i/(e.length-1)*100,v:t,e:a})}));else for(r in e)s=i[r]||(i[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:a})},Ye=function(t,e,i,n,r){return L(t)?t.call(e,i,n,r):P(t)&&~t.indexOf("random(")?le(t):t},je=lt+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Ze={};dt(je+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return Ze[t]=1}));var Ke=function(t){function i(i,n,s,a){var l;"number"==typeof n&&(s.duration=n,n=s,s=null);var h,c,u,d,p,f,m,g,_=(l=t.call(this,a?n:wt(n))||this).vars,v=_.duration,x=_.delay,S=_.immediateRender,M=_.stagger,b=_.overwrite,T=_.keyframes,w=_.defaults,E=_.scrollTrigger,A=_.yoyoEase,C=n.parent||o,P=(F(i)||k(i)?R(i[0]):"length"in n)?[i]:te(i);if(l._targets=P.length?ht(P):Z(0,!y.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=b,T||M||O(v)||O(x)){if(n=l.vars,(h=l.timeline=new ze({data:"nested",defaults:w||{},targets:C&&"nested"===C.data?C.vars.targets:P})).kill(),h.parent=h._dp=e(l),h._start=0,M||O(v)||O(x)){if(d=P.length,m=M&&ne(M),I(M))for(p in M)~je.indexOf(p)&&(g||(g={}),g[p]=M[p]);for(c=0;c<d;c++)(u=Tt(n,Ze)).stagger=0,A&&(u.yoyoEase=A),g&&Mt(u,g),f=P[c],u.duration=+Ye(v,e(l),c,f,P),u.delay=(+Ye(x,e(l),c,f,P)||0)-l._delay,!M&&1===d&&u.delay&&(l._delay=x=u.delay,l._start+=x,u.delay=0),h.to(f,u,m?m(c,f,P):0),h._ease=Ee.none;h.duration()?v=x=0:l.timeline=0}else if(T){wt(St(h.vars.defaults,{ease:"none"})),h._ease=De(T.ease||n.ease||"none");var L,D,N,z=0;if(F(T))T.forEach((function(t){return h.to(P,t,">")})),h.duration();else{for(p in u={},T)"ease"===p||"easeEach"===p||qe(p,T[p],u,T.easeEach);for(p in u)for(L=u[p].sort((function(t,e){return t.t-e.t})),z=0,c=0;c<L.length;c++)(N={ease:(D=L[c]).e,duration:(D.t-(c?L[c-1].t:0))/100*v})[p]=D.v,h.to(P,N,z),z+=N.duration;h.duration()<v&&h.to({},{duration:v-h.duration()})}}v||l.duration(v=h.duration())}else l.timeline=0;return!0!==b||r||(Be=e(l),o.killTweensOf(P),Be=0),Ft(C,e(l),s),n.reversed&&l.reverse(),n.paused&&l.paused(!0),(S||!v&&!T&&l._start===ft(C._time)&&U(S)&&Rt(e(l))&&"nested"!==C.data)&&(l._tTime=-1e-8,l.render(Math.max(0,-x)||0)),E&&zt(e(l),E),l}n(i,t);var a=i.prototype;return a.render=function(t,e,i){var n,r,a,o,l,h,c,u,d,p=this._time,f=this._tDur,m=this._dur,g=t<0,_=t>f-M&&!g?f:t<M?0:t;if(m){if(_!==this._tTime||!t||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g){if(n=_,u=this.timeline,this._repeat){if(o=m+this._rDelay,this._repeat<-1&&g)return this.totalTime(100*o+t,e,i);if(n=ft(_%o),_===f?(a=this._repeat,n=m):((a=~~(_/o))&&a===_/o&&(n=m,a--),n>m&&(n=m)),(h=this._yoyo&&1&a)&&(d=this._yEase,n=m-n),l=It(this._tTime,o),n===p&&!i&&this._initted)return this._tTime=_,this;a!==l&&(u&&this._yEase&&Re(u,h),!this.vars.repeatRefresh||h||this._lock||(this._lock=i=1,this.render(ft(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(Bt(this,g?t:n,i,e,_))return this._tTime=0,this;if(p!==this._time)return this;if(m!==this._dur)return this.render(t,e,i)}if(this._tTime=_,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(d||this._ease)(n/m),this._from&&(this.ratio=c=1-c),n&&!p&&!e&&!a&&(ue(this,"onStart"),this._tTime!==_))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(t<0?t:!n&&h?-1e-8:u._dur*u._ease(n/this._dur),e,i)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(g&&Lt(this,t,0,i),ue(this,"onUpdate")),this._repeat&&a!==l&&this.vars.onRepeat&&!e&&this.parent&&ue(this,"onRepeat"),_!==this._tDur&&_||this._tTime!==_||(g&&!this._onUpdate&&Lt(this,t,0,!0),(t||!m)&&(_===this._tDur&&this._ts>0||!_&&this._ts<0)&&Ct(this,1),e||g&&!p||!(_||p||h)||(ue(this,_===f?"onComplete":"onReverseComplete",!0),this._prom&&!(_<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,i,n){var r,a,o,l=t.ratio,h=e<0||!e&&(!t._start&&Vt(t)&&(t._initted||!Ht(t))||(t._ts<0||t._dp._ts<0)&&!Ht(t))?0:1,c=t._rDelay,u=0;if(c&&t._repeat&&(u=Zt(0,t._tDur,e),a=It(u,c),t._yoyo&&1&a&&(h=1-h),a!==It(t._tTime,c)&&(l=1-h,t.vars.repeatRefresh&&t._initted&&t.invalidate())),h!==l||s||n||t._zTime===M||!e&&t._zTime){if(!t._initted&&Bt(t,e,n,i,u))return;for(o=t._zTime,t._zTime=e||(i?M:0),i||(i=e&&!o),t.ratio=h,t._from&&(h=1-h),t._time=0,t._tTime=u,r=t._pt;r;)r.r(h,r.d),r=r._next;e<0&&Lt(t,e,0,!0),t._onUpdate&&!i&&ue(t,"onUpdate"),u&&t._repeat&&!i&&t.parent&&ue(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===h&&(h&&Ct(t,1),i||s||(ue(t,h?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,i);return this},a.targets=function(){return this._targets},a.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},a.resetTo=function(t,e,i,n){f||Te.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Xe(this,r),function(t,e,i,n,r,s,a){var o,l,h,c,u=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!u)for(u=t._ptCache[e]=[],h=t._ptLookup,c=t._targets.length;c--;){if((o=h[c][e])&&o.d&&o.d._pt)for(o=o.d._pt;o&&o.p!==e&&o.fp!==e;)o=o._next;if(!o)return Ve=1,t.vars[e]="+=0",Xe(t,a),Ve=0,1;u.push(o)}for(c=u.length;c--;)(o=(l=u[c])._pt||l).s=!n&&0!==n||r?o.s+(n||0)+s*o.c:n,o.c=i-o.s,l.e&&(l.e=pt(i)+Kt(l.e)),l.b&&(l.b=o.s+Kt(l.b))}(this,t,e,i,n,this._ease(r/this._dur),r)?this.resetTo(t,e,i,n):(Ot(this,0),this.parent||Et(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},a.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?de(this):this;if(this.timeline){var i=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Be&&!0!==Be.vars.overwrite)._first||de(this),this.parent&&i!==this.timeline.totalDuration()&&Gt(this,this._dur*this.timeline._tDur/i,0,1),this}var n,r,s,a,o,l,h,c=this._targets,u=t?te(t):c,d=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var i=t.length,n=i===e.length;n&&i--&&t[i]===e[i];);return i<0}(c,u))return"all"===e&&(this._pt=0),de(this);for(n=this._op=this._op||[],"all"!==e&&(P(e)&&(o={},dt(e,(function(t){return o[t]=1})),e=o),e=function(t,e){var i,n,r,s,a=t[0]?ct(t[0]).harness:0,o=a&&a.aliases;if(!o)return e;for(n in i=Mt({},e),o)if(n in i)for(r=(s=o[n].split(",")).length;r--;)i[s[r]]=i[n];return i}(c,e)),h=c.length;h--;)if(~u.indexOf(c[h]))for(o in r=d[h],"all"===e?(n[h]=e,a=r,s={}):(s=n[h]=n[h]||{},a=e),a)(l=r&&r[o])&&("kill"in l.d&&!0!==l.d.kill(o)||At(this,l,"_pt"),delete r[o]),"all"!==s&&(s[o]=1);return this._initted&&!this._pt&&p&&de(this),this},i.to=function(t,e){return new i(t,e,arguments[2])},i.from=function(t,e){return Yt(1,arguments)},i.delayedCall=function(t,e,n,r){return new i(e,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:e,onReverseComplete:e,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},i.fromTo=function(t,e,i){return Yt(2,arguments)},i.set=function(t,e){return e.duration=0,e.repeatDelay||(e.repeat=0),new i(t,e)},i.killTweensOf=function(t,e,i){return o.killTweensOf(t,e,i)},i}(Fe);St(Ke.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),dt("staggerTo,staggerFrom,staggerFromTo",(function(t){Ke[t]=function(){var e=new ze,i=Jt.call(arguments,0);return i.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,i)}}));var Je=function(t,e,i){return t[e]=i},$e=function(t,e,i){return t[e](i)},Qe=function(t,e,i,n){return t[e](n.fp,i)},ti=function(t,e,i){return t.setAttribute(e,i)},ei=function(t,e){return L(t[e])?$e:D(t[e])&&t.setAttribute?ti:Je},ii=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},ni=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},ri=function(t,e){var i=e._pt,n="";if(!t&&e.b)n=e.b;else if(1===t&&e.e)n=e.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*t):Math.round(1e4*(i.s+i.c*t))/1e4)+n,i=i._next;n+=e.c}e.set(e.t,e.p,n,e)},si=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},ai=function(t,e,i,n){for(var r,s=this._pt;s;)r=s._next,s.p===n&&s.modifier(t,e,i),s=r},oi=function(t){for(var e,i,n=this._pt;n;)i=n._next,n.p===t&&!n.op||n.op===t?At(this,n,"_pt"):n.dep||(e=1),n=i;return!e},li=function(t,e,i,n){n.mSet(t,e,n.m.call(n.tween,i,n.mt),n)},hi=function(t){for(var e,i,n,r,s=t._pt;s;){for(e=s._next,i=n;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:r)?s._prev._next=s:n=s,(s._next=i)?i._prev=s:r=s,s=e}t._pt=n},ci=function(){function t(t,e,i,n,r,s,a,o,l){this.t=e,this.s=n,this.c=r,this.p=i,this.r=s||ii,this.d=a||this,this.set=o||Je,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,i){this.mSet=this.mSet||this.set,this.set=li,this.m=t,this.mt=i,this.tween=e},t}();dt(lt+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return et[t]=1})),q.TweenMax=q.TweenLite=Ke,q.TimelineLite=q.TimelineMax=ze,o=new ze({sortChildren:!1,defaults:x,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),y.stringFilter=be;var ui=[],di={},pi=[],fi=0,mi=0,gi=function(t){return(di[t]||pi).map((function(t){return t()}))},_i=function(){var t=Date.now(),e=[];t-fi>2&&(gi("matchMediaInit"),ui.forEach((function(t){var i,n,r,s,a=t.queries,o=t.conditions;for(n in a)(i=l.matchMedia(a[n]).matches)&&(r=1),i!==o[n]&&(o[n]=i,s=1);s&&(t.revert(),r&&e.push(t))})),gi("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t)})),fi=t,gi("matchMedia"))},vi=function(){function t(t,e){this.selector=e&&ee(e),this.data=[],this._r=[],this.isReverted=!1,this.id=mi++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,i){L(t)&&(i=e,e=t,t=L);var n=this,r=function(){var t,r=a,s=n.selector;return r&&r!==n&&r.data.push(n),i&&(n.selector=ee(i)),a=n,t=e.apply(n,arguments),L(t)&&n._r.push(t),a=r,n.selector=s,n.isReverted=!1,t};return n.last=r,t===L?r(n):t?n[t]=r:r},e.ignore=function(t){var e=a;a=null,t(this),a=e},e.getTweens=function(){var e=[];return this.data.forEach((function(i){return i instanceof t?e.push.apply(e,i.getTweens()):i instanceof Ke&&!(i.parent&&"nested"===i.parent.data)&&e.push(i)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var i=this;if(t){var n=this.getTweens();this.data.forEach((function(t){"isFlip"===t.data&&(t.revert(),t.getChildren(!0,!0,!1).forEach((function(t){return n.splice(n.indexOf(t),1)})))})),n.map((function(t){return{g:t.globalTime(0),t}})).sort((function(t,e){return e.g-t.g||-1/0})).forEach((function(e){return e.t.revert(t)})),this.data.forEach((function(e){return!(e instanceof Ke)&&e.revert&&e.revert(t)})),this._r.forEach((function(e){return e(t,i)})),this.isReverted=!0}else this.data.forEach((function(t){return t.kill&&t.kill()}));if(this.clear(),e)for(var r=ui.length;r--;)ui[r].id===this.id&&ui.splice(r,1)},e.revert=function(t){this.kill(t||{})},t}(),yi=function(){function t(t){this.contexts=[],this.scope=t}var e=t.prototype;return e.add=function(t,e,i){I(t)||(t={matches:t});var n,r,s,o=new vi(0,i||this.scope),h=o.conditions={};for(r in a&&!o.selector&&(o.selector=a.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===r?s=1:(n=l.matchMedia(t[r]))&&(ui.indexOf(o)<0&&ui.push(o),(h[r]=n.matches)&&(s=1),n.addListener?n.addListener(_i):n.addEventListener("change",_i));return s&&e(o),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),xi={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach((function(t){return fe(t)}))},timeline:function(t){return new ze(t)},getTweensOf:function(t,e){return o.getTweensOf(t,e)},getProperty:function(t,e,i,n){P(t)&&(t=te(t)[0]);var r=ct(t||{}).get,s=i?xt:yt;return"native"===i&&(i=""),t?e?s((rt[e]&&rt[e].get||r)(t,e,i,n)):function(e,i,n){return s((rt[e]&&rt[e].get||r)(t,e,i,n))}:t},quickSetter:function(t,e,i){if((t=te(t)).length>1){var n=t.map((function(t){return bi.quickSetter(t,e,i)})),r=n.length;return function(t){for(var e=r;e--;)n[e](t)}}t=t[0]||{};var s=rt[e],a=ct(t),o=a.harness&&(a.harness.aliases||{})[e]||e,l=s?function(e){var n=new s;p._pt=0,n.init(t,i?e+i:e,p,0,[t]),n.render(1,n),p._pt&&si(1,p)}:a.set(t,o);return s?l:function(e){return l(t,o,i?e+i:e,a,1)}},quickTo:function(t,e,i){var n,r=bi.to(t,Mt(((n={})[e]="+=0.1",n.paused=!0,n),i||{})),s=function(t,i,n){return r.resetTo(e,t,i,n)};return s.tween=r,s},isTweening:function(t){return o.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=De(t.ease,x.ease)),bt(x,t||{})},config:function(t){return bt(y,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,n=t.plugins,r=t.defaults,s=t.extendTimeline;(n||"").split(",").forEach((function(t){return t&&!rt[t]&&!q[t]&&Z()})),st[e]=function(t,e,n){return i(te(t),St(e||{},r),n)},s&&(ze.prototype[e]=function(t,i,n){return this.add(st[e](t,I(i)?i:(n=i)&&{},this),n)})},registerEase:function(t,e){Ee[t]=De(e)},parseEase:function(t,e){return arguments.length?De(t,e):Ee},getById:function(t){return o.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var i,n,r=new ze(t);for(r.smoothChildTiming=U(t.smoothChildTiming),o.remove(r),r._dp=0,r._time=r._tTime=o._time,i=o._first;i;)n=i._next,!e&&!i._dur&&i instanceof Ke&&i.vars.onComplete===i._targets[0]||Ft(r,i,i._start-i._delay),i=n;return Ft(o,r,0),r},context:function(t,e){return t?new vi(t,e):a},matchMedia:function(t){return new yi(t)},matchMediaRefresh:function(){return ui.forEach((function(t){var e,i,n=t.conditions;for(i in n)n[i]&&(n[i]=!1,e=1);e&&t.revert()}))||_i()},addEventListener:function(t,e){var i=di[t]||(di[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=di[t],n=i&&i.indexOf(e);n>=0&&i.splice(n,1)},utils:{wrap:function t(e,i,n){var r=i-e;return F(e)?oe(e,t(0,e.length),i):jt(n,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,i,n){var r=i-e,s=2*r;return F(e)?oe(e,t(0,e.length-1),i):jt(n,(function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)}))},distribute:ne,random:ae,snap:se,normalize:function(t,e,i){return he(t,e,0,1,i)},getUnit:Kt,clamp:function(t,e,i){return jt(i,(function(i){return Zt(t,e,i)}))},splitColor:ve,toArray:te,selector:ee,mapRange:he,pipe:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(i){return t(parseFloat(i))+(e||Kt(i))}},interpolate:function t(e,i,n,r){var s=isNaN(e+i)?0:function(t){return(1-t)*e+t*i};if(!s){var a,o,l,h,c,u=P(e),d={};if(!0===n&&(r=1)&&(n=null),u)e={p:e},i={p:i};else if(F(e)&&!F(i)){for(l=[],h=e.length,c=h-2,o=1;o<h;o++)l.push(t(e[o-1],e[o]));h--,s=function(t){t*=h;var e=Math.min(c,~~t);return l[e](t-e)},n=i}else r||(e=Mt(F(e)?[]:{},e));if(!l){for(a in i)Ge.call(d,e,a,"get",i[a]);s=function(t){return si(t,d)||(u?e.p:e)}}}return jt(n,s)},shuffle:ie},install:j,effects:st,ticker:Te,updateRoot:ze.updateRoot,plugins:rt,globalTimeline:o,core:{PropTween:ci,globals:K,Tween:Ke,Timeline:ze,Animation:Fe,getCache:ct,_removeLinkedListItem:At,reverting:function(){return s},context:function(t){return t&&a&&(a.data.push(t),t._ctx=a),a},suppressOverwrites:function(t){return r=t}}};dt("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return xi[t]=Ke[t]})),Te.add(ze.updateRoot),p=xi.to({},{duration:0});var Si=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},Mi=function(t,e){return{name:t,rawVars:1,init:function(t,i,n){n._onInit=function(t){var n,r;if(P(i)&&(n={},dt(i,(function(t){return n[t]=1})),i=n),e){for(r in n={},i)n[r]=e(i[r]);i=n}!function(t,e){var i,n,r,s=t._targets;for(i in e)for(n=s.length;n--;)(r=t._ptLookup[n][i])&&(r=r.d)&&(r._pt&&(r=Si(r,i)),r&&r.modifier&&r.modifier(e[i],t,s[n],i))}(t,i)}}}},bi=xi.registerPlugin({name:"attr",init:function(t,e,i,n,r){var s,a,o;for(s in this.tween=i,e)o=t.getAttribute(s)||"",(a=this.add(t,"setAttribute",(o||0)+"",e[s],n,r,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(t,e){for(var i=e._pt;i;)s?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},Mi("roundProps",re),Mi("modifiers"),Mi("snap",se))||xi;Ke.version=ze.version=bi.version="3.12.2",u=1,N()&&we();Ee.Power0,Ee.Power1,Ee.Power2,Ee.Power3,Ee.Power4,Ee.Linear,Ee.Quad,Ee.Cubic,Ee.Quart,Ee.Quint,Ee.Strong,Ee.Elastic,Ee.Back,Ee.SteppedEase,Ee.Bounce,Ee.Sine,Ee.Expo,Ee.Circ;var Ti,wi,Ei,Ai,Ci,Pi,Li,Ri,Di={},Ii=180/Math.PI,Ui=Math.PI/180,Ni=Math.atan2,Oi=/([A-Z])/g,ki=/(left|right|width|margin|padding|x)/i,Fi=/[\s,\(]\S/,zi={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Bi=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Vi=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Hi=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},Gi=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},Wi=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Xi=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},qi=function(t,e,i){return t.style[e]=i},Yi=function(t,e,i){return t.style.setProperty(e,i)},ji=function(t,e,i){return t._gsap[e]=i},Zi=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},Ki=function(t,e,i,n,r){var s=t._gsap;s.scaleX=s.scaleY=i,s.renderTransform(r,s)},Ji=function(t,e,i,n,r){var s=t._gsap;s[e]=i,s.renderTransform(r,s)},$i="transform",Qi=$i+"Origin",tn=function t(e,i){var n=this,r=this.target,s=r.style;if(e in Di&&s){if(this.tfm=this.tfm||{},"transform"===e)return zi.transform.split(",").forEach((function(e){return t.call(n,e,i)}));if(~(e=zi[e]||e).indexOf(",")?e.split(",").forEach((function(t){return n.tfm[t]=yn(r,t)})):this.tfm[e]=r._gsap.x?r._gsap[e]:yn(r,e),this.props.indexOf($i)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Qi,i,"")),e=$i}(s||i)&&this.props.push(e,i,s[e])},en=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},nn=function(){var t,e,i=this.props,n=this.target,r=n.style,s=n._gsap;for(t=0;t<i.length;t+=3)i[t+1]?n[i[t]]=i[t+2]:i[t+2]?r[i[t]]=i[t+2]:r.removeProperty("--"===i[t].substr(0,2)?i[t]:i[t].replace(Oi,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(t=Li())&&t.isStart||r[$i]||(en(r),s.uncache=1)}},rn=function(t,e){var i={target:t,props:[],revert:nn,save:tn};return t._gsap||bi.core.getCache(t),e&&e.split(",").forEach((function(t){return i.save(t)})),i},sn=function(t,e){var i=wi.createElementNS?wi.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):wi.createElement(t);return i.style?i:wi.createElement(t)},an=function t(e,i,n){var r=getComputedStyle(e);return r[i]||r.getPropertyValue(i.replace(Oi,"-$1").toLowerCase())||r.getPropertyValue(i)||!n&&t(e,ln(i)||i,1)||""},on="O,Moz,ms,Ms,Webkit".split(","),ln=function(t,e,i){var n=(e||Ci).style,r=5;if(t in n&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(on[r]+t in n););return r<0?null:(3===r?"ms":r>=0?on[r]:"")+t},hn=function(){"undefined"!=typeof window&&window.document&&(Ti=window,wi=Ti.document,Ei=wi.documentElement,Ci=sn("div")||{style:{}},sn("div"),$i=ln($i),Qi=$i+"Origin",Ci.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Ri=!!ln("perspective"),Li=bi.core.reverting,Ai=1)},cn=function t(e){var i,n=sn("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,a=this.style.cssText;if(Ei.appendChild(n),n.appendChild(this),this.style.display="block",e)try{i=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(t){}else this._gsapBBox&&(i=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),Ei.removeChild(n),this.style.cssText=a,i},un=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},dn=function(t){var e;try{e=t.getBBox()}catch(i){e=cn.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===cn||(e=cn.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+un(t,["x","cx","x1"])||0,y:+un(t,["y","cy","y1"])||0,width:0,height:0}},pn=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!dn(t))},fn=function(t,e){if(e){var i=t.style;e in Di&&e!==Qi&&(e=$i),i.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),i.removeProperty(e.replace(Oi,"-$1").toLowerCase())):i.removeAttribute(e)}},mn=function(t,e,i,n,r,s){var a=new ci(t._pt,e,i,0,1,s?Xi:Wi);return t._pt=a,a.b=n,a.e=r,t._props.push(i),a},gn={deg:1,rad:1,turn:1},_n={grid:1,flex:1},vn=function t(e,i,n,r){var s,a,o,l,h=parseFloat(n)||0,c=(n+"").trim().substr((h+"").length)||"px",u=Ci.style,d=ki.test(i),p="svg"===e.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,_="%"===r;return r===c||!h||gn[r]||gn[c]?h:("px"!==c&&!g&&(h=t(e,i,n,"px")),l=e.getCTM&&pn(e),!_&&"%"!==c||!Di[i]&&!~i.indexOf("adius")?(u[d?"width":"height"]=m+(g?c:r),a=~i.indexOf("adius")||"em"===r&&e.appendChild&&!p?e:e.parentNode,l&&(a=(e.ownerSVGElement||{}).parentNode),a&&a!==wi&&a.appendChild||(a=wi.body),(o=a._gsap)&&_&&o.width&&d&&o.time===Te.time&&!o.uncache?pt(h/o.width*m):((_||"%"===c)&&!_n[an(a,"display")]&&(u.position=an(e,"position")),a===e&&(u.position="static"),a.appendChild(Ci),s=Ci[f],a.removeChild(Ci),u.position="absolute",d&&_&&((o=ct(a)).time=Te.time,o.width=a[f]),pt(g?s*h/m:s&&h?m/s*h:0))):(s=l?e.getBBox()[d?"width":"height"]:e[f],pt(_?h/s*m:h/100*s)))},yn=function(t,e,i,n){var r;return Ai||hn(),e in zi&&"transform"!==e&&~(e=zi[e]).indexOf(",")&&(e=e.split(",")[0]),Di[e]&&"transform"!==e?(r=Ln(t,n),r="transformOrigin"!==e?r[e]:r.svg?r.origin:Rn(an(t,Qi))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||n||~(r+"").indexOf("calc("))&&(r=bn[e]&&bn[e](t,e,i)||an(t,e)||ut(t,e)||("opacity"===e?1:0)),i&&!~(r+"").trim().indexOf(" ")?vn(t,e,r,i)+i:r},xn=function(t,e,i,n){if(!i||"none"===i){var r=ln(e,t,1),s=r&&an(t,r,1);s&&s!==i?(e=r,i=s):"borderColor"===e&&(i=an(t,"borderTopColor"))}var a,o,l,h,c,u,d,p,f,m,g,_=new ci(this._pt,t.style,e,0,1,ri),v=0,x=0;if(_.b=i,_.e=n,i+="","auto"===(n+="")&&(t.style[e]=n,n=an(t,e)||n,t.style[e]=i),be(a=[i,n]),n=a[1],l=(i=a[0]).match(V)||[],(n.match(V)||[]).length){for(;o=V.exec(n);)d=o[0],f=n.substring(v,o.index),c?c=(c+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(c=1),d!==(u=l[x++]||"")&&(h=parseFloat(u)||0,g=u.substr((h+"").length),"="===d.charAt(1)&&(d=mt(h,d)+g),p=parseFloat(d),m=d.substr((p+"").length),v=V.lastIndex-m.length,m||(m=m||y.units[e]||g,v===n.length&&(n+=m,_.e+=m)),g!==m&&(h=vn(t,e,u,m)||0),_._pt={_next:_._pt,p:f||1===x?f:",",s:h,c:p-h,m:c&&c<4||"zIndex"===e?Math.round:0});_.c=v<n.length?n.substring(v,n.length):""}else _.r="display"===e&&"none"===n?Xi:Wi;return G.test(n)&&(_.e=0),this._pt=_,_},Sn={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Mn=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i,n,r,s=e.t,a=s.style,o=e.u,l=s._gsap;if("all"===o||!0===o)a.cssText="",n=1;else for(r=(o=o.split(",")).length;--r>-1;)i=o[r],Di[i]&&(n=1,i="transformOrigin"===i?Qi:$i),fn(s,i);n&&(fn(s,$i),l&&(l.svg&&s.removeAttribute("transform"),Ln(s,1),l.uncache=1,en(a)))}},bn={clearProps:function(t,e,i,n,r){if("isFromStart"!==r.data){var s=t._pt=new ci(t._pt,e,i,0,0,Mn);return s.u=n,s.pr=-10,s.tween=r,t._props.push(i),1}}},Tn=[1,0,0,1,0,0],wn={},En=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},An=function(t){var e=an(t,$i);return En(e)?Tn:e.substr(7).match(B).map(pt)},Cn=function(t,e){var i,n,r,s,a=t._gsap||ct(t),o=t.style,l=An(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Tn:l:(l!==Tn||t.offsetParent||t===Ei||a.svg||(r=o.display,o.display="block",(i=t.parentNode)&&t.offsetParent||(s=1,n=t.nextElementSibling,Ei.appendChild(t)),l=An(t),r?o.display=r:fn(t,"display"),s&&(n?i.insertBefore(t,n):i?i.appendChild(t):Ei.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Pn=function(t,e,i,n,r,s){var a,o,l,h=t._gsap,c=r||Cn(t,!0),u=h.xOrigin||0,d=h.yOrigin||0,p=h.xOffset||0,f=h.yOffset||0,m=c[0],g=c[1],_=c[2],v=c[3],y=c[4],x=c[5],S=e.split(" "),M=parseFloat(S[0])||0,b=parseFloat(S[1])||0;i?c!==Tn&&(o=m*v-g*_)&&(l=M*(-g/o)+b*(m/o)-(m*x-g*y)/o,M=M*(v/o)+b*(-_/o)+(_*x-v*y)/o,b=l):(M=(a=dn(t)).x+(~S[0].indexOf("%")?M/100*a.width:M),b=a.y+(~(S[1]||S[0]).indexOf("%")?b/100*a.height:b)),n||!1!==n&&h.smooth?(y=M-u,x=b-d,h.xOffset=p+(y*m+x*_)-y,h.yOffset=f+(y*g+x*v)-x):h.xOffset=h.yOffset=0,h.xOrigin=M,h.yOrigin=b,h.smooth=!!n,h.origin=e,h.originIsAbsolute=!!i,t.style[Qi]="0px 0px",s&&(mn(s,h,"xOrigin",u,M),mn(s,h,"yOrigin",d,b),mn(s,h,"xOffset",p,h.xOffset),mn(s,h,"yOffset",f,h.yOffset)),t.setAttribute("data-svg-origin",M+" "+b)},Ln=function(t,e){var i=t._gsap||new ke(t);if("x"in i&&!e&&!i.uncache)return i;var n,r,s,a,o,l,h,c,u,d,p,f,m,g,_,v,x,S,M,b,T,w,E,A,C,P,L,R,D,I,U,N,O=t.style,k=i.scaleX<0,F="px",z="deg",B=getComputedStyle(t),V=an(t,Qi)||"0";return n=r=s=l=h=c=u=d=p=0,a=o=1,i.svg=!(!t.getCTM||!pn(t)),B.translate&&("none"===B.translate&&"none"===B.scale&&"none"===B.rotate||(O[$i]=("none"!==B.translate?"translate3d("+(B.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==B.rotate?"rotate("+B.rotate+") ":"")+("none"!==B.scale?"scale("+B.scale.split(" ").join(",")+") ":"")+("none"!==B[$i]?B[$i]:"")),O.scale=O.rotate=O.translate="none"),g=Cn(t,i.svg),i.svg&&(i.uncache?(C=t.getBBox(),V=i.xOrigin-C.x+"px "+(i.yOrigin-C.y)+"px",A=""):A=!e&&t.getAttribute("data-svg-origin"),Pn(t,A||V,!!A||i.originIsAbsolute,!1!==i.smooth,g)),f=i.xOrigin||0,m=i.yOrigin||0,g!==Tn&&(S=g[0],M=g[1],b=g[2],T=g[3],n=w=g[4],r=E=g[5],6===g.length?(a=Math.sqrt(S*S+M*M),o=Math.sqrt(T*T+b*b),l=S||M?Ni(M,S)*Ii:0,(u=b||T?Ni(b,T)*Ii+l:0)&&(o*=Math.abs(Math.cos(u*Ui))),i.svg&&(n-=f-(f*S+m*b),r-=m-(f*M+m*T))):(N=g[6],I=g[7],L=g[8],R=g[9],D=g[10],U=g[11],n=g[12],r=g[13],s=g[14],h=(_=Ni(N,D))*Ii,_&&(A=w*(v=Math.cos(-_))+L*(x=Math.sin(-_)),C=E*v+R*x,P=N*v+D*x,L=w*-x+L*v,R=E*-x+R*v,D=N*-x+D*v,U=I*-x+U*v,w=A,E=C,N=P),c=(_=Ni(-b,D))*Ii,_&&(v=Math.cos(-_),U=T*(x=Math.sin(-_))+U*v,S=A=S*v-L*x,M=C=M*v-R*x,b=P=b*v-D*x),l=(_=Ni(M,S))*Ii,_&&(A=S*(v=Math.cos(_))+M*(x=Math.sin(_)),C=w*v+E*x,M=M*v-S*x,E=E*v-w*x,S=A,w=C),h&&Math.abs(h)+Math.abs(l)>359.9&&(h=l=0,c=180-c),a=pt(Math.sqrt(S*S+M*M+b*b)),o=pt(Math.sqrt(E*E+N*N)),_=Ni(w,E),u=Math.abs(_)>2e-4?_*Ii:0,p=U?1/(U<0?-U:U):0),i.svg&&(A=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!En(an(t,$i)),A&&t.setAttribute("transform",A))),Math.abs(u)>90&&Math.abs(u)<270&&(k?(a*=-1,u+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,u+=u<=0?180:-180)),e=e||i.uncache,i.x=n-((i.xPercent=n&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-n)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+F,i.y=r-((i.yPercent=r&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+F,i.z=s+F,i.scaleX=pt(a),i.scaleY=pt(o),i.rotation=pt(l)+z,i.rotationX=pt(h)+z,i.rotationY=pt(c)+z,i.skewX=u+z,i.skewY=d+z,i.transformPerspective=p+F,(i.zOrigin=parseFloat(V.split(" ")[2])||0)&&(O[Qi]=Rn(V)),i.xOffset=i.yOffset=0,i.force3D=y.force3D,i.renderTransform=i.svg?Fn:Ri?kn:In,i.uncache=0,i},Rn=function(t){return(t=t.split(" "))[0]+" "+t[1]},Dn=function(t,e,i){var n=Kt(e);return pt(parseFloat(e)+parseFloat(vn(t,"x",i+"px",n)))+n},In=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,kn(t,e)},Un="0deg",Nn="0px",On=") ",kn=function(t,e){var i=e||this,n=i.xPercent,r=i.yPercent,s=i.x,a=i.y,o=i.z,l=i.rotation,h=i.rotationY,c=i.rotationX,u=i.skewX,d=i.skewY,p=i.scaleX,f=i.scaleY,m=i.transformPerspective,g=i.force3D,_=i.target,v=i.zOrigin,y="",x="auto"===g&&t&&1!==t||!0===g;if(v&&(c!==Un||h!==Un)){var S,M=parseFloat(h)*Ui,b=Math.sin(M),T=Math.cos(M);M=parseFloat(c)*Ui,S=Math.cos(M),s=Dn(_,s,b*S*-v),a=Dn(_,a,-Math.sin(M)*-v),o=Dn(_,o,T*S*-v+v)}m!==Nn&&(y+="perspective("+m+On),(n||r)&&(y+="translate("+n+"%, "+r+"%) "),(x||s!==Nn||a!==Nn||o!==Nn)&&(y+=o!==Nn||x?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+On),l!==Un&&(y+="rotate("+l+On),h!==Un&&(y+="rotateY("+h+On),c!==Un&&(y+="rotateX("+c+On),u===Un&&d===Un||(y+="skew("+u+", "+d+On),1===p&&1===f||(y+="scale("+p+", "+f+On),_.style[$i]=y||"translate(0, 0)"},Fn=function(t,e){var i,n,r,s,a,o=e||this,l=o.xPercent,h=o.yPercent,c=o.x,u=o.y,d=o.rotation,p=o.skewX,f=o.skewY,m=o.scaleX,g=o.scaleY,_=o.target,v=o.xOrigin,y=o.yOrigin,x=o.xOffset,S=o.yOffset,M=o.forceCSS,b=parseFloat(c),T=parseFloat(u);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Ui,p*=Ui,i=Math.cos(d)*m,n=Math.sin(d)*m,r=Math.sin(d-p)*-g,s=Math.cos(d-p)*g,p&&(f*=Ui,a=Math.tan(p-f),r*=a=Math.sqrt(1+a*a),s*=a,f&&(a=Math.tan(f),i*=a=Math.sqrt(1+a*a),n*=a)),i=pt(i),n=pt(n),r=pt(r),s=pt(s)):(i=m,s=g,n=r=0),(b&&!~(c+"").indexOf("px")||T&&!~(u+"").indexOf("px"))&&(b=vn(_,"x",c,"px"),T=vn(_,"y",u,"px")),(v||y||x||S)&&(b=pt(b+v-(v*i+y*r)+x),T=pt(T+y-(v*n+y*s)+S)),(l||h)&&(a=_.getBBox(),b=pt(b+l/100*a.width),T=pt(T+h/100*a.height)),a="matrix("+i+","+n+","+r+","+s+","+b+","+T+")",_.setAttribute("transform",a),M&&(_.style[$i]=a)},zn=function(t,e,i,n,r){var s,a,o=360,l=P(r),h=parseFloat(r)*(l&&~r.indexOf("rad")?Ii:1)-n,c=n+h+"deg";return l&&("short"===(s=r.split("_")[1])&&(h%=o)!==h%180&&(h+=h<0?o:-360),"cw"===s&&h<0?h=(h+36e9)%o-~~(h/o)*o:"ccw"===s&&h>0&&(h=(h-36e9)%o-~~(h/o)*o)),t._pt=a=new ci(t._pt,e,i,n,h,Vi),a.e=c,a.u="deg",t._props.push(i),a},Bn=function(t,e){for(var i in e)t[i]=e[i];return t},Vn=function(t,e,i){var n,r,s,a,o,l,h,c=Bn({},i._gsap),u=i.style;for(r in c.svg?(s=i.getAttribute("transform"),i.setAttribute("transform",""),u[$i]=e,n=Ln(i,1),fn(i,$i),i.setAttribute("transform",s)):(s=getComputedStyle(i)[$i],u[$i]=e,n=Ln(i,1),u[$i]=s),Di)(s=c[r])!==(a=n[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(o=Kt(s)!==(h=Kt(a))?vn(i,r,s,h):parseFloat(s),l=parseFloat(a),t._pt=new ci(t._pt,n,r,o,l-o,Bi),t._pt.u=h||0,t._props.push(r));Bn(n,c)};dt("padding,margin,Width,Radius",(function(t,e){var i="Top",n="Right",r="Bottom",s="Left",a=(e<3?[i,n,r,s]:[i+s,i+n,r+n,r+s]).map((function(i){return e<2?t+i:"border"+i+t}));bn[e>1?"border"+t:t]=function(t,e,i,n,r){var s,o;if(arguments.length<4)return s=a.map((function(e){return yn(t,e,i)})),5===(o=s.join(" ")).split(s[0]).length?s[0]:o;s=(n+"").split(" "),o={},a.forEach((function(t,e){return o[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,o,r)}}));var Hn,Gn,Wn,Xn={name:"css",register:hn,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,n,r){var s,a,o,l,h,c,u,d,p,f,m,g,_,v,x,S,M,b,T,w,E=this._props,A=t.style,C=i.vars.startAt;for(u in Ai||hn(),this.styles=this.styles||rn(t),S=this.styles.props,this.tween=i,e)if("autoRound"!==u&&(a=e[u],!rt[u]||!We(u,e,i,n,t,r)))if(h=typeof a,c=bn[u],"function"===h&&(h=typeof(a=a.call(i,n,t,r))),"string"===h&&~a.indexOf("random(")&&(a=le(a)),c)c(this,t,u,a,i)&&(x=1);else if("--"===u.substr(0,2))s=(getComputedStyle(t).getPropertyValue(u)+"").trim(),a+="",Se.lastIndex=0,Se.test(s)||(d=Kt(s),p=Kt(a)),p?d!==p&&(s=vn(t,u,s,p)+p):d&&(a+=d),this.add(A,"setProperty",s,a,n,r,0,0,u),E.push(u),S.push(u,0,A[u]);else if("undefined"!==h){if(C&&u in C?(s="function"==typeof C[u]?C[u].call(i,n,t,r):C[u],P(s)&&~s.indexOf("random(")&&(s=le(s)),Kt(s+"")||(s+=y.units[u]||Kt(yn(t,u))||""),"="===(s+"").charAt(1)&&(s=yn(t,u))):s=yn(t,u),l=parseFloat(s),(f="string"===h&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),u in zi&&("autoAlpha"===u&&(1===l&&"hidden"===yn(t,"visibility")&&o&&(l=0),S.push("visibility",0,A.visibility),mn(this,A,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==u&&"transform"!==u&&~(u=zi[u]).indexOf(",")&&(u=u.split(",")[0])),m=u in Di)if(this.styles.save(u),g||((_=t._gsap).renderTransform&&!e.parseTransform||Ln(t,e.parseTransform),v=!1!==e.smoothOrigin&&_.smooth,(g=this._pt=new ci(this._pt,A,$i,0,1,_.renderTransform,_,0,-1)).dep=1),"scale"===u)this._pt=new ci(this._pt,_,"scaleY",_.scaleY,(f?mt(_.scaleY,f+o):o)-_.scaleY||0,Bi),this._pt.u=0,E.push("scaleY",u),u+="X";else{if("transformOrigin"===u){S.push(Qi,0,A[Qi]),b=void 0,T=void 0,w=void 0,b=(M=a).split(" "),T=b[0],w=b[1]||"50%","top"!==T&&"bottom"!==T&&"left"!==w&&"right"!==w||(M=T,T=w,w=M),b[0]=Sn[T]||T,b[1]=Sn[w]||w,a=b.join(" "),_.svg?Pn(t,a,0,v,0,this):((p=parseFloat(a.split(" ")[2])||0)!==_.zOrigin&&mn(this,_,"zOrigin",_.zOrigin,p),mn(this,A,u,Rn(s),Rn(a)));continue}if("svgOrigin"===u){Pn(t,a,1,v,0,this);continue}if(u in wn){zn(this,_,u,l,f?mt(l,f+a):a);continue}if("smoothOrigin"===u){mn(this,_,"smooth",_.smooth,a);continue}if("force3D"===u){_[u]=a;continue}if("transform"===u){Vn(this,a,t);continue}}else u in A||(u=ln(u)||u);if(m||(o||0===o)&&(l||0===l)&&!Fi.test(a)&&u in A)o||(o=0),(d=(s+"").substr((l+"").length))!==(p=Kt(a)||(u in y.units?y.units[u]:d))&&(l=vn(t,u,s,p)),this._pt=new ci(this._pt,m?_:A,u,l,(f?mt(l,f+o):o)-l,m||"px"!==p&&"zIndex"!==u||!1===e.autoRound?Bi:Gi),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=Hi);else if(u in A)xn.call(this,t,u,s,f?f+a:a);else if(u in t)this.add(t,u,s||t[u],f?f+a:a,n,r);else if("parseTransform"!==u)continue;m||(u in A?S.push(u,0,A[u]):S.push(u,1,s||t[u])),E.push(u)}x&&hi(this)},render:function(t,e){if(e.tween._time||!Li())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:yn,aliases:zi,getSetter:function(t,e,i){var n=zi[e];return n&&n.indexOf(",")<0&&(e=n),e in Di&&e!==Qi&&(t._gsap.x||yn(t,"x"))?i&&Pi===i?"scale"===e?Zi:ji:(Pi=i||{})&&("scale"===e?Ki:Ji):t.style&&!D(t.style[e])?qi:~e.indexOf("-")?Yi:ei(t,e)},core:{_removeProperty:fn,_getMatrix:Cn}};bi.utils.checkPrefix=ln,bi.core.getStyleSaver=rn,Wn=dt((Hn="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Gn="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){Di[t]=1})),dt(Gn,(function(t){y.units[t]="deg",wn[t]=1})),zi[Wn[13]]=Hn+","+Gn,dt("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");zi[e[1]]=Wn[e[0]]})),dt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){y.units[t]="px"})),bi.registerPlugin(Xn);var qn=bi.registerPlugin(Xn)||bi;qn.core.Tween;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Yn="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,jn=(t,e,i=null)=>{for(;e!==i;){const i=e.nextSibling;t.removeChild(e),e=i}},Zn=`{{lit-${String(Math.random()).slice(2)}}}`,Kn=`\x3c!--${Zn}--\x3e`,Jn=new RegExp(`${Zn}|${Kn}`),$n="$lit$";class Qn{constructor(t,e){this.parts=[],this.element=e;const i=[],n=[],r=document.createTreeWalker(e.content,133,null,!1);let s=0,a=-1,o=0;const{strings:l,values:{length:h}}=t;for(;o<h;){const t=r.nextNode();if(null!==t){if(a++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:i}=e;let n=0;for(let t=0;t<i;t++)tr(e[t].name,$n)&&n++;for(;n-- >0;){const e=l[o],i=nr.exec(e)[2],n=i.toLowerCase()+$n,r=t.getAttribute(n);t.removeAttribute(n);const s=r.split(Jn);this.parts.push({type:"attribute",index:a,name:i,strings:s}),o+=s.length-1}}"TEMPLATE"===t.tagName&&(n.push(t),r.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(Zn)>=0){const n=t.parentNode,r=e.split(Jn),s=r.length-1;for(let e=0;e<s;e++){let i,s=r[e];if(""===s)i=ir();else{const t=nr.exec(s);null!==t&&tr(t[2],$n)&&(s=s.slice(0,t.index)+t[1]+t[2].slice(0,-5)+t[3]),i=document.createTextNode(s)}n.insertBefore(i,t),this.parts.push({type:"node",index:++a})}""===r[s]?(n.insertBefore(ir(),t),i.push(t)):t.data=r[s],o+=s}}else if(8===t.nodeType)if(t.data===Zn){const e=t.parentNode;null!==t.previousSibling&&a!==s||(a++,e.insertBefore(ir(),t)),s=a,this.parts.push({type:"node",index:a}),null===t.nextSibling?t.data="":(i.push(t),a--),o++}else{let e=-1;for(;-1!==(e=t.data.indexOf(Zn,e+1));)this.parts.push({type:"node",index:-1}),o++}}else r.currentNode=n.pop()}for(const t of i)t.parentNode.removeChild(t)}}const tr=(t,e)=>{const i=t.length-e.length;return i>=0&&t.slice(i)===e},er=t=>-1!==t.index,ir=()=>document.createComment(""),nr=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function rr(t,e){const{element:{content:i},parts:n}=t,r=document.createTreeWalker(i,133,null,!1);let s=ar(n),a=n[s],o=-1,l=0;const h=[];let c=null;for(;r.nextNode();){o++;const t=r.currentNode;for(t.previousSibling===c&&(c=null),e.has(t)&&(h.push(t),null===c&&(c=t)),null!==c&&l++;void 0!==a&&a.index===o;)a.index=null!==c?-1:a.index-l,s=ar(n,s),a=n[s]}h.forEach((t=>t.parentNode.removeChild(t)))}const sr=t=>{let e=11===t.nodeType?0:1;const i=document.createTreeWalker(t,133,null,!1);for(;i.nextNode();)e++;return e},ar=(t,e=-1)=>{for(let i=e+1;i<t.length;i++){const e=t[i];if(er(e))return i}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const or=new WeakMap,lr=t=>"function"==typeof t&&or.has(t),hr={},cr={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class ur{constructor(t,e,i){this.__parts=[],this.template=t,this.processor=e,this.options=i}update(t){let e=0;for(const i of this.__parts)void 0!==i&&i.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=Yn?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],i=this.template.parts,n=document.createTreeWalker(t,133,null,!1);let r,s=0,a=0,o=n.nextNode();for(;s<i.length;)if(r=i[s],er(r)){for(;a<r.index;)a++,"TEMPLATE"===o.nodeName&&(e.push(o),n.currentNode=o.content),null===(o=n.nextNode())&&(n.currentNode=e.pop(),o=n.nextNode());if("node"===r.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(o.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(o,r.name,r.strings,this.options));s++}else this.__parts.push(void 0),s++;return Yn&&(document.adoptNode(t),customElements.upgrade(t)),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const dr=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),pr=` ${Zn} `;class fr{constructor(t,e,i,n){this.strings=t,this.values=e,this.type=i,this.processor=n}getHTML(){const t=this.strings.length-1;let e="",i=!1;for(let n=0;n<t;n++){const t=this.strings[n],r=t.lastIndexOf("\x3c!--");i=(r>-1||i)&&-1===t.indexOf("--\x3e",r+1);const s=nr.exec(t);e+=null===s?t+(i?pr:Kn):t.substr(0,s.index)+s[1]+s[2]+$n+s[3]+Zn}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==dr&&(e=dr.createHTML(e)),t.innerHTML=e,t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const mr=t=>null===t||!("object"==typeof t||"function"==typeof t),gr=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class _r{constructor(t,e,i){this.dirty=!0,this.element=t,this.name=e,this.strings=i,this.parts=[];for(let t=0;t<i.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new vr(this)}_getValue(){const t=this.strings,e=t.length-1,i=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=i[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!gr(t))return t}let n="";for(let r=0;r<e;r++){n+=t[r];const e=i[r];if(void 0!==e){const t=e.value;if(mr(t)||!gr(t))n+="string"==typeof t?t:String(t);else for(const e of t)n+="string"==typeof e?e:String(e)}}return n+=t[e],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class vr{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===hr||mr(t)&&t===this.value||(this.value=t,lr(t)||(this.committer.dirty=!0))}commit(){for(;lr(this.value);){const t=this.value;this.value=hr,t(this)}this.value!==hr&&this.committer.commit()}}class yr{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(ir()),this.endNode=t.appendChild(ir())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=ir()),t.__insert(this.endNode=ir())}insertAfterPart(t){t.__insert(this.startNode=ir()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;lr(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=hr,t(this)}const t=this.__pendingValue;t!==hr&&(mr(t)?t!==this.value&&this.__commitText(t):t instanceof fr?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):gr(t)?this.__commitIterable(t):t===cr?(this.value=cr,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,i="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=i:this.__commitNode(document.createTextNode(i)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof ur&&this.value.template===e)this.value.update(t.values);else{const i=new ur(e,t.processor,this.options),n=i._clone();i.update(t.values),this.__commitNode(n),this.value=i}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let i,n=0;for(const r of t)i=e[n],void 0===i&&(i=new yr(this.options),e.push(i),0===n?i.appendIntoPart(this):i.insertAfterPart(e[n-1])),i.setValue(r),i.commit(),n++;n<e.length&&(e.length=n,this.clear(i&&i.endNode))}clear(t=this.startNode){jn(this.startNode.parentNode,t.nextSibling,this.endNode)}}class xr{constructor(t,e,i){if(this.value=void 0,this.__pendingValue=void 0,2!==i.length||""!==i[0]||""!==i[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=i}setValue(t){this.__pendingValue=t}commit(){for(;lr(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=hr,t(this)}if(this.__pendingValue===hr)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=hr}}class Sr extends _r{constructor(t,e,i){super(t,e,i),this.single=2===i.length&&""===i[0]&&""===i[1]}_createPart(){return new Mr(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class Mr extends vr{}let br=!1;(()=>{try{const t={get capture(){return br=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class Tr{constructor(t,e,i){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=i,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;lr(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=hr,t(this)}if(this.__pendingValue===hr)return;const t=this.__pendingValue,e=this.value,i=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),n=null!=t&&(null==e||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),n&&(this.__options=wr(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=hr}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const wr=t=>t&&(br?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
function Er(t){let e=Ar.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},Ar.set(t.type,e));let i=e.stringsArray.get(t.strings);if(void 0!==i)return i;const n=t.strings.join(Zn);return i=e.keyString.get(n),void 0===i&&(i=new Qn(t,t.getTemplateElement()),e.keyString.set(n,i)),e.stringsArray.set(t.strings,i),i}const Ar=new Map,Cr=new WeakMap;const Pr=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{handleAttributeExpressions(t,e,i,n){const r=e[0];if("."===r){return new Sr(t,e.slice(1),i).parts}if("@"===r)return[new Tr(t,e.slice(1),n.eventContext)];if("?"===r)return[new xr(t,e.slice(1),i)];return new _r(t,e,i).parts}handleTextExpression(t){return new yr(t)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const Lr=(t,...e)=>new fr(t,e,"html",Pr),Rr=(t,e)=>`${t}--${e}`;let Dr=!0;(void 0===window.ShadyCSS||void 0===window.ShadyCSS.prepareTemplateDom)&&(Dr=!1);const Ir=t=>e=>{const i=Rr(e.type,t);let n=Ar.get(i);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},Ar.set(i,n));let r=n.stringsArray.get(e.strings);if(void 0!==r)return r;const s=e.strings.join(Zn);if(r=n.keyString.get(s),void 0===r){const i=e.getTemplateElement();Dr&&window.ShadyCSS.prepareTemplateDom(i,t),r=new Qn(e,i),n.keyString.set(s,r)}return n.stringsArray.set(e.strings,r),r},Ur=["html","svg"],Nr=new Set,Or=(t,e,i)=>{Nr.add(t);const n=i?i.element:document.createElement("template"),r=e.querySelectorAll("style"),{length:s}=r;if(0===s)return void window.ShadyCSS.prepareTemplateStyles(n,t);const a=document.createElement("style");for(let t=0;t<s;t++){const e=r[t];e.parentNode.removeChild(e),a.textContent+=e.textContent}(t=>{Ur.forEach((e=>{const i=Ar.get(Rr(e,t));void 0!==i&&i.keyString.forEach((t=>{const{element:{content:e}}=t,i=new Set;Array.from(e.querySelectorAll("style")).forEach((t=>{i.add(t)})),rr(t,i)}))}))})(t);const o=n.content;i?function(t,e,i=null){const{element:{content:n},parts:r}=t;if(null==i)return void n.appendChild(e);const s=document.createTreeWalker(n,133,null,!1);let a=ar(r),o=0,l=-1;for(;s.nextNode();)for(l++,s.currentNode===i&&(o=sr(e),i.parentNode.insertBefore(e,i));-1!==a&&r[a].index===l;){if(o>0){for(;-1!==a;)r[a].index+=o,a=ar(r,a);return}a=ar(r,a)}}(i,a,o.firstChild):o.insertBefore(a,o.firstChild),window.ShadyCSS.prepareTemplateStyles(n,t);const l=o.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)e.insertBefore(l.cloneNode(!0),e.firstChild);else if(i){o.insertBefore(a,o.firstChild);const t=new Set;t.add(a),rr(i,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const kr={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},Fr=(t,e)=>e!==t&&(e==e||t==t),zr={attribute:!0,type:String,converter:kr,reflect:!1,hasChanged:Fr},Br="finalized";class Vr extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach(((e,i)=>{const n=this._attributeNameForProperty(i,e);void 0!==n&&(this._attributeToPropertyMap.set(n,i),t.push(n))})),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(((t,e)=>this._classProperties.set(e,t)))}}static createProperty(t,e=zr){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const i="symbol"==typeof t?Symbol():`__${t}`,n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(n){const r=this[t];this[e]=n,this.requestUpdateInternal(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||zr}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty(Br)||t.finalize(),this[Br]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const i of e)this.createProperty(i,t[i])}}static _attributeNameForProperty(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,i=Fr){return i(t,e)}static _propertyValueFromAttribute(t,e){const i=e.type,n=e.converter||kr,r="function"==typeof n?n:n.fromAttribute;return r?r(t,i):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const i=e.type,n=e.converter;return(n&&n.toAttribute||kr.toAttribute)(t,i)}initialize(){this._updateState=0,this._updatePromise=new Promise((t=>this._enableUpdatingResolver=t)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((t,e)=>this[e]=t)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,i){e!==i&&this._attributeToProperty(t,i)}_propertyToAttribute(t,e,i=zr){const n=this.constructor,r=n._attributeNameForProperty(t,i);if(void 0!==r){const t=n._propertyValueToAttribute(e,i);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(r):this.setAttribute(r,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const i=this.constructor,n=i._attributeToPropertyMap.get(t);if(void 0!==n){const t=i.getPropertyOptions(n);this._updateState=16|this._updateState,this[n]=i._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,i){let n=!0;if(void 0!==t){const r=this.constructor;i=i||r.getPropertyOptions(t),r._valueHasChanged(this[t],e,i.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,i))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((t,e)=>this._propertyToAttribute(e,this[e],t))),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}Vr[Br]=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Hr=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:n}=e;return{kind:i,elements:n,finisher(e){window.customElements.define(t,e)}}})(t,e),Gr=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(i){i.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}},Wr=(t,e,i)=>{e.constructor.createProperty(i,t)};function Xr(t){return(e,i)=>void 0!==i?Wr(t,e,i):Gr(t,e)}const qr=Element.prototype;qr.msMatchesSelector||qr.webkitMatchesSelector;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Yr=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,jr=Symbol();class Zr{constructor(t,e){if(e!==jr)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(Yr?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const Kr={};class Jr extends Vr{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,i)=>t.reduceRight(((t,i)=>Array.isArray(i)?e(i,t):(t.add(i),t)),i),i=e(t,new Set),n=[];i.forEach((t=>n.unshift(t))),this._styles=n}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map((t=>{if(t instanceof CSSStyleSheet&&!Yr){const e=Array.prototype.slice.call(t.cssRules).reduce(((t,e)=>t+e.cssText),"");return new Zr(String(e),jr)}return t}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Yr?this.renderRoot.adoptedStyleSheets=t.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map((t=>t.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==Kr&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)})))}render(){return Kr}}Jr.finalized=!0,Jr.render=(t,e,i)=>{if(!i||"object"!=typeof i||!i.scopeName)throw new Error("The `scopeName` option is required.");const n=i.scopeName,r=Cr.has(e),s=Dr&&11===e.nodeType&&!!e.host,a=s&&!Nr.has(n),o=a?document.createDocumentFragment():e;if(((t,e,i)=>{let n=Cr.get(e);void 0===n&&(jn(e,e.firstChild),Cr.set(e,n=new yr(Object.assign({templateFactory:Er},i))),n.appendInto(e)),n.setValue(t),n.commit()})(t,o,Object.assign({templateFactory:Ir(n)},i)),a){const t=Cr.get(o);Cr.delete(o);const i=t.value instanceof ur?t.value.template:void 0;Or(n,o,i),jn(e,e.firstChild),e.appendChild(o),Cr.set(e,t)}!r&&s&&window.ShadyCSS.styleElement(e.host)},Jr.shadowRootOptions={mode:"open"};class $r extends Jr{firstUpdated(t){this.setAttribute("data-resolved",""),super.firstUpdated(t)}createRenderRoot(){return this}}customElements.define("myth-page",class extends $r{animateIn(){this.querySelector("close-button"),this.querySelector(".page-inner");this.querySelector("myth-hero").animateIn();const t=this.querySelector(".page-modules");qn.fromTo(t,{y:100,opacity:0},{y:0,opacity:1,duration:1.2,ease:"power3.out",delay:.9})}});var Qr=function(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};let ts=class extends $r{constructor(){super(...arguments),this._switchTimeline=null,this._currentModeLink="#grid",this.timelineTween=null,this.setMode=(t,e=!1)=>{var i,n,r,s,a,o,l;this._currentMode!==t&&(null===(i=this.timelineTween)||void 0===i||i.kill(),this.timelineTween=null,"stack"===t?(null===(n=this.switch)||void 0===n||n.classList.remove("grid-mode-active"),null===(r=this.switch)||void 0===r||r.setAttribute("aria-label","Select grid layout"),this._switchTimeline.paused(!0),null===(s=this.hoverTween)||void 0===s||s.kill(),qn.to(this.switchSideHoverWrappers[0],{rotation:"0deg",scaleX:1,scaleY:1,ease:"power1.inout",duration:.4}),e?this._switchTimeline.progress(0,!1).pause():this.timelineTween=qn.to(this._switchTimeline,{progress:0,duration:1,ease:"none"}),this._currentModeLink="#grid"):"grid"===t&&(e?this._switchTimeline.progress(1,!1).pause():this._switchTimeline.play(),null===(a=this.hoverTween)||void 0===a||a.kill(),qn.to(this.switchSideHoverWrappers[1],{rotation:"90deg",scaleX:1,scaleY:1,ease:"power1.inout",duration:.4}),null===(o=this.switch)||void 0===o||o.classList.add("grid-mode-active"),null===(l=this.switch)||void 0===l||l.setAttribute("aria-label","Select stack layout"),this._currentModeLink="/"+this._router.getHashUrlForCardIndex(this._galleryLayout.currCardIndex)),this._currentMode=t)},this.setGalleryRouterAndLayout=(t,e)=>{this._router=t,this._galleryLayout=e},this.completeTransition=()=>{var t,e;null===(t=this.timelineTween)||void 0===t||t.kill(),this.timelineTween=null,null===(e=this._switchTimeline)||void 0===e||e.progress("grid"===this._currentMode?1:0,!1).pause()},this.calcScaleTo=()=>{this.scaleTo=Math.max(window.innerWidth,window.innerHeight)/150+2},this.resetAnimationCircles=()=>{}}firstUpdated(t){super.firstUpdated(t),this.switch=this.querySelector(".switch"),this.switchSideHoverWrappers=Array.from(this.querySelectorAll(".switch-mode")),this.animationCircles=Array.from(this.querySelectorAll(".switch-circleAnimation")),this.icons=Array.from(this.querySelectorAll(".mode-icon")),this.iconBGs=Array.from(this.querySelectorAll(".mode-icon-bg")),this.setupCirclesAnimation(),window.addEventListener("resize",this.calcScaleTo)}onHover(){var t;null===(t=this.hoverTween)||void 0===t||t.kill(),"grid"!==this._currentMode?this.hoverTween=qn.to(this.switchSideHoverWrappers[1],{rotation:"90deg",ease:"power1.inout",scaleX:1.2,scaleY:1.2,duration:.5}):this.hoverTween=qn.to(this.switchSideHoverWrappers[0],{rotation:"10deg",scaleX:.6,scaleY:.6,ease:"power1.inout",duration:.5})}onLeave(){var t;null===(t=this.hoverTween)||void 0===t||t.kill(),"grid"!==this._currentMode?this.hoverTween=qn.to(this.switchSideHoverWrappers[1],{rotation:"0deg",scaleX:1,scaleY:1,ease:"power1.inout",duration:.5}):this.hoverTween=qn.to(this.switchSideHoverWrappers[0],{rotation:"0deg",scaleX:1,scaleY:1,ease:"power1.inout",duration:.5})}setupCirclesAnimation(){this._switchTimeline=qn.timeline({paused:!0}),this.calcScaleTo();var t=.3,e=.3;this._switchTimeline.to(this.icons[1],{scaleX:0,scaleY:0,duration:.15},0),this._switchTimeline.set(this.icons[1].querySelectorAll(".dot"),{background:"#000000"},t),this._switchTimeline.set(this.icons[1],{scaleX:1,scaleY:1},t),this._switchTimeline.to(this.iconBGs[0],{scaleX:0,scaleY:0,duration:e,ease:"power2.in"},0),this._switchTimeline.to(this.iconBGs[1],{scaleX:1,scaleY:1,duration:.5,ease:"power2.out"},t),this._switchTimeline.to(this.icons[0],{scaleX:0,scaleY:0,duration:e},0),this._switchTimeline.to(this.icons[0],{scaleX:1,rotation:"0deg",scaleY:1,duration:.4,ease:"power2.inOut"},.4),this._switchTimeline.set(this.icons[0],{background:"#ffffff"},.3),this._switchTimeline.set(this.animationCircles,{scaleX:.12,scaleY:.12,force3D:!0},0),this.animationCircles.forEach(((t,e)=>{var i=t,n={value:0};this._switchTimeline.fromTo(n,{value:0},{value:1,duration:1.5-.07*e,ease:"power2.inOut",onUpdate:()=>{var t=qn.utils.interpolate(.12,this.scaleTo,n.value);qn.set(i,{scaleX:t,scaleY:t,force3D:!0})}},.05+.12*e-.025*e)})),this._switchTimeline.set(this.animationCircles,{scaleX:.12,scaleY:.12,force3D:!0})}render(){return Lr` <div class="switch-circleAnimation"></div>
            <div class="switch-circleAnimation"></div>
            <div class="switch-circleAnimation"></div>
            <div class="switch-circleAnimation"></div>
            <a href="${this._currentModeLink}" class="switch" role="button" aria-label="Select ${"#grid"===this._currentModeLink?"grid":"stack"} layout" @mouseenter="${this.onHover}" @mouseleave="${this.onLeave}">
                <div class="switch-mode stack-mode">
                    <div class="mode-icon-bg"></div>
                    <span class="mode-icon"></span>
                </div>
                <div class="switch-mode grid-mode">
                    <div class="mode-icon-bg"></div>
                    <span class="mode-icon">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </span>
                </div>
            </a>`}};Qr([Xr({type:String})],ts.prototype,"_currentModeLink",void 0),ts=Qr([Hr("myth-layout-toggle")],ts);
/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const es="157",is=1,ns=2,rs=3,ss=0,as=1,os=100,ls=0,hs=1,cs=2,us=0,ds=1,ps=2,fs=3,ms=4,gs=5,_s=301,vs=302,ys=303,xs=304,Ss=306,Ms=1e3,bs=1001,Ts=1002,ws=1003,Es=1004,As=1005,Cs=1006,Ps=1008,Ls=1009,Rs=1012,Ds=1013,Is=1014,Us=1015,Ns=1016,Os=1020,ks=1023,Fs=1026,zs=1027,Bs=33776,Vs=33777,Hs=33778,Gs=33779,Ws=36492,Xs=2300,qs=2301,Ys=2302,js=2400,Zs=2401,Ks=2402,Js=3e3,$s=3001,Qs="",ta="srgb",ea="srgb-linear",ia="display-p3",na="display-p3-linear",ra="linear",sa="srgb",aa="rec709",oa="p3",la=7680,ha=35044,ca="300 es",ua=1035,da=2e3,pa=2001;class fa{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const i=this._listeners[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const i=e.slice(0);for(let e=0,n=i.length;e<n;e++)i[e].call(this,t);t.target=null}}}const ma=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ga=1234567;const _a=Math.PI/180,va=180/Math.PI;function ya(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(ma[255&t]+ma[t>>8&255]+ma[t>>16&255]+ma[t>>24&255]+"-"+ma[255&e]+ma[e>>8&255]+"-"+ma[e>>16&15|64]+ma[e>>24&255]+"-"+ma[63&i|128]+ma[i>>8&255]+"-"+ma[i>>16&255]+ma[i>>24&255]+ma[255&n]+ma[n>>8&255]+ma[n>>16&255]+ma[n>>24&255]).toLowerCase()}function xa(t,e,i){return Math.max(e,Math.min(i,t))}function Sa(t,e){return(t%e+e)%e}function Ma(t,e,i){return(1-i)*t+i*e}function ba(t){return 0==(t&t-1)&&0!==t}function Ta(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function wa(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Ea(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Aa(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const Ca={DEG2RAD:_a,RAD2DEG:va,generateUUID:ya,clamp:xa,euclideanModulo:Sa,mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},inverseLerp:function(t,e,i){return t!==e?(i-t)/(e-t):0},lerp:Ma,damp:function(t,e,i,n){return Ma(t,e,1-Math.exp(-i*n))},pingpong:function(t,e=1){return e-Math.abs(Sa(t,2*e)-e)},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(ga=t);let e=ga+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*_a},radToDeg:function(t){return t*va},isPowerOfTwo:ba,ceilPowerOfTwo:Ta,floorPowerOfTwo:wa,setQuaternionFromProperEuler:function(t,e,i,n,r){const s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),h=s((e+n)/2),c=a((e+n)/2),u=s((e-n)/2),d=a((e-n)/2),p=s((n-e)/2),f=a((n-e)/2);switch(r){case"XYX":t.set(o*c,l*u,l*d,o*h);break;case"YZY":t.set(l*d,o*c,l*u,o*h);break;case"ZXZ":t.set(l*u,l*d,o*c,o*h);break;case"XZX":t.set(o*c,l*f,l*p,o*h);break;case"YXY":t.set(l*p,o*c,l*f,o*h);break;case"ZYZ":t.set(l*f,l*p,o*c,o*h)}},normalize:Aa,denormalize:Ea};class Pa{constructor(t=0,e=0){Pa.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(xa(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*i-s*n+t.x,this.y=r*n+s*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class La{constructor(t,e,i,n,r,s,a,o,l){La.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,i,n,r,s,a,o,l)}set(t,e,i,n,r,s,a,o,l){const h=this.elements;return h[0]=t,h[1]=n,h[2]=a,h[3]=e,h[4]=r,h[5]=o,h[6]=i,h[7]=s,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,s=i[0],a=i[3],o=i[6],l=i[1],h=i[4],c=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],_=n[1],v=n[4],y=n[7],x=n[2],S=n[5],M=n[8];return r[0]=s*f+a*_+o*x,r[3]=s*m+a*v+o*S,r[6]=s*g+a*y+o*M,r[1]=l*f+h*_+c*x,r[4]=l*m+h*v+c*S,r[7]=l*g+h*y+c*M,r[2]=u*f+d*_+p*x,r[5]=u*m+d*v+p*S,r[8]=u*g+d*y+p*M,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8];return e*s*h-e*a*l-i*r*h+i*a*o+n*r*l-n*s*o}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=h*s-a*l,u=a*o-h*r,d=l*r-s*o,p=e*c+i*u+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=c*f,t[1]=(n*l-h*i)*f,t[2]=(a*i-n*s)*f,t[3]=u*f,t[4]=(h*e-n*o)*f,t[5]=(n*r-a*e)*f,t[6]=d*f,t[7]=(i*o-l*e)*f,t[8]=(s*e-i*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(i*o,i*l,-i*(o*s+l*a)+s+t,-n*l,n*o,-n*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Ra.makeScale(t,e)),this}rotate(t){return this.premultiply(Ra.makeRotation(-t)),this}translate(t,e){return this.premultiply(Ra.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<9;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Ra=new La;function Da(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Ia(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Ua(){const t=Ia("canvas");return t.style.display="block",t}const Na={};function Oa(t){t in Na||(Na[t]=!0)}const ka=(new La).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Fa=(new La).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),za={[ea]:{transfer:ra,primaries:aa,toReference:t=>t,fromReference:t=>t},[ta]:{transfer:sa,primaries:aa,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[na]:{transfer:ra,primaries:oa,toReference:t=>t.applyMatrix3(Fa),fromReference:t=>t.applyMatrix3(ka)},[ia]:{transfer:sa,primaries:oa,toReference:t=>t.convertSRGBToLinear().applyMatrix3(Fa),fromReference:t=>t.applyMatrix3(ka).convertLinearToSRGB()}},Ba=new Set([ea,na]),Va={enabled:!0,_workingColorSpace:ea,get legacyMode(){return!this.enabled},set legacyMode(t){this.enabled=!t},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Ba.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,i){if(!1===this.enabled||e===i||!e||!i)return t;const n=za[e].toReference;return(0,za[i].fromReference)(n(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return za[t].primaries},getTransfer:function(t){return t===Qs?ra:za[t].transfer}};function Ha(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ga(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let Wa;class Xa{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Wa&&(Wa=Ia("canvas")),Wa.width=t.width,Wa.height=t.height;const i=Wa.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=Wa}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Ia("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);const n=i.getImageData(0,0,t.width,t.height),r=n.data;for(let t=0;t<r.length;t++)r[t]=255*Ha(r[t]/255);return i.putImageData(n,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Ha(e[t]/255)):e[t]=Ha(e[t]);return{data:e,width:t.width,height:t.height}}return t}}let qa=0;class Ya{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qa++}),this.uuid=ya(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let t;if(Array.isArray(n)){t=[];for(let e=0,i=n.length;e<i;e++)n[e].isDataTexture?t.push(ja(n[e].image)):t.push(ja(n[e]))}else t=ja(n);i.url=t}return e||(t.images[this.uuid]=i),i}}function ja(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Xa.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}let Za=0;class Ka extends fa{constructor(t=Ka.DEFAULT_IMAGE,e=Ka.DEFAULT_MAPPING,i=1001,n=1001,r=1006,s=1008,a=1023,o=1009,l=Ka.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Za++}),this.uuid=ya(),this.name="",this.source=new Ya(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Pa(0,0),this.repeat=new Pa(1,1),this.center=new Pa(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new La,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(Oa("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===$s?ta:Qs),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ms:t.x=t.x-Math.floor(t.x);break;case bs:t.x=t.x<0?0:1;break;case Ts:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ms:t.y=t.y-Math.floor(t.y);break;case bs:t.y=t.y<0?0:1;break;case Ts:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Oa("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===ta?$s:Js}set encoding(t){Oa("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===$s?ta:Qs}}Ka.DEFAULT_IMAGE=null,Ka.DEFAULT_MAPPING=300,Ka.DEFAULT_ANISOTROPY=1;class Ja{constructor(t=0,e=0,i=0,n=1){Ja.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*e+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*e+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*e+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,r;const s=.01,a=.1,o=t.elements,l=o[0],h=o[4],c=o[8],u=o[1],d=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(h-u)<s&&Math.abs(c-f)<s&&Math.abs(p-m)<s){if(Math.abs(h+u)<a&&Math.abs(c+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,_=(g+1)/2,v=(h+u)/4,y=(c+f)/4,x=(p+m)/4;return t>o&&t>_?t<s?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(t),n=v/i,r=y/i):o>_?o<s?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(o),i=v/n,r=x/n):_<s?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(_),i=y/r,n=x/r),this.set(i,n,r,e),this}let _=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(u-h)*(u-h));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(c-f)/_,this.z=(u-h)/_,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $a extends fa{constructor(t=1,e=1,i={}){super(),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Ja(0,0,t,e),this.scissorTest=!1,this.viewport=new Ja(0,0,t,e);const n={width:t,height:e,depth:1};void 0!==i.encoding&&(Oa("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===$s?ta:Qs),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Cs,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Ka(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(t,e,i=1){this.width===t&&this.height===e&&this.depth===i||(this.width=t,this.height=e,this.depth=i,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new Ya(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Qa extends $a{constructor(t=1,e=1,i={}){super(t,e,i),this.isWebGLRenderTarget=!0}}class to extends Ka{constructor(t=null,e=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=ws,this.minFilter=ws,this.wrapR=bs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eo extends Ka{constructor(t=null,e=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=ws,this.minFilter=ws,this.wrapR=bs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class io{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,r,s,a){let o=i[n+0],l=i[n+1],h=i[n+2],c=i[n+3];const u=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return t[e+0]=o,t[e+1]=l,t[e+2]=h,void(t[e+3]=c);if(1===a)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(c!==f||o!==u||l!==d||h!==p){let t=1-a;const e=o*u+l*d+h*p+c*f,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const r=Math.sqrt(n),s=Math.atan2(r,e*i);t=Math.sin(t*s)/r,a=Math.sin(a*s)/r}const r=a*i;if(o=o*t+u*r,l=l*t+d*r,h=h*t+p*r,c=c*t+f*r,t===1-a){const t=1/Math.sqrt(o*o+l*l+h*h+c*c);o*=t,l*=t,h*=t,c*=t}}t[e]=o,t[e+1]=l,t[e+2]=h,t[e+3]=c}static multiplyQuaternionsFlat(t,e,i,n,r,s){const a=i[n],o=i[n+1],l=i[n+2],h=i[n+3],c=r[s],u=r[s+1],d=r[s+2],p=r[s+3];return t[e]=a*p+h*c+o*d-l*u,t[e+1]=o*p+h*u+l*c-a*d,t[e+2]=l*p+h*d+a*u-o*c,t[e+3]=h*p-a*c-o*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const i=t._x,n=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(i/2),h=a(n/2),c=a(r/2),u=o(i/2),d=o(n/2),p=o(r/2);switch(s){case"XYZ":this._x=u*h*c+l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c-u*d*p;break;case"YXZ":this._x=u*h*c+l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c+u*d*p;break;case"ZXY":this._x=u*h*c-l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c-u*d*p;break;case"ZYX":this._x=u*h*c-l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c+u*d*p;break;case"YZX":this._x=u*h*c+l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c-u*d*p;break;case"XZY":this._x=u*h*c-l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c+u*d*p}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],r=e[8],s=e[1],a=e[5],o=e[9],l=e[2],h=e[6],c=e[10],u=i+a+c;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(h-o)*t,this._y=(r-l)*t,this._z=(s-n)*t}else if(i>a&&i>c){const t=2*Math.sqrt(1+i-a-c);this._w=(h-o)/t,this._x=.25*t,this._y=(n+s)/t,this._z=(r+l)/t}else if(a>c){const t=2*Math.sqrt(1+a-i-c);this._w=(r-l)/t,this._x=(n+s)/t,this._y=.25*t,this._z=(o+h)/t}else{const t=2*Math.sqrt(1+c-i-a);this._w=(s-n)/t,this._x=(r+l)/t,this._y=(o+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(xa(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,r=t._z,s=t._w,a=e._x,o=e._y,l=e._z,h=e._w;return this._x=i*h+s*a+n*l-r*o,this._y=n*h+s*o+r*a-i*l,this._z=r*h+s*l+i*o-n*a,this._w=s*h-i*a-n*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,r=this._z,s=this._w;let a=s*t._w+i*t._x+n*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(o),h=Math.atan2(l,a),c=Math.sin((1-e)*h)/l,u=Math.sin(e*h)/l;return this._w=s*c+this._w*u,this._x=i*c+this._x*u,this._y=n*c+this._y*u,this._z=r*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(r),i*Math.cos(r),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class no{constructor(t=0,e=0,i=0){no.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(so.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(so.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=t.elements,s=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,a=t.z,o=t.w,l=o*e+s*n-a*i,h=o*i+a*e-r*n,c=o*n+r*i-s*e,u=-r*e-s*i-a*n;return this.x=l*o+u*-r+h*-a-c*-s,this.y=h*o+u*-s+c*-r-l*-a,this.z=c*o+u*-a+l*-s-h*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=n*o-r*a,this.y=r*s-i*o,this.z=i*a-n*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return ro.copy(this).projectOnVector(t),this.sub(ro)}reflect(t){return this.sub(ro.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(xa(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ro=new no,so=new io;class ao{constructor(t=new no(1/0,1/0,1/0),e=new no(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e+=3)this.expandByPoint(lo.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,i=t.count;e<i;e++)this.expandByPoint(lo.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=lo.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),void 0!==t.boundingBox)null===t.boundingBox&&t.computeBoundingBox(),ho.copy(t.boundingBox),ho.applyMatrix4(t.matrixWorld),this.union(ho);else{const i=t.geometry;if(void 0!==i)if(e&&void 0!==i.attributes&&void 0!==i.attributes.position){const e=i.attributes.position;for(let i=0,n=e.count;i<n;i++)lo.fromBufferAttribute(e,i).applyMatrix4(t.matrixWorld),this.expandByPoint(lo)}else null===i.boundingBox&&i.computeBoundingBox(),ho.copy(i.boundingBox),ho.applyMatrix4(t.matrixWorld),this.union(ho)}const i=t.children;for(let t=0,n=i.length;t<n;t++)this.expandByObject(i[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,lo),lo.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(_o),vo.subVectors(this.max,_o),co.subVectors(t.a,_o),uo.subVectors(t.b,_o),po.subVectors(t.c,_o),fo.subVectors(uo,co),mo.subVectors(po,uo),go.subVectors(co,po);let e=[0,-fo.z,fo.y,0,-mo.z,mo.y,0,-go.z,go.y,fo.z,0,-fo.x,mo.z,0,-mo.x,go.z,0,-go.x,-fo.y,fo.x,0,-mo.y,mo.x,0,-go.y,go.x,0];return!!So(e,co,uo,po,vo)&&(e=[1,0,0,0,1,0,0,0,1],!!So(e,co,uo,po,vo)&&(yo.crossVectors(fo,mo),e=[yo.x,yo.y,yo.z],So(e,co,uo,po,vo)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,lo).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(lo).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(oo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),oo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),oo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),oo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),oo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),oo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),oo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),oo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(oo)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const oo=[new no,new no,new no,new no,new no,new no,new no,new no],lo=new no,ho=new ao,co=new no,uo=new no,po=new no,fo=new no,mo=new no,go=new no,_o=new no,vo=new no,yo=new no,xo=new no;function So(t,e,i,n,r){for(let s=0,a=t.length-3;s<=a;s+=3){xo.fromArray(t,s);const a=r.x*Math.abs(xo.x)+r.y*Math.abs(xo.y)+r.z*Math.abs(xo.z),o=e.dot(xo),l=i.dot(xo),h=n.dot(xo);if(Math.max(-Math.max(o,l,h),Math.min(o,l,h))>a)return!1}return!0}const Mo=new ao,bo=new no,To=new no;class wo{constructor(t=new no,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;void 0!==e?i.copy(e):Mo.setFromPoints(t).getCenter(i);let n=0;for(let e=0,r=t.length;e<r;e++)n=Math.max(n,i.distanceToSquared(t[e]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;bo.subVectors(t,this.center);const e=bo.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),i=.5*(t-this.radius);this.center.addScaledVector(bo,i/t),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(To.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(bo.copy(t.center).add(To)),this.expandByPoint(bo.copy(t.center).sub(To))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Eo=new no,Ao=new no,Co=new no,Po=new no,Lo=new no,Ro=new no,Do=new no;class Io{constructor(t=new no,e=new no(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Eo)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Eo.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Eo.copy(this.origin).addScaledVector(this.direction,e),Eo.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){Ao.copy(t).add(e).multiplyScalar(.5),Co.copy(e).sub(t).normalize(),Po.copy(this.origin).sub(Ao);const r=.5*t.distanceTo(e),s=-this.direction.dot(Co),a=Po.dot(this.direction),o=-Po.dot(Co),l=Po.lengthSq(),h=Math.abs(1-s*s);let c,u,d,p;if(h>0)if(c=s*o-a,u=s*a-o,p=r*h,c>=0)if(u>=-p)if(u<=p){const t=1/h;c*=t,u*=t,d=c*(c+s*u+2*a)+u*(s*c+u+2*o)+l}else u=r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;else u=-r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;else u<=-p?(c=Math.max(0,-(-s*r+a)),u=c>0?-r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l):u<=p?(c=0,u=Math.min(Math.max(-r,-o),r),d=u*(u+2*o)+l):(c=Math.max(0,-(s*r+a)),u=c>0?r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l);else u=s>0?-r:r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,c),n&&n.copy(Ao).addScaledVector(Co,u),d}intersectSphere(t,e){Eo.subVectors(t.center,this.origin);const i=Eo.dot(this.direction),n=Eo.dot(Eo)-i*i,r=t.radius*t.radius;if(n>r)return null;const s=Math.sqrt(r-n),a=i-s,o=i+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return null===i?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,s,a,o;const l=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),h>=0?(r=(t.min.y-u.y)*h,s=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,s=(t.min.y-u.y)*h),i>s||r>n?null:((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),c>=0?(a=(t.min.z-u.z)*c,o=(t.max.z-u.z)*c):(a=(t.max.z-u.z)*c,o=(t.min.z-u.z)*c),i>o||a>n?null:((a>i||i!=i)&&(i=a),(o<n||n!=n)&&(n=o),n<0?null:this.at(i>=0?i:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,Eo)}intersectTriangle(t,e,i,n,r){Lo.subVectors(e,t),Ro.subVectors(i,t),Do.crossVectors(Lo,Ro);let s,a=this.direction.dot(Do);if(a>0){if(n)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Po.subVectors(this.origin,t);const o=s*this.direction.dot(Ro.crossVectors(Po,Ro));if(o<0)return null;const l=s*this.direction.dot(Lo.cross(Po));if(l<0)return null;if(o+l>a)return null;const h=-s*Po.dot(Do);return h<0?null:this.at(h/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Uo{constructor(t,e,i,n,r,s,a,o,l,h,c,u,d,p,f,m){Uo.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,i,n,r,s,a,o,l,h,c,u,d,p,f,m)}set(t,e,i,n,r,s,a,o,l,h,c,u,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Uo).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/No.setFromMatrixColumn(t,0).length(),r=1/No.setFromMatrixColumn(t,1).length(),s=1/No.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,i=t.x,n=t.y,r=t.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(n),l=Math.sin(n),h=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){const t=s*h,i=s*c,n=a*h,r=a*c;e[0]=o*h,e[4]=-o*c,e[8]=l,e[1]=i+n*l,e[5]=t-r*l,e[9]=-a*o,e[2]=r-t*l,e[6]=n+i*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*h,i=o*c,n=l*h,r=l*c;e[0]=t+r*a,e[4]=n*a-i,e[8]=s*l,e[1]=s*c,e[5]=s*h,e[9]=-a,e[2]=i*a-n,e[6]=r+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*h,i=o*c,n=l*h,r=l*c;e[0]=t-r*a,e[4]=-s*c,e[8]=n+i*a,e[1]=i+n*a,e[5]=s*h,e[9]=r-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*h,i=s*c,n=a*h,r=a*c;e[0]=o*h,e[4]=n*l-i,e[8]=t*l+r,e[1]=o*c,e[5]=r*l+t,e[9]=i*l-n,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,i=s*l,n=a*o,r=a*l;e[0]=o*h,e[4]=r-t*c,e[8]=n*c+i,e[1]=c,e[5]=s*h,e[9]=-a*h,e[2]=-l*h,e[6]=i*c+n,e[10]=t-r*c}else if("XZY"===t.order){const t=s*o,i=s*l,n=a*o,r=a*l;e[0]=o*h,e[4]=-c,e[8]=l*h,e[1]=t*c+r,e[5]=s*h,e[9]=i*c-n,e[2]=n*c-i,e[6]=a*h,e[10]=r*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(ko,t,Fo)}lookAt(t,e,i){const n=this.elements;return Vo.subVectors(t,e),0===Vo.lengthSq()&&(Vo.z=1),Vo.normalize(),zo.crossVectors(i,Vo),0===zo.lengthSq()&&(1===Math.abs(i.z)?Vo.x+=1e-4:Vo.z+=1e-4,Vo.normalize(),zo.crossVectors(i,Vo)),zo.normalize(),Bo.crossVectors(Vo,zo),n[0]=zo.x,n[4]=Bo.x,n[8]=Vo.x,n[1]=zo.y,n[5]=Bo.y,n[9]=Vo.y,n[2]=zo.z,n[6]=Bo.z,n[10]=Vo.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,s=i[0],a=i[4],o=i[8],l=i[12],h=i[1],c=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],_=i[3],v=i[7],y=i[11],x=i[15],S=n[0],M=n[4],b=n[8],T=n[12],w=n[1],E=n[5],A=n[9],C=n[13],P=n[2],L=n[6],R=n[10],D=n[14],I=n[3],U=n[7],N=n[11],O=n[15];return r[0]=s*S+a*w+o*P+l*I,r[4]=s*M+a*E+o*L+l*U,r[8]=s*b+a*A+o*R+l*N,r[12]=s*T+a*C+o*D+l*O,r[1]=h*S+c*w+u*P+d*I,r[5]=h*M+c*E+u*L+d*U,r[9]=h*b+c*A+u*R+d*N,r[13]=h*T+c*C+u*D+d*O,r[2]=p*S+f*w+m*P+g*I,r[6]=p*M+f*E+m*L+g*U,r[10]=p*b+f*A+m*R+g*N,r[14]=p*T+f*C+m*D+g*O,r[3]=_*S+v*w+y*P+x*I,r[7]=_*M+v*E+y*L+x*U,r[11]=_*b+v*A+y*R+x*N,r[15]=_*T+v*C+y*D+x*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],s=t[1],a=t[5],o=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+r*o*c-n*l*c-r*a*u+i*l*u+n*a*d-i*o*d)+t[7]*(+e*o*d-e*l*u+r*s*u-n*s*d+n*l*h-r*o*h)+t[11]*(+e*l*c-e*a*d-r*s*c+i*s*d+r*a*h-i*l*h)+t[15]*(-n*a*h-e*o*c+e*a*u+n*s*c-i*s*u+i*o*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],_=c*m*l-f*u*l+f*o*d-a*m*d-c*o*g+a*u*g,v=p*u*l-h*m*l-p*o*d+s*m*d+h*o*g-s*u*g,y=h*f*l-p*c*l+p*a*d-s*f*d-h*a*g+s*c*g,x=p*c*o-h*f*o-p*a*u+s*f*u+h*a*m-s*c*m,S=e*_+i*v+n*y+r*x;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/S;return t[0]=_*M,t[1]=(f*u*r-c*m*r-f*n*d+i*m*d+c*n*g-i*u*g)*M,t[2]=(a*m*r-f*o*r+f*n*l-i*m*l-a*n*g+i*o*g)*M,t[3]=(c*o*r-a*u*r-c*n*l+i*u*l+a*n*d-i*o*d)*M,t[4]=v*M,t[5]=(h*m*r-p*u*r+p*n*d-e*m*d-h*n*g+e*u*g)*M,t[6]=(p*o*r-s*m*r-p*n*l+e*m*l+s*n*g-e*o*g)*M,t[7]=(s*u*r-h*o*r+h*n*l-e*u*l-s*n*d+e*o*d)*M,t[8]=y*M,t[9]=(p*c*r-h*f*r-p*i*d+e*f*d+h*i*g-e*c*g)*M,t[10]=(s*f*r-p*a*r+p*i*l-e*f*l-s*i*g+e*a*g)*M,t[11]=(h*a*r-s*c*r-h*i*l+e*c*l+s*i*d-e*a*d)*M,t[12]=x*M,t[13]=(h*f*n-p*c*n+p*i*u-e*f*u-h*i*m+e*c*m)*M,t[14]=(p*a*n-s*f*n-p*i*o+e*f*o+s*i*m-e*a*m)*M,t[15]=(s*c*n-h*a*n+h*i*o-e*c*o-s*i*u+e*a*u)*M,this}scale(t){const e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),r=1-i,s=t.x,a=t.y,o=t.z,l=r*s,h=r*a;return this.set(l*s+i,l*a-n*o,l*o+n*a,0,l*a+n*o,h*a+i,h*o-n*s,0,l*o-n*a,h*o+n*s,r*o*o+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,r,s){return this.set(1,i,r,0,t,1,s,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,l=r+r,h=s+s,c=a+a,u=r*l,d=r*h,p=r*c,f=s*h,m=s*c,g=a*c,_=o*l,v=o*h,y=o*c,x=i.x,S=i.y,M=i.z;return n[0]=(1-(f+g))*x,n[1]=(d+y)*x,n[2]=(p-v)*x,n[3]=0,n[4]=(d-y)*S,n[5]=(1-(u+g))*S,n[6]=(m+_)*S,n[7]=0,n[8]=(p+v)*M,n[9]=(m-_)*M,n[10]=(1-(u+f))*M,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let r=No.set(n[0],n[1],n[2]).length();const s=No.set(n[4],n[5],n[6]).length(),a=No.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],Oo.copy(this);const o=1/r,l=1/s,h=1/a;return Oo.elements[0]*=o,Oo.elements[1]*=o,Oo.elements[2]*=o,Oo.elements[4]*=l,Oo.elements[5]*=l,Oo.elements[6]*=l,Oo.elements[8]*=h,Oo.elements[9]*=h,Oo.elements[10]*=h,e.setFromRotationMatrix(Oo),i.x=r,i.y=s,i.z=a,this}makePerspective(t,e,i,n,r,s,a=2e3){const o=this.elements,l=2*r/(e-t),h=2*r/(i-n),c=(e+t)/(e-t),u=(i+n)/(i-n);let d,p;if(a===da)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==pa)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);d=-s/(s-r),p=-s*r/(s-r)}return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=h,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,i,n,r,s,a=2e3){const o=this.elements,l=1/(e-t),h=1/(i-n),c=1/(s-r),u=(e+t)*l,d=(i+n)*h;let p,f;if(a===da)p=(s+r)*c,f=-2*c;else{if(a!==pa)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=r*c,f=-1*c}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*h,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=f,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const No=new no,Oo=new Uo,ko=new no(0,0,0),Fo=new no(1,1,1),zo=new no,Bo=new no,Vo=new no,Ho=new Uo,Go=new io;class Wo{constructor(t=0,e=0,i=0,n=Wo.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){const n=t.elements,r=n[0],s=n[4],a=n[8],o=n[1],l=n[5],h=n[9],c=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(xa(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-xa(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,r),this._z=0);break;case"ZXY":this._x=Math.asin(xa(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-xa(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(xa(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-xa(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-h,d),this._y=0)}return this._order=e,!0===i&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return Ho.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ho,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Go.setFromEuler(this),this.setFromQuaternion(Go,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Wo.DEFAULT_ORDER="XYZ";class Xo{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let qo=0;const Yo=new no,jo=new io,Zo=new Uo,Ko=new no,Jo=new no,$o=new no,Qo=new io,tl=new no(1,0,0),el=new no(0,1,0),il=new no(0,0,1),nl={type:"added"},rl={type:"removed"};class sl extends fa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qo++}),this.uuid=ya(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=sl.DEFAULT_UP.clone();const t=new no,e=new Wo,i=new io,n=new no(1,1,1);e._onChange((function(){i.setFromEuler(e,!1)})),i._onChange((function(){e.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Uo},normalMatrix:{value:new La}}),this.matrix=new Uo,this.matrixWorld=new Uo,this.matrixAutoUpdate=sl.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=sl.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Xo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return jo.setFromAxisAngle(t,e),this.quaternion.multiply(jo),this}rotateOnWorldAxis(t,e){return jo.setFromAxisAngle(t,e),this.quaternion.premultiply(jo),this}rotateX(t){return this.rotateOnAxis(tl,t)}rotateY(t){return this.rotateOnAxis(el,t)}rotateZ(t){return this.rotateOnAxis(il,t)}translateOnAxis(t,e){return Yo.copy(t).applyQuaternion(this.quaternion),this.position.add(Yo.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(tl,t)}translateY(t){return this.translateOnAxis(el,t)}translateZ(t){return this.translateOnAxis(il,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Zo.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?Ko.copy(t):Ko.set(t,e,i);const n=this.parent;this.updateWorldMatrix(!0,!1),Jo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Zo.lookAt(Jo,Ko,this.up):Zo.lookAt(Ko,Jo,this.up),this.quaternion.setFromRotationMatrix(Zo),n&&(Zo.extractRotation(n.matrixWorld),jo.setFromRotationMatrix(Zo),this.quaternion.premultiply(jo.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(nl)),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(rl)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Zo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Zo.multiply(t.parent.matrixWorld)),t.applyMatrix4(Zo),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}}getObjectsByProperty(t,e){let i=[];this[t]===e&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectsByProperty(t,e);r.length>0&&(i=i.concat(r))}return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jo,t,$o),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jo,Qo,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let i=0,n=e.length;i<n;i++){const n=e[i];!0!==n.matrixWorldAutoUpdate&&!0!==t||n.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const i=this.parent;if(!0===t&&null!==i&&!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,i=t.length;e<i;e++){const i=t[e];!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};function r(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const i=e.shapes;if(Array.isArray(i))for(let e=0,n=i.length;e<n;e++){const n=i[e];r(t.shapes,n)}else r(t.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let i=0,n=this.material.length;i<n;i++)e.push(r(t.materials,this.material[i]));n.material=e}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(let e=0;e<this.children.length;e++)n.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let e=0;e<this.animations.length;e++){const i=this.animations[e];n.animations.push(r(t.animations,i))}}if(e){const e=s(t.geometries),n=s(t.materials),r=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),h=s(t.animations),c=s(t.nodes);e.length>0&&(i.geometries=e),n.length>0&&(i.materials=n),r.length>0&&(i.textures=r),a.length>0&&(i.images=a),o.length>0&&(i.shapes=o),l.length>0&&(i.skeletons=l),h.length>0&&(i.animations=h),c.length>0&&(i.nodes=c)}return i.object=n,i;function s(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const i=t.children[e];this.add(i.clone())}return this}}sl.DEFAULT_UP=new no(0,1,0),sl.DEFAULT_MATRIX_AUTO_UPDATE=!0,sl.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const al=new no,ol=new no,ll=new no,hl=new no,cl=new no,ul=new no,dl=new no,pl=new no,fl=new no,ml=new no;let gl=!1;class _l{constructor(t=new no,e=new no,i=new no){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),al.subVectors(t,e),n.cross(al);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(t,e,i,n,r){al.subVectors(n,e),ol.subVectors(i,e),ll.subVectors(t,e);const s=al.dot(al),a=al.dot(ol),o=al.dot(ll),l=ol.dot(ol),h=ol.dot(ll),c=s*l-a*a;if(0===c)return r.set(-2,-1,-1);const u=1/c,d=(l*o-a*h)*u,p=(s*h-a*o)*u;return r.set(1-d-p,p,d)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,hl),hl.x>=0&&hl.y>=0&&hl.x+hl.y<=1}static getUV(t,e,i,n,r,s,a,o){return!1===gl&&(gl=!0),this.getInterpolation(t,e,i,n,r,s,a,o)}static getInterpolation(t,e,i,n,r,s,a,o){return this.getBarycoord(t,e,i,n,hl),o.setScalar(0),o.addScaledVector(r,hl.x),o.addScaledVector(s,hl.y),o.addScaledVector(a,hl.z),o}static isFrontFacing(t,e,i,n){return al.subVectors(i,e),ol.subVectors(t,e),al.cross(ol).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return al.subVectors(this.c,this.b),ol.subVectors(this.a,this.b),.5*al.cross(ol).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return _l.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return _l.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return!1===gl&&(gl=!0),_l.getInterpolation(t,this.a,this.b,this.c,e,i,n,r)}getInterpolation(t,e,i,n,r){return _l.getInterpolation(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return _l.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return _l.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const i=this.a,n=this.b,r=this.c;let s,a;cl.subVectors(n,i),ul.subVectors(r,i),pl.subVectors(t,i);const o=cl.dot(pl),l=ul.dot(pl);if(o<=0&&l<=0)return e.copy(i);fl.subVectors(t,n);const h=cl.dot(fl),c=ul.dot(fl);if(h>=0&&c<=h)return e.copy(n);const u=o*c-h*l;if(u<=0&&o>=0&&h<=0)return s=o/(o-h),e.copy(i).addScaledVector(cl,s);ml.subVectors(t,r);const d=cl.dot(ml),p=ul.dot(ml);if(p>=0&&d<=p)return e.copy(r);const f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),e.copy(i).addScaledVector(ul,a);const m=h*p-d*c;if(m<=0&&c-h>=0&&d-p>=0)return dl.subVectors(r,n),a=(c-h)/(c-h+(d-p)),e.copy(n).addScaledVector(dl,a);const g=1/(m+f+u);return s=f*g,a=u*g,e.copy(i).addScaledVector(cl,s).addScaledVector(ul,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let vl=0;class yl extends fa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:vl++}),this.uuid=ya(),this.name="",this.type="Material",this.blending=1,this.side=ss,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=os,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=la,this.stencilZFail=la,this.stencilZPass=la,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const i=t[e];if(void 0===i)continue;const n=this[e];void 0!==n&&(n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),this.side!==ss&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),e){const e=n(t.textures),r=n(t.images);e.length>0&&(i.textures=e),r.length>0&&(i.images=r)}return i}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let i=null;if(null!==e){const t=e.length;i=new Array(t);for(let n=0;n!==t;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}const xl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Sl={h:0,s:0,l:0},Ml={h:0,s:0,l:0};function bl(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}class Tl{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,i)}set(t,e,i){if(void 0===e&&void 0===i){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,i);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=ta){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Va.toWorkingColorSpace(this,e),this}setRGB(t,e,i,n=Va.workingColorSpace){return this.r=t,this.g=e,this.b=i,Va.toWorkingColorSpace(this,n),this}setHSL(t,e,i,n=Va.workingColorSpace){if(t=Sa(t,1),e=xa(e,0,1),i=xa(i,0,1),0===e)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+e):i+e-i*e,r=2*i-n;this.r=bl(r,n,t+1/3),this.g=bl(r,n,t),this.b=bl(r,n,t-1/3)}return Va.toWorkingColorSpace(this,n),this}setStyle(t,e=ta){function i(t){void 0!==t&&parseFloat(t)}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(t)){let t;const r=n[1],s=n[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(t[4]),this.setRGB(Math.min(255,parseInt(t[1],10))/255,Math.min(255,parseInt(t[2],10))/255,Math.min(255,parseInt(t[3],10))/255,e);if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(t[4]),this.setRGB(Math.min(100,parseInt(t[1],10))/100,Math.min(100,parseInt(t[2],10))/100,Math.min(100,parseInt(t[3],10))/100,e);break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return i(t[4]),this.setHSL(parseFloat(t[1])/360,parseFloat(t[2])/100,parseFloat(t[3])/100,e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],i=t.length;if(3===i)return this.setRGB(parseInt(t.charAt(0),16)/15,parseInt(t.charAt(1),16)/15,parseInt(t.charAt(2),16)/15,e);if(6===i)return this.setHex(parseInt(t,16),e)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=ta){const i=xl[t.toLowerCase()];return void 0!==i&&this.setHex(i,e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ha(t.r),this.g=Ha(t.g),this.b=Ha(t.b),this}copyLinearToSRGB(t){return this.r=Ga(t.r),this.g=Ga(t.g),this.b=Ga(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=ta){return Va.fromWorkingColorSpace(wl.copy(this),t),65536*Math.round(xa(255*wl.r,0,255))+256*Math.round(xa(255*wl.g,0,255))+Math.round(xa(255*wl.b,0,255))}getHexString(t=ta){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Va.workingColorSpace){Va.fromWorkingColorSpace(wl.copy(this),e);const i=wl.r,n=wl.g,r=wl.b,s=Math.max(i,n,r),a=Math.min(i,n,r);let o,l;const h=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=h<=.5?t/(s+a):t/(2-s-a),s){case i:o=(n-r)/t+(n<r?6:0);break;case n:o=(r-i)/t+2;break;case r:o=(i-n)/t+4}o/=6}return t.h=o,t.s=l,t.l=h,t}getRGB(t,e=Va.workingColorSpace){return Va.fromWorkingColorSpace(wl.copy(this),e),t.r=wl.r,t.g=wl.g,t.b=wl.b,t}getStyle(t=ta){Va.fromWorkingColorSpace(wl.copy(this),t);const e=wl.r,i=wl.g,n=wl.b;return t!==ta?`color(${t} ${e.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*i)},${Math.round(255*n)})`}offsetHSL(t,e,i){return this.getHSL(Sl),this.setHSL(Sl.h+t,Sl.s+e,Sl.l+i)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Sl),t.getHSL(Ml);const i=Ma(Sl.h,Ml.h,e),n=Ma(Sl.s,Ml.s,e),r=Ma(Sl.l,Ml.l,e);return this.setHSL(i,n,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,i=this.g,n=this.b,r=t.elements;return this.r=r[0]*e+r[3]*i+r[6]*n,this.g=r[1]*e+r[4]*i+r[7]*n,this.b=r[2]*e+r[5]*i+r[8]*n,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const wl=new Tl;Tl.NAMES=xl;class El extends yl{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Tl(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ls,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Al=new no,Cl=new Pa;class Pl{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=i,this.usage=ha,this.updateRange={offset:0,count:-1},this.gpuType=Us,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,i=this.count;e<i;e++)Cl.fromBufferAttribute(this,e),Cl.applyMatrix3(t),this.setXY(e,Cl.x,Cl.y);else if(3===this.itemSize)for(let e=0,i=this.count;e<i;e++)Al.fromBufferAttribute(this,e),Al.applyMatrix3(t),this.setXYZ(e,Al.x,Al.y,Al.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)Al.fromBufferAttribute(this,e),Al.applyMatrix4(t),this.setXYZ(e,Al.x,Al.y,Al.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Al.fromBufferAttribute(this,e),Al.applyNormalMatrix(t),this.setXYZ(e,Al.x,Al.y,Al.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Al.fromBufferAttribute(this,e),Al.transformDirection(t),this.setXYZ(e,Al.x,Al.y,Al.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let i=this.array[t*this.itemSize+e];return this.normalized&&(i=Ea(i,this.array)),i}setComponent(t,e,i){return this.normalized&&(i=Aa(i,this.array)),this.array[t*this.itemSize+e]=i,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Ea(e,this.array)),e}setX(t,e){return this.normalized&&(e=Aa(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Ea(e,this.array)),e}setY(t,e){return this.normalized&&(e=Aa(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Ea(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Aa(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Ea(e,this.array)),e}setW(t,e){return this.normalized&&(e=Aa(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=Aa(e,this.array),i=Aa(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.normalized&&(e=Aa(e,this.array),i=Aa(i,this.array),n=Aa(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t*=this.itemSize,this.normalized&&(e=Aa(e,this.array),i=Aa(i,this.array),n=Aa(n,this.array),r=Aa(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==ha&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}class Ll extends Pl{constructor(t,e,i){super(new Uint16Array(t),e,i)}}class Rl extends Pl{constructor(t,e,i){super(new Uint32Array(t),e,i)}}class Dl extends Pl{constructor(t,e,i){super(new Float32Array(t),e,i)}}let Il=0;const Ul=new Uo,Nl=new sl,Ol=new no,kl=new ao,Fl=new ao,zl=new no;class Bl extends fa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Il++}),this.uuid=ya(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Da(t)?Rl:Ll)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const e=(new La).getNormalMatrix(t);i.applyNormalMatrix(e),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Ul.makeRotationFromQuaternion(t),this.applyMatrix4(Ul),this}rotateX(t){return Ul.makeRotationX(t),this.applyMatrix4(Ul),this}rotateY(t){return Ul.makeRotationY(t),this.applyMatrix4(Ul),this}rotateZ(t){return Ul.makeRotationZ(t),this.applyMatrix4(Ul),this}translate(t,e,i){return Ul.makeTranslation(t,e,i),this.applyMatrix4(Ul),this}scale(t,e,i){return Ul.makeScale(t,e,i),this.applyMatrix4(Ul),this}lookAt(t){return Nl.lookAt(t),Nl.updateMatrix(),this.applyMatrix4(Nl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ol).negate(),this.translate(Ol.x,Ol.y,Ol.z),this}setFromPoints(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Dl(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ao);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new no(-1/0,-1/0,-1/0),new no(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];kl.setFromBufferAttribute(i),this.morphTargetsRelative?(zl.addVectors(this.boundingBox.min,kl.min),this.boundingBox.expandByPoint(zl),zl.addVectors(this.boundingBox.max,kl.max),this.boundingBox.expandByPoint(zl)):(this.boundingBox.expandByPoint(kl.min),this.boundingBox.expandByPoint(kl.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new wo);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new no,1/0);else if(t){const i=this.boundingSphere.center;if(kl.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];Fl.setFromBufferAttribute(i),this.morphTargetsRelative?(zl.addVectors(kl.min,Fl.min),kl.expandByPoint(zl),zl.addVectors(kl.max,Fl.max),kl.expandByPoint(zl)):(kl.expandByPoint(Fl.min),kl.expandByPoint(Fl.max))}kl.getCenter(i);let n=0;for(let e=0,r=t.count;e<r;e++)zl.fromBufferAttribute(t,e),n=Math.max(n,i.distanceToSquared(zl));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],a=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)zl.fromBufferAttribute(s,e),a&&(Ol.fromBufferAttribute(t,e),zl.add(Ol)),n=Math.max(n,i.distanceToSquared(zl))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const i=t.array,n=e.position.array,r=e.normal.array,s=e.uv.array,a=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Pl(new Float32Array(4*a),4));const o=this.getAttribute("tangent").array,l=[],h=[];for(let t=0;t<a;t++)l[t]=new no,h[t]=new no;const c=new no,u=new no,d=new no,p=new Pa,f=new Pa,m=new Pa,g=new no,_=new no;function v(t,e,i){c.fromArray(n,3*t),u.fromArray(n,3*e),d.fromArray(n,3*i),p.fromArray(s,2*t),f.fromArray(s,2*e),m.fromArray(s,2*i),u.sub(c),d.sub(c),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(u).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),_.copy(d).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[i].add(g),h[t].add(_),h[e].add(_),h[i].add(_))}let y=this.groups;0===y.length&&(y=[{start:0,count:i.length}]);for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)v(i[t+0],i[t+1],i[t+2])}const x=new no,S=new no,M=new no,b=new no;function T(t){M.fromArray(r,3*t),b.copy(M);const e=l[t];x.copy(e),x.sub(M.multiplyScalar(M.dot(e))).normalize(),S.crossVectors(b,e);const i=S.dot(h[t])<0?-1:1;o[4*t]=x.x,o[4*t+1]=x.y,o[4*t+2]=x.z,o[4*t+3]=i}for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)T(i[t+0]),T(i[t+1]),T(i[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let i=this.getAttribute("normal");if(void 0===i)i=new Pl(new Float32Array(3*e.count),3),this.setAttribute("normal",i);else for(let t=0,e=i.count;t<e;t++)i.setXYZ(t,0,0,0);const n=new no,r=new no,s=new no,a=new no,o=new no,l=new no,h=new no,c=new no;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);n.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),h.subVectors(s,r),c.subVectors(n,r),h.cross(c),a.fromBufferAttribute(i,d),o.fromBufferAttribute(i,p),l.fromBufferAttribute(i,f),a.add(h),o.add(h),l.add(h),i.setXYZ(d,a.x,a.y,a.z),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,a=e.count;t<a;t+=3)n.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),h.subVectors(s,r),c.subVectors(n,r),h.cross(c),i.setXYZ(t+0,h.x,h.y,h.z),i.setXYZ(t+1,h.x,h.y,h.z),i.setXYZ(t+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)zl.fromBufferAttribute(t,e),zl.normalize(),t.setXYZ(e,zl.x,zl.y,zl.z)}toNonIndexed(){function t(t,e){const i=t.array,n=t.itemSize,r=t.normalized,s=new i.constructor(e.length*n);let a=0,o=0;for(let r=0,l=e.length;r<l;r++){a=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*n;for(let t=0;t<n;t++)s[o++]=i[a++]}return new Pl(s,n,r)}if(null===this.index)return this;const e=new Bl,i=this.index.array,n=this.attributes;for(const r in n){const s=t(n[r],i);e.setAttribute(r,s)}const r=this.morphAttributes;for(const n in r){const s=[],a=r[n];for(let e=0,n=a.length;e<n;e++){const n=t(a[e],i);s.push(n)}e.morphAttributes[n]=s}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let t=0,i=s.length;t<i;t++){const i=s[t];e.addGroup(i.start,i.count,i.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const i=this.attributes;for(const e in i){const n=i[e];t.data.attributes[e]=n.toJSON(t.data)}const n={};let r=!1;for(const e in this.morphAttributes){const i=this.morphAttributes[e],s=[];for(let e=0,n=i.length;e<n;e++){const n=i[e];s.push(n.toJSON(t.data))}s.length>0&&(n[e]=s,r=!0)}r&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const i=t.index;null!==i&&this.setIndex(i.clone(e));const n=t.attributes;for(const t in n){const i=n[t];this.setAttribute(t,i.clone(e))}const r=t.morphAttributes;for(const t in r){const i=[],n=r[t];for(let t=0,r=n.length;t<r;t++)i.push(n[t].clone(e));this.morphAttributes[t]=i}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let t=0,e=s.length;t<e;t++){const e=s[t];this.addGroup(e.start,e.count,e.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Vl=new Uo,Hl=new Io,Gl=new wo,Wl=new no,Xl=new no,ql=new no,Yl=new no,jl=new no,Zl=new no,Kl=new Pa,Jl=new Pa,$l=new Pa,Ql=new no,th=new no,eh=new no,ih=new no,nh=new no;class rh extends sl{constructor(t=new Bl,e=new El){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const i=t[e[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=i.length;t<e;t++){const e=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;e.fromBufferAttribute(n,t);const a=this.morphTargetInfluences;if(r&&a){Zl.set(0,0,0);for(let i=0,n=r.length;i<n;i++){const n=a[i],o=r[i];0!==n&&(jl.fromBufferAttribute(o,t),s?Zl.addScaledVector(jl,n):Zl.addScaledVector(jl.sub(e),n))}e.add(Zl)}return e}raycast(t,e){const i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0!==n){if(null===i.boundingSphere&&i.computeBoundingSphere(),Gl.copy(i.boundingSphere),Gl.applyMatrix4(r),Hl.copy(t.ray).recast(t.near),!1===Gl.containsPoint(Hl.origin)){if(null===Hl.intersectSphere(Gl,Wl))return;if(Hl.origin.distanceToSquared(Wl)>(t.far-t.near)**2)return}Vl.copy(r).invert(),Hl.copy(t.ray).applyMatrix4(Vl),null!==i.boundingBox&&!1===Hl.intersectsBox(i.boundingBox)||this._computeIntersections(t,e,Hl)}}_computeIntersections(t,e,i){let n;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,h=r.attributes.uv1,c=r.attributes.normal,u=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let r=0,o=u.length;r<o;r++){const o=u[r],p=s[o.materialIndex];for(let r=Math.max(o.start,d.start),s=Math.min(a.count,Math.min(o.start+o.count,d.start+d.count));r<s;r+=3){n=sh(this,p,t,i,l,h,c,a.getX(r),a.getX(r+1),a.getX(r+2)),n&&(n.faceIndex=Math.floor(r/3),n.face.materialIndex=o.materialIndex,e.push(n))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){n=sh(this,s,t,i,l,h,c,a.getX(r),a.getX(r+1),a.getX(r+2)),n&&(n.faceIndex=Math.floor(r/3),e.push(n))}}else if(void 0!==o)if(Array.isArray(s))for(let r=0,a=u.length;r<a;r++){const a=u[r],p=s[a.materialIndex];for(let r=Math.max(a.start,d.start),s=Math.min(o.count,Math.min(a.start+a.count,d.start+d.count));r<s;r+=3){n=sh(this,p,t,i,l,h,c,r,r+1,r+2),n&&(n.faceIndex=Math.floor(r/3),n.face.materialIndex=a.materialIndex,e.push(n))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){n=sh(this,s,t,i,l,h,c,r,r+1,r+2),n&&(n.faceIndex=Math.floor(r/3),e.push(n))}}}}function sh(t,e,i,n,r,s,a,o,l,h){t.getVertexPosition(o,Xl),t.getVertexPosition(l,ql),t.getVertexPosition(h,Yl);const c=function(t,e,i,n,r,s,a,o){let l;if(l=e.side===as?n.intersectTriangle(a,s,r,!0,o):n.intersectTriangle(r,s,a,e.side===ss,o),null===l)return null;nh.copy(o),nh.applyMatrix4(t.matrixWorld);const h=i.ray.origin.distanceTo(nh);return h<i.near||h>i.far?null:{distance:h,point:nh.clone(),object:t}}(t,e,i,n,Xl,ql,Yl,ih);if(c){r&&(Kl.fromBufferAttribute(r,o),Jl.fromBufferAttribute(r,l),$l.fromBufferAttribute(r,h),c.uv=_l.getInterpolation(ih,Xl,ql,Yl,Kl,Jl,$l,new Pa)),s&&(Kl.fromBufferAttribute(s,o),Jl.fromBufferAttribute(s,l),$l.fromBufferAttribute(s,h),c.uv1=_l.getInterpolation(ih,Xl,ql,Yl,Kl,Jl,$l,new Pa),c.uv2=c.uv1),a&&(Ql.fromBufferAttribute(a,o),th.fromBufferAttribute(a,l),eh.fromBufferAttribute(a,h),c.normal=_l.getInterpolation(ih,Xl,ql,Yl,Ql,th,eh,new no),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));const t={a:o,b:l,c:h,normal:new no,materialIndex:0};_l.getNormal(Xl,ql,Yl,t.normal),c.face=t}return c}class ah extends Bl{constructor(t=1,e=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};const a=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],h=[],c=[];let u=0,d=0;function p(t,e,i,n,r,s,p,f,m,g,_){const v=s/m,y=p/g,x=s/2,S=p/2,M=f/2,b=m+1,T=g+1;let w=0,E=0;const A=new no;for(let s=0;s<T;s++){const a=s*y-S;for(let o=0;o<b;o++){const u=o*v-x;A[t]=u*n,A[e]=a*r,A[i]=M,l.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[i]=f>0?1:-1,h.push(A.x,A.y,A.z),c.push(o/m),c.push(1-s/g),w+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const i=u+e+b*t,n=u+e+b*(t+1),r=u+(e+1)+b*(t+1),s=u+(e+1)+b*t;o.push(i,n,s),o.push(n,r,s),E+=6}a.addGroup(d,E,_),d+=E,u+=w}p("z","y","x",-1,-1,i,e,t,s,r,0),p("z","y","x",1,-1,i,e,-t,s,r,1),p("x","z","y",1,1,t,i,e,n,s,2),p("x","z","y",1,-1,t,i,-e,n,s,3),p("x","y","z",1,-1,t,e,i,n,r,4),p("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(o),this.setAttribute("position",new Dl(l,3)),this.setAttribute("normal",new Dl(h,3)),this.setAttribute("uv",new Dl(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ah(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function oh(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?e[i][n]=null:e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function lh(t){const e={};for(let i=0;i<t.length;i++){const n=oh(t[i]);for(const t in n)e[t]=n[t]}return e}function hh(t){return null===t.getRenderTarget()?t.outputColorSpace:Va.workingColorSpace}const ch={clone:oh,merge:lh};class uh extends yl{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=oh(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const i={};for(const t in this.extensions)!0===this.extensions[t]&&(i[t]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}}class dh extends sl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Uo,this.projectionMatrix=new Uo,this.projectionMatrixInverse=new Uo,this.coordinateSystem=da}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ph extends dh{constructor(t=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*va*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*_a*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*va*Math.atan(Math.tan(.5*_a*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,n,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*_a*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;r+=s.offsetX*n/t,e-=s.offsetY*i/a,n*=s.width/t,i*=s.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const fh=-90;class mh extends sl{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new ph(fh,1,t,e);n.layers=this.layers,this.add(n);const r=new ph(fh,1,t,e);r.layers=this.layers,this.add(r);const s=new ph(fh,1,t,e);s.layers=this.layers,this.add(s);const a=new ph(fh,1,t,e);a.layers=this.layers,this.add(a);const o=new ph(fh,1,t,e);o.layers=this.layers,this.add(o);const l=new ph(fh,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[i,n,r,s,a,o]=e;for(const t of e)this.remove(t);if(t===da)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(t!==pa)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const t of e)this.add(t),t.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,h]=this.children,c=t.getRenderTarget(),u=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.xr.enabled;t.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0,n),t.render(e,r),t.setRenderTarget(i,1,n),t.render(e,s),t.setRenderTarget(i,2,n),t.render(e,a),t.setRenderTarget(i,3,n),t.render(e,o),t.setRenderTarget(i,4,n),t.render(e,l),i.texture.generateMipmaps=f,t.setRenderTarget(i,5,n),t.render(e,h),t.setRenderTarget(c,u,d),t.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class gh extends Ka{constructor(t,e,i,n,r,s,a,o,l,h){super(t=void 0!==t?t:[],e=void 0!==e?e:_s,i,n,r,s,a,o,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class _h extends Qa{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const i={width:t,height:t,depth:1},n=[i,i,i,i,i,i];void 0!==e.encoding&&(Oa("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),e.colorSpace=e.encoding===$s?ta:Qs),this.texture=new gh(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Cs}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new ah(5,5,5),r=new uh({name:"CubemapFromEquirect",uniforms:oh(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:as,blending:0});r.uniforms.tEquirect.value=e;const s=new rh(n,r),a=e.minFilter;e.minFilter===Ps&&(e.minFilter=Cs);return new mh(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,i,n){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,i,n);t.setRenderTarget(r)}}const vh=new no,yh=new no,xh=new La;class Sh{constructor(t=new no(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){const n=vh.subVectors(i,e).cross(yh.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const i=t.delta(vh),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:e.copy(t.start).addScaledVector(i,r)}intersectsLine(t){const e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const i=e||xh.getNormalMatrix(t),n=this.coplanarPoint(vh).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Mh=new wo,bh=new no;class Th{constructor(t=new Sh,e=new Sh,i=new Sh,n=new Sh,r=new Sh,s=new Sh){this.planes=[t,e,i,n,r,s]}set(t,e,i,n,r,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(s),this}copy(t){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t,e=2e3){const i=this.planes,n=t.elements,r=n[0],s=n[1],a=n[2],o=n[3],l=n[4],h=n[5],c=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],_=n[13],v=n[14],y=n[15];if(i[0].setComponents(o-r,u-l,m-d,y-g).normalize(),i[1].setComponents(o+r,u+l,m+d,y+g).normalize(),i[2].setComponents(o+s,u+h,m+p,y+_).normalize(),i[3].setComponents(o-s,u-h,m-p,y-_).normalize(),i[4].setComponents(o-a,u-c,m-f,y-v).normalize(),e===da)i[5].setComponents(o+a,u+c,m+f,y+v).normalize();else{if(e!==pa)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);i[5].setComponents(a,c,f,v).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Mh.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Mh.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Mh)}intersectsSprite(t){return Mh.center.set(0,0,0),Mh.radius=.7071067811865476,Mh.applyMatrix4(t.matrixWorld),this.intersectsSphere(Mh)}intersectsSphere(t){const e=this.planes,i=t.center,n=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(i)<n)return!1}return!0}intersectsBox(t){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(bh.x=n.normal.x>0?t.max.x:t.min.x,bh.y=n.normal.y>0?t.max.y:t.min.y,bh.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(bh)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function wh(){let t=null,e=!1,i=null,n=null;function r(e,s){i(e,s),n=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==i&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(t){i=t},setContext:function(e){t=e}}}function Eh(t,e){const i=e.isWebGL2,n=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),n.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const i=n.get(e);i&&(t.deleteBuffer(i.buffer),n.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=n.get(e);return void((!t||t.version<e.version)&&n.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=n.get(e);void 0===s?n.set(e,function(e,n){const r=e.array,s=e.usage,a=t.createBuffer();let o;if(t.bindBuffer(n,a),t.bufferData(n,r,s),e.onUploadCallback(),r instanceof Float32Array)o=t.FLOAT;else if(r instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!i)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");o=t.HALF_FLOAT}else o=t.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=t.SHORT;else if(r instanceof Uint32Array)o=t.UNSIGNED_INT;else if(r instanceof Int32Array)o=t.INT;else if(r instanceof Int8Array)o=t.BYTE;else if(r instanceof Uint8Array)o=t.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=t.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):s.version<e.version&&(!function(e,n,r){const s=n.array,a=n.updateRange;t.bindBuffer(r,e),-1===a.count?t.bufferSubData(r,0,s):(i?t.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):t.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),n.onUploadCallback()}(s.buffer,e,r),s.version=e.version)}}}class Ah extends Bl{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};const r=t/2,s=e/2,a=Math.floor(i),o=Math.floor(n),l=a+1,h=o+1,c=t/a,u=e/o,d=[],p=[],f=[],m=[];for(let t=0;t<h;t++){const e=t*u-s;for(let i=0;i<l;i++){const n=i*c-r;p.push(n,-e,0),f.push(0,0,1),m.push(i/a),m.push(1-t/o)}}for(let t=0;t<o;t++)for(let e=0;e<a;e++){const i=e+l*t,n=e+l*(t+1),r=e+1+l*(t+1),s=e+1+l*t;d.push(i,n,s),d.push(n,r,s)}this.setIndex(d),this.setAttribute("position",new Dl(p,3)),this.setAttribute("normal",new Dl(f,3)),this.setAttribute("uv",new Dl(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Ah(t.width,t.height,t.widthSegments,t.heightSegments)}}const Ch={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Ph={common:{diffuse:{value:new Tl(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new La},alphaMap:{value:null},alphaMapTransform:{value:new La},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new La}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new La}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new La}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new La},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new La},normalScale:{value:new Pa(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new La},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new La}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new La}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new La}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tl(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tl(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new La},alphaTest:{value:0},uvTransform:{value:new La}},sprite:{diffuse:{value:new Tl(16777215)},opacity:{value:1},center:{value:new Pa(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new La},alphaMap:{value:null},alphaMapTransform:{value:new La},alphaTest:{value:0}}},Lh={basic:{uniforms:lh([Ph.common,Ph.specularmap,Ph.envmap,Ph.aomap,Ph.lightmap,Ph.fog]),vertexShader:Ch.meshbasic_vert,fragmentShader:Ch.meshbasic_frag},lambert:{uniforms:lh([Ph.common,Ph.specularmap,Ph.envmap,Ph.aomap,Ph.lightmap,Ph.emissivemap,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,Ph.fog,Ph.lights,{emissive:{value:new Tl(0)}}]),vertexShader:Ch.meshlambert_vert,fragmentShader:Ch.meshlambert_frag},phong:{uniforms:lh([Ph.common,Ph.specularmap,Ph.envmap,Ph.aomap,Ph.lightmap,Ph.emissivemap,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,Ph.fog,Ph.lights,{emissive:{value:new Tl(0)},specular:{value:new Tl(1118481)},shininess:{value:30}}]),vertexShader:Ch.meshphong_vert,fragmentShader:Ch.meshphong_frag},standard:{uniforms:lh([Ph.common,Ph.envmap,Ph.aomap,Ph.lightmap,Ph.emissivemap,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,Ph.roughnessmap,Ph.metalnessmap,Ph.fog,Ph.lights,{emissive:{value:new Tl(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ch.meshphysical_vert,fragmentShader:Ch.meshphysical_frag},toon:{uniforms:lh([Ph.common,Ph.aomap,Ph.lightmap,Ph.emissivemap,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,Ph.gradientmap,Ph.fog,Ph.lights,{emissive:{value:new Tl(0)}}]),vertexShader:Ch.meshtoon_vert,fragmentShader:Ch.meshtoon_frag},matcap:{uniforms:lh([Ph.common,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,Ph.fog,{matcap:{value:null}}]),vertexShader:Ch.meshmatcap_vert,fragmentShader:Ch.meshmatcap_frag},points:{uniforms:lh([Ph.points,Ph.fog]),vertexShader:Ch.points_vert,fragmentShader:Ch.points_frag},dashed:{uniforms:lh([Ph.common,Ph.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ch.linedashed_vert,fragmentShader:Ch.linedashed_frag},depth:{uniforms:lh([Ph.common,Ph.displacementmap]),vertexShader:Ch.depth_vert,fragmentShader:Ch.depth_frag},normal:{uniforms:lh([Ph.common,Ph.bumpmap,Ph.normalmap,Ph.displacementmap,{opacity:{value:1}}]),vertexShader:Ch.meshnormal_vert,fragmentShader:Ch.meshnormal_frag},sprite:{uniforms:lh([Ph.sprite,Ph.fog]),vertexShader:Ch.sprite_vert,fragmentShader:Ch.sprite_frag},background:{uniforms:{uvTransform:{value:new La},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ch.background_vert,fragmentShader:Ch.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ch.backgroundCube_vert,fragmentShader:Ch.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ch.cube_vert,fragmentShader:Ch.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ch.equirect_vert,fragmentShader:Ch.equirect_frag},distanceRGBA:{uniforms:lh([Ph.common,Ph.displacementmap,{referencePosition:{value:new no},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ch.distanceRGBA_vert,fragmentShader:Ch.distanceRGBA_frag},shadow:{uniforms:lh([Ph.lights,Ph.fog,{color:{value:new Tl(0)},opacity:{value:1}}]),vertexShader:Ch.shadow_vert,fragmentShader:Ch.shadow_frag}};Lh.physical={uniforms:lh([Lh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new La},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new La},clearcoatNormalScale:{value:new Pa(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new La},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new La},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new La},sheen:{value:0},sheenColor:{value:new Tl(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new La},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new La},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new La},transmissionSamplerSize:{value:new Pa},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new La},attenuationDistance:{value:0},attenuationColor:{value:new Tl(0)},specularColor:{value:new Tl(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new La},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new La},anisotropyVector:{value:new Pa},anisotropyMap:{value:null},anisotropyMapTransform:{value:new La}}]),vertexShader:Ch.meshphysical_vert,fragmentShader:Ch.meshphysical_frag};const Rh={r:0,b:0,g:0};function Dh(t,e,i,n,r,s,a){const o=new Tl(0);let l,h,c=!0===s?0:1,u=null,d=0,p=null;function f(e,i){e.getRGB(Rh,hh(t)),n.buffers.color.setClear(Rh.r,Rh.g,Rh.b,i,a)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),c=e,f(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,f(o,c)},render:function(s,m){let g=!1,_=!0===m.isScene?m.background:null;if(_&&_.isTexture){_=(m.backgroundBlurriness>0?i:e).get(_)}null===_?f(o,c):_&&_.isColor&&(f(_,1),g=!0);const v=t.xr.getEnvironmentBlendMode();"additive"===v?n.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===v&&n.buffers.color.setClear(0,0,0,0,a),(t.autoClear||g)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Ss)?(void 0===h&&(h=new rh(new ah(1,1,1),new uh({name:"BackgroundCubeMaterial",uniforms:oh(Lh.backgroundCube.uniforms),vertexShader:Lh.backgroundCube.vertexShader,fragmentShader:Lh.backgroundCube.fragmentShader,side:as,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=Va.getTransfer(_.colorSpace)!==sa,u===_&&d===_.version&&p===t.toneMapping||(h.material.needsUpdate=!0,u=_,d=_.version,p=t.toneMapping),h.layers.enableAll(),s.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(void 0===l&&(l=new rh(new Ah(2,2),new uh({name:"BackgroundMaterial",uniforms:oh(Lh.background.uniforms),vertexShader:Lh.background.vertexShader,fragmentShader:Lh.background.fragmentShader,side:ss,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=_,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=Va.getTransfer(_.colorSpace)!==sa,!0===_.matrixAutoUpdate&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),u===_&&d===_.version&&p===t.toneMapping||(l.material.needsUpdate=!0,u=_,d=_.version,p=t.toneMapping),l.layers.enableAll(),s.unshift(l,l.geometry,l.material,0,0,null))}}}function Ih(t,e,i,n){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||null!==s,o={},l=p(null);let h=l,c=!1;function u(e){return n.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function d(e){return n.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function p(t){const e=[],i=[],n=[];for(let t=0;t<r;t++)e[t]=0,i[t]=0,n[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:i,attributeDivisors:n,object:t,attributes:{},index:null}}function f(){const t=h.newAttributes;for(let e=0,i=t.length;e<i;e++)t[e]=0}function m(t){g(t,0)}function g(i,r){const s=h.newAttributes,a=h.enabledAttributes,o=h.attributeDivisors;if(s[i]=1,0===a[i]&&(t.enableVertexAttribArray(i),a[i]=1),o[i]!==r){(n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),o[i]=r}}function _(){const e=h.newAttributes,i=h.enabledAttributes;for(let n=0,r=i.length;n<r;n++)i[n]!==e[n]&&(t.disableVertexAttribArray(n),i[n]=0)}function v(e,i,n,r,s,a,o){!0===o?t.vertexAttribIPointer(e,i,n,s,a):t.vertexAttribPointer(e,i,n,r,s,a)}function y(){x(),c=!0,h!==l&&(h=l,u(h.object))}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,y,x){let S=!1;if(a){const e=function(e,i,r){const a=!0===r.wireframe;let l=o[e.id];void 0===l&&(l={},o[e.id]=l);let h=l[i.id];void 0===h&&(h={},l[i.id]=h);let c=h[a];void 0===c&&(c=p(n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),h[a]=c);return c}(y,d,l);h!==e&&(h=e,u(h.object)),S=function(t,e,i,n){const r=h.attributes,s=e.attributes;let a=0;const o=i.getAttributes();for(const e in o){if(o[e].location>=0){const i=r[e];let n=s[e];if(void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor)),void 0===i)return!0;if(i.attribute!==n)return!0;if(n&&i.data!==n.data)return!0;a++}}return h.attributesNum!==a||h.index!==n}(r,y,d,x),S&&function(t,e,i,n){const r={},s=e.attributes;let a=0;const o=i.getAttributes();for(const e in o){if(o[e].location>=0){let i=s[e];void 0===i&&("instanceMatrix"===e&&t.instanceMatrix&&(i=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(i=t.instanceColor));const n={};n.attribute=i,i&&i.data&&(n.data=i.data),r[e]=n,a++}}h.attributes=r,h.attributesNum=a,h.index=n}(r,y,d,x)}else{const t=!0===l.wireframe;h.geometry===y.id&&h.program===d.id&&h.wireframe===t||(h.geometry=y.id,h.program=d.id,h.wireframe=t,S=!0)}null!==x&&i.update(x,t.ELEMENT_ARRAY_BUFFER),(S||c)&&(c=!1,function(r,s,a,o){if(!1===n.isWebGL2&&(r.isInstancedMesh||o.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;f();const l=o.attributes,h=a.getAttributes(),c=s.defaultAttributeValues;for(const e in h){const s=h[e];if(s.location>=0){let a=l[e];if(void 0===a&&("instanceMatrix"===e&&r.instanceMatrix&&(a=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(a=r.instanceColor)),void 0!==a){const e=a.normalized,l=a.itemSize,h=i.get(a);if(void 0===h)continue;const c=h.buffer,u=h.type,d=h.bytesPerElement,p=!0===n.isWebGL2&&(u===t.INT||u===t.UNSIGNED_INT||a.gpuType===Ds);if(a.isInterleavedBufferAttribute){const i=a.data,n=i.stride,h=a.offset;if(i.isInstancedInterleavedBuffer){for(let t=0;t<s.locationSize;t++)g(s.location+t,i.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let t=0;t<s.locationSize;t++)m(s.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<s.locationSize;t++)v(s.location+t,l/s.locationSize,u,e,n*d,(h+l/s.locationSize*t)*d,p)}else{if(a.isInstancedBufferAttribute){for(let t=0;t<s.locationSize;t++)g(s.location+t,a.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let t=0;t<s.locationSize;t++)m(s.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<s.locationSize;t++)v(s.location+t,l/s.locationSize,u,e,l*d,l/s.locationSize*t*d,p)}}else if(void 0!==c){const i=c[e];if(void 0!==i)switch(i.length){case 2:t.vertexAttrib2fv(s.location,i);break;case 3:t.vertexAttrib3fv(s.location,i);break;case 4:t.vertexAttrib4fv(s.location,i);break;default:t.vertexAttrib1fv(s.location,i)}}}}_()}(r,l,d,y),null!==x&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.get(x).buffer))},reset:y,resetDefaultState:x,dispose:function(){y();for(const t in o){const e=o[t];for(const t in e){const i=e[t];for(const t in i)d(i[t].object),delete i[t];delete e[t]}delete o[t]}},releaseStatesOfGeometry:function(t){if(void 0===o[t.id])return;const e=o[t.id];for(const t in e){const i=e[t];for(const t in i)d(i[t].object),delete i[t];delete e[t]}delete o[t.id]},releaseStatesOfProgram:function(t){for(const e in o){const i=o[e];if(void 0===i[t.id])continue;const n=i[t.id];for(const t in n)d(n[t].object),delete n[t];delete i[t.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:_}}function Uh(t,e,i,n){const r=n.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,n){t.drawArrays(s,e,n),i.update(n,s,1)},this.renderInstances=function(n,a,o){if(0===o)return;let l,h;if(r)l=t,h="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===l)return;l[h](s,n,a,o),i.update(a,s,o)}}function Nh(t,e,i){let n;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===t.constructor.name;let a=void 0!==i.precision?i.precision:"highp";const o=r(a);o!==a&&(a=o);const l=s||e.has("WEBGL_draw_buffers"),h=!0===i.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),f=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),g=t.getParameter(t.MAX_VARYING_VECTORS),_=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=u>0,y=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const i=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:h,maxTextures:c,maxVertexTextures:u,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:_,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:s?t.getParameter(t.MAX_SAMPLES):0}}function Oh(t){const e=this;let i=null,n=0,r=!1,s=!1;const a=new Sh,o=new La,l={value:null,needsUpdate:!1};function h(t,i,n,r){const s=null!==t?t.length:0;let h=null;if(0!==s){if(h=l.value,!0!==r||null===h){const e=n+4*s,r=i.matrixWorldInverse;o.getNormalMatrix(r),(null===h||h.length<e)&&(h=new Float32Array(e));for(let e=0,i=n;e!==s;++e,i+=4)a.copy(t[e]).applyMatrix4(r,o),a.normal.toArray(h,i),h[i+3]=a.constant}l.value=h,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,h}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const i=0!==t.length||e||0!==n||r;return r=e,n=t.length,i},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(t,e){i=h(t,e,0)},this.setState=function(a,o,c){const u=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=t.get(a);if(!r||null===u||0===u.length||s&&!p)s?h(null):function(){l.value!==i&&(l.value=i,l.needsUpdate=n>0);e.numPlanes=n,e.numIntersection=0}();else{const t=s?0:n,e=4*t;let r=f.clippingState||null;l.value=r,r=h(u,o,e,c);for(let t=0;t!==e;++t)r[t]=i[t];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function kh(t){let e=new WeakMap;function i(t,e){return e===ys?t.mapping=_s:e===xs&&(t.mapping=vs),t}function n(t){const i=t.target;i.removeEventListener("dispose",n);const r=e.get(i);void 0!==r&&(e.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const s=r.mapping;if(s===ys||s===xs){if(e.has(r)){return i(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new _h(s.height/2);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",n),i(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}class Fh extends dh{constructor(t=-1,e=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,i,n,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-t,s=i+t,a=n+e,o=n-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const zh=[.125,.215,.35,.446,.526,.582],Bh=20,Vh=new Fh,Hh=new Tl;let Gh=null;const Wh=(1+Math.sqrt(5))/2,Xh=1/Wh,qh=[new no(1,1,1),new no(-1,1,1),new no(1,1,-1),new no(-1,1,-1),new no(0,Wh,Xh),new no(0,Wh,-Xh),new no(Xh,0,Wh),new no(-Xh,0,Wh),new no(Wh,Xh,0),new no(-Wh,Xh,0)];class Yh{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,n=100){Gh=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,i,n,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Jh(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Kh(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Gh),t.scissorTest=!1,Zh(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===_s||t.mapping===vs?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Gh=this._renderer.getRenderTarget();const i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:Cs,minFilter:Cs,generateMipmaps:!1,type:Ns,format:ks,colorSpace:ea,depthBuffer:!1},n=jh(t,e,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=jh(t,e,i);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],i=[],n=[];let r=t;const s=t-4+1+zh.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);i.push(s);let o=1/s;a>t-4?o=zh[a-t+4-1]:0===a&&(o=0),n.push(o);const l=1/(s-2),h=-l,c=1+l,u=[h,h,c,h,c,c,h,h,c,c,h,c],d=6,p=6,f=3,m=2,g=1,_=new Float32Array(f*p*d),v=new Float32Array(m*p*d),y=new Float32Array(g*p*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,i=t>2?0:-1,n=[e,i,0,e+2/3,i,0,e+2/3,i+1,0,e,i,0,e+2/3,i+1,0,e,i+1,0];_.set(n,f*p*t),v.set(u,m*p*t);const r=[t,t,t,t,t,t];y.set(r,g*p*t)}const x=new Bl;x.setAttribute("position",new Pl(_,f)),x.setAttribute("uv",new Pl(v,m)),x.setAttribute("faceIndex",new Pl(y,g)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}(n)),this._blurMaterial=function(t,e,i){const n=new Float32Array(Bh),r=new no(0,1,0),s=new uh({name:"SphericalGaussianBlur",defines:{n:Bh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:$h(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(n,t,e)}return n}_compileMaterial(t){const e=new rh(this._lodPlanes[0],t);this._renderer.compile(e,Vh)}_sceneToCubeUV(t,e,i,n){const r=new ph(90,1,e,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,h=o.toneMapping;o.getClearColor(Hh),o.toneMapping=us,o.autoClear=!1;const c=new El({name:"PMREM.Background",side:as,depthWrite:!1,depthTest:!1}),u=new rh(new ah,c);let d=!1;const p=t.background;p?p.isColor&&(c.color.copy(p),t.background=null,d=!0):(c.color.copy(Hh),d=!0);for(let e=0;e<6;e++){const i=e%3;0===i?(r.up.set(0,s[e],0),r.lookAt(a[e],0,0)):1===i?(r.up.set(0,0,s[e]),r.lookAt(0,a[e],0)):(r.up.set(0,s[e],0),r.lookAt(0,0,a[e]));const l=this._cubeSize;Zh(n,i*l,e>2?l:0,l,l),o.setRenderTarget(n),d&&o.render(u,r),o.render(t,r)}u.geometry.dispose(),u.material.dispose(),o.toneMapping=h,o.autoClear=l,t.background=p}_textureToCubeUV(t,e){const i=this._renderer,n=t.mapping===_s||t.mapping===vs;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=Jh()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Kh());const r=n?this._cubemapMaterial:this._equirectMaterial,s=new rh(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;Zh(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(s,Vh)}_applyPMREM(t){const e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const i=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),n=qh[(e-1)%qh.length];this._blur(t,e-1,e,i,n)}e.autoClear=i}_blur(t,e,i,n,r){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,i,n,"latitudinal",r),this._halfBlur(s,t,i,i,n,"longitudinal",r)}_halfBlur(t,e,i,n,r,s,a){const o=this._renderer,l=this._blurMaterial,h=new rh(this._lodPlanes[n],l),c=l.uniforms,u=this._sizeLods[i]-1,d=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):Bh,m=[];let g=0;for(let t=0;t<Bh;++t){const e=t/p,i=Math.exp(-e*e/2);m.push(i),0===t?g+=i:t<f&&(g+=2*i)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;c.envMap.value=t.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===s,a&&(c.poleAxis.value=a);const{_lodMax:_}=this;c.dTheta.value=d,c.mipInt.value=_-i;const v=this._sizeLods[n];Zh(e,3*v*(n>_-4?n-_+4:0),4*(this._cubeSize-v),3*v,2*v),o.setRenderTarget(e),o.render(h,Vh)}}function jh(t,e,i){const n=new Qa(t,e,i);return n.texture.mapping=Ss,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Zh(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function Kh(){return new uh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$h(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Jh(){return new uh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$h(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $h(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Qh(t){let e=new WeakMap,i=null;function n(t){const i=t.target;i.removeEventListener("dispose",n);const r=e.get(i);void 0!==r&&(e.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=s===ys||s===xs,o=s===_s||s===vs;if(a||o){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let n=e.get(r);return null===i&&(i=new Yh(t)),n=a?i.fromEquirectangular(r,n):i.fromCubemap(r,n),e.set(r,n),n.texture}if(e.has(r))return e.get(r).texture;{const s=r.image;if(a&&s&&s.height>0||o&&s&&function(t){let e=0;const i=6;for(let n=0;n<i;n++)void 0!==t[n]&&e++;return e===i}(s)){null===i&&(i=new Yh(t));const s=a?i.fromEquirectangular(r):i.fromCubemap(r);return e.set(r,s),r.addEventListener("dispose",n),s.texture}return null}}}return r},dispose:function(){e=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function tc(t){const e={};function i(i){if(void 0!==e[i])return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return{has:function(t){return null!==i(t)},init:function(t){t.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(t){const e=i(t);return e}}}function ec(t,e,i,n){const r={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const t in o.attributes)e.remove(o.attributes[t]);for(const t in o.morphAttributes){const i=o.morphAttributes[t];for(let t=0,n=i.length;t<n;t++)e.remove(i[t])}o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(e.remove(l),s.delete(o)),n.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,i.memory.geometries--}function o(t){const i=[],n=t.index,r=t.attributes.position;let a=0;if(null!==n){const t=n.array;a=n.version;for(let e=0,n=t.length;e<n;e+=3){const n=t[e+0],r=t[e+1],s=t[e+2];i.push(n,r,r,s,s,n)}}else{if(void 0===r)return;{const t=r.array;a=r.version;for(let e=0,n=t.length/3-1;e<n;e+=3){const t=e+0,n=e+1,r=e+2;i.push(t,n,n,r,r,t)}}}const o=new(Da(i)?Rl:Ll)(i,1);o.version=a;const l=s.get(t);l&&e.remove(l),s.set(t,o)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,i.memory.geometries++),e},update:function(i){const n=i.attributes;for(const i in n)e.update(n[i],t.ARRAY_BUFFER);const r=i.morphAttributes;for(const i in r){const n=r[i];for(let i=0,r=n.length;i<r;i++)e.update(n[i],t.ARRAY_BUFFER)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const i=t.index;null!==i&&e.version<i.version&&o(t)}else o(t);return s.get(t)}}}function ic(t,e,i,n){const r=n.isWebGL2;let s,a,o;this.setMode=function(t){s=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,n){t.drawElements(s,n,a,e*o),i.update(n,s,1)},this.renderInstances=function(n,l,h){if(0===h)return;let c,u;if(r)c=t,u="drawElementsInstanced";else if(c=e.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===c)return;c[u](s,l,a,n*o,h),i.update(l,s,h)}}function nc(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(i,n,r){switch(e.calls++,n){case t.TRIANGLES:e.triangles+=r*(i/3);break;case t.LINES:e.lines+=r*(i/2);break;case t.LINE_STRIP:e.lines+=r*(i-1);break;case t.LINE_LOOP:e.lines+=r*i;break;case t.POINTS:e.points+=r*i}}}}function rc(t,e){return t[0]-e[0]}function sc(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ac(t,e,i){const n={},r=new Float32Array(8),s=new WeakMap,a=new Ja,o=[];for(let t=0;t<8;t++)o[t]=[t,0];return{update:function(l,h,c){const u=l.morphTargetInfluences;if(!0===e.isWebGL2){const d=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,p=void 0!==d?d.length:0;let f=s.get(h);if(void 0===f||f.count!==p){void 0!==f&&f.texture.dispose();const _=void 0!==h.morphAttributes.position,v=void 0!==h.morphAttributes.normal,y=void 0!==h.morphAttributes.color,x=h.morphAttributes.position||[],S=h.morphAttributes.normal||[],M=h.morphAttributes.color||[];let b=0;!0===_&&(b=1),!0===v&&(b=2),!0===y&&(b=3);let T=h.attributes.position.count*b,w=1;T>e.maxTextureSize&&(w=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);const E=new Float32Array(T*w*4*p),A=new to(E,T,w,p);A.type=Us,A.needsUpdate=!0;const C=4*b;for(let L=0;L<p;L++){const R=x[L],D=S[L],I=M[L],U=T*w*4*L;for(let N=0;N<R.count;N++){const O=N*C;!0===_&&(a.fromBufferAttribute(R,N),E[U+O+0]=a.x,E[U+O+1]=a.y,E[U+O+2]=a.z,E[U+O+3]=0),!0===v&&(a.fromBufferAttribute(D,N),E[U+O+4]=a.x,E[U+O+5]=a.y,E[U+O+6]=a.z,E[U+O+7]=0),!0===y&&(a.fromBufferAttribute(I,N),E[U+O+8]=a.x,E[U+O+9]=a.y,E[U+O+10]=a.z,E[U+O+11]=4===I.itemSize?a.w:1)}}function P(){A.dispose(),s.delete(h),h.removeEventListener("dispose",P)}f={count:p,texture:A,size:new Pa(T,w)},s.set(h,f),h.addEventListener("dispose",P)}let m=0;for(let k=0;k<u.length;k++)m+=u[k];const g=h.morphTargetsRelative?1:1-m;c.getUniforms().setValue(t,"morphTargetBaseInfluence",g),c.getUniforms().setValue(t,"morphTargetInfluences",u),c.getUniforms().setValue(t,"morphTargetsTexture",f.texture,i),c.getUniforms().setValue(t,"morphTargetsTextureSize",f.size)}else{const F=void 0===u?0:u.length;let z=n[h.id];if(void 0===z||z.length!==F){z=[];for(let W=0;W<F;W++)z[W]=[W,0];n[h.id]=z}for(let X=0;X<F;X++){const q=z[X];q[0]=X,q[1]=u[X]}z.sort(sc);for(let Y=0;Y<8;Y++)Y<F&&z[Y][1]?(o[Y][0]=z[Y][0],o[Y][1]=z[Y][1]):(o[Y][0]=Number.MAX_SAFE_INTEGER,o[Y][1]=0);o.sort(rc);const B=h.morphAttributes.position,V=h.morphAttributes.normal;let H=0;for(let j=0;j<8;j++){const Z=o[j],K=Z[0],J=Z[1];K!==Number.MAX_SAFE_INTEGER&&J?(B&&h.getAttribute("morphTarget"+j)!==B[K]&&h.setAttribute("morphTarget"+j,B[K]),V&&h.getAttribute("morphNormal"+j)!==V[K]&&h.setAttribute("morphNormal"+j,V[K]),r[j]=J,H+=J):(B&&!0===h.hasAttribute("morphTarget"+j)&&h.deleteAttribute("morphTarget"+j),V&&!0===h.hasAttribute("morphNormal"+j)&&h.deleteAttribute("morphNormal"+j),r[j]=0)}const G=h.morphTargetsRelative?1:1-H;c.getUniforms().setValue(t,"morphTargetBaseInfluence",G),c.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function oc(t,e,i,n){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),i.remove(e.instanceMatrix),null!==e.instanceColor&&i.remove(e.instanceColor)}return{update:function(a){const o=n.render.frame,l=a.geometry,h=e.get(a,l);if(r.get(h)!==o&&(e.update(h),r.set(h,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(i.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&i.update(a.instanceColor,t.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const t=a.skeleton;r.get(t)!==o&&(t.update(),r.set(t,o))}return h},dispose:function(){r=new WeakMap}}}const lc=new Ka,hc=new to,cc=new eo,uc=new gh,dc=[],pc=[],fc=new Float32Array(16),mc=new Float32Array(9),gc=new Float32Array(4);function _c(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let s=dc[r];if(void 0===s&&(s=new Float32Array(r),dc[r]=s),0!==e){n.toArray(s,0);for(let n=1,r=0;n!==e;++n)r+=i,t[n].toArray(s,r)}return s}function vc(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function yc(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function xc(t,e){let i=pc[e];void 0===i&&(i=new Int32Array(e),pc[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Sc(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Mc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(vc(i,e))return;t.uniform2fv(this.addr,e),yc(i,e)}}function bc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(vc(i,e))return;t.uniform3fv(this.addr,e),yc(i,e)}}function Tc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(vc(i,e))return;t.uniform4fv(this.addr,e),yc(i,e)}}function wc(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(vc(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),yc(i,e)}else{if(vc(i,n))return;gc.set(n),t.uniformMatrix2fv(this.addr,!1,gc),yc(i,n)}}function Ec(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(vc(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),yc(i,e)}else{if(vc(i,n))return;mc.set(n),t.uniformMatrix3fv(this.addr,!1,mc),yc(i,n)}}function Ac(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(vc(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),yc(i,e)}else{if(vc(i,n))return;fc.set(n),t.uniformMatrix4fv(this.addr,!1,fc),yc(i,n)}}function Cc(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Pc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(vc(i,e))return;t.uniform2iv(this.addr,e),yc(i,e)}}function Lc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(vc(i,e))return;t.uniform3iv(this.addr,e),yc(i,e)}}function Rc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(vc(i,e))return;t.uniform4iv(this.addr,e),yc(i,e)}}function Dc(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function Ic(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(vc(i,e))return;t.uniform2uiv(this.addr,e),yc(i,e)}}function Uc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(vc(i,e))return;t.uniform3uiv(this.addr,e),yc(i,e)}}function Nc(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(vc(i,e))return;t.uniform4uiv(this.addr,e),yc(i,e)}}function Oc(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||lc,r)}function kc(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||cc,r)}function Fc(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||uc,r)}function zc(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||hc,r)}function Bc(t,e){t.uniform1fv(this.addr,e)}function Vc(t,e){const i=_c(e,this.size,2);t.uniform2fv(this.addr,i)}function Hc(t,e){const i=_c(e,this.size,3);t.uniform3fv(this.addr,i)}function Gc(t,e){const i=_c(e,this.size,4);t.uniform4fv(this.addr,i)}function Wc(t,e){const i=_c(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function Xc(t,e){const i=_c(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function qc(t,e){const i=_c(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function Yc(t,e){t.uniform1iv(this.addr,e)}function jc(t,e){t.uniform2iv(this.addr,e)}function Zc(t,e){t.uniform3iv(this.addr,e)}function Kc(t,e){t.uniform4iv(this.addr,e)}function Jc(t,e){t.uniform1uiv(this.addr,e)}function $c(t,e){t.uniform2uiv(this.addr,e)}function Qc(t,e){t.uniform3uiv(this.addr,e)}function tu(t,e){t.uniform4uiv(this.addr,e)}function eu(t,e,i){const n=this.cache,r=e.length,s=xc(i,r);vc(n,s)||(t.uniform1iv(this.addr,s),yc(n,s));for(let t=0;t!==r;++t)i.setTexture2D(e[t]||lc,s[t])}function iu(t,e,i){const n=this.cache,r=e.length,s=xc(i,r);vc(n,s)||(t.uniform1iv(this.addr,s),yc(n,s));for(let t=0;t!==r;++t)i.setTexture3D(e[t]||cc,s[t])}function nu(t,e,i){const n=this.cache,r=e.length,s=xc(i,r);vc(n,s)||(t.uniform1iv(this.addr,s),yc(n,s));for(let t=0;t!==r;++t)i.setTextureCube(e[t]||uc,s[t])}function ru(t,e,i){const n=this.cache,r=e.length,s=xc(i,r);vc(n,s)||(t.uniform1iv(this.addr,s),yc(n,s));for(let t=0;t!==r;++t)i.setTexture2DArray(e[t]||hc,s[t])}class su{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Sc;case 35664:return Mc;case 35665:return bc;case 35666:return Tc;case 35674:return wc;case 35675:return Ec;case 35676:return Ac;case 5124:case 35670:return Cc;case 35667:case 35671:return Pc;case 35668:case 35672:return Lc;case 35669:case 35673:return Rc;case 5125:return Dc;case 36294:return Ic;case 36295:return Uc;case 36296:return Nc;case 35678:case 36198:case 36298:case 36306:case 35682:return Oc;case 35679:case 36299:case 36307:return kc;case 35680:case 36300:case 36308:case 36293:return Fc;case 36289:case 36303:case 36311:case 36292:return zc}}(e.type)}}class au{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Bc;case 35664:return Vc;case 35665:return Hc;case 35666:return Gc;case 35674:return Wc;case 35675:return Xc;case 35676:return qc;case 5124:case 35670:return Yc;case 35667:case 35671:return jc;case 35668:case 35672:return Zc;case 35669:case 35673:return Kc;case 5125:return Jc;case 36294:return $c;case 36295:return Qc;case 36296:return tu;case 35678:case 36198:case 36298:case 36306:case 35682:return eu;case 35679:case 36299:case 36307:return iu;case 35680:case 36300:case 36308:case 36293:return nu;case 36289:case 36303:case 36311:case 36292:return ru}}(e.type)}}class ou{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const s=n[r];s.setValue(t,e[s.id],i)}}}const lu=/(\w+)(\])?(\[|\.)?/g;function hu(t,e){t.seq.push(e),t.map[e.id]=e}function cu(t,e,i){const n=t.name,r=n.length;for(lu.lastIndex=0;;){const s=lu.exec(n),a=lu.lastIndex;let o=s[1];const l="]"===s[2],h=s[3];if(l&&(o|=0),void 0===h||"["===h&&a+2===r){hu(i,void 0===h?new su(o,t,e):new au(o,t,e));break}{let t=i.map[o];void 0===t&&(t=new ou(o),hu(i,t)),i=t}}}class uu{constructor(t,e){this.seq=[],this.map={};const i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){const i=t.getActiveUniform(e,n);cu(i,t.getUniformLocation(e,i.name),this)}}setValue(t,e,i,n){const r=this.map[e];void 0!==r&&r.setValue(t,i,n)}setOptional(t,e,i){const n=e[i];void 0!==n&&this.setValue(t,i,n)}static upload(t,e,i,n){for(let r=0,s=e.length;r!==s;++r){const s=e[r],a=i[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,n)}}static seqWithValue(t,e){const i=[];for(let n=0,r=t.length;n!==r;++n){const r=t[n];r.id in e&&i.push(r)}return i}}function du(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}let pu=0;function fu(t,e,i){const n=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const n=parseInt(s[1]);return i.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const i=t.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let t=r;t<s;t++){const r=t+1;n.push(`${r===e?">":" "} ${r}: ${i[t]}`)}return n.join("\n")}(t.getShaderSource(e),n)}return r}function mu(t,e){const i=function(t){const e=Va.getPrimaries(Va.workingColorSpace),i=Va.getPrimaries(t);let n;switch(e===i?n="":e===oa&&i===aa?n="LinearDisplayP3ToLinearSRGB":e===aa&&i===oa&&(n="LinearSRGBToLinearDisplayP3"),t){case ea:case na:return[n,"LinearTransferOETF"];case ta:case ia:return[n,"sRGBTransferOETF"];default:return[n,"LinearTransferOETF"]}}(e);return`vec4 ${t}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function gu(t,e){let i;switch(e){case ds:i="Linear";break;case ps:i="Reinhard";break;case fs:i="OptimizedCineon";break;case ms:i="ACESFilmic";break;case gs:i="Custom";break;default:i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function _u(t){return""!==t}function vu(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yu(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const xu=/^[ \t]*#include +<([\w\d./]+)>/gm;function Su(t){return t.replace(xu,bu)}const Mu=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function bu(t,e){let i=Ch[e];if(void 0===i){const t=Mu.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");i=Ch[t]}return Su(i)}const Tu=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wu(t){return t.replace(Tu,Eu)}function Eu(t,e,i,n){let r="";for(let t=parseInt(e);t<parseInt(i);t++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function Au(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Cu(t,e,i,n){const r=t.getContext(),s=i.defines;let a=i.vertexShader,o=i.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===is?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ns?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===rs&&(e="SHADOWMAP_TYPE_VSM"),e}(i),h=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case _s:case vs:e="ENVMAP_TYPE_CUBE";break;case Ss:e="ENVMAP_TYPE_CUBE_UV"}return e}(i),c=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===vs&&(e="ENVMAP_MODE_REFRACTION");return e}(i),u=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case ls:e="ENVMAP_BLENDING_MULTIPLY";break;case hs:e="ENVMAP_BLENDING_MIX";break;case cs:e="ENVMAP_BLENDING_ADD"}return e}(i),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:n,maxMip:i}}(i),p=i.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_u).join("\n")}(i),f=function(t){const e=[];for(const i in t){const n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(s),m=r.createProgram();let g,_,v=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?(g=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(_u).join("\n"),g.length>0&&(g+="\n"),_=[p,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(_u).join("\n"),_.length>0&&(_+="\n")):(g=[Au(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(_u).join("\n"),_=[p,Au(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+c:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==us?"#define TONE_MAPPING":"",i.toneMapping!==us?Ch.tonemapping_pars_fragment:"",i.toneMapping!==us?gu("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Ch.colorspace_pars_fragment,mu("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(_u).join("\n")),a=Su(a),a=vu(a,i),a=yu(a,i),o=Su(o),o=vu(o,i),o=yu(o,i),a=wu(a),o=wu(o),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",i.glslVersion===ca?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===ca?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const y=v+g+a,x=v+_+o,S=du(r,r.VERTEX_SHADER,y),M=du(r,r.FRAGMENT_SHADER,x);if(r.attachShader(m,S),r.attachShader(m,M),void 0!==i.index0AttributeName?r.bindAttribLocation(m,0,i.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const e=r.getProgramInfoLog(m).trim(),i=r.getShaderInfoLog(S).trim(),n=r.getShaderInfoLog(M).trim();let s=!0,a=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(s=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(r,m,S,M);else{fu(r,S,"vertex"),fu(r,M,"fragment")}else""!==e||""!==i&&""!==n||(a=!1);a&&(this.diagnostics={runnable:s,programLog:e,vertexShader:{log:i,prefix:g},fragmentShader:{log:n,prefix:_}})}let b,T;return r.deleteShader(S),r.deleteShader(M),this.getUniforms=function(){return void 0===b&&(b=new uu(r,m)),b},this.getAttributes=function(){return void 0===T&&(T=function(t,e){const i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const n=t.getActiveAttrib(e,r),s=n.name;let a=1;n.type===t.FLOAT_MAT2&&(a=2),n.type===t.FLOAT_MAT3&&(a=3),n.type===t.FLOAT_MAT4&&(a=4),i[s]={type:n.type,location:t.getAttribLocation(e,s),locationSize:a}}return i}(r,m)),T},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=pu++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=M,this}let Pu=0;class Lu{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,i=t.fragmentShader,n=this._getShaderStage(e),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(t);return!1===s.has(n)&&(s.add(n),n.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let i=e.get(t);return void 0===i&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){const e=this.shaderCache;let i=e.get(t);return void 0===i&&(i=new Ru(t),e.set(t,i)),i}}class Ru{constructor(t){this.id=Pu++,this.code=t,this.usedTimes=0}}function Du(t,e,i,n,r,s,a){const o=new Xo,l=new Lu,h=[],c=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(t){return 0===t?"uv":`uv${t}`}return{getParameters:function(s,o,h,g,_){const v=g.fog,y=_.geometry,x=s.isMeshStandardMaterial?g.environment:null,S=(s.isMeshStandardMaterial?i:e).get(s.envMap||x),M=S&&S.mapping===Ss?S.image.height:null,b=f[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),s.precision);const T=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,w=void 0!==T?T.length:0;let E,A,C,P,L=0;if(void 0!==y.morphAttributes.position&&(L=1),void 0!==y.morphAttributes.normal&&(L=2),void 0!==y.morphAttributes.color&&(L=3),b){const t=Lh[b];E=t.vertexShader,A=t.fragmentShader}else E=s.vertexShader,A=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const R=t.getRenderTarget(),D=!0===_.isInstancedMesh,I=!!s.map,U=!!s.matcap,N=!!S,O=!!s.aoMap,k=!!s.lightMap,F=!!s.bumpMap,z=!!s.normalMap,B=!!s.displacementMap,V=!!s.emissiveMap,H=!!s.metalnessMap,G=!!s.roughnessMap,W=s.anisotropy>0,X=s.clearcoat>0,q=s.iridescence>0,Y=s.sheen>0,j=s.transmission>0,Z=W&&!!s.anisotropyMap,K=X&&!!s.clearcoatMap,J=X&&!!s.clearcoatNormalMap,$=X&&!!s.clearcoatRoughnessMap,Q=q&&!!s.iridescenceMap,tt=q&&!!s.iridescenceThicknessMap,et=Y&&!!s.sheenColorMap,it=Y&&!!s.sheenRoughnessMap,nt=!!s.specularMap,rt=!!s.specularColorMap,st=!!s.specularIntensityMap,at=j&&!!s.transmissionMap,ot=j&&!!s.thicknessMap,lt=!!s.gradientMap,ht=!!s.alphaMap,ct=s.alphaTest>0,ut=!!s.alphaHash,dt=!!s.extensions,pt=!!y.attributes.uv1,ft=!!y.attributes.uv2,mt=!!y.attributes.uv3;let gt=us;return s.toneMapped&&(null!==R&&!0!==R.isXRRenderTarget||(gt=t.toneMapping)),{isWebGL2:c,shaderID:b,shaderType:s.type,shaderName:s.name,vertexShader:E,fragmentShader:A,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,instancing:D,instancingColor:D&&null!==_.instanceColor,supportsVertexTextures:d,outputColorSpace:null===R?t.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:ea,map:I,matcap:U,envMap:N,envMapMode:N&&S.mapping,envMapCubeUVHeight:M,aoMap:O,lightMap:k,bumpMap:F,normalMap:z,displacementMap:d&&B,emissiveMap:V,normalMapObjectSpace:z&&1===s.normalMapType,normalMapTangentSpace:z&&0===s.normalMapType,metalnessMap:H,roughnessMap:G,anisotropy:W,anisotropyMap:Z,clearcoat:X,clearcoatMap:K,clearcoatNormalMap:J,clearcoatRoughnessMap:$,iridescence:q,iridescenceMap:Q,iridescenceThicknessMap:tt,sheen:Y,sheenColorMap:et,sheenRoughnessMap:it,specularMap:nt,specularColorMap:rt,specularIntensityMap:st,transmission:j,transmissionMap:at,thicknessMap:ot,gradientMap:lt,opaque:!1===s.transparent&&1===s.blending,alphaMap:ht,alphaTest:ct,alphaHash:ut,combine:s.combine,mapUv:I&&m(s.map.channel),aoMapUv:O&&m(s.aoMap.channel),lightMapUv:k&&m(s.lightMap.channel),bumpMapUv:F&&m(s.bumpMap.channel),normalMapUv:z&&m(s.normalMap.channel),displacementMapUv:B&&m(s.displacementMap.channel),emissiveMapUv:V&&m(s.emissiveMap.channel),metalnessMapUv:H&&m(s.metalnessMap.channel),roughnessMapUv:G&&m(s.roughnessMap.channel),anisotropyMapUv:Z&&m(s.anisotropyMap.channel),clearcoatMapUv:K&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:J&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:Q&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:tt&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:et&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:it&&m(s.sheenRoughnessMap.channel),specularMapUv:nt&&m(s.specularMap.channel),specularColorMapUv:rt&&m(s.specularColorMap.channel),specularIntensityMapUv:st&&m(s.specularIntensityMap.channel),transmissionMapUv:at&&m(s.transmissionMap.channel),thicknessMapUv:ot&&m(s.thicknessMap.channel),alphaMapUv:ht&&m(s.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||W),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUv1s:pt,vertexUv2s:ft,vertexUv3s:mt,pointsUvs:!0===_.isPoints&&!!y.attributes.uv&&(I||ht),fog:!!v,useFog:!0===s.fog,fogExp2:v&&v.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===_.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:w,morphTextureStride:L,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.length>0,shadowMapType:t.shadowMap.type,toneMapping:gt,useLegacyLights:t._useLegacyLights,decodeVideoTexture:I&&!0===s.map.isVideoTexture&&Va.getTransfer(s.map.colorSpace)===sa,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:s.side===as,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:dt&&!0===s.extensions.derivatives,extensionFragDepth:dt&&!0===s.extensions.fragDepth,extensionDrawBuffers:dt&&!0===s.extensions.drawBuffers,extensionShaderTextureLOD:dt&&!0===s.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||n.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(e){const i=[];if(e.shaderID?i.push(e.shaderID):(i.push(e.customVertexShaderID),i.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)i.push(t),i.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(i,e),function(t,e){o.disableAll(),e.isWebGL2&&o.enable(0);e.supportsVertexTextures&&o.enable(1);e.instancing&&o.enable(2);e.instancingColor&&o.enable(3);e.matcap&&o.enable(4);e.envMap&&o.enable(5);e.normalMapObjectSpace&&o.enable(6);e.normalMapTangentSpace&&o.enable(7);e.clearcoat&&o.enable(8);e.iridescence&&o.enable(9);e.alphaTest&&o.enable(10);e.vertexColors&&o.enable(11);e.vertexAlphas&&o.enable(12);e.vertexUv1s&&o.enable(13);e.vertexUv2s&&o.enable(14);e.vertexUv3s&&o.enable(15);e.vertexTangents&&o.enable(16);e.anisotropy&&o.enable(17);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.skinning&&o.enable(4);e.morphTargets&&o.enable(5);e.morphNormals&&o.enable(6);e.morphColors&&o.enable(7);e.premultipliedAlpha&&o.enable(8);e.shadowMapEnabled&&o.enable(9);e.useLegacyLights&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.transmission&&o.enable(15);e.sheen&&o.enable(16);e.opaque&&o.enable(17);e.pointsUvs&&o.enable(18);e.decodeVideoTexture&&o.enable(19);t.push(o.mask)}(i,e),i.push(t.outputColorSpace)),i.push(e.customProgramCacheKey),i.join()},getUniforms:function(t){const e=f[t.type];let i;if(e){const t=Lh[e];i=ch.clone(t.uniforms)}else i=t.uniforms;return i},acquireProgram:function(e,i){let n;for(let t=0,e=h.length;t<e;t++){const e=h[t];if(e.cacheKey===i){n=e,++n.usedTimes;break}}return void 0===n&&(n=new Cu(t,i,e,s),h.push(n)),n},releaseProgram:function(t){if(0==--t.usedTimes){const e=h.indexOf(t);h[e]=h[h.length-1],h.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:h,dispose:function(){l.dispose()}}}function Iu(){let t=new WeakMap;return{get:function(e){let i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i},remove:function(e){t.delete(e)},update:function(e,i,n){t.get(e)[i]=n},dispose:function(){t=new WeakMap}}}function Uu(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Nu(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ou(){const t=[];let e=0;const i=[],n=[],r=[];function s(i,n,r,s,a,o){let l=t[e];return void 0===l?(l={id:i.id,object:i,geometry:n,material:r,groupOrder:s,renderOrder:i.renderOrder,z:a,group:o},t[e]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=r,l.groupOrder=s,l.renderOrder=i.renderOrder,l.z=a,l.group=o),e++,l}return{opaque:i,transmissive:n,transparent:r,init:function(){e=0,i.length=0,n.length=0,r.length=0},push:function(t,e,a,o,l,h){const c=s(t,e,a,o,l,h);a.transmission>0?n.push(c):!0===a.transparent?r.push(c):i.push(c)},unshift:function(t,e,a,o,l,h){const c=s(t,e,a,o,l,h);a.transmission>0?n.unshift(c):!0===a.transparent?r.unshift(c):i.unshift(c)},finish:function(){for(let i=e,n=t.length;i<n;i++){const e=t[i];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){i.length>1&&i.sort(t||Uu),n.length>1&&n.sort(e||Nu),r.length>1&&r.sort(e||Nu)}}}function ku(){let t=new WeakMap;return{get:function(e,i){const n=t.get(e);let r;return void 0===n?(r=new Ou,t.set(e,[r])):i>=n.length?(r=new Ou,n.push(r)):r=n[i],r},dispose:function(){t=new WeakMap}}}function Fu(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new no,color:new Tl};break;case"SpotLight":i={position:new no,direction:new no,color:new Tl,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new no,color:new Tl,distance:0,decay:0};break;case"HemisphereLight":i={direction:new no,skyColor:new Tl,groundColor:new Tl};break;case"RectAreaLight":i={color:new Tl,position:new no,halfWidth:new no,halfHeight:new no}}return t[e.id]=i,i}}}let zu=0;function Bu(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Vu(t,e){const i=new Fu,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pa};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pa,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=i,i}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let t=0;t<9;t++)r.probe.push(new no);const s=new no,a=new Uo,o=new Uo;return{setup:function(s,a){let o=0,l=0,h=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let c=0,u=0,d=0,p=0,f=0,m=0,g=0,_=0,v=0,y=0,x=0;s.sort(Bu);const S=!0===a?Math.PI:1;for(let t=0,e=s.length;t<e;t++){const e=s[t],a=e.color,M=e.intensity,b=e.distance,T=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=a.r*M*S,l+=a.g*M*S,h+=a.b*M*S;else if(e.isLightProbe){for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],M);x++}else if(e.isDirectionalLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*S),e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,r.directionalShadow[c]=i,r.directionalShadowMap[c]=T,r.directionalShadowMatrix[c]=e.shadow.matrix,m++}r.directional[c]=t,c++}else if(e.isSpotLight){const t=i.get(e);t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(M*S),t.distance=b,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,r.spot[d]=t;const s=e.shadow;if(e.map&&(r.spotLightMap[v]=e.map,v++,s.updateMatrices(e),e.castShadow&&y++),r.spotLightMatrix[d]=s.matrix,e.castShadow){const t=n.get(e);t.shadowBias=s.bias,t.shadowNormalBias=s.normalBias,t.shadowRadius=s.radius,t.shadowMapSize=s.mapSize,r.spotShadow[d]=t,r.spotShadowMap[d]=T,_++}d++}else if(e.isRectAreaLight){const t=i.get(e);t.color.copy(a).multiplyScalar(M),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*S),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,i.shadowCameraNear=t.camera.near,i.shadowCameraFar=t.camera.far,r.pointShadow[u]=i,r.pointShadowMap[u]=T,r.pointShadowMatrix[u]=e.shadow.matrix,g++}r.point[u]=t,u++}else if(e.isHemisphereLight){const t=i.get(e);t.skyColor.copy(e.color).multiplyScalar(M*S),t.groundColor.copy(e.groundColor).multiplyScalar(M*S),r.hemi[f]=t,f++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ph.LTC_FLOAT_1,r.rectAreaLTC2=Ph.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")&&(r.rectAreaLTC1=Ph.LTC_HALF_1,r.rectAreaLTC2=Ph.LTC_HALF_2)),r.ambient[0]=o,r.ambient[1]=l,r.ambient[2]=h;const M=r.hash;M.directionalLength===c&&M.pointLength===u&&M.spotLength===d&&M.rectAreaLength===p&&M.hemiLength===f&&M.numDirectionalShadows===m&&M.numPointShadows===g&&M.numSpotShadows===_&&M.numSpotMaps===v&&M.numLightProbes===x||(r.directional.length=c,r.spot.length=d,r.rectArea.length=p,r.point.length=u,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=_,r.spotShadowMap.length=_,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=_+v-y,r.spotLightMap.length=v,r.numSpotLightShadowsWithMaps=y,r.numLightProbes=x,M.directionalLength=c,M.pointLength=u,M.spotLength=d,M.rectAreaLength=p,M.hemiLength=f,M.numDirectionalShadows=m,M.numPointShadows=g,M.numSpotShadows=_,M.numSpotMaps=v,M.numLightProbes=x,r.version=zu++)},setupView:function(t,e){let i=0,n=0,l=0,h=0,c=0;const u=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[i];t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),i++}else if(d.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),l++}else if(d.isRectAreaLight){const t=r.rectArea[h];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),o.identity(),a.copy(d.matrixWorld),a.premultiply(u),o.extractRotation(a),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(o),t.halfHeight.applyMatrix4(o),h++}else if(d.isPointLight){const t=r.point[n];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),n++}else if(d.isHemisphereLight){const t=r.hemi[c];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(u),c++}}},state:r}}function Hu(t,e){const i=new Vu(t,e),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:function(t){i.setup(n,t)},setupLightsView:function(t){i.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){r.push(t)}}}function Gu(t,e){let i=new WeakMap;return{get:function(n,r=0){const s=i.get(n);let a;return void 0===s?(a=new Hu(t,e),i.set(n,[a])):r>=s.length?(a=new Hu(t,e),s.push(a)):a=s[r],a},dispose:function(){i=new WeakMap}}}class Wu extends yl{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class Xu extends yl{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function qu(t,e,i){let n=new Th;const r=new Pa,s=new Pa,a=new Ja,o=new Wu({depthPacking:3201}),l=new Xu,h={},c=i.maxTextureSize,u={[ss]:as,[as]:ss,2:2},d=new uh({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Pa},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new Bl;f.setAttribute("position",new Pl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new rh(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=is;let _=this.type;function v(i,n){const s=e.update(m);d.defines.VSM_SAMPLES!==i.blurSamples&&(d.defines.VSM_SAMPLES=i.blurSamples,p.defines.VSM_SAMPLES=i.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new Qa(r.x,r.y)),d.uniforms.shadow_pass.value=i.map.texture,d.uniforms.resolution.value=i.mapSize,d.uniforms.radius.value=i.radius,t.setRenderTarget(i.mapPass),t.clear(),t.renderBufferDirect(n,null,s,d,m,null),p.uniforms.shadow_pass.value=i.mapPass.texture,p.uniforms.resolution.value=i.mapSize,p.uniforms.radius.value=i.radius,t.setRenderTarget(i.map),t.clear(),t.renderBufferDirect(n,null,s,p,m,null)}function y(e,i,n,r){let s=null;const a=!0===n.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===n.isPointLight?l:o,t.localClippingEnabled&&!0===i.clipShadows&&Array.isArray(i.clippingPlanes)&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0||i.map&&i.alphaTest>0){const t=s.uuid,e=i.uuid;let n=h[t];void 0===n&&(n={},h[t]=n);let r=n[e];void 0===r&&(r=s.clone(),n[e]=r),s=r}if(s.visible=i.visible,s.wireframe=i.wireframe,s.side=r===rs?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:u[i.side],s.alphaMap=i.alphaMap,s.alphaTest=i.alphaTest,s.map=i.map,s.clipShadows=i.clipShadows,s.clippingPlanes=i.clippingPlanes,s.clipIntersection=i.clipIntersection,s.displacementMap=i.displacementMap,s.displacementScale=i.displacementScale,s.displacementBias=i.displacementBias,s.wireframeLinewidth=i.wireframeLinewidth,s.linewidth=i.linewidth,!0===n.isPointLight&&!0===s.isMeshDistanceMaterial){t.properties.get(s).light=n}return s}function x(i,r,s,a,o){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&o===rs)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,i.matrixWorld);const n=e.update(i),r=i.material;if(Array.isArray(r)){const e=n.groups;for(let l=0,h=e.length;l<h;l++){const h=e[l],c=r[h.materialIndex];if(c&&c.visible){const e=y(i,c,a,o);t.renderBufferDirect(s,null,n,e,i,h)}}}else if(r.visible){const e=y(i,r,a,o);t.renderBufferDirect(s,null,n,e,i,null)}}const l=i.children;for(let t=0,e=l.length;t<e;t++)x(l[t],r,s,a,o)}this.render=function(e,i,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),h=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=_!==rs&&this.type===rs,f=_===rs&&this.type!==rs;for(let l=0,h=e.length;l<h;l++){const h=e[l],u=h.shadow;if(void 0===u)continue;if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;r.copy(u.mapSize);const m=u.getFrameExtents();if(r.multiply(m),s.copy(u.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/m.x),r.x=s.x*m.x,u.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/m.y),r.y=s.y*m.y,u.mapSize.y=s.y)),null===u.map||!0===p||!0===f){const t=this.type!==rs?{minFilter:ws,magFilter:ws}:{};null!==u.map&&u.map.dispose(),u.map=new Qa(r.x,r.y,t),u.map.texture.name=h.name+".shadowMap",u.camera.updateProjectionMatrix()}t.setRenderTarget(u.map),t.clear();const g=u.getViewportCount();for(let t=0;t<g;t++){const e=u.getViewport(t);a.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(a),u.updateMatrices(h,t),n=u.getFrustum(),x(i,o,u.camera,h,this.type)}!0!==u.isPointLightShadow&&this.type===rs&&v(u,o),u.needsUpdate=!1}_=this.type,g.needsUpdate=!1,t.setRenderTarget(l,h,u)}}function Yu(t,e,i){const n=i.isWebGL2;const r=new function(){let e=!1;const i=new Ja;let n=null;const r=new Ja(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,s,a,o){!0===o&&(e*=a,n*=a,s*=a),i.set(e,n,s,a),!1===r.equals(i)&&(t.clearColor(e,n,s,a),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}},s=new function(){let e=!1,i=null,n=null,r=null;return{setTest:function(e){e?B(t.DEPTH_TEST):V(t.DEPTH_TEST)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}},a=new function(){let e=!1,i=null,n=null,r=null,s=null,a=null,o=null,l=null,h=null;return{setTest:function(i){e||(i?B(t.STENCIL_TEST):V(t.STENCIL_TEST))},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,a){n===e&&r===i&&s===a||(t.stencilFunc(e,i,a),n=e,r=i,s=a)},setOp:function(e,i,n){a===e&&o===i&&l===n||(t.stencilOp(e,i,n),a=e,o=i,l=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,i=null,n=null,r=null,s=null,a=null,o=null,l=null,h=null}}},o=new WeakMap,l=new WeakMap;let h={},c={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,_=null,v=null,y=null,x=null,S=null,M=!1,b=null,T=null,w=null,E=null,A=null;const C=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let P=!1,L=0;const R=t.getParameter(t.VERSION);-1!==R.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(R)[1]),P=L>=1):-1!==R.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(R)[1]),P=L>=2);let D=null,I={};const U=t.getParameter(t.SCISSOR_BOX),N=t.getParameter(t.VIEWPORT),O=(new Ja).fromArray(U),k=(new Ja).fromArray(N);function F(e,i,r,s){const a=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let o=0;o<r;o++)!n||e!==t.TEXTURE_3D&&e!==t.TEXTURE_2D_ARRAY?t.texImage2D(i+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a):t.texImage3D(i,0,t.RGBA,1,1,s,0,t.RGBA,t.UNSIGNED_BYTE,a);return o}const z={};function B(e){!0!==h[e]&&(t.enable(e),h[e]=!0)}function V(e){!1!==h[e]&&(t.disable(e),h[e]=!1)}z[t.TEXTURE_2D]=F(t.TEXTURE_2D,t.TEXTURE_2D,1),z[t.TEXTURE_CUBE_MAP]=F(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(z[t.TEXTURE_2D_ARRAY]=F(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),z[t.TEXTURE_3D]=F(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),r.setClear(0,0,0,1),s.setClear(1),a.setClear(0),B(t.DEPTH_TEST),s.setFunc(3),X(!1),q(1),B(t.CULL_FACE),W(0);const H={[os]:t.FUNC_ADD,101:t.FUNC_SUBTRACT,102:t.FUNC_REVERSE_SUBTRACT};if(n)H[103]=t.MIN,H[104]=t.MAX;else{const t=e.get("EXT_blend_minmax");null!==t&&(H[103]=t.MIN_EXT,H[104]=t.MAX_EXT)}const G={200:t.ZERO,201:t.ONE,202:t.SRC_COLOR,204:t.SRC_ALPHA,210:t.SRC_ALPHA_SATURATE,208:t.DST_COLOR,206:t.DST_ALPHA,203:t.ONE_MINUS_SRC_COLOR,205:t.ONE_MINUS_SRC_ALPHA,209:t.ONE_MINUS_DST_COLOR,207:t.ONE_MINUS_DST_ALPHA};function W(e,i,n,r,s,a,o,l){if(0!==e){if(!1===f&&(B(t.BLEND),f=!0),5===e)s=s||i,a=a||n,o=o||r,i===g&&s===y||(t.blendEquationSeparate(H[i],H[s]),g=i,y=s),n===_&&r===v&&a===x&&o===S||(t.blendFuncSeparate(G[n],G[r],G[a],G[o]),_=n,v=r,x=a,S=o),m=e,M=!1;else if(e!==m||l!==M){if(g===os&&y===os||(t.blendEquation(t.FUNC_ADD),g=os,y=os),l)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFunc(t.ZERO,t.SRC_COLOR)}_=null,v=null,x=null,S=null,m=e,M=l}}else!0===f&&(V(t.BLEND),f=!1)}function X(e){b!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),b=e)}function q(e){0!==e?(B(t.CULL_FACE),e!==T&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):V(t.CULL_FACE),T=e}function Y(e,i,n){e?(B(t.POLYGON_OFFSET_FILL),E===i&&A===n||(t.polygonOffset(i,n),E=i,A=n)):V(t.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:s,stencil:a},enable:B,disable:V,bindFramebuffer:function(e,i){return c[e]!==i&&(t.bindFramebuffer(e,i),c[e]=i,n&&(e===t.DRAW_FRAMEBUFFER&&(c[t.FRAMEBUFFER]=i),e===t.FRAMEBUFFER&&(c[t.DRAW_FRAMEBUFFER]=i)),!0)},drawBuffers:function(n,r){let s=d,a=!1;if(n)if(s=u.get(r),void 0===s&&(s=[],u.set(r,s)),n.isWebGLMultipleRenderTargets){const e=n.texture;if(s.length!==e.length||s[0]!==t.COLOR_ATTACHMENT0){for(let i=0,n=e.length;i<n;i++)s[i]=t.COLOR_ATTACHMENT0+i;s.length=e.length,a=!0}}else s[0]!==t.COLOR_ATTACHMENT0&&(s[0]=t.COLOR_ATTACHMENT0,a=!0);else s[0]!==t.BACK&&(s[0]=t.BACK,a=!0);a&&(i.isWebGL2?t.drawBuffers(s):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(e){return p!==e&&(t.useProgram(e),p=e,!0)},setBlending:W,setMaterial:function(e,i){2===e.side?V(t.CULL_FACE):B(t.CULL_FACE);let n=e.side===as;i&&(n=!n),X(n),1===e.blending&&!1===e.transparent?W(0):W(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),r.setMask(e.colorWrite);const o=e.stencilWrite;a.setTest(o),o&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Y(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?B(t.SAMPLE_ALPHA_TO_COVERAGE):V(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:X,setCullFace:q,setLineWidth:function(e){e!==w&&(P&&t.lineWidth(e),w=e)},setPolygonOffset:Y,setScissorTest:function(e){e?B(t.SCISSOR_TEST):V(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+C-1),D!==e&&(t.activeTexture(e),D=e)},bindTexture:function(e,i,n){void 0===n&&(n=null===D?t.TEXTURE0+C-1:D);let r=I[n];void 0===r&&(r={type:void 0,texture:void 0},I[n]=r),r.type===e&&r.texture===i||(D!==n&&(t.activeTexture(n),D=n),t.bindTexture(e,i||z[e]),r.type=e,r.texture=i)},unbindTexture:function(){const e=I[D];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(t){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){}},updateUBOMapping:function(e,i){let n=l.get(i);void 0===n&&(n=new WeakMap,l.set(i,n));let r=n.get(e);void 0===r&&(r=t.getUniformBlockIndex(i,e.name),n.set(e,r))},uniformBlockBinding:function(e,i){const n=l.get(i).get(e);o.get(i)!==n&&(t.uniformBlockBinding(i,n,e.__bindingPointIndex),o.set(i,n))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(t){}},scissor:function(e){!1===O.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),O.copy(e))},viewport:function(e){!1===k.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),k.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),!0===n&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},D=null,I={},c={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,_=null,v=null,y=null,x=null,S=null,M=!1,b=null,T=null,w=null,E=null,A=null,O.set(0,0,t.canvas.width,t.canvas.height),k.set(0,0,t.canvas.width,t.canvas.height),r.reset(),s.reset(),a.reset()}}}function ju(t,e,i,n,r,s,a){const o=r.isWebGL2,l=(r.maxTextures,r.maxCubemapSize),h=r.maxTextureSize,c=r.maxSamples,u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let f;const m=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function _(t,e){return g?new OffscreenCanvas(t,e):Ia("canvas")}function v(t,e,i,n){let r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=e?wa:Math.floor,s=n(r*t.width),a=n(r*t.height);void 0===f&&(f=_(s,a));const o=i?_(s,a):f;o.width=s,o.height=a;return o.getContext("2d").drawImage(t,0,0,s,a),o}return t}return t}function y(t){return ba(t.width)&&ba(t.height)}function x(t,e){return t.generateMipmaps&&e&&t.minFilter!==ws&&t.minFilter!==Cs}function S(e){t.generateMipmap(e)}function M(i,n,r,s,a=!1){if(!1===o)return n;if(null!==i&&void 0!==t[i])return t[i];let l=n;if(n===t.RED&&(r===t.FLOAT&&(l=t.R32F),r===t.HALF_FLOAT&&(l=t.R16F),r===t.UNSIGNED_BYTE&&(l=t.R8)),n===t.RED_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.R8UI),r===t.UNSIGNED_SHORT&&(l=t.R16UI),r===t.UNSIGNED_INT&&(l=t.R32UI),r===t.BYTE&&(l=t.R8I),r===t.SHORT&&(l=t.R16I),r===t.INT&&(l=t.R32I)),n===t.RG&&(r===t.FLOAT&&(l=t.RG32F),r===t.HALF_FLOAT&&(l=t.RG16F),r===t.UNSIGNED_BYTE&&(l=t.RG8)),n===t.RGBA){const e=a?ra:Va.getTransfer(s);r===t.FLOAT&&(l=t.RGBA32F),r===t.HALF_FLOAT&&(l=t.RGBA16F),r===t.UNSIGNED_BYTE&&(l=e===sa?t.SRGB8_ALPHA8:t.RGBA8),r===t.UNSIGNED_SHORT_4_4_4_4&&(l=t.RGBA4),r===t.UNSIGNED_SHORT_5_5_5_1&&(l=t.RGB5_A1)}return l!==t.R16F&&l!==t.R32F&&l!==t.RG16F&&l!==t.RG32F&&l!==t.RGBA16F&&l!==t.RGBA32F||e.get("EXT_color_buffer_float"),l}function b(t,e,i){return!0===x(t,i)||t.isFramebufferTexture&&t.minFilter!==ws&&t.minFilter!==Cs?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function T(e){return e===ws||e===Es||e===As?t.NEAREST:t.LINEAR}function w(t){const e=t.target;e.removeEventListener("dispose",w),function(t){const e=n.get(t);if(void 0===e.__webglInit)return;const i=t.source,r=m.get(i);if(r){const n=r[e.__cacheKey];n.usedTimes--,0===n.usedTimes&&A(t),0===Object.keys(r).length&&m.delete(i)}n.remove(t)}(e),e.isVideoTexture&&p.delete(e)}function E(e){const i=e.target;i.removeEventListener("dispose",E),function(e){const i=e.texture,r=n.get(e),s=n.get(i);void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),a.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++){if(Array.isArray(r.__webglFramebuffer[e]))for(let i=0;i<r.__webglFramebuffer[e].length;i++)t.deleteFramebuffer(r.__webglFramebuffer[e][i]);else t.deleteFramebuffer(r.__webglFramebuffer[e]);r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e])}else{if(Array.isArray(r.__webglFramebuffer))for(let e=0;e<r.__webglFramebuffer.length;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let e=0;e<r.__webglColorRenderbuffer.length;e++)r.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(r.__webglColorRenderbuffer[e]);r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let e=0,r=i.length;e<r;e++){const r=n.get(i[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),a.memory.textures--),n.remove(i[e])}n.remove(i),n.remove(e)}(i)}function A(e){const i=n.get(e);t.deleteTexture(i.__webglTexture);const r=e.source;delete m.get(r)[i.__cacheKey],a.memory.textures--}let C=0;function P(e,r){const s=n.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version){const t=e.image;if(null===t);else if(!1!==t.complete)return void N(s,e,r)}i.bindTexture(t.TEXTURE_2D,s.__webglTexture,t.TEXTURE0+r)}const L={[Ms]:t.REPEAT,[bs]:t.CLAMP_TO_EDGE,[Ts]:t.MIRRORED_REPEAT},R={[ws]:t.NEAREST,[Es]:t.NEAREST_MIPMAP_NEAREST,[As]:t.NEAREST_MIPMAP_LINEAR,[Cs]:t.LINEAR,1007:t.LINEAR_MIPMAP_NEAREST,[Ps]:t.LINEAR_MIPMAP_LINEAR},D={512:t.NEVER,519:t.ALWAYS,513:t.LESS,515:t.LEQUAL,514:t.EQUAL,518:t.GEQUAL,516:t.GREATER,517:t.NOTEQUAL};function I(i,s,a){if(a?(t.texParameteri(i,t.TEXTURE_WRAP_S,L[s.wrapS]),t.texParameteri(i,t.TEXTURE_WRAP_T,L[s.wrapT]),i!==t.TEXTURE_3D&&i!==t.TEXTURE_2D_ARRAY||t.texParameteri(i,t.TEXTURE_WRAP_R,L[s.wrapR]),t.texParameteri(i,t.TEXTURE_MAG_FILTER,R[s.magFilter]),t.texParameteri(i,t.TEXTURE_MIN_FILTER,R[s.minFilter])):(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i!==t.TEXTURE_3D&&i!==t.TEXTURE_2D_ARRAY||t.texParameteri(i,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),s.wrapS!==bs||s.wrapT,t.texParameteri(i,t.TEXTURE_MAG_FILTER,T(s.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,T(s.minFilter)),s.minFilter!==ws&&s.minFilter),s.compareFunction&&(t.texParameteri(i,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(i,t.TEXTURE_COMPARE_FUNC,D[s.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(s.magFilter===ws)return;if(s.minFilter!==As&&s.minFilter!==Ps)return;if(s.type===Us&&!1===e.has("OES_texture_float_linear"))return;if(!1===o&&s.type===Ns&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(t.texParameterf(i,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function U(e,i){let n=!1;void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",w));const r=i.source;let s=m.get(r);void 0===s&&(s={},m.set(r,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(i);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,n=!0),s[o].usedTimes++;const r=s[e.__cacheKey];void 0!==r&&(s[e.__cacheKey].usedTimes--,0===r.usedTimes&&A(i)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return n}function N(e,r,a){let l=t.TEXTURE_2D;(r.isDataArrayTexture||r.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),r.isData3DTexture&&(l=t.TEXTURE_3D);const c=U(e,r),u=r.source;i.bindTexture(l,e.__webglTexture,t.TEXTURE0+a);const d=n.get(u);if(u.version!==d.__version||!0===c){i.activeTexture(t.TEXTURE0+a);const e=Va.getPrimaries(Va.workingColorSpace),n=r.colorSpace===Qs?null:Va.getPrimaries(r.colorSpace),p=r.colorSpace===Qs||e===n?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);const f=function(t){return!o&&(t.wrapS!==bs||t.wrapT!==bs||t.minFilter!==ws&&t.minFilter!==Cs)}(r)&&!1===y(r.image);let m=v(r.image,f,!1,h);m=V(r,m);const g=y(m)||o,_=s.convert(r.format,r.colorSpace);let T,w=s.convert(r.type),E=M(r.internalFormat,_,w,r.colorSpace,r.isVideoTexture);I(l,r,g);const A=r.mipmaps,C=o&&!0!==r.isVideoTexture,P=void 0===d.__version||!0===c,L=b(r,m,g);if(r.isDepthTexture)E=t.DEPTH_COMPONENT,o?E=r.type===Us?t.DEPTH_COMPONENT32F:r.type===Is?t.DEPTH_COMPONENT24:r.type===Os?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT16:r.type,r.format===Fs&&E===t.DEPTH_COMPONENT&&r.type!==Rs&&r.type!==Is&&(r.type=Is,w=s.convert(r.type)),r.format===zs&&E===t.DEPTH_COMPONENT&&(E=t.DEPTH_STENCIL,r.type!==Os&&(r.type=Os,w=s.convert(r.type))),P&&(C?i.texStorage2D(t.TEXTURE_2D,1,E,m.width,m.height):i.texImage2D(t.TEXTURE_2D,0,E,m.width,m.height,0,_,w,null));else if(r.isDataTexture)if(A.length>0&&g){C&&P&&i.texStorage2D(t.TEXTURE_2D,L,E,A[0].width,A[0].height);for(let e=0,n=A.length;e<n;e++)T=A[e],C?i.texSubImage2D(t.TEXTURE_2D,e,0,0,T.width,T.height,_,w,T.data):i.texImage2D(t.TEXTURE_2D,e,E,T.width,T.height,0,_,w,T.data);r.generateMipmaps=!1}else C?(P&&i.texStorage2D(t.TEXTURE_2D,L,E,m.width,m.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,m.width,m.height,_,w,m.data)):i.texImage2D(t.TEXTURE_2D,0,E,m.width,m.height,0,_,w,m.data);else if(r.isCompressedTexture)if(r.isCompressedArrayTexture){C&&P&&i.texStorage3D(t.TEXTURE_2D_ARRAY,L,E,A[0].width,A[0].height,m.depth);for(let e=0,n=A.length;e<n;e++)T=A[e],r.format!==ks?null!==_&&(C?i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,T.width,T.height,m.depth,_,T.data,0,0):i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,E,T.width,T.height,m.depth,0,T.data,0,0)):C?i.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,T.width,T.height,m.depth,_,w,T.data):i.texImage3D(t.TEXTURE_2D_ARRAY,e,E,T.width,T.height,m.depth,0,_,w,T.data)}else{C&&P&&i.texStorage2D(t.TEXTURE_2D,L,E,A[0].width,A[0].height);for(let e=0,n=A.length;e<n;e++)T=A[e],r.format!==ks?null!==_&&(C?i.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,T.width,T.height,_,T.data):i.compressedTexImage2D(t.TEXTURE_2D,e,E,T.width,T.height,0,T.data)):C?i.texSubImage2D(t.TEXTURE_2D,e,0,0,T.width,T.height,_,w,T.data):i.texImage2D(t.TEXTURE_2D,e,E,T.width,T.height,0,_,w,T.data)}else if(r.isDataArrayTexture)C?(P&&i.texStorage3D(t.TEXTURE_2D_ARRAY,L,E,m.width,m.height,m.depth),i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,m.width,m.height,m.depth,_,w,m.data)):i.texImage3D(t.TEXTURE_2D_ARRAY,0,E,m.width,m.height,m.depth,0,_,w,m.data);else if(r.isData3DTexture)C?(P&&i.texStorage3D(t.TEXTURE_3D,L,E,m.width,m.height,m.depth),i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,m.width,m.height,m.depth,_,w,m.data)):i.texImage3D(t.TEXTURE_3D,0,E,m.width,m.height,m.depth,0,_,w,m.data);else if(r.isFramebufferTexture){if(P)if(C)i.texStorage2D(t.TEXTURE_2D,L,E,m.width,m.height);else{let e=m.width,n=m.height;for(let r=0;r<L;r++)i.texImage2D(t.TEXTURE_2D,r,E,e,n,0,_,w,null),e>>=1,n>>=1}}else if(A.length>0&&g){C&&P&&i.texStorage2D(t.TEXTURE_2D,L,E,A[0].width,A[0].height);for(let e=0,n=A.length;e<n;e++)T=A[e],C?i.texSubImage2D(t.TEXTURE_2D,e,0,0,_,w,T):i.texImage2D(t.TEXTURE_2D,e,E,_,w,T);r.generateMipmaps=!1}else C?(P&&i.texStorage2D(t.TEXTURE_2D,L,E,m.width,m.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,_,w,m)):i.texImage2D(t.TEXTURE_2D,0,E,_,w,m);x(r,g)&&S(l),d.__version=u.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}function O(e,r,a,o,l,h){const c=s.convert(a.format,a.colorSpace),d=s.convert(a.type),p=M(a.internalFormat,c,d,a.colorSpace);if(!n.get(r).__hasExternalTextures){const e=Math.max(1,r.width>>h),n=Math.max(1,r.height>>h);l===t.TEXTURE_3D||l===t.TEXTURE_2D_ARRAY?i.texImage3D(l,h,p,e,n,r.depth,0,c,d,null):i.texImage2D(l,h,p,e,n,0,c,d,null)}i.bindFramebuffer(t.FRAMEBUFFER,e),B(r)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,o,l,n.get(a).__webglTexture,0,z(r)):(l===t.TEXTURE_2D||l>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,o,l,n.get(a).__webglTexture,h),i.bindFramebuffer(t.FRAMEBUFFER,null)}function k(e,i,n){if(t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer&&!i.stencilBuffer){let r=!0===o?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(n||B(i)){const e=i.depthTexture;e&&e.isDepthTexture&&(e.type===Us?r=t.DEPTH_COMPONENT32F:e.type===Is&&(r=t.DEPTH_COMPONENT24));const n=z(i);B(i)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,n,r,i.width,i.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,n,r,i.width,i.height)}else t.renderbufferStorage(t.RENDERBUFFER,r,i.width,i.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}else if(i.depthBuffer&&i.stencilBuffer){const r=z(i);n&&!1===B(i)?t.renderbufferStorageMultisample(t.RENDERBUFFER,r,t.DEPTH24_STENCIL8,i.width,i.height):B(i)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,r,t.DEPTH24_STENCIL8,i.width,i.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)}else{const e=!0===i.isWebGLMultipleRenderTargets?i.texture:[i.texture];for(let r=0;r<e.length;r++){const a=e[r],o=s.convert(a.format,a.colorSpace),l=s.convert(a.type),h=M(a.internalFormat,o,l,a.colorSpace),c=z(i);n&&!1===B(i)?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,h,i.width,i.height):B(i)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,h,i.width,i.height):t.renderbufferStorage(t.RENDERBUFFER,h,i.width,i.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function F(e){const r=n.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),P(r.depthTexture,0);const s=n.get(r.depthTexture).__webglTexture,a=z(r);if(r.depthTexture.format===Fs)B(r)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,s,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,s,0);else{if(r.depthTexture.format!==zs)throw new Error("Unknown depthTexture format");B(r)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,s,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,s,0)}}(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)i.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=t.createRenderbuffer(),k(r.__webglDepthbuffer[n],e,!1)}else i.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),k(r.__webglDepthbuffer,e,!1);i.bindFramebuffer(t.FRAMEBUFFER,null)}function z(t){return Math.min(c,t.samples)}function B(t){const i=n.get(t);return o&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function V(t,i){const n=t.colorSpace,r=t.format;t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===ua||n!==ea&&n!==Qs&&Va.getTransfer(n)===sa&&!1===o&&(!0===e.has("EXT_sRGB")&&r===ks?(t.format=ua,t.minFilter=Cs,t.generateMipmaps=!1):i=Xa.sRGBToLinear(i)),i}this.allocateTextureUnit=function(){const t=C;return C+=1,t},this.resetTextureUnits=function(){C=0},this.setTexture2D=P,this.setTexture2DArray=function(e,r){const s=n.get(e);e.version>0&&s.__version!==e.version?N(s,e,r):i.bindTexture(t.TEXTURE_2D_ARRAY,s.__webglTexture,t.TEXTURE0+r)},this.setTexture3D=function(e,r){const s=n.get(e);e.version>0&&s.__version!==e.version?N(s,e,r):i.bindTexture(t.TEXTURE_3D,s.__webglTexture,t.TEXTURE0+r)},this.setTextureCube=function(e,r){const a=n.get(e);e.version>0&&a.__version!==e.version?function(e,r,a){if(6!==r.image.length)return;const h=U(e,r),c=r.source;i.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+a);const u=n.get(c);if(c.version!==u.__version||!0===h){i.activeTexture(t.TEXTURE0+a);const e=Va.getPrimaries(Va.workingColorSpace),n=r.colorSpace===Qs?null:Va.getPrimaries(r.colorSpace),d=r.colorSpace===Qs||e===n?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const p=r.isCompressedTexture||r.image[0].isCompressedTexture,f=r.image[0]&&r.image[0].isDataTexture,m=[];for(let t=0;t<6;t++)m[t]=p||f?f?r.image[t].image:r.image[t]:v(r.image[t],!1,!0,l),m[t]=V(r,m[t]);const g=m[0],_=y(g)||o,T=s.convert(r.format,r.colorSpace),w=s.convert(r.type),E=M(r.internalFormat,T,w,r.colorSpace),A=o&&!0!==r.isVideoTexture,C=void 0===u.__version||!0===h;let P,L=b(r,g,_);if(I(t.TEXTURE_CUBE_MAP,r,_),p){A&&C&&i.texStorage2D(t.TEXTURE_CUBE_MAP,L,E,g.width,g.height);for(let e=0;e<6;e++){P=m[e].mipmaps;for(let n=0;n<P.length;n++){const s=P[n];r.format!==ks?null!==T&&(A?i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,0,0,s.width,s.height,T,s.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,E,s.width,s.height,0,s.data)):A?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,0,0,s.width,s.height,T,w,s.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,E,s.width,s.height,0,T,w,s.data)}}}else{P=r.mipmaps,A&&C&&(P.length>0&&L++,i.texStorage2D(t.TEXTURE_CUBE_MAP,L,E,m[0].width,m[0].height));for(let e=0;e<6;e++)if(f){A?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,m[e].width,m[e].height,T,w,m[e].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,m[e].width,m[e].height,0,T,w,m[e].data);for(let n=0;n<P.length;n++){const r=P[n].image[e].image;A?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,r.width,r.height,T,w,r.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,E,r.width,r.height,0,T,w,r.data)}}else{A?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,T,w,m[e]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,E,T,w,m[e]);for(let n=0;n<P.length;n++){const r=P[n];A?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,0,0,T,w,r.image[e]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n+1,E,T,w,r.image[e])}}}x(r,_)&&S(t.TEXTURE_CUBE_MAP),u.__version=c.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}(a,e,r):i.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture,t.TEXTURE0+r)},this.rebindTextures=function(e,i,r){const s=n.get(e);void 0!==i&&O(s.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==r&&F(e)},this.setupRenderTarget=function(e){const l=e.texture,h=n.get(e),c=n.get(l);e.addEventListener("dispose",E),!0!==e.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=t.createTexture()),c.__version=l.version,a.memory.textures++);const u=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=y(e)||o;if(u){h.__webglFramebuffer=[];for(let e=0;e<6;e++)if(o&&l.mipmaps&&l.mipmaps.length>0){h.__webglFramebuffer[e]=[];for(let i=0;i<l.mipmaps.length;i++)h.__webglFramebuffer[e][i]=t.createFramebuffer()}else h.__webglFramebuffer[e]=t.createFramebuffer()}else{if(o&&l.mipmaps&&l.mipmaps.length>0){h.__webglFramebuffer=[];for(let e=0;e<l.mipmaps.length;e++)h.__webglFramebuffer[e]=t.createFramebuffer()}else h.__webglFramebuffer=t.createFramebuffer();if(d&&r.drawBuffers){const i=e.texture;for(let e=0,r=i.length;e<r;e++){const r=n.get(i[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),a.memory.textures++)}}if(o&&e.samples>0&&!1===B(e)){const n=d?l:[l];h.__webglMultisampledFramebuffer=t.createFramebuffer(),h.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer);for(let i=0;i<n.length;i++){const r=n[i];h.__webglColorRenderbuffer[i]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,h.__webglColorRenderbuffer[i]);const a=s.convert(r.format,r.colorSpace),o=s.convert(r.type),l=M(r.internalFormat,a,o,r.colorSpace,!0===e.isXRRenderTarget),c=z(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+i,t.RENDERBUFFER,h.__webglColorRenderbuffer[i])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(h.__webglDepthRenderbuffer=t.createRenderbuffer(),k(h.__webglDepthRenderbuffer,e,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(u){i.bindTexture(t.TEXTURE_CUBE_MAP,c.__webglTexture),I(t.TEXTURE_CUBE_MAP,l,p);for(let i=0;i<6;i++)if(o&&l.mipmaps&&l.mipmaps.length>0)for(let n=0;n<l.mipmaps.length;n++)O(h.__webglFramebuffer[i][n],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+i,n);else O(h.__webglFramebuffer[i],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0);x(l,p)&&S(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(d){const r=e.texture;for(let s=0,a=r.length;s<a;s++){const a=r[s],o=n.get(a);i.bindTexture(t.TEXTURE_2D,o.__webglTexture),I(t.TEXTURE_2D,a,p),O(h.__webglFramebuffer,e,a,t.COLOR_ATTACHMENT0+s,t.TEXTURE_2D,0),x(a,p)&&S(t.TEXTURE_2D)}i.unbindTexture()}else{let n=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&o&&(n=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),i.bindTexture(n,c.__webglTexture),I(n,l,p),o&&l.mipmaps&&l.mipmaps.length>0)for(let i=0;i<l.mipmaps.length;i++)O(h.__webglFramebuffer[i],e,l,t.COLOR_ATTACHMENT0,n,i);else O(h.__webglFramebuffer,e,l,t.COLOR_ATTACHMENT0,n,0);x(l,p)&&S(n),i.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(e){const r=y(e)||o,s=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let a=0,o=s.length;a<o;a++){const o=s[a];if(x(o,r)){const r=e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,s=n.get(o).__webglTexture;i.bindTexture(r,s),S(r),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(o&&e.samples>0&&!1===B(e)){const r=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],s=e.width,a=e.height;let o=t.COLOR_BUFFER_BIT;const l=[],h=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=n.get(e),u=!0===e.isWebGLMultipleRenderTargets;if(u)for(let e=0;e<r.length;e++)i.bindFramebuffer(t.FRAMEBUFFER,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(let i=0;i<r.length;i++){l.push(t.COLOR_ATTACHMENT0+i),e.depthBuffer&&l.push(h);const p=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===p&&(e.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&(o|=t.STENCIL_BUFFER_BIT)),u&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,c.__webglColorRenderbuffer[i]),!0===p&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[h]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[h])),u){const e=n.get(r[i]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,t.NEAREST),d&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l)}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),u)for(let e=0;e<r.length;e++){i.bindFramebuffer(t.FRAMEBUFFER,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,c.__webglColorRenderbuffer[e]);const s=n.get(r[e]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,s,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=O,this.useMultisampledRTT=B}function Zu(t,e,i){const n=i.isWebGL2;return{convert:function(i,r=""){let s;const a=Va.getTransfer(r);if(i===Ls)return t.UNSIGNED_BYTE;if(1017===i)return t.UNSIGNED_SHORT_4_4_4_4;if(1018===i)return t.UNSIGNED_SHORT_5_5_5_1;if(1010===i)return t.BYTE;if(1011===i)return t.SHORT;if(i===Rs)return t.UNSIGNED_SHORT;if(i===Ds)return t.INT;if(i===Is)return t.UNSIGNED_INT;if(i===Us)return t.FLOAT;if(i===Ns)return n?t.HALF_FLOAT:(s=e.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(1021===i)return t.ALPHA;if(i===ks)return t.RGBA;if(1024===i)return t.LUMINANCE;if(1025===i)return t.LUMINANCE_ALPHA;if(i===Fs)return t.DEPTH_COMPONENT;if(i===zs)return t.DEPTH_STENCIL;if(i===ua)return s=e.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(1028===i)return t.RED;if(1029===i)return t.RED_INTEGER;if(1030===i)return t.RG;if(1031===i)return t.RG_INTEGER;if(1033===i)return t.RGBA_INTEGER;if(i===Bs||i===Vs||i===Hs||i===Gs)if(a===sa){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(i===Bs)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Vs)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Hs)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Gs)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(i===Bs)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Vs)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Hs)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Gs)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===i||35841===i||35842===i||35843===i){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(35840===i)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===i)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===i)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===i)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===i)return s=e.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===i||37496===i){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(37492===i)return a===sa?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(37496===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(37808===i||37809===i||37810===i||37811===i||37812===i||37813===i||37814===i||37815===i||37816===i||37817===i||37818===i||37819===i||37820===i||37821===i){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(37808===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===i)return a===sa?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===Ws||36494===i||36495===i){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(i===Ws)return a===sa?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===i)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===i)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===i||36284===i||36285===i||36286===i){if(s=e.get("EXT_texture_compression_rgtc"),null===s)return null;if(i===Ws)return s.COMPRESSED_RED_RGTC1_EXT;if(36284===i)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===i)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===i)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Os?n?t.UNSIGNED_INT_24_8:(s=e.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[i]?t[i]:null}}}class Ku extends ph{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class Ju extends sl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $u={type:"move"};class Qu{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ju,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ju,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new no,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new no),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ju,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new no,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new no),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,i){let n=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){s=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,i),r=this._getHandJoint(l,n);null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=t.radius),r.visible=null!==t}const n=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=n.position.distanceTo(r.position),o=.02,h=.005;l.inputState.pinching&&a>o+h?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=o-h&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(r=e.getPose(t.gripSpace,i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(n=e.getPose(t.targetRaySpace,i),null===n&&null!==r&&(n=r),null!==n&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent($u)))}return null!==a&&(a.visible=null!==n),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const i=new Ju;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}}class td extends Ka{constructor(t,e,i,n,r,s,a,o,l,h){if((h=void 0!==h?h:Fs)!==Fs&&h!==zs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===Fs&&(i=Is),void 0===i&&h===zs&&(i=Os),super(null,n,r,s,a,o,h,i,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==a?a:ws,this.minFilter=void 0!==o?o:ws,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class ed extends fa{constructor(t,e){super();const i=this;let n=null,r=1,s=null,a="local-floor",o=1,l=null,h=null,c=null,u=null,d=null,p=null;const f=e.getContextAttributes();let m=null,g=null;const _=[],v=[],y=new ph;y.layers.enable(1),y.viewport=new Ja;const x=new ph;x.layers.enable(2),x.viewport=new Ja;const S=[y,x],M=new Ku;M.layers.enable(1),M.layers.enable(2);let b=null,T=null;function w(t){const e=v.indexOf(t.inputSource);if(-1===e)return;const i=_[e];void 0!==i&&(i.update(t.inputSource,t.frame,l||s),i.dispatchEvent({type:t.type,data:t.inputSource}))}function E(){n.removeEventListener("select",w),n.removeEventListener("selectstart",w),n.removeEventListener("selectend",w),n.removeEventListener("squeeze",w),n.removeEventListener("squeezestart",w),n.removeEventListener("squeezeend",w),n.removeEventListener("end",E),n.removeEventListener("inputsourceschange",A);for(let t=0;t<_.length;t++){const e=v[t];null!==e&&(v[t]=null,_[t].disconnect(e))}b=null,T=null,t.setRenderTarget(m),d=null,u=null,c=null,n=null,g=null,D.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function A(t){for(let e=0;e<t.removed.length;e++){const i=t.removed[e],n=v.indexOf(i);n>=0&&(v[n]=null,_[n].disconnect(i))}for(let e=0;e<t.added.length;e++){const i=t.added[e];let n=v.indexOf(i);if(-1===n){for(let t=0;t<_.length;t++){if(t>=v.length){v.push(i),n=t;break}if(null===v[t]){v[t]=i,n=t;break}}if(-1===n)break}const r=_[n];r&&r.connect(i)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=_[t];return void 0===e&&(e=new Qu,_[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=_[t];return void 0===e&&(e=new Qu,_[t]=e),e.getGripSpace()},this.getHand=function(t){let e=_[t];return void 0===e&&(e=new Qu,_[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,i.isPresenting},this.setReferenceSpaceType=function(t){a=t,i.isPresenting},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(h){if(n=h,null!==n){if(m=t.getRenderTarget(),n.addEventListener("select",w),n.addEventListener("selectstart",w),n.addEventListener("selectend",w),n.addEventListener("squeeze",w),n.addEventListener("squeezestart",w),n.addEventListener("squeezeend",w),n.addEventListener("end",E),n.addEventListener("inputsourceschange",A),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===n.renderState.layers||!1===t.capabilities.isWebGL2){const i={antialias:void 0!==n.renderState.layers||f.antialias,alpha:!0,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(n,e,i),n.updateRenderState({baseLayer:d}),g=new Qa(d.framebufferWidth,d.framebufferHeight,{format:ks,type:Ls,colorSpace:t.outputColorSpace,stencilBuffer:f.stencil})}else{let i=null,s=null,a=null;f.depth&&(a=f.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,i=f.stencil?zs:Fs,s=f.stencil?Os:Is);const o={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:r};c=new XRWebGLBinding(n,e),u=c.createProjectionLayer(o),n.updateRenderState({layers:[u]}),g=new Qa(u.textureWidth,u.textureHeight,{format:ks,type:Ls,depthTexture:new td(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:f.stencil,colorSpace:t.outputColorSpace,samples:f.antialias?4:0});t.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await n.requestReferenceSpace(a),D.setContext(n),D.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode};const C=new no,P=new no;function L(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===n)return;M.near=x.near=y.near=t.near,M.far=x.far=y.far=t.far,b===M.near&&T===M.far||(n.updateRenderState({depthNear:M.near,depthFar:M.far}),b=M.near,T=M.far);const e=t.parent,i=M.cameras;L(M,e);for(let t=0;t<i.length;t++)L(i[t],e);2===i.length?function(t,e,i){C.setFromMatrixPosition(e.matrixWorld),P.setFromMatrixPosition(i.matrixWorld);const n=C.distanceTo(P),r=e.projectionMatrix.elements,s=i.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],h=(r[9]-1)/r[5],c=(r[8]-1)/r[0],u=(s[8]+1)/s[0],d=a*c,p=a*u,f=n/(-c+u),m=f*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+f,_=o+f,v=d-m,y=p+(n-m),x=l*o/_*g,S=h*o/_*g;t.projectionMatrix.makePerspective(v,y,x,S,g,_),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}(M,y,x):M.projectionMatrix.copy(y.projectionMatrix),function(t,e,i){null===i?t.matrix.copy(e.matrixWorld):(t.matrix.copy(i.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*va*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,M,e)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==u||null!==d)return o},this.setFoveation=function(t){o=t,null!==u&&(u.fixedFoveation=t),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=t)};let R=null;const D=new wh;D.setAnimationLoop((function(e,n){if(h=n.getViewerPose(l||s),p=n,null!==h){const e=h.views;null!==d&&(t.setRenderTargetFramebuffer(g,d.framebuffer),t.setRenderTarget(g));let i=!1;e.length!==M.cameras.length&&(M.cameras.length=0,i=!0);for(let n=0;n<e.length;n++){const r=e[n];let s=null;if(null!==d)s=d.getViewport(r);else{const e=c.getViewSubImage(u,r);s=e.viewport,0===n&&(t.setRenderTargetTextures(g,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}let a=S[n];void 0===a&&(a=new ph,a.layers.enable(n),a.viewport=new Ja,S[n]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&(M.matrix.copy(a.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===i&&M.cameras.push(a)}}for(let t=0;t<_.length;t++){const e=v[t],i=_[t];null!==e&&void 0!==i&&i.update(e,n,l||s)}R&&R(e,n),n.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:n}),p=null})),this.setAnimationLoop=function(t){R=t},this.dispose=function(){}}}function id(t,e){function i(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map,i(r.map,n.mapTransform)),r.alphaMap&&(n.alphaMap.value=r.alphaMap,i(r.alphaMap,n.alphaMapTransform)),r.bumpMap&&(n.bumpMap.value=r.bumpMap,i(r.bumpMap,n.bumpMapTransform),n.bumpScale.value=r.bumpScale,r.side===as&&(n.bumpScale.value*=-1)),r.normalMap&&(n.normalMap.value=r.normalMap,i(r.normalMap,n.normalMapTransform),n.normalScale.value.copy(r.normalScale),r.side===as&&n.normalScale.value.negate()),r.displacementMap&&(n.displacementMap.value=r.displacementMap,i(r.displacementMap,n.displacementMapTransform),n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap,i(r.emissiveMap,n.emissiveMapTransform)),r.specularMap&&(n.specularMap.value=r.specularMap,i(r.specularMap,n.specularMapTransform)),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const s=e.get(r).envMap;if(s&&(n.envMap.value=s,n.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const e=!0===t._useLegacyLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*e,i(r.lightMap,n.lightMapTransform)}r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity,i(r.aoMap,n.aoMapTransform))}return{refreshFogUniforms:function(e,i){i.color.getRGB(e.fogColor.value,hh(t)),i.isFog?(e.fogNear.value=i.near,e.fogFar.value=i.far):i.isFogExp2&&(e.fogDensity.value=i.density)},refreshMaterialUniforms:function(t,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(t,r):r.isMeshToonMaterial?(n(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(n(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(n(t,r),function(t,n){t.metalness.value=n.metalness,n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap,i(n.metalnessMap,t.metalnessMapTransform));t.roughness.value=n.roughness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap,i(n.roughnessMap,t.roughnessMapTransform));const r=e.get(n).envMap;r&&(t.envMapIntensity.value=n.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,i(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,i(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,i(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,i(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,i(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),e.side===as&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,i(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,i(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,i(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,i(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,i(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,i(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,i(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,r,o)):r.isMeshMatcapMaterial?(n(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?n(t,r):r.isMeshDistanceMaterial?(n(t,r),function(t,i){const n=e.get(i).light;t.referencePosition.value.setFromMatrixPosition(n.matrixWorld),t.nearDistance.value=n.shadow.camera.near,t.farDistance.value=n.shadow.camera.far}(t,r)):r.isMeshNormalMaterial?n(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,i(e.map,t.mapTransform))}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map,i(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,i(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r,s,a):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,i(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,i(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function nd(t,e,i,n){let r={},s={},a=[];const o=i.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(t,e,i){const n=t.value;if(void 0===i[e]){if("number"==typeof n)i[e]=n;else{const t=Array.isArray(n)?n:[n],r=[];for(let e=0;e<t.length;e++)r.push(t[e].clone());i[e]=r}return!0}if("number"==typeof n){if(i[e]!==n)return i[e]=n,!0}else{const t=Array.isArray(i[e])?i[e]:[i[e]],r=Array.isArray(n)?n:[n];for(let e=0;e<t.length;e++){const i=t[e];if(!1===i.equals(r[e]))return i.copy(r[e]),!0}}return!1}function h(t){const e={boundary:0,storage:0};return"number"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture,e}function c(e){const i=e.target;i.removeEventListener("dispose",c);const n=a.indexOf(i.__bindingPointIndex);a.splice(n,1),t.deleteBuffer(r[i.id]),delete r[i.id],delete s[i.id]}return{bind:function(t,e){const i=e.program;n.uniformBlockBinding(t,i)},update:function(i,u){let d=r[i.id];void 0===d&&(!function(t){const e=t.uniforms;let i=0;const n=16;let r=0;for(let t=0,s=e.length;t<s;t++){const s=e[t],a={boundary:0,storage:0},o=Array.isArray(s.value)?s.value:[s.value];for(let t=0,e=o.length;t<e;t++){const e=h(o[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(s.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=i,t>0){r=i%n;0!==r&&n-r-a.boundary<0&&(i+=n-r,s.__offset=i)}i+=a.storage}r=i%n,r>0&&(i+=n-r);t.__size=i,t.__cache={}}(i),d=function(e){const i=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return 0}();e.__bindingPointIndex=i;const n=t.createBuffer(),r=e.__size,s=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,r,s),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,i,n),n}(i),r[i.id]=d,i.addEventListener("dispose",c));const p=u.program;n.updateUBOMapping(i,p);const f=e.render.frame;s[i.id]!==f&&(!function(e){const i=r[e.id],n=e.uniforms,s=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,i);for(let e=0,i=n.length;e<i;e++){const i=n[e];if(!0===l(i,e,s)){const e=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=h(a);"number"==typeof a?(i.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=a.elements[0],i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=a.elements[0],i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=a.elements[0]):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,i.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(i),s[i.id]=f)},dispose:function(){for(const e in r)t.deleteBuffer(r[e]);a=[],r={},s={}}}}class rd{constructor(t={}){const{canvas:e=Ua(),context:i=null,depth:n=!0,stencil:r=!0,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:c=!1}=t;let u;this.isWebGLRenderer=!0,u=null!==i?i.getContextAttributes().alpha:s;const d=new Uint32Array(4),p=new Int32Array(4);let f=null,m=null;const g=[],_=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ta,this._useLegacyLights=!1,this.toneMapping=us,this.toneMappingExposure=1;const v=this;let y=!1,x=0,S=0,M=null,b=-1,T=null;const w=new Ja,E=new Ja;let A=null;const C=new Tl(0);let P=0,L=e.width,R=e.height,D=1,I=null,U=null;const N=new Ja(0,0,L,R),O=new Ja(0,0,L,R);let k=!1;const F=new Th;let z=!1,B=!1,V=null;const H=new Uo,G=new Pa,W=new no,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function q(){return null===M?D:1}let Y,j,Z,K,J,$,Q,tt,et,it,nt,rt,st,at,ot,lt,ht,ct,ut,dt,pt,ft,mt,gt,_t=i;function vt(t,i){for(let n=0;n<t.length;n++){const r=t[n],s=e.getContext(r,i);if(null!==s)return s}return null}try{const t={alpha:!0,depth:n,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${es}`),e.addEventListener("webglcontextlost",St,!1),e.addEventListener("webglcontextrestored",Mt,!1),e.addEventListener("webglcontextcreationerror",bt,!1),null===_t){const e=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&e.shift(),_t=vt(e,t),null===_t)throw vt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&WebGLRenderingContext,void 0===_t.getShaderPrecisionFormat&&(_t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw t}function yt(){Y=new tc(_t),j=new Nh(_t,Y,t),Y.init(j),ft=new Zu(_t,Y,j),Z=new Yu(_t,Y,j),K=new nc(_t),J=new Iu,$=new ju(_t,Y,Z,J,j,ft,K),Q=new kh(v),tt=new Qh(v),et=new Eh(_t,j),mt=new Ih(_t,Y,et,j),it=new ec(_t,et,K,mt),nt=new oc(_t,it,et,K),ut=new ac(_t,j,$),lt=new Oh(J),rt=new Du(v,Q,tt,Y,j,mt,lt),st=new id(v,J),at=new ku,ot=new Gu(Y,j),ct=new Dh(v,Q,tt,Z,nt,u,o),ht=new qu(v,nt,j),gt=new nd(_t,K,j,Z),dt=new Uh(_t,Y,K,j),pt=new ic(_t,Y,K,j),K.programs=rt.programs,v.capabilities=j,v.extensions=Y,v.properties=J,v.renderLists=at,v.shadowMap=ht,v.state=Z,v.info=K}yt();const xt=new ed(v,_t);function St(t){t.preventDefault(),y=!0}function Mt(){y=!1;const t=K.autoReset,e=ht.enabled,i=ht.autoUpdate,n=ht.needsUpdate,r=ht.type;yt(),K.autoReset=t,ht.enabled=e,ht.autoUpdate=i,ht.needsUpdate=n,ht.type=r}function bt(t){}function Tt(t){const e=t.target;e.removeEventListener("dispose",Tt),function(t){(function(t){const e=J.get(t).programs;void 0!==e&&(e.forEach((function(t){rt.releaseProgram(t)})),t.isShaderMaterial&&rt.releaseShaderCache(t))})(t),J.remove(t)}(e)}this.xr=xt,this.getContext=function(){return _t},this.getContextAttributes=function(){return _t.getContextAttributes()},this.forceContextLoss=function(){const t=Y.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=Y.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(t){void 0!==t&&(D=t,this.setSize(L,R,!1))},this.getSize=function(t){return t.set(L,R)},this.setSize=function(t,i,n=!0){xt.isPresenting||(L=t,R=i,e.width=Math.floor(t*D),e.height=Math.floor(i*D),!0===n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(t){return t.set(L*D,R*D).floor()},this.setDrawingBufferSize=function(t,i,n){L=t,R=i,D=n,e.width=Math.floor(t*n),e.height=Math.floor(i*n),this.setViewport(0,0,t,i)},this.getCurrentViewport=function(t){return t.copy(w)},this.getViewport=function(t){return t.copy(N)},this.setViewport=function(t,e,i,n){t.isVector4?N.set(t.x,t.y,t.z,t.w):N.set(t,e,i,n),Z.viewport(w.copy(N).multiplyScalar(D).floor())},this.getScissor=function(t){return t.copy(O)},this.setScissor=function(t,e,i,n){t.isVector4?O.set(t.x,t.y,t.z,t.w):O.set(t,e,i,n),Z.scissor(E.copy(O).multiplyScalar(D).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(t){Z.setScissorTest(k=t)},this.setOpaqueSort=function(t){I=t},this.setTransparentSort=function(t){U=t},this.getClearColor=function(t){return t.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(t=!0,e=!0,i=!0){let n=0;if(t){let t=!1;if(null!==M){const e=M.texture.format;t=1033===e||1031===e||1029===e}if(t){const t=M.texture.type,e=t===Ls||t===Is||t===Rs||t===Os||1017===t||1018===t,i=ct.getClearColor(),n=ct.getClearAlpha(),r=i.r,s=i.g,a=i.b;e?(d[0]=r,d[1]=s,d[2]=a,d[3]=n,_t.clearBufferuiv(_t.COLOR,0,d)):(p[0]=r,p[1]=s,p[2]=a,p[3]=n,_t.clearBufferiv(_t.COLOR,0,p))}else n|=_t.COLOR_BUFFER_BIT}e&&(n|=_t.DEPTH_BUFFER_BIT),i&&(n|=_t.STENCIL_BUFFER_BIT),_t.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",St,!1),e.removeEventListener("webglcontextrestored",Mt,!1),e.removeEventListener("webglcontextcreationerror",bt,!1),at.dispose(),ot.dispose(),J.dispose(),Q.dispose(),tt.dispose(),nt.dispose(),mt.dispose(),gt.dispose(),rt.dispose(),xt.dispose(),xt.removeEventListener("sessionstart",Et),xt.removeEventListener("sessionend",At),V&&(V.dispose(),V=null),Ct.stop()},this.renderBufferDirect=function(t,e,i,n,r,s){null===e&&(e=X);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(t,e,i,n,r){!0!==e.isScene&&(e=X);$.resetTextureUnits();const s=e.fog,a=n.isMeshStandardMaterial?e.environment:null,o=null===M?v.outputColorSpace:!0===M.isXRRenderTarget?M.texture.colorSpace:ea,l=(n.isMeshStandardMaterial?tt:Q).get(n.envMap||a),h=!0===n.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,c=!!i.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),u=!!i.morphAttributes.position,d=!!i.morphAttributes.normal,p=!!i.morphAttributes.color;let f=us;n.toneMapped&&(null!==M&&!0!==M.isXRRenderTarget||(f=v.toneMapping));const g=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,_=void 0!==g?g.length:0,y=J.get(n),x=m.state.lights;if(!0===z&&(!0===B||t!==T)){const e=t===T&&n.id===b;lt.setState(n,t,e)}let S=!1;n.version===y.__version?y.needsLights&&y.lightsStateVersion!==x.state.version||y.outputColorSpace!==o||r.isInstancedMesh&&!1===y.instancing?S=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?S=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||y.envMap!==l||!0===n.fog&&y.fog!==s?S=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===lt.numPlanes&&y.numIntersection===lt.numIntersection?(y.vertexAlphas!==h||y.vertexTangents!==c||y.morphTargets!==u||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==f||!0===j.isWebGL2&&y.morphTargetsCount!==_)&&(S=!0):S=!0:S=!0:S=!0:(S=!0,y.__version=n.version);let w=y.currentProgram;!0===S&&(w=It(n,e,r));let E=!1,A=!1,C=!1;const P=w.getUniforms(),L=y.uniforms;Z.useProgram(w.program)&&(E=!0,A=!0,C=!0);n.id!==b&&(b=n.id,A=!0);if(E||T!==t){P.setValue(_t,"projectionMatrix",t.projectionMatrix),P.setValue(_t,"viewMatrix",t.matrixWorldInverse);const e=P.map.cameraPosition;void 0!==e&&e.setValue(_t,W.setFromMatrixPosition(t.matrixWorld)),j.logarithmicDepthBuffer&&P.setValue(_t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&P.setValue(_t,"isOrthographic",!0===t.isOrthographicCamera),T!==t&&(T=t,A=!0,C=!0)}if(r.isSkinnedMesh){P.setOptional(_t,r,"bindMatrix"),P.setOptional(_t,r,"bindMatrixInverse");const t=r.skeleton;t&&j.floatVertexTextures&&(null===t.boneTexture&&t.computeBoneTexture(),P.setValue(_t,"boneTexture",t.boneTexture,$),P.setValue(_t,"boneTextureSize",t.boneTextureSize))}const I=i.morphAttributes;(void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===j.isWebGL2)&&ut.update(r,i,w);(A||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,P.setValue(_t,"receiveShadow",r.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(L.envMap.value=l,L.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);A&&(P.setValue(_t,"toneMappingExposure",v.toneMappingExposure),y.needsLights&&(N=C,(U=L).ambientLightColor.needsUpdate=N,U.lightProbe.needsUpdate=N,U.directionalLights.needsUpdate=N,U.directionalLightShadows.needsUpdate=N,U.pointLights.needsUpdate=N,U.pointLightShadows.needsUpdate=N,U.spotLights.needsUpdate=N,U.spotLightShadows.needsUpdate=N,U.rectAreaLights.needsUpdate=N,U.hemisphereLights.needsUpdate=N),s&&!0===n.fog&&st.refreshFogUniforms(L,s),st.refreshMaterialUniforms(L,n,D,R,V),uu.upload(_t,y.uniformsList,L,$));var U,N;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(uu.upload(_t,y.uniformsList,L,$),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&P.setValue(_t,"center",r.center);if(P.setValue(_t,"modelViewMatrix",r.modelViewMatrix),P.setValue(_t,"normalMatrix",r.normalMatrix),P.setValue(_t,"modelMatrix",r.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const t=n.uniformsGroups;for(let e=0,i=t.length;e<i;e++)if(j.isWebGL2){const i=t[e];gt.update(i,w),gt.bind(i,w)}}return w}(t,e,i,n,r);Z.setMaterial(n,a);let l=i.index,h=1;if(!0===n.wireframe){if(l=it.getWireframeAttribute(i),void 0===l)return;h=2}const c=i.drawRange,u=i.attributes.position;let d=c.start*h,p=(c.start+c.count)*h;null!==s&&(d=Math.max(d,s.start*h),p=Math.min(p,(s.start+s.count)*h)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=u&&(d=Math.max(d,0),p=Math.min(p,u.count));const f=p-d;if(f<0||f===1/0)return;let g;mt.setup(r,n,o,i,l);let _=dt;if(null!==l&&(g=et.get(l),_=pt,_.setIndex(g)),r.isMesh)!0===n.wireframe?(Z.setLineWidth(n.wireframeLinewidth*q()),_.setMode(_t.LINES)):_.setMode(_t.TRIANGLES);else if(r.isLine){let t=n.linewidth;void 0===t&&(t=1),Z.setLineWidth(t*q()),r.isLineSegments?_.setMode(_t.LINES):r.isLineLoop?_.setMode(_t.LINE_LOOP):_.setMode(_t.LINE_STRIP)}else r.isPoints?_.setMode(_t.POINTS):r.isSprite&&_.setMode(_t.TRIANGLES);if(r.isInstancedMesh)_.renderInstances(d,f,r.count);else if(i.isInstancedBufferGeometry){const t=void 0!==i._maxInstanceCount?i._maxInstanceCount:1/0,e=Math.min(i.instanceCount,t);_.renderInstances(d,f,e)}else _.render(d,f)},this.compile=function(t,e){function i(t,e,i){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=as,t.needsUpdate=!0,It(t,e,i),t.side=ss,t.needsUpdate=!0,It(t,e,i),t.side=2):It(t,e,i)}m=ot.get(t),m.init(),_.push(m),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),m.setupLights(v._useLegacyLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){i(n[r],t,e)}else i(n,t,e)})),_.pop(),m=null};let wt=null;function Et(){Ct.stop()}function At(){Ct.start()}const Ct=new wh;function Pt(t,e,i,n){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)i=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)m.pushLight(t),t.castShadow&&m.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||F.intersectsSprite(t)){n&&W.setFromMatrixPosition(t.matrixWorld).applyMatrix4(H);const e=nt.update(t),r=t.material;r.visible&&f.push(t,e,r,i,W.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||F.intersectsObject(t))){const e=nt.update(t),r=t.material;if(n&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),W.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),W.copy(e.boundingSphere.center)),W.applyMatrix4(t.matrixWorld).applyMatrix4(H)),Array.isArray(r)){const n=e.groups;for(let s=0,a=n.length;s<a;s++){const a=n[s],o=r[a.materialIndex];o&&o.visible&&f.push(t,e,o,i,W.z,a)}}else r.visible&&f.push(t,e,r,i,W.z,null)}const r=t.children;for(let t=0,s=r.length;t<s;t++)Pt(r[t],e,i,n)}function Lt(t,e,i,n){const r=t.opaque,s=t.transmissive,a=t.transparent;m.setupLightsView(i),!0===z&&lt.setGlobalState(v.clippingPlanes,i),s.length>0&&function(t,e,i,n){const r=j.isWebGL2;null===V&&(V=new Qa(1,1,{generateMipmaps:!0,type:Y.has("EXT_color_buffer_half_float")?Ns:Ls,minFilter:Ps,samples:r?4:0}));v.getDrawingBufferSize(G),r?V.setSize(G.x,G.y):V.setSize(wa(G.x),wa(G.y));const s=v.getRenderTarget();v.setRenderTarget(V),v.getClearColor(C),P=v.getClearAlpha(),P<1&&v.setClearColor(16777215,.5);v.clear();const a=v.toneMapping;v.toneMapping=us,Rt(t,i,n),$.updateMultisampleRenderTarget(V),$.updateRenderTargetMipmap(V);let o=!1;for(let t=0,r=e.length;t<r;t++){const r=e[t],s=r.object,a=r.geometry,l=r.material,h=r.group;if(2===l.side&&s.layers.test(n.layers)){const t=l.side;l.side=as,l.needsUpdate=!0,Dt(s,i,n,a,l,h),l.side=t,l.needsUpdate=!0,o=!0}}!0===o&&($.updateMultisampleRenderTarget(V),$.updateRenderTargetMipmap(V));v.setRenderTarget(s),v.setClearColor(C,P),v.toneMapping=a}(r,s,e,i),n&&Z.viewport(w.copy(n)),r.length>0&&Rt(r,e,i),s.length>0&&Rt(s,e,i),a.length>0&&Rt(a,e,i),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function Rt(t,e,i){const n=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],a=s.object,o=s.geometry,l=null===n?s.material:n,h=s.group;a.layers.test(i.layers)&&Dt(a,e,i,o,l,h)}}function Dt(t,e,i,n,r,s){t.onBeforeRender(v,e,i,n,r,s),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(v,e,i,n,t,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=as,r.needsUpdate=!0,v.renderBufferDirect(i,e,n,r,t,s),r.side=ss,r.needsUpdate=!0,v.renderBufferDirect(i,e,n,r,t,s),r.side=2):v.renderBufferDirect(i,e,n,r,t,s),t.onAfterRender(v,e,i,n,r,s)}function It(t,e,i){!0!==e.isScene&&(e=X);const n=J.get(t),r=m.state.lights,s=m.state.shadowsArray,a=r.state.version,o=rt.getParameters(t,r.state,s,e,i),l=rt.getProgramCacheKey(o);let h=n.programs;n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=(t.isMeshStandardMaterial?tt:Q).get(t.envMap||n.environment),void 0===h&&(t.addEventListener("dispose",Tt),h=new Map,n.programs=h);let c=h.get(l);if(void 0!==c){if(n.currentProgram===c&&n.lightsStateVersion===a)return Ut(t,o),c}else o.uniforms=rt.getUniforms(t),t.onBuild(i,o,v),t.onBeforeCompile(o,v),c=rt.acquireProgram(o,l),h.set(l,c),n.uniforms=o.uniforms;const u=n.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=lt.uniform),Ut(t,o),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=a,n.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);const d=c.getUniforms(),p=uu.seqWithValue(d.seq,u);return n.currentProgram=c,n.uniformsList=p,c}function Ut(t,e){const i=J.get(t);i.outputColorSpace=e.outputColorSpace,i.instancing=e.instancing,i.instancingColor=e.instancingColor,i.skinning=e.skinning,i.morphTargets=e.morphTargets,i.morphNormals=e.morphNormals,i.morphColors=e.morphColors,i.morphTargetsCount=e.morphTargetsCount,i.numClippingPlanes=e.numClippingPlanes,i.numIntersection=e.numClipIntersection,i.vertexAlphas=e.vertexAlphas,i.vertexTangents=e.vertexTangents,i.toneMapping=e.toneMapping}Ct.setAnimationLoop((function(t){wt&&wt(t)})),"undefined"!=typeof self&&Ct.setContext(self),this.setAnimationLoop=function(t){wt=t,xt.setAnimationLoop(t),null===t?Ct.stop():Ct.start()},xt.addEventListener("sessionstart",Et),xt.addEventListener("sessionend",At),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return;if(!0===y)return;!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===xt.enabled&&!0===xt.isPresenting&&(!0===xt.cameraAutoUpdate&&xt.updateCamera(e),e=xt.getCamera()),!0===t.isScene&&t.onBeforeRender(v,t,e,M),m=ot.get(t,_.length),m.init(),_.push(m),H.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),F.setFromProjectionMatrix(H),B=this.localClippingEnabled,z=lt.init(this.clippingPlanes,B),f=at.get(t,g.length),f.init(),g.push(f),Pt(t,e,0,v.sortObjects),f.finish(),!0===v.sortObjects&&f.sort(I,U),this.info.render.frame++,!0===z&&lt.beginShadows();const i=m.state.shadowsArray;if(ht.render(i,t,e),!0===z&&lt.endShadows(),!0===this.info.autoReset&&this.info.reset(),ct.render(f,t),m.setupLights(v._useLegacyLights),e.isArrayCamera){const i=e.cameras;for(let e=0,n=i.length;e<n;e++){const n=i[e];Lt(f,t,n,n.viewport)}}else Lt(f,t,e);null!==M&&($.updateMultisampleRenderTarget(M),$.updateRenderTargetMipmap(M)),!0===t.isScene&&t.onAfterRender(v,t,e),mt.resetDefaultState(),b=-1,T=null,_.pop(),m=_.length>0?_[_.length-1]:null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(t,e,i){J.get(t.texture).__webglTexture=e,J.get(t.depthTexture).__webglTexture=i;const n=J.get(t);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===i,n.__autoAllocateDepthBuffer||!0===Y.has("WEBGL_multisampled_render_to_texture")&&(n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const i=J.get(t);i.__webglFramebuffer=e,i.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,i=0){M=t,x=e,S=i;let n=!0,r=null,s=!1,a=!1;if(t){const o=J.get(t);void 0!==o.__useDefaultFramebuffer?(Z.bindFramebuffer(_t.FRAMEBUFFER,null),n=!1):void 0===o.__webglFramebuffer?$.setupRenderTarget(t):o.__hasExternalTextures&&$.rebindTextures(t,J.get(t.texture).__webglTexture,J.get(t.depthTexture).__webglTexture);const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const h=J.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=Array.isArray(h[e])?h[e][i]:h[e],s=!0):r=j.isWebGL2&&t.samples>0&&!1===$.useMultisampledRTT(t)?J.get(t).__webglMultisampledFramebuffer:Array.isArray(h)?h[i]:h,w.copy(t.viewport),E.copy(t.scissor),A=t.scissorTest}else w.copy(N).multiplyScalar(D).floor(),E.copy(O).multiplyScalar(D).floor(),A=k;if(Z.bindFramebuffer(_t.FRAMEBUFFER,r)&&j.drawBuffers&&n&&Z.drawBuffers(t,r),Z.viewport(w),Z.scissor(E),Z.setScissorTest(A),s){const n=J.get(t.texture);_t.framebufferTexture2D(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,_t.TEXTURE_CUBE_MAP_POSITIVE_X+e,n.__webglTexture,i)}else if(a){const n=J.get(t.texture),r=e||0;_t.framebufferTextureLayer(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,n.__webglTexture,i||0,r)}b=-1},this.readRenderTargetPixels=function(t,e,i,n,r,s,a){if(!t||!t.isWebGLRenderTarget)return;let o=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){Z.bindFramebuffer(_t.FRAMEBUFFER,o);try{const a=t.texture,o=a.format,l=a.type;if(o!==ks&&ft.convert(o)!==_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_FORMAT))return;const h=l===Ns&&(Y.has("EXT_color_buffer_half_float")||j.isWebGL2&&Y.has("EXT_color_buffer_float"));if(!(l===Ls||ft.convert(l)===_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_TYPE)||l===Us&&(j.isWebGL2||Y.has("OES_texture_float")||Y.has("WEBGL_color_buffer_float"))||h))return;e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&_t.readPixels(e,i,n,r,ft.convert(o),ft.convert(l),s)}finally{const t=null!==M?J.get(M).__webglFramebuffer:null;Z.bindFramebuffer(_t.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t,e,i=0){const n=Math.pow(2,-i),r=Math.floor(e.image.width*n),s=Math.floor(e.image.height*n);$.setTexture2D(e,0),_t.copyTexSubImage2D(_t.TEXTURE_2D,i,0,0,t.x,t.y,r,s),Z.unbindTexture()},this.copyTextureToTexture=function(t,e,i,n=0){const r=e.image.width,s=e.image.height,a=ft.convert(i.format),o=ft.convert(i.type);$.setTexture2D(i,0),_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,i.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,i.unpackAlignment),e.isDataTexture?_t.texSubImage2D(_t.TEXTURE_2D,n,t.x,t.y,r,s,a,o,e.image.data):e.isCompressedTexture?_t.compressedTexSubImage2D(_t.TEXTURE_2D,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):_t.texSubImage2D(_t.TEXTURE_2D,n,t.x,t.y,a,o,e.image),0===n&&i.generateMipmaps&&_t.generateMipmap(_t.TEXTURE_2D),Z.unbindTexture()},this.copyTextureToTexture3D=function(t,e,i,n,r=0){if(v.isWebGL1Renderer)return;const s=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,o=t.max.z-t.min.z+1,l=ft.convert(n.format),h=ft.convert(n.type);let c;if(n.isData3DTexture)$.setTexture3D(n,0),c=_t.TEXTURE_3D;else{if(!n.isDataArrayTexture)return;$.setTexture2DArray(n,0),c=_t.TEXTURE_2D_ARRAY}_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,n.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,n.unpackAlignment);const u=_t.getParameter(_t.UNPACK_ROW_LENGTH),d=_t.getParameter(_t.UNPACK_IMAGE_HEIGHT),p=_t.getParameter(_t.UNPACK_SKIP_PIXELS),f=_t.getParameter(_t.UNPACK_SKIP_ROWS),m=_t.getParameter(_t.UNPACK_SKIP_IMAGES),g=i.isCompressedTexture?i.mipmaps[0]:i.image;_t.pixelStorei(_t.UNPACK_ROW_LENGTH,g.width),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,g.height),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,t.min.x),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,t.min.y),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,t.min.z),i.isDataTexture||i.isData3DTexture?_t.texSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,h,g.data):i.isCompressedArrayTexture?_t.compressedTexSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,g.data):_t.texSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,h,g),_t.pixelStorei(_t.UNPACK_ROW_LENGTH,u),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,d),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,p),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,f),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,m),0===r&&n.generateMipmaps&&_t.generateMipmap(c),Z.unbindTexture()},this.initTexture=function(t){t.isCubeTexture?$.setTextureCube(t,0):t.isData3DTexture?$.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?$.setTexture2DArray(t,0):$.setTexture2D(t,0),Z.unbindTexture()},this.resetState=function(){x=0,S=0,M=null,Z.reset(),mt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return da}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=t===ia?"display-p3":"srgb",e.unpackColorSpace=Va.workingColorSpace===na?"display-p3":"srgb"}get physicallyCorrectLights(){return!this.useLegacyLights}set physicallyCorrectLights(t){this.useLegacyLights=!t}get outputEncoding(){return this.outputColorSpace===ta?$s:Js}set outputEncoding(t){this.outputColorSpace=t===$s?ta:ea}get useLegacyLights(){return this._useLegacyLights}set useLegacyLights(t){this._useLegacyLights=t}}(class extends rd{}).prototype.isWebGL1Renderer=!0;class sd extends sl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e}}class ad extends Ka{constructor(t,e,i,n,r,s,a,o,l){super(t,e,i,n,r,s,a,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:Cs,this.magFilter=void 0!==r?r:Cs,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){h.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class od extends yl{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Tl(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class ld extends yl{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Tl(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tl(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Pa(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}function hd(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function cd(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class ud{constructor(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{let s;i:{n:if(!(t<n)){for(let s=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===s)break;if(r=n,n=e[++i],t<n)break e}s=e.length;break i}if(t>=r)break t;{const a=e[1];t<a&&(i=2,r=a);for(let s=i-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(i===s)break;if(n=r,r=e[--i-1],t>=r)break e}s=i,i=0}}for(;i<s;){const n=i+s>>>1;t<e[n]?s=n:i=n+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n;for(let t=0;t!==n;++t)e[t]=i[r+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class dd extends ud{constructor(t,e,i,n){super(t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:js,endingEnd:js}}intervalChanged_(t,e,i){const n=this.parameterPositions;let r=t-2,s=t+1,a=n[r],o=n[s];if(void 0===a)switch(this.getSettings_().endingStart){case Zs:r=t,a=2*e-i;break;case Ks:r=n.length-2,a=e+n[r]-n[r+1];break;default:r=t,a=i}if(void 0===o)switch(this.getSettings_().endingEnd){case Zs:s=t,o=2*i-e;break;case Ks:s=1,o=i+n[1]-n[0];break;default:s=t-1,o=e}const l=.5*(i-e),h=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(o-i),this._offsetPrev=r*h,this._offsetNext=s*h}interpolate_(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,h=this._offsetPrev,c=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,_=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,y=d*m-d*f;for(let t=0;t!==a;++t)r[t]=g*s[h+t]+_*s[l+t]+v*s[o+t]+y*s[c+t];return r}}class pd extends ud{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,h=(i-e)/(n-e),c=1-h;for(let t=0;t!==a;++t)r[t]=s[l+t]*c+s[o+t]*h;return r}}class fd extends ud{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t){return this.copySampleValue_(t-1)}}class md{constructor(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=hd(e,this.TimeBufferType),this.values=hd(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:hd(t.times,Array),values:hd(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(i.interpolation=e)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new fd(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new pd(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new dd(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Xs:e=this.InterpolantFactoryMethodDiscrete;break;case qs:e=this.InterpolantFactoryMethodLinear;break;case Ys:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xs;case this.InterpolantFactoryMethodLinear:return qs;case this.InterpolantFactoryMethodSmooth:return Ys}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this}trim(t,e){const i=this.times,n=i.length;let r=0,s=n-1;for(;r!==n&&i[r]<t;)++r;for(;-1!==s&&i[s]>e;)--s;if(++s,0!==r||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=i.slice(r,s),this.values=this.values.slice(r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);const i=this.times,n=this.values,r=i.length;0===r&&(t=!1);let s=null;for(let e=0;e!==r;e++){const n=i[e];if("number"==typeof n&&isNaN(n)){t=!1;break}if(null!==s&&s>n){t=!1;break}s=n}if(void 0!==n&&cd(n))for(let e=0,i=n.length;e!==i;++e){const i=n[e];if(isNaN(i)){t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),i=this.getValueSize(),n=this.getInterpolation()===Ys,r=t.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=t[a];if(o!==t[a+1]&&(1!==a||o!==t[0]))if(n)r=!0;else{const t=a*i,n=t-i,s=t+i;for(let a=0;a!==i;++a){const i=e[t+a];if(i!==e[n+a]||i!==e[s+a]){r=!0;break}}}if(r){if(a!==s){t[s]=t[a];const n=a*i,r=s*i;for(let t=0;t!==i;++t)e[r+t]=e[n+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*i,n=s*i,a=0;a!==i;++a)e[n+a]=e[t+a];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*i)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}md.prototype.TimeBufferType=Float32Array,md.prototype.ValueBufferType=Float32Array,md.prototype.DefaultInterpolation=qs;class gd extends md{}gd.prototype.ValueTypeName="bool",gd.prototype.ValueBufferType=Array,gd.prototype.DefaultInterpolation=Xs,gd.prototype.InterpolantFactoryMethodLinear=void 0,gd.prototype.InterpolantFactoryMethodSmooth=void 0;class _d extends md{}_d.prototype.ValueTypeName="color";class vd extends md{}vd.prototype.ValueTypeName="number";class yd extends ud{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-e)/(n-e);let l=t*a;for(let t=l+a;l!==t;l+=4)io.slerpFlat(r,0,s,l-a,s,l,o);return r}}class xd extends md{InterpolantFactoryMethodLinear(t){return new yd(this.times,this.values,this.getValueSize(),t)}}xd.prototype.ValueTypeName="quaternion",xd.prototype.DefaultInterpolation=qs,xd.prototype.InterpolantFactoryMethodSmooth=void 0;class Sd extends md{}Sd.prototype.ValueTypeName="string",Sd.prototype.ValueBufferType=Array,Sd.prototype.DefaultInterpolation=Xs,Sd.prototype.InterpolantFactoryMethodLinear=void 0,Sd.prototype.InterpolantFactoryMethodSmooth=void 0;class Md extends md{}Md.prototype.ValueTypeName="vector";const bd={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Td{constructor(t,e,i){const n=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,!1===s&&void 0!==n.onStart&&n.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,i=l.length;e<i;e+=2){const i=l[e],n=l[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return n}return null}}}const wd=new Td;class Ed{constructor(t){this.manager=void 0!==t?t:wd,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const i=this;return new Promise((function(n,r){i.load(t,n,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}Ed.DEFAULT_MATERIAL_NAME="__DEFAULT";class Ad extends Ed{constructor(t){super(t)}load(t,e,i,n){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=bd.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const a=Ia("img");function o(){h(),bd.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){h(),n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}function h(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}class Cd extends Ed{constructor(t){super(t)}load(t,e,i,n){const r=new Ka,s=new Ad(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),i,n),r}}class Pd extends sl{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Tl(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}const Ld=new Uo,Rd=new no,Dd=new no;class Id{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Pa(512,512),this.map=null,this.mapPass=null,this.matrix=new Uo,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Th,this._frameExtents=new Pa(1,1),this._viewportCount=1,this._viewports=[new Ja(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,i=this.matrix;Rd.setFromMatrixPosition(t.matrixWorld),e.position.copy(Rd),Dd.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Dd),e.updateMatrixWorld(),Ld.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ld),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Ld)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Ud extends Id{constructor(){super(new ph(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,i=2*va*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class Nd extends Pd{constructor(t,e,i=0,n=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sl.DEFAULT_UP),this.updateMatrix(),this.target=new sl,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Ud}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class Od extends Id{constructor(){super(new Fh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class kd extends Pd{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sl.DEFAULT_UP),this.updateMatrix(),this.target=new sl,this.shadow=new Od}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class Fd extends Pd{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}const zd="\\[\\]\\.:\\/",Bd=new RegExp("["+zd+"]","g"),Vd="[^"+zd+"]",Hd="[^"+zd.replace("\\.","")+"]",Gd=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Vd)+/(WCOD+)?/.source.replace("WCOD",Hd)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vd)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vd)+"$"),Wd=["material","materials","bones","map"];class Xd{constructor(t,e,i){this.path=e,this.parsedPath=i||Xd.parseTrackName(e),this.node=Xd.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new Xd.Composite(t,e,i):new Xd(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Bd,"")}static parseTrackName(t){const e=Gd.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=i.nodeName.substring(n+1);-1!==Wd.indexOf(t)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=t)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){const i=function(t){for(let n=0;n<t.length;n++){const r=t[n];if(r.name===e||r.uuid===e)return r;const s=i(r.children);if(s)return s}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,i=e.objectName,n=e.propertyName;let r=e.propertyIndex;if(t||(t=Xd.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(i){let n=e.objectIndex;switch(i){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return;if(!t.material.map)return;t=t.material.map;break;default:if(void 0===t[i])return;t=t[i]}if(void 0!==n){if(void 0===t[n])return;t=t[n]}}const s=t[n];if(void 0===s){e.nodeName;return}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xd.Composite=class{constructor(t,e,i){const n=i||Xd.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)}setValue(t,e){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Xd.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xd.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xd.prototype.GetterByBindingType=[Xd.prototype._getValue_direct,Xd.prototype._getValue_array,Xd.prototype._getValue_arrayElement,Xd.prototype._getValue_toArray],Xd.prototype.SetterByBindingTypeAndVersioning=[[Xd.prototype._setValue_direct,Xd.prototype._setValue_direct_setNeedsUpdate,Xd.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xd.prototype._setValue_array,Xd.prototype._setValue_array_setNeedsUpdate,Xd.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xd.prototype._setValue_arrayElement,Xd.prototype._setValue_arrayElement_setNeedsUpdate,Xd.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xd.prototype._setValue_fromArray,Xd.prototype._setValue_fromArray_setNeedsUpdate,Xd.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class qd{constructor(t,e,i=0,n=1/0){this.ray=new Io(t,e),this.near=i,this.far=n,this.camera=null,this.layers=new Xo,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)}intersectObject(t,e=!0,i=[]){return jd(t,this,i,e),i.sort(Yd),i}intersectObjects(t,e=!0,i=[]){for(let n=0,r=t.length;n<r;n++)jd(t[n],this,i,e);return i.sort(Yd),i}}function Yd(t,e){return t.distance-e.distance}function jd(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),!0===n){const n=t.children;for(let t=0,r=n.length;t<r;t++)jd(n[t],e,i,!0)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:es}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=es));class Zd extends ld{constructor(t,e){super(e),this.PREMULTIPLIEDALPHA=!1,this.map2=null,this.mapReady={value:0},this.videoFrameLoaded=()=>{this.mapReady.value=1},this.beforeCompileModifier=t=>{t.uniforms.map2={value:this.map2},t.uniforms.mapReady=this.mapReady,t.fragmentShader=t.fragmentShader.replace("#include <map_pars_fragment>","\n                    #ifdef USE_MAP\n\n                    uniform sampler2D map;\n                    uniform sampler2D map2;\n                    uniform float mapReady;\n\n                    #endif\n            "),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>","\n                    #ifdef USE_MAP\n//                    vec2 textUv = vec2((vMapUv.x + 0.05555555555555558) * 1.0 / 1.1111111111111112, ((vMapUv.y + 0.05555555555555558) * 1.0 / 1.777777777777778) * 2.5 - (2.5 - 1.0));\n//                    vec2 textUv = vec2((vMapUv.x + 0.05), ((vMapUv.y + 0.05) / 1.777777777777778) * 2.5 - (2.5 - 1.1));\n//                     vec2 textUv = vec2((vMapUv.x + 0.05555555555555558) * 1.0 / 1.1111111111111112 * 1.2, ((vMapUv.y + 0.05555555555555558) * 1.777777777777778) - 1.1111111111111112 * 2.0 + 0.05555555555555558);\n//                     vec2 textUv = vec2((vMapUv.x), ((vMapUv.y + 0.05555555555555558) * 1.777777777777778) - 1.1111111111111112 * 2.0 + 0.05555555555555558);\n//                     vec2 textUv = vec2((vMapUv.x), ((vMapUv.y + 0.05) / 1.777777777777778) * 2.5 - (2.5 - 1.1));\n                      float offsetY = 0.027;\n                     vec2 textUv = vec2((vMapUv.x), ((vMapUv.y * 1.1111 + (0.05 + offsetY)) / 1.777777777777778) * 2.5 - (2.5 - (1.0 + offsetY * 2.0)) * 1.1111);\n                    //If the texture is not in the range of the text uv, use the video texture and apply the color correction\n                    if ((textUv.y < 0.0 || textUv.x < 0.0 || textUv.x > 1.0 || textUv.y > 1.0) && mapReady > 0.0) {\n                      diffuseColor *= texture2D( map, vMapUv );\n                      diffuseColor = vec4( mix( pow( diffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), diffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( diffuseColor.rgb, vec3( 0.04045 ) ) ) ), diffuseColor.w );\n                    } else {\n                      diffuseColor *= texture2D( map2, textUv );\n                    }\n                    // vec2 textUv = vec2((vMapUv.x + 0.05555555555555558) * 1.0 / 1.1111111111111112 * 1.2, ((vMapUv.y + 0.05555555555555558) * 1.777777777777778) - 1.1111111111111112 * 2.0 + 0.05555555555555558);\n                    // vec2 textUv = vec2((vMapUv.x), ((vMapUv.y + 0.05555555555555558) * 1.777777777777778) - 1.1111111111111112 * 2.0 + 0.05555555555555558);\n                    // vec4 texelColor2 = texture2D(map2, textUv);\n                    // diffuseColor = mix(diffuseColor, texelColor2, texelColor2.r > 0.0 ? 0.0 : 1.0);\n                    // diffuseColor = mix(diffuseColor, texelColor2, vMapUv.y < textUv.y ? 0.0 : 1.0);\n                    //  diffuseColor = mix(diffuseColor, texelColor2, 1.0);\n                    // diffuseColor = mix(diffuseColor, texelColor2, textUv.y < 0.0 || textUv.x < 0.0 || textUv.x > 1.0 || textUv.y > 1.0 ? 0.0 : 1.0);\n\n                    #endif\n            ")},this.map2=t,this.onBeforeCompile=this.beforeCompileModifier}}class Kd{constructor(t,e,i){this.cardTextures=[],this.cardMaterials=[],this.videoPlayers=[],this.useVideos=!0,this._textureLoader=new Cd,this._totalTextures=0,this._loadedTextures=0,this.generateFirstVideoFrameTexture=(t,e)=>{t>0&&("requestVideoFrameCallback"in HTMLVideoElement.prototype?e.requestVideoFrameCallback(((i,n)=>{try{t>=2&&e.pause(),this.cardMaterials[t].videoFrameLoaded()}catch(e){this.cardMaterials[t].videoFrameLoaded()}})):this.cardMaterials[t].videoFrameLoaded())},this._textureLoaded=()=>{this._loadedTextures++,this._loadedTextures===this._totalTextures&&this._onLoaded()},this.switchingToGrid=()=>{this.cardMaterials.forEach(((t,e)=>{e>0&&(this.videoPlayers[e].pause(),this.cardMaterials[e].videoFrameLoaded())}))},this._cardWidth=t,this._cardHeight=e,this._onLoaded=i}loadAssets(t,e){this._totalTextures=t.length,e.forEach(((e,i)=>{var n=this._textureLoader.load(t[i],this._textureLoaded);if(n.colorSpace=ta,n.encoding=$s,n.wrapS=bs,n.wrapT=bs,null===e)return this.videoPlayers.push(document.createElement("video")),this.cardTextures.push(n),void this.cardMaterials.push(new ld({color:16777215,roughness:.45,emissiveIntensity:0,emissive:16777215,metalness:.09,map:n}));let r;if(this.useVideos){var s=document.createElement("video");s.src=e,s.loop=!0,s.muted=!0,s.playsInline=!0;var a=s.play();void 0!==a?a.then((t=>{this.generateFirstVideoFrameTexture(i,s)})).catch((t=>{this.generateFirstVideoFrameTexture(i,s)})):this.generateFirstVideoFrameTexture(i,s),this.videoPlayers.push(s),r=new ad(s);const t=1;r.repeat.set(1/t,this._cardHeight/this._cardWidth*(1/t)),r.offset.set(-.5*(r.repeat.x-1),-.5*(r.repeat.x-1)),r.colorSpace=ta,r.encoding=$s}else r=n;this.cardTextures.push(r),this.cardMaterials.push(new Zd(n,{color:16777215,roughness:.45,emissiveIntensity:0,emissive:16777215,metalness:.09,map:r}))}))}}class Jd{constructor(t){this.cardWidth=5,this.cardHeight=8,this.maxVisibleCardsInStack=3,this.cardAngle=Ca.degToRad(5),this.cardThickness=.05,this.cardCornerRadius=.5,this.currCardIndex=0,this.stackIndexBeforeGridMode=0,this._cardBackgroundColors=["#0073e6","#ffbb25","#e42616","#0073e6","#1fb254","#e42616","#ffbb25"],this._cardBackgroundClasses=["blue-mode","yellow-mode","red-mode","blue-mode","green-mode","red-mode","yellow-mode"],this._currBgClass=this._cardBackgroundClasses[0],this._currNextBgClass="next-"+this._cardBackgroundClasses[1],this.gridSettings={_colCount:3,_spacing:1,cardWidth:this.cardWidth+1,cardHeight:this.cardHeight+1,_colStart:this.cardWidth+-1,_rowStart:this.cardHeight+-.25,_totalRows:0,_pixelPaddingTop:120,_gridFactor:1,_cameraZoomFactor:1,_cameraZoom:1},this._parentDimensions={width:0,height:0},this.threeUnitPixelWidth=0,this.threeUnitPixelHeight=0,this.threeUnitPixelHeightAtGridPosition=0,this.scrollHeightThreeUnits=0,this.cardPixelWidth=0,this.cardPixelHeight=0,this.getStackPositions=(t=-1)=>{let e=[];for(let r=0;r<this.cardCount;r++){var i=this.nextIndexWrappedUnclamped((-1!==t?t:this.currCardIndex)+r),n=Ca.clamp(r,0,this.maxVisibleCardsInStack-1);e[i]={position:{x:0,y:0,z:.1*-n},rotation:{x:0,y:0,z:-n*this.cardAngle}}}return e},this.getGridPositions=()=>{let t=0,e=0,i=[];for(let n=0;n<this.cardCount;n++)t=n%this.gridSettings._colCount,e=Math.floor(n/this.gridSettings._colCount),i[n]={x:this.gridSettings._colStart+t*this.gridSettings.cardWidth,y:e*-this.gridSettings.cardHeight-this.gridSettings._rowStart};return i},this.layoutGrid=t=>{var e=this.getGridPositions();t.forEach(((t,i)=>{let n=e[i];qn.killTweensOf(t.position,"x,y"),t.position.x=n.x,t.position.y=n.y}))},this.getBorderRadius=t=>t>=768?80:t>=640?46:32,this.getCardDomMatchedPageTransforms=(t,e,i,n=!1)=>{var r=t.querySelector(".page-inner").clientWidth,s=this.getBorderRadius(window.innerWidth),a=parseFloat(window.getComputedStyle(t,null).getPropertyValue("padding-top")),o=Ca.degToRad(i.fov),l=2*Math.tan(o/2)*(i.position.z-(e+this.cardThickness*(n?1:.5)))*i.aspect,h=this.cardWidth/l*this._parentDimensions.width*i.zoom,c=this.cardWidth/l*this._parentDimensions.width*(this.cardHeight/this.cardWidth)*i.zoom,u=c/this.cardHeight,d=r/h;return{yOffset:(.5*(this._parentDimensions.height-c*d)-a-i.view.offsetY)/u,morphTargetTo:s/(this.cardCornerRadius*u)*(1/d),scaleTo:d}},this.resize=(t,e,i,n)=>{this._parentDimensions.width=t,this._parentDimensions.height=e,this.gridSettings._colCount=3,this.gridSettings._spacing=1,window.innerWidth,window.innerWidth<768&&(this.gridSettings._spacing=.5,this.gridSettings._colCount=2),window.innerWidth>=640&&(this.gridSettings._spacing=1),this.gridSettings.cardWidth=this.cardWidth+this.gridSettings._spacing,this.gridSettings.cardHeight=this.cardHeight+this.gridSettings._spacing,this.gridSettings._colStart=this.gridSettings._colCount%2==0?-.5*this.gridSettings.cardWidth:-1*this.gridSettings.cardWidth;var r=Ca.degToRad(i.fov),s=2*Math.tan(r/2)*i.position.z,a=2*Math.tan(r/2)*(i.position.z+(3+.5*this.cardThickness)),o=s*i.aspect;this.cardPixelWidth=this.cardWidth/o*t,this.cardPixelHeight=this.cardWidth/o*t*(this.cardHeight/this.cardWidth),this.threeUnitPixelWidth=this.cardPixelWidth/this.cardWidth,this.threeUnitPixelHeight=this.cardPixelHeight/this.cardHeight;var l=s/a;this.threeUnitPixelHeightAtGridPosition=this.threeUnitPixelHeight*l;var h=180;if(n>767&&(h=700),this.cardPixelWidth+h>t){let e=(this.cardPixelWidth+h)/t,n=qn.utils.clamp(.2,1,1/e);i.zoom=n}else i.zoom=1;this.gridSettings._cameraZoom=i.zoom;const c=.5*(e-this.cardPixelHeight*i.zoom*l)-this.gridSettings._pixelPaddingTop;this.gridSettings._rowStart=-c/(this.threeUnitPixelHeightAtGridPosition*i.zoom);var u=this.gridSettings._spacing*this.threeUnitPixelHeightAtGridPosition*i.zoom,d=t-(this.cardPixelWidth*l*i.zoom*this.gridSettings._colCount+u*(this.gridSettings._colCount+1));this.gridSettings._cameraZoomFactor=d<0?1- -1*d/t:1,this.gridSettings._gridFactor=a/s,this.gridSettings._totalRows=Math.ceil(this.cardCount/this.gridSettings._colCount),this.scrollHeightThreeUnits=(this.gridSettings._totalRows-1)*this.gridSettings.cardHeight+2*this.gridSettings._rowStart,document.documentElement.style.setProperty("--cardPixelWidth",this.cardPixelWidth*i.zoom+"px"),document.documentElement.style.setProperty("--cardPixelHeight",this.cardPixelHeight*i.zoom+"px")},this.setBackgroundColor=(t,e=!1,i,n=-1)=>{e?i||(document.body.style.backgroundColor=this._cardBackgroundColors[t]):i?(document.documentElement.classList.remove(this._currBgClass),document.documentElement.classList.remove(this._currNextBgClass)):(document.documentElement.classList.remove(this._currBgClass),document.documentElement.classList.remove(this._currNextBgClass),this._currBgClass=this._cardBackgroundClasses[-1!==n?n:this.currCardIndex],this._currNextBgClass="next-"+this._cardBackgroundClasses[t],document.documentElement.classList.add(this._currBgClass),document.documentElement.classList.add(this._currNextBgClass))},this.cardCount=t,this.nextIndexWrapped=qn.utils.wrap(0,t-1),this.nextIndexWrappedUnclamped=qn.utils.wrap(0,t)}}
/*!
 * matrix 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var $d,Qd,tp,ep,ip,np,rp,sp,ap,op="transform",lp=op+"Origin",hp=function(t){var e=t.ownerDocument||t;!(op in t.style)&&"msTransform"in t.style&&(lp=(op="msTransform")+"Origin");for(;e.parentNode&&(e=e.parentNode););if(Qd=window,rp=new _p,e){$d=e,tp=e.documentElement,ep=e.body,(sp=$d.createElementNS("http://www.w3.org/2000/svg","g")).style.transform="none";var i=e.createElement("div"),n=e.createElement("div");ep.appendChild(i),i.appendChild(n),i.style.position="static",i.style[op]="translate3d(0,0,1px)",ap=n.offsetParent!==i,ep.removeChild(i)}return e},cp=[],up=[],dp=function(t){return t.ownerSVGElement||("svg"===(t.tagName+"").toLowerCase()?t:null)},pp=function t(e){return"fixed"===Qd.getComputedStyle(e).position||((e=e.parentNode)&&1===e.nodeType?t(e):void 0)},fp=function t(e,i){if(e.parentNode&&($d||hp(e))){var n=dp(e),r=n?n.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",s=n?i?"rect":"g":"div",a=2!==i?0:100,o=3===i?100:0,l="position:absolute;display:block;pointer-events:none;margin:0;padding:0;",h=$d.createElementNS?$d.createElementNS(r.replace(/^https/,"http"),s):$d.createElement(s);return i&&(n?(np||(np=t(e)),h.setAttribute("width",.01),h.setAttribute("height",.01),h.setAttribute("transform","translate("+a+","+o+")"),np.appendChild(h)):(ip||((ip=t(e)).style.cssText=l),h.style.cssText=l+"width:0.1px;height:0.1px;top:"+o+"px;left:"+a+"px",ip.appendChild(h))),h}throw"Need document and parent."},mp=function(t,e){var i,n,r,s,a,o,l=dp(t),h=t===l,c=l?cp:up,u=t.parentNode;if(t===Qd)return t;if(c.length||c.push(fp(t,1),fp(t,2),fp(t,3)),i=l?np:ip,l)h?(r=function(t){var e,i=t.getCTM();return i||(e=t.style[op],t.style[op]="none",t.appendChild(sp),i=sp.getCTM(),t.removeChild(sp),e?t.style[op]=e:t.style.removeProperty(op.replace(/([A-Z])/g,"-$1").toLowerCase())),i||rp.clone()}(t),s=-r.e/r.a,a=-r.f/r.d,n=rp):t.getBBox?(r=t.getBBox(),n=(n=t.transform?t.transform.baseVal:{}).numberOfItems?n.numberOfItems>1?function(t){for(var e=new _p,i=0;i<t.numberOfItems;i++)e.multiply(t.getItem(i).matrix);return e}(n):n.getItem(0).matrix:rp,s=n.a*r.x+n.c*r.y,a=n.b*r.x+n.d*r.y):(n=new _p,s=a=0),e&&"g"===t.tagName.toLowerCase()&&(s=a=0),(h?l:u).appendChild(i),i.setAttribute("transform","matrix("+n.a+","+n.b+","+n.c+","+n.d+","+(n.e+s)+","+(n.f+a)+")");else{if(s=a=0,ap)for(n=t.offsetParent,r=t;r&&(r=r.parentNode)&&r!==n&&r.parentNode;)(Qd.getComputedStyle(r)[op]+"").length>4&&(s=r.offsetLeft,a=r.offsetTop,r=0);if("absolute"!==(o=Qd.getComputedStyle(t)).position&&"fixed"!==o.position)for(n=t.offsetParent;u&&u!==n;)s+=u.scrollLeft||0,a+=u.scrollTop||0,u=u.parentNode;(r=i.style).top=t.offsetTop-a+"px",r.left=t.offsetLeft-s+"px",r[op]=o[op],r[lp]=o[lp],r.position="fixed"===o.position?"fixed":"absolute",t.parentNode.appendChild(i)}return i},gp=function(t,e,i,n,r,s,a){return t.a=e,t.b=i,t.c=n,t.d=r,t.e=s,t.f=a,t},_p=function(){function t(t,e,i,n,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),gp(this,t,e,i,n,r,s)}var e=t.prototype;return e.inverse=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.e,s=this.f,a=t*n-e*i||1e-10;return gp(this,n/a,-e/a,-i/a,t/a,(i*s-n*r)/a,-(t*s-e*r)/a)},e.multiply=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,s=this.e,a=this.f,o=t.a,l=t.c,h=t.b,c=t.d,u=t.e,d=t.f;return gp(this,o*e+h*n,o*i+h*r,l*e+c*n,l*i+c*r,s+u*e+d*n,a+u*i+d*r)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)},e.equals=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,s=this.e,a=this.f;return e===t.a&&i===t.b&&n===t.c&&r===t.d&&s===t.e&&a===t.f},e.apply=function(t,e){void 0===e&&(e={});var i=t.x,n=t.y,r=this.a,s=this.b,a=this.c,o=this.d,l=this.e,h=this.f;return e.x=i*r+n*a+l||0,e.y=i*s+n*o+h||0,e},t}();function vp(t,e,i,n){if(!t||!t.parentNode||($d||hp(t)).documentElement===t)return new _p;var r=function(t){for(var e,i;t&&t!==ep;)(i=t._gsap)&&i.uncache&&i.get(t,"x"),i&&!i.scaleX&&!i.scaleY&&i.renderTransform&&(i.scaleX=i.scaleY=1e-4,i.renderTransform(1,i),e?e.push(i):e=[i]),t=t.parentNode;return e}(t),s=dp(t)?cp:up,a=mp(t,i),o=s[0].getBoundingClientRect(),l=s[1].getBoundingClientRect(),h=s[2].getBoundingClientRect(),c=a.parentNode,u=!n&&pp(t),d=new _p((l.left-o.left)/100,(l.top-o.top)/100,(h.left-o.left)/100,(h.top-o.top)/100,o.left+(u?0:Qd.pageXOffset||$d.scrollLeft||tp.scrollLeft||ep.scrollLeft||0),o.top+(u?0:Qd.pageYOffset||$d.scrollTop||tp.scrollTop||ep.scrollTop||0));if(c.removeChild(a),r)for(o=r.length;o--;)(l=r[o]).scaleX=l.scaleY=0,l.renderTransform(1,l);return e?d.inverse():d}function yp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}
/*!
 * Draggable 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */
var xp,Sp,Mp,bp,Tp,wp,Ep,Ap,Cp,Pp,Lp,Rp,Dp,Ip,Up,Np,Op,kp,Fp,zp,Bp,Vp,Hp=0,Gp=function(){return"undefined"!=typeof window},Wp=function(){return xp||Gp()&&(xp=window.gsap)&&xp.registerPlugin&&xp},Xp=function(t){return"function"==typeof t},qp=function(t){return"object"==typeof t},Yp=function(t){return void 0===t},jp=function(){return!1},Zp="transform",Kp="transformOrigin",Jp=function(t){return Math.round(1e4*t)/1e4},$p=Array.isArray,Qp=function(t,e){var i=Mp.createElementNS?Mp.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Mp.createElement(t);return i.style?i:Mp.createElement(t)},tf=180/Math.PI,ef=1e20,nf=new _p,rf=Date.now||function(){return(new Date).getTime()},sf=[],af={},of=0,lf=/^(?:a|input|textarea|button|select)$/i,hf=0,cf={},uf={},df=function(t,e){var i,n={};for(i in t)n[i]=e?t[i]*e:t[i];return n},pf=function t(e,i){for(var n,r=e.length;r--;)i?e[r].style.touchAction=i:e[r].style.removeProperty("touch-action"),(n=e[r].children)&&n.length&&t(n,i)},ff=function(){return sf.forEach((function(t){return t()}))},mf=function(){return!sf.length&&xp.ticker.remove(ff)},gf=function(t){for(var e=sf.length;e--;)sf[e]===t&&sf.splice(e,1);xp.to(mf,{overwrite:!0,delay:15,duration:0,onComplete:mf,data:"_draggable"})},_f=function(t,e,i,n){if(t.addEventListener){var r=Dp[e];n=n||(Lp?{passive:!1}:null),t.addEventListener(r||e,i,n),r&&e!==r&&t.addEventListener(e,i,n)}},vf=function(t,e,i,n){if(t.removeEventListener){var r=Dp[e];t.removeEventListener(r||e,i,n),r&&e!==r&&t.removeEventListener(e,i,n)}},yf=function(t){t.preventDefault&&t.preventDefault(),t.preventManipulation&&t.preventManipulation()},xf=function t(e){Ip=e.touches&&Hp<e.touches.length,vf(e.target,"touchend",t)},Sf=function(t){Ip=t.touches&&Hp<t.touches.length,_f(t.target,"touchend",xf)},Mf=function(t){return Sp.pageYOffset||t.scrollTop||t.documentElement.scrollTop||t.body.scrollTop||0},bf=function(t){return Sp.pageXOffset||t.scrollLeft||t.documentElement.scrollLeft||t.body.scrollLeft||0},Tf=function t(e,i){_f(e,"scroll",i),Ef(e.parentNode)||t(e.parentNode,i)},wf=function t(e,i){vf(e,"scroll",i),Ef(e.parentNode)||t(e.parentNode,i)},Ef=function(t){return!(t&&t!==bp&&9!==t.nodeType&&t!==Mp.body&&t!==Sp&&t.nodeType&&t.parentNode)},Af=function(t,e){var i="x"===e?"Width":"Height",n="scroll"+i,r="client"+i;return Math.max(0,Ef(t)?Math.max(bp[n],Tp[n])-(Sp["inner"+i]||bp[r]||Tp[r]):t[n]-t[r])},Cf=function t(e,i){var n=Af(e,"x"),r=Af(e,"y");Ef(e)?e=uf:t(e.parentNode,i),e._gsMaxScrollX=n,e._gsMaxScrollY=r,i||(e._gsScrollX=e.scrollLeft||0,e._gsScrollY=e.scrollTop||0)},Pf=function(t,e,i){var n=t.style;n&&(Yp(n[e])&&(e=Cp(e,t)||e),null==i?n.removeProperty&&n.removeProperty(e.replace(/([A-Z])/g,"-$1").toLowerCase()):n[e]=i)},Lf=function(t){return Sp.getComputedStyle(t instanceof Element?t:t.host||(t.parentNode||{}).host||t)},Rf={},Df=function(t){if(t===Sp)return Rf.left=Rf.top=0,Rf.width=Rf.right=bp.clientWidth||t.innerWidth||Tp.clientWidth||0,Rf.height=Rf.bottom=(t.innerHeight||0)-20<bp.clientHeight?bp.clientHeight:t.innerHeight||Tp.clientHeight||0,Rf;var e=t.ownerDocument||Mp,i=Yp(t.pageX)?t.nodeType||Yp(t.left)||Yp(t.top)?Pp(t)[0].getBoundingClientRect():t:{left:t.pageX-bf(e),top:t.pageY-Mf(e),right:t.pageX-bf(e)+1,bottom:t.pageY-Mf(e)+1};return Yp(i.right)&&!Yp(i.width)?(i.right=i.left+i.width,i.bottom=i.top+i.height):Yp(i.width)&&(i={width:i.right-i.left,height:i.bottom-i.top,right:i.right,left:i.left,bottom:i.bottom,top:i.top}),i},If=function(t,e,i){var n,r=t.vars,s=r[i],a=t._listeners[e];return Xp(s)&&(n=s.apply(r.callbackScope||t,r[i+"Params"]||[t.pointerEvent])),a&&!1===t.dispatchEvent(e)&&(n=!1),n},Uf=function(t,e){var i,n,r,s=Pp(t)[0];return s.nodeType||s===Sp?Of(s,e):Yp(t.left)?{left:n=t.min||t.minX||t.minRotation||0,top:i=t.min||t.minY||0,width:(t.max||t.maxX||t.maxRotation||0)-n,height:(t.max||t.maxY||0)-i}:(r={x:0,y:0},{left:t.left-r.x,top:t.top-r.y,width:t.width,height:t.height})},Nf={},Of=function(t,e){e=Pp(e)[0];var i,n,r,s,a,o,l,h,c,u,d,p,f,m=t.getBBox&&t.ownerSVGElement,g=t.ownerDocument||Mp;if(t===Sp)r=Mf(g),n=(i=bf(g))+(g.documentElement.clientWidth||t.innerWidth||g.body.clientWidth||0),s=r+((t.innerHeight||0)-20<g.documentElement.clientHeight?g.documentElement.clientHeight:t.innerHeight||g.body.clientHeight||0);else{if(e===Sp||Yp(e))return t.getBoundingClientRect();i=r=0,m?(d=(u=t.getBBox()).width,p=u.height):(t.viewBox&&(u=t.viewBox.baseVal)&&(i=u.x||0,r=u.y||0,d=u.width,p=u.height),d||(u="border-box"===(f=Lf(t)).boxSizing,d=(parseFloat(f.width)||t.clientWidth||0)+(u?0:parseFloat(f.borderLeftWidth)+parseFloat(f.borderRightWidth)),p=(parseFloat(f.height)||t.clientHeight||0)+(u?0:parseFloat(f.borderTopWidth)+parseFloat(f.borderBottomWidth)))),n=d,s=p}return t===e?{left:i,top:r,width:n-i,height:s-r}:(o=(a=vp(e,!0).multiply(vp(t))).apply({x:i,y:r}),l=a.apply({x:n,y:r}),h=a.apply({x:n,y:s}),c=a.apply({x:i,y:s}),{left:i=Math.min(o.x,l.x,h.x,c.x),top:r=Math.min(o.y,l.y,h.y,c.y),width:Math.max(o.x,l.x,h.x,c.x)-i,height:Math.max(o.y,l.y,h.y,c.y)-r})},kf=function(t,e,i,n,r,s){var a,o,l,h={};if(e)if(1!==r&&e instanceof Array){if(h.end=a=[],l=e.length,qp(e[0]))for(o=0;o<l;o++)a[o]=df(e[o],r);else for(o=0;o<l;o++)a[o]=e[o]*r;i+=1.1,n-=1.1}else Xp(e)?h.end=function(i){var n,s,a=e.call(t,i);if(1!==r)if(qp(a)){for(s in n={},a)n[s]=a[s]*r;a=n}else a*=r;return a}:h.end=e;return(i||0===i)&&(h.max=i),(n||0===n)&&(h.min=n),s&&(h.velocity=0),h},Ff=function t(e){var i;return!(!e||!e.getAttribute||e===Tp)&&(!("true"!==(i=e.getAttribute("data-clickable"))&&("false"===i||!lf.test(e.nodeName+"")&&"true"!==e.getAttribute("contentEditable")))||t(e.parentNode))},zf=function(t,e){for(var i,n=t.length;n--;)(i=t[n]).ondragstart=i.onselectstart=e?null:jp,xp.set(i,{lazy:!0,userSelect:e?"text":"none"})},Bf=function t(e){return"fixed"===Lf(e).position||((e=e.parentNode)&&1===e.nodeType?t(e):void 0)},Vf=function(t,e){t=xp.utils.toArray(t)[0],e=e||{};var i,n,r,s,a,o,l=document.createElement("div"),h=l.style,c=t.firstChild,u=0,d=0,p=t.scrollTop,f=t.scrollLeft,m=t.scrollWidth,g=t.scrollHeight,_=0,v=0,y=0;Bp&&!1!==e.force3D?(a="translate3d(",o="px,0px)"):Zp&&(a="translate(",o="px)"),this.scrollTop=function(t,e){if(!arguments.length)return-this.top();this.top(-t,e)},this.scrollLeft=function(t,e){if(!arguments.length)return-this.left();this.left(-t,e)},this.left=function(i,n){if(!arguments.length)return-(t.scrollLeft+d);var r=t.scrollLeft-f,s=d;if((r>2||r<-2)&&!n)return f=t.scrollLeft,xp.killTweensOf(this,{left:1,scrollLeft:1}),this.left(-f),void(e.onKill&&e.onKill());(i=-i)<0?(d=i-.5|0,i=0):i>v?(d=i-v|0,i=v):d=0,(d||s)&&(this._skip||(h[Zp]=a+-d+"px,"+-u+o),d+_>=0&&(h.paddingRight=d+_+"px")),t.scrollLeft=0|i,f=t.scrollLeft},this.top=function(i,n){if(!arguments.length)return-(t.scrollTop+u);var r=t.scrollTop-p,s=u;if((r>2||r<-2)&&!n)return p=t.scrollTop,xp.killTweensOf(this,{top:1,scrollTop:1}),this.top(-p),void(e.onKill&&e.onKill());(i=-i)<0?(u=i-.5|0,i=0):i>y?(u=i-y|0,i=y):u=0,(u||s)&&(this._skip||(h[Zp]=a+-d+"px,"+-u+o)),t.scrollTop=0|i,p=t.scrollTop},this.maxScrollTop=function(){return y},this.maxScrollLeft=function(){return v},this.disable=function(){for(c=l.firstChild;c;)s=c.nextSibling,t.appendChild(c),c=s;t===l.parentNode&&t.removeChild(l)},this.enable=function(){if((c=t.firstChild)!==l){for(;c;)s=c.nextSibling,l.appendChild(c),c=s;t.appendChild(l),this.calibrate()}},this.calibrate=function(e){var s,a,o,c=t.clientWidth===i;p=t.scrollTop,f=t.scrollLeft,c&&t.clientHeight===n&&l.offsetHeight===r&&m===t.scrollWidth&&g===t.scrollHeight&&!e||((u||d)&&(a=this.left(),o=this.top(),this.left(-t.scrollLeft),this.top(-t.scrollTop)),s=Lf(t),c&&!e||(h.display="block",h.width="auto",h.paddingRight="0px",(_=Math.max(0,t.scrollWidth-t.clientWidth))&&(_+=parseFloat(s.paddingLeft)+(Vp?parseFloat(s.paddingRight):0))),h.display="inline-block",h.position="relative",h.overflow="visible",h.verticalAlign="top",h.boxSizing="content-box",h.width="100%",h.paddingRight=_+"px",Vp&&(h.paddingBottom=s.paddingBottom),i=t.clientWidth,n=t.clientHeight,m=t.scrollWidth,g=t.scrollHeight,v=t.scrollWidth-i,y=t.scrollHeight-n,r=l.offsetHeight,h.display="block",(a||o)&&(this.left(a),this.top(o)))},this.content=l,this.element=t,this._skip=!1,this.enable()},Hf=function(t){if(Gp()&&document.body){var e=window&&window.navigator;Sp=window,Mp=document,bp=Mp.documentElement,Tp=Mp.body,wp=Qp("div"),kp=!!window.PointerEvent,(Ep=Qp("div")).style.cssText="visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;cursor:grab",Op="grab"===Ep.style.cursor?"grab":"move",Up=e&&-1!==e.userAgent.toLowerCase().indexOf("android"),Rp="ontouchstart"in bp&&"orientation"in Sp||e&&(e.MaxTouchPoints>0||e.msMaxTouchPoints>0),n=Qp("div"),r=Qp("div"),s=r.style,a=Tp,s.display="inline-block",s.position="relative",n.style.cssText="width:90px;height:40px;padding:10px;overflow:auto;visibility:hidden",n.appendChild(r),a.appendChild(n),i=r.offsetHeight+18>n.scrollHeight,a.removeChild(n),Vp=i,Dp=function(t){for(var e=t.split(","),i=(("onpointerdown"in wp?"pointerdown,pointermove,pointerup,pointercancel":"onmspointerdown"in wp?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":t).split(",")),n={},r=4;--r>-1;)n[e[r]]=i[r],n[i[r]]=e[r];try{bp.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){Lp=1}}))}catch(t){}return n}("touchstart,touchmove,touchend,touchcancel"),_f(Mp,"touchcancel",jp),_f(Sp,"touchmove",jp),Tp&&Tp.addEventListener("touchstart",jp),_f(Mp,"contextmenu",(function(){for(var t in af)af[t].isPressed&&af[t].endDrag()})),xp=Ap=Wp()}var i,n,r,s,a;xp&&(Np=xp.plugins.inertia,Fp=xp.core.context||function(){},Cp=xp.utils.checkPrefix,Zp=Cp(Zp),Kp=Cp(Kp),Pp=xp.utils.toArray,zp=xp.core.getStyleSaver,Bp=!!Cp("perspective"))},Gf=function(){function t(t){this._listeners={},this.target=t||this}var e=t.prototype;return e.addEventListener=function(t,e){var i=this._listeners[t]||(this._listeners[t]=[]);~i.indexOf(e)||i.push(e)},e.removeEventListener=function(t,e){var i=this._listeners[t],n=i&&i.indexOf(e);n>=0&&i.splice(n,1)},e.dispatchEvent=function(t){var e,i=this;return(this._listeners[t]||[]).forEach((function(n){return!1===n.call(i,{type:t,target:i.target})&&(e=!1)})),e},t}(),Wf=function(t){var e,i;function n(e,i){var r;r=t.call(this)||this,Ap||Hf(),e=Pp(e)[0],r.styles=zp&&zp(e,"transform,left,top"),Np||(Np=xp.plugins.inertia),r.vars=i=df(i||{}),r.target=e,r.x=r.y=r.rotation=0,r.dragResistance=parseFloat(i.dragResistance)||0,r.edgeResistance=isNaN(i.edgeResistance)?1:parseFloat(i.edgeResistance)||0,r.lockAxis=i.lockAxis,r.autoScroll=i.autoScroll||0,r.lockedAxis=null,r.allowEventDefault=!!i.allowEventDefault,xp.getProperty(e,"x");var s,a,o,l,h,c,u,d,p,f,m,g,_,v,y,x,S,M,b,T,w,E,A,C,P,L,R,D,I,U,N,O,k,F=(i.type||"x,y").toLowerCase(),z=~F.indexOf("x")||~F.indexOf("y"),B=-1!==F.indexOf("rotation"),V=B?"rotation":z?"x":"left",H=z?"y":"top",G=!(!~F.indexOf("x")&&!~F.indexOf("left")&&"scroll"!==F),W=!(!~F.indexOf("y")&&!~F.indexOf("top")&&"scroll"!==F),X=i.minimumMovement||2,q=yp(r),Y=Pp(i.trigger||i.handle||e),j={},Z=0,K=!1,J=i.autoScrollMarginTop||40,$=i.autoScrollMarginRight||40,Q=i.autoScrollMarginBottom||40,tt=i.autoScrollMarginLeft||40,et=i.clickableTest||Ff,it=0,nt=e._gsap||xp.core.getCache(e),rt=Bf(e),st=function(t,i){return parseFloat(nt.get(e,t,i))},at=e.ownerDocument||Mp,ot=function(t){return yf(t),t.stopImmediatePropagation&&t.stopImmediatePropagation(),!1},lt=function t(i){if(q.autoScroll&&q.isDragging&&(K||S)){var n,r,s,o,l,h,c,u,p=e,f=15*q.autoScroll;for(K=!1,uf.scrollTop=null!=Sp.pageYOffset?Sp.pageYOffset:null!=at.documentElement.scrollTop?at.documentElement.scrollTop:at.body.scrollTop,uf.scrollLeft=null!=Sp.pageXOffset?Sp.pageXOffset:null!=at.documentElement.scrollLeft?at.documentElement.scrollLeft:at.body.scrollLeft,o=q.pointerX-uf.scrollLeft,l=q.pointerY-uf.scrollTop;p&&!r;)n=(r=Ef(p.parentNode))?uf:p.parentNode,s=r?{bottom:Math.max(bp.clientHeight,Sp.innerHeight||0),right:Math.max(bp.clientWidth,Sp.innerWidth||0),left:0,top:0}:n.getBoundingClientRect(),h=c=0,W&&((u=n._gsMaxScrollY-n.scrollTop)<0?c=u:l>s.bottom-Q&&u?(K=!0,c=Math.min(u,f*(1-Math.max(0,s.bottom-l)/Q)|0)):l<s.top+J&&n.scrollTop&&(K=!0,c=-Math.min(n.scrollTop,f*(1-Math.max(0,l-s.top)/J)|0)),c&&(n.scrollTop+=c)),G&&((u=n._gsMaxScrollX-n.scrollLeft)<0?h=u:o>s.right-$&&u?(K=!0,h=Math.min(u,f*(1-Math.max(0,s.right-o)/$)|0)):o<s.left+tt&&n.scrollLeft&&(K=!0,h=-Math.min(n.scrollLeft,f*(1-Math.max(0,o-s.left)/tt)|0)),h&&(n.scrollLeft+=h)),r&&(h||c)&&(Sp.scrollTo(n.scrollLeft,n.scrollTop),St(q.pointerX+h,q.pointerY+c)),p=n}if(S){var m=q.x,g=q.y;B?(q.deltaX=m-parseFloat(nt.rotation),q.rotation=m,nt.rotation=m+"deg",nt.renderTransform(1,nt)):a?(W&&(q.deltaY=g-a.top(),a.top(g)),G&&(q.deltaX=m-a.left(),a.left(m))):z?(W&&(q.deltaY=g-parseFloat(nt.y),nt.y=g+"px"),G&&(q.deltaX=m-parseFloat(nt.x),nt.x=m+"px"),nt.renderTransform(1,nt)):(W&&(q.deltaY=g-parseFloat(e.style.top||0),e.style.top=g+"px"),G&&(q.deltaX=m-parseFloat(e.style.left||0),e.style.left=m+"px")),!d||i||D||(D=!0,!1===If(q,"drag","onDrag")&&(G&&(q.x-=q.deltaX),W&&(q.y-=q.deltaY),t(!0)),D=!1)}S=!1},ht=function(t,i){var n,r,s=q.x,o=q.y;e._gsap||(nt=xp.core.getCache(e)),nt.uncache&&xp.getProperty(e,"x"),z?(q.x=parseFloat(nt.x),q.y=parseFloat(nt.y)):B?q.x=q.rotation=parseFloat(nt.rotation):a?(q.y=a.top(),q.x=a.left()):(q.y=parseFloat(e.style.top||(r=Lf(e))&&r.top)||0,q.x=parseFloat(e.style.left||(r||{}).left)||0),(b||T||w)&&!i&&(q.isDragging||q.isThrowing)&&(w&&(cf.x=q.x,cf.y=q.y,(n=w(cf)).x!==q.x&&(q.x=n.x,S=!0),n.y!==q.y&&(q.y=n.y,S=!0)),b&&(n=b(q.x))!==q.x&&(q.x=n,B&&(q.rotation=n),S=!0),T&&((n=T(q.y))!==q.y&&(q.y=n),S=!0)),S&&lt(!0),t||(q.deltaX=q.x-s,q.deltaY=q.y-o,If(q,"throwupdate","onThrowUpdate"))},ct=function(t,e,i,n){return null==e&&(e=-ef),null==i&&(i=ef),Xp(t)?function(r){var s=q.isPressed?1-q.edgeResistance:1;return t.call(q,(r>i?i+(r-i)*s:r<e?e+(r-e)*s:r)*n)*n}:$p(t)?function(n){for(var r,s,a=t.length,o=0,l=ef;--a>-1;)(s=(r=t[a])-n)<0&&(s=-s),s<l&&r>=e&&r<=i&&(o=a,l=s);return t[o]}:isNaN(t)?function(t){return t}:function(){return t*n}},ut=function(){var t,n,r,s;u=!1,a?(a.calibrate(),q.minX=m=-a.maxScrollLeft(),q.minY=_=-a.maxScrollTop(),q.maxX=f=q.maxY=g=0,u=!0):i.bounds&&(t=Uf(i.bounds,e.parentNode),B?(q.minX=m=t.left,q.maxX=f=t.left+t.width,q.minY=_=q.maxY=g=0):Yp(i.bounds.maxX)&&Yp(i.bounds.maxY)?(n=Uf(e,e.parentNode),q.minX=m=Math.round(st(V,"px")+t.left-n.left),q.minY=_=Math.round(st(H,"px")+t.top-n.top),q.maxX=f=Math.round(m+(t.width-n.width)),q.maxY=g=Math.round(_+(t.height-n.height))):(t=i.bounds,q.minX=m=t.minX,q.minY=_=t.minY,q.maxX=f=t.maxX,q.maxY=g=t.maxY),m>f&&(q.minX=f,q.maxX=f=m,m=q.minX),_>g&&(q.minY=g,q.maxY=g=_,_=q.minY),B&&(q.minRotation=m,q.maxRotation=f),u=!0),i.liveSnap&&(r=!0===i.liveSnap?i.snap||{}:i.liveSnap,s=$p(r)||Xp(r),B?(b=ct(s?r:r.rotation,m,f,1),T=null):r.points?w=function(t,e,i,n,r,s,a){return s=s&&s<ef?s*s:ef,Xp(t)?function(o){var l,h,c,u=q.isPressed?1-q.edgeResistance:1,d=o.x,p=o.y;return o.x=d=d>i?i+(d-i)*u:d<e?e+(d-e)*u:d,o.y=p=p>r?r+(p-r)*u:p<n?n+(p-n)*u:p,(l=t.call(q,o))!==o&&(o.x=l.x,o.y=l.y),1!==a&&(o.x*=a,o.y*=a),s<ef&&(h=o.x-d)*h+(c=o.y-p)*c>s&&(o.x=d,o.y=p),o}:$p(t)?function(e){for(var i,n,r,a,o=t.length,l=0,h=ef;--o>-1;)(a=(i=(r=t[o]).x-e.x)*i+(n=r.y-e.y)*n)<h&&(l=o,h=a);return h<=s?t[l]:e}:function(t){return t}}(s?r:r.points,m,f,_,g,r.radius,a?-1:1):(G&&(b=ct(s?r:r.x||r.left||r.scrollLeft,m,f,a?-1:1)),W&&(T=ct(s?r:r.y||r.top||r.scrollTop,_,g,a?-1:1))))},dt=function(){q.isThrowing=!1,If(q,"throwcomplete","onThrowComplete")},pt=function(){q.isThrowing=!1},ft=function(t,n){var r,s,o,l;t&&Np?(!0===t&&(r=i.snap||i.liveSnap||{},s=$p(r)||Xp(r),t={resistance:(i.throwResistance||i.resistance||1e3)/(B?10:1)},B?t.rotation=kf(q,s?r:r.rotation,f,m,1,n):(G&&(t[V]=kf(q,s?r:r.points||r.x||r.left,f,m,a?-1:1,n||"x"===q.lockedAxis)),W&&(t[H]=kf(q,s?r:r.points||r.y||r.top,g,_,a?-1:1,n||"y"===q.lockedAxis)),(r.points||$p(r)&&qp(r[0]))&&(t.linkedProps=V+","+H,t.radius=r.radius))),q.isThrowing=!0,l=isNaN(i.overshootTolerance)?1===i.edgeResistance?0:1-q.edgeResistance+.2:i.overshootTolerance,t.duration||(t.duration={max:Math.max(i.minDuration||0,"maxDuration"in i?i.maxDuration:2),min:isNaN(i.minDuration)?0===l||qp(t)&&t.resistance>1e3?0:.5:i.minDuration,overshoot:l}),q.tween=o=xp.to(a||e,{inertia:t,data:"_draggable",onComplete:dt,onInterrupt:pt,onUpdate:i.fastMode?If:ht,onUpdateParams:i.fastMode?[q,"onthrowupdate","onThrowUpdate"]:r&&r.radius?[!1,!0]:[]}),i.fastMode||(a&&(a._skip=!0),o.render(1e9,!0,!0),ht(!0,!0),q.endX=q.x,q.endY=q.y,B&&(q.endRotation=q.x),o.play(0),ht(!0,!0),a&&(a._skip=!1))):u&&q.applyBounds()},mt=function(t){var i,n=C;C=vp(e.parentNode,!0),t&&q.isPressed&&!C.equals(n||new _p)&&(i=n.inverse().apply({x:o,y:l}),C.apply(i,i),o=i.x,l=i.y),C.equals(nf)&&(C=null)},gt=function(){var t,i,n,r=1-q.edgeResistance,s=rt?bf(at):0,d=rt?Mf(at):0;z&&(nt.x=st(V,"px")+"px",nt.y=st(H,"px")+"px",nt.renderTransform()),mt(!1),Nf.x=q.pointerX-s,Nf.y=q.pointerY-d,C&&C.apply(Nf,Nf),o=Nf.x,l=Nf.y,S&&(St(q.pointerX,q.pointerY),lt(!0)),O=vp(e),a?(ut(),c=a.top(),h=a.left()):(_t()?(ht(!0,!0),ut()):q.applyBounds(),B?(t=e.ownerSVGElement?[nt.xOrigin-e.getBBox().x,nt.yOrigin-e.getBBox().y]:(Lf(e)[Kp]||"0 0").split(" "),x=q.rotationOrigin=vp(e).apply({x:parseFloat(t[0])||0,y:parseFloat(t[1])||0}),ht(!0,!0),i=q.pointerX-x.x-s,n=x.y-q.pointerY+d,h=q.x,c=q.y=Math.atan2(n,i)*tf):(c=st(H,"px"),h=st(V,"px"))),u&&r&&(h>f?h=f+(h-f)/r:h<m&&(h=m-(m-h)/r),B||(c>g?c=g+(c-g)/r:c<_&&(c=_-(_-c)/r))),q.startX=h=Jp(h),q.startY=c=Jp(c)},_t=function(){return q.tween&&q.tween.isActive()},vt=function(){!Ep.parentNode||_t()||q.isDragging||Ep.parentNode.removeChild(Ep)},yt=function(t,r){var h;if(!s||q.isPressed||!t||!("mousedown"!==t.type&&"pointerdown"!==t.type||r)&&rf()-it<30&&Dp[q.pointerEvent.type])N&&t&&s&&yf(t);else{if(P=_t(),k=!1,q.pointerEvent=t,Dp[t.type]?(A=~t.type.indexOf("touch")?t.currentTarget||t.target:at,_f(A,"touchend",Mt),_f(A,"touchmove",xt),_f(A,"touchcancel",Mt),_f(at,"touchstart",Sf)):(A=null,_f(at,"mousemove",xt)),R=null,kp&&A||(_f(at,"mouseup",Mt),t&&t.target&&_f(t.target,"mouseup",Mt)),E=et.call(q,t.target)&&!1===i.dragClickables&&!r)return _f(t.target,"change",Mt),If(q,"pressInit","onPressInit"),If(q,"press","onPress"),zf(Y,!0),void(N=!1);var c;if(L=!(!A||G===W||!1===q.vars.allowNativeTouchScrolling||q.vars.allowContextMenu&&t&&(t.ctrlKey||t.which>2))&&(G?"y":"x"),(N=!L&&!q.allowEventDefault)&&(yf(t),_f(Sp,"touchforcechange",yf)),t.changedTouches?(t=v=t.changedTouches[0],y=t.identifier):t.pointerId?y=t.pointerId:v=y=null,Hp++,c=lt,sf.push(c),1===sf.length&&xp.ticker.add(ff),l=q.pointerY=t.pageY,o=q.pointerX=t.pageX,If(q,"pressInit","onPressInit"),(L||q.autoScroll)&&Cf(e.parentNode),!e.parentNode||!q.autoScroll||a||B||!e.parentNode._gsMaxScrollX||Ep.parentNode||e.getBBox||(Ep.style.width=e.parentNode.scrollWidth+"px",e.parentNode.appendChild(Ep)),gt(),q.tween&&q.tween.kill(),q.isThrowing=!1,xp.killTweensOf(a||e,j,!0),a&&xp.killTweensOf(e,{scrollTo:1},!0),q.tween=q.lockedAxis=null,(i.zIndexBoost||!B&&!a&&!1!==i.zIndexBoost)&&(e.style.zIndex=n.zIndex++),q.isPressed=!0,d=!(!i.onDrag&&!q._listeners.drag),p=!(!i.onMove&&!q._listeners.move),!1!==i.cursor||i.activeCursor)for(h=Y.length;--h>-1;)xp.set(Y[h],{cursor:i.activeCursor||i.cursor||("grab"===Op?"grabbing":Op)});If(q,"press","onPress")}},xt=function(t){var i,n,r,a,h,c,u=t;if(s&&!Ip&&q.isPressed&&t){if(q.pointerEvent=t,i=t.changedTouches){if((t=i[0])!==v&&t.identifier!==y){for(a=i.length;--a>-1&&(t=i[a]).identifier!==y&&t.target!==e;);if(a<0)return}}else if(t.pointerId&&y&&t.pointerId!==y)return;A&&L&&!R&&(Nf.x=t.pageX-(rt?bf(at):0),Nf.y=t.pageY-(rt?Mf(at):0),C&&C.apply(Nf,Nf),n=Nf.x,r=Nf.y,((h=Math.abs(n-o))!==(c=Math.abs(r-l))&&(h>X||c>X)||Up&&L===R)&&(R=h>c&&G?"x":"y",L&&R!==L&&_f(Sp,"touchforcechange",yf),!1!==q.vars.lockAxisOnTouchScroll&&G&&W&&(q.lockedAxis="x"===R?"y":"x",Xp(q.vars.onLockAxis)&&q.vars.onLockAxis.call(q,u)),Up&&L===R))?Mt(u):(q.allowEventDefault||L&&(!R||L===R)||!1===u.cancelable?N&&(N=!1):(yf(u),N=!0),q.autoScroll&&(K=!0),St(t.pageX,t.pageY,p))}else N&&t&&s&&yf(t)},St=function(t,e,i){var n,r,s,a,d,p,v=1-q.dragResistance,y=1-q.edgeResistance,M=q.pointerX,E=q.pointerY,A=c,P=q.x,L=q.y,R=q.endX,D=q.endY,I=q.endRotation,U=S;q.pointerX=t,q.pointerY=e,rt&&(t-=bf(at),e-=Mf(at)),B?(a=Math.atan2(x.y-e,t-x.x)*tf,(d=q.y-a)>180?(c-=360,q.y=a):d<-180&&(c+=360,q.y=a),q.x!==h||Math.abs(c-a)>X?(q.y=a,s=h+(c-a)*v):s=h):(C&&(p=t*C.a+e*C.c+C.e,e=t*C.b+e*C.d+C.f,t=p),(r=e-l)<X&&r>-X&&(r=0),(n=t-o)<X&&n>-X&&(n=0),(q.lockAxis||q.lockedAxis)&&(n||r)&&((p=q.lockedAxis)||(q.lockedAxis=p=G&&Math.abs(n)>Math.abs(r)?"y":W?"x":null,p&&Xp(q.vars.onLockAxis)&&q.vars.onLockAxis.call(q,q.pointerEvent)),"y"===p?r=0:"x"===p&&(n=0)),s=Jp(h+n*v),a=Jp(c+r*v)),(b||T||w)&&(q.x!==s||q.y!==a&&!B)&&(w&&(cf.x=s,cf.y=a,p=w(cf),s=Jp(p.x),a=Jp(p.y)),b&&(s=Jp(b(s))),T&&(a=Jp(T(a)))),u&&(s>f?s=f+Math.round((s-f)*y):s<m&&(s=m+Math.round((s-m)*y)),B||(a>g?a=Math.round(g+(a-g)*y):a<_&&(a=Math.round(_+(a-_)*y)))),(q.x!==s||q.y!==a&&!B)&&(B?(q.endRotation=q.x=q.endX=s,S=!0):(W&&(q.y=q.endY=a,S=!0),G&&(q.x=q.endX=s,S=!0)),i&&!1===If(q,"move","onMove")?(q.pointerX=M,q.pointerY=E,c=A,q.x=P,q.y=L,q.endX=R,q.endY=D,q.endRotation=I,S=U):!q.isDragging&&q.isPressed&&(q.isDragging=k=!0,If(q,"dragstart","onDragStart")))},Mt=function t(n,r){if(s&&q.isPressed&&(!n||null==y||r||!(n.pointerId&&n.pointerId!==y&&n.target!==e||n.changedTouches&&!function(t,e){for(var i=t.length;i--;)if(t[i].identifier===e)return!0}(n.changedTouches,y)))){q.isPressed=!1;var a,o,l,h,c,u=n,d=q.isDragging,p=q.vars.allowContextMenu&&n&&(n.ctrlKey||n.which>2),f=xp.delayedCall(.001,vt);if(A?(vf(A,"touchend",t),vf(A,"touchmove",xt),vf(A,"touchcancel",t),vf(at,"touchstart",Sf)):vf(at,"mousemove",xt),vf(Sp,"touchforcechange",yf),kp&&A||(vf(at,"mouseup",t),n&&n.target&&vf(n.target,"mouseup",t)),S=!1,d&&(Z=hf=rf(),q.isDragging=!1),gf(lt),E&&!p)return n&&(vf(n.target,"change",t),q.pointerEvent=u),zf(Y,!1),If(q,"release","onRelease"),If(q,"click","onClick"),void(E=!1);for(o=Y.length;--o>-1;)Pf(Y[o],"cursor",i.cursor||(!1!==i.cursor?Op:null));if(Hp--,n){if((a=n.changedTouches)&&(n=a[0])!==v&&n.identifier!==y){for(o=a.length;--o>-1&&(n=a[o]).identifier!==y&&n.target!==e;);if(o<0&&!r)return}q.pointerEvent=u,q.pointerX=n.pageX,q.pointerY=n.pageY}return p&&u?(yf(u),N=!0,If(q,"release","onRelease")):u&&!d?(N=!1,P&&(i.snap||i.bounds)&&ft(i.inertia||i.throwProps),If(q,"release","onRelease"),Up&&"touchmove"===u.type||-1!==u.type.indexOf("cancel")||(If(q,"click","onClick"),rf()-it<300&&If(q,"doubleclick","onDoubleClick"),h=u.target||e,it=rf(),c=function(){it===I||!q.enabled()||q.isPressed||u.defaultPrevented||(h.click?h.click():at.createEvent&&((l=at.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,Sp,1,q.pointerEvent.screenX,q.pointerEvent.screenY,q.pointerX,q.pointerY,!1,!1,!1,!1,0,null),h.dispatchEvent(l)))},Up||u.defaultPrevented||xp.delayedCall(.05,c))):(ft(i.inertia||i.throwProps),q.allowEventDefault||!u||!1===i.dragClickables&&et.call(q,u.target)||!d||L&&(!R||L!==R)||!1===u.cancelable?N=!1:(N=!0,yf(u)),If(q,"release","onRelease")),_t()&&f.duration(q.tween.duration()),d&&If(q,"dragend","onDragEnd"),!0}N&&n&&s&&yf(n)},bt=function(t){if(t&&q.isDragging&&!a){var i=t.target||e.parentNode,n=i.scrollLeft-i._gsScrollX,r=i.scrollTop-i._gsScrollY;(n||r)&&(C?(o-=n*C.a+r*C.c,l-=r*C.d+n*C.b):(o-=n,l-=r),i._gsScrollX+=n,i._gsScrollY+=r,St(q.pointerX,q.pointerY))}},Tt=function(t){var e=rf(),i=e-it<100,n=e-Z<50,r=i&&I===it,s=q.pointerEvent&&q.pointerEvent.defaultPrevented,a=i&&U===it,o=t.isTrusted||null==t.isTrusted&&i&&r;if((r||n&&!1!==q.vars.suppressClickOnDrag)&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),i&&(!q.pointerEvent||!q.pointerEvent.defaultPrevented)&&(!r||o&&!a))return o&&r&&(U=it),void(I=it);(q.isPressed||n||i)&&(o&&t.detail&&i&&!s||yf(t)),i||n||k||(t&&t.target&&(q.pointerEvent=t),If(q,"click","onClick"))},wt=function(t){return C?{x:t.x*C.a+t.y*C.c+C.e,y:t.x*C.b+t.y*C.d+C.f}:{x:t.x,y:t.y}};return(M=n.get(e))&&M.kill(),r.startDrag=function(t,i){var n,r,s,a;yt(t||q.pointerEvent,!0),i&&!q.hitTest(t||q.pointerEvent)&&(n=Df(t||q.pointerEvent),r=Df(e),s=wt({x:n.left+n.width/2,y:n.top+n.height/2}),a=wt({x:r.left+r.width/2,y:r.top+r.height/2}),o-=s.x-a.x,l-=s.y-a.y),q.isDragging||(q.isDragging=k=!0,If(q,"dragstart","onDragStart"))},r.drag=xt,r.endDrag=function(t){return Mt(t||q.pointerEvent,!0)},r.timeSinceDrag=function(){return q.isDragging?0:(rf()-Z)/1e3},r.timeSinceClick=function(){return(rf()-it)/1e3},r.hitTest=function(t,e){return n.hitTest(q.target,t,e)},r.getDirection=function(t,i){var n,r,s,a,o,l,u="velocity"===t&&Np?t:qp(t)&&!B?"element":"start";return"element"===u&&(o=Df(q.target),l=Df(t)),n="start"===u?q.x-h:"velocity"===u?Np.getVelocity(e,V):o.left+o.width/2-(l.left+l.width/2),B?n<0?"counter-clockwise":"clockwise":(i=i||2,r="start"===u?q.y-c:"velocity"===u?Np.getVelocity(e,H):o.top+o.height/2-(l.top+l.height/2),a=(s=Math.abs(n/r))<1/i?"":n<0?"left":"right",s<i&&(""!==a&&(a+="-"),a+=r<0?"up":"down"),a)},r.applyBounds=function(t,n){var r,s,a,o,l,h;if(t&&i.bounds!==t)return i.bounds=t,q.update(!0,n);if(ht(!0),ut(),u&&!_t()){if(r=q.x,s=q.y,r>f?r=f:r<m&&(r=m),s>g?s=g:s<_&&(s=_),(q.x!==r||q.y!==s)&&(a=!0,q.x=q.endX=r,B?q.endRotation=r:q.y=q.endY=s,S=!0,lt(!0),q.autoScroll&&!q.isDragging))for(Cf(e.parentNode),o=e,uf.scrollTop=null!=Sp.pageYOffset?Sp.pageYOffset:null!=at.documentElement.scrollTop?at.documentElement.scrollTop:at.body.scrollTop,uf.scrollLeft=null!=Sp.pageXOffset?Sp.pageXOffset:null!=at.documentElement.scrollLeft?at.documentElement.scrollLeft:at.body.scrollLeft;o&&!h;)l=(h=Ef(o.parentNode))?uf:o.parentNode,W&&l.scrollTop>l._gsMaxScrollY&&(l.scrollTop=l._gsMaxScrollY),G&&l.scrollLeft>l._gsMaxScrollX&&(l.scrollLeft=l._gsMaxScrollX),o=l;q.isThrowing&&(a||q.endX>f||q.endX<m||q.endY>g||q.endY<_)&&ft(i.inertia||i.throwProps,a)}return q},r.update=function(t,i,n){if(i&&q.isPressed){var r=vp(e),s=O.apply({x:q.x-h,y:q.y-c}),a=vp(e.parentNode,!0);a.apply({x:r.e-s.x,y:r.f-s.y},s),q.x-=s.x-a.e,q.y-=s.y-a.f,lt(!0),gt()}var o=q.x,l=q.y;return mt(!i),t?q.applyBounds():(S&&n&&lt(!0),ht(!0)),i&&(St(q.pointerX,q.pointerY),S&&lt(!0)),q.isPressed&&!i&&(G&&Math.abs(o-q.x)>.01||W&&Math.abs(l-q.y)>.01&&!B)&&gt(),q.autoScroll&&(Cf(e.parentNode,q.isDragging),K=q.isDragging,lt(!0),wf(e,bt),Tf(e,bt)),q},r.enable=function(t){var n,r,o,l={lazy:!0};if(!1!==i.cursor&&(l.cursor=i.cursor||Op),xp.utils.checkPrefix("touchCallout")&&(l.touchCallout="none"),"soft"!==t){for(pf(Y,G===W?"none":i.allowNativeTouchScrolling&&e.scrollHeight===e.clientHeight==(e.scrollWidth===e.clientHeight)||i.allowEventDefault?"manipulation":G?"pan-y":"pan-x"),r=Y.length;--r>-1;)o=Y[r],kp||_f(o,"mousedown",yt),_f(o,"touchstart",yt),_f(o,"click",Tt,!0),xp.set(o,l),o.getBBox&&o.ownerSVGElement&&G!==W&&xp.set(o.ownerSVGElement,{touchAction:i.allowNativeTouchScrolling||i.allowEventDefault?"manipulation":G?"pan-y":"pan-x"}),i.allowContextMenu||_f(o,"contextmenu",ot);zf(Y,!1)}return Tf(e,bt),s=!0,Np&&"soft"!==t&&Np.track(a||e,z?"x,y":B?"rotation":"top,left"),e._gsDragID=n="d"+of++,af[n]=q,a&&(a.enable(),a.element._gsDragID=n),(i.bounds||B)&&gt(),i.bounds&&q.applyBounds(),q},r.disable=function(t){for(var i,n=q.isDragging,r=Y.length;--r>-1;)Pf(Y[r],"cursor",null);if("soft"!==t){for(pf(Y,null),r=Y.length;--r>-1;)i=Y[r],Pf(i,"touchCallout",null),vf(i,"mousedown",yt),vf(i,"touchstart",yt),vf(i,"click",Tt,!0),vf(i,"contextmenu",ot);zf(Y,!0),A&&(vf(A,"touchcancel",Mt),vf(A,"touchend",Mt),vf(A,"touchmove",xt)),vf(at,"mouseup",Mt),vf(at,"mousemove",xt)}return wf(e,bt),s=!1,Np&&"soft"!==t&&(Np.untrack(a||e,z?"x,y":B?"rotation":"top,left"),q.tween&&q.tween.kill()),a&&a.disable(),gf(lt),q.isDragging=q.isPressed=E=!1,n&&If(q,"dragend","onDragEnd"),q},r.enabled=function(t,e){return arguments.length?t?q.enable(e):q.disable(e):s},r.kill=function(){return q.isThrowing=!1,q.tween&&q.tween.kill(),q.disable(),xp.set(Y,{clearProps:"userSelect"}),delete af[e._gsDragID],q},r.revert=function(){this.kill(),this.styles&&this.styles.revert()},~F.indexOf("scroll")&&(a=r.scrollProxy=new Vf(e,function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t}({onKill:function(){q.isPressed&&Mt(null)}},i)),e.style.overflowY=W&&!Rp?"auto":"hidden",e.style.overflowX=G&&!Rp?"auto":"hidden",e=a.content),B?j.rotation=1:(G&&(j[V]=1),W&&(j[H]=1)),nt.force3D=!("force3D"in i)||i.force3D,Fp(yp(r)),r.enable(),r}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n.register=function(t){xp=t,Hf()},n.create=function(t,e){return Ap||Hf(),Pp(t).map((function(t){return new n(t,e)}))},n.get=function(t){return af[(Pp(t)[0]||{})._gsDragID]},n.timeSinceDrag=function(){return(rf()-hf)/1e3},n.hitTest=function(t,e,i){if(t===e)return!1;var n,r,s,a=Df(t),o=Df(e),l=a.top,h=a.left,c=a.right,u=a.bottom,d=a.width,p=a.height,f=o.left>c||o.right<h||o.top>u||o.bottom<l;return f||!i?!f:(s=-1!==(i+"").indexOf("%"),i=parseFloat(i)||0,(n={left:Math.max(h,o.left),top:Math.max(l,o.top)}).width=Math.min(c,o.right)-n.left,n.height=Math.min(u,o.bottom)-n.top,!(n.width<0||n.height<0)&&(s?(i*=.01,(r=n.width*n.height)>=d*p*i||r>=o.width*o.height*i):n.width>i&&n.height>i))},n}(Gf);!function(t,e){for(var i in e)i in t||(t[i]=e[i])}(Wf.prototype,{pointerX:0,pointerY:0,startX:0,startY:0,deltaX:0,deltaY:0,isDragging:!1,isPressed:!1}),Wf.zIndex=1e3,Wf.version="3.12.2",Wp()&&xp.registerPlugin(Wf),qn.registerPlugin(Wf);class Xf{constructor(t){this.draggableVars={proxy:null,currentPosition:0,calcBounds:{minX:0,maxX:0},bounds:{minX:0,maxX:0},dragJustStarted:!1},this._dragTimeline=null,this._hoverTimelineQuickTo=null,this._dragDuration=.2,this._wrapper=null,this._hoverLeaveTweenDuration=1.25,this._hoverTweenDuration=1.25,this.getDragTimeline=()=>{const t=this._galleryComponent.getCurrentCard();if(null===this._dragTimeline){const n=qn.timeline({paused:!0});var e="none",i="none";n.fromTo(this._hoverIndicatorsLeft[0],{force3D:!0,scaleX:"61%",scaleY:"115%"},{duration:.5,scaleX:"0%",scaleY:"115%",force3D:!0,ease:e},0),n.fromTo(this._hoverIndicatorsRight[0],{scaleX:"0%",scaleY:"115%"},{duration:.5,scaleX:"61%",scaleY:"115%",force3D:!0,ease:i},.5),n.fromTo(t.position,{precise:{z:1.5,x:-3.1}},{duration:.5,precise:{x:0,z:0},ease:e},0),n.fromTo(t.position,{precise:{x:0,z:0}},{duration:.5,precise:{z:1.5,x:3.1},ease:i},.5),n.fromTo(t.scale,{precise:{x:.9,y:.9,z:.9}},{duration:.5,precise:{x:1,y:1,z:1},ease:e},0),n.fromTo(t.scale,{precise:{x:1,y:1,z:1}},{duration:.5,precise:{x:.9,y:.9,z:.9},ease:i},.5),n.fromTo(t.rotation,{precise:{z:.12,y:-.66}},{duration:.5,precise:{z:0,y:0},ease:e},0),n.fromTo(this._galleryComponent._galleryScene.directionalLight.position,{x:-14.41},{duration:.5,x:0,ease:"linear"},0),n.fromTo(this._galleryComponent._galleryScene.directionalLight.position,{x:0},{duration:.5,x:14.41,ease:"linear"},.5),n.fromTo(t.rotation,{precise:{z:0,y:0}},{duration:.5,precise:{z:-.12,y:.66},ease:i},.5),this._dragTimeline=n,n.progress(.5),this._dragTimelineQuickTo=qn.quickTo(this._dragTimeline,"progress",{duration:this._hoverTweenDuration,ease:"power3"})}return this._dragTimeline},this._dragEndResetTimeline=null,this.onDragEnd=()=>{if(0===this._draggable.x)return!0;this._dragTimelineQuickTo.tween.duration(this._hoverTweenDuration),this.killDragEndTimeline(),this.draggableVars.currentPosition<=.4?(this.resetDrag(),this._clickTriggerCallback(!0)):this.draggableVars.currentPosition>=.6?(this.resetDrag(),this._openPageCallback()):(this.draggableVars.currentPosition=.5,this._dragEndResetTimeline=qn.timeline(),this._dragEndResetTimeline.to(this.draggableVars.proxy,{x:0,duration:.2,ease:"sine.out",onComplete:this.resetDrag},0),this._dragTimelineQuickTo(.5)),this._galleryComponent.classList.remove("dragging")},this.killDragEndTimeline=(t=!1,e=!1)=>{var i,n,r;1==e&&(null===(i=this._dragTimeline)||void 0===i||i.progress(.5),null===(n=this._dragEndResetTimeline)||void 0===n||n.progress(1)),null===(r=this._dragEndResetTimeline)||void 0===r||r.kill(),this._dragEndResetTimeline=null,t&&this.resetDrag()},this.resetDrag=()=>{qn.set(this.draggableVars.proxy,{x:0}),this._draggable.update()},this.dragEase=qn.parseEase("sine.out"),this.onDrag=()=>{this.draggableVars.currentPosition=qn.utils.mapRange(this.draggableVars.calcBounds.minX,this.draggableVars.calcBounds.maxX,-1,2,this._draggable.x);var t=qn.utils.clamp(0,1,this.draggableVars.currentPosition);this.getDragTimeline(),this._dragTimelineQuickTo.tween.duration(this._dragDuration),this._dragTimelineQuickTo(t)},this.onMouseEnter=(t=!1)=>{this._galleryComponent.canInteract()&&(this.getDragTimeline(),this._dragTimelineQuickTo.tween.duration(this._hoverTweenDuration),this._dragTimelineQuickTo(t?0:1))},this.onMouseLeave=(t=!1)=>{this._galleryComponent.canInteract()&&(this.getDragTimeline(),this._dragTimelineQuickTo.tween.duration(this._hoverLeaveTweenDuration),this._dragTimelineQuickTo(.5))},this.onMouseEnterCard=(t=!1)=>{},this.onMouseLeaveCard=(t=!1)=>{},this.isInteracting=()=>this._draggable.isPressed||this._draggable.isThrowing,this.onResize=()=>{this.draggableVars.calcBounds.maxX=this._wrapper.clientWidth,this.draggableVars.calcBounds.minX=-this.draggableVars.calcBounds.maxX,this.draggableVars.bounds.minX=.25*this.draggableVars.calcBounds.minX,this.draggableVars.bounds.maxX=.25*this.draggableVars.calcBounds.maxX,this._draggable&&(this._draggable.applyBounds(this.draggableVars.bounds),this._draggable.update(!0))},this.disable=()=>{this._draggable.disable()},this.enable=()=>{this._draggable.enable()},this.killDragTimelineAndOngoingTweens=(t=!1)=>{var e;null===(e=this._dragTimelineQuickTo)||void 0===e||e.tween.kill(),t&&this.killDragEndTimeline(!0,!0),this.killDragTimeline(),t||this.killDragEndTimeline(!0)},this.killDragTimeline=()=>{var t;null===(t=this._dragTimeline)||void 0===t||t.kill(),this._dragTimeline=null},this.reEnableCardStackInteractions=()=>{this.getDragTimeline()},this._galleryComponent=t}setupDraggable(t,e,i,n,r,s){this.draggableVars.proxy=t,this._wrapper=e,this._hoverIndicatorsLeft=i,this._hoverIndicatorsRight=n,this._clickTriggerCallback=r,this._openPageCallback=s,this.draggableVars.calcBounds.maxX=this._wrapper.clientWidth,this.draggableVars.calcBounds.minX=-this.draggableVars.bounds.maxX,this.draggableVars.bounds.minX=.25*this.draggableVars.calcBounds.minX,this.draggableVars.bounds.maxX=.25*this.draggableVars.calcBounds.maxX,this._draggable=Wf.create(this.draggableVars.proxy,{type:"x",trigger:this._wrapper,bounds:this.draggableVars.bounds,zIndexBoost:!1,onDragStart:()=>{this.killDragEndTimeline(),this._galleryComponent.classList.add("dragging"),this.draggableVars.dragJustStarted=!0},edgeResistance:.65,onDrag:this.onDrag,onThrowUpdate:this.onDrag,onThrowComplete:this.onDrag,onRelease:this.onDragEnd,allowEventDefault:!1,allowContextMenu:!0})[0]}}function qf(t,e,i,n,r,s){let a=s||1;const o=Math.PI,l=[],h=[],c=[];p(r,1,0,!0),p(r,-1,4*(r+3)+1,!1),function(i,r,s,u){let d,p,f,m,g,_,v,y,x,S;const M=3*s,b=3*u;let T=r;for(let t=1;t<5;t++){for(let t=0;t<i+2;t++)d=T,p=T+1,f=T+2,m=T+3,l.push(d,p,m,d,m,f),T+=2;T+=2}const w=2*n*Math.sin(o/(4*i)),E=t/2-n,A=e/2-n,C=4*E+4*A+4*i*w;let P;T=0;for(let t=1;t<5;t++){P=a/4;for(let e=0;e<i+3;e++)g=h[M+T],_=h[M+T+1],v=h[M+T+2],y=h[b+T],x=h[b+T+1],S=h[b+T+2],h.push(g,_,v,y,x,S),T+=3,c.push(0,0,0,0),0===e&&(P-=1===t||3===t?A/C:E/C),e===i+1&&(P-=1===t||3===t?E/C:A/C),e>0&&e<i+1&&(P-=w/C);a=4-(5-a)%4}}(r,2*(4*(r+3)+1),1,4*(r+3)+2);const u=new Bl;u.setIndex(new Pl(new Uint32Array(l),1)),u.setAttribute("position",new Pl(new Float32Array(h),3)),u.setAttribute("uv",new Pl(new Float32Array(c),2));const d=4*(r+2)*3;return u.addGroup(0,d,0),u.addGroup(d,d,1),u.addGroup(2*d,2*d+3,2),u.computeVertexNormals(),u.computeBoundingBox(),u;function p(r,s,a,u=!0){const d=1===s?0:1,p=1===s?1:0;let f,m,g,_,v,y=0;for(let t=1;t<5;t++){y++;for(let t=0;t<r+2;t++)l.push(a,a+d+y,a+p+y),y++}h.push(0,0,s*i/2),u?c.push(.5,.5):c.push(0,0);let x=0;const S=1===s?0:1;for(let a=1;a<5;a++){_=1===a||4===a?1:-1,v=a<3?1:-1,f=Math.cos(x)*t/2,m=Math.sin(x)*e/2,g=s*i/2,h.push(f,m,g),u?c.push(S+s*(.5+f/t),.5+m/e):c.push(0,0);for(let a=0;a<r+1;a++){const l={x:_*(t/2-n),y:v*(e/2-n),z:s*i/2},d=o/2*a/r;f=l.x+n*Math.cos(x+d),m=l.y+n*Math.sin(x+d),g=l.z,h.push(f,m,g),u?c.push(S+s*(.5+f/t),.5+m/e):c.push(0,0)}x+=o/2,f=Math.cos(x)*t/2,m=Math.sin(x)*e/2,g=s*i/2,h.push(f,m,g),u?c.push(S+s*(.5+f/t),.5+m/e):c.push(0,0)}}}const Yf=class{static isWebGLAvailable(){try{const t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}static isWebGL2Available(){try{const t=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!t.getContext("webgl2"))}catch(t){return!1}}static isColorSpaceAvailable(t){try{const e=document.createElement("canvas"),i=window.WebGL2RenderingContext&&e.getContext("webgl2");return i.drawingBufferColorSpace=t,i.drawingBufferColorSpace===t}catch(t){return!1}}static getWebGLErrorMessage(){return this.getErrorMessage(1)}static getWebGL2ErrorMessage(){return this.getErrorMessage(2)}static getErrorMessage(t){const e={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext};let i='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>';const n=document.createElement("div");return n.id="webglmessage",n.style.fontFamily="monospace",n.style.fontSize="13px",n.style.fontWeight="normal",n.style.textAlign="center",n.style.background="#fff",n.style.color="#000",n.style.padding="1.5em",n.style.width="400px",n.style.margin="5em auto 0",i=e[t]?i.replace("$0","graphics card"):i.replace("$0","browser"),i=i.replace("$1",{1:"WebGL",2:"WebGL 2"}[t]),n.innerHTML=i,n}};class jf{constructor(t,e,i,n,r,s,a){if(this.camera=null,this._scene=null,this.renderer=null,this.cardsWrapper=new sl,this.cards=[],this.cardMeshes=[],this.pauseAnimation=!1,this._raycaster=new qd,this._pointer=new Pa(-99999,-99999),this._pointerArea=new Pa,this._useColorManagement=!0,this.gridInteractive=!1,this._hoveredCardIndex=-1,this._useShadows=!0,this.maxPixelRatio=3,this.shadowMapSize=1024,this.onPointerMove=t=>{this._pointer.x=t.clientX/this._pointerArea.x*2-1,this._pointer.y=-t.clientY/this._pointerArea.y*2+1},this.setGridAreaHovered=t=>{this._gridAreaHovered=t,!1===t&&this.setHoveredCardIndex(-1)},this._checkRaycast=(t=!1)=>{this._raycaster.setFromCamera(this._pointer,this.camera);const e=this._raycaster.intersectObjects(this.cardMeshes);if(t)return e.length>0?this.cardMeshes.indexOf(e[0].object):-1;e.length>0?this.setHoveredCardIndex(this.cardMeshes.indexOf(e[0].object)):this.setHoveredCardIndex(-1)},this.getCardIndexFromPointer=t=>(this.onPointerMove(t),this._checkRaycast(!0)),this.setHoveredCardIndex=t=>{this._hoveredCardIndex!==t&&(this._hoveredCardIndex=t,this.cardMeshes.forEach(((t,e)=>{qn.to(t.position,{duration:e===this._hoveredCardIndex?.85:.5,ease:e===this._hoveredCardIndex?"elastic.out(1.1, 1)":"back.out",z:e===this._hoveredCardIndex?.3:0})})),-1!==this._hoveredCardIndex?this._galleryComponent.gridHoverArea.style.cursor="pointer":this._galleryComponent.gridHoverArea.style.cursor="")},this._animate=()=>{this.pauseAnimation||(requestAnimationFrame(this._animate),this.gridInteractive&&this._gridAreaHovered&&this._checkRaycast(),this.renderer.render(this._scene,this.camera))},this.resumeAnimation=()=>{this.pauseAnimation&&(this.pauseAnimation=!1,this._animate())},this.pauseAnimationWithRender=()=>{this._pauseAnimation=!0,this.renderer.render(this._scene,this.camera)},this.render=()=>{this.renderer.render(this._scene,this.camera)},this.onResize=(t,e)=>{this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,this.maxPixelRatio)),this.renderer.setSize(t,e),this.camera.aspect=t/e,this._pointerArea.set(window.innerWidth,window.innerHeight)},!Yf.isWebGLAvailable()){const t=Yf.getWebGLErrorMessage();return t.innerHTML+=".<br><br>This experience is not available without WebGL.",void document.body.appendChild(t)}this._assetLoader=t,this._galleryLayout=e,this._cardTexturePaths=i,this._cardVideoPaths=n,this._galleryComponent=a,Va.enabled=!0;const o=new URLSearchParams(window.location.search);if(this._useShadows="false"!==o.get("shadow"),this._useShadows){(({focus:t=0,size:e=25,samples:i=10}={})=>{const n=Ch.shadowmap_pars_fragment;Ch.shadowmap_pars_fragment=Ch.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP\n\n    #define PENUMBRA_FILTER_SIZE float(${e})\n    #define RGB_NOISE_FUNCTION(uv) (randRGB(uv))\n    vec3 randRGB(vec2 uv) {\n      return vec3(\n        fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),\n        fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),\n        fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)\n      );\n    }\n    \n    vec3 lowPassRandRGB(vec2 uv) {\n      // 3x3 convolution (average)\n      // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9\n      vec3 result = vec3(0);\n      result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));\n      result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));\n      result *= 0.111111111; // 1.0 / 9.0\n      return result;\n    }\n    vec3 highPassRandRGB(vec2 uv) {\n      // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal\n      // hp(x) = x - lp(x)\n      return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;\n    }\n    \n    \n    vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n      const float goldenAngle = 2.399963f; // radians\n      float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n      float theta = float(sampleIndex) * goldenAngle + angle;\n      float sine = sin(theta);\n      float cosine = cos(theta);\n      return vec2(cosine, sine) * r;\n    }\n    float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n      return (zReceiver - zBlocker) / zBlocker;\n    }\n    float findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {\n      float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n      float blockerDepthSum = float(${t});\n      float blockers = 0.0;\n    \n      int j = 0;\n      vec2 offset = vec2(0.);\n      float depth = 0.;\n    \n      #pragma unroll_loop_start\n      for(int i = 0; i < ${i}; i ++) {\n        offset = (vogelDiskSample(j, ${i}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;\n        depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));\n        if (depth < compare) {\n          blockerDepthSum += depth;\n          blockers++;\n        }\n        j++;\n      }\n      #pragma unroll_loop_end\n    \n      if (blockers > 0.0) {\n        return blockerDepthSum / blockers;\n      }\n      return -1.0;\n    }\n            \n    float vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {\n      float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n      float shadow = 0.0f;\n      int j = 0;\n      vec2 vogelSample = vec2(0.0);\n      vec2 offset = vec2(0.0);\n      #pragma unroll_loop_start\n      for (int i = 0; i < ${i}; i++) {\n        vogelSample = vogelDiskSample(j, ${i}, angle) * texelSize;\n        offset = vogelSample * (1.0 + filterRadius * float(${e}));\n        shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n        j++;\n      }\n      #pragma unroll_loop_end\n      return shadow * 1.0 / ${i}.0;\n    }\n    \n    float PCSS (sampler2D shadowMap, vec4 coords) {\n      vec2 uv = coords.xy;\n      float zReceiver = coords.z; // Assumed to be eye-space z in this code\n      float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;\n      float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);\n      if (avgBlockerDepth == -1.0) {\n        return 1.0;\n      }\n      float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n      return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);\n    }`).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )")})({size:10,samples:3,focus:.7})}this.camera=new ph(65,r/s,.01,100),this.camera.position.set(0,0,10),this._scene=new sd,this._scene.add(this.camera),this.ambientLight=new Fd(16777215,.42),this._scene.add(this.ambientLight),this.directionalLight=new kd(16777215,.49),this._useShadows&&(this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.width=this.shadowMapSize,this.directionalLight.shadow.mapSize.height=this.shadowMapSize,this.directionalLight.shadow.camera.near=1,this.directionalLight.shadow.camera.far=100,this.directionalLight.shadow.camera.left=-15,this.directionalLight.shadow.camera.right=15,this.directionalLight.shadow.camera.top=15,this.directionalLight.shadow.camera.bottom=-15),this.directionalLight.position.set(0,10,15),this._scene.add(this.directionalLight),this.spotLight=new Nd(16777215),this.spotLight.position.set(3.12,8.96,10.35),this.spotLight.power=1.446,this.spotLight.penumbra=.48,this.spotLight.distance=0,this.spotLight.intensity=.218,this.spotLight.angle=.451,this._useShadows,this._scene.add(this.spotLight);var l=new od;l.opacity=.15;var h=new rh(new Ah(6*this._galleryLayout.cardWidth,4*this._galleryLayout.cardHeight),l);h.receiveShadow=!0,this.shadowCatcher=h,this.shadowCatcher.position.z-=.26,this._useShadows&&this._scene.add(h);var c=qf(this._galleryLayout.cardWidth,this._galleryLayout.cardHeight,this._galleryLayout.cardThickness,this._galleryLayout.cardCornerRadius,32),u=qf(this._galleryLayout.cardWidth,this._galleryLayout.cardHeight,this._galleryLayout.cardThickness,0,32);c.morphAttributes.position=[],c.morphAttributes.position[0]=new Dl(u.attributes.position.array,u.attributes.position.itemSize),this._assetLoader.loadAssets(this._cardTexturePaths,this._cardVideoPaths),this.setupCards(c),this.scrollQuickTo=qn.quickTo(this.cardsWrapper.position,"y",{duration:.1,ease:"linear.inout"}),this.renderer=new rd({antialias:!0,powerPreference:"high-performance",alpha:!0}),this.renderer.useLegacyLights=!0,this._useColorManagement?(this.renderer.toneMapping=ms,this.renderer.outputEncoding=$s):(this.renderer.outputEncoding=Js,this.ambientLight.intensity=.5),this._useShadows&&(this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=ns),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,this.maxPixelRatio)),this.renderer.setSize(r,s),this._animate()}setupCards(t){this._assetLoader.cardMaterials.forEach(((e,i)=>{let n=new rh(t,e);this._useShadows&&(n.receiveShadow=!0,n.castShadow=!0);var r=Ca.clamp(i,0,this._galleryLayout.maxVisibleCardsInStack-1),s=new sl;s.position.z=.1*-r,s.rotateZ(-r*this._galleryLayout.cardAngle),s.add(n),s.cardMesh=n,this.cards.push(s),this.cardsWrapper.add(s),this.cardMeshes.push(n)})),this._scene.add(this.cardsWrapper)}}function Zf(t,e){var i,n,r=[],s={},a=s.format=function(t){return t?(t="/"+t.replace(/^\/|\/$/g,""),i.test(t)&&t.replace(i,"/")):t};return t="/"+(t||"").replace(/^\/|\/$/g,""),i="/"==t?/^\/+/:new RegExp("^\\"+t+"(?=\\/|$)\\/?","i"),s.route=function(e,r){"/"!=e[0]||i.test(e)||(e=t+e),history[(e===n||r?"replace":"push")+"State"](e,null,e)},s.on=function(t,e){return(t=function(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var i,n,r,s,a=[],o="",l=t.split("/");for(l[0]||l.shift();r=l.shift();)"*"===(i=r[0])?(a.push("wild"),o+="/(.*)"):":"===i?(n=r.indexOf("?",1),s=r.indexOf(".",1),a.push(r.substring(1,~n?n:~s?s:r.length)),o+=~n&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~n?"?":"")+"\\"+r.substring(s))):o+="/"+r;return{keys:a,pattern:new RegExp("^"+o+(e?"(?=$|/)":"/?$"),"i")}}(t)).fn=e,r.push(t),s},s.run=function(t){var i,o,l=0,h={};if(t=a(t||location.pathname)){for(t=t.match(/[^\?#]*/)[0],n=t;l<r.length;l++)if(i=(o=r[l]).pattern.exec(t)){for(l=0;l<o.keys.length;)h[o.keys[l]]=i[++l]||null;return o.fn(h),s}e&&e(t)}return s},s.listen=function(t){function e(t){s.run()}function n(t){var e=t.target.closest("a"),n=e&&e.getAttribute("href");t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button||t.defaultPrevented||n&&!e.target&&e.host===location.host&&"#"!=n[0]&&("/"!=n[0]||i.test(n))&&(t.preventDefault(),s.route(n))}return Kf("push"),Kf("replace"),addEventListener("popstate",e),addEventListener("replacestate",e),addEventListener("pushstate",e),addEventListener("click",n),s.unlisten=function(){removeEventListener("popstate",e),removeEventListener("replacestate",e),removeEventListener("pushstate",e),removeEventListener("click",n)},s.run(t)},s}function Kf(t,e){history[t]||(history[t]=t,e=history[t+="State"],history[t]=function(i){var n=new Event(t.toLowerCase());return n.uri=i,e.apply(this,arguments),dispatchEvent(n)})}var Jf=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(t){s(t)}}function o(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};class $f{constructor(){this.base="/",this.componentTagForContent="myth-page",this.cardRoutes=["be-more-than-just-a-landing-page","bring-code-from-platforms-into-the-browser","interact-seamlessly-with-users-local-files","render-heavy-graphics-in-the-browser","simplify-secure-logins-with-biometric-authentication","deliver-app-like-navigations"],this.prefetchedRoutes=[],this.firstLoad=!0,this.onRouteChangeCallback=null,this._ignoreFirst=!0,this.siteReady=()=>{this.aboutDialog=document.querySelector("myth-about"),this.shareDialog=document.querySelector("myth-share"),this.router.listen()},this.gotoCardIndex=t=>{t>=0&&t<this.cardRoutes.length&&this.router.route(this.cardRoutes[t])},this.onRouteChange=t=>Jf(this,void 0,void 0,(function*(){this.shareDialog.updateSharelink();var e=window.location.hash;if((null==e?void 0:e.length)>0){"#share"===e?this.shareDialog.open():this.shareDialog.close(),"#about"===e?this.aboutDialog.open():this.aboutDialog.close();if(this.aboutDialog._open||this.shareDialog._open||this.onRouteChangeCallback(-1,null,e),!this.firstLoad||null===t.wild)return void(this.firstLoad=!1)}if(!this.firstLoad){const t=this.aboutDialog._open||this.shareDialog._open;if(this.aboutDialog.close(),this.shareDialog.close(),t)return}this.firstLoad=!1;var i=this.cardRoutes.indexOf(t.wild);if(i>=0&&i<this.cardRoutes.length){if(!this.prefetchedRoutes[i]){const e=yield this.fetchRoute(this.base+t.wild);this.prefetchedRoutes[i]=e}const e=this.extractRouteContent(this.prefetchedRoutes[i]);this.onRouteChangeCallback(i,e)}else null===t.wild&&this.onRouteChangeCallback(-1,null)})),this.prefetchAllRoutes=()=>{this.cardRoutes.forEach(((t,e)=>Jf(this,void 0,void 0,(function*(){if(!this.prefetchedRoutes[e]){const i=yield this.fetchRoute(this.base+t);this.prefetchedRoutes[e]=i}}))))},"scrollRestoration"in history&&(history.scrollRestoration="manual"),this.router=Zf(this.base),this.router.on("/*",this.onRouteChange),document.addEventListener("loading-completed",this.prefetchAllRoutes)}getCardIndexFromHash(t){return this.cardRoutes.indexOf(t.replace("#card-",""))}getHashUrlForCardIndex(t){return"#card-"+this.cardRoutes[t]}extractRouteContent(t){return(new DOMParser).parseFromString(t,"text/html").querySelector(this.componentTagForContent)}fetchRoute(t){return Jf(this,void 0,void 0,(function*(){let e=yield fetch(t,{credentials:"same-origin"});return yield e.text()}))}}
/*!
 * paths 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var Qf=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,tm=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,em=Math.PI/180,im=(Math.PI,Math.sin),nm=Math.cos,rm=Math.abs,sm=Math.sqrt,am=(Math.atan2,function(t){return"number"==typeof t}),om=1e5,lm=function(t){return Math.round(t*om)/om||0};function hm(t,e,i,n,r,s,a,o,l){if(t!==o||e!==l){i=rm(i),n=rm(n);var h=r%360*em,c=nm(h),u=im(h),d=Math.PI,p=2*d,f=(t-o)/2,m=(e-l)/2,g=c*f+u*m,_=-u*f+c*m,v=g*g,y=_*_,x=v/(i*i)+y/(n*n);x>1&&(i=sm(x)*i,n=sm(x)*n);var S=i*i,M=n*n,b=(S*M-S*y-M*v)/(S*y+M*v);b<0&&(b=0);var T=(s===a?-1:1)*sm(b),w=T*(i*_/n),E=T*(-n*g/i),A=(t+o)/2+(c*w-u*E),C=(e+l)/2+(u*w+c*E),P=(g-w)/i,L=(_-E)/n,R=(-g-w)/i,D=(-_-E)/n,I=P*P+L*L,U=(L<0?-1:1)*Math.acos(P/sm(I)),N=(P*D-L*R<0?-1:1)*Math.acos((P*R+L*D)/sm(I*(R*R+D*D)));isNaN(N)&&(N=d),!a&&N>0?N-=p:a&&N<0&&(N+=p),U%=p,N%=p;var O,k=Math.ceil(rm(N)/(p/4)),F=[],z=N/k,B=4/3*im(z/2)/(1+nm(z/2)),V=c*i,H=u*i,G=u*-n,W=c*n;for(O=0;O<k;O++)g=nm(r=U+O*z),_=im(r),P=nm(r+=z),L=im(r),F.push(g-B*_,_+B*g,P+B*L,L-B*P,P,L);for(O=0;O<F.length;O+=2)g=F[O],_=F[O+1],F[O]=g*V+_*G+A,F[O+1]=g*H+_*W+C;return F[O-2]=o,F[O-1]=l,F}}function cm(t){var e,i,n,r,s,a,o,l,h,c,u,d,p,f,m,g=(t+"").replace(tm,(function(t){var e=+t;return e<1e-4&&e>-1e-4?0:e})).match(Qf)||[],_=[],v=0,y=0,x=2/3,S=g.length,M=0,b=function(t,e,i,n){c=(i-t)/3,u=(n-e)/3,o.push(t+c,e+u,i-c,n-u,i,n)};if(!t||!isNaN(g[0])||isNaN(g[1]))return _;for(e=0;e<S;e++)if(p=s,isNaN(g[e])?a=(s=g[e].toUpperCase())!==g[e]:e--,n=+g[e+1],r=+g[e+2],a&&(n+=v,r+=y),e||(l=n,h=r),"M"===s)o&&(o.length<8?_.length-=1:M+=o.length),v=l=n,y=h=r,o=[n,r],_.push(o),e+=2,s="L";else if("C"===s)o||(o=[0,0]),a||(v=y=0),o.push(n,r,v+1*g[e+3],y+1*g[e+4],v+=1*g[e+5],y+=1*g[e+6]),e+=6;else if("S"===s)c=v,u=y,"C"!==p&&"S"!==p||(c+=v-o[o.length-4],u+=y-o[o.length-3]),a||(v=y=0),o.push(c,u,n,r,v+=1*g[e+3],y+=1*g[e+4]),e+=4;else if("Q"===s)c=v+(n-v)*x,u=y+(r-y)*x,a||(v=y=0),v+=1*g[e+3],y+=1*g[e+4],o.push(c,u,v+(n-v)*x,y+(r-y)*x,v,y),e+=4;else if("T"===s)c=v-o[o.length-4],u=y-o[o.length-3],o.push(v+c,y+u,n+(v+1.5*c-n)*x,r+(y+1.5*u-r)*x,v=n,y=r),e+=2;else if("H"===s)b(v,y,v=n,y),e+=1;else if("V"===s)b(v,y,v,y=n+(a?y-v:0)),e+=1;else if("L"===s||"Z"===s)"Z"===s&&(n=l,r=h,o.closed=!0),("L"===s||rm(v-n)>.5||rm(y-r)>.5)&&(b(v,y,n,r),"L"===s&&(e+=2)),v=n,y=r;else if("A"===s){if(f=g[e+4],m=g[e+5],c=g[e+6],u=g[e+7],i=7,f.length>1&&(f.length<3?(u=c,c=m,i--):(u=m,c=f.substr(2),i-=2),m=f.charAt(1),f=f.charAt(0)),d=hm(v,y,+g[e+1],+g[e+2],+g[e+3],+f,+m,(a?v:0)+1*c,(a?y:0)+1*u),e+=i,d)for(i=0;i<d.length;i++)o.push(d[i]);v=o[o.length-2],y=o[o.length-1]}return(e=o.length)<6?(_.pop(),e=0):o[0]===o[e-2]&&o[1]===o[e-1]&&(o.closed=!0),_.totalPoints=M+e,_}function um(t){am(t[0])&&(t=[t]);var e,i,n,r,s="",a=t.length;for(i=0;i<a;i++){for(r=t[i],s+="M"+lm(r[0])+","+lm(r[1])+" C",e=r.length,n=2;n<e;n++)s+=lm(r[n++])+","+lm(r[n++])+" "+lm(r[n++])+","+lm(r[n++])+" "+lm(r[n++])+","+lm(r[n])+" ";r.closed&&(s+="z")}return s}
/*!
 * CustomEase 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var dm,pm,fm=function(){return dm||"undefined"!=typeof window&&(dm=window.gsap)&&dm.registerPlugin&&dm},mm=function(){(dm=fm())&&(dm.registerEase("_CE",xm.create),pm=1)},gm=function(t){return~~(1e3*t+(t<0?-.5:.5))/1e3},_m=/[-+=\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/gi,vm=/[cLlsSaAhHvVtTqQ]/g,ym=function t(e,i,n,r,s,a,o,l,h,c,u){var d,p=(e+n)/2,f=(i+r)/2,m=(n+s)/2,g=(r+a)/2,_=(s+o)/2,v=(a+l)/2,y=(p+m)/2,x=(f+g)/2,S=(m+_)/2,M=(g+v)/2,b=(y+S)/2,T=(x+M)/2,w=o-e,E=l-i,A=Math.abs((n-o)*E-(r-l)*w),C=Math.abs((s-o)*E-(a-l)*w);return c||(c=[{x:e,y:i},{x:o,y:l}],u=1),c.splice(u||c.length-1,0,{x:b,y:T}),(A+C)*(A+C)>h*(w*w+E*E)&&(d=c.length,t(e,i,p,f,y,x,b,T,h,c,u),t(b,T,S,M,_,v,o,l,h,c,u+1+(c.length-d))),c},xm=function(){function t(t,e,i){pm||mm(),this.id=t,this.setData(e,i)}var e=t.prototype;return e.setData=function(t,e){e=e||{};var i,n,r,s,a,o,l,h,c,u=(t=t||"0,0,1,1").match(_m),d=1,p=[],f=[],m=e.precision||1,g=m<=1;if(this.data=t,(vm.test(t)||~t.indexOf("M")&&t.indexOf("C")<0)&&(u=cm(t)[0]),4===(i=u.length))u.unshift(0,0),u.push(1,1),i=8;else if((i-2)%6)throw"Invalid CustomEase";for(0==+u[0]&&1==+u[i-2]||function(t,e,i){i||0===i||(i=Math.max(+t[t.length-1],+t[1]));var n,r=-1*+t[0],s=-i,a=t.length,o=1/(+t[a-2]+r),l=-e||(Math.abs(+t[a-1]-+t[1])<.01*(+t[a-2]-+t[0])?function(t){var e,i=t.length,n=1e20;for(e=1;e<i;e+=6)+t[e]<n&&(n=+t[e]);return n}(t)+s:+t[a-1]+s);for(l=l?1/l:-o,n=0;n<a;n+=2)t[n]=(+t[n]+r)*o,t[n+1]=(+t[n+1]+s)*l}(u,e.height,e.originY),this.segment=u,s=2;s<i;s+=6)n={x:+u[s-2],y:+u[s-1]},r={x:+u[s+4],y:+u[s+5]},p.push(n,r),ym(n.x,n.y,+u[s],+u[s+1],+u[s+2],+u[s+3],r.x,r.y,1/(2e5*m),p,p.length-1);for(i=p.length,s=0;s<i;s++)l=p[s],h=p[s-1]||l,(l.x>h.x||h.y!==l.y&&h.x===l.x||l===h)&&l.x<=1?(h.cx=l.x-h.x,h.cy=l.y-h.y,h.n=l,h.nx=l.x,g&&s>1&&Math.abs(h.cy/h.cx-p[s-2].cy/p[s-2].cx)>2&&(g=0),h.cx<d&&(h.cx?d=h.cx:(h.cx=.001,s===i-1&&(h.x-=.001,d=Math.min(d,.001),g=0)))):(p.splice(s--,1),i--);if(a=1/(i=1/d+1|0),o=0,l=p[0],g){for(s=0;s<i;s++)c=s*a,l.nx<c&&(l=p[++o]),n=l.y+(c-l.x)/l.cx*l.cy,f[s]={x:c,cx:a,y:n,cy:0,nx:9},s&&(f[s-1].cy=n-f[s-1].y);f[i-1].cy=p[p.length-1].y-n}else{for(s=0;s<i;s++)l.nx<s*a&&(l=p[++o]),f[s]=l;o<p.length-1&&(f[s-1]=p[p.length-2])}return this.ease=function(t){var e=f[t*i|0]||f[i-1];return e.nx<t&&(e=e.n),e.y+(t-e.x)/e.cx*e.cy},this.ease.custom=this,this.id&&dm&&dm.registerEase(this.id,this.ease),this},e.getSVGData=function(e){return t.getSVGData(this,e)},t.create=function(e,i,n){return new t(e,i,n).ease},t.register=function(t){dm=t,mm()},t.get=function(t){return dm.parseEase(t)},t.getSVGData=function(e,i){var n,r,s,a,o,l,h,c,u,d,p=(i=i||{}).width||100,f=i.height||100,m=i.x||0,g=(i.y||0)+f,_=dm.utils.toArray(i.path)[0];if(i.invert&&(f=-f,g=0),"string"==typeof e&&(e=dm.parseEase(e)),e.custom&&(e=e.custom),e instanceof t)n=um(function(t,e,i,n,r,s,a){for(var o,l,h,c,u,d=t.length;--d>-1;)for(l=(o=t[d]).length,h=0;h<l;h+=2)c=o[h],u=o[h+1],o[h]=c*e+u*n+s,o[h+1]=c*i+u*r+a;return t._dirty=1,t}([e.segment],p,0,0,-f,m,g));else{for(n=[m,g],a=1/(h=Math.max(5,200*(i.precision||1))),c=5/(h+=2),u=gm(m+a*p),r=((d=gm(g+e(a)*-f))-g)/(u-m),s=2;s<h;s++)o=gm(m+s*a*p),l=gm(g+e(s*a)*-f),(Math.abs((l-d)/(o-u)-r)>c||s===h-1)&&(n.push(u,d),r=(l-d)/(o-u)),u=o,d=l;n="M"+n.join(",")}return _&&_.setAttribute("d",n),n},t}();fm()&&dm.registerPlugin(xm),xm.version="3.12.2";
/*!
 * ScrollToPlugin 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
var Sm,Mm,bm,Tm,wm,Em,Am,Cm,Pm=function(){return"undefined"!=typeof window},Lm=function(){return Sm||Pm()&&(Sm=window.gsap)&&Sm.registerPlugin&&Sm},Rm=function(t){return"string"==typeof t},Dm=function(t){return"function"==typeof t},Im=function(t,e){var i="x"===e?"Width":"Height",n="scroll"+i,r="client"+i;return t===bm||t===Tm||t===wm?Math.max(Tm[n],wm[n])-(bm["inner"+i]||Tm[r]||wm[r]):t[n]-t["offset"+i]},Um=function(t,e){var i="scroll"+("x"===e?"Left":"Top");return t===bm&&(null!=t.pageXOffset?i="page"+e.toUpperCase()+"Offset":t=null!=Tm[i]?Tm:wm),function(){return t[i]}},Nm=function(t,e){if(!(t=Em(t)[0])||!t.getBoundingClientRect)return{x:0,y:0};var i=t.getBoundingClientRect(),n=!e||e===bm||e===wm,r=n?{top:Tm.clientTop-(bm.pageYOffset||Tm.scrollTop||wm.scrollTop||0),left:Tm.clientLeft-(bm.pageXOffset||Tm.scrollLeft||wm.scrollLeft||0)}:e.getBoundingClientRect(),s={x:i.left-r.left,y:i.top-r.top};return!n&&e&&(s.x+=Um(e,"x")(),s.y+=Um(e,"y")()),s},Om=function(t,e,i,n,r){return isNaN(t)||"object"==typeof t?Rm(t)&&"="===t.charAt(1)?parseFloat(t.substr(2))*("-"===t.charAt(0)?-1:1)+n-r:"max"===t?Im(e,i)-r:Math.min(Im(e,i),Nm(t,e)[i]-r):parseFloat(t)-r},km=function(){Sm=Lm(),Pm()&&Sm&&"undefined"!=typeof document&&document.body&&(bm=window,wm=document.body,Tm=document.documentElement,Em=Sm.utils.toArray,Sm.config({autoKillThreshold:7}),Am=Sm.config(),Mm=1)},Fm={version:"3.12.2",name:"scrollTo",rawVars:1,register:function(t){Sm=t,km()},init:function(t,e,i,n,r){Mm||km();var s=this,a=Sm.getProperty(t,"scrollSnapType");s.isWin=t===bm,s.target=t,s.tween=i,e=function(t,e,i,n){if(Dm(t)&&(t=t(e,i,n)),"object"!=typeof t)return Rm(t)&&"max"!==t&&"="!==t.charAt(1)?{x:t,y:t}:{y:t};if(t.nodeType)return{y:t,x:t};var r,s={};for(r in t)s[r]="onAutoKill"!==r&&Dm(t[r])?t[r](e,i,n):t[r];return s}(e,n,t,r),s.vars=e,s.autoKill=!!e.autoKill,s.getX=Um(t,"x"),s.getY=Um(t,"y"),s.x=s.xPrev=s.getX(),s.y=s.yPrev=s.getY(),Cm||(Cm=Sm.core.globals().ScrollTrigger),"smooth"===Sm.getProperty(t,"scrollBehavior")&&Sm.set(t,{scrollBehavior:"auto"}),a&&"none"!==a&&(s.snap=1,s.snapInline=t.style.scrollSnapType,t.style.scrollSnapType="none"),null!=e.x?(s.add(s,"x",s.x,Om(e.x,t,"x",s.x,e.offsetX||0),n,r),s._props.push("scrollTo_x")):s.skipX=1,null!=e.y?(s.add(s,"y",s.y,Om(e.y,t,"y",s.y,e.offsetY||0),n,r),s._props.push("scrollTo_y")):s.skipY=1},render:function(t,e){for(var i,n,r,s,a,o=e._pt,l=e.target,h=e.tween,c=e.autoKill,u=e.xPrev,d=e.yPrev,p=e.isWin,f=e.snap,m=e.snapInline;o;)o.r(t,o.d),o=o._next;i=p||!e.skipX?e.getX():u,r=(n=p||!e.skipY?e.getY():d)-d,s=i-u,a=Am.autoKillThreshold,e.x<0&&(e.x=0),e.y<0&&(e.y=0),c&&(!e.skipX&&(s>a||s<-a)&&i<Im(l,"x")&&(e.skipX=1),!e.skipY&&(r>a||r<-a)&&n<Im(l,"y")&&(e.skipY=1),e.skipX&&e.skipY&&(h.kill(),e.vars.onAutoKill&&e.vars.onAutoKill.apply(h,e.vars.onAutoKillParams||[]))),p?bm.scrollTo(e.skipX?i:e.x,e.skipY?n:e.y):(e.skipY||(l.scrollTop=e.y),e.skipX||(l.scrollLeft=e.x)),!f||1!==t&&0!==t||(n=l.scrollTop,i=l.scrollLeft,m?l.style.scrollSnapType=m:l.style.removeProperty("scroll-snap-type"),l.scrollTop=n+1,l.scrollLeft=i+1,l.scrollTop=n,l.scrollLeft=i),e.xPrev=e.x,e.yPrev=e.y,Cm&&Cm.update()},kill:function(t){var e="scrollTo"===t;(e||"scrollTo_x"===t)&&(this.skipX=1),(e||"scrollTo_y"===t)&&(this.skipY=1)}};function zm(){return window.scrollY/function(){const t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)-window.innerHeight}()}Fm.max=Im,Fm.getOffset=Nm,Fm.buildGetter=Um,Lm()&&Sm.registerPlugin(Fm);var Bm=function(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};qn.registerPlugin(Fm,xm),qn.registerPlugin({name:"precise",init(t,e,i,n,r){let s,a,o=this;for(s in o.t=t,e)a=e[s],"function"==typeof a&&(a=a.call(i,n,t,r)),o.pt={n:o.pt,p:s,s:t[s],c:a-t[s]},o._props.push(s)},render(t,e){let i=e.pt;for(;i;)e.t[i.p]=i.s+i.c*t,i=i.n}});const Vm=xm.create("custom","M0,0,C0,0,0.035,-0.003,0.055,-0.01,0.1,-0.025,0.129,-0.043,0.175,-0.058,0.193,-0.064,0.209,-0.067,0.227,-0.065,0.248,-0.063,0.269,-0.057,0.287,-0.045,0.309,-0.03,0.325,-0.011,0.342,0.012,0.363,0.043,0.374,0.067,0.39,0.103,0.41,0.15,0.421,0.18,0.435,0.23,0.477,0.394,0.486,0.422,0.528,0.589,0.545,0.658,0.556,0.697,0.579,0.763,0.595,0.809,0.609,0.837,0.629,0.881,0.672,0.978,1,1,1,1");class Hm extends $r{constructor(){super(),this._cardTexturePaths=["/assets/images/card_titles/1_titlecard.png","/assets/images/card_titles/2.png","/assets/images/card_titles/3.png","/assets/images/card_titles/4.png","/assets/images/card_titles/5.png","/assets/images/card_titles/6.png"],this._cardVideoPaths=[null,"/assets/videos/card_videos/02.mp4","/assets/videos/card_videos/03.mp4","/assets/videos/card_videos/04.mp4","/assets/videos/card_videos/05.mp4","/assets/videos/card_videos/06.mp4"],this._cardTitles=["Be more than a landing page","Bring code from platforms into the browser","Interact seamlessly with local files","Render heavy graphics in the browser","Simplify secure logins","Deliver app-like navigations"],this._clickedCard=!1,this._cardStackInteractionsDisabled=!1,this.GridModeActive=()=>this._gridMode,this._gridMode=!1,this._scrollHeight=0,this.scrollQuickTo=null,this._cardOpenZPosition=6,this._cardTransitioning=!1,this._galleryLayout=new Jd(this._cardTexturePaths.length),this._dragManager=new Xf(this),this._texturesLoaded=()=>{this.dispatchEvent(new CustomEvent("loading-completed",{bubbles:!0}))},this._currGridTimeline=null,this._currGridTimelineProgressTween=null,this._assetLoader=new Kd(this._galleryLayout.cardWidth,this._galleryLayout.cardHeight,this._texturesLoaded),this._currPageTransitionTimeline=null,this._pageopen=!1,this._pageOpenCardIndex=-1,this._pageOpenGridSavedScrollPosition=0,this._router=new $f,this.viewOffsetInfluence=1,this.setNextCardHashLink=t=>{this.nextCardHashLink="#card-"+this._router.cardRoutes[t]},this.killAndCompleteAnyOngoingStateTransition=(t=!1)=>{var e,i,n,r,s,a,o;this._currPageTransitionTimeline&&(null===(e=this._transitionScrollTo)||void 0===e||e.progress(1,!1).pause(),null===(i=this._transitionScrollTo)||void 0===i||i.kill(),this._transitionScrollTo=null,null===(n=this._currPageTransitionTimeline)||void 0===n||n.progress(1,!1).pause(),null===(r=this._currPageTransitionTimeline)||void 0===r||r.kill(),this._currPageTransitionTimeline=null,null===(s=this._currPageTransitionTimeline)||void 0===s||s.progress(1,!1).pause(),null===(a=this._currPageTransitionTimeline)||void 0===a||a.kill(),this._currPageTransitionTimeline=null),null===(o=this._transitionDelayedCall)||void 0===o||o.kill(),this._transitionDelayedCall=null,t&&this.killCurrentGridTimeline(t)},this.pageLoadCalled=0,this.onPageLoaded=(t,e,i=null)=>{var n,r,s=this._cardTransitioning;this.pageLoadCalled++;var a=this._currGridTimeline&&(null===(n=this._currGridTimeline)||void 0===n?void 0:n.progress())>0&&(null===(r=this._currGridTimeline)||void 0===r?void 0:r.progress())<1,o=a||!1;if(this.killAndCompleteAnyOngoingStateTransition(o),t>=0&&e&&this._pageOpenCardIndex!==t){var l=this._galleryLayout.currCardIndex;this._galleryLayout.currCardIndex=t;var h=document.querySelector("myth-page");h?h.replaceWith(e):this._footer.parentNode.insertBefore(e,this._footer),l!==t&&this.forceSortStack(l,t),this.onMouseClick(!1,!1,this._gridMode)}else if(this._pageopen&&this._pageOpenCardIndex!==t)this._onClosePage(s),"#grid"!==i||this._gridMode||window.location.reload();else if("#grid"===i)this._gridMode||(this._gridMode=!0,this.toggleGridStackModeChanged(o),this.layoutToggleSwitch.setMode("grid",o));else if(this._gridMode&&null===i)this._gridMode=!1,this.toggleGridStackModeChanged(o),this.layoutToggleSwitch.setMode("stack",o);else if(this._gridMode||0!==(null==i?void 0:i.indexOf("#card-")))if(this._gridMode&&0===(null==i?void 0:i.indexOf("#card-"))){this._gridMode=!1;c=this._router.getCardIndexFromHash(i);this.forceSortStack(this._galleryLayout.currCardIndex,c,!0,!1,!0),this.toggleGridStackModeChanged(o),this.layoutToggleSwitch.setMode("stack",o)}else this._gridMode||null!==i||this.forceSortStack(this._galleryLayout.currCardIndex,0,!0,!0,!0);else{var c;if((c=this._router.getCardIndexFromHash(i))>=0)this._galleryLayout.nextIndexWrappedUnclamped(this._galleryLayout.currCardIndex+1)===c?this.onMouseClick(!0,!1):this.forceSortStack(this._galleryLayout.currCardIndex,c,!0,!0,!0)}},this.getCurrentCard=()=>this._galleryScene.cards[this._galleryLayout.currCardIndex],this.canvasWidth=0,this.canvasHeight=0,this._onResize=()=>{var t,e=this.canvasWrapper.clientWidth,i=this.canvasWrapper.clientHeight;if(this.canvasWidth!==e||this.canvasHeight!==i){this.canvasWidth=e,this.canvasHeight=i;var n=window.innerWidth;this._galleryScene.onResize(e,i),this._galleryLayout.resize(e,i,this._galleryScene.camera,n),null===(t=this._currGridTimeline)||void 0===t||t.progress(this._gridMode?1:0,!1).pause(),this._gridMode&&(this._galleryScene.camera.zoom=this._galleryLayout.gridSettings._cameraZoom*this._galleryLayout.gridSettings._cameraZoomFactor,this._galleryLayout.layoutGrid(this._galleryScene.cards),this.setScrollHeightOfGridMode(),this.layoutToggleSwitch.completeTransition()),this._dragManager.onResize(),this.viewOffsetY=i-window.innerHeight,this.updateViewOffset(),this._galleryScene.camera.updateProjectionMatrix()}},this.updateViewOffset=()=>{this._galleryScene.camera.setViewOffset(this.canvasWidth,this.canvasHeight,0,.75*this.viewOffsetY*this.viewOffsetInfluence,this.canvasWidth,this.canvasHeight)},this.dragNextCardTriggered=()=>{this._router.router.route(this.nextCardHashLink)},this.dragOpenPageCallback=()=>{this._router.gotoCardIndex(this._galleryLayout.currCardIndex)},this.setScrollHeightOfGridMode=()=>{var t=Math.ceil(this._galleryLayout.scrollHeightThreeUnits*this._galleryLayout.threeUnitPixelHeightAtGridPosition+this.canvasHeight);this.scrollSpacer.style.height=t+"px",this._scrollHeight=t+this._footer.clientHeight-this.canvasHeight},this._onScroll=()=>{if(!this._gridMode||this._pageopen||this._scrollHeight<=0)return;this._pageOpenGridSavedScrollPosition=window.scrollY;const t=this._pageOpenGridSavedScrollPosition/this._scrollHeight;this._galleryScene.cardsWrapper.position.y=t*this._galleryLayout.scrollHeightThreeUnits},this._onClosePage=(t=!1)=>{if(this._pageopen){this._pageOpenCardIndex=-1,this._pageopen=!1;var e=zm(),i=this._gridMode?this._galleryScene.cardsWrapper.position.z:0,n=this._cardOpenZPosition+i,r=this._galleryLayout.getCardDomMatchedPageTransforms(this._currentPage,n,this._galleryScene.camera,this._gridMode);document.body.classList.add("page-transitioning-out"),document.documentElement.classList.remove("scroll-enabled"),this.style.pointerEvents="none",this._transitionScrollTo=qn.to(window,{scrollTo:{y:0,autoKill:!1},duration:0===e||t?0:.5,immediateRender:t,ease:"power2.inOut",onComplete:()=>{this._transitionScrollTo=null,this.dispatchEvent(new CustomEvent("fix-footer-for-transition")),document.body.classList.remove("page-transitioned-in"),this._galleryScene.cardsWrapper.visible=!0,this._galleryScene.resumeAnimation();const e=this._galleryScene.cards[this._gridMode?this._galleryLayout.currCardIndex:this._galleryLayout.nextIndexWrappedUnclamped(this._galleryLayout.currCardIndex)];e.scale.set(r.scaleTo,r.scaleTo,r.scaleTo),e.position.y=r.yOffset-this._galleryScene.cardsWrapper.position.y,e.cardMesh.morphTargetInfluences[0]=1-r.morphTargetTo;const i=qn.timeline({onComplete:()=>{var t;document.body.classList.remove("page-transitioning-out"),document.body.classList.remove("page-open"),this.dispatchEvent(new CustomEvent("unfix-footer-for-transition")),this.style.pointerEvents="",window.scrollTo(0,this._pageOpenGridSavedScrollPosition),this._clickedCard=!1,this._cardTransitioning=!1,null===(t=document.querySelector("myth-page"))||void 0===t||t.remove(),this._gridMode&&(this._galleryScene.gridInteractive=!0),this._currPageTransitionTimeline=null,this.inert=!1}});qn.set(this.hoverIndicatorsLeft[0],{scaleX:"0%",scaleY:"115%",force3D:!0}),qn.set(this.hoverIndicatorsLeft[1],{scaleX:"0%",scaleY:"115%",force3D:!0}),i.to(this.hoverIndicatorsRight[0],{duration:.7,scaleX:"0%",scaleY:"115%",ease:"power3.out",force3D:!0},0),i.to(this.hoverIndicatorsRight[1],{duration:.7,scaleX:"0%",scaleY:"115%",ease:"power3.out",force3D:!0},0);var n=this._gridMode?this._galleryLayout.getGridPositions():this._galleryLayout.getStackPositions();this._gridMode?this._galleryScene.cards.forEach(((t,e)=>{e!==this._galleryLayout.currCardIndex&&i.to(t.position,{duration:.7,z:0,x:n[e].x,y:n[e].y,ease:"sine.inOut"},.5)})):this._galleryScene.cards.forEach(((t,e)=>{e!==this._galleryLayout.currCardIndex&&(i.to(t.rotation,{duration:.7,z:n[e].rotation.z,ease:"sine.inOut"},.5),i.to(t.position,{duration:.7,z:n[e].position.z,ease:"sine.inOut"},.5))})),i.to(this._galleryScene.shadowCatcher.position,{z:this._gridMode?-3.1:-.26,ease:"sine.inOut",duration:.7},.5),i.to(this._galleryScene.shadowCatcher.material,{opacity:.15,ease:"linear.inOut",duration:.7},.5),i.to(e.cardMesh.material,{duration:.2,emissiveIntensity:0,ease:"linear.inout"},.3),i.to(e.cardMesh.material.emissive,{duration:.2,r:1,g:1,b:1,ease:"linear.inout"},.3),i.to(e.cardMesh.morphTargetInfluences,{0:0,duration:.4,ease:"sine.inOut"},0);var s=n[this._galleryLayout.currCardIndex];i.to(e.position,{duration:1.5,z:0,x:this._gridMode?s.x:s.position.x,y:this._gridMode?s.y:s.position.y,ease:"power4.out"},0),i.to(e.rotation,{duration:1,z:0,y:0,ease:"power2.inOut"},0),i.to(e.scale,{duration:1,x:1,y:1,z:1,ease:"power4.out"},0),!0===t?(this._currPageTransitionTimeline=null,i.progress(1,!1).pause(),i.kill()):this._currPageTransitionTimeline=i}})}},this.transitionToOpenPage=(t,e=!1)=>{this._pageopen=!0,this._pageOpenCardIndex=this._galleryLayout.currCardIndex,this.dispatchEvent(new CustomEvent("fix-footer-for-transition")),document.body.classList.add("page-open"),this.inert=!0,this._currentPage=document.body.querySelector("myth-page");var i=e?this._galleryScene.cardsWrapper.position.z:0,n=this._cardOpenZPosition+i,r=this._galleryLayout.getCardDomMatchedPageTransforms(this._currentPage,n,this._galleryScene.camera,e);qn.set(window,{scrollTo:0});const s=qn.timeline();s.to(this.hoverIndicatorsRight[0],{duration:.7,scaleX:"150%",scaleY:"150%",ease:"power2.out",force3D:!0},0),s.to(this.hoverIndicatorsRight[1],{duration:.75,scaleX:"150%",scaleY:"150%",ease:"power1.out",force3D:!0},0),this._galleryScene.cards.forEach(((t,i)=>{i!==this._galleryLayout.currCardIndex&&(e?(s.to(t.rotation,{duration:.5,z:0,ease:"sine.inOut"},.15),s.to(t.position,{duration:.5,y:"-="+this._galleryScene.cardsWrapper.position.y,z:"-=3",ease:"power3.inOut"},.15)):(s.to(t.rotation,{duration:.5,z:0,ease:"sine.inOut"},.2),s.to(t.position,{duration:.5,z:"-=2",ease:"sine.inOut"},.2)))})),s.to(t.cardMesh.material,{duration:.5,emissiveIntensity:30,ease:"linear.inout"},.4),s.to(t.cardMesh.material.emissive,{duration:.5,r:.06847816983662762,g:.06847816983662762,b:.06847816983662762,ease:"linear.inout"},.4),s.to(t.cardMesh.morphTargetInfluences,{0:1-r.morphTargetTo,duration:.4,ease:"sine.inOut"},.3),s.to(t.position,{duration:1,y:r.yOffset-this._galleryScene.cardsWrapper.position.y,ease:"power1.inOut"},0),s.to(this._galleryScene.shadowCatcher.position,{z:-6.1,ease:"sine.inOut",duration:.7},0),s.to(this._galleryScene.shadowCatcher.material,{opacity:0,ease:"linear.inOut",duration:.7},0),s.to(t.position,{duration:.5,x:4,z:.5*this._cardOpenZPosition,ease:"power1.in"},0),s.to(t.position,{duration:.5,x:0,z:this._cardOpenZPosition,ease:"power1.out"},.5),s.to(t.rotation,{duration:.5,z:0,y:.5*Math.PI,ease:"power1.in"},0),s.to(t.rotation,{duration:.5,y:Math.PI,ease:"power1.out"},.5),s.to(t.scale,{duration:1,x:r.scaleTo,y:r.scaleTo,z:r.scaleTo,ease:Vm},0),s.eventCallback("onComplete",(()=>{this.dispatchEvent(new CustomEvent("unfix-footer-for-transition")),document.body.classList.add("page-transitioned-in"),document.documentElement.classList.add("scroll-enabled"),this._currentPage.animateIn(),this._currPageTransitionTimeline=null,this._cardTransitioning=!1,this._transitionDelayedCall=qn.delayedCall(.5,(()=>{this._transitionDelayedCall=null,this._galleryScene.cardsWrapper.visible=!1,this._galleryScene.pauseAnimationWithRender()}))})),this._currPageTransitionTimeline=s},this.onMouseClick=(t=!1,e=!1,i=!1)=>{if(!this._cardStackInteractionsDisabled&&!this._cardTransitioning||i)if(this._clickedCard=!this._clickedCard,this.style.pointerEvents="none",this._cardTransitioning=!0,i||this._dragManager.killDragTimelineAndOngoingTweens(),t)this.animateToNextCardInStack(i,e);else{const t=this._galleryScene.cards[this._galleryLayout.currCardIndex];this.transitionToOpenPage(t,i)}},this.forceSortStack=(t,e,i=!1,n=!1,r=!1)=>{if(!this._gridMode){r&&this._dragManager.killDragTimelineAndOngoingTweens();var s=this._galleryLayout.getStackPositions(i?e:this._galleryLayout.currCardIndex);this._galleryScene.cards.forEach(((t,e)=>{t.rotation.setFromVector3(s[e].rotation),t.position.copy(s[e].position),t.scale.set(1,1,1)}));const n=this._galleryLayout.nextIndexWrappedUnclamped(e+1);this._galleryLayout.setBackgroundColor(e,!0,this._gridMode),this._galleryLayout.currCardIndex=e,this.currentCardLink=this._router.base+this._router.cardRoutes[e],this.setNextCardHashLink(n),this.currentCardTitle=this._cardTitles[e],this.nextCardButtonDidAnimateOut(t,this._gridMode,!1,n),r&&(this._dragManager.reEnableCardStackInteractions(),this.style.pointerEvents="",this._cardTransitioning=!1)}},this.nextCardButtonDidAnimateOut=(t,e,i=!1,n=null)=>{var r=null!==n?n:this._galleryLayout.nextIndexWrappedUnclamped(t+2);this._galleryLayout.setBackgroundColor(r,!1,this._gridMode),this._assetLoader.useVideos&&!e&&(this._assetLoader.videoPlayers[t].pause(),this._assetLoader.videoPlayers[r].play()),qn.set(this.hoverIndicatorsLeft[0],{scaleX:"0%",scaleY:"115%",force3D:!0}),qn.set(this.hoverIndicatorsLeft[1],{scaleX:"0%",scaleY:"115%",force3D:!0})},this.reEnableCardStackInteractions=t=>{var e=this._galleryLayout.maxVisibleCardsInStack-1;qn.killTweensOf([t.position,t.rotation,t.scale]),t.position.set(0,0,.1*-e),t.rotation.set(0,0,-e*this._galleryLayout.cardAngle),t.scale.set(1,1,1),this._dragManager.killDragTimeline(),this._dragManager.reEnableCardStackInteractions(),this.style.pointerEvents="",this._currPageTransitionTimeline=null,this._cardTransitioning=!1},this.animateToNextCardInStack=(t,e)=>{const i=this._galleryLayout.nextIndexWrappedUnclamped(this._galleryLayout.currCardIndex),n=this._galleryLayout.nextIndexWrappedUnclamped(i+1),r=this._galleryLayout.nextIndexWrappedUnclamped(i+2),s=this._galleryScene.cards[i],a=this._galleryScene.cards[n],o=this._galleryScene.cards[r];this._clickedCard=!1;const l=qn.timeline({onComplete:()=>this.reEnableCardStackInteractions(s)});this._galleryScene.cards.forEach(((t,e)=>{var n=e;n!==i&&(l.to(this._galleryScene.cards[n].position,{duration:.5,z:"-=1",ease:"back.in"},0),t===a?l.to(a.position,{duration:.5,z:0,ease:"back.out"},.5):t===o?l.to(o.position,{duration:.5,z:-.1,ease:"back.out"},.5):l.to(this._galleryScene.cards[n].position,{duration:.5,z:"+=1",ease:"back.out"},.5))})),l.to(this._galleryScene.shadowCatcher.position,{z:"-=1",ease:"back.in)",duration:.5},0),l.to(this._galleryScene.directionalLight.position,{x:0,ease:"power1.out",duration:1},0),l.to(this._galleryScene.shadowCatcher.position,{z:this._galleryScene.shadowCatcher.position.z,ease:"back.out)",duration:.5},.5),l.to(a.rotation,{duration:.25,z:0,ease:"power2.out"},.5),l.to(o.rotation,{duration:.25,z:-this._galleryLayout.cardAngle,ease:"power2.out"},.5),l.to(s.position,{duration:1,z:3,x:-18,ease:"power1.out"},0),l.to(s.rotation,{duration:1,y:-.6*Math.PI,ease:"power2.out"},0),this._galleryLayout.setBackgroundColor(n,!0,this._gridMode),l.to(this.hoverIndicatorsLeft[0],{duration:.75,scaleX:"150%",scaleY:"150%",ease:"power4.out",force3D:!0},0),l.to(this.hoverIndicatorsLeft[1],{duration:.75,scaleX:"150%",scaleY:"150%",ease:"power4.out",force3D:!0,onComplete:()=>this.nextCardButtonDidAnimateOut(i,t)},0),this._galleryLayout.currCardIndex=n,this.currentCardLink=this._router.base+this._router.cardRoutes[this._galleryLayout.currCardIndex],this.setNextCardHashLink(r),this.currentCardTitle=this._cardTitles[this._galleryLayout.currCardIndex],this._currPageTransitionTimeline=l},this.canInteract=()=>!(this._clickedCard||this._cardStackInteractionsDisabled||this._dragManager.isInteracting()||this._cardTransitioning),this.killCurrentGridTimeline=(t=!1,e=!1)=>{var i;if(null===(i=this._currGridTimelineProgressTween)||void 0===i||i.progress(1,!1).pause().kill(),this._currGridTimelineProgressTween=null,qn.killTweensOf(this._galleryScene.cardsWrapper.position,"y"),this._currGridTimeline){qn.killTweensOf(this._currGridTimeline);var n=t&&!this._gridMode?0:1;this._currGridTimeline.progress(n,!1).pause(),e&&(this._currGridTimeline.kill(),this._currGridTimeline=null)}},this.getToGridTimeline=()=>{this.killCurrentGridTimeline(!1,!0);const t=qn.timeline({paused:!0});var e=this._galleryLayout.getGridPositions(),i=this._galleryLayout.getStackPositions();let n=0;for(let r=this._galleryLayout.currCardIndex;r<this._galleryLayout.currCardIndex+this._galleryScene.cards.length;r++){let s=this._galleryLayout.nextIndexWrappedUnclamped(r);const a=this._galleryScene.cards[s];qn.killTweensOf([a.position,a.rotation,a.scale,a]),this._assetLoader.useVideos&&this._assetLoader.switchingToGrid();let o=e[s],l=i[s];t.fromTo(this._galleryScene.shadowCatcher.position,{z:-.26},{z:-3.1,ease:"back.inOut(3)",duration:2},0),t.fromTo(this._galleryScene.ambientLight,{intensity:.4},{intensity:.6,ease:"sine.inOut",duration:.25},1.85),t.fromTo(this._galleryScene.spotLight,{intensity:.318},{intensity:0,ease:"sine.inOut",duration:.25},1.85),t.fromTo(a.rotation,{y:l.rotation.y,z:l.rotation.z},{duration:1.5,y:0,z:0,ease:"power2.out"},0),t.fromTo(a.position,{x:l.position.x,y:l.position.y,z:l.position.z},{duration:.5,x:0,y:0,z:-.2*n,ease:"power4.out"},.25),t.fromTo(a.position,{x:l.position.x,y:l.position.y,z:-.2*n},{duration:1,immediateRender:!1,x:o.x,y:o.y,z:0,ease:"power2.inOut"},1.1),n++}return t.fromTo(this._galleryScene.cardsWrapper.position,{z:0},{duration:2,z:-3,ease:"back.inOut(3)"},0),t.fromTo(this,{viewOffsetInfluence:1},{duration:2,viewOffsetInfluence:0,onUpdate:this.updateViewOffset,ease:"sine.inOut"},0),t.fromTo(this._galleryScene.camera,{zoom:this._galleryLayout.gridSettings._cameraZoom},{duration:2,zoom:this._galleryLayout.gridSettings._cameraZoom*this._galleryLayout.gridSettings._cameraZoomFactor,onUpdate:()=>this._galleryScene.camera.updateProjectionMatrix(),ease:"sine.inOut"},0),t.eventCallback("onComplete",(()=>{this.setScrollHeightOfGridMode(),document.documentElement.classList.add("scroll-enabled-grid"),this.layoutToggleSwitch.resetAnimationCircles(),this.setGridInteractive(!0)})),t},this.toggleGridStackModeChanged=(t=!1)=>{var e;if(this._dragManager.killDragTimelineAndOngoingTweens(!0),this._gridMode)this._galleryLayout.stackIndexBeforeGridMode=this._galleryLayout.currCardIndex,this._cardStackInteractionsDisabled=!0,this._dragManager.disable(),document.documentElement.classList.add("grid-mode"),this._currGridTimeline=this.getToGridTimeline(),t?this._currGridTimeline.progress(1,!1).pause():this._currGridTimelineProgressTween=qn.to(this._currGridTimeline,{progress:1,duration:this._currGridTimeline.duration(),ease:"power2.out"});else{this._galleryLayout.currCardIndex=this._galleryLayout.stackIndexBeforeGridMode,this.dispatchEvent(new CustomEvent("fix-footer-for-transition")),document.documentElement.classList.add("grid-transitioning-out"),this.scrollSpacer.style.height="",document.documentElement.classList.remove("scroll-enabled-grid"),this.setGridInteractive(!1);let i=1.3;(1!==(null===(e=this._currGridTimeline)||void 0===e?void 0:e.progress())||t)&&(i=0),this._currGridTimeline=this.getToGridTimeline(),this._currGridTimeline.progress(1,!0).pause(),this._galleryScene.camera.zoom=this._galleryLayout.gridSettings._cameraZoom*this._galleryLayout.gridSettings._cameraZoomFactor,this.viewOffsetInfluence=0,this.updateViewOffset(),this._galleryScene.camera.updateProjectionMatrix(),this._currGridTimelineProgressTween=qn.timeline(),this._currGridTimelineProgressTween.to(this._galleryScene.cardsWrapper.position,{duration:i,y:0,ease:"elastic.out(1.1, 1)"},0),this._currGridTimelineProgressTween.to(this._currGridTimeline,{progress:0,duration:i,ease:"power1.inOut",onComplete:()=>{this._assetLoader.useVideos&&(this._assetLoader.videoPlayers[this._galleryLayout.currCardIndex].play(),this._assetLoader.videoPlayers[this._galleryLayout.nextIndexWrapped(this._galleryLayout.currCardIndex+1)].play()),this._dragManager.enable(),document.documentElement.classList.remove("grid-transitioning-out"),document.documentElement.classList.remove("grid-mode"),this.dispatchEvent(new CustomEvent("unfix-footer-for-transition")),this._cardStackInteractionsDisabled=!1,this._currGridTimeline=null}},0)}},this.setGridInteractive=t=>{this._galleryScene.gridInteractive=t,this.gridHoverArea.style.pointerEvents=t?"auto":"none",t?(this.gridHoverArea.addEventListener("pointermove",this._galleryScene.onPointerMove),this.gridHoverArea.addEventListener("pointerenter",this.gridAreaHover),this.gridHoverArea.addEventListener("pointerleave",this.gridAreaLeave),this.gridHoverArea.addEventListener("click",this.gridAreaClicked)):(this.gridHoverArea.removeEventListener("pointermove",this._galleryScene.onPointerMove),this.gridHoverArea.removeEventListener("pointerenter",this.gridAreaHover),this.gridHoverArea.removeEventListener("pointerleave",this.gridAreaLeave),this.gridHoverArea.removeEventListener("click",this.gridAreaClicked),this._galleryScene.setHoveredCardIndex(-1))},this.gridAreaHover=t=>{this._galleryScene.onPointerMove(t),this._galleryScene.setGridAreaHovered(!0)},this.gridAreaLeave=t=>{this._galleryScene.onPointerMove(t),this._galleryScene.setGridAreaHovered(!1)},this.gridAreaClicked=t=>{if(this._galleryScene.gridInteractive){var e=this._galleryScene.getCardIndexFromPointer(t);-1!==e&&(this._galleryScene.gridInteractive=!1,this._galleryLayout.currCardIndex=e,this._galleryScene.setHoveredCardIndex(-1),this._router.gotoCardIndex(this._galleryLayout.currCardIndex))}},this.currentCardLink=this._router.base+this._router.cardRoutes[0],this.setNextCardHashLink(1),this.currentCardTitle=this._cardTitles[0],qn.defaults({overwrite:"auto"}),this._galleryScene=new jf(this._assetLoader,this._galleryLayout,this._cardTexturePaths,this._cardVideoPaths,window.innerWidth,window.innerHeight,this),this._router.onRouteChangeCallback=this.onPageLoaded}connectedCallback(){super.connectedCallback()}disconnectedCallback(){window.removeEventListener("scroll",this._onScroll),super.disconnectedCallback()}firstUpdated(t){super.firstUpdated(t),this.canvasElement=this.querySelector("canvas"),this.wrapper=this.querySelector(".myths__cards_gallery"),this.gridHoverArea=this.querySelector(".myths__cards_gallery__gridHoverArea"),this.scrollSpacer=this.querySelector(".myths__cards_gallery__scrollSpacer"),this.canvasWrapper=this.querySelector(".myths__cards_gallery__canvasWrapper"),window.addEventListener("resize",this._onResize),this.layoutToggleSwitch=this.querySelector("myth-layout-toggle"),this.layoutToggleSwitch.setGalleryRouterAndLayout(this._router,this._galleryLayout),this._footer=document.documentElement.querySelector("myth-footer"),this.hoverIndicatorsLeft=Array.from(this.querySelectorAll(".myths__cards_gallery__hoverIndicator__leftBG")),this.hoverIndicatorsRight=Array.from(this.querySelectorAll(".myths__cards_gallery__hoverIndicator__rightBG")).reverse(),qn.set(this.hoverIndicatorsLeft,{scaleY:"115%",scaleX:"0%"}),qn.set(this.hoverIndicatorsRight,{scaleY:"115%",scaleX:"0%"}),this._dragManager.setupDraggable(this.querySelector(".myths__cards_gallery__dragProxy"),this.wrapper,this.hoverIndicatorsLeft,this.hoverIndicatorsRight,this.dragNextCardTriggered,this.dragOpenPageCallback),this._onResize(),setTimeout((()=>{window.addEventListener("scroll",this._onScroll,{passive:!0}),this._router.siteReady()}),1)}render(){return Lr` <div class="myths__cards_gallery__scrollSpacer"></div>
            <div class="myths__cards_gallery">
                <div class="myths__cards_gallery__dragProxy"></div>
                <div class="myths__cards_gallery__hoverIndicator">
                    <div class="myths__cards_gallery__hoverIndicator__left">
                        <div class="myths__cards_gallery__hoverIndicator__leftBG"></div>
                        <div class="myths__cards_gallery__hoverIndicator__rightBG"></div>
                    </div>
                    <div class="myths__cards_gallery__hoverIndicator__right">
                        <div class="myths__cards_gallery__hoverIndicator__leftBG"></div>
                        <div class="myths__cards_gallery__hoverIndicator__rightBG"></div>
                    </div>
                </div>
                <a href="${this.nextCardHashLink}" aria-label="Navigate to next card" class="myths__cards_gallery__button myths__cards_gallery__prev" @mouseenter="${()=>this._dragManager.onMouseEnter(!0)}" @mouseleave="${()=>this._dragManager.onMouseLeave(!0)}">
                    <span>Next Card</span>
                </a>
                <a href="${this.currentCardLink}" aria-label="Show me the web can: ${this.currentCardTitle}" alt="Show me the web can: ${this.currentCardTitle}" class="myths__cards_gallery__button myths__cards_gallery__debunk" @mouseenter="${()=>this._dragManager.onMouseEnter()}" @mouseleave="${()=>this._dragManager.onMouseLeave()}"><span>Show me!</span></a>
                <a href="${this.currentCardLink}" aria-label="Show me the web can: ${this.currentCardTitle}" alt="Show me the web can: ${this.currentCardTitle}" class="myths__cards_gallery__button myths__cards_gallery__openCard" @mouseenter="${()=>this._dragManager.onMouseEnterCard()}" @mouseleave="${()=>this._dragManager.onMouseLeaveCard()}"></a>
                <div class="myths__cards_gallery__gridHoverArea"></div>
                <myth-layout-toggle></myth-layout-toggle>
                <div class="myths__cards_gallery__canvasWrapper">${this._galleryScene.renderer.domElement}</div>
            </div>`}}Bm([Xr({type:String})],Hm.prototype,"currentCardLink",void 0),Bm([Xr({type:String})],Hm.prototype,"nextCardHashLink",void 0),Bm([Xr({type:String})],Hm.prototype,"currentCardTitle",void 0),customElements.define("myth-cards-gallery",Hm);var Gm=function(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};class Wm extends $r{constructor(){super(),this.didClick=!1,this.resetDidClick=()=>{this.didClick=!1},this.onClick=t=>{this.dialogMode&&!this.didClick&&(t.preventDefault(),this.didClick=!0,history.length>2?history.back():history.pushState(null,"","/"))},this.gridMode=document.querySelector("myth-cards-gallery").GridModeActive()}render(){return this.dialogMode?Lr`<button class="close-myth" aria-label="Close" @click="${this.onClick}">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z" />
                </svg>
            </button>`:Lr`<a class="close-myth" aria-label="Close" @click="${this.onClick}" href="/${this.closeLink&&!this.gridMode?this.closeLink:this.gridMode&&!this.dialogMode?"#grid":""}">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z" />
                </svg>
            </a>`}}Gm([Xr({type:Boolean})],Wm.prototype,"dialogMode",void 0),Gm([Xr({type:String})],Wm.prototype,"closeLink",void 0),customElements.define("close-button",Wm);customElements.define("myth-top-nav",class extends $r{render(){return Lr`<nav class="nav">
            <a class="nav__item about-link" role="button" href="#about"> About </a>
            <a class="nav__item share-link" role="button" href="#share"> Share </a>
        </nav>`}});customElements.define("myth-footer",class extends $r{constructor(){super(...arguments),this.fixPositionForAnimation=()=>{var t=this.offsetTop-window.scrollY;this.style.position="fixed",this.style.top=t+"px"},this.unfixPositionForAnimation=()=>{this.style.position="",this.style.top=""}}connectedCallback(){super.connectedCallback();const t=document.documentElement.querySelector("myth-cards-gallery");t.addEventListener("fix-footer-for-transition",this.fixPositionForAnimation),t.addEventListener("unfix-footer-for-transition",this.unfixPositionForAnimation)}shareClick(t){document.querySelector("myth-share").open()}aboutClick(t){document.querySelector("myth-about").open()}render(){return Lr` <nav class="nav">
            <a class="nav__item about-link" role="button" href="#about" @click="${this.aboutClick}"> About </a>
            <a class="nav__item credit-link" href="https://developer.chrome.com/" aria-label="Visit Chrome for Developers website" alt="Chrome for Developers">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 168.67">
                    <defs>
                        <clipPath id="clippath">
                            <circle cx="98.6" cy="84.33" r="62.27" style="stroke-width:0;fill:none" />
                        </clipPath>
                        <style>
                            .cls-2 {
                                stroke-width: 0;
                                fill: #fff;
                            }
                        </style>
                    </defs>
                    <path
                        d="M217.79 106.23c-4.12-2.38-7.36-5.64-9.72-9.79-2.35-4.15-3.53-8.77-3.53-13.86s1.18-9.72 3.53-13.86c2.35-4.15 5.59-7.41 9.72-9.79 4.12-2.38 8.71-3.57 13.76-3.57 3.88 0 7.43.74 10.66 2.22 3.23 1.48 6.03 3.58 8.41 6.3l-4.44 4.29c-1.99-2.38-4.16-4.12-6.51-5.24-2.35-1.12-5.06-1.67-8.11-1.67-3.78 0-7.25.89-10.41 2.66-3.15 1.77-5.67 4.27-7.53 7.5-1.87 3.23-2.8 6.95-2.8 11.17s.93 7.95 2.8 11.17c1.87 3.23 4.38 5.73 7.53 7.5 3.15 1.77 6.62 2.66 10.41 2.66 6.31 0 11.67-2.6 16.08-7.79l4.51 4.37c-2.43 2.86-5.41 5.13-8.95 6.8-3.54 1.67-7.42 2.51-11.64 2.51-5.05 0-9.63-1.19-13.76-3.57ZM259.06 56.53h6.19v15.36l-.29 5.09h.29c1.02-1.89 2.63-3.47 4.84-4.73 2.21-1.26 4.62-1.89 7.24-1.89 4.51 0 7.96 1.32 10.33 3.97 2.38 2.64 3.57 6.15 3.57 10.52v23.8h-6.19V85.8c0-3.35-.85-5.82-2.55-7.42-1.7-1.6-3.91-2.4-6.62-2.4-1.94 0-3.72.58-5.35 1.75-1.63 1.16-2.91 2.67-3.86 4.51-.95 1.84-1.42 3.76-1.42 5.75v20.67h-6.19V56.55ZM300.1 71.52h5.89v5.97h.29c.73-2.04 2.13-3.72 4.22-5.06 2.09-1.33 4.27-2 6.55-2 1.7 0 3.15.24 4.37.73v6.7c-1.55-.78-3.3-1.16-5.24-1.16-1.8 0-3.44.51-4.95 1.53-1.5 1.02-2.71 2.39-3.6 4.11-.9 1.72-1.35 3.58-1.35 5.57v20.74h-6.19V71.53ZM332.49 107.18c-2.91-1.75-5.18-4.12-6.8-7.13-1.63-3.01-2.44-6.33-2.44-9.97s.81-6.96 2.44-9.97c1.62-3.01 3.89-5.39 6.8-7.13 2.91-1.75 6.19-2.62 9.83-2.62s6.91.87 9.82 2.62 5.18 4.12 6.81 7.13c1.62 3.01 2.44 6.33 2.44 9.97s-.81 6.96-2.44 9.97c-1.63 3.01-3.89 5.39-6.81 7.13-2.91 1.75-6.19 2.62-9.82 2.62s-6.91-.87-9.83-2.62Zm16.19-4.69c1.96-1.14 3.54-2.78 4.73-4.91 1.19-2.13 1.78-4.63 1.78-7.5s-.59-5.36-1.78-7.5c-1.19-2.13-2.77-3.77-4.73-4.91-1.97-1.14-4.09-1.71-6.37-1.71s-4.42.57-6.4 1.71c-1.99 1.14-3.58 2.78-4.77 4.91-1.19 2.14-1.78 4.63-1.78 7.5s.59 5.36 1.78 7.5c1.19 2.14 2.78 3.77 4.77 4.91 1.99 1.14 4.12 1.71 6.4 1.71s4.4-.57 6.37-1.71ZM367.86 71.52h5.89v5.46h.29c1.07-1.89 2.67-3.47 4.8-4.73 2.13-1.26 4.39-1.89 6.77-1.89 2.72 0 5.08.65 7.1 1.96 2.01 1.31 3.46 3.06 4.33 5.24 1.31-2.18 3.04-3.93 5.2-5.24s4.67-1.96 7.53-1.96c4.27 0 7.48 1.3 9.64 3.89 2.16 2.6 3.24 6.13 3.24 10.59v23.8h-6.11V85.79c0-3.44-.7-5.94-2.11-7.5-1.41-1.55-3.49-2.33-6.26-2.33-1.84 0-3.52.53-5.02 1.6-1.5 1.07-2.68 2.5-3.53 4.29-.85 1.8-1.27 3.74-1.27 5.82v20.96h-6.19V85.85c0-3.49-.7-6.02-2.11-7.57-1.41-1.55-3.47-2.33-6.19-2.33-1.84 0-3.52.55-5.02 1.64-1.5 1.09-2.68 2.55-3.53 4.37-.85 1.82-1.27 3.77-1.27 5.86v20.81h-6.19V71.51ZM438.52 107.25c-2.81-1.7-5.01-4.04-6.59-7.02-1.58-2.98-2.37-6.34-2.37-10.08s.74-6.89 2.22-9.9c1.48-3.01 3.58-5.41 6.29-7.21 2.72-1.79 5.87-2.69 9.46-2.69s6.79.81 9.46 2.44c2.67 1.63 4.72 3.87 6.15 6.73 1.43 2.86 2.15 6.14 2.15 9.83 0 .73-.07 1.36-.22 1.89h-29.33c.15 2.81.82 5.19 2.04 7.13 1.21 1.94 2.75 3.4 4.62 4.37 1.87.97 3.82 1.46 5.86 1.46 4.75 0 8.42-2.23 10.99-6.7l5.24 2.55c-1.6 3.01-3.77 5.39-6.51 7.13-2.74 1.75-6.05 2.62-9.93 2.62-3.54 0-6.72-.85-9.53-2.55Zm20.23-21.1c-.1-1.55-.53-3.1-1.31-4.66-.78-1.55-2-2.86-3.68-3.93-1.67-1.07-3.77-1.6-6.29-1.6-2.91 0-5.37.94-7.39 2.8-2.01 1.87-3.34 4.33-3.97 7.39h22.63ZM492.23 77.12h-6.84v-5.6h6.84v-4c0-2.33.53-4.37 1.6-6.11 1.07-1.75 2.5-3.09 4.29-4.04 1.79-.95 3.78-1.42 5.97-1.42s3.9.29 5.46.87v6.04c-.87-.34-1.7-.62-2.47-.84-.78-.22-1.7-.33-2.77-.33-1.6 0-2.98.57-4.15 1.71-1.16 1.14-1.75 2.73-1.75 4.77v3.35h9.53v5.6h-9.53v31.51h-6.19V77.12ZM520.54 107.18c-2.91-1.75-5.18-4.12-6.8-7.13-1.63-3.01-2.44-6.33-2.44-9.97s.81-6.96 2.44-9.97c1.62-3.01 3.89-5.39 6.8-7.13 2.91-1.75 6.19-2.62 9.83-2.62s6.91.87 9.82 2.62 5.18 4.12 6.81 7.13c1.62 3.01 2.44 6.33 2.44 9.97s-.81 6.96-2.44 9.97c-1.63 3.01-3.89 5.39-6.81 7.13-2.91 1.75-6.19 2.62-9.82 2.62s-6.91-.87-9.83-2.62Zm16.19-4.69c1.96-1.14 3.54-2.78 4.73-4.91 1.19-2.13 1.78-4.63 1.78-7.5s-.59-5.36-1.78-7.5c-1.19-2.13-2.77-3.77-4.73-4.91-1.97-1.14-4.09-1.71-6.37-1.71s-4.42.57-6.4 1.71c-1.99 1.14-3.58 2.78-4.77 4.91-1.19 2.14-1.78 4.63-1.78 7.5s.59 5.36 1.78 7.5c1.19 2.14 2.78 3.77 4.77 4.91 1.99 1.14 4.12 1.71 6.4 1.71s4.4-.57 6.37-1.71ZM555.91 71.52h5.89v5.97h.29c.73-2.04 2.13-3.72 4.22-5.06 2.09-1.33 4.27-2 6.55-2 1.7 0 3.15.24 4.37.73v6.7c-1.55-.78-3.3-1.16-5.24-1.16-1.8 0-3.44.51-4.95 1.53-1.5 1.02-2.71 2.39-3.6 4.11-.9 1.72-1.35 3.58-1.35 5.57v20.74h-6.19V71.53ZM601.32 56.53h15.72c5.34 0 9.99 1.1 13.97 3.31 3.98 2.21 7.03 5.28 9.17 9.21 2.13 3.93 3.2 8.44 3.2 13.54s-1.07 9.61-3.2 13.54c-2.14 3.93-5.19 7-9.17 9.21-3.98 2.21-8.64 3.31-13.97 3.31h-15.72V56.54Zm15.72 46.21c6.16 0 11.05-1.77 14.66-5.31 3.61-3.54 5.42-8.49 5.42-14.85s-1.81-11.3-5.42-14.85c-3.62-3.54-8.5-5.31-14.66-5.31h-9.61v40.32h9.61ZM657.14 107.25c-2.81-1.7-5.01-4.04-6.59-7.02-1.58-2.98-2.37-6.34-2.37-10.08s.74-6.89 2.22-9.9c1.48-3.01 3.58-5.41 6.29-7.21 2.72-1.79 5.87-2.69 9.46-2.69s6.79.81 9.46 2.44c2.67 1.63 4.72 3.87 6.15 6.73 1.43 2.86 2.15 6.14 2.15 9.83 0 .73-.07 1.36-.22 1.89h-29.33c.15 2.81.82 5.19 2.04 7.13 1.21 1.94 2.75 3.4 4.62 4.37 1.87.97 3.82 1.46 5.86 1.46 4.75 0 8.42-2.23 10.99-6.7l5.24 2.55c-1.6 3.01-3.77 5.39-6.51 7.13-2.74 1.75-6.05 2.62-9.93 2.62-3.54 0-6.72-.85-9.53-2.55Zm20.23-21.1c-.1-1.55-.53-3.1-1.31-4.66-.78-1.55-2-2.86-3.68-3.93-1.67-1.07-3.77-1.6-6.29-1.6-2.91 0-5.37.94-7.39 2.8-2.01 1.87-3.34 4.33-3.97 7.39h22.63ZM686.32 71.52h6.62l11.5 29.84h.15l11.64-29.84h6.48l-15.14 37.12h-6.26l-14.99-37.12ZM733.7 107.25c-2.81-1.7-5.01-4.04-6.59-7.02-1.58-2.98-2.37-6.34-2.37-10.08s.74-6.89 2.22-9.9c1.48-3.01 3.58-5.41 6.29-7.21 2.72-1.79 5.87-2.69 9.46-2.69s6.79.81 9.46 2.44c2.67 1.63 4.72 3.87 6.15 6.73 1.43 2.86 2.15 6.14 2.15 9.83 0 .73-.07 1.36-.22 1.89h-29.33c.15 2.81.82 5.19 2.04 7.13 1.21 1.94 2.75 3.4 4.62 4.37 1.87.97 3.82 1.46 5.86 1.46 4.75 0 8.42-2.23 10.99-6.7l5.24 2.55c-1.6 3.01-3.77 5.39-6.51 7.13-2.74 1.75-6.05 2.62-9.93 2.62-3.54 0-6.72-.85-9.53-2.55Zm20.23-21.1c-.1-1.55-.53-3.1-1.31-4.66-.78-1.55-2-2.86-3.68-3.93-1.67-1.07-3.77-1.6-6.29-1.6-2.91 0-5.37.94-7.39 2.8-2.01 1.87-3.34 4.33-3.97 7.39h22.63ZM767.69 56.53h6.19v52.11h-6.19V56.53ZM789.95 107.18c-2.91-1.75-5.18-4.12-6.8-7.13-1.63-3.01-2.44-6.33-2.44-9.97s.81-6.96 2.44-9.97c1.62-3.01 3.89-5.39 6.8-7.13 2.91-1.75 6.19-2.62 9.83-2.62s6.91.87 9.82 2.62 5.18 4.12 6.81 7.13c1.62 3.01 2.44 6.33 2.44 9.97s-.81 6.96-2.44 9.97c-1.63 3.01-3.89 5.39-6.81 7.13-2.91 1.75-6.19 2.62-9.82 2.62s-6.91-.87-9.83-2.62Zm16.19-4.69c1.96-1.14 3.54-2.78 4.73-4.91 1.19-2.13 1.78-4.63 1.78-7.5s-.59-5.36-1.78-7.5c-1.19-2.13-2.77-3.77-4.73-4.91-1.97-1.14-4.09-1.71-6.37-1.71s-4.42.57-6.4 1.71c-1.99 1.14-3.58 2.78-4.77 4.91-1.19 2.14-1.78 4.63-1.78 7.5s.59 5.36 1.78 7.5c1.19 2.14 2.78 3.77 4.77 4.91 1.99 1.14 4.12 1.71 6.4 1.71s4.4-.57 6.37-1.71ZM825.4 71.52h5.89v5.53h.29c1.12-1.89 2.8-3.48 5.06-4.77 2.26-1.29 4.79-1.93 7.6-1.93 3.3 0 6.31.85 9.02 2.55 2.72 1.7 4.85 4.05 6.4 7.06 1.55 3.01 2.33 6.38 2.33 10.12s-.78 7.17-2.33 10.15c-1.55 2.98-3.69 5.33-6.4 7.02-2.72 1.7-5.73 2.55-9.02 2.55-2.81 0-5.35-.64-7.6-1.93s-3.94-2.85-5.06-4.69h-.29l.29 5.09v16.08h-6.19V71.51Zm24.16 30.93c1.89-1.16 3.41-2.83 4.55-4.99 1.14-2.16 1.71-4.62 1.71-7.39s-.57-5.23-1.71-7.39c-1.14-2.16-2.66-3.82-4.55-4.99-1.89-1.16-3.91-1.75-6.04-1.75s-4.15.58-6.04 1.75-3.4 2.81-4.51 4.95c-1.12 2.14-1.67 4.61-1.67 7.42s.56 5.29 1.67 7.42c1.12 2.14 2.62 3.78 4.51 4.95 1.89 1.16 3.9 1.75 6.04 1.75s4.15-.58 6.04-1.75ZM876.19 107.25c-2.81-1.7-5.01-4.04-6.59-7.02-1.58-2.98-2.37-6.34-2.37-10.08s.74-6.89 2.22-9.9c1.48-3.01 3.58-5.41 6.29-7.21 2.72-1.79 5.87-2.69 9.46-2.69s6.79.81 9.46 2.44c2.67 1.63 4.72 3.87 6.15 6.73 1.43 2.86 2.15 6.14 2.15 9.83 0 .73-.07 1.36-.22 1.89h-29.33c.15 2.81.82 5.19 2.04 7.13 1.21 1.94 2.75 3.4 4.62 4.37 1.87.97 3.82 1.46 5.86 1.46 4.75 0 8.42-2.23 10.99-6.7l5.24 2.55c-1.6 3.01-3.77 5.39-6.51 7.13-2.74 1.75-6.05 2.62-9.93 2.62-3.54 0-6.72-.85-9.53-2.55Zm20.23-21.1c-.1-1.55-.53-3.1-1.31-4.66-.78-1.55-2-2.86-3.68-3.93-1.67-1.07-3.77-1.6-6.29-1.6-2.91 0-5.37.94-7.39 2.8-2.01 1.87-3.34 4.33-3.97 7.39h22.63ZM910.18 71.52h5.89v5.97h.29c.73-2.04 2.13-3.72 4.22-5.06 2.09-1.33 4.27-2 6.55-2 1.7 0 3.15.24 4.37.73v6.7c-1.55-.78-3.3-1.16-5.24-1.16-1.8 0-3.44.51-4.95 1.53-1.5 1.02-2.71 2.39-3.6 4.11-.9 1.72-1.35 3.58-1.35 5.57v20.74h-6.19V71.53ZM939 107c-2.67-1.87-4.56-4.26-5.68-7.17l5.53-2.47c.92 2.23 2.29 3.96 4.11 5.17 1.82 1.21 3.82 1.82 6 1.82 2.33 0 4.32-.47 5.97-1.42 1.65-.95 2.47-2.29 2.47-4.04 0-1.55-.65-2.8-1.97-3.75-1.31-.95-3.37-1.76-6.19-2.44l-4.51-1.16c-2.96-.73-5.39-1.96-7.28-3.71-1.89-1.75-2.84-4-2.84-6.77 0-2.13.64-4.01 1.93-5.64 1.29-1.62 3-2.87 5.13-3.75 2.13-.87 4.44-1.31 6.91-1.31 3.25 0 6.15.7 8.7 2.11 2.55 1.41 4.35 3.37 5.42 5.89l-5.39 2.47c-1.65-3.3-4.59-4.95-8.81-4.95-2.04 0-3.82.47-5.35 1.42-1.53.95-2.29 2.15-2.29 3.6 0 1.36.53 2.46 1.6 3.31 1.07.85 2.67 1.54 4.8 2.07l5.39 1.38c3.64.92 6.38 2.29 8.22 4.11 1.84 1.82 2.77 4.04 2.77 6.66 0 2.28-.65 4.28-1.96 6-1.31 1.72-3.08 3.05-5.31 3.97-2.23.92-4.71 1.38-7.42 1.38-3.98 0-7.3-.94-9.97-2.8Z"
                        class="cls-2"
                    />
                    <g style="clip-path:url(#clippath)">
                        <circle cx="98.6" cy="84.33" r="22.64" class="cls-2" />
                        <path d="M115.59 61.69c6.87 5.16 11.32 13.38 11.32 22.64 0 5.15-1.38 9.98-3.79 14.14s0 .01 0 .01L95.34 146.6H160.89V61.69H115.6Z" class="cls-2" />
                        <path d="M74.09 98.49 46.22 50.21v.47l-9.89-16.96V146.6H88.8l20.92-36.24c-3.41 1.46-7.17 2.27-11.12 2.27-10.48 0-19.61-5.69-24.51-14.15Z" class="cls-2" />
                        <path d="M46.22 22.06v16.83l24.29 42.07c1.67-14.04 13.61-24.93 28.1-24.93h62.27V22.06H46.22Z" class="cls-2" />
                    </g>
                </svg>
            </a>
            <a class="nav__item share-link" role="button" href="#share" @click="${this.shareClick}"> Share </a>
            <a class="nav__item privacy-link" href="https://policies.google.com/privacy"> Privacy </a>
        </nav>`}});var Xm=i(98234),qm=i.n(Xm),Ym=function(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};let jm=class extends $r{constructor(){super(...arguments),this.loop=!1,this.autoplay=!1}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.animation&&this.animation.destroy(),this.animation=null}firstUpdated(t){super.firstUpdated(t),this.animation=qm().loadAnimation({container:this.querySelector(".myth-illustration"),renderer:"svg",loop:this.loop,autoplay:this.autoplay,path:this.illustration})}playAnimation(){this.animation&&this.animation.play()}stopAnimation(){this.animation&&this.animation.stop()}render(){return Lr`<div class="myth-illustration"></div>`}};Ym([Xr({type:String})],jm.prototype,"illustration",void 0),Ym([Xr({type:Boolean})],jm.prototype,"loop",void 0),Ym([Xr({type:Boolean})],jm.prototype,"autoplay",void 0),jm=Ym([Hr("myth-illustration")],jm);customElements.define("myth-hero",class extends $r{constructor(){super(...arguments),this.inTL=null}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this.inTL)||void 0===t||t.kill(),this.inTL=null}animateIn(){const t=this.querySelector("myth-illustration"),e=this.querySelector(".illustration-wrapper"),i=this.querySelector(".label"),n=this.querySelector(".headline"),r=this.querySelector(".page-text");this.inTL=qn.timeline(),this.inTL.fromTo(e,{opacity:0,rotationZ:45},{opacity:1,rotationZ:0,duration:.8,ease:"power3.out"},.6),this.inTL.add((()=>{t.playAnimation()}),1.2),this.inTL.fromTo([i,n],{opacity:0,y:40},{opacity:1,y:0,duration:1.2,stagger:.1,ease:"power3.out"},.2),this.inTL.fromTo(r,{opacity:0,y:100},{opacity:1,y:0,duration:1.2,ease:"power3.out"},.8)}});var Zm=function(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a},Km=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{l(n.next(t))}catch(t){s(t)}}function o(t){try{l(n.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((n=n.apply(t,e||[])).next())}))};class Jm extends $r{constructor(){super(...arguments),this._open=!1,this.urlEncodedShareLink=encodeURIComponent(window.location.origin+window.location.pathname),this.updateSharelink=()=>{this.urlEncodedShareLink=encodeURIComponent(window.location.origin+window.location.pathname)},this.open=()=>{var t;this._open||(this._open=!0,document.documentElement.classList.add("no-scroll"),this.closeButton.resetDidClick(),this.dialog.showModal(),null===(t=this._currentTransitionTimeline)||void 0===t||t.progress(1,!1).pause().kill(),this._currentTransitionTimeline=qn.timeline(),this._currentTransitionTimeline.to(this,{autoAlpha:1,duration:.6,ease:"power3.out"}),this._currentTransitionTimeline.fromTo(this.stackLayers,{scale:0,rotationZ:90},{scale:1,duration:1,rotationZ:0,ease:"power4.inOut",stagger:.04},.1),this._currentTransitionTimeline.fromTo(this.topPart,{opacity:0,y:40},{opacity:1,y:0},"-=0.2"),this._currentTransitionTimeline.fromTo(this.socialLinks,{opacity:0,y:40},{opacity:1,stagger:.05,y:0},"-=0.1"))},this.close=()=>{var t;this._open&&(this._open=!1,null===(t=this._currentTransitionTimeline)||void 0===t||t.progress(1,!1).pause().kill(),this._currentTransitionTimeline=qn.timeline({onComplete:()=>{this.dialog.close(),document.documentElement.classList.remove("no-scroll")}}),this._currentTransitionTimeline.to([this.topPart,this.socialLinks],{opacity:0,duration:.4}),this._currentTransitionTimeline.to(this.stackLayers,{scale:0,duration:1,rotationZ:90,ease:"power4.inOut",stagger:-.05},0),this._currentTransitionTimeline.to(this,{autoAlpha:0,duration:.4,ease:"power3.out"},"-=0.3"))}}firstUpdated(t){super.firstUpdated(t),this.dialog=this.parentElement,this.stackLayers=this.querySelectorAll(".stacks-layer"),this.topPart=this.querySelector(".top-part"),this.socialLinks=this.querySelectorAll(".social-link"),this.closeButton=this.querySelector("close-button")}onCopyClicked(t){t.preventDefault();const e=window.location.origin+window.location.pathname;return(()=>{Km(this,void 0,void 0,(function*(){try{yield navigator.clipboard.writeText(e)}catch(t){}}))})(),!1}render(){return Lr`
            <div class="share-inner">
                <div class="stacks">
                    <div class="stacks-layer"></div>
                    <div class="stacks-layer"></div>
                    <div class="stacks-layer"></div>
                    <div class="stacks-layer"></div>
                    <div class="stacks-layer"></div>
                </div>
                <div class="top-part">
                    <p class="social-text">
                        <span>Share </span>
                        <span>with friends</span>
                    </p>
                    <close-button dialogMode="true"></close-button>
                </div>

                <div class="socials-list">
                    <a href="#copy-link" @click="${t=>this.onCopyClicked(t)}" rel="noreferrer" class="social-link">
                        <svg width="26" height="14" viewBox="0 0 26 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M16 2H19C19.6566 2 20.3068 2.12933 20.9134 2.3806C21.52 2.63188 22.0712 3.00017 22.5355 3.46447C22.9998 3.92876 23.3681 4.47996 23.6194 5.08658C23.8707 5.69321 24 6.34339 24 7C24 7.65661 23.8707 8.30679 23.6194 8.91342C23.3681 9.52004 22.9998 10.0712 22.5355 10.5355C22.0712 10.9998 21.52 11.3681 20.9134 11.6194C20.3068 11.8707 19.6566 12 19 12H16M10 12H7C6.34339 12 5.69321 11.8707 5.08658 11.6194C4.47995 11.3681 3.92876 10.9998 3.46447 10.5355C2.52678 9.59785 2 8.32608 2 7C2 5.67392 2.52678 4.40215 3.46447 3.46447C4.40215 2.52678 5.67392 2 7 2H10"
                                stroke="white"
                                stroke-width="3"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            <path d="M9 7H17" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </a>
                    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=${this.urlEncodedShareLink}" rel="noreferrer" class="social-link">
                        <svg width="11" height="20" viewBox="0 0 11 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11 0H8C6.67392 0 5.40215 0.526784 4.46447 1.46447C3.52678 2.40215 3 3.67392 3 5V8H0V12H3V20H7V12H10L11 8H7V5C7 4.73478 7.10536 4.48043 7.29289 4.29289C7.48043 4.10536 7.73478 4 8 4H11V0Z" fill="white" />
                        </svg>
                    </a>
                    <a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&url=${this.urlEncodedShareLink}" rel="noreferrer" class="social-link">
                        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 6C15.5913 6 17.1174 6.63214 18.2426 7.75736C19.3679 8.88258 20 10.4087 20 12V19H16V12C16 11.4696 15.7893 10.9609 15.4142 10.5858C15.0391 10.2107 14.5304 10 14 10C13.4696 10 12.9609 10.2107 12.5858 10.5858C12.2107 10.9609 12 11.4696 12 12V19H8V12C8 10.4087 8.63214 8.88258 9.75736 7.75736C10.8826 6.63214 12.4087 6 14 6Z" fill="white" />
                            <path d="M4 7H0V19H4V7Z" fill="white" />
                            <path d="M2 4C3.10457 4 4 3.10457 4 2C4 0.89543 3.10457 0 2 0C0.89543 0 0 0.89543 0 2C0 3.10457 0.89543 4 2 4Z" fill="white" />
                        </svg>
                    </a>
                    <a target="_blank" href="https://twitter.com/intent/tweet?url=${this.urlEncodedShareLink}" rel="noreferrer" class="social-link">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_2444_2413)">
                                <path d="M13.093 9.31072L21.283 0H19.3422L12.2308 8.08436L6.55101 0H0L8.58902 12.225L0 21.9887H1.94088L9.45067 13.4513L15.449 21.9887H22L13.0925 9.31072H13.093ZM10.4347 12.3327L9.56445 11.1154L2.6402 1.42891H5.62127L11.2092 9.24619L12.0795 10.4635L19.3431 20.6248H16.3621L10.4347 12.3332V12.3327Z" fill="white" />
                            </g>
                            <defs>
                                <clipPath id="clip0_2444_2413">
                                    <rect width="22" height="22" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                    </a>
                </div>
            </div>
        `}}Zm([Xr({type:String})],Jm.prototype,"urlEncodedShareLink",void 0),customElements.define("myth-share",Jm);customElements.define("myth-about",class extends $r{constructor(){super(...arguments),this._open=!1,this.open=()=>{var t;if(this._open)return;this._open=!0,document.documentElement.classList.add("no-scroll"),this.dialogWrapper.showModal(),this.closeButton.resetDidClick();const e=this.scrollHeight-this.clientHeight;null===(t=this.activeTimeline)||void 0===t||t.kill();const i=qn.timeline();e||i.set(this,{overflowY:"hidden"},0),i.to(this,{autoAlpha:1,duration:.6,ease:"power3.out"},0),i.fromTo(this.topItems,{opacity:0,y:60},{opacity:1,y:0,ease:"power4.out",duration:.8,stagger:.1},.2),i.fromTo(this.bottomItems,{opacity:0,y:60},{opacity:1,y:0,ease:"power4.out",duration:.8,stagger:.1},.8),i.fromTo(this.illustration,{rotationZ:-90,opacity:0},{rotationZ:0,opacity:1,duration:.8,ease:"power3.inOut"},.3),i.add((()=>this.illustration.playAnimation()),.8),e||i.set(this,{overflowY:"auto"}),this.activeTimeline=i},this.close=()=>{var t;if(!this._open)return;this._open=!1,null===(t=this.activeTimeline)||void 0===t||t.kill();const e=qn.timeline({onComplete:()=>{this.illustration.stopAnimation(),this.dialogWrapper.close(),document.documentElement.classList.remove("no-scroll")}});this.scrollHeight-this.clientHeight||e.set(this,{overflowY:"hidden"},0),e.to([...this.topItems,...this.bottomItems],{y:100,opacity:0,duration:.8,stagger:-.1,ease:"power3.out"},0),e.to(this.illustration,{opacity:0,duration:.6,rotationZ:-90,ease:"power3.inOut"},0),e.to(this,{autoAlpha:0,duration:.6,ease:"power3.out"},.6),this.activeTimeline=e}}firstUpdated(t){super.firstUpdated(t),this.close=this.close.bind(this),this.dialogWrapper=this.parentElement,this.closeButton=this.querySelector("close-button"),this.illustration=this.querySelector("myth-illustration"),this.topItems=this.querySelector(".top-part").children,this.bottomItems=this.querySelector(".bottom-part").children}});new t;new class{constructor(){this.element=document.querySelector(".myth-splash"),this.loaded=()=>{this.textureLoaded=!0,this.animateOut()},this.element.classList.add("loading"),document.addEventListener("loading-completed",this.loaded),this.textureLoaded&&this.animateOut(.3)}animateOut(t=0){const e=this.element.querySelector(".splash-inner"),i=this.element.querySelector(".splash-copy"),n=qn.timeline({delay:t,onComplete:()=>{this.element.remove()}});n.to(e,{rotateZ:-20,duration:.4,ease:"power3.out"},0),n.to(i,{rotateZ:-20,duration:.2,ease:"power3.out"},0),n.to(e,{rotateZ:80,scale:.7,opacity:0,duration:.6,ease:"power4.out"},.4),n.to(i,{rotateZ:10,duration:.4,ease:"power3.out"},.4),n.to(this.element,{autoAlpha:0,duration:.4,ease:"power3.out"},"-=0.3")}}})()})();