import{$ as v,G as E,Q as w,K as n,R as L,o as k,S as l}from"./index.ff37fac8.js";function S(){this.done||(this.createEffect(()=>{if(v()!==this.camera||!this.mouseControlState.get())return;if(E()===this.camera){const t=s=>this.gyrate(s.movementX,s.movementY);return document.addEventListener("mousemove",t),()=>{document.removeEventListener("mousemove",t)}}let o=!1,e,i,r;const d=()=>{o=!0,[i,r]=[void 0,void 0]},g=()=>o=!1,h=t=>{i===void 0&&(i=t.clientX),r===void 0&&(r=t.clientY);const[s,a]=[t.clientX-i,t.clientY-r];[i,r]=[t.clientX,t.clientY],o&&this.gyrate(s/window.innerWidth*3e3,a/window.innerHeight*3e3)};if(w){const t=c=>{e===void 0&&(e=c.changedTouches[c.changedTouches.length-1].identifier,d())};n.addEventListener("touchstart",t);const s=c=>{e!==void 0&&c.changedTouches[c.changedTouches.length-1].identifier===e&&(e=void 0,g())};n.addEventListener("touchend",s);const a=c=>{if(e===void 0)return;let u;for(let m=0;m<c.changedTouches.length;++m){const f=c.changedTouches[m];if(f.identifier===e){u=f;break}}u&&h(u)};return n.addEventListener("touchmove",a),()=>{n.removeEventListener("touchstart",t),n.removeEventListener("touchend",s),n.removeEventListener("touchmove",a),e=void 0,o=!1}}const p=L.on("down",d),T=L.on("up",g);return n.addEventListener("mousemove",h),()=>{p.cancel(),T.cancel(),n.removeEventListener("mousemove",h),e=void 0,o=!1}},[this.mouseControlState.get,v,E]),this.createEffect(()=>{const o=v();if(this.mouseControlState.get()!==!0||o!==this.camera||k())return;const e=()=>{var r,d;return(d=(r=n).requestPointerLock)==null?void 0:d.call(r)},i=()=>{document.pointerLockElement===n?l(o):l(void 0)};return n.addEventListener("click",e),document.addEventListener("pointerlockchange",i),()=>{n.removeEventListener("click",e),document.removeEventListener("pointerlockchange",i),document.exitPointerLock(),l(void 0)}},[this.mouseControlState.get,v,k]))}export{S as default};
