import{j as h,p as l,br as p,bs as b,bt as B,r as a,C as m,t as w,Y as M}from"./index.ff37fac8.js";import{s as f}from"./useBVHMap.eb7f5eaa.1812c0a6.js";h(()=>{const r=f();if(!r.length){const t=l(p);return()=>{t.cancel()}}const x=l(()=>{p();for(const t of b){t.updateMatrixWorld();const d=B(t),{start:s,end:i}=m;i.copy(s.copy(t.position)),a.makeEmpty(),a.expandByPoint(s),a.min.addScalar(-.5),a.max.addScalar(.5);const u=w,y=M;let o=0,e=0;for(const g of r)g.shapecast({intersectsBounds:c=>c.intersectsBox(a),intersectsTriangle:c=>{o=c.closestPointToSegment(m,u,y),o<.5&&(e=.5-o,s.addScaledVector(d,e),i.addScaledVector(d,e))}});const n=s.sub(t.position),S=Math.max(0,n.length()-1e-5);n.normalize().multiplyScalar(S),t.position.add(n)}});return()=>{x.cancel()}},[f]);
